var Ay=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports);var vy=Ay((exports,module)=>{function _mergeNamespaces(a,s){for(var o=0;o<s.length;o++){const j=s[o];if(typeof j!="string"&&!Array.isArray(j)){for(const $ in j)if($!=="default"&&!($ in a)){const _e=Object.getOwnPropertyDescriptor(j,$);_e&&Object.defineProperty(a,$,_e.get?_e:{enumerable:!0,get:()=>j[$]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const $ of document.querySelectorAll('link[rel="modulepreload"]'))j($);new MutationObserver($=>{for(const _e of $)if(_e.type==="childList")for(const tt of _e.addedNodes)tt.tagName==="LINK"&&tt.rel==="modulepreload"&&j(tt)}).observe(document,{childList:!0,subtree:!0});function o($){const _e={};return $.integrity&&(_e.integrity=$.integrity),$.referrerpolicy&&(_e.referrerPolicy=$.referrerpolicy),$.crossorigin==="use-credentials"?_e.credentials="include":$.crossorigin==="anonymous"?_e.credentials="omit":_e.credentials="same-origin",_e}function j($){if($.ep)return;$.ep=!0;const _e=o($);fetch($.href,_e)}})();function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var jsxRuntimeExports={},jsxRuntime={get exports(){return jsxRuntimeExports},set exports(a){jsxRuntimeExports=a}},reactJsxRuntime_production_min={},reactExports={},react={get exports(){return reactExports},set exports(a){reactExports=a}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(a){return a===null||typeof a!="object"?null:(a=z$2&&a[z$2]||a["@@iterator"],typeof a=="function"?a:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(a,s,o){this.props=a,this.context=s,this.refs=D$1,this.updater=o||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(a,s){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,s,"setState")};E$1.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(a,s,o){this.props=a,this.context=s,this.refs=D$1,this.updater=o||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(a,s,o){var j,$={},_e=null,tt=null;if(s!=null)for(j in s.ref!==void 0&&(tt=s.ref),s.key!==void 0&&(_e=""+s.key),s)J.call(s,j)&&!L$1.hasOwnProperty(j)&&($[j]=s[j]);var nt=arguments.length-2;if(nt===1)$.children=o;else if(1<nt){for(var rt=Array(nt),it=0;it<nt;it++)rt[it]=arguments[it+2];$.children=rt}if(a&&a.defaultProps)for(j in nt=a.defaultProps,nt)$[j]===void 0&&($[j]=nt[j]);return{$$typeof:l$2,type:a,key:_e,ref:tt,props:$,_owner:K$1.current}}function N$1(a,s){return{$$typeof:l$2,type:a.type,key:s,ref:a.ref,props:a.props,_owner:a._owner}}function O$1(a){return typeof a=="object"&&a!==null&&a.$$typeof===l$2}function escape$1(a){var s={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(o){return s[o]})}var P$1=/\/+/g;function Q$1(a,s){return typeof a=="object"&&a!==null&&a.key!=null?escape$1(""+a.key):s.toString(36)}function R$1(a,s,o,j,$){var _e=typeof a;(_e==="undefined"||_e==="boolean")&&(a=null);var tt=!1;if(a===null)tt=!0;else switch(_e){case"string":case"number":tt=!0;break;case"object":switch(a.$$typeof){case l$2:case n$2:tt=!0}}if(tt)return tt=a,$=$(tt),a=j===""?"."+Q$1(tt,0):j,I$1($)?(o="",a!=null&&(o=a.replace(P$1,"$&/")+"/"),R$1($,s,o,"",function(it){return it})):$!=null&&(O$1($)&&($=N$1($,o+(!$.key||tt&&tt.key===$.key?"":(""+$.key).replace(P$1,"$&/")+"/")+a)),s.push($)),1;if(tt=0,j=j===""?".":j+":",I$1(a))for(var nt=0;nt<a.length;nt++){_e=a[nt];var rt=j+Q$1(_e,nt);tt+=R$1(_e,s,o,rt,$)}else if(rt=A$2(a),typeof rt=="function")for(a=rt.call(a),nt=0;!(_e=a.next()).done;)_e=_e.value,rt=j+Q$1(_e,nt++),tt+=R$1(_e,s,o,rt,$);else if(_e==="object")throw s=String(a),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return tt}function S$1(a,s,o){if(a==null)return a;var j=[],$=0;return R$1(a,j,"","",function(_e){return s.call(o,_e,$++)}),j}function T$1(a){if(a._status===-1){var s=a._result;s=s(),s.then(function(o){(a._status===0||a._status===-1)&&(a._status=1,a._result=o)},function(o){(a._status===0||a._status===-1)&&(a._status=2,a._result=o)}),a._status===-1&&(a._status=0,a._result=s)}if(a._status===1)return a._result.default;throw a._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function(a,s,o){S$1(a,function(){s.apply(this,arguments)},o)},count:function(a){var s=0;return S$1(a,function(){s++}),s},toArray:function(a){return S$1(a,function(s){return s})||[]},only:function(a){if(!O$1(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(a,s,o){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var j=C$1({},a.props),$=a.key,_e=a.ref,tt=a._owner;if(s!=null){if(s.ref!==void 0&&(_e=s.ref,tt=K$1.current),s.key!==void 0&&($=""+s.key),a.type&&a.type.defaultProps)var nt=a.type.defaultProps;for(rt in s)J.call(s,rt)&&!L$1.hasOwnProperty(rt)&&(j[rt]=s[rt]===void 0&&nt!==void 0?nt[rt]:s[rt])}var rt=arguments.length-2;if(rt===1)j.children=o;else if(1<rt){nt=Array(rt);for(var it=0;it<rt;it++)nt[it]=arguments[it+2];j.children=nt}return{$$typeof:l$2,type:a.type,key:$,ref:_e,props:j,_owner:tt}};react_production_min.createContext=function(a){return a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:t$1,_context:a},a.Consumer=a};react_production_min.createElement=M$1;react_production_min.createFactory=function(a){var s=M$1.bind(null,a);return s.type=a,s};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(a){return{$$typeof:v$2,render:a}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(a){return{$$typeof:y$1,_payload:{_status:-1,_result:a},_init:T$1}};react_production_min.memo=function(a,s){return{$$typeof:x$2,type:a,compare:s===void 0?null:s}};react_production_min.startTransition=function(a){var s=V$1.transition;V$1.transition={};try{a()}finally{V$1.transition=s}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(a,s){return U$1.current.useCallback(a,s)};react_production_min.useContext=function(a){return U$1.current.useContext(a)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(a){return U$1.current.useDeferredValue(a)};react_production_min.useEffect=function(a,s){return U$1.current.useEffect(a,s)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(a,s,o){return U$1.current.useImperativeHandle(a,s,o)};react_production_min.useInsertionEffect=function(a,s){return U$1.current.useInsertionEffect(a,s)};react_production_min.useLayoutEffect=function(a,s){return U$1.current.useLayoutEffect(a,s)};react_production_min.useMemo=function(a,s){return U$1.current.useMemo(a,s)};react_production_min.useReducer=function(a,s,o){return U$1.current.useReducer(a,s,o)};react_production_min.useRef=function(a){return U$1.current.useRef(a)};react_production_min.useState=function(a){return U$1.current.useState(a)};react_production_min.useSyncExternalStore=function(a,s,o){return U$1.current.useSyncExternalStore(a,s,o)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";(function(a){a.exports=react_production_min})(react);const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(a,s,o){var j,$={},_e=null,tt=null;o!==void 0&&(_e=""+o),s.key!==void 0&&(_e=""+s.key),s.ref!==void 0&&(tt=s.ref);for(j in s)m$2.call(s,j)&&!p$2.hasOwnProperty(j)&&($[j]=s[j]);if(a&&a.defaultProps)for(j in s=a.defaultProps,s)$[j]===void 0&&($[j]=s[j]);return{$$typeof:k$1,type:a,key:_e,ref:tt,props:$,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;(function(a){a.exports=reactJsxRuntime_production_min})(jsxRuntime);const Fragment=jsxRuntimeExports.Fragment,jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client={},reactDomExports={},reactDom={get exports(){return reactDomExports},set exports(a){reactDomExports=a}},reactDom_production_min={},schedulerExports$1={},scheduler$1={get exports(){return schedulerExports$1},set exports(a){schedulerExports$1=a}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function s(Lt,Qt){var nn=Lt.length;Lt.push(Qt);e:for(;0<nn;){var mn=nn-1>>>1,Zt=Lt[mn];if(0<$(Zt,Qt))Lt[mn]=Qt,Lt[nn]=Zt,nn=mn;else break e}}function o(Lt){return Lt.length===0?null:Lt[0]}function j(Lt){if(Lt.length===0)return null;var Qt=Lt[0],nn=Lt.pop();if(nn!==Qt){Lt[0]=nn;e:for(var mn=0,Zt=Lt.length,cn=Zt>>>1;mn<cn;){var Ot=2*(mn+1)-1,rn=Lt[Ot],fn=Ot+1,hn=Lt[fn];if(0>$(rn,nn))fn<Zt&&0>$(hn,rn)?(Lt[mn]=hn,Lt[fn]=nn,mn=fn):(Lt[mn]=rn,Lt[Ot]=nn,mn=Ot);else if(fn<Zt&&0>$(hn,nn))Lt[mn]=hn,Lt[fn]=nn,mn=fn;else break e}}return Qt}function $(Lt,Qt){var nn=Lt.sortIndex-Qt.sortIndex;return nn!==0?nn:Lt.id-Qt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _e=performance;a.unstable_now=function(){return _e.now()}}else{var tt=Date,nt=tt.now();a.unstable_now=function(){return tt.now()-nt}}var rt=[],it=[],st=1,at=null,ot=3,ct=!1,ft=!1,ht=!1,mt=typeof setTimeout=="function"?setTimeout:null,lt=typeof clearTimeout=="function"?clearTimeout:null,ut=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function dt(Lt){for(var Qt=o(it);Qt!==null;){if(Qt.callback===null)j(it);else if(Qt.startTime<=Lt)j(it),Qt.sortIndex=Qt.expirationTime,s(rt,Qt);else break;Qt=o(it)}}function gt(Lt){if(ht=!1,dt(Lt),!ft)if(o(rt)!==null)ft=!0,jt(Et);else{var Qt=o(it);Qt!==null&&Vt(gt,Qt.startTime-Lt)}}function Et(Lt,Qt){ft=!1,ht&&(ht=!1,lt(Mt),Mt=-1),ct=!0;var nn=ot;try{for(dt(Qt),at=o(rt);at!==null&&(!(at.expirationTime>Qt)||Lt&&!Ut());){var mn=at.callback;if(typeof mn=="function"){at.callback=null,ot=at.priorityLevel;var Zt=mn(at.expirationTime<=Qt);Qt=a.unstable_now(),typeof Zt=="function"?at.callback=Zt:at===o(rt)&&j(rt),dt(Qt)}else j(rt);at=o(rt)}if(at!==null)var cn=!0;else{var Ot=o(it);Ot!==null&&Vt(gt,Ot.startTime-Qt),cn=!1}return cn}finally{at=null,ot=nn,ct=!1}}var St=!1,Tt=null,Mt=-1,Bt=5,Rt=-1;function Ut(){return!(a.unstable_now()-Rt<Bt)}function Ht(){if(Tt!==null){var Lt=a.unstable_now();Rt=Lt;var Qt=!0;try{Qt=Tt(!0,Lt)}finally{Qt?Wt():(St=!1,Tt=null)}}else St=!1}var Wt;if(typeof ut=="function")Wt=function(){ut(Ht)};else if(typeof MessageChannel<"u"){var Jt=new MessageChannel,sn=Jt.port2;Jt.port1.onmessage=Ht,Wt=function(){sn.postMessage(null)}}else Wt=function(){mt(Ht,0)};function jt(Lt){Tt=Lt,St||(St=!0,Wt())}function Vt(Lt,Qt){Mt=mt(function(){Lt(a.unstable_now())},Qt)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Lt){Lt.callback=null},a.unstable_continueExecution=function(){ft||ct||(ft=!0,jt(Et))},a.unstable_forceFrameRate=function(Lt){0>Lt||125<Lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Bt=0<Lt?Math.floor(1e3/Lt):5},a.unstable_getCurrentPriorityLevel=function(){return ot},a.unstable_getFirstCallbackNode=function(){return o(rt)},a.unstable_next=function(Lt){switch(ot){case 1:case 2:case 3:var Qt=3;break;default:Qt=ot}var nn=ot;ot=Qt;try{return Lt()}finally{ot=nn}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Lt,Qt){switch(Lt){case 1:case 2:case 3:case 4:case 5:break;default:Lt=3}var nn=ot;ot=Lt;try{return Qt()}finally{ot=nn}},a.unstable_scheduleCallback=function(Lt,Qt,nn){var mn=a.unstable_now();switch(typeof nn=="object"&&nn!==null?(nn=nn.delay,nn=typeof nn=="number"&&0<nn?mn+nn:mn):nn=mn,Lt){case 1:var Zt=-1;break;case 2:Zt=250;break;case 5:Zt=1073741823;break;case 4:Zt=1e4;break;default:Zt=5e3}return Zt=nn+Zt,Lt={id:st++,callback:Qt,priorityLevel:Lt,startTime:nn,expirationTime:Zt,sortIndex:-1},nn>mn?(Lt.sortIndex=nn,s(it,Lt),o(rt)===null&&Lt===o(it)&&(ht?(lt(Mt),Mt=-1):ht=!0,Vt(gt,nn-mn))):(Lt.sortIndex=Zt,s(rt,Lt),ft||ct||(ft=!0,jt(Et))),Lt},a.unstable_shouldYield=Ut,a.unstable_wrapCallback=function(Lt){var Qt=ot;return function(){var nn=ot;ot=Qt;try{return Lt.apply(this,arguments)}finally{ot=nn}}}})(scheduler_production_min$1);(function(a){a.exports=scheduler_production_min$1})(scheduler$1);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports$1;function p$1(a){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+a,o=1;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(a,s){ha(a,s),ha(a+"Capture",s)}function ha(a,s){for(ea[a]=s,a=0;a<s.length;a++)da.add(s[a])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(a){return ja.call(ma,a)?!0:ja.call(la,a)?!1:ka.test(a)?ma[a]=!0:(la[a]=!0,!1)}function pa(a,s,o,j){if(o!==null&&o.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return j?!1:o!==null?!o.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function qa(a,s,o,j){if(s===null||typeof s>"u"||pa(a,s,o,j))return!0;if(j)return!1;if(o!==null)switch(o.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function v$1(a,s,o,j,$,_e,tt){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=j,this.attributeNamespace=$,this.mustUseProperty=o,this.propertyName=a,this.type=s,this.sanitizeURL=_e,this.removeEmptyString=tt}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){z$1[a]=new v$1(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var s=a[0];z$1[s]=new v$1(s,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){z$1[a]=new v$1(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){z$1[a]=new v$1(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){z$1[a]=new v$1(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){z$1[a]=new v$1(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){z$1[a]=new v$1(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){z$1[a]=new v$1(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){z$1[a]=new v$1(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var s=a.replace(ra,sa);z$1[s]=new v$1(s,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var s=a.replace(ra,sa);z$1[s]=new v$1(s,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var s=a.replace(ra,sa);z$1[s]=new v$1(s,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){z$1[a]=new v$1(a,1,!1,a.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){z$1[a]=new v$1(a,1,!1,a.toLowerCase(),null,!0,!0)});function ta(a,s,o,j){var $=z$1.hasOwnProperty(s)?z$1[s]:null;($!==null?$.type!==0:j||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(qa(s,o,$,j)&&(o=null),j||$===null?oa(s)&&(o===null?a.removeAttribute(s):a.setAttribute(s,""+o)):$.mustUseProperty?a[$.propertyName]=o===null?$.type===3?!1:"":o:(s=$.attributeName,j=$.attributeNamespace,o===null?a.removeAttribute(s):($=$.type,o=$===3||$===4&&o===!0?"":""+o,j?a.setAttributeNS(j,s,o):a.setAttribute(s,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(a){return a===null||typeof a!="object"?null:(a=Ja&&a[Ja]||a["@@iterator"],typeof a=="function"?a:null)}var A$1=Object.assign,La;function Ma(a){if(La===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);La=s&&s[1]||""}return`
`+La+a}var Na=!1;function Oa(a,s){if(!a||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(it){var j=it}Reflect.construct(a,[],s)}else{try{s.call()}catch(it){j=it}a.call(s.prototype)}else{try{throw Error()}catch(it){j=it}a()}}catch(it){if(it&&j&&typeof it.stack=="string"){for(var $=it.stack.split(`
`),_e=j.stack.split(`
`),tt=$.length-1,nt=_e.length-1;1<=tt&&0<=nt&&$[tt]!==_e[nt];)nt--;for(;1<=tt&&0<=nt;tt--,nt--)if($[tt]!==_e[nt]){if(tt!==1||nt!==1)do if(tt--,nt--,0>nt||$[tt]!==_e[nt]){var rt=`
`+$[tt].replace(" at new "," at ");return a.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",a.displayName)),rt}while(1<=tt&&0<=nt);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(a=a?a.displayName||a.name:"")?Ma(a):""}function Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return""}}function Qa(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case Ca:return(a.displayName||"Context")+".Consumer";case Ba:return(a._context.displayName||"Context")+".Provider";case Da:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ga:return s=a.displayName||null,s!==null?s:Qa(a.type)||"Memo";case Ha:s=a._payload,a=a._init;try{return Qa(a(s))}catch{}}return null}function Ra(a){var s=a.type;switch(a.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=s.render,a=a.displayName||a.name||"",s.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(s);case 8:return s===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Sa(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ta(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ua(a){var s=Ta(a)?"checked":"value",o=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),j=""+a[s];if(!a.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var $=o.get,_e=o.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return $.call(this)},set:function(tt){j=""+tt,_e.call(this,tt)}}),Object.defineProperty(a,s,{enumerable:o.enumerable}),{getValue:function(){return j},setValue:function(tt){j=""+tt},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var o=s.getValue(),j="";return a&&(j=Ta(a)?a.checked?"true":"false":a.value),a=j,a!==o?(s.setValue(a),!0):!1}function Xa(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ya(a,s){var o=s.checked;return A$1({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??a._wrapperState.initialChecked})}function Za(a,s){var o=s.defaultValue==null?"":s.defaultValue,j=s.checked!=null?s.checked:s.defaultChecked;o=Sa(s.value!=null?s.value:o),a._wrapperState={initialChecked:j,initialValue:o,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ab(a,s){s=s.checked,s!=null&&ta(a,"checked",s,!1)}function bb(a,s){ab(a,s);var o=Sa(s.value),j=s.type;if(o!=null)j==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+o):a.value!==""+o&&(a.value=""+o);else if(j==="submit"||j==="reset"){a.removeAttribute("value");return}s.hasOwnProperty("value")?cb(a,s.type,o):s.hasOwnProperty("defaultValue")&&cb(a,s.type,Sa(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(a.defaultChecked=!!s.defaultChecked)}function db(a,s,o){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var j=s.type;if(!(j!=="submit"&&j!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+a._wrapperState.initialValue,o||s===a.value||(a.value=s),a.defaultValue=s}o=a.name,o!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,o!==""&&(a.name=o)}function cb(a,s,o){(s!=="number"||Xa(a.ownerDocument)!==a)&&(o==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+o&&(a.defaultValue=""+o))}var eb=Array.isArray;function fb(a,s,o,j){if(a=a.options,s){s={};for(var $=0;$<o.length;$++)s["$"+o[$]]=!0;for(o=0;o<a.length;o++)$=s.hasOwnProperty("$"+a[o].value),a[o].selected!==$&&(a[o].selected=$),$&&j&&(a[o].defaultSelected=!0)}else{for(o=""+Sa(o),s=null,$=0;$<a.length;$++){if(a[$].value===o){a[$].selected=!0,j&&(a[$].defaultSelected=!0);return}s!==null||a[$].disabled||(s=a[$])}s!==null&&(s.selected=!0)}}function gb(a,s){if(s.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},s,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function hb(a,s){var o=s.value;if(o==null){if(o=s.children,s=s.defaultValue,o!=null){if(s!=null)throw Error(p$1(92));if(eb(o)){if(1<o.length)throw Error(p$1(93));o=o[0]}s=o}s==null&&(s=""),o=s}a._wrapperState={initialValue:Sa(o)}}function ib(a,s){var o=Sa(s.value),j=Sa(s.defaultValue);o!=null&&(o=""+o,o!==a.value&&(a.value=o),s.defaultValue==null&&a.defaultValue!==o&&(a.defaultValue=o)),j!=null&&(a.defaultValue=""+j)}function jb(a){var s=a.textContent;s===a._wrapperState.initialValue&&s!==""&&s!==null&&(a.value=s)}function kb(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(a,s){return a==null||a==="http://www.w3.org/1999/xhtml"?kb(s):a==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var mb,nb=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,o,j,$){MSApp.execUnsafeLocalFunction(function(){return a(s,o,j,$)})}:a}(function(a,s){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=s;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;s.firstChild;)a.appendChild(s.firstChild)}});function ob(a,s){if(s){var o=a.firstChild;if(o&&o===a.lastChild&&o.nodeType===3){o.nodeValue=s;return}}a.textContent=s}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(a){qb.forEach(function(s){s=s+a.charAt(0).toUpperCase()+a.substring(1),pb[s]=pb[a]})});function rb(a,s,o){return s==null||typeof s=="boolean"||s===""?"":o||typeof s!="number"||s===0||pb.hasOwnProperty(a)&&pb[a]?(""+s).trim():s+"px"}function sb(a,s){a=a.style;for(var o in s)if(s.hasOwnProperty(o)){var j=o.indexOf("--")===0,$=rb(o,s[o],j);o==="float"&&(o="cssFloat"),j?a.setProperty(o,$):a[o]=$}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(a,s){if(s){if(tb[a]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(p$1(137,a));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(p$1(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(p$1(61))}if(s.style!=null&&typeof s.style!="object")throw Error(p$1(62))}}function vb(a,s){if(a.indexOf("-")===-1)return typeof s.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yb=null,zb=null,Ab=null;function Bb(a){if(a=Cb(a)){if(typeof yb!="function")throw Error(p$1(280));var s=a.stateNode;s&&(s=Db(s),yb(a.stateNode,a.type,s))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,s=Ab;if(Ab=zb=null,Bb(a),s)for(a=0;a<s.length;a++)Bb(s[a])}}function Gb(a,s){return a(s)}function Hb(){}var Ib=!1;function Jb(a,s,o){if(Ib)return a(s,o);Ib=!0;try{return Gb(a,s,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(a,s){var o=a.stateNode;if(o===null)return null;var j=Db(o);if(j===null)return null;o=j[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(a=a.type,j=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!j;break e;default:a=!1}if(a)return null;if(o&&typeof o!="function")throw Error(p$1(231,s,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(a,s,o,j,$,_e,tt,nt,rt){var it=Array.prototype.slice.call(arguments,3);try{s.apply(o,it)}catch(st){this.onError(st)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0,Pb=a}};function Tb(a,s,o,j,$,_e,tt,nt,rt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(a,s,o,j,$,_e,tt,nt,rt){if(Tb.apply(this,arguments),Ob){if(Ob){var it=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=it)}}function Vb(a){var s=a,o=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,s.flags&4098&&(o=s.return),a=s.return;while(a)}return s.tag===3?o:null}function Wb(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p$1(188))}function Yb(a){var s=a.alternate;if(!s){if(s=Vb(a),s===null)throw Error(p$1(188));return s!==a?null:a}for(var o=a,j=s;;){var $=o.return;if($===null)break;var _e=$.alternate;if(_e===null){if(j=$.return,j!==null){o=j;continue}break}if($.child===_e.child){for(_e=$.child;_e;){if(_e===o)return Xb($),a;if(_e===j)return Xb($),s;_e=_e.sibling}throw Error(p$1(188))}if(o.return!==j.return)o=$,j=_e;else{for(var tt=!1,nt=$.child;nt;){if(nt===o){tt=!0,o=$,j=_e;break}if(nt===j){tt=!0,j=$,o=_e;break}nt=nt.sibling}if(!tt){for(nt=_e.child;nt;){if(nt===o){tt=!0,o=_e,j=$;break}if(nt===j){tt=!0,j=_e,o=$;break}nt=nt.sibling}if(!tt)throw Error(p$1(189))}}if(o.alternate!==j)throw Error(p$1(190))}if(o.tag!==3)throw Error(p$1(188));return o.stateNode.current===o?a:s}function Zb(a){return a=Yb(a),a!==null?$b(a):null}function $b(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var s=$b(a);if(s!==null)return s;a=a.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,a,void 0,(a.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){return a>>>=0,a===0?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;function tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function uc(a,s){var o=a.pendingLanes;if(o===0)return 0;var j=0,$=a.suspendedLanes,_e=a.pingedLanes,tt=o&268435455;if(tt!==0){var nt=tt&~$;nt!==0?j=tc(nt):(_e&=tt,_e!==0&&(j=tc(_e)))}else tt=o&~$,tt!==0?j=tc(tt):_e!==0&&(j=tc(_e));if(j===0)return 0;if(s!==0&&s!==j&&!(s&$)&&($=j&-j,_e=s&-s,$>=_e||$===16&&(_e&4194240)!==0))return s;if(j&4&&(j|=o&16),s=a.entangledLanes,s!==0)for(a=a.entanglements,s&=j;0<s;)o=31-oc(s),$=1<<o,j|=a[o],s&=~$;return j}function vc(a,s){switch(a){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(a,s){for(var o=a.suspendedLanes,j=a.pingedLanes,$=a.expirationTimes,_e=a.pendingLanes;0<_e;){var tt=31-oc(_e),nt=1<<tt,rt=$[tt];rt===-1?(!(nt&o)||nt&j)&&($[tt]=vc(nt,s)):rt<=s&&(a.expiredLanes|=nt),_e&=~nt}}function xc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function yc(){var a=rc;return rc<<=1,!(rc&4194240)&&(rc=64),a}function zc(a){for(var s=[],o=0;31>o;o++)s.push(a);return s}function Ac(a,s,o){a.pendingLanes|=s,s!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,s=31-oc(s),a[s]=o}function Bc(a,s){var o=a.pendingLanes&~s;a.pendingLanes=s,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=s,a.mutableReadLanes&=s,a.entangledLanes&=s,s=a.entanglements;var j=a.eventTimes;for(a=a.expirationTimes;0<o;){var $=31-oc(o),_e=1<<$;s[$]=0,j[$]=-1,a[$]=-1,o&=~_e}}function Cc(a,s){var o=a.entangledLanes|=s;for(a=a.entanglements;o;){var j=31-oc(o),$=1<<j;$&s|a[j]&s&&(a[j]|=s),o&=~$}}var C=0;function Dc(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(a,s){switch(a){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(s.pointerId)}}function Tc(a,s,o,j,$,_e){return a===null||a.nativeEvent!==_e?(a={blockedOn:s,domEventName:o,eventSystemFlags:j,nativeEvent:_e,targetContainers:[$]},s!==null&&(s=Cb(s),s!==null&&Fc(s)),a):(a.eventSystemFlags|=j,s=a.targetContainers,$!==null&&s.indexOf($)===-1&&s.push($),a)}function Uc(a,s,o,j,$){switch(s){case"focusin":return Lc=Tc(Lc,a,s,o,j,$),!0;case"dragenter":return Mc=Tc(Mc,a,s,o,j,$),!0;case"mouseover":return Nc=Tc(Nc,a,s,o,j,$),!0;case"pointerover":var _e=$.pointerId;return Oc.set(_e,Tc(Oc.get(_e)||null,a,s,o,j,$)),!0;case"gotpointercapture":return _e=$.pointerId,Pc.set(_e,Tc(Pc.get(_e)||null,a,s,o,j,$)),!0}return!1}function Vc(a){var s=Wc(a.target);if(s!==null){var o=Vb(s);if(o!==null){if(s=o.tag,s===13){if(s=Wb(o),s!==null){a.blockedOn=s,Ic(a.priority,function(){Gc(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){a.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xc(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var o=Yc(a.domEventName,a.eventSystemFlags,s[0],a.nativeEvent);if(o===null){o=a.nativeEvent;var j=new o.constructor(o.type,o);wb=j,o.target.dispatchEvent(j),wb=null}else return s=Cb(o),s!==null&&Fc(s),a.blockedOn=o,!1;s.shift()}return!0}function Zc(a,s,o){Xc(a)&&o.delete(s)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(a,s){a.blockedOn===s&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(a){function s($){return ad($,a)}if(0<Kc.length){ad(Kc[0],a);for(var o=1;o<Kc.length;o++){var j=Kc[o];j.blockedOn===a&&(j.blockedOn=null)}}for(Lc!==null&&ad(Lc,a),Mc!==null&&ad(Mc,a),Nc!==null&&ad(Nc,a),Oc.forEach(s),Pc.forEach(s),o=0;o<Qc.length;o++)j=Qc[o],j.blockedOn===a&&(j.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(a,s,o,j){var $=C,_e=cd.transition;cd.transition=null;try{C=1,fd$1(a,s,o,j)}finally{C=$,cd.transition=_e}}function gd(a,s,o,j){var $=C,_e=cd.transition;cd.transition=null;try{C=4,fd$1(a,s,o,j)}finally{C=$,cd.transition=_e}}function fd$1(a,s,o,j){if(dd){var $=Yc(a,s,o,j);if($===null)hd(a,s,j,id$1,o),Sc(a,j);else if(Uc($,a,s,o,j))j.stopPropagation();else if(Sc(a,j),s&4&&-1<Rc.indexOf(a)){for(;$!==null;){var _e=Cb($);if(_e!==null&&Ec(_e),_e=Yc(a,s,o,j),_e===null&&hd(a,s,j,id$1,o),_e===$)break;$=_e}$!==null&&j.stopPropagation()}else hd(a,s,j,null,o)}}var id$1=null;function Yc(a,s,o,j){if(id$1=null,a=xb(j),a=Wc(a),a!==null)if(s=Vb(a),s===null)a=null;else if(o=s.tag,o===13){if(a=Wb(s),a!==null)return a;a=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null);return id$1=a,null}function jd(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,s=ld,o=s.length,j,$="value"in kd?kd.value:kd.textContent,_e=$.length;for(a=0;a<o&&s[a]===$[a];a++);var tt=o-a;for(j=1;j<=tt&&s[o-j]===$[_e-j];j++);return md=$.slice(a,1<j?1-j:void 0)}function od(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function pd(){return!0}function qd(){return!1}function rd(a){function s(o,j,$,_e,tt){this._reactName=o,this._targetInst=$,this.type=j,this.nativeEvent=_e,this.target=tt,this.currentTarget=null;for(var nt in a)a.hasOwnProperty(nt)&&(o=a[nt],this[nt]=o?o(_e):_e[nt]);return this.isDefaultPrevented=(_e.defaultPrevented!=null?_e.defaultPrevented:_e.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),s}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yd&&(yd&&a.type==="mousemove"?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a),wd)},movementY:function(a){return"movementY"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Od[a])?!!s[a]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(a){if(a.key){var s=Md[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=od(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Nd[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return a.type==="keypress"?od(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?od(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(a,s){switch(a){case"keyup":return $d.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ie=!1;function je(a,s){switch(a){case"compositionend":return he(s);case"keypress":return s.which!==32?null:(fe=!0,ee);case"textInput":return a=s.data,a===ee&&fe?null:a;default:return null}}function ke(a,s){if(ie)return a==="compositionend"||!ae&&ge(a,s)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return de&&s.locale!=="ko"?null:s.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!le[a.type]:s==="textarea"}function ne(a,s,o,j){Eb(j),s=oe(s,"onChange"),0<s.length&&(o=new td$1("onChange","change",null,o,j),a.push({event:o,listeners:s}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var s=ue(a);if(Wa(s))return a}function ve(a,s){if(a==="change")return s}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(a){if(a.propertyName==="value"&&te(qe)){var s=[];ne(s,qe,a,xb(a)),Jb(re,s)}}function Ce(a,s,o){a==="focusin"?(Ae(),pe=s,qe=o,pe.attachEvent("onpropertychange",Be)):a==="focusout"&&Ae()}function De(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return te(qe)}function Ee(a,s){if(a==="click")return te(s)}function Fe(a,s){if(a==="input"||a==="change")return te(s)}function Ge(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(a,s){if(He(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var o=Object.keys(a),j=Object.keys(s);if(o.length!==j.length)return!1;for(j=0;j<o.length;j++){var $=o[j];if(!ja.call(s,$)||!He(a[$],s[$]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ke(a,s){var o=Je(a);a=0;for(var j;o;){if(o.nodeType===3){if(j=a+o.textContent.length,a<=s&&j>=s)return{node:o,offset:s-a};a=j}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Je(o)}}function Le(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Le(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Me(){for(var a=window,s=Xa();s instanceof a.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)a=s.contentWindow;else break;s=Xa(a.document)}return s}function Ne(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}function Oe(a){var s=Me(),o=a.focusedElem,j=a.selectionRange;if(s!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(j!==null&&Ne(o)){if(s=j.start,a=j.end,a===void 0&&(a=s),"selectionStart"in o)o.selectionStart=s,o.selectionEnd=Math.min(a,o.value.length);else if(a=(s=o.ownerDocument||document)&&s.defaultView||window,a.getSelection){a=a.getSelection();var $=o.textContent.length,_e=Math.min(j.start,$);j=j.end===void 0?_e:Math.min(j.end,$),!a.extend&&_e>j&&($=j,j=_e,_e=$),$=Ke(o,_e);var tt=Ke(o,j);$&&tt&&(a.rangeCount!==1||a.anchorNode!==$.node||a.anchorOffset!==$.offset||a.focusNode!==tt.node||a.focusOffset!==tt.offset)&&(s=s.createRange(),s.setStart($.node,$.offset),a.removeAllRanges(),_e>j?(a.addRange(s),a.extend(tt.node,tt.offset)):(s.setEnd(tt.node,tt.offset),a.addRange(s)))}}for(s=[],a=o;a=a.parentNode;)a.nodeType===1&&s.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<s.length;o++)a=s[o],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(a,s,o){var j=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te||Qe==null||Qe!==Xa(j)||(j=Qe,"selectionStart"in j&&Ne(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),Se&&Ie(Se,j)||(Se=j,j=oe(Re,"onSelect"),0<j.length&&(s=new td$1("onSelect","select",null,s,o),a.push({event:s,listeners:j}),s.target=Qe)))}function Ve(a,s){var o={};return o[a.toLowerCase()]=s.toLowerCase(),o["Webkit"+a]="webkit"+s,o["Moz"+a]="moz"+s,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var s=We[a],o;for(o in s)if(s.hasOwnProperty(o)&&o in Ye)return Xe[a]=s[o];return a}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(a,s){df.set(a,s),fa(s,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(a,s,o){var j=a.type||"unknown-event";a.currentTarget=o,Ub(j,s,void 0,a),a.currentTarget=null}function se(a,s){s=(s&4)!==0;for(var o=0;o<a.length;o++){var j=a[o],$=j.event;j=j.listeners;e:{var _e=void 0;if(s)for(var tt=j.length-1;0<=tt;tt--){var nt=j[tt],rt=nt.instance,it=nt.currentTarget;if(nt=nt.listener,rt!==_e&&$.isPropagationStopped())break e;nf($,nt,it),_e=rt}else for(tt=0;tt<j.length;tt++){if(nt=j[tt],rt=nt.instance,it=nt.currentTarget,nt=nt.listener,rt!==_e&&$.isPropagationStopped())break e;nf($,nt,it),_e=rt}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a}function D(a,s){var o=s[of];o===void 0&&(o=s[of]=new Set);var j=a+"__bubble";o.has(j)||(pf(s,a,2,!1),o.add(j))}function qf(a,s,o){var j=0;s&&(j|=4),pf(o,a,j,s)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,a),qf(o,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[rf]||(s[rf]=!0,qf("selectionchange",!1,s))}}function pf(a,s,o,j){switch(jd(s)){case 1:var $=ed;break;case 4:$=gd;break;default:$=fd$1}o=$.bind(null,s,o,a),$=void 0,!Lb||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||($=!0),j?$!==void 0?a.addEventListener(s,o,{capture:!0,passive:$}):a.addEventListener(s,o,!0):$!==void 0?a.addEventListener(s,o,{passive:$}):a.addEventListener(s,o,!1)}function hd(a,s,o,j,$){var _e=j;if(!(s&1)&&!(s&2)&&j!==null)e:for(;;){if(j===null)return;var tt=j.tag;if(tt===3||tt===4){var nt=j.stateNode.containerInfo;if(nt===$||nt.nodeType===8&&nt.parentNode===$)break;if(tt===4)for(tt=j.return;tt!==null;){var rt=tt.tag;if((rt===3||rt===4)&&(rt=tt.stateNode.containerInfo,rt===$||rt.nodeType===8&&rt.parentNode===$))return;tt=tt.return}for(;nt!==null;){if(tt=Wc(nt),tt===null)return;if(rt=tt.tag,rt===5||rt===6){j=_e=tt;continue e}nt=nt.parentNode}}j=j.return}Jb(function(){var it=_e,st=xb(o),at=[];e:{var ot=df.get(a);if(ot!==void 0){var ct=td$1,ft=a;switch(a){case"keypress":if(od(o)===0)break e;case"keydown":case"keyup":ct=Rd;break;case"focusin":ft="focus",ct=Fd;break;case"focusout":ft="blur",ct=Fd;break;case"beforeblur":case"afterblur":ct=Fd;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Vd;break;case $e:case af:case bf:ct=Hd;break;case cf:ct=Xd;break;case"scroll":ct=vd;break;case"wheel":ct=Zd;break;case"copy":case"cut":case"paste":ct=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=Td}var ht=(s&4)!==0,mt=!ht&&a==="scroll",lt=ht?ot!==null?ot+"Capture":null:ot;ht=[];for(var ut=it,dt;ut!==null;){dt=ut;var gt=dt.stateNode;if(dt.tag===5&&gt!==null&&(dt=gt,lt!==null&&(gt=Kb(ut,lt),gt!=null&&ht.push(tf(ut,gt,dt)))),mt)break;ut=ut.return}0<ht.length&&(ot=new ct(ot,ft,null,o,st),at.push({event:ot,listeners:ht}))}}if(!(s&7)){e:{if(ot=a==="mouseover"||a==="pointerover",ct=a==="mouseout"||a==="pointerout",ot&&o!==wb&&(ft=o.relatedTarget||o.fromElement)&&(Wc(ft)||ft[uf]))break e;if((ct||ot)&&(ot=st.window===st?st:(ot=st.ownerDocument)?ot.defaultView||ot.parentWindow:window,ct?(ft=o.relatedTarget||o.toElement,ct=it,ft=ft?Wc(ft):null,ft!==null&&(mt=Vb(ft),ft!==mt||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(ct=null,ft=it),ct!==ft)){if(ht=Bd,gt="onMouseLeave",lt="onMouseEnter",ut="mouse",(a==="pointerout"||a==="pointerover")&&(ht=Td,gt="onPointerLeave",lt="onPointerEnter",ut="pointer"),mt=ct==null?ot:ue(ct),dt=ft==null?ot:ue(ft),ot=new ht(gt,ut+"leave",ct,o,st),ot.target=mt,ot.relatedTarget=dt,gt=null,Wc(st)===it&&(ht=new ht(lt,ut+"enter",ft,o,st),ht.target=dt,ht.relatedTarget=mt,gt=ht),mt=gt,ct&&ft)t:{for(ht=ct,lt=ft,ut=0,dt=ht;dt;dt=vf(dt))ut++;for(dt=0,gt=lt;gt;gt=vf(gt))dt++;for(;0<ut-dt;)ht=vf(ht),ut--;for(;0<dt-ut;)lt=vf(lt),dt--;for(;ut--;){if(ht===lt||lt!==null&&ht===lt.alternate)break t;ht=vf(ht),lt=vf(lt)}ht=null}else ht=null;ct!==null&&wf(at,ot,ct,ht,!1),ft!==null&&mt!==null&&wf(at,mt,ft,ht,!0)}}e:{if(ot=it?ue(it):window,ct=ot.nodeName&&ot.nodeName.toLowerCase(),ct==="select"||ct==="input"&&ot.type==="file")var Et=ve;else if(me(ot))if(we)Et=Fe;else{Et=De;var St=Ce}else(ct=ot.nodeName)&&ct.toLowerCase()==="input"&&(ot.type==="checkbox"||ot.type==="radio")&&(Et=Ee);if(Et&&(Et=Et(a,it))){ne(at,Et,o,st);break e}St&&St(a,ot,it),a==="focusout"&&(St=ot._wrapperState)&&St.controlled&&ot.type==="number"&&cb(ot,"number",ot.value)}switch(St=it?ue(it):window,a){case"focusin":(me(St)||St.contentEditable==="true")&&(Qe=St,Re=it,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(at,o,st);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(at,o,st)}var Tt;if(ae)e:{switch(a){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else ie?ge(a,o)&&(Mt="onCompositionEnd"):a==="keydown"&&o.keyCode===229&&(Mt="onCompositionStart");Mt&&(de&&o.locale!=="ko"&&(ie||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&ie&&(Tt=nd()):(kd=st,ld="value"in kd?kd.value:kd.textContent,ie=!0)),St=oe(it,Mt),0<St.length&&(Mt=new Ld(Mt,a,null,o,st),at.push({event:Mt,listeners:St}),Tt?Mt.data=Tt:(Tt=he(o),Tt!==null&&(Mt.data=Tt)))),(Tt=ce?je(a,o):ke(a,o))&&(it=oe(it,"onBeforeInput"),0<it.length&&(st=new Ld("onBeforeInput","beforeinput",null,o,st),at.push({event:st,listeners:it}),st.data=Tt))}se(at,s)})}function tf(a,s,o){return{instance:a,listener:s,currentTarget:o}}function oe(a,s){for(var o=s+"Capture",j=[];a!==null;){var $=a,_e=$.stateNode;$.tag===5&&_e!==null&&($=_e,_e=Kb(a,o),_e!=null&&j.unshift(tf(a,_e,$)),_e=Kb(a,s),_e!=null&&j.push(tf(a,_e,$))),a=a.return}return j}function vf(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function wf(a,s,o,j,$){for(var _e=s._reactName,tt=[];o!==null&&o!==j;){var nt=o,rt=nt.alternate,it=nt.stateNode;if(rt!==null&&rt===j)break;nt.tag===5&&it!==null&&(nt=it,$?(rt=Kb(o,_e),rt!=null&&tt.unshift(tf(o,rt,nt))):$||(rt=Kb(o,_e),rt!=null&&tt.push(tf(o,rt,nt)))),o=o.return}tt.length!==0&&a.push({event:s,listeners:tt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(a){return(typeof a=="string"?a:""+a).replace(xf,`
`).replace(yf,"")}function Af(a,s,o){if(s=zf(s),zf(a)!==s&&o)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a})}function Kf(a,s){var o=s,j=0;do{var $=o.nextSibling;if(a.removeChild(o),$&&$.nodeType===8)if(o=$.data,o==="/$"){if(j===0){a.removeChild($),bd(s);return}j--}else o!=="$"&&o!=="$?"&&o!=="$!"||j++;o=$}while(o);bd(s)}function Lf(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return a}function Mf(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var o=a.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return a;s--}else o==="/$"&&s++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(a){var s=a[Of];if(s)return s;for(var o=a.parentNode;o;){if(s=o[uf]||o[Of]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(a=Mf(a);a!==null;){if(o=a[Of])return o;a=Mf(a)}return s}a=o,o=a.parentNode}return null}function Cb(a){return a=a[Of]||a[uf],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ue(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(p$1(33))}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}function E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,s){Tf++,Sf[Tf]=a.current,a.current=s}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,s){var o=a.type.contextTypes;if(!o)return Vf;var j=a.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===s)return j.__reactInternalMemoizedMaskedChildContext;var $={},_e;for(_e in o)$[_e]=s[_e];return j&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=s,a.__reactInternalMemoizedMaskedChildContext=$),$}function Zf(a){return a=a.childContextTypes,a!=null}function $f(){E(Wf),E(H)}function ag(a,s,o){if(H.current!==Vf)throw Error(p$1(168));G(H,s),G(Wf,o)}function bg(a,s,o){var j=a.stateNode;if(s=s.childContextTypes,typeof j.getChildContext!="function")return o;j=j.getChildContext();for(var $ in j)if(!($ in s))throw Error(p$1(108,Ra(a)||"Unknown",$));return A$1({},o,j)}function cg(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,a),G(Wf,Wf.current),!0}function dg(a,s,o){var j=a.stateNode;if(!j)throw Error(p$1(169));o?(a=bg(a,s,Xf),j.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(a){eg===null?eg=[a]:eg.push(a)}function ig(a){fg=!0,hg(a)}function jg(){if(!gg&&eg!==null){gg=!0;var a=0,s=C;try{var o=eg;for(C=1;a<o.length;a++){var j=o[a];do j=j(!0);while(j!==null)}eg=null,fg=!1}catch($){throw eg!==null&&(eg=eg.slice(a+1)),ac(fc,jg),$}finally{C=s,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(a,s){kg[lg++]=ng,kg[lg++]=mg,mg=a,ng=s}function ug(a,s,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=a;var j=rg;a=sg;var $=32-oc(j)-1;j&=~(1<<$),o+=1;var _e=32-oc(s)+$;if(30<_e){var tt=$-$%5;_e=(j&(1<<tt)-1).toString(32),j>>=tt,$-=tt,rg=1<<32-oc(s)+$|o<<$|j,sg=_e+a}else rg=1<<_e|o<<$|j,sg=a}function vg(a){a.return!==null&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(a,s){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=s,o.return=a,s=a.deletions,s===null?(a.deletions=[o],a.flags|=16):s.push(o)}function Cg(a,s){switch(a.tag){case 5:var o=a.type;return s=s.nodeType!==1||o.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(a.stateNode=s,xg=a,yg=Lf(s.firstChild),!0):!1;case 6:return s=a.pendingProps===""||s.nodeType!==3?null:s,s!==null?(a.stateNode=s,xg=a,yg=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(o=qg!==null?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:s,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=s,o.return=a,a.child=o,xg=a,yg=null,!0):!1;default:return!1}}function Dg(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Eg(a){if(I){var s=yg;if(s){var o=s;if(!Cg(a,s)){if(Dg(a))throw Error(p$1(418));s=Lf(o.nextSibling);var j=xg;s&&Cg(a,s)?Ag(j,o):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p$1(418));a.flags=a.flags&-4097|2,I=!1,xg=a}}}function Fg(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;xg=a}function Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var s;if((s=a.tag!==3)&&!(s=a.tag!==5)&&(s=a.type,s=s!=="head"&&s!=="body"&&!Ef(a.type,a.memoizedProps)),s&&(s=yg)){if(Dg(a))throw Hg(),Error(p$1(418));for(;s;)Ag(a,s),s=Lf(s.nextSibling)}if(Fg(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(p$1(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8){var o=a.data;if(o==="/$"){if(s===0){yg=Lf(a.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++}a=a.nextSibling}yg=null}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(a){zg===null?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;function Lg(a,s){if(a&&a.defaultProps){s=A$1({},s),a=a.defaultProps;for(var o in a)s[o]===void 0&&(s[o]=a[o]);return s}return s}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(a){var s=Mg.current;E(Mg),a._currentValue=s}function Sg(a,s,o){for(;a!==null;){var j=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,j!==null&&(j.childLanes|=s)):j!==null&&(j.childLanes&s)!==s&&(j.childLanes|=s),a===o)break;a=a.return}}function Tg(a,s){Ng=a,Pg=Og=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&s&&(Ug=!0),a.firstContext=null)}function Vg(a){var s=a._currentValue;if(Pg!==a)if(a={context:a,memoizedValue:s,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=a,Ng.dependencies={lanes:0,firstContext:a}}else Og=Og.next=a;return s}var Wg=null;function Xg(a){Wg===null?Wg=[a]:Wg.push(a)}function Yg(a,s,o,j){var $=s.interleaved;return $===null?(o.next=o,Xg(s)):(o.next=$.next,$.next=o),s.interleaved=o,Zg(a,j)}function Zg(a,s){a.lanes|=s;var o=a.alternate;for(o!==null&&(o.lanes|=s),o=a,a=a.return;a!==null;)a.childLanes|=s,o=a.alternate,o!==null&&(o.childLanes|=s),o=a,a=a.return;return o.tag===3?o.stateNode:null}var $g=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ch(a,s){return{eventTime:a,lane:s,tag:0,payload:null,callback:null,next:null}}function dh(a,s,o){var j=a.updateQueue;if(j===null)return null;if(j=j.shared,K&2){var $=j.pending;return $===null?s.next=s:(s.next=$.next,$.next=s),j.pending=s,Zg(a,o)}return $=j.interleaved,$===null?(s.next=s,Xg(j)):(s.next=$.next,$.next=s),j.interleaved=s,Zg(a,o)}function eh(a,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194240)!==0)){var j=s.lanes;j&=a.pendingLanes,o|=j,s.lanes=o,Cc(a,o)}}function fh(a,s){var o=a.updateQueue,j=a.alternate;if(j!==null&&(j=j.updateQueue,o===j)){var $=null,_e=null;if(o=o.firstBaseUpdate,o!==null){do{var tt={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};_e===null?$=_e=tt:_e=_e.next=tt,o=o.next}while(o!==null);_e===null?$=_e=s:_e=_e.next=s}else $=_e=s;o={baseState:j.baseState,firstBaseUpdate:$,lastBaseUpdate:_e,shared:j.shared,effects:j.effects},a.updateQueue=o;return}a=o.lastBaseUpdate,a===null?o.firstBaseUpdate=s:a.next=s,o.lastBaseUpdate=s}function gh(a,s,o,j){var $=a.updateQueue;$g=!1;var _e=$.firstBaseUpdate,tt=$.lastBaseUpdate,nt=$.shared.pending;if(nt!==null){$.shared.pending=null;var rt=nt,it=rt.next;rt.next=null,tt===null?_e=it:tt.next=it,tt=rt;var st=a.alternate;st!==null&&(st=st.updateQueue,nt=st.lastBaseUpdate,nt!==tt&&(nt===null?st.firstBaseUpdate=it:nt.next=it,st.lastBaseUpdate=rt))}if(_e!==null){var at=$.baseState;tt=0,st=it=rt=null,nt=_e;do{var ot=nt.lane,ct=nt.eventTime;if((j&ot)===ot){st!==null&&(st=st.next={eventTime:ct,lane:0,tag:nt.tag,payload:nt.payload,callback:nt.callback,next:null});e:{var ft=a,ht=nt;switch(ot=s,ct=o,ht.tag){case 1:if(ft=ht.payload,typeof ft=="function"){at=ft.call(ct,at,ot);break e}at=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=ht.payload,ot=typeof ft=="function"?ft.call(ct,at,ot):ft,ot==null)break e;at=A$1({},at,ot);break e;case 2:$g=!0}}nt.callback!==null&&nt.lane!==0&&(a.flags|=64,ot=$.effects,ot===null?$.effects=[nt]:ot.push(nt))}else ct={eventTime:ct,lane:ot,tag:nt.tag,payload:nt.payload,callback:nt.callback,next:null},st===null?(it=st=ct,rt=at):st=st.next=ct,tt|=ot;if(nt=nt.next,nt===null){if(nt=$.shared.pending,nt===null)break;ot=nt,nt=ot.next,ot.next=null,$.lastBaseUpdate=ot,$.shared.pending=null}}while(1);if(st===null&&(rt=at),$.baseState=rt,$.firstBaseUpdate=it,$.lastBaseUpdate=st,s=$.shared.interleaved,s!==null){$=s;do tt|=$.lane,$=$.next;while($!==s)}else _e===null&&($.shared.lanes=0);hh|=tt,a.lanes=tt,a.memoizedState=at}}function ih(a,s,o){if(a=s.effects,s.effects=null,a!==null)for(s=0;s<a.length;s++){var j=a[s],$=j.callback;if($!==null){if(j.callback=null,j=o,typeof $!="function")throw Error(p$1(191,$));$.call(j)}}}var jh=new aa.Component().refs;function kh(a,s,o,j){s=a.memoizedState,o=o(j,s),o=o==null?s:A$1({},s,o),a.memoizedState=o,a.lanes===0&&(a.updateQueue.baseState=o)}var nh={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,s,o){a=a._reactInternals;var j=L(),$=lh(a),_e=ch(j,$);_e.payload=s,o!=null&&(_e.callback=o),s=dh(a,_e,$),s!==null&&(mh(s,a,$,j),eh(s,a,$))},enqueueReplaceState:function(a,s,o){a=a._reactInternals;var j=L(),$=lh(a),_e=ch(j,$);_e.tag=1,_e.payload=s,o!=null&&(_e.callback=o),s=dh(a,_e,$),s!==null&&(mh(s,a,$,j),eh(s,a,$))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var o=L(),j=lh(a),$=ch(o,j);$.tag=2,s!=null&&($.callback=s),s=dh(a,$,j),s!==null&&(mh(s,a,j,o),eh(s,a,j))}};function oh(a,s,o,j,$,_e,tt){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(j,_e,tt):s.prototype&&s.prototype.isPureReactComponent?!Ie(o,j)||!Ie($,_e):!0}function ph(a,s,o){var j=!1,$=Vf,_e=s.contextType;return typeof _e=="object"&&_e!==null?_e=Vg(_e):($=Zf(s)?Xf:H.current,j=s.contextTypes,_e=(j=j!=null)?Yf(a,$):Vf),s=new s(o,_e),a.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=nh,a.stateNode=s,s._reactInternals=a,j&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=$,a.__reactInternalMemoizedMaskedChildContext=_e),s}function qh(a,s,o,j){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,j),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,j),s.state!==a&&nh.enqueueReplaceState(s,s.state,null)}function rh(a,s,o,j){var $=a.stateNode;$.props=o,$.state=a.memoizedState,$.refs=jh,ah(a);var _e=s.contextType;typeof _e=="object"&&_e!==null?$.context=Vg(_e):(_e=Zf(s)?Xf:H.current,$.context=Yf(a,_e)),$.state=a.memoizedState,_e=s.getDerivedStateFromProps,typeof _e=="function"&&(kh(a,s,_e,o),$.state=a.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(s=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),s!==$.state&&nh.enqueueReplaceState($,$.state,null),gh(a,o,$,j),$.state=a.memoizedState),typeof $.componentDidMount=="function"&&(a.flags|=4194308)}function sh(a,s,o){if(a=o.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p$1(309));var j=o.stateNode}if(!j)throw Error(p$1(147,a));var $=j,_e=""+a;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===_e?s.ref:(s=function(tt){var nt=$.refs;nt===jh&&(nt=$.refs={}),tt===null?delete nt[_e]:nt[_e]=tt},s._stringRef=_e,s)}if(typeof a!="string")throw Error(p$1(284));if(!o._owner)throw Error(p$1(290,a))}return a}function th(a,s){throw a=Object.prototype.toString.call(s),Error(p$1(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a))}function uh(a){var s=a._init;return s(a._payload)}function vh(a){function s(lt,ut){if(a){var dt=lt.deletions;dt===null?(lt.deletions=[ut],lt.flags|=16):dt.push(ut)}}function o(lt,ut){if(!a)return null;for(;ut!==null;)s(lt,ut),ut=ut.sibling;return null}function j(lt,ut){for(lt=new Map;ut!==null;)ut.key!==null?lt.set(ut.key,ut):lt.set(ut.index,ut),ut=ut.sibling;return lt}function $(lt,ut){return lt=wh(lt,ut),lt.index=0,lt.sibling=null,lt}function _e(lt,ut,dt){return lt.index=dt,a?(dt=lt.alternate,dt!==null?(dt=dt.index,dt<ut?(lt.flags|=2,ut):dt):(lt.flags|=2,ut)):(lt.flags|=1048576,ut)}function tt(lt){return a&&lt.alternate===null&&(lt.flags|=2),lt}function nt(lt,ut,dt,gt){return ut===null||ut.tag!==6?(ut=xh(dt,lt.mode,gt),ut.return=lt,ut):(ut=$(ut,dt),ut.return=lt,ut)}function rt(lt,ut,dt,gt){var Et=dt.type;return Et===ya?st(lt,ut,dt.props.children,gt,dt.key):ut!==null&&(ut.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===Ha&&uh(Et)===ut.type)?(gt=$(ut,dt.props),gt.ref=sh(lt,ut,dt),gt.return=lt,gt):(gt=yh(dt.type,dt.key,dt.props,null,lt.mode,gt),gt.ref=sh(lt,ut,dt),gt.return=lt,gt)}function it(lt,ut,dt,gt){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==dt.containerInfo||ut.stateNode.implementation!==dt.implementation?(ut=zh$1(dt,lt.mode,gt),ut.return=lt,ut):(ut=$(ut,dt.children||[]),ut.return=lt,ut)}function st(lt,ut,dt,gt,Et){return ut===null||ut.tag!==7?(ut=Ah(dt,lt.mode,gt,Et),ut.return=lt,ut):(ut=$(ut,dt),ut.return=lt,ut)}function at(lt,ut,dt){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return ut=xh(""+ut,lt.mode,dt),ut.return=lt,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case va:return dt=yh(ut.type,ut.key,ut.props,null,lt.mode,dt),dt.ref=sh(lt,null,ut),dt.return=lt,dt;case wa:return ut=zh$1(ut,lt.mode,dt),ut.return=lt,ut;case Ha:var gt=ut._init;return at(lt,gt(ut._payload),dt)}if(eb(ut)||Ka(ut))return ut=Ah(ut,lt.mode,dt,null),ut.return=lt,ut;th(lt,ut)}return null}function ot(lt,ut,dt,gt){var Et=ut!==null?ut.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number")return Et!==null?null:nt(lt,ut,""+dt,gt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:return dt.key===Et?rt(lt,ut,dt,gt):null;case wa:return dt.key===Et?it(lt,ut,dt,gt):null;case Ha:return Et=dt._init,ot(lt,ut,Et(dt._payload),gt)}if(eb(dt)||Ka(dt))return Et!==null?null:st(lt,ut,dt,gt,null);th(lt,dt)}return null}function ct(lt,ut,dt,gt,Et){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return lt=lt.get(dt)||null,nt(ut,lt,""+gt,Et);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case va:return lt=lt.get(gt.key===null?dt:gt.key)||null,rt(ut,lt,gt,Et);case wa:return lt=lt.get(gt.key===null?dt:gt.key)||null,it(ut,lt,gt,Et);case Ha:var St=gt._init;return ct(lt,ut,dt,St(gt._payload),Et)}if(eb(gt)||Ka(gt))return lt=lt.get(dt)||null,st(ut,lt,gt,Et,null);th(ut,gt)}return null}function ft(lt,ut,dt,gt){for(var Et=null,St=null,Tt=ut,Mt=ut=0,Bt=null;Tt!==null&&Mt<dt.length;Mt++){Tt.index>Mt?(Bt=Tt,Tt=null):Bt=Tt.sibling;var Rt=ot(lt,Tt,dt[Mt],gt);if(Rt===null){Tt===null&&(Tt=Bt);break}a&&Tt&&Rt.alternate===null&&s(lt,Tt),ut=_e(Rt,ut,Mt),St===null?Et=Rt:St.sibling=Rt,St=Rt,Tt=Bt}if(Mt===dt.length)return o(lt,Tt),I&&tg(lt,Mt),Et;if(Tt===null){for(;Mt<dt.length;Mt++)Tt=at(lt,dt[Mt],gt),Tt!==null&&(ut=_e(Tt,ut,Mt),St===null?Et=Tt:St.sibling=Tt,St=Tt);return I&&tg(lt,Mt),Et}for(Tt=j(lt,Tt);Mt<dt.length;Mt++)Bt=ct(Tt,lt,Mt,dt[Mt],gt),Bt!==null&&(a&&Bt.alternate!==null&&Tt.delete(Bt.key===null?Mt:Bt.key),ut=_e(Bt,ut,Mt),St===null?Et=Bt:St.sibling=Bt,St=Bt);return a&&Tt.forEach(function(Ut){return s(lt,Ut)}),I&&tg(lt,Mt),Et}function ht(lt,ut,dt,gt){var Et=Ka(dt);if(typeof Et!="function")throw Error(p$1(150));if(dt=Et.call(dt),dt==null)throw Error(p$1(151));for(var St=Et=null,Tt=ut,Mt=ut=0,Bt=null,Rt=dt.next();Tt!==null&&!Rt.done;Mt++,Rt=dt.next()){Tt.index>Mt?(Bt=Tt,Tt=null):Bt=Tt.sibling;var Ut=ot(lt,Tt,Rt.value,gt);if(Ut===null){Tt===null&&(Tt=Bt);break}a&&Tt&&Ut.alternate===null&&s(lt,Tt),ut=_e(Ut,ut,Mt),St===null?Et=Ut:St.sibling=Ut,St=Ut,Tt=Bt}if(Rt.done)return o(lt,Tt),I&&tg(lt,Mt),Et;if(Tt===null){for(;!Rt.done;Mt++,Rt=dt.next())Rt=at(lt,Rt.value,gt),Rt!==null&&(ut=_e(Rt,ut,Mt),St===null?Et=Rt:St.sibling=Rt,St=Rt);return I&&tg(lt,Mt),Et}for(Tt=j(lt,Tt);!Rt.done;Mt++,Rt=dt.next())Rt=ct(Tt,lt,Mt,Rt.value,gt),Rt!==null&&(a&&Rt.alternate!==null&&Tt.delete(Rt.key===null?Mt:Rt.key),ut=_e(Rt,ut,Mt),St===null?Et=Rt:St.sibling=Rt,St=Rt);return a&&Tt.forEach(function(Ht){return s(lt,Ht)}),I&&tg(lt,Mt),Et}function mt(lt,ut,dt,gt){if(typeof dt=="object"&&dt!==null&&dt.type===ya&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:e:{for(var Et=dt.key,St=ut;St!==null;){if(St.key===Et){if(Et=dt.type,Et===ya){if(St.tag===7){o(lt,St.sibling),ut=$(St,dt.props.children),ut.return=lt,lt=ut;break e}}else if(St.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===Ha&&uh(Et)===St.type){o(lt,St.sibling),ut=$(St,dt.props),ut.ref=sh(lt,St,dt),ut.return=lt,lt=ut;break e}o(lt,St);break}else s(lt,St);St=St.sibling}dt.type===ya?(ut=Ah(dt.props.children,lt.mode,gt,dt.key),ut.return=lt,lt=ut):(gt=yh(dt.type,dt.key,dt.props,null,lt.mode,gt),gt.ref=sh(lt,ut,dt),gt.return=lt,lt=gt)}return tt(lt);case wa:e:{for(St=dt.key;ut!==null;){if(ut.key===St)if(ut.tag===4&&ut.stateNode.containerInfo===dt.containerInfo&&ut.stateNode.implementation===dt.implementation){o(lt,ut.sibling),ut=$(ut,dt.children||[]),ut.return=lt,lt=ut;break e}else{o(lt,ut);break}else s(lt,ut);ut=ut.sibling}ut=zh$1(dt,lt.mode,gt),ut.return=lt,lt=ut}return tt(lt);case Ha:return St=dt._init,mt(lt,ut,St(dt._payload),gt)}if(eb(dt))return ft(lt,ut,dt,gt);if(Ka(dt))return ht(lt,ut,dt,gt);th(lt,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"?(dt=""+dt,ut!==null&&ut.tag===6?(o(lt,ut.sibling),ut=$(ut,dt),ut.return=lt,lt=ut):(o(lt,ut),ut=xh(dt,lt.mode,gt),ut.return=lt,lt=ut),tt(lt)):o(lt,ut)}return mt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(a){if(a===Dh)throw Error(p$1(174));return a}function Ih(a,s){switch(G(Gh,s),G(Fh,a),G(Eh,Dh),a=s.nodeType,a){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:lb(null,"");break;default:a=a===8?s.parentNode:s,s=a.namespaceURI||null,a=a.tagName,s=lb(s,a)}E(Eh),G(Eh,s)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(a){Hh(Gh.current);var s=Hh(Eh.current),o=lb(s,a.type);s!==o&&(G(Fh,a),G(Eh,o))}function Lh(a){Fh.current===a&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(a){for(var s=a;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Nh=[];function Oh(){for(var a=0;a<Nh.length;a++)Nh[a]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p$1(321))}function Wh(a,s){if(s===null)return!1;for(var o=0;o<s.length&&o<a.length;o++)if(!He(a[o],s[o]))return!1;return!0}function Xh(a,s,o,j,$,_e){if(Rh=_e,N=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Ph.current=a===null||a.memoizedState===null?Yh:Zh,a=o(j,$),Th){_e=0;do{if(Th=!1,Uh=0,25<=_e)throw Error(p$1(301));_e+=1,P=O=null,s.updateQueue=null,Ph.current=$h,a=o(j,$)}while(Th)}if(Ph.current=ai,s=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,s)throw Error(p$1(300));return a}function bi(){var a=Uh!==0;return Uh=0,a}function ci(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=a:P=P.next=a,P}function di(){if(O===null){var a=N.alternate;a=a!==null?a.memoizedState:null}else a=O.next;var s=P===null?N.memoizedState:P.next;if(s!==null)P=s,O=a;else{if(a===null)throw Error(p$1(310));O=a,a={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=a:P=P.next=a}return P}function ei(a,s){return typeof s=="function"?s(a):s}function fi(a){var s=di(),o=s.queue;if(o===null)throw Error(p$1(311));o.lastRenderedReducer=a;var j=O,$=j.baseQueue,_e=o.pending;if(_e!==null){if($!==null){var tt=$.next;$.next=_e.next,_e.next=tt}j.baseQueue=$=_e,o.pending=null}if($!==null){_e=$.next,j=j.baseState;var nt=tt=null,rt=null,it=_e;do{var st=it.lane;if((Rh&st)===st)rt!==null&&(rt=rt.next={lane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),j=it.hasEagerState?it.eagerState:a(j,it.action);else{var at={lane:st,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null};rt===null?(nt=rt=at,tt=j):rt=rt.next=at,N.lanes|=st,hh|=st}it=it.next}while(it!==null&&it!==_e);rt===null?tt=j:rt.next=nt,He(j,s.memoizedState)||(Ug=!0),s.memoizedState=j,s.baseState=tt,s.baseQueue=rt,o.lastRenderedState=j}if(a=o.interleaved,a!==null){$=a;do _e=$.lane,N.lanes|=_e,hh|=_e,$=$.next;while($!==a)}else $===null&&(o.lanes=0);return[s.memoizedState,o.dispatch]}function gi(a){var s=di(),o=s.queue;if(o===null)throw Error(p$1(311));o.lastRenderedReducer=a;var j=o.dispatch,$=o.pending,_e=s.memoizedState;if($!==null){o.pending=null;var tt=$=$.next;do _e=a(_e,tt.action),tt=tt.next;while(tt!==$);He(_e,s.memoizedState)||(Ug=!0),s.memoizedState=_e,s.baseQueue===null&&(s.baseState=_e),o.lastRenderedState=_e}return[_e,j]}function hi(){}function ii(a,s){var o=N,j=di(),$=s(),_e=!He(j.memoizedState,$);if(_e&&(j.memoizedState=$,Ug=!0),j=j.queue,ji(ki.bind(null,o,j,a),[a]),j.getSnapshot!==s||_e||P!==null&&P.memoizedState.tag&1){if(o.flags|=2048,li(9,mi.bind(null,o,j,$,s),void 0,null),R===null)throw Error(p$1(349));Rh&30||ni(o,s,$)}return $}function ni(a,s,o){a.flags|=16384,a={getSnapshot:s,value:o},s=N.updateQueue,s===null?(s={lastEffect:null,stores:null},N.updateQueue=s,s.stores=[a]):(o=s.stores,o===null?s.stores=[a]:o.push(a))}function mi(a,s,o,j){s.value=o,s.getSnapshot=j,oi(s)&&pi(a)}function ki(a,s,o){return o(function(){oi(s)&&pi(a)})}function oi(a){var s=a.getSnapshot;a=a.value;try{var o=s();return!He(a,o)}catch{return!0}}function pi(a){var s=Zg(a,1);s!==null&&mh(s,a,1,-1)}function qi(a){var s=ci();return typeof a=="function"&&(a=a()),s.memoizedState=s.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:a},s.queue=a,a=a.dispatch=ri.bind(null,N,a),[s.memoizedState,a]}function li(a,s,o,j){return a={tag:a,create:s,destroy:o,deps:j,next:null},s=N.updateQueue,s===null?(s={lastEffect:null,stores:null},N.updateQueue=s,s.lastEffect=a.next=a):(o=s.lastEffect,o===null?s.lastEffect=a.next=a:(j=o.next,o.next=a,a.next=j,s.lastEffect=a)),a}function si(){return di().memoizedState}function ti(a,s,o,j){var $=ci();N.flags|=a,$.memoizedState=li(1|s,o,void 0,j===void 0?null:j)}function ui(a,s,o,j){var $=di();j=j===void 0?null:j;var _e=void 0;if(O!==null){var tt=O.memoizedState;if(_e=tt.destroy,j!==null&&Wh(j,tt.deps)){$.memoizedState=li(s,o,_e,j);return}}N.flags|=a,$.memoizedState=li(1|s,o,_e,j)}function vi(a,s){return ti(8390656,8,a,s)}function ji(a,s){return ui(2048,8,a,s)}function wi(a,s){return ui(4,2,a,s)}function xi(a,s){return ui(4,4,a,s)}function yi(a,s){if(typeof s=="function")return a=a(),s(a),function(){s(null)};if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function zi(a,s,o){return o=o!=null?o.concat([a]):null,ui(4,4,yi.bind(null,s,a),o)}function Ai(){}function Bi(a,s){var o=di();s=s===void 0?null:s;var j=o.memoizedState;return j!==null&&s!==null&&Wh(s,j[1])?j[0]:(o.memoizedState=[a,s],a)}function Ci(a,s){var o=di();s=s===void 0?null:s;var j=o.memoizedState;return j!==null&&s!==null&&Wh(s,j[1])?j[0]:(a=a(),o.memoizedState=[a,s],a)}function Di(a,s,o){return Rh&21?(He(o,s)||(o=yc(),N.lanes|=o,hh|=o,a.baseState=!0),s):(a.baseState&&(a.baseState=!1,Ug=!0),a.memoizedState=o)}function Ei(a,s){var o=C;C=o!==0&&4>o?o:4,a(!0);var j=Qh.transition;Qh.transition={};try{a(!1),s()}finally{C=o,Qh.transition=j}}function Fi(){return di().memoizedState}function Gi(a,s,o){var j=lh(a);if(o={lane:j,action:o,hasEagerState:!1,eagerState:null,next:null},Hi(a))Ii(s,o);else if(o=Yg(a,s,o,j),o!==null){var $=L();mh(o,a,j,$),Ji(o,s,j)}}function ri(a,s,o){var j=lh(a),$={lane:j,action:o,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(s,$);else{var _e=a.alternate;if(a.lanes===0&&(_e===null||_e.lanes===0)&&(_e=s.lastRenderedReducer,_e!==null))try{var tt=s.lastRenderedState,nt=_e(tt,o);if($.hasEagerState=!0,$.eagerState=nt,He(nt,tt)){var rt=s.interleaved;rt===null?($.next=$,Xg(s)):($.next=rt.next,rt.next=$),s.interleaved=$;return}}catch{}finally{}o=Yg(a,s,$,j),o!==null&&($=L(),mh(o,a,j,$),Ji(o,s,j))}}function Hi(a){var s=a.alternate;return a===N||s!==null&&s===N}function Ii(a,s){Th=Sh=!0;var o=a.pending;o===null?s.next=s:(s.next=o.next,o.next=s),a.pending=s}function Ji(a,s,o){if(o&4194240){var j=s.lanes;j&=a.pendingLanes,o|=j,s.lanes=o,Cc(a,o)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(a,s){return ci().memoizedState=[a,s===void 0?null:s],a},useContext:Vg,useEffect:vi,useImperativeHandle:function(a,s,o){return o=o!=null?o.concat([a]):null,ti(4194308,4,yi.bind(null,s,a),o)},useLayoutEffect:function(a,s){return ti(4194308,4,a,s)},useInsertionEffect:function(a,s){return ti(4,2,a,s)},useMemo:function(a,s){var o=ci();return s=s===void 0?null:s,a=a(),o.memoizedState=[a,s],a},useReducer:function(a,s,o){var j=ci();return s=o!==void 0?o(s):s,j.memoizedState=j.baseState=s,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:s},j.queue=a,a=a.dispatch=Gi.bind(null,N,a),[j.memoizedState,a]},useRef:function(a){var s=ci();return a={current:a},s.memoizedState=a},useState:qi,useDebugValue:Ai,useDeferredValue:function(a){return ci().memoizedState=a},useTransition:function(){var a=qi(!1),s=a[0];return a=Ei.bind(null,a[1]),ci().memoizedState=a,[s,a]},useMutableSource:function(){},useSyncExternalStore:function(a,s,o){var j=N,$=ci();if(I){if(o===void 0)throw Error(p$1(407));o=o()}else{if(o=s(),R===null)throw Error(p$1(349));Rh&30||ni(j,s,o)}$.memoizedState=o;var _e={value:o,getSnapshot:s};return $.queue=_e,vi(ki.bind(null,j,_e,a),[a]),j.flags|=2048,li(9,mi.bind(null,j,_e,o,s),void 0,null),o},useId:function(){var a=ci(),s=R.identifierPrefix;if(I){var o=sg,j=rg;o=(j&~(1<<32-oc(j)-1)).toString(32)+o,s=":"+s+"R"+o,o=Uh++,0<o&&(s+="H"+o.toString(32)),s+=":"}else o=Vh++,s=":"+s+"r"+o.toString(32)+":";return a.memoizedState=s},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var s=di();return Di(s,O.memoizedState,a)},useTransition:function(){var a=fi(ei)[0],s=di().memoizedState;return[a,s]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var s=di();return O===null?s.memoizedState=a:Di(s,O.memoizedState,a)},useTransition:function(){var a=gi(ei)[0],s=di().memoizedState;return[a,s]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(a,s){try{var o="",j=s;do o+=Pa(j),j=j.return;while(j);var $=o}catch(_e){$=`
Error generating stack: `+_e.message+`
`+_e.stack}return{value:a,source:s,stack:$,digest:null}}function Li(a,s,o){return{value:a,source:null,stack:o??null,digest:s??null}}function Mi(a,s){try{console.error(s.value)}catch(o){setTimeout(function(){throw o})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(a,s,o){o=ch(-1,o),o.tag=3,o.payload={element:null};var j=s.value;return o.callback=function(){Pi||(Pi=!0,Qi=j),Mi(a,s)},o}function Ri(a,s,o){o=ch(-1,o),o.tag=3;var j=a.type.getDerivedStateFromError;if(typeof j=="function"){var $=s.value;o.payload=function(){return j($)},o.callback=function(){Mi(a,s)}}var _e=a.stateNode;return _e!==null&&typeof _e.componentDidCatch=="function"&&(o.callback=function(){Mi(a,s),typeof j!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var tt=s.stack;this.componentDidCatch(s.value,{componentStack:tt!==null?tt:""})}),o}function Ti(a,s,o){var j=a.pingCache;if(j===null){j=a.pingCache=new Ni;var $=new Set;j.set(s,$)}else $=j.get(s),$===void 0&&($=new Set,j.set(s,$));$.has(o)||($.add(o),a=Ui.bind(null,a,s,o),s.then(a,a))}function Vi(a){do{var s;if((s=a.tag===13)&&(s=a.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return a;a=a.return}while(a!==null);return null}function Wi(a,s,o,j,$){return a.mode&1?(a.flags|=65536,a.lanes=$,a):(a===s?a.flags|=65536:(a.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(s=ch(-1,1),s.tag=2,dh(o,s,1))),o.lanes|=1),a)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(a,s,o,j){s.child=a===null?Ch(s,null,o,j):Bh(s,a.child,o,j)}function Zi(a,s,o,j,$){o=o.render;var _e=s.ref;return Tg(s,$),j=Xh(a,s,o,j,_e,$),o=bi(),a!==null&&!Ug?(s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~$,$i(a,s,$)):(I&&o&&vg(s),s.flags|=1,Yi(a,s,j,$),s.child)}function aj(a,s,o,j,$){if(a===null){var _e=o.type;return typeof _e=="function"&&!bj(_e)&&_e.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(s.tag=15,s.type=_e,cj(a,s,_e,j,$)):(a=yh(o.type,null,j,s,s.mode,$),a.ref=s.ref,a.return=s,s.child=a)}if(_e=a.child,!(a.lanes&$)){var tt=_e.memoizedProps;if(o=o.compare,o=o!==null?o:Ie,o(tt,j)&&a.ref===s.ref)return $i(a,s,$)}return s.flags|=1,a=wh(_e,j),a.ref=s.ref,a.return=s,s.child=a}function cj(a,s,o,j,$){if(a!==null){var _e=a.memoizedProps;if(Ie(_e,j)&&a.ref===s.ref)if(Ug=!1,s.pendingProps=j=_e,(a.lanes&$)!==0)a.flags&131072&&(Ug=!0);else return s.lanes=a.lanes,$i(a,s,$)}return dj(a,s,o,j,$)}function ej(a,s,o){var j=s.pendingProps,$=j.children,_e=a!==null?a.memoizedState:null;if(j.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=o;else{if(!(o&1073741824))return a=_e!==null?_e.baseLanes|o:o,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:a,cachePool:null,transitions:null},s.updateQueue=null,G(fj,gj),gj|=a,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=_e!==null?_e.baseLanes:o,G(fj,gj),gj|=j}else _e!==null?(j=_e.baseLanes|o,s.memoizedState=null):j=o,G(fj,gj),gj|=j;return Yi(a,s,$,o),s.child}function hj(a,s){var o=s.ref;(a===null&&o!==null||a!==null&&a.ref!==o)&&(s.flags|=512,s.flags|=2097152)}function dj(a,s,o,j,$){var _e=Zf(o)?Xf:H.current;return _e=Yf(s,_e),Tg(s,$),o=Xh(a,s,o,j,_e,$),j=bi(),a!==null&&!Ug?(s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~$,$i(a,s,$)):(I&&j&&vg(s),s.flags|=1,Yi(a,s,o,$),s.child)}function ij(a,s,o,j,$){if(Zf(o)){var _e=!0;cg(s)}else _e=!1;if(Tg(s,$),s.stateNode===null)jj(a,s),ph(s,o,j),rh(s,o,j,$),j=!0;else if(a===null){var tt=s.stateNode,nt=s.memoizedProps;tt.props=nt;var rt=tt.context,it=o.contextType;typeof it=="object"&&it!==null?it=Vg(it):(it=Zf(o)?Xf:H.current,it=Yf(s,it));var st=o.getDerivedStateFromProps,at=typeof st=="function"||typeof tt.getSnapshotBeforeUpdate=="function";at||typeof tt.UNSAFE_componentWillReceiveProps!="function"&&typeof tt.componentWillReceiveProps!="function"||(nt!==j||rt!==it)&&qh(s,tt,j,it),$g=!1;var ot=s.memoizedState;tt.state=ot,gh(s,j,tt,$),rt=s.memoizedState,nt!==j||ot!==rt||Wf.current||$g?(typeof st=="function"&&(kh(s,o,st,j),rt=s.memoizedState),(nt=$g||oh(s,o,nt,j,ot,rt,it))?(at||typeof tt.UNSAFE_componentWillMount!="function"&&typeof tt.componentWillMount!="function"||(typeof tt.componentWillMount=="function"&&tt.componentWillMount(),typeof tt.UNSAFE_componentWillMount=="function"&&tt.UNSAFE_componentWillMount()),typeof tt.componentDidMount=="function"&&(s.flags|=4194308)):(typeof tt.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=j,s.memoizedState=rt),tt.props=j,tt.state=rt,tt.context=it,j=nt):(typeof tt.componentDidMount=="function"&&(s.flags|=4194308),j=!1)}else{tt=s.stateNode,bh(a,s),nt=s.memoizedProps,it=s.type===s.elementType?nt:Lg(s.type,nt),tt.props=it,at=s.pendingProps,ot=tt.context,rt=o.contextType,typeof rt=="object"&&rt!==null?rt=Vg(rt):(rt=Zf(o)?Xf:H.current,rt=Yf(s,rt));var ct=o.getDerivedStateFromProps;(st=typeof ct=="function"||typeof tt.getSnapshotBeforeUpdate=="function")||typeof tt.UNSAFE_componentWillReceiveProps!="function"&&typeof tt.componentWillReceiveProps!="function"||(nt!==at||ot!==rt)&&qh(s,tt,j,rt),$g=!1,ot=s.memoizedState,tt.state=ot,gh(s,j,tt,$);var ft=s.memoizedState;nt!==at||ot!==ft||Wf.current||$g?(typeof ct=="function"&&(kh(s,o,ct,j),ft=s.memoizedState),(it=$g||oh(s,o,it,j,ot,ft,rt)||!1)?(st||typeof tt.UNSAFE_componentWillUpdate!="function"&&typeof tt.componentWillUpdate!="function"||(typeof tt.componentWillUpdate=="function"&&tt.componentWillUpdate(j,ft,rt),typeof tt.UNSAFE_componentWillUpdate=="function"&&tt.UNSAFE_componentWillUpdate(j,ft,rt)),typeof tt.componentDidUpdate=="function"&&(s.flags|=4),typeof tt.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof tt.componentDidUpdate!="function"||nt===a.memoizedProps&&ot===a.memoizedState||(s.flags|=4),typeof tt.getSnapshotBeforeUpdate!="function"||nt===a.memoizedProps&&ot===a.memoizedState||(s.flags|=1024),s.memoizedProps=j,s.memoizedState=ft),tt.props=j,tt.state=ft,tt.context=rt,j=it):(typeof tt.componentDidUpdate!="function"||nt===a.memoizedProps&&ot===a.memoizedState||(s.flags|=4),typeof tt.getSnapshotBeforeUpdate!="function"||nt===a.memoizedProps&&ot===a.memoizedState||(s.flags|=1024),j=!1)}return kj(a,s,o,j,_e,$)}function kj(a,s,o,j,$,_e){hj(a,s);var tt=(s.flags&128)!==0;if(!j&&!tt)return $&&dg(s,o,!1),$i(a,s,_e);j=s.stateNode,Xi.current=s;var nt=tt&&typeof o.getDerivedStateFromError!="function"?null:j.render();return s.flags|=1,a!==null&&tt?(s.child=Bh(s,a.child,null,_e),s.child=Bh(s,null,nt,_e)):Yi(a,s,nt,_e),s.memoizedState=j.state,$&&dg(s,o,!0),s.child}function lj(a){var s=a.stateNode;s.pendingContext?ag(a,s.pendingContext,s.pendingContext!==s.context):s.context&&ag(a,s.context,!1),Ih(a,s.containerInfo)}function mj(a,s,o,j,$){return Ig(),Jg($),s.flags|=256,Yi(a,s,o,j),s.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(a){return{baseLanes:a,cachePool:null,transitions:null}}function pj(a,s,o){var j=s.pendingProps,$=M.current,_e=!1,tt=(s.flags&128)!==0,nt;if((nt=tt)||(nt=a!==null&&a.memoizedState===null?!1:($&2)!==0),nt?(_e=!0,s.flags&=-129):(a===null||a.memoizedState!==null)&&($|=1),G(M,$&1),a===null)return Eg(s),a=s.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(s.mode&1?a.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(tt=j.children,a=j.fallback,_e?(j=s.mode,_e=s.child,tt={mode:"hidden",children:tt},!(j&1)&&_e!==null?(_e.childLanes=0,_e.pendingProps=tt):_e=qj(tt,j,0,null),a=Ah(a,j,o,null),_e.return=s,a.return=s,_e.sibling=a,s.child=_e,s.child.memoizedState=oj(o),s.memoizedState=nj,a):rj(s,tt));if($=a.memoizedState,$!==null&&(nt=$.dehydrated,nt!==null))return sj(a,s,tt,j,nt,$,o);if(_e){_e=j.fallback,tt=s.mode,$=a.child,nt=$.sibling;var rt={mode:"hidden",children:j.children};return!(tt&1)&&s.child!==$?(j=s.child,j.childLanes=0,j.pendingProps=rt,s.deletions=null):(j=wh($,rt),j.subtreeFlags=$.subtreeFlags&14680064),nt!==null?_e=wh(nt,_e):(_e=Ah(_e,tt,o,null),_e.flags|=2),_e.return=s,j.return=s,j.sibling=_e,s.child=j,j=_e,_e=s.child,tt=a.child.memoizedState,tt=tt===null?oj(o):{baseLanes:tt.baseLanes|o,cachePool:null,transitions:tt.transitions},_e.memoizedState=tt,_e.childLanes=a.childLanes&~o,s.memoizedState=nj,j}return _e=a.child,a=_e.sibling,j=wh(_e,{mode:"visible",children:j.children}),!(s.mode&1)&&(j.lanes=o),j.return=s,j.sibling=null,a!==null&&(o=s.deletions,o===null?(s.deletions=[a],s.flags|=16):o.push(a)),s.child=j,s.memoizedState=null,j}function rj(a,s){return s=qj({mode:"visible",children:s},a.mode,0,null),s.return=a,a.child=s}function tj(a,s,o,j){return j!==null&&Jg(j),Bh(s,a.child,null,o),a=rj(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function sj(a,s,o,j,$,_e,tt){if(o)return s.flags&256?(s.flags&=-257,j=Li(Error(p$1(422))),tj(a,s,tt,j)):s.memoizedState!==null?(s.child=a.child,s.flags|=128,null):(_e=j.fallback,$=s.mode,j=qj({mode:"visible",children:j.children},$,0,null),_e=Ah(_e,$,tt,null),_e.flags|=2,j.return=s,_e.return=s,j.sibling=_e,s.child=j,s.mode&1&&Bh(s,a.child,null,tt),s.child.memoizedState=oj(tt),s.memoizedState=nj,_e);if(!(s.mode&1))return tj(a,s,tt,null);if($.data==="$!"){if(j=$.nextSibling&&$.nextSibling.dataset,j)var nt=j.dgst;return j=nt,_e=Error(p$1(419)),j=Li(_e,j,void 0),tj(a,s,tt,j)}if(nt=(tt&a.childLanes)!==0,Ug||nt){if(j=R,j!==null){switch(tt&-tt){case 4:$=2;break;case 16:$=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:$=32;break;case 536870912:$=268435456;break;default:$=0}$=$&(j.suspendedLanes|tt)?0:$,$!==0&&$!==_e.retryLane&&(_e.retryLane=$,Zg(a,$),mh(j,a,$,-1))}return uj(),j=Li(Error(p$1(421))),tj(a,s,tt,j)}return $.data==="$?"?(s.flags|=128,s.child=a.child,s=vj.bind(null,a),$._reactRetry=s,null):(a=_e.treeContext,yg=Lf($.nextSibling),xg=s,I=!0,zg=null,a!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=s),s=rj(s,j.children),s.flags|=4096,s)}function wj(a,s,o){a.lanes|=s;var j=a.alternate;j!==null&&(j.lanes|=s),Sg(a.return,s,o)}function xj(a,s,o,j,$){var _e=a.memoizedState;_e===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:j,tail:o,tailMode:$}:(_e.isBackwards=s,_e.rendering=null,_e.renderingStartTime=0,_e.last=j,_e.tail=o,_e.tailMode=$)}function yj(a,s,o){var j=s.pendingProps,$=j.revealOrder,_e=j.tail;if(Yi(a,s,j.children,o),j=M.current,j&2)j=j&1|2,s.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&wj(a,o,s);else if(a.tag===19)wj(a,o,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}j&=1}if(G(M,j),!(s.mode&1))s.memoizedState=null;else switch($){case"forwards":for(o=s.child,$=null;o!==null;)a=o.alternate,a!==null&&Mh(a)===null&&($=o),o=o.sibling;o=$,o===null?($=s.child,s.child=null):($=o.sibling,o.sibling=null),xj(s,!1,$,o,_e);break;case"backwards":for(o=null,$=s.child,s.child=null;$!==null;){if(a=$.alternate,a!==null&&Mh(a)===null){s.child=$;break}a=$.sibling,$.sibling=o,o=$,$=a}xj(s,!0,o,null,_e);break;case"together":xj(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function jj(a,s){!(s.mode&1)&&a!==null&&(a.alternate=null,s.alternate=null,s.flags|=2)}function $i(a,s,o){if(a!==null&&(s.dependencies=a.dependencies),hh|=s.lanes,!(o&s.childLanes))return null;if(a!==null&&s.child!==a.child)throw Error(p$1(153));if(s.child!==null){for(a=s.child,o=wh(a,a.pendingProps),s.child=o,o.return=s;a.sibling!==null;)a=a.sibling,o=o.sibling=wh(a,a.pendingProps),o.return=s;o.sibling=null}return s.child}function zj(a,s,o){switch(s.tag){case 3:lj(s),Ig();break;case 5:Kh(s);break;case 1:Zf(s.type)&&cg(s);break;case 4:Ih(s,s.stateNode.containerInfo);break;case 10:var j=s.type._context,$=s.memoizedProps.value;G(Mg,j._currentValue),j._currentValue=$;break;case 13:if(j=s.memoizedState,j!==null)return j.dehydrated!==null?(G(M,M.current&1),s.flags|=128,null):o&s.child.childLanes?pj(a,s,o):(G(M,M.current&1),a=$i(a,s,o),a!==null?a.sibling:null);G(M,M.current&1);break;case 19:if(j=(o&s.childLanes)!==0,a.flags&128){if(j)return yj(a,s,o);s.flags|=128}if($=s.memoizedState,$!==null&&($.rendering=null,$.tail=null,$.lastEffect=null),G(M,M.current),j)break;return null;case 22:case 23:return s.lanes=0,ej(a,s,o)}return $i(a,s,o)}var Aj,Bj,Cj,Dj;Aj=function(a,s){for(var o=s.child;o!==null;){if(o.tag===5||o.tag===6)a.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Bj=function(){};Cj=function(a,s,o,j){var $=a.memoizedProps;if($!==j){a=s.stateNode,Hh(Eh.current);var _e=null;switch(o){case"input":$=Ya(a,$),j=Ya(a,j),_e=[];break;case"select":$=A$1({},$,{value:void 0}),j=A$1({},j,{value:void 0}),_e=[];break;case"textarea":$=gb(a,$),j=gb(a,j),_e=[];break;default:typeof $.onClick!="function"&&typeof j.onClick=="function"&&(a.onclick=Bf)}ub(o,j);var tt;o=null;for(it in $)if(!j.hasOwnProperty(it)&&$.hasOwnProperty(it)&&$[it]!=null)if(it==="style"){var nt=$[it];for(tt in nt)nt.hasOwnProperty(tt)&&(o||(o={}),o[tt]="")}else it!=="dangerouslySetInnerHTML"&&it!=="children"&&it!=="suppressContentEditableWarning"&&it!=="suppressHydrationWarning"&&it!=="autoFocus"&&(ea.hasOwnProperty(it)?_e||(_e=[]):(_e=_e||[]).push(it,null));for(it in j){var rt=j[it];if(nt=$!=null?$[it]:void 0,j.hasOwnProperty(it)&&rt!==nt&&(rt!=null||nt!=null))if(it==="style")if(nt){for(tt in nt)!nt.hasOwnProperty(tt)||rt&&rt.hasOwnProperty(tt)||(o||(o={}),o[tt]="");for(tt in rt)rt.hasOwnProperty(tt)&&nt[tt]!==rt[tt]&&(o||(o={}),o[tt]=rt[tt])}else o||(_e||(_e=[]),_e.push(it,o)),o=rt;else it==="dangerouslySetInnerHTML"?(rt=rt?rt.__html:void 0,nt=nt?nt.__html:void 0,rt!=null&&nt!==rt&&(_e=_e||[]).push(it,rt)):it==="children"?typeof rt!="string"&&typeof rt!="number"||(_e=_e||[]).push(it,""+rt):it!=="suppressContentEditableWarning"&&it!=="suppressHydrationWarning"&&(ea.hasOwnProperty(it)?(rt!=null&&it==="onScroll"&&D("scroll",a),_e||nt===rt||(_e=[])):(_e=_e||[]).push(it,rt))}o&&(_e=_e||[]).push("style",o);var it=_e;(s.updateQueue=it)&&(s.flags|=4)}};Dj=function(a,s,o,j){o!==j&&(s.flags|=4)};function Ej(a,s){if(!I)switch(a.tailMode){case"hidden":s=a.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?a.tail=null:o.sibling=null;break;case"collapsed":o=a.tail;for(var j=null;o!==null;)o.alternate!==null&&(j=o),o=o.sibling;j===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:j.sibling=null}}function S(a){var s=a.alternate!==null&&a.alternate.child===a.child,o=0,j=0;if(s)for(var $=a.child;$!==null;)o|=$.lanes|$.childLanes,j|=$.subtreeFlags&14680064,j|=$.flags&14680064,$.return=a,$=$.sibling;else for($=a.child;$!==null;)o|=$.lanes|$.childLanes,j|=$.subtreeFlags,j|=$.flags,$.return=a,$=$.sibling;return a.subtreeFlags|=j,a.childLanes=o,s}function Fj(a,s,o){var j=s.pendingProps;switch(wg(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(s),null;case 1:return Zf(s.type)&&$f(),S(s),null;case 3:return j=s.stateNode,Jh(),E(Wf),E(H),Oh(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(a===null||a.child===null)&&(Gg(s)?s.flags|=4:a===null||a.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(a,s),S(s),null;case 5:Lh(s);var $=Hh(Gh.current);if(o=s.type,a!==null&&s.stateNode!=null)Cj(a,s,o,j,$),a.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!j){if(s.stateNode===null)throw Error(p$1(166));return S(s),null}if(a=Hh(Eh.current),Gg(s)){j=s.stateNode,o=s.type;var _e=s.memoizedProps;switch(j[Of]=s,j[Pf]=_e,a=(s.mode&1)!==0,o){case"dialog":D("cancel",j),D("close",j);break;case"iframe":case"object":case"embed":D("load",j);break;case"video":case"audio":for($=0;$<lf.length;$++)D(lf[$],j);break;case"source":D("error",j);break;case"img":case"image":case"link":D("error",j),D("load",j);break;case"details":D("toggle",j);break;case"input":Za(j,_e),D("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!_e.multiple},D("invalid",j);break;case"textarea":hb(j,_e),D("invalid",j)}ub(o,_e),$=null;for(var tt in _e)if(_e.hasOwnProperty(tt)){var nt=_e[tt];tt==="children"?typeof nt=="string"?j.textContent!==nt&&(_e.suppressHydrationWarning!==!0&&Af(j.textContent,nt,a),$=["children",nt]):typeof nt=="number"&&j.textContent!==""+nt&&(_e.suppressHydrationWarning!==!0&&Af(j.textContent,nt,a),$=["children",""+nt]):ea.hasOwnProperty(tt)&&nt!=null&&tt==="onScroll"&&D("scroll",j)}switch(o){case"input":Va(j),db(j,_e,!0);break;case"textarea":Va(j),jb(j);break;case"select":case"option":break;default:typeof _e.onClick=="function"&&(j.onclick=Bf)}j=$,s.updateQueue=j,j!==null&&(s.flags|=4)}else{tt=$.nodeType===9?$:$.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kb(o)),a==="http://www.w3.org/1999/xhtml"?o==="script"?(a=tt.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof j.is=="string"?a=tt.createElement(o,{is:j.is}):(a=tt.createElement(o),o==="select"&&(tt=a,j.multiple?tt.multiple=!0:j.size&&(tt.size=j.size))):a=tt.createElementNS(a,o),a[Of]=s,a[Pf]=j,Aj(a,s,!1,!1),s.stateNode=a;e:{switch(tt=vb(o,j),o){case"dialog":D("cancel",a),D("close",a),$=j;break;case"iframe":case"object":case"embed":D("load",a),$=j;break;case"video":case"audio":for($=0;$<lf.length;$++)D(lf[$],a);$=j;break;case"source":D("error",a),$=j;break;case"img":case"image":case"link":D("error",a),D("load",a),$=j;break;case"details":D("toggle",a),$=j;break;case"input":Za(a,j),$=Ya(a,j),D("invalid",a);break;case"option":$=j;break;case"select":a._wrapperState={wasMultiple:!!j.multiple},$=A$1({},j,{value:void 0}),D("invalid",a);break;case"textarea":hb(a,j),$=gb(a,j),D("invalid",a);break;default:$=j}ub(o,$),nt=$;for(_e in nt)if(nt.hasOwnProperty(_e)){var rt=nt[_e];_e==="style"?sb(a,rt):_e==="dangerouslySetInnerHTML"?(rt=rt?rt.__html:void 0,rt!=null&&nb(a,rt)):_e==="children"?typeof rt=="string"?(o!=="textarea"||rt!=="")&&ob(a,rt):typeof rt=="number"&&ob(a,""+rt):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(ea.hasOwnProperty(_e)?rt!=null&&_e==="onScroll"&&D("scroll",a):rt!=null&&ta(a,_e,rt,tt))}switch(o){case"input":Va(a),db(a,j,!1);break;case"textarea":Va(a),jb(a);break;case"option":j.value!=null&&a.setAttribute("value",""+Sa(j.value));break;case"select":a.multiple=!!j.multiple,_e=j.value,_e!=null?fb(a,!!j.multiple,_e,!1):j.defaultValue!=null&&fb(a,!!j.multiple,j.defaultValue,!0);break;default:typeof $.onClick=="function"&&(a.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return S(s),null;case 6:if(a&&s.stateNode!=null)Dj(a,s,a.memoizedProps,j);else{if(typeof j!="string"&&s.stateNode===null)throw Error(p$1(166));if(o=Hh(Gh.current),Hh(Eh.current),Gg(s)){if(j=s.stateNode,o=s.memoizedProps,j[Of]=s,(_e=j.nodeValue!==o)&&(a=xg,a!==null))switch(a.tag){case 3:Af(j.nodeValue,o,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Af(j.nodeValue,o,(a.mode&1)!==0)}_e&&(s.flags|=4)}else j=(o.nodeType===9?o:o.ownerDocument).createTextNode(j),j[Of]=s,s.stateNode=j}return S(s),null;case 13:if(E(M),j=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I&&yg!==null&&s.mode&1&&!(s.flags&128))Hg(),Ig(),s.flags|=98560,_e=!1;else if(_e=Gg(s),j!==null&&j.dehydrated!==null){if(a===null){if(!_e)throw Error(p$1(318));if(_e=s.memoizedState,_e=_e!==null?_e.dehydrated:null,!_e)throw Error(p$1(317));_e[Of]=s}else Ig(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;S(s),_e=!1}else zg!==null&&(Gj(zg),zg=null),_e=!0;if(!_e)return s.flags&65536?s:null}return s.flags&128?(s.lanes=o,s):(j=j!==null,j!==(a!==null&&a.memoizedState!==null)&&j&&(s.child.flags|=8192,s.mode&1&&(a===null||M.current&1?T===0&&(T=3):uj())),s.updateQueue!==null&&(s.flags|=4),S(s),null);case 4:return Jh(),Bj(a,s),a===null&&sf(s.stateNode.containerInfo),S(s),null;case 10:return Rg(s.type._context),S(s),null;case 17:return Zf(s.type)&&$f(),S(s),null;case 19:if(E(M),_e=s.memoizedState,_e===null)return S(s),null;if(j=(s.flags&128)!==0,tt=_e.rendering,tt===null)if(j)Ej(_e,!1);else{if(T!==0||a!==null&&a.flags&128)for(a=s.child;a!==null;){if(tt=Mh(a),tt!==null){for(s.flags|=128,Ej(_e,!1),j=tt.updateQueue,j!==null&&(s.updateQueue=j,s.flags|=4),s.subtreeFlags=0,j=o,o=s.child;o!==null;)_e=o,a=j,_e.flags&=14680066,tt=_e.alternate,tt===null?(_e.childLanes=0,_e.lanes=a,_e.child=null,_e.subtreeFlags=0,_e.memoizedProps=null,_e.memoizedState=null,_e.updateQueue=null,_e.dependencies=null,_e.stateNode=null):(_e.childLanes=tt.childLanes,_e.lanes=tt.lanes,_e.child=tt.child,_e.subtreeFlags=0,_e.deletions=null,_e.memoizedProps=tt.memoizedProps,_e.memoizedState=tt.memoizedState,_e.updateQueue=tt.updateQueue,_e.type=tt.type,a=tt.dependencies,_e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),o=o.sibling;return G(M,M.current&1|2),s.child}a=a.sibling}_e.tail!==null&&B()>Hj&&(s.flags|=128,j=!0,Ej(_e,!1),s.lanes=4194304)}else{if(!j)if(a=Mh(tt),a!==null){if(s.flags|=128,j=!0,o=a.updateQueue,o!==null&&(s.updateQueue=o,s.flags|=4),Ej(_e,!0),_e.tail===null&&_e.tailMode==="hidden"&&!tt.alternate&&!I)return S(s),null}else 2*B()-_e.renderingStartTime>Hj&&o!==1073741824&&(s.flags|=128,j=!0,Ej(_e,!1),s.lanes=4194304);_e.isBackwards?(tt.sibling=s.child,s.child=tt):(o=_e.last,o!==null?o.sibling=tt:s.child=tt,_e.last=tt)}return _e.tail!==null?(s=_e.tail,_e.rendering=s,_e.tail=s.sibling,_e.renderingStartTime=B(),s.sibling=null,o=M.current,G(M,j?o&1|2:o&1),s):(S(s),null);case 22:case 23:return Ij(),j=s.memoizedState!==null,a!==null&&a.memoizedState!==null!==j&&(s.flags|=8192),j&&s.mode&1?gj&1073741824&&(S(s),s.subtreeFlags&6&&(s.flags|=8192)):S(s),null;case 24:return null;case 25:return null}throw Error(p$1(156,s.tag))}function Jj(a,s){switch(wg(s),s.tag){case 1:return Zf(s.type)&&$f(),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Jh(),E(Wf),E(H),Oh(),a=s.flags,a&65536&&!(a&128)?(s.flags=a&-65537|128,s):null;case 5:return Lh(s),null;case 13:if(E(M),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(p$1(340));Ig()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(s.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(a,s){var o=a.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(j){W(a,s,j)}else o.current=null}function Nj(a,s,o){try{o()}catch(j){W(a,s,j)}}var Oj=!1;function Pj(a,s){if(Cf=dd,a=Me(),Ne(a)){if("selectionStart"in a)var o={start:a.selectionStart,end:a.selectionEnd};else e:{o=(o=a.ownerDocument)&&o.defaultView||window;var j=o.getSelection&&o.getSelection();if(j&&j.rangeCount!==0){o=j.anchorNode;var $=j.anchorOffset,_e=j.focusNode;j=j.focusOffset;try{o.nodeType,_e.nodeType}catch{o=null;break e}var tt=0,nt=-1,rt=-1,it=0,st=0,at=a,ot=null;t:for(;;){for(var ct;at!==o||$!==0&&at.nodeType!==3||(nt=tt+$),at!==_e||j!==0&&at.nodeType!==3||(rt=tt+j),at.nodeType===3&&(tt+=at.nodeValue.length),(ct=at.firstChild)!==null;)ot=at,at=ct;for(;;){if(at===a)break t;if(ot===o&&++it===$&&(nt=tt),ot===_e&&++st===j&&(rt=tt),(ct=at.nextSibling)!==null)break;at=ot,ot=at.parentNode}at=ct}o=nt===-1||rt===-1?null:{start:nt,end:rt}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:a,selectionRange:o},dd=!1,V=s;V!==null;)if(s=V,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,V=a;else for(;V!==null;){s=V;try{var ft=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var ht=ft.memoizedProps,mt=ft.memoizedState,lt=s.stateNode,ut=lt.getSnapshotBeforeUpdate(s.elementType===s.type?ht:Lg(s.type,ht),mt);lt.__reactInternalSnapshotBeforeUpdate=ut}break;case 3:var dt=s.stateNode.containerInfo;dt.nodeType===1?dt.textContent="":dt.nodeType===9&&dt.documentElement&&dt.removeChild(dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(gt){W(s,s.return,gt)}if(a=s.sibling,a!==null){a.return=s.return,V=a;break}V=s.return}return ft=Oj,Oj=!1,ft}function Qj(a,s,o){var j=s.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var $=j=j.next;do{if(($.tag&a)===a){var _e=$.destroy;$.destroy=void 0,_e!==void 0&&Nj(s,o,_e)}$=$.next}while($!==j)}}function Rj(a,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&a)===a){var j=o.create;o.destroy=j()}o=o.next}while(o!==s)}}function Sj(a){var s=a.ref;if(s!==null){var o=a.stateNode;switch(a.tag){case 5:a=o;break;default:a=o}typeof s=="function"?s(a):s.current=a}}function Tj(a){var s=a.alternate;s!==null&&(a.alternate=null,Tj(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&(delete s[Of],delete s[Pf],delete s[of],delete s[Qf],delete s[Rf])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Uj(a){return a.tag===5||a.tag===3||a.tag===4}function Vj(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Uj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Wj(a,s,o){var j=a.tag;if(j===5||j===6)a=a.stateNode,s?o.nodeType===8?o.parentNode.insertBefore(a,s):o.insertBefore(a,s):(o.nodeType===8?(s=o.parentNode,s.insertBefore(a,o)):(s=o,s.appendChild(a)),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Bf));else if(j!==4&&(a=a.child,a!==null))for(Wj(a,s,o),a=a.sibling;a!==null;)Wj(a,s,o),a=a.sibling}function Xj(a,s,o){var j=a.tag;if(j===5||j===6)a=a.stateNode,s?o.insertBefore(a,s):o.appendChild(a);else if(j!==4&&(a=a.child,a!==null))for(Xj(a,s,o),a=a.sibling;a!==null;)Xj(a,s,o),a=a.sibling}var X=null,Yj=!1;function Zj(a,s,o){for(o=o.child;o!==null;)ak(a,s,o),o=o.sibling}function ak(a,s,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U||Mj(o,s);case 6:var j=X,$=Yj;X=null,Zj(a,s,o),X=j,Yj=$,X!==null&&(Yj?(a=X,o=o.stateNode,a.nodeType===8?a.parentNode.removeChild(o):a.removeChild(o)):X.removeChild(o.stateNode));break;case 18:X!==null&&(Yj?(a=X,o=o.stateNode,a.nodeType===8?Kf(a.parentNode,o):a.nodeType===1&&Kf(a,o),bd(a)):Kf(X,o.stateNode));break;case 4:j=X,$=Yj,X=o.stateNode.containerInfo,Yj=!0,Zj(a,s,o),X=j,Yj=$;break;case 0:case 11:case 14:case 15:if(!U&&(j=o.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){$=j=j.next;do{var _e=$,tt=_e.destroy;_e=_e.tag,tt!==void 0&&(_e&2||_e&4)&&Nj(o,s,tt),$=$.next}while($!==j)}Zj(a,s,o);break;case 1:if(!U&&(Mj(o,s),j=o.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=o.memoizedProps,j.state=o.memoizedState,j.componentWillUnmount()}catch(nt){W(o,s,nt)}Zj(a,s,o);break;case 21:Zj(a,s,o);break;case 22:o.mode&1?(U=(j=U)||o.memoizedState!==null,Zj(a,s,o),U=j):Zj(a,s,o);break;default:Zj(a,s,o)}}function bk(a){var s=a.updateQueue;if(s!==null){a.updateQueue=null;var o=a.stateNode;o===null&&(o=a.stateNode=new Lj),s.forEach(function(j){var $=ck.bind(null,a,j);o.has(j)||(o.add(j),j.then($,$))})}}function dk(a,s){var o=s.deletions;if(o!==null)for(var j=0;j<o.length;j++){var $=o[j];try{var _e=a,tt=s,nt=tt;e:for(;nt!==null;){switch(nt.tag){case 5:X=nt.stateNode,Yj=!1;break e;case 3:X=nt.stateNode.containerInfo,Yj=!0;break e;case 4:X=nt.stateNode.containerInfo,Yj=!0;break e}nt=nt.return}if(X===null)throw Error(p$1(160));ak(_e,tt,$),X=null,Yj=!1;var rt=$.alternate;rt!==null&&(rt.return=null),$.return=null}catch(it){W($,s,it)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)ek(s,a),s=s.sibling}function ek(a,s){var o=a.alternate,j=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(dk(s,a),fk(a),j&4){try{Qj(3,a,a.return),Rj(3,a)}catch(ht){W(a,a.return,ht)}try{Qj(5,a,a.return)}catch(ht){W(a,a.return,ht)}}break;case 1:dk(s,a),fk(a),j&512&&o!==null&&Mj(o,o.return);break;case 5:if(dk(s,a),fk(a),j&512&&o!==null&&Mj(o,o.return),a.flags&32){var $=a.stateNode;try{ob($,"")}catch(ht){W(a,a.return,ht)}}if(j&4&&($=a.stateNode,$!=null)){var _e=a.memoizedProps,tt=o!==null?o.memoizedProps:_e,nt=a.type,rt=a.updateQueue;if(a.updateQueue=null,rt!==null)try{nt==="input"&&_e.type==="radio"&&_e.name!=null&&ab($,_e),vb(nt,tt);var it=vb(nt,_e);for(tt=0;tt<rt.length;tt+=2){var st=rt[tt],at=rt[tt+1];st==="style"?sb($,at):st==="dangerouslySetInnerHTML"?nb($,at):st==="children"?ob($,at):ta($,st,at,it)}switch(nt){case"input":bb($,_e);break;case"textarea":ib($,_e);break;case"select":var ot=$._wrapperState.wasMultiple;$._wrapperState.wasMultiple=!!_e.multiple;var ct=_e.value;ct!=null?fb($,!!_e.multiple,ct,!1):ot!==!!_e.multiple&&(_e.defaultValue!=null?fb($,!!_e.multiple,_e.defaultValue,!0):fb($,!!_e.multiple,_e.multiple?[]:"",!1))}$[Pf]=_e}catch(ht){W(a,a.return,ht)}}break;case 6:if(dk(s,a),fk(a),j&4){if(a.stateNode===null)throw Error(p$1(162));$=a.stateNode,_e=a.memoizedProps;try{$.nodeValue=_e}catch(ht){W(a,a.return,ht)}}break;case 3:if(dk(s,a),fk(a),j&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(s.containerInfo)}catch(ht){W(a,a.return,ht)}break;case 4:dk(s,a),fk(a);break;case 13:dk(s,a),fk(a),$=a.child,$.flags&8192&&(_e=$.memoizedState!==null,$.stateNode.isHidden=_e,!_e||$.alternate!==null&&$.alternate.memoizedState!==null||(gk=B())),j&4&&bk(a);break;case 22:if(st=o!==null&&o.memoizedState!==null,a.mode&1?(U=(it=U)||st,dk(s,a),U=it):dk(s,a),fk(a),j&8192){if(it=a.memoizedState!==null,(a.stateNode.isHidden=it)&&!st&&a.mode&1)for(V=a,st=a.child;st!==null;){for(at=V=st;V!==null;){switch(ot=V,ct=ot.child,ot.tag){case 0:case 11:case 14:case 15:Qj(4,ot,ot.return);break;case 1:Mj(ot,ot.return);var ft=ot.stateNode;if(typeof ft.componentWillUnmount=="function"){j=ot,o=ot.return;try{s=j,ft.props=s.memoizedProps,ft.state=s.memoizedState,ft.componentWillUnmount()}catch(ht){W(j,o,ht)}}break;case 5:Mj(ot,ot.return);break;case 22:if(ot.memoizedState!==null){hk(at);continue}}ct!==null?(ct.return=ot,V=ct):hk(at)}st=st.sibling}e:for(st=null,at=a;;){if(at.tag===5){if(st===null){st=at;try{$=at.stateNode,it?(_e=$.style,typeof _e.setProperty=="function"?_e.setProperty("display","none","important"):_e.display="none"):(nt=at.stateNode,rt=at.memoizedProps.style,tt=rt!=null&&rt.hasOwnProperty("display")?rt.display:null,nt.style.display=rb("display",tt))}catch(ht){W(a,a.return,ht)}}}else if(at.tag===6){if(st===null)try{at.stateNode.nodeValue=it?"":at.memoizedProps}catch(ht){W(a,a.return,ht)}}else if((at.tag!==22&&at.tag!==23||at.memoizedState===null||at===a)&&at.child!==null){at.child.return=at,at=at.child;continue}if(at===a)break e;for(;at.sibling===null;){if(at.return===null||at.return===a)break e;st===at&&(st=null),at=at.return}st===at&&(st=null),at.sibling.return=at.return,at=at.sibling}}break;case 19:dk(s,a),fk(a),j&4&&bk(a);break;case 21:break;default:dk(s,a),fk(a)}}function fk(a){var s=a.flags;if(s&2){try{e:{for(var o=a.return;o!==null;){if(Uj(o)){var j=o;break e}o=o.return}throw Error(p$1(160))}switch(j.tag){case 5:var $=j.stateNode;j.flags&32&&(ob($,""),j.flags&=-33);var _e=Vj(a);Xj(a,_e,$);break;case 3:case 4:var tt=j.stateNode.containerInfo,nt=Vj(a);Wj(a,nt,tt);break;default:throw Error(p$1(161))}}catch(rt){W(a,a.return,rt)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function ik(a,s,o){V=a,jk(a)}function jk(a,s,o){for(var j=(a.mode&1)!==0;V!==null;){var $=V,_e=$.child;if($.tag===22&&j){var tt=$.memoizedState!==null||Kj;if(!tt){var nt=$.alternate,rt=nt!==null&&nt.memoizedState!==null||U;nt=Kj;var it=U;if(Kj=tt,(U=rt)&&!it)for(V=$;V!==null;)tt=V,rt=tt.child,tt.tag===22&&tt.memoizedState!==null?kk($):rt!==null?(rt.return=tt,V=rt):kk($);for(;_e!==null;)V=_e,jk(_e),_e=_e.sibling;V=$,Kj=nt,U=it}lk(a)}else $.subtreeFlags&8772&&_e!==null?(_e.return=$,V=_e):lk(a)}}function lk(a){for(;V!==null;){var s=V;if(s.flags&8772){var o=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:U||Rj(5,s);break;case 1:var j=s.stateNode;if(s.flags&4&&!U)if(o===null)j.componentDidMount();else{var $=s.elementType===s.type?o.memoizedProps:Lg(s.type,o.memoizedProps);j.componentDidUpdate($,o.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var _e=s.updateQueue;_e!==null&&ih(s,_e,j);break;case 3:var tt=s.updateQueue;if(tt!==null){if(o=null,s.child!==null)switch(s.child.tag){case 5:o=s.child.stateNode;break;case 1:o=s.child.stateNode}ih(s,tt,o)}break;case 5:var nt=s.stateNode;if(o===null&&s.flags&4){o=nt;var rt=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":rt.autoFocus&&o.focus();break;case"img":rt.src&&(o.src=rt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var it=s.alternate;if(it!==null){var st=it.memoizedState;if(st!==null){var at=st.dehydrated;at!==null&&bd(at)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||s.flags&512&&Sj(s)}catch(ot){W(s,s.return,ot)}}if(s===a){V=null;break}if(o=s.sibling,o!==null){o.return=s.return,V=o;break}V=s.return}}function hk(a){for(;V!==null;){var s=V;if(s===a){V=null;break}var o=s.sibling;if(o!==null){o.return=s.return,V=o;break}V=s.return}}function kk(a){for(;V!==null;){var s=V;try{switch(s.tag){case 0:case 11:case 15:var o=s.return;try{Rj(4,s)}catch(rt){W(s,o,rt)}break;case 1:var j=s.stateNode;if(typeof j.componentDidMount=="function"){var $=s.return;try{j.componentDidMount()}catch(rt){W(s,$,rt)}}var _e=s.return;try{Sj(s)}catch(rt){W(s,_e,rt)}break;case 5:var tt=s.return;try{Sj(s)}catch(rt){W(s,tt,rt)}}}catch(rt){W(s,s.return,rt)}if(s===a){V=null;break}var nt=s.sibling;if(nt!==null){nt.return=s.return,V=nt;break}V=s.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(a){return a.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(a=C,a!==0||(a=window.event,a=a===void 0?16:jd(a.type)),a):1}function mh(a,s,o,j){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac(a,o,j),(!(K&2)||a!==R)&&(a===R&&(!(K&2)&&(rk|=o),T===4&&Dk(a,Z)),Ek(a,j),o===1&&K===0&&!(s.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(a,s){var o=a.callbackNode;wc(a,s);var j=uc(a,a===R?Z:0);if(j===0)o!==null&&bc(o),a.callbackNode=null,a.callbackPriority=0;else if(s=j&-j,a.callbackPriority!==s){if(o!=null&&bc(o),s===1)a.tag===0?ig(Fk.bind(null,a)):hg(Fk.bind(null,a)),Jf(function(){!(K&6)&&jg()}),o=null;else{switch(Dc(j)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Gk(o,Hk.bind(null,a))}a.callbackPriority=s,a.callbackNode=o}}function Hk(a,s){if(Bk=-1,Ck=0,K&6)throw Error(p$1(327));var o=a.callbackNode;if(Ik()&&a.callbackNode!==o)return null;var j=uc(a,a===R?Z:0);if(j===0)return null;if(j&30||j&a.expiredLanes||s)s=Jk(a,j);else{s=j;var $=K;K|=2;var _e=Kk();(R!==a||Z!==s)&&(vk=null,Hj=B()+500,Lk(a,s));do try{Mk();break}catch(nt){Nk(a,nt)}while(1);Qg(),nk.current=_e,K=$,Y!==null?s=0:(R=null,Z=0,s=T)}if(s!==0){if(s===2&&($=xc(a),$!==0&&(j=$,s=Ok(a,$))),s===1)throw o=qk,Lk(a,0),Dk(a,j),Ek(a,B()),o;if(s===6)Dk(a,j);else{if($=a.current.alternate,!(j&30)&&!Pk($)&&(s=Jk(a,j),s===2&&(_e=xc(a),_e!==0&&(j=_e,s=Ok(a,_e))),s===1))throw o=qk,Lk(a,0),Dk(a,j),Ek(a,B()),o;switch(a.finishedWork=$,a.finishedLanes=j,s){case 0:case 1:throw Error(p$1(345));case 2:Qk(a,uk,vk);break;case 3:if(Dk(a,j),(j&130023424)===j&&(s=gk+500-B(),10<s)){if(uc(a,0)!==0)break;if($=a.suspendedLanes,($&j)!==j){L(),a.pingedLanes|=a.suspendedLanes&$;break}a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),s);break}Qk(a,uk,vk);break;case 4:if(Dk(a,j),(j&4194240)===j)break;for(s=a.eventTimes,$=-1;0<j;){var tt=31-oc(j);_e=1<<tt,tt=s[tt],tt>$&&($=tt),j&=~_e}if(j=$,j=B()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*mk(j/1960))-j,10<j){a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),j);break}Qk(a,uk,vk);break;case 5:Qk(a,uk,vk);break;default:throw Error(p$1(329))}}}return Ek(a,B()),a.callbackNode===o?Hk.bind(null,a):null}function Ok(a,s){var o=tk;return a.current.memoizedState.isDehydrated&&(Lk(a,s).flags|=256),a=Jk(a,s),a!==2&&(s=uk,uk=o,s!==null&&Gj(s)),a}function Gj(a){uk===null?uk=a:uk.push.apply(uk,a)}function Pk(a){for(var s=a;;){if(s.flags&16384){var o=s.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var j=0;j<o.length;j++){var $=o[j],_e=$.getSnapshot;$=$.value;try{if(!He(_e(),$))return!1}catch{return!1}}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Dk(a,s){for(s&=~sk,s&=~rk,a.suspendedLanes|=s,a.pingedLanes&=~s,a=a.expirationTimes;0<s;){var o=31-oc(s),j=1<<o;a[o]=-1,s&=~j}}function Fk(a){if(K&6)throw Error(p$1(327));Ik();var s=uc(a,0);if(!(s&1))return Ek(a,B()),null;var o=Jk(a,s);if(a.tag!==0&&o===2){var j=xc(a);j!==0&&(s=j,o=Ok(a,j))}if(o===1)throw o=qk,Lk(a,0),Dk(a,s),Ek(a,B()),o;if(o===6)throw Error(p$1(345));return a.finishedWork=a.current.alternate,a.finishedLanes=s,Qk(a,uk,vk),Ek(a,B()),null}function Rk(a,s){var o=K;K|=1;try{return a(s)}finally{K=o,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(a){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var s=K;K|=1;var o=pk.transition,j=C;try{if(pk.transition=null,C=1,a)return a()}finally{C=j,pk.transition=o,K=s,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(a,s){a.finishedWork=null,a.finishedLanes=0;var o=a.timeoutHandle;if(o!==-1&&(a.timeoutHandle=-1,Gf(o)),Y!==null)for(o=Y.return;o!==null;){var j=o;switch(wg(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(j);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(j.type._context);break;case 22:case 23:Ij()}o=o.return}if(R=a,Y=a=wh(a.current,null),Z=gj=s,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(s=0;s<Wg.length;s++)if(o=Wg[s],j=o.interleaved,j!==null){o.interleaved=null;var $=j.next,_e=o.pending;if(_e!==null){var tt=_e.next;_e.next=$,j.next=tt}o.pending=j}Wg=null}return a}function Nk(a,s){do{var o=Y;try{if(Qg(),Ph.current=ai,Sh){for(var j=N.memoizedState;j!==null;){var $=j.queue;$!==null&&($.pending=null),j=j.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,o===null||o.return===null){T=1,qk=s,Y=null;break}e:{var _e=a,tt=o.return,nt=o,rt=s;if(s=Z,nt.flags|=32768,rt!==null&&typeof rt=="object"&&typeof rt.then=="function"){var it=rt,st=nt,at=st.tag;if(!(st.mode&1)&&(at===0||at===11||at===15)){var ot=st.alternate;ot?(st.updateQueue=ot.updateQueue,st.memoizedState=ot.memoizedState,st.lanes=ot.lanes):(st.updateQueue=null,st.memoizedState=null)}var ct=Vi(tt);if(ct!==null){ct.flags&=-257,Wi(ct,tt,nt,_e,s),ct.mode&1&&Ti(_e,it,s),s=ct,rt=it;var ft=s.updateQueue;if(ft===null){var ht=new Set;ht.add(rt),s.updateQueue=ht}else ft.add(rt);break e}else{if(!(s&1)){Ti(_e,it,s),uj();break e}rt=Error(p$1(426))}}else if(I&&nt.mode&1){var mt=Vi(tt);if(mt!==null){!(mt.flags&65536)&&(mt.flags|=256),Wi(mt,tt,nt,_e,s),Jg(Ki(rt,nt));break e}}_e=rt=Ki(rt,nt),T!==4&&(T=2),tk===null?tk=[_e]:tk.push(_e),_e=tt;do{switch(_e.tag){case 3:_e.flags|=65536,s&=-s,_e.lanes|=s;var lt=Oi(_e,rt,s);fh(_e,lt);break e;case 1:nt=rt;var ut=_e.type,dt=_e.stateNode;if(!(_e.flags&128)&&(typeof ut.getDerivedStateFromError=="function"||dt!==null&&typeof dt.componentDidCatch=="function"&&(Si===null||!Si.has(dt)))){_e.flags|=65536,s&=-s,_e.lanes|=s;var gt=Ri(_e,nt,s);fh(_e,gt);break e}}_e=_e.return}while(_e!==null)}Tk(o)}catch(Et){s=Et,Y===o&&o!==null&&(Y=o=o.return);continue}break}while(1)}function Kk(){var a=nk.current;return nk.current=ai,a===null?ai:a}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk(a,s){var o=K;K|=2;var j=Kk();(R!==a||Z!==s)&&(vk=null,Lk(a,s));do try{Uk();break}catch($){Nk(a,$)}while(1);if(Qg(),K=o,nk.current=j,Y!==null)throw Error(p$1(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(a){var s=Wk(a.alternate,a,gj);a.memoizedProps=a.pendingProps,s===null?Tk(a):Y=s,ok.current=null}function Tk(a){var s=a;do{var o=s.alternate;if(a=s.return,s.flags&32768){if(o=Jj(o,s),o!==null){o.flags&=32767,Y=o;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6,Y=null;return}}else if(o=Fj(o,s,gj),o!==null){Y=o;return}if(s=s.sibling,s!==null){Y=s;return}Y=s=a}while(s!==null);T===0&&(T=5)}function Qk(a,s,o){var j=C,$=pk.transition;try{pk.transition=null,C=1,Xk(a,s,o,j)}finally{pk.transition=$,C=j}return null}function Xk(a,s,o,j){do Ik();while(xk!==null);if(K&6)throw Error(p$1(327));o=a.finishedWork;var $=a.finishedLanes;if(o===null)return null;if(a.finishedWork=null,a.finishedLanes=0,o===a.current)throw Error(p$1(177));a.callbackNode=null,a.callbackPriority=0;var _e=o.lanes|o.childLanes;if(Bc(a,_e),a===R&&(Y=R=null,Z=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),_e=(o.flags&15990)!==0,o.subtreeFlags&15990||_e){_e=pk.transition,pk.transition=null;var tt=C;C=1;var nt=K;K|=4,ok.current=null,Pj(a,o),ek(o,a),Oe(Df),dd=!!Cf,Df=Cf=null,a.current=o,ik(o),dc(),K=nt,C=tt,pk.transition=_e}else a.current=o;if(wk&&(wk=!1,xk=a,yk=$),_e=a.pendingLanes,_e===0&&(Si=null),mc(o.stateNode),Ek(a,B()),s!==null)for(j=a.onRecoverableError,o=0;o<s.length;o++)$=s[o],j($.value,{componentStack:$.stack,digest:$.digest});if(Pi)throw Pi=!1,a=Qi,Qi=null,a;return yk&1&&a.tag!==0&&Ik(),_e=a.pendingLanes,_e&1?a===Ak?zk++:(zk=0,Ak=a):zk=0,jg(),null}function Ik(){if(xk!==null){var a=Dc(yk),s=pk.transition,o=C;try{if(pk.transition=null,C=16>a?16:a,xk===null)var j=!1;else{if(a=xk,xk=null,yk=0,K&6)throw Error(p$1(331));var $=K;for(K|=4,V=a.current;V!==null;){var _e=V,tt=_e.child;if(V.flags&16){var nt=_e.deletions;if(nt!==null){for(var rt=0;rt<nt.length;rt++){var it=nt[rt];for(V=it;V!==null;){var st=V;switch(st.tag){case 0:case 11:case 15:Qj(8,st,_e)}var at=st.child;if(at!==null)at.return=st,V=at;else for(;V!==null;){st=V;var ot=st.sibling,ct=st.return;if(Tj(st),st===it){V=null;break}if(ot!==null){ot.return=ct,V=ot;break}V=ct}}}var ft=_e.alternate;if(ft!==null){var ht=ft.child;if(ht!==null){ft.child=null;do{var mt=ht.sibling;ht.sibling=null,ht=mt}while(ht!==null)}}V=_e}}if(_e.subtreeFlags&2064&&tt!==null)tt.return=_e,V=tt;else e:for(;V!==null;){if(_e=V,_e.flags&2048)switch(_e.tag){case 0:case 11:case 15:Qj(9,_e,_e.return)}var lt=_e.sibling;if(lt!==null){lt.return=_e.return,V=lt;break e}V=_e.return}}var ut=a.current;for(V=ut;V!==null;){tt=V;var dt=tt.child;if(tt.subtreeFlags&2064&&dt!==null)dt.return=tt,V=dt;else e:for(tt=ut;V!==null;){if(nt=V,nt.flags&2048)try{switch(nt.tag){case 0:case 11:case 15:Rj(9,nt)}}catch(Et){W(nt,nt.return,Et)}if(nt===tt){V=null;break e}var gt=nt.sibling;if(gt!==null){gt.return=nt.return,V=gt;break e}V=nt.return}}if(K=$,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,a)}catch{}j=!0}return j}finally{C=o,pk.transition=s}}return!1}function Yk(a,s,o){s=Ki(o,s),s=Oi(a,s,1),a=dh(a,s,1),s=L(),a!==null&&(Ac(a,1,s),Ek(a,s))}function W(a,s,o){if(a.tag===3)Yk(a,a,o);else for(;s!==null;){if(s.tag===3){Yk(s,a,o);break}else if(s.tag===1){var j=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Si===null||!Si.has(j))){a=Ki(o,a),a=Ri(s,a,1),s=dh(s,a,1),a=L(),s!==null&&(Ac(s,1,a),Ek(s,a));break}}s=s.return}}function Ui(a,s,o){var j=a.pingCache;j!==null&&j.delete(s),s=L(),a.pingedLanes|=a.suspendedLanes&o,R===a&&(Z&o)===o&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(a,0):sk|=o),Ek(a,s)}function Zk(a,s){s===0&&(a.mode&1?(s=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):s=1);var o=L();a=Zg(a,s),a!==null&&(Ac(a,s,o),Ek(a,o))}function vj(a){var s=a.memoizedState,o=0;s!==null&&(o=s.retryLane),Zk(a,o)}function ck(a,s){var o=0;switch(a.tag){case 13:var j=a.stateNode,$=a.memoizedState;$!==null&&(o=$.retryLane);break;case 19:j=a.stateNode;break;default:throw Error(p$1(314))}j!==null&&j.delete(s),Zk(a,o)}var Wk;Wk=function(a,s,o){if(a!==null)if(a.memoizedProps!==s.pendingProps||Wf.current)Ug=!0;else{if(!(a.lanes&o)&&!(s.flags&128))return Ug=!1,zj(a,s,o);Ug=!!(a.flags&131072)}else Ug=!1,I&&s.flags&1048576&&ug(s,ng,s.index);switch(s.lanes=0,s.tag){case 2:var j=s.type;jj(a,s),a=s.pendingProps;var $=Yf(s,H.current);Tg(s,o),$=Xh(null,s,j,a,$,o);var _e=bi();return s.flags|=1,typeof $=="object"&&$!==null&&typeof $.render=="function"&&$.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Zf(j)?(_e=!0,cg(s)):_e=!1,s.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,ah(s),$.updater=nh,s.stateNode=$,$._reactInternals=s,rh(s,j,a,o),s=kj(null,s,j,!0,_e,o)):(s.tag=0,I&&_e&&vg(s),Yi(null,s,$,o),s=s.child),s;case 16:j=s.elementType;e:{switch(jj(a,s),a=s.pendingProps,$=j._init,j=$(j._payload),s.type=j,$=s.tag=$k(j),a=Lg(j,a),$){case 0:s=dj(null,s,j,a,o);break e;case 1:s=ij(null,s,j,a,o);break e;case 11:s=Zi(null,s,j,a,o);break e;case 14:s=aj(null,s,j,Lg(j.type,a),o);break e}throw Error(p$1(306,j,""))}return s;case 0:return j=s.type,$=s.pendingProps,$=s.elementType===j?$:Lg(j,$),dj(a,s,j,$,o);case 1:return j=s.type,$=s.pendingProps,$=s.elementType===j?$:Lg(j,$),ij(a,s,j,$,o);case 3:e:{if(lj(s),a===null)throw Error(p$1(387));j=s.pendingProps,_e=s.memoizedState,$=_e.element,bh(a,s),gh(s,j,null,o);var tt=s.memoizedState;if(j=tt.element,_e.isDehydrated)if(_e={element:j,isDehydrated:!1,cache:tt.cache,pendingSuspenseBoundaries:tt.pendingSuspenseBoundaries,transitions:tt.transitions},s.updateQueue.baseState=_e,s.memoizedState=_e,s.flags&256){$=Ki(Error(p$1(423)),s),s=mj(a,s,j,o,$);break e}else if(j!==$){$=Ki(Error(p$1(424)),s),s=mj(a,s,j,o,$);break e}else for(yg=Lf(s.stateNode.containerInfo.firstChild),xg=s,I=!0,zg=null,o=Ch(s,null,j,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),j===$){s=$i(a,s,o);break e}Yi(a,s,j,o)}s=s.child}return s;case 5:return Kh(s),a===null&&Eg(s),j=s.type,$=s.pendingProps,_e=a!==null?a.memoizedProps:null,tt=$.children,Ef(j,$)?tt=null:_e!==null&&Ef(j,_e)&&(s.flags|=32),hj(a,s),Yi(a,s,tt,o),s.child;case 6:return a===null&&Eg(s),null;case 13:return pj(a,s,o);case 4:return Ih(s,s.stateNode.containerInfo),j=s.pendingProps,a===null?s.child=Bh(s,null,j,o):Yi(a,s,j,o),s.child;case 11:return j=s.type,$=s.pendingProps,$=s.elementType===j?$:Lg(j,$),Zi(a,s,j,$,o);case 7:return Yi(a,s,s.pendingProps,o),s.child;case 8:return Yi(a,s,s.pendingProps.children,o),s.child;case 12:return Yi(a,s,s.pendingProps.children,o),s.child;case 10:e:{if(j=s.type._context,$=s.pendingProps,_e=s.memoizedProps,tt=$.value,G(Mg,j._currentValue),j._currentValue=tt,_e!==null)if(He(_e.value,tt)){if(_e.children===$.children&&!Wf.current){s=$i(a,s,o);break e}}else for(_e=s.child,_e!==null&&(_e.return=s);_e!==null;){var nt=_e.dependencies;if(nt!==null){tt=_e.child;for(var rt=nt.firstContext;rt!==null;){if(rt.context===j){if(_e.tag===1){rt=ch(-1,o&-o),rt.tag=2;var it=_e.updateQueue;if(it!==null){it=it.shared;var st=it.pending;st===null?rt.next=rt:(rt.next=st.next,st.next=rt),it.pending=rt}}_e.lanes|=o,rt=_e.alternate,rt!==null&&(rt.lanes|=o),Sg(_e.return,o,s),nt.lanes|=o;break}rt=rt.next}}else if(_e.tag===10)tt=_e.type===s.type?null:_e.child;else if(_e.tag===18){if(tt=_e.return,tt===null)throw Error(p$1(341));tt.lanes|=o,nt=tt.alternate,nt!==null&&(nt.lanes|=o),Sg(tt,o,s),tt=_e.sibling}else tt=_e.child;if(tt!==null)tt.return=_e;else for(tt=_e;tt!==null;){if(tt===s){tt=null;break}if(_e=tt.sibling,_e!==null){_e.return=tt.return,tt=_e;break}tt=tt.return}_e=tt}Yi(a,s,$.children,o),s=s.child}return s;case 9:return $=s.type,j=s.pendingProps.children,Tg(s,o),$=Vg($),j=j($),s.flags|=1,Yi(a,s,j,o),s.child;case 14:return j=s.type,$=Lg(j,s.pendingProps),$=Lg(j.type,$),aj(a,s,j,$,o);case 15:return cj(a,s,s.type,s.pendingProps,o);case 17:return j=s.type,$=s.pendingProps,$=s.elementType===j?$:Lg(j,$),jj(a,s),s.tag=1,Zf(j)?(a=!0,cg(s)):a=!1,Tg(s,o),ph(s,j,$),rh(s,j,$,o),kj(null,s,j,!0,a,o);case 19:return yj(a,s,o);case 22:return ej(a,s,o)}throw Error(p$1(156,s.tag))};function Gk(a,s){return ac(a,s)}function al(a,s,o,j){this.tag=a,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(a,s,o,j){return new al(a,s,o,j)}function bj(a){return a=a.prototype,!(!a||!a.isReactComponent)}function $k(a){if(typeof a=="function")return bj(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Da)return 11;if(a===Ga)return 14}return 2}function wh(a,s){var o=a.alternate;return o===null?(o=Bg(a.tag,s,a.key,a.mode),o.elementType=a.elementType,o.type=a.type,o.stateNode=a.stateNode,o.alternate=a,a.alternate=o):(o.pendingProps=s,o.type=a.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=a.flags&14680064,o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,s=a.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=a.sibling,o.index=a.index,o.ref=a.ref,o}function yh(a,s,o,j,$,_e){var tt=2;if(j=a,typeof a=="function")bj(a)&&(tt=1);else if(typeof a=="string")tt=5;else e:switch(a){case ya:return Ah(o.children,$,_e,s);case za:tt=8,$|=8;break;case Aa:return a=Bg(12,o,s,$|2),a.elementType=Aa,a.lanes=_e,a;case Ea:return a=Bg(13,o,s,$),a.elementType=Ea,a.lanes=_e,a;case Fa:return a=Bg(19,o,s,$),a.elementType=Fa,a.lanes=_e,a;case Ia:return qj(o,$,_e,s);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Ba:tt=10;break e;case Ca:tt=9;break e;case Da:tt=11;break e;case Ga:tt=14;break e;case Ha:tt=16,j=null;break e}throw Error(p$1(130,a==null?a:typeof a,""))}return s=Bg(tt,o,s,$),s.elementType=a,s.type=j,s.lanes=_e,s}function Ah(a,s,o,j){return a=Bg(7,a,j,s),a.lanes=o,a}function qj(a,s,o,j){return a=Bg(22,a,j,s),a.elementType=Ia,a.lanes=o,a.stateNode={isHidden:!1},a}function xh(a,s,o){return a=Bg(6,a,null,s),a.lanes=o,a}function zh$1(a,s,o){return s=Bg(4,a.children!==null?a.children:[],a.key,s),s.lanes=o,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}function bl(a,s,o,j,$){this.tag=s,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=j,this.onRecoverableError=$,this.mutableSourceEagerHydrationData=null}function cl(a,s,o,j,$,_e,tt,nt,rt){return a=new bl(a,s,o,nt,rt),s===1?(s=1,_e===!0&&(s|=8)):s=0,_e=Bg(3,null,null,s),a.current=_e,_e.stateNode=a,_e.memoizedState={element:j,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(_e),a}function dl(a,s,o){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:j==null?null:""+j,children:a,containerInfo:s,implementation:o}}function el(a){if(!a)return Vf;a=a._reactInternals;e:{if(Vb(a)!==a||a.tag!==1)throw Error(p$1(170));var s=a;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Zf(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(p$1(171))}if(a.tag===1){var o=a.type;if(Zf(o))return bg(a,o,s)}return s}function fl$1(a,s,o,j,$,_e,tt,nt,rt){return a=cl(o,j,!0,a,$,_e,tt,nt,rt),a.context=el(null),o=a.current,j=L(),$=lh(o),_e=ch(j,$),_e.callback=s??null,dh(o,_e,$),a.current.lanes=$,Ac(a,$,j),Ek(a,j),a}function gl(a,s,o,j){var $=s.current,_e=L(),tt=lh($);return o=el(o),s.context===null?s.context=o:s.pendingContext=o,s=ch(_e,tt),s.payload={element:a},j=j===void 0?null:j,j!==null&&(s.callback=j),a=dh($,s,tt),a!==null&&(mh(a,$,tt,_e),eh(a,$,tt)),tt}function hl(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function il(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var o=a.retryLane;a.retryLane=o!==0&&o<s?o:s}}function jl(a,s){il(a,s),(a=a.alternate)&&il(a,s)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(a){console.error(a)};function ml(a){this._internalRoot=a}nl.prototype.render=ml.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(p$1(409));gl(a,s,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;Sk(function(){gl(null,a,null,null)}),s[uf]=null}};function nl(a){this._internalRoot=a}nl.prototype.unstable_scheduleHydration=function(a){if(a){var s=Hc();a={blockedOn:null,target:a,priority:s};for(var o=0;o<Qc.length&&s!==0&&s<Qc[o].priority;o++);Qc.splice(o,0,a),o===0&&Vc(a)}};function ol(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function pl(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(a,s,o,j,$){if($){if(typeof j=="function"){var _e=j;j=function(){var it=hl(tt);_e.call(it)}}var tt=fl$1(s,j,a,0,null,!1,!1,"",ql);return a._reactRootContainer=tt,a[uf]=tt.current,sf(a.nodeType===8?a.parentNode:a),Sk(),tt}for(;$=a.lastChild;)a.removeChild($);if(typeof j=="function"){var nt=j;j=function(){var it=hl(rt);nt.call(it)}}var rt=cl(a,0,!1,null,null,!1,!1,"",ql);return a._reactRootContainer=rt,a[uf]=rt.current,sf(a.nodeType===8?a.parentNode:a),Sk(function(){gl(s,rt,o,j)}),rt}function sl(a,s,o,j,$){var _e=o._reactRootContainer;if(_e){var tt=_e;if(typeof $=="function"){var nt=$;$=function(){var rt=hl(tt);nt.call(rt)}}gl(s,tt,a,$)}else tt=rl(o,s,a,$,j);return hl(tt)}Ec=function(a){switch(a.tag){case 3:var s=a.stateNode;if(s.current.memoizedState.isDehydrated){var o=tc(s.pendingLanes);o!==0&&(Cc(s,o|1),Ek(s,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var j=Zg(a,1);if(j!==null){var $=L();mh(j,a,1,$)}}),jl(a,1)}};Fc=function(a){if(a.tag===13){var s=Zg(a,134217728);if(s!==null){var o=L();mh(s,a,134217728,o)}jl(a,134217728)}};Gc=function(a){if(a.tag===13){var s=lh(a),o=Zg(a,s);if(o!==null){var j=L();mh(o,a,s,j)}jl(a,s)}};Hc=function(){return C};Ic=function(a,s){var o=C;try{return C=a,s()}finally{C=o}};yb=function(a,s,o){switch(s){case"input":if(bb(a,o),s=o.name,o.type==="radio"&&s!=null){for(o=a;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<o.length;s++){var j=o[s];if(j!==a&&j.form===a.form){var $=Db(j);if(!$)throw Error(p$1(90));Wa(j),bb(j,$)}}}break;case"textarea":ib(a,o);break;case"select":s=o.value,s!=null&&fb(a,!!o.multiple,s,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Zb(a),a===null?null:a.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(a,s){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(s))throw Error(p$1(200));return dl(a,s,null,o)};reactDom_production_min.createRoot=function(a,s){if(!ol(a))throw Error(p$1(299));var o=!1,j="",$=ll;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(j=s.identifierPrefix),s.onRecoverableError!==void 0&&($=s.onRecoverableError)),s=cl(a,1,!1,null,null,o,!1,j,$),a[uf]=s.current,sf(a.nodeType===8?a.parentNode:a),new ml(s)};reactDom_production_min.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(p$1(188)):(a=Object.keys(a).join(","),Error(p$1(268,a)));return a=Zb(s),a=a===null?null:a.stateNode,a};reactDom_production_min.flushSync=function(a){return Sk(a)};reactDom_production_min.hydrate=function(a,s,o){if(!pl(s))throw Error(p$1(200));return sl(null,a,s,!0,o)};reactDom_production_min.hydrateRoot=function(a,s,o){if(!ol(a))throw Error(p$1(405));var j=o!=null&&o.hydratedSources||null,$=!1,_e="",tt=ll;if(o!=null&&(o.unstable_strictMode===!0&&($=!0),o.identifierPrefix!==void 0&&(_e=o.identifierPrefix),o.onRecoverableError!==void 0&&(tt=o.onRecoverableError)),s=fl$1(s,null,a,1,o??null,$,!1,_e,tt),a[uf]=s.current,sf(a),j)for(a=0;a<j.length;a++)o=j[a],$=o._getVersion,$=$(o._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[o,$]:s.mutableSourceEagerHydrationData.push(o,$);return new nl(s)};reactDom_production_min.render=function(a,s,o){if(!pl(s))throw Error(p$1(200));return sl(null,a,s,!1,o)};reactDom_production_min.unmountComponentAtNode=function(a){if(!pl(a))throw Error(p$1(40));return a._reactRootContainer?(Sk(function(){sl(null,null,a,!1,function(){a._reactRootContainer=null,a[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(a,s,o,j){if(!pl(o))throw Error(p$1(200));if(a==null||a._reactInternals===void 0)throw Error(p$1(38));return sl(a,s,o,!1,j)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(a){function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(o){console.error(o)}}s(),a.exports=reactDom_production_min})(reactDom);var m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="153",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,TwoPassDoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",_SRGBAFormat=1035,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(s,o){this._listeners===void 0&&(this._listeners={});const j=this._listeners;j[s]===void 0&&(j[s]=[]),j[s].indexOf(o)===-1&&j[s].push(o)}hasEventListener(s,o){if(this._listeners===void 0)return!1;const j=this._listeners;return j[s]!==void 0&&j[s].indexOf(o)!==-1}removeEventListener(s,o){if(this._listeners===void 0)return;const $=this._listeners[s];if($!==void 0){const _e=$.indexOf(o);_e!==-1&&$.splice(_e,1)}}dispatchEvent(s){if(this._listeners===void 0)return;const j=this._listeners[s.type];if(j!==void 0){s.target=this;const $=j.slice(0);for(let _e=0,tt=$.length;_e<tt;_e++)$[_e].call(this,s);s.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const a=Math.random()*4294967295|0,s=Math.random()*4294967295|0,o=Math.random()*4294967295|0,j=Math.random()*4294967295|0;return(_lut[a&255]+_lut[a>>8&255]+_lut[a>>16&255]+_lut[a>>24&255]+"-"+_lut[s&255]+_lut[s>>8&255]+"-"+_lut[s>>16&15|64]+_lut[s>>24&255]+"-"+_lut[o&63|128]+_lut[o>>8&255]+"-"+_lut[o>>16&255]+_lut[o>>24&255]+_lut[j&255]+_lut[j>>8&255]+_lut[j>>16&255]+_lut[j>>24&255]).toLowerCase()}function clamp$2(a,s,o){return Math.max(s,Math.min(o,a))}function euclideanModulo(a,s){return(a%s+s)%s}function mapLinear(a,s,o,j,$){return j+(a-s)*($-j)/(o-s)}function inverseLerp(a,s,o){return a!==s?(o-a)/(s-a):0}function lerp(a,s,o){return(1-o)*a+o*s}function damp(a,s,o,j){return lerp(a,s,1-Math.exp(-o*j))}function pingpong(a,s=1){return s-Math.abs(euclideanModulo(a,s*2)-s)}function smoothstep(a,s,o){return a<=s?0:a>=o?1:(a=(a-s)/(o-s),a*a*(3-2*a))}function smootherstep(a,s,o){return a<=s?0:a>=o?1:(a=(a-s)/(o-s),a*a*a*(a*(a*6-15)+10))}function randInt(a,s){return a+Math.floor(Math.random()*(s-a+1))}function randFloat(a,s){return a+Math.random()*(s-a)}function randFloatSpread(a){return a*(.5-Math.random())}function seededRandom(a){a!==void 0&&(_seed=a);let s=_seed+=1831565813;return s=Math.imul(s^s>>>15,s|1),s^=s+Math.imul(s^s>>>7,s|61),((s^s>>>14)>>>0)/4294967296}function degToRad(a){return a*DEG2RAD}function radToDeg(a){return a*RAD2DEG}function isPowerOfTwo(a){return(a&a-1)===0&&a!==0}function ceilPowerOfTwo(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function floorPowerOfTwo(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function setQuaternionFromProperEuler(a,s,o,j,$){const _e=Math.cos,tt=Math.sin,nt=_e(o/2),rt=tt(o/2),it=_e((s+j)/2),st=tt((s+j)/2),at=_e((s-j)/2),ot=tt((s-j)/2),ct=_e((j-s)/2),ft=tt((j-s)/2);switch($){case"XYX":a.set(nt*st,rt*at,rt*ot,nt*it);break;case"YZY":a.set(rt*ot,nt*st,rt*at,nt*it);break;case"ZXZ":a.set(rt*at,rt*ot,nt*st,nt*it);break;case"XZX":a.set(nt*st,rt*ft,rt*ct,nt*it);break;case"YXY":a.set(rt*ct,nt*st,rt*ft,nt*it);break;case"ZYZ":a.set(rt*ft,rt*ct,nt*st,nt*it);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+$)}}function denormalize(a,s){switch(s.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw new Error("Invalid component type.")}}function normalize(a,s){switch(s.constructor){case Float32Array:return a;case Uint32Array:return Math.round(a*4294967295);case Uint16Array:return Math.round(a*65535);case Uint8Array:return Math.round(a*255);case Int32Array:return Math.round(a*2147483647);case Int16Array:return Math.round(a*32767);case Int8Array:return Math.round(a*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp:clamp$2,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(s=0,o=0){Vector2.prototype.isVector2=!0,this.x=s,this.y=o}get width(){return this.x}set width(s){this.x=s}get height(){return this.y}set height(s){this.y=s}set(s,o){return this.x=s,this.y=o,this}setScalar(s){return this.x=s,this.y=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setComponent(s,o){switch(s){case 0:this.x=o;break;case 1:this.y=o;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y)}copy(s){return this.x=s.x,this.y=s.y,this}add(s){return this.x+=s.x,this.y+=s.y,this}addScalar(s){return this.x+=s,this.y+=s,this}addVectors(s,o){return this.x=s.x+o.x,this.y=s.y+o.y,this}addScaledVector(s,o){return this.x+=s.x*o,this.y+=s.y*o,this}sub(s){return this.x-=s.x,this.y-=s.y,this}subScalar(s){return this.x-=s,this.y-=s,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this}multiply(s){return this.x*=s.x,this.y*=s.y,this}multiplyScalar(s){return this.x*=s,this.y*=s,this}divide(s){return this.x/=s.x,this.y/=s.y,this}divideScalar(s){return this.multiplyScalar(1/s)}applyMatrix3(s){const o=this.x,j=this.y,$=s.elements;return this.x=$[0]*o+$[3]*j+$[6],this.y=$[1]*o+$[4]*j+$[7],this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this}clamp(s,o){return this.x=Math.max(s.x,Math.min(o.x,this.x)),this.y=Math.max(s.y,Math.min(o.y,this.y)),this}clampScalar(s,o){return this.x=Math.max(s,Math.min(o,this.x)),this.y=Math.max(s,Math.min(o,this.y)),this}clampLength(s,o){const j=this.length();return this.divideScalar(j||1).multiplyScalar(Math.max(s,Math.min(o,j)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(s){return this.x*s.x+this.y*s.y}cross(s){return this.x*s.y-this.y*s.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(s){const o=Math.sqrt(this.lengthSq()*s.lengthSq());if(o===0)return Math.PI/2;const j=this.dot(s)/o;return Math.acos(clamp$2(j,-1,1))}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const o=this.x-s.x,j=this.y-s.y;return o*o+j*j}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,o){return this.x+=(s.x-this.x)*o,this.y+=(s.y-this.y)*o,this}lerpVectors(s,o,j){return this.x=s.x+(o.x-s.x)*j,this.y=s.y+(o.y-s.y)*j,this}equals(s){return s.x===this.x&&s.y===this.y}fromArray(s,o=0){return this.x=s[o],this.y=s[o+1],this}toArray(s=[],o=0){return s[o]=this.x,s[o+1]=this.y,s}fromBufferAttribute(s,o){return this.x=s.getX(o),this.y=s.getY(o),this}rotateAround(s,o){const j=Math.cos(o),$=Math.sin(o),_e=this.x-s.x,tt=this.y-s.y;return this.x=_e*j-tt*$+s.x,this.y=_e*$+tt*j+s.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(s,o,j,$,_e,tt,nt,rt,it){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],s!==void 0&&this.set(s,o,j,$,_e,tt,nt,rt,it)}set(s,o,j,$,_e,tt,nt,rt,it){const st=this.elements;return st[0]=s,st[1]=$,st[2]=nt,st[3]=o,st[4]=_e,st[5]=rt,st[6]=j,st[7]=tt,st[8]=it,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(s){const o=this.elements,j=s.elements;return o[0]=j[0],o[1]=j[1],o[2]=j[2],o[3]=j[3],o[4]=j[4],o[5]=j[5],o[6]=j[6],o[7]=j[7],o[8]=j[8],this}extractBasis(s,o,j){return s.setFromMatrix3Column(this,0),o.setFromMatrix3Column(this,1),j.setFromMatrix3Column(this,2),this}setFromMatrix4(s){const o=s.elements;return this.set(o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]),this}multiply(s){return this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,o){const j=s.elements,$=o.elements,_e=this.elements,tt=j[0],nt=j[3],rt=j[6],it=j[1],st=j[4],at=j[7],ot=j[2],ct=j[5],ft=j[8],ht=$[0],mt=$[3],lt=$[6],ut=$[1],dt=$[4],gt=$[7],Et=$[2],St=$[5],Tt=$[8];return _e[0]=tt*ht+nt*ut+rt*Et,_e[3]=tt*mt+nt*dt+rt*St,_e[6]=tt*lt+nt*gt+rt*Tt,_e[1]=it*ht+st*ut+at*Et,_e[4]=it*mt+st*dt+at*St,_e[7]=it*lt+st*gt+at*Tt,_e[2]=ot*ht+ct*ut+ft*Et,_e[5]=ot*mt+ct*dt+ft*St,_e[8]=ot*lt+ct*gt+ft*Tt,this}multiplyScalar(s){const o=this.elements;return o[0]*=s,o[3]*=s,o[6]*=s,o[1]*=s,o[4]*=s,o[7]*=s,o[2]*=s,o[5]*=s,o[8]*=s,this}determinant(){const s=this.elements,o=s[0],j=s[1],$=s[2],_e=s[3],tt=s[4],nt=s[5],rt=s[6],it=s[7],st=s[8];return o*tt*st-o*nt*it-j*_e*st+j*nt*rt+$*_e*it-$*tt*rt}invert(){const s=this.elements,o=s[0],j=s[1],$=s[2],_e=s[3],tt=s[4],nt=s[5],rt=s[6],it=s[7],st=s[8],at=st*tt-nt*it,ot=nt*rt-st*_e,ct=it*_e-tt*rt,ft=o*at+j*ot+$*ct;if(ft===0)return this.set(0,0,0,0,0,0,0,0,0);const ht=1/ft;return s[0]=at*ht,s[1]=($*it-st*j)*ht,s[2]=(nt*j-$*tt)*ht,s[3]=ot*ht,s[4]=(st*o-$*rt)*ht,s[5]=($*_e-nt*o)*ht,s[6]=ct*ht,s[7]=(j*rt-it*o)*ht,s[8]=(tt*o-j*_e)*ht,this}transpose(){let s;const o=this.elements;return s=o[1],o[1]=o[3],o[3]=s,s=o[2],o[2]=o[6],o[6]=s,s=o[5],o[5]=o[7],o[7]=s,this}getNormalMatrix(s){return this.setFromMatrix4(s).invert().transpose()}transposeIntoArray(s){const o=this.elements;return s[0]=o[0],s[1]=o[3],s[2]=o[6],s[3]=o[1],s[4]=o[4],s[5]=o[7],s[6]=o[2],s[7]=o[5],s[8]=o[8],this}setUvTransform(s,o,j,$,_e,tt,nt){const rt=Math.cos(_e),it=Math.sin(_e);return this.set(j*rt,j*it,-j*(rt*tt+it*nt)+tt+s,-$*it,$*rt,-$*(-it*tt+rt*nt)+nt+o,0,0,1),this}scale(s,o){return this.premultiply(_m3.makeScale(s,o)),this}rotate(s){return this.premultiply(_m3.makeRotation(-s)),this}translate(s,o){return this.premultiply(_m3.makeTranslation(s,o)),this}makeTranslation(s,o){return s.isVector2?this.set(1,0,s.x,0,1,s.y,0,0,1):this.set(1,0,s,0,1,o,0,0,1),this}makeRotation(s){const o=Math.cos(s),j=Math.sin(s);return this.set(o,-j,0,j,o,0,0,0,1),this}makeScale(s,o){return this.set(s,0,0,0,o,0,0,0,1),this}equals(s){const o=this.elements,j=s.elements;for(let $=0;$<9;$++)if(o[$]!==j[$])return!1;return!0}fromArray(s,o=0){for(let j=0;j<9;j++)this.elements[j]=s[j+o];return this}toArray(s=[],o=0){const j=this.elements;return s[o]=j[0],s[o+1]=j[1],s[o+2]=j[2],s[o+3]=j[3],s[o+4]=j[4],s[o+5]=j[5],s[o+6]=j[6],s[o+7]=j[7],s[o+8]=j[8],s}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(a){for(let s=a.length-1;s>=0;--s)if(a[s]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(a,s){return new TYPED_ARRAYS[a](s)}function createElementNS(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}const _cache={};function warnOnce(a){a in _cache||(_cache[a]=!0,console.warn(a))}function SRGBToLinear(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function LinearToSRGB(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function DisplayP3ToLinearSRGB(a){return a.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB)}function LinearSRGBToDisplayP3(a){return a.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}const TO_LINEAR={[LinearSRGBColorSpace]:a=>a,[SRGBColorSpace]:a=>a.convertSRGBToLinear(),[DisplayP3ColorSpace]:DisplayP3ToLinearSRGB},FROM_LINEAR={[LinearSRGBColorSpace]:a=>a,[SRGBColorSpace]:a=>a.convertLinearToSRGB(),[DisplayP3ColorSpace]:LinearSRGBToDisplayP3},ColorManagement={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(a){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!a},get workingColorSpace(){return LinearSRGBColorSpace},set workingColorSpace(a){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(a,s,o){if(this.enabled===!1||s===o||!s||!o)return a;const j=TO_LINEAR[s],$=FROM_LINEAR[o];if(j===void 0||$===void 0)throw new Error(`Unsupported color space conversion, "${s}" to "${o}".`);return $(j(a))},fromWorkingColorSpace:function(a,s){return this.convert(a,this.workingColorSpace,s)},toWorkingColorSpace:function(a,s){return this.convert(a,s,this.workingColorSpace)}};let _canvas;class ImageUtils{static getDataURL(s){if(/^data:/i.test(s.src)||typeof HTMLCanvasElement>"u")return s.src;let o;if(s instanceof HTMLCanvasElement)o=s;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=s.width,_canvas.height=s.height;const j=_canvas.getContext("2d");s instanceof ImageData?j.putImageData(s,0,0):j.drawImage(s,0,0,s.width,s.height),o=_canvas}return o.width>2048||o.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",s),o.toDataURL("image/jpeg",.6)):o.toDataURL("image/png")}static sRGBToLinear(s){if(typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap){const o=createElementNS("canvas");o.width=s.width,o.height=s.height;const j=o.getContext("2d");j.drawImage(s,0,0,s.width,s.height);const $=j.getImageData(0,0,s.width,s.height),_e=$.data;for(let tt=0;tt<_e.length;tt++)_e[tt]=SRGBToLinear(_e[tt]/255)*255;return j.putImageData($,0,0),o}else if(s.data){const o=s.data.slice(0);for(let j=0;j<o.length;j++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[j]=Math.floor(SRGBToLinear(o[j]/255)*255):o[j]=SRGBToLinear(o[j]);return{data:o,width:s.width,height:s.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),s}}let sourceId=0;class Source{constructor(s=null){this.isSource=!0,Object.defineProperty(this,"id",{value:sourceId++}),this.uuid=generateUUID(),this.data=s,this.version=0}set needsUpdate(s){s===!0&&this.version++}toJSON(s){const o=s===void 0||typeof s=="string";if(!o&&s.images[this.uuid]!==void 0)return s.images[this.uuid];const j={uuid:this.uuid,url:""},$=this.data;if($!==null){let _e;if(Array.isArray($)){_e=[];for(let tt=0,nt=$.length;tt<nt;tt++)$[tt].isDataTexture?_e.push(serializeImage($[tt].image)):_e.push(serializeImage($[tt]))}else _e=serializeImage($);j.url=_e}return o||(s.images[this.uuid]=j),j}}function serializeImage(a){return typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap?ImageUtils.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let textureId=0;class Texture extends EventDispatcher{constructor(s=Texture.DEFAULT_IMAGE,o=Texture.DEFAULT_MAPPING,j=ClampToEdgeWrapping,$=ClampToEdgeWrapping,_e=LinearFilter,tt=LinearMipmapLinearFilter,nt=RGBAFormat,rt=UnsignedByteType,it=Texture.DEFAULT_ANISOTROPY,st=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(s),this.mipmaps=[],this.mapping=o,this.channel=0,this.wrapS=j,this.wrapT=$,this.magFilter=_e,this.minFilter=tt,this.anisotropy=it,this.format=nt,this.internalFormat=null,this.type=rt,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof st=="string"?this.colorSpace=st:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=st===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(s=null){this.source.data=s}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(s){return this.name=s.name,this.source=s.source,this.mipmaps=s.mipmaps.slice(0),this.mapping=s.mapping,this.channel=s.channel,this.wrapS=s.wrapS,this.wrapT=s.wrapT,this.magFilter=s.magFilter,this.minFilter=s.minFilter,this.anisotropy=s.anisotropy,this.format=s.format,this.internalFormat=s.internalFormat,this.type=s.type,this.offset.copy(s.offset),this.repeat.copy(s.repeat),this.center.copy(s.center),this.rotation=s.rotation,this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrix.copy(s.matrix),this.generateMipmaps=s.generateMipmaps,this.premultiplyAlpha=s.premultiplyAlpha,this.flipY=s.flipY,this.unpackAlignment=s.unpackAlignment,this.colorSpace=s.colorSpace,this.userData=JSON.parse(JSON.stringify(s.userData)),this.needsUpdate=!0,this}toJSON(s){const o=s===void 0||typeof s=="string";if(!o&&s.textures[this.uuid]!==void 0)return s.textures[this.uuid];const j={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(s).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(j.userData=this.userData),o||(s.textures[this.uuid]=j),j}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(s){if(this.mapping!==UVMapping)return s;if(s.applyMatrix3(this.matrix),s.x<0||s.x>1)switch(this.wrapS){case RepeatWrapping:s.x=s.x-Math.floor(s.x);break;case ClampToEdgeWrapping:s.x=s.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(s.x)%2)===1?s.x=Math.ceil(s.x)-s.x:s.x=s.x-Math.floor(s.x);break}if(s.y<0||s.y>1)switch(this.wrapT){case RepeatWrapping:s.y=s.y-Math.floor(s.y);break;case ClampToEdgeWrapping:s.y=s.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(s.y)%2)===1?s.y=Math.ceil(s.y)-s.y:s.y=s.y-Math.floor(s.y);break}return this.flipY&&(s.y=1-s.y),s}set needsUpdate(s){s===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set encoding(s){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=s===sRGBEncoding?SRGBColorSpace:NoColorSpace}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(s=0,o=0,j=0,$=1){Vector4.prototype.isVector4=!0,this.x=s,this.y=o,this.z=j,this.w=$}get width(){return this.z}set width(s){this.z=s}get height(){return this.w}set height(s){this.w=s}set(s,o,j,$){return this.x=s,this.y=o,this.z=j,this.w=$,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this.w=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setW(s){return this.w=s,this}setComponent(s,o){switch(s){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;case 3:this.w=o;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w!==void 0?s.w:1,this}add(s){return this.x+=s.x,this.y+=s.y,this.z+=s.z,this.w+=s.w,this}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this}addVectors(s,o){return this.x=s.x+o.x,this.y=s.y+o.y,this.z=s.z+o.z,this.w=s.w+o.w,this}addScaledVector(s,o){return this.x+=s.x*o,this.y+=s.y*o,this.z+=s.z*o,this.w+=s.w*o,this}sub(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this.w-=s.w,this}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this.w-=s,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this.z=s.z-o.z,this.w=s.w-o.w,this}multiply(s){return this.x*=s.x,this.y*=s.y,this.z*=s.z,this.w*=s.w,this}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}applyMatrix4(s){const o=this.x,j=this.y,$=this.z,_e=this.w,tt=s.elements;return this.x=tt[0]*o+tt[4]*j+tt[8]*$+tt[12]*_e,this.y=tt[1]*o+tt[5]*j+tt[9]*$+tt[13]*_e,this.z=tt[2]*o+tt[6]*j+tt[10]*$+tt[14]*_e,this.w=tt[3]*o+tt[7]*j+tt[11]*$+tt[15]*_e,this}divideScalar(s){return this.multiplyScalar(1/s)}setAxisAngleFromQuaternion(s){this.w=2*Math.acos(s.w);const o=Math.sqrt(1-s.w*s.w);return o<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=s.x/o,this.y=s.y/o,this.z=s.z/o),this}setAxisAngleFromRotationMatrix(s){let o,j,$,_e;const rt=s.elements,it=rt[0],st=rt[4],at=rt[8],ot=rt[1],ct=rt[5],ft=rt[9],ht=rt[2],mt=rt[6],lt=rt[10];if(Math.abs(st-ot)<.01&&Math.abs(at-ht)<.01&&Math.abs(ft-mt)<.01){if(Math.abs(st+ot)<.1&&Math.abs(at+ht)<.1&&Math.abs(ft+mt)<.1&&Math.abs(it+ct+lt-3)<.1)return this.set(1,0,0,0),this;o=Math.PI;const dt=(it+1)/2,gt=(ct+1)/2,Et=(lt+1)/2,St=(st+ot)/4,Tt=(at+ht)/4,Mt=(ft+mt)/4;return dt>gt&&dt>Et?dt<.01?(j=0,$=.707106781,_e=.707106781):(j=Math.sqrt(dt),$=St/j,_e=Tt/j):gt>Et?gt<.01?(j=.707106781,$=0,_e=.707106781):($=Math.sqrt(gt),j=St/$,_e=Mt/$):Et<.01?(j=.707106781,$=.707106781,_e=0):(_e=Math.sqrt(Et),j=Tt/_e,$=Mt/_e),this.set(j,$,_e,o),this}let ut=Math.sqrt((mt-ft)*(mt-ft)+(at-ht)*(at-ht)+(ot-st)*(ot-st));return Math.abs(ut)<.001&&(ut=1),this.x=(mt-ft)/ut,this.y=(at-ht)/ut,this.z=(ot-st)/ut,this.w=Math.acos((it+ct+lt-1)/2),this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this.w=Math.min(this.w,s.w),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this.w=Math.max(this.w,s.w),this}clamp(s,o){return this.x=Math.max(s.x,Math.min(o.x,this.x)),this.y=Math.max(s.y,Math.min(o.y,this.y)),this.z=Math.max(s.z,Math.min(o.z,this.z)),this.w=Math.max(s.w,Math.min(o.w,this.w)),this}clampScalar(s,o){return this.x=Math.max(s,Math.min(o,this.x)),this.y=Math.max(s,Math.min(o,this.y)),this.z=Math.max(s,Math.min(o,this.z)),this.w=Math.max(s,Math.min(o,this.w)),this}clampLength(s,o){const j=this.length();return this.divideScalar(j||1).multiplyScalar(Math.max(s,Math.min(o,j)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z+this.w*s.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,o){return this.x+=(s.x-this.x)*o,this.y+=(s.y-this.y)*o,this.z+=(s.z-this.z)*o,this.w+=(s.w-this.w)*o,this}lerpVectors(s,o,j){return this.x=s.x+(o.x-s.x)*j,this.y=s.y+(o.y-s.y)*j,this.z=s.z+(o.z-s.z)*j,this.w=s.w+(o.w-s.w)*j,this}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z&&s.w===this.w}fromArray(s,o=0){return this.x=s[o],this.y=s[o+1],this.z=s[o+2],this.w=s[o+3],this}toArray(s=[],o=0){return s[o]=this.x,s[o+1]=this.y,s[o+2]=this.z,s[o+3]=this.w,s}fromBufferAttribute(s,o){return this.x=s.getX(o),this.y=s.getY(o),this.z=s.getZ(o),this.w=s.getW(o),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class WebGLRenderTarget extends EventDispatcher{constructor(s=1,o=1,j={}){super(),this.isWebGLRenderTarget=!0,this.width=s,this.height=o,this.depth=1,this.scissor=new Vector4(0,0,s,o),this.scissorTest=!1,this.viewport=new Vector4(0,0,s,o);const $={width:s,height:o,depth:1};j.encoding!==void 0&&(warnOnce("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),j.colorSpace=j.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new Texture($,j.mapping,j.wrapS,j.wrapT,j.magFilter,j.minFilter,j.format,j.type,j.anisotropy,j.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=j.generateMipmaps!==void 0?j.generateMipmaps:!1,this.texture.internalFormat=j.internalFormat!==void 0?j.internalFormat:null,this.texture.minFilter=j.minFilter!==void 0?j.minFilter:LinearFilter,this.depthBuffer=j.depthBuffer!==void 0?j.depthBuffer:!0,this.stencilBuffer=j.stencilBuffer!==void 0?j.stencilBuffer:!1,this.depthTexture=j.depthTexture!==void 0?j.depthTexture:null,this.samples=j.samples!==void 0?j.samples:0}setSize(s,o,j=1){(this.width!==s||this.height!==o||this.depth!==j)&&(this.width=s,this.height=o,this.depth=j,this.texture.image.width=s,this.texture.image.height=o,this.texture.image.depth=j,this.dispose()),this.viewport.set(0,0,s,o),this.scissor.set(0,0,s,o)}clone(){return new this.constructor().copy(this)}copy(s){this.width=s.width,this.height=s.height,this.depth=s.depth,this.scissor.copy(s.scissor),this.scissorTest=s.scissorTest,this.viewport.copy(s.viewport),this.texture=s.texture.clone(),this.texture.isRenderTargetTexture=!0;const o=Object.assign({},s.texture.image);return this.texture.source=new Source(o),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,s.depthTexture!==null&&(this.depthTexture=s.depthTexture.clone()),this.samples=s.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DataArrayTexture extends Texture{constructor(s=null,o=1,j=1,$=1){super(null),this.isDataArrayTexture=!0,this.image={data:s,width:o,height:j,depth:$},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(s=1,o=1,j=1){super(s,o),this.isWebGLArrayRenderTarget=!0,this.depth=j,this.texture=new DataArrayTexture(null,s,o,j),this.texture.isRenderTargetTexture=!0}}let Data3DTexture$1=class extends Texture{constructor(s=null,o=1,j=1,$=1){super(null),this.isData3DTexture=!0,this.image={data:s,width:o,height:j,depth:$},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(s=1,o=1,j=1){super(s,o),this.isWebGL3DRenderTarget=!0,this.depth=j,this.texture=new Data3DTexture$1(null,s,o,j),this.texture.isRenderTargetTexture=!0}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(s=1,o=1,j=1,$={}){super(s,o,$),this.isWebGLMultipleRenderTargets=!0;const _e=this.texture;this.texture=[];for(let tt=0;tt<j;tt++)this.texture[tt]=_e.clone(),this.texture[tt].isRenderTargetTexture=!0}setSize(s,o,j=1){if(this.width!==s||this.height!==o||this.depth!==j){this.width=s,this.height=o,this.depth=j;for(let $=0,_e=this.texture.length;$<_e;$++)this.texture[$].image.width=s,this.texture[$].image.height=o,this.texture[$].image.depth=j;this.dispose()}return this.viewport.set(0,0,s,o),this.scissor.set(0,0,s,o),this}copy(s){this.dispose(),this.width=s.width,this.height=s.height,this.depth=s.depth,this.scissor.copy(s.scissor),this.scissorTest=s.scissorTest,this.viewport.copy(s.viewport),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,s.depthTexture!==null&&(this.depthTexture=s.depthTexture.clone()),this.texture.length=0;for(let o=0,j=s.texture.length;o<j;o++)this.texture[o]=s.texture[o].clone(),this.texture[o].isRenderTargetTexture=!0;return this}}class Quaternion{constructor(s=0,o=0,j=0,$=1){this.isQuaternion=!0,this._x=s,this._y=o,this._z=j,this._w=$}static slerpFlat(s,o,j,$,_e,tt,nt){let rt=j[$+0],it=j[$+1],st=j[$+2],at=j[$+3];const ot=_e[tt+0],ct=_e[tt+1],ft=_e[tt+2],ht=_e[tt+3];if(nt===0){s[o+0]=rt,s[o+1]=it,s[o+2]=st,s[o+3]=at;return}if(nt===1){s[o+0]=ot,s[o+1]=ct,s[o+2]=ft,s[o+3]=ht;return}if(at!==ht||rt!==ot||it!==ct||st!==ft){let mt=1-nt;const lt=rt*ot+it*ct+st*ft+at*ht,ut=lt>=0?1:-1,dt=1-lt*lt;if(dt>Number.EPSILON){const Et=Math.sqrt(dt),St=Math.atan2(Et,lt*ut);mt=Math.sin(mt*St)/Et,nt=Math.sin(nt*St)/Et}const gt=nt*ut;if(rt=rt*mt+ot*gt,it=it*mt+ct*gt,st=st*mt+ft*gt,at=at*mt+ht*gt,mt===1-nt){const Et=1/Math.sqrt(rt*rt+it*it+st*st+at*at);rt*=Et,it*=Et,st*=Et,at*=Et}}s[o]=rt,s[o+1]=it,s[o+2]=st,s[o+3]=at}static multiplyQuaternionsFlat(s,o,j,$,_e,tt){const nt=j[$],rt=j[$+1],it=j[$+2],st=j[$+3],at=_e[tt],ot=_e[tt+1],ct=_e[tt+2],ft=_e[tt+3];return s[o]=nt*ft+st*at+rt*ct-it*ot,s[o+1]=rt*ft+st*ot+it*at-nt*ct,s[o+2]=it*ft+st*ct+nt*ot-rt*at,s[o+3]=st*ft-nt*at-rt*ot-it*ct,s}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get w(){return this._w}set w(s){this._w=s,this._onChangeCallback()}set(s,o,j,$){return this._x=s,this._y=o,this._z=j,this._w=$,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(s){return this._x=s.x,this._y=s.y,this._z=s.z,this._w=s.w,this._onChangeCallback(),this}setFromEuler(s,o){const j=s._x,$=s._y,_e=s._z,tt=s._order,nt=Math.cos,rt=Math.sin,it=nt(j/2),st=nt($/2),at=nt(_e/2),ot=rt(j/2),ct=rt($/2),ft=rt(_e/2);switch(tt){case"XYZ":this._x=ot*st*at+it*ct*ft,this._y=it*ct*at-ot*st*ft,this._z=it*st*ft+ot*ct*at,this._w=it*st*at-ot*ct*ft;break;case"YXZ":this._x=ot*st*at+it*ct*ft,this._y=it*ct*at-ot*st*ft,this._z=it*st*ft-ot*ct*at,this._w=it*st*at+ot*ct*ft;break;case"ZXY":this._x=ot*st*at-it*ct*ft,this._y=it*ct*at+ot*st*ft,this._z=it*st*ft+ot*ct*at,this._w=it*st*at-ot*ct*ft;break;case"ZYX":this._x=ot*st*at-it*ct*ft,this._y=it*ct*at+ot*st*ft,this._z=it*st*ft-ot*ct*at,this._w=it*st*at+ot*ct*ft;break;case"YZX":this._x=ot*st*at+it*ct*ft,this._y=it*ct*at+ot*st*ft,this._z=it*st*ft-ot*ct*at,this._w=it*st*at-ot*ct*ft;break;case"XZY":this._x=ot*st*at-it*ct*ft,this._y=it*ct*at-ot*st*ft,this._z=it*st*ft+ot*ct*at,this._w=it*st*at+ot*ct*ft;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+tt)}return o!==!1&&this._onChangeCallback(),this}setFromAxisAngle(s,o){const j=o/2,$=Math.sin(j);return this._x=s.x*$,this._y=s.y*$,this._z=s.z*$,this._w=Math.cos(j),this._onChangeCallback(),this}setFromRotationMatrix(s){const o=s.elements,j=o[0],$=o[4],_e=o[8],tt=o[1],nt=o[5],rt=o[9],it=o[2],st=o[6],at=o[10],ot=j+nt+at;if(ot>0){const ct=.5/Math.sqrt(ot+1);this._w=.25/ct,this._x=(st-rt)*ct,this._y=(_e-it)*ct,this._z=(tt-$)*ct}else if(j>nt&&j>at){const ct=2*Math.sqrt(1+j-nt-at);this._w=(st-rt)/ct,this._x=.25*ct,this._y=($+tt)/ct,this._z=(_e+it)/ct}else if(nt>at){const ct=2*Math.sqrt(1+nt-j-at);this._w=(_e-it)/ct,this._x=($+tt)/ct,this._y=.25*ct,this._z=(rt+st)/ct}else{const ct=2*Math.sqrt(1+at-j-nt);this._w=(tt-$)/ct,this._x=(_e+it)/ct,this._y=(rt+st)/ct,this._z=.25*ct}return this._onChangeCallback(),this}setFromUnitVectors(s,o){let j=s.dot(o)+1;return j<Number.EPSILON?(j=0,Math.abs(s.x)>Math.abs(s.z)?(this._x=-s.y,this._y=s.x,this._z=0,this._w=j):(this._x=0,this._y=-s.z,this._z=s.y,this._w=j)):(this._x=s.y*o.z-s.z*o.y,this._y=s.z*o.x-s.x*o.z,this._z=s.x*o.y-s.y*o.x,this._w=j),this.normalize()}angleTo(s){return 2*Math.acos(Math.abs(clamp$2(this.dot(s),-1,1)))}rotateTowards(s,o){const j=this.angleTo(s);if(j===0)return this;const $=Math.min(1,o/j);return this.slerp(s,$),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(s){return this._x*s._x+this._y*s._y+this._z*s._z+this._w*s._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let s=this.length();return s===0?(this._x=0,this._y=0,this._z=0,this._w=1):(s=1/s,this._x=this._x*s,this._y=this._y*s,this._z=this._z*s,this._w=this._w*s),this._onChangeCallback(),this}multiply(s){return this.multiplyQuaternions(this,s)}premultiply(s){return this.multiplyQuaternions(s,this)}multiplyQuaternions(s,o){const j=s._x,$=s._y,_e=s._z,tt=s._w,nt=o._x,rt=o._y,it=o._z,st=o._w;return this._x=j*st+tt*nt+$*it-_e*rt,this._y=$*st+tt*rt+_e*nt-j*it,this._z=_e*st+tt*it+j*rt-$*nt,this._w=tt*st-j*nt-$*rt-_e*it,this._onChangeCallback(),this}slerp(s,o){if(o===0)return this;if(o===1)return this.copy(s);const j=this._x,$=this._y,_e=this._z,tt=this._w;let nt=tt*s._w+j*s._x+$*s._y+_e*s._z;if(nt<0?(this._w=-s._w,this._x=-s._x,this._y=-s._y,this._z=-s._z,nt=-nt):this.copy(s),nt>=1)return this._w=tt,this._x=j,this._y=$,this._z=_e,this;const rt=1-nt*nt;if(rt<=Number.EPSILON){const ct=1-o;return this._w=ct*tt+o*this._w,this._x=ct*j+o*this._x,this._y=ct*$+o*this._y,this._z=ct*_e+o*this._z,this.normalize(),this._onChangeCallback(),this}const it=Math.sqrt(rt),st=Math.atan2(it,nt),at=Math.sin((1-o)*st)/it,ot=Math.sin(o*st)/it;return this._w=tt*at+this._w*ot,this._x=j*at+this._x*ot,this._y=$*at+this._y*ot,this._z=_e*at+this._z*ot,this._onChangeCallback(),this}slerpQuaternions(s,o,j){return this.copy(s).slerp(o,j)}random(){const s=Math.random(),o=Math.sqrt(1-s),j=Math.sqrt(s),$=2*Math.PI*Math.random(),_e=2*Math.PI*Math.random();return this.set(o*Math.cos($),j*Math.sin(_e),j*Math.cos(_e),o*Math.sin($))}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._w===this._w}fromArray(s,o=0){return this._x=s[o],this._y=s[o+1],this._z=s[o+2],this._w=s[o+3],this._onChangeCallback(),this}toArray(s=[],o=0){return s[o]=this._x,s[o+1]=this._y,s[o+2]=this._z,s[o+3]=this._w,s}fromBufferAttribute(s,o){return this._x=s.getX(o),this._y=s.getY(o),this._z=s.getZ(o),this._w=s.getW(o),this}toJSON(){return this.toArray()}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(s=0,o=0,j=0){Vector3.prototype.isVector3=!0,this.x=s,this.y=o,this.z=j}set(s,o,j){return j===void 0&&(j=this.z),this.x=s,this.y=o,this.z=j,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setComponent(s,o){switch(s){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this}add(s){return this.x+=s.x,this.y+=s.y,this.z+=s.z,this}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this}addVectors(s,o){return this.x=s.x+o.x,this.y=s.y+o.y,this.z=s.z+o.z,this}addScaledVector(s,o){return this.x+=s.x*o,this.y+=s.y*o,this.z+=s.z*o,this}sub(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this.z=s.z-o.z,this}multiply(s){return this.x*=s.x,this.y*=s.y,this.z*=s.z,this}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this}multiplyVectors(s,o){return this.x=s.x*o.x,this.y=s.y*o.y,this.z=s.z*o.z,this}applyEuler(s){return this.applyQuaternion(_quaternion$4.setFromEuler(s))}applyAxisAngle(s,o){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(s,o))}applyMatrix3(s){const o=this.x,j=this.y,$=this.z,_e=s.elements;return this.x=_e[0]*o+_e[3]*j+_e[6]*$,this.y=_e[1]*o+_e[4]*j+_e[7]*$,this.z=_e[2]*o+_e[5]*j+_e[8]*$,this}applyNormalMatrix(s){return this.applyMatrix3(s).normalize()}applyMatrix4(s){const o=this.x,j=this.y,$=this.z,_e=s.elements,tt=1/(_e[3]*o+_e[7]*j+_e[11]*$+_e[15]);return this.x=(_e[0]*o+_e[4]*j+_e[8]*$+_e[12])*tt,this.y=(_e[1]*o+_e[5]*j+_e[9]*$+_e[13])*tt,this.z=(_e[2]*o+_e[6]*j+_e[10]*$+_e[14])*tt,this}applyQuaternion(s){const o=this.x,j=this.y,$=this.z,_e=s.x,tt=s.y,nt=s.z,rt=s.w,it=rt*o+tt*$-nt*j,st=rt*j+nt*o-_e*$,at=rt*$+_e*j-tt*o,ot=-_e*o-tt*j-nt*$;return this.x=it*rt+ot*-_e+st*-nt-at*-tt,this.y=st*rt+ot*-tt+at*-_e-it*-nt,this.z=at*rt+ot*-nt+it*-tt-st*-_e,this}project(s){return this.applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix)}unproject(s){return this.applyMatrix4(s.projectionMatrixInverse).applyMatrix4(s.matrixWorld)}transformDirection(s){const o=this.x,j=this.y,$=this.z,_e=s.elements;return this.x=_e[0]*o+_e[4]*j+_e[8]*$,this.y=_e[1]*o+_e[5]*j+_e[9]*$,this.z=_e[2]*o+_e[6]*j+_e[10]*$,this.normalize()}divide(s){return this.x/=s.x,this.y/=s.y,this.z/=s.z,this}divideScalar(s){return this.multiplyScalar(1/s)}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this}clamp(s,o){return this.x=Math.max(s.x,Math.min(o.x,this.x)),this.y=Math.max(s.y,Math.min(o.y,this.y)),this.z=Math.max(s.z,Math.min(o.z,this.z)),this}clampScalar(s,o){return this.x=Math.max(s,Math.min(o,this.x)),this.y=Math.max(s,Math.min(o,this.y)),this.z=Math.max(s,Math.min(o,this.z)),this}clampLength(s,o){const j=this.length();return this.divideScalar(j||1).multiplyScalar(Math.max(s,Math.min(o,j)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,o){return this.x+=(s.x-this.x)*o,this.y+=(s.y-this.y)*o,this.z+=(s.z-this.z)*o,this}lerpVectors(s,o,j){return this.x=s.x+(o.x-s.x)*j,this.y=s.y+(o.y-s.y)*j,this.z=s.z+(o.z-s.z)*j,this}cross(s){return this.crossVectors(this,s)}crossVectors(s,o){const j=s.x,$=s.y,_e=s.z,tt=o.x,nt=o.y,rt=o.z;return this.x=$*rt-_e*nt,this.y=_e*tt-j*rt,this.z=j*nt-$*tt,this}projectOnVector(s){const o=s.lengthSq();if(o===0)return this.set(0,0,0);const j=s.dot(this)/o;return this.copy(s).multiplyScalar(j)}projectOnPlane(s){return _vector$b.copy(this).projectOnVector(s),this.sub(_vector$b)}reflect(s){return this.sub(_vector$b.copy(s).multiplyScalar(2*this.dot(s)))}angleTo(s){const o=Math.sqrt(this.lengthSq()*s.lengthSq());if(o===0)return Math.PI/2;const j=this.dot(s)/o;return Math.acos(clamp$2(j,-1,1))}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const o=this.x-s.x,j=this.y-s.y,$=this.z-s.z;return o*o+j*j+$*$}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)+Math.abs(this.z-s.z)}setFromSpherical(s){return this.setFromSphericalCoords(s.radius,s.phi,s.theta)}setFromSphericalCoords(s,o,j){const $=Math.sin(o)*s;return this.x=$*Math.sin(j),this.y=Math.cos(o)*s,this.z=$*Math.cos(j),this}setFromCylindrical(s){return this.setFromCylindricalCoords(s.radius,s.theta,s.y)}setFromCylindricalCoords(s,o,j){return this.x=s*Math.sin(o),this.y=j,this.z=s*Math.cos(o),this}setFromMatrixPosition(s){const o=s.elements;return this.x=o[12],this.y=o[13],this.z=o[14],this}setFromMatrixScale(s){const o=this.setFromMatrixColumn(s,0).length(),j=this.setFromMatrixColumn(s,1).length(),$=this.setFromMatrixColumn(s,2).length();return this.x=o,this.y=j,this.z=$,this}setFromMatrixColumn(s,o){return this.fromArray(s.elements,o*4)}setFromMatrix3Column(s,o){return this.fromArray(s.elements,o*3)}setFromEuler(s){return this.x=s._x,this.y=s._y,this.z=s._z,this}setFromColor(s){return this.x=s.r,this.y=s.g,this.z=s.b,this}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z}fromArray(s,o=0){return this.x=s[o],this.y=s[o+1],this.z=s[o+2],this}toArray(s=[],o=0){return s[o]=this.x,s[o+1]=this.y,s[o+2]=this.z,s}fromBufferAttribute(s,o){return this.x=s.getX(o),this.y=s.getY(o),this.z=s.getZ(o),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const s=(Math.random()-.5)*2,o=Math.random()*Math.PI*2,j=Math.sqrt(1-s**2);return this.x=j*Math.cos(o),this.y=j*Math.sin(o),this.z=s,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$b=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(s=new Vector3(1/0,1/0,1/0),o=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=s,this.max=o}set(s,o){return this.min.copy(s),this.max.copy(o),this}setFromArray(s){this.makeEmpty();for(let o=0,j=s.length;o<j;o+=3)this.expandByPoint(_vector$a.fromArray(s,o));return this}setFromBufferAttribute(s){this.makeEmpty();for(let o=0,j=s.count;o<j;o++)this.expandByPoint(_vector$a.fromBufferAttribute(s,o));return this}setFromPoints(s){this.makeEmpty();for(let o=0,j=s.length;o<j;o++)this.expandByPoint(s[o]);return this}setFromCenterAndSize(s,o){const j=_vector$a.copy(o).multiplyScalar(.5);return this.min.copy(s).sub(j),this.max.copy(s).add(j),this}setFromObject(s,o=!1){return this.makeEmpty(),this.expandByObject(s,o)}clone(){return new this.constructor().copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(s){return this.isEmpty()?s.set(0,0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return this.isEmpty()?s.set(0,0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}expandByObject(s,o=!1){if(s.updateWorldMatrix(!1,!1),s.boundingBox!==void 0)s.boundingBox===null&&s.computeBoundingBox(),_box$3.copy(s.boundingBox),_box$3.applyMatrix4(s.matrixWorld),this.union(_box$3);else{const $=s.geometry;if($!==void 0)if(o&&$.attributes!==void 0&&$.attributes.position!==void 0){const _e=$.attributes.position;for(let tt=0,nt=_e.count;tt<nt;tt++)_vector$a.fromBufferAttribute(_e,tt).applyMatrix4(s.matrixWorld),this.expandByPoint(_vector$a)}else $.boundingBox===null&&$.computeBoundingBox(),_box$3.copy($.boundingBox),_box$3.applyMatrix4(s.matrixWorld),this.union(_box$3)}const j=s.children;for(let $=0,_e=j.length;$<_e;$++)this.expandByObject(j[$],o);return this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y||s.z<this.min.z||s.z>this.max.z)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y&&this.min.z<=s.min.z&&s.max.z<=this.max.z}getParameter(s,o){return o.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y),(s.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y||s.max.z<this.min.z||s.min.z>this.max.z)}intersectsSphere(s){return this.clampPoint(s.center,_vector$a),_vector$a.distanceToSquared(s.center)<=s.radius*s.radius}intersectsPlane(s){let o,j;return s.normal.x>0?(o=s.normal.x*this.min.x,j=s.normal.x*this.max.x):(o=s.normal.x*this.max.x,j=s.normal.x*this.min.x),s.normal.y>0?(o+=s.normal.y*this.min.y,j+=s.normal.y*this.max.y):(o+=s.normal.y*this.max.y,j+=s.normal.y*this.min.y),s.normal.z>0?(o+=s.normal.z*this.min.z,j+=s.normal.z*this.max.z):(o+=s.normal.z*this.max.z,j+=s.normal.z*this.min.z),o<=-s.constant&&j>=-s.constant}intersectsTriangle(s){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(s.a,_center),_v1$7.subVectors(s.b,_center),_v2$4.subVectors(s.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let o=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(o,_v0$2,_v1$7,_v2$4,_extents)||(o=[1,0,0,0,1,0,0,0,1],!satForAxes(o,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),o=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(o,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(s,o){return o.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return this.clampPoint(s,_vector$a).distanceTo(s)}getBoundingSphere(s){return this.isEmpty()?s.makeEmpty():(this.getCenter(s.center),s.radius=this.getSize(_vector$a).length()*.5),s}intersect(s){return this.min.max(s.min),this.max.min(s.max),this.isEmpty()&&this.makeEmpty(),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}applyMatrix4(s){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(s),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(s),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(s),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(s),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(s),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(s),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(s),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(s),this.setFromPoints(_points),this)}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$a=new Vector3,_box$3=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(a,s,o,j,$){for(let _e=0,tt=a.length-3;_e<=tt;_e+=3){_testAxis.fromArray(a,_e);const nt=$.x*Math.abs(_testAxis.x)+$.y*Math.abs(_testAxis.y)+$.z*Math.abs(_testAxis.z),rt=s.dot(_testAxis),it=o.dot(_testAxis),st=j.dot(_testAxis);if(Math.max(-Math.max(rt,it,st),Math.min(rt,it,st))>nt)return!1}return!0}const _box$2=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(s=new Vector3,o=-1){this.center=s,this.radius=o}set(s,o){return this.center.copy(s),this.radius=o,this}setFromPoints(s,o){const j=this.center;o!==void 0?j.copy(o):_box$2.setFromPoints(s).getCenter(j);let $=0;for(let _e=0,tt=s.length;_e<tt;_e++)$=Math.max($,j.distanceToSquared(s[_e]));return this.radius=Math.sqrt($),this}copy(s){return this.center.copy(s.center),this.radius=s.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(s){return s.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(s){return s.distanceTo(this.center)-this.radius}intersectsSphere(s){const o=this.radius+s.radius;return s.center.distanceToSquared(this.center)<=o*o}intersectsBox(s){return s.intersectsSphere(this)}intersectsPlane(s){return Math.abs(s.distanceToPoint(this.center))<=this.radius}clampPoint(s,o){const j=this.center.distanceToSquared(s);return o.copy(s),j>this.radius*this.radius&&(o.sub(this.center).normalize(),o.multiplyScalar(this.radius).add(this.center)),o}getBoundingBox(s){return this.isEmpty()?(s.makeEmpty(),s):(s.set(this.center,this.center),s.expandByScalar(this.radius),s)}applyMatrix4(s){return this.center.applyMatrix4(s),this.radius=this.radius*s.getMaxScaleOnAxis(),this}translate(s){return this.center.add(s),this}expandByPoint(s){if(this.isEmpty())return this.center.copy(s),this.radius=0,this;_v1$6.subVectors(s,this.center);const o=_v1$6.lengthSq();if(o>this.radius*this.radius){const j=Math.sqrt(o),$=(j-this.radius)*.5;this.center.addScaledVector(_v1$6,$/j),this.radius+=$}return this}union(s){return s.isEmpty()?this:this.isEmpty()?(this.copy(s),this):(this.center.equals(s.center)===!0?this.radius=Math.max(this.radius,s.radius):(_v2$3.subVectors(s.center,this.center).setLength(s.radius),this.expandByPoint(_v1$6.copy(s.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(s.center).sub(_v2$3))),this)}equals(s){return s.center.equals(this.center)&&s.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$9=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(s=new Vector3,o=new Vector3(0,0,-1)){this.origin=s,this.direction=o}set(s,o){return this.origin.copy(s),this.direction.copy(o),this}copy(s){return this.origin.copy(s.origin),this.direction.copy(s.direction),this}at(s,o){return o.copy(this.origin).addScaledVector(this.direction,s)}lookAt(s){return this.direction.copy(s).sub(this.origin).normalize(),this}recast(s){return this.origin.copy(this.at(s,_vector$9)),this}closestPointToPoint(s,o){o.subVectors(s,this.origin);const j=o.dot(this.direction);return j<0?o.copy(this.origin):o.copy(this.origin).addScaledVector(this.direction,j)}distanceToPoint(s){return Math.sqrt(this.distanceSqToPoint(s))}distanceSqToPoint(s){const o=_vector$9.subVectors(s,this.origin).dot(this.direction);return o<0?this.origin.distanceToSquared(s):(_vector$9.copy(this.origin).addScaledVector(this.direction,o),_vector$9.distanceToSquared(s))}distanceSqToSegment(s,o,j,$){_segCenter.copy(s).add(o).multiplyScalar(.5),_segDir.copy(o).sub(s).normalize(),_diff.copy(this.origin).sub(_segCenter);const _e=s.distanceTo(o)*.5,tt=-this.direction.dot(_segDir),nt=_diff.dot(this.direction),rt=-_diff.dot(_segDir),it=_diff.lengthSq(),st=Math.abs(1-tt*tt);let at,ot,ct,ft;if(st>0)if(at=tt*rt-nt,ot=tt*nt-rt,ft=_e*st,at>=0)if(ot>=-ft)if(ot<=ft){const ht=1/st;at*=ht,ot*=ht,ct=at*(at+tt*ot+2*nt)+ot*(tt*at+ot+2*rt)+it}else ot=_e,at=Math.max(0,-(tt*ot+nt)),ct=-at*at+ot*(ot+2*rt)+it;else ot=-_e,at=Math.max(0,-(tt*ot+nt)),ct=-at*at+ot*(ot+2*rt)+it;else ot<=-ft?(at=Math.max(0,-(-tt*_e+nt)),ot=at>0?-_e:Math.min(Math.max(-_e,-rt),_e),ct=-at*at+ot*(ot+2*rt)+it):ot<=ft?(at=0,ot=Math.min(Math.max(-_e,-rt),_e),ct=ot*(ot+2*rt)+it):(at=Math.max(0,-(tt*_e+nt)),ot=at>0?_e:Math.min(Math.max(-_e,-rt),_e),ct=-at*at+ot*(ot+2*rt)+it);else ot=tt>0?-_e:_e,at=Math.max(0,-(tt*ot+nt)),ct=-at*at+ot*(ot+2*rt)+it;return j&&j.copy(this.origin).addScaledVector(this.direction,at),$&&$.copy(_segCenter).addScaledVector(_segDir,ot),ct}intersectSphere(s,o){_vector$9.subVectors(s.center,this.origin);const j=_vector$9.dot(this.direction),$=_vector$9.dot(_vector$9)-j*j,_e=s.radius*s.radius;if($>_e)return null;const tt=Math.sqrt(_e-$),nt=j-tt,rt=j+tt;return rt<0?null:nt<0?this.at(rt,o):this.at(nt,o)}intersectsSphere(s){return this.distanceSqToPoint(s.center)<=s.radius*s.radius}distanceToPlane(s){const o=s.normal.dot(this.direction);if(o===0)return s.distanceToPoint(this.origin)===0?0:null;const j=-(this.origin.dot(s.normal)+s.constant)/o;return j>=0?j:null}intersectPlane(s,o){const j=this.distanceToPlane(s);return j===null?null:this.at(j,o)}intersectsPlane(s){const o=s.distanceToPoint(this.origin);return o===0||s.normal.dot(this.direction)*o<0}intersectBox(s,o){let j,$,_e,tt,nt,rt;const it=1/this.direction.x,st=1/this.direction.y,at=1/this.direction.z,ot=this.origin;return it>=0?(j=(s.min.x-ot.x)*it,$=(s.max.x-ot.x)*it):(j=(s.max.x-ot.x)*it,$=(s.min.x-ot.x)*it),st>=0?(_e=(s.min.y-ot.y)*st,tt=(s.max.y-ot.y)*st):(_e=(s.max.y-ot.y)*st,tt=(s.min.y-ot.y)*st),j>tt||_e>$||((_e>j||isNaN(j))&&(j=_e),(tt<$||isNaN($))&&($=tt),at>=0?(nt=(s.min.z-ot.z)*at,rt=(s.max.z-ot.z)*at):(nt=(s.max.z-ot.z)*at,rt=(s.min.z-ot.z)*at),j>rt||nt>$)||((nt>j||j!==j)&&(j=nt),(rt<$||$!==$)&&($=rt),$<0)?null:this.at(j>=0?j:$,o)}intersectsBox(s){return this.intersectBox(s,_vector$9)!==null}intersectTriangle(s,o,j,$,_e){_edge1.subVectors(o,s),_edge2.subVectors(j,s),_normal$1.crossVectors(_edge1,_edge2);let tt=this.direction.dot(_normal$1),nt;if(tt>0){if($)return null;nt=1}else if(tt<0)nt=-1,tt=-tt;else return null;_diff.subVectors(this.origin,s);const rt=nt*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(rt<0)return null;const it=nt*this.direction.dot(_edge1.cross(_diff));if(it<0||rt+it>tt)return null;const st=-nt*_diff.dot(_normal$1);return st<0?null:this.at(st/tt,_e)}applyMatrix4(s){return this.origin.applyMatrix4(s),this.direction.transformDirection(s),this}equals(s){return s.origin.equals(this.origin)&&s.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(s,o,j,$,_e,tt,nt,rt,it,st,at,ot,ct,ft,ht,mt){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s!==void 0&&this.set(s,o,j,$,_e,tt,nt,rt,it,st,at,ot,ct,ft,ht,mt)}set(s,o,j,$,_e,tt,nt,rt,it,st,at,ot,ct,ft,ht,mt){const lt=this.elements;return lt[0]=s,lt[4]=o,lt[8]=j,lt[12]=$,lt[1]=_e,lt[5]=tt,lt[9]=nt,lt[13]=rt,lt[2]=it,lt[6]=st,lt[10]=at,lt[14]=ot,lt[3]=ct,lt[7]=ft,lt[11]=ht,lt[15]=mt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(s){const o=this.elements,j=s.elements;return o[0]=j[0],o[1]=j[1],o[2]=j[2],o[3]=j[3],o[4]=j[4],o[5]=j[5],o[6]=j[6],o[7]=j[7],o[8]=j[8],o[9]=j[9],o[10]=j[10],o[11]=j[11],o[12]=j[12],o[13]=j[13],o[14]=j[14],o[15]=j[15],this}copyPosition(s){const o=this.elements,j=s.elements;return o[12]=j[12],o[13]=j[13],o[14]=j[14],this}setFromMatrix3(s){const o=s.elements;return this.set(o[0],o[3],o[6],0,o[1],o[4],o[7],0,o[2],o[5],o[8],0,0,0,0,1),this}extractBasis(s,o,j){return s.setFromMatrixColumn(this,0),o.setFromMatrixColumn(this,1),j.setFromMatrixColumn(this,2),this}makeBasis(s,o,j){return this.set(s.x,o.x,j.x,0,s.y,o.y,j.y,0,s.z,o.z,j.z,0,0,0,0,1),this}extractRotation(s){const o=this.elements,j=s.elements,$=1/_v1$5$1.setFromMatrixColumn(s,0).length(),_e=1/_v1$5$1.setFromMatrixColumn(s,1).length(),tt=1/_v1$5$1.setFromMatrixColumn(s,2).length();return o[0]=j[0]*$,o[1]=j[1]*$,o[2]=j[2]*$,o[3]=0,o[4]=j[4]*_e,o[5]=j[5]*_e,o[6]=j[6]*_e,o[7]=0,o[8]=j[8]*tt,o[9]=j[9]*tt,o[10]=j[10]*tt,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this}makeRotationFromEuler(s){const o=this.elements,j=s.x,$=s.y,_e=s.z,tt=Math.cos(j),nt=Math.sin(j),rt=Math.cos($),it=Math.sin($),st=Math.cos(_e),at=Math.sin(_e);if(s.order==="XYZ"){const ot=tt*st,ct=tt*at,ft=nt*st,ht=nt*at;o[0]=rt*st,o[4]=-rt*at,o[8]=it,o[1]=ct+ft*it,o[5]=ot-ht*it,o[9]=-nt*rt,o[2]=ht-ot*it,o[6]=ft+ct*it,o[10]=tt*rt}else if(s.order==="YXZ"){const ot=rt*st,ct=rt*at,ft=it*st,ht=it*at;o[0]=ot+ht*nt,o[4]=ft*nt-ct,o[8]=tt*it,o[1]=tt*at,o[5]=tt*st,o[9]=-nt,o[2]=ct*nt-ft,o[6]=ht+ot*nt,o[10]=tt*rt}else if(s.order==="ZXY"){const ot=rt*st,ct=rt*at,ft=it*st,ht=it*at;o[0]=ot-ht*nt,o[4]=-tt*at,o[8]=ft+ct*nt,o[1]=ct+ft*nt,o[5]=tt*st,o[9]=ht-ot*nt,o[2]=-tt*it,o[6]=nt,o[10]=tt*rt}else if(s.order==="ZYX"){const ot=tt*st,ct=tt*at,ft=nt*st,ht=nt*at;o[0]=rt*st,o[4]=ft*it-ct,o[8]=ot*it+ht,o[1]=rt*at,o[5]=ht*it+ot,o[9]=ct*it-ft,o[2]=-it,o[6]=nt*rt,o[10]=tt*rt}else if(s.order==="YZX"){const ot=tt*rt,ct=tt*it,ft=nt*rt,ht=nt*it;o[0]=rt*st,o[4]=ht-ot*at,o[8]=ft*at+ct,o[1]=at,o[5]=tt*st,o[9]=-nt*st,o[2]=-it*st,o[6]=ct*at+ft,o[10]=ot-ht*at}else if(s.order==="XZY"){const ot=tt*rt,ct=tt*it,ft=nt*rt,ht=nt*it;o[0]=rt*st,o[4]=-at,o[8]=it*st,o[1]=ot*at+ht,o[5]=tt*st,o[9]=ct*at-ft,o[2]=ft*at-ct,o[6]=nt*st,o[10]=ht*at+ot}return o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this}makeRotationFromQuaternion(s){return this.compose(_zero,s,_one)}lookAt(s,o,j){const $=this.elements;return _z.subVectors(s,o),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(j,_z),_x.lengthSq()===0&&(Math.abs(j.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(j,_z)),_x.normalize(),_y.crossVectors(_z,_x),$[0]=_x.x,$[4]=_y.x,$[8]=_z.x,$[1]=_x.y,$[5]=_y.y,$[9]=_z.y,$[2]=_x.z,$[6]=_y.z,$[10]=_z.z,this}multiply(s){return this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,o){const j=s.elements,$=o.elements,_e=this.elements,tt=j[0],nt=j[4],rt=j[8],it=j[12],st=j[1],at=j[5],ot=j[9],ct=j[13],ft=j[2],ht=j[6],mt=j[10],lt=j[14],ut=j[3],dt=j[7],gt=j[11],Et=j[15],St=$[0],Tt=$[4],Mt=$[8],Bt=$[12],Rt=$[1],Ut=$[5],Ht=$[9],Wt=$[13],Jt=$[2],sn=$[6],jt=$[10],Vt=$[14],Lt=$[3],Qt=$[7],nn=$[11],mn=$[15];return _e[0]=tt*St+nt*Rt+rt*Jt+it*Lt,_e[4]=tt*Tt+nt*Ut+rt*sn+it*Qt,_e[8]=tt*Mt+nt*Ht+rt*jt+it*nn,_e[12]=tt*Bt+nt*Wt+rt*Vt+it*mn,_e[1]=st*St+at*Rt+ot*Jt+ct*Lt,_e[5]=st*Tt+at*Ut+ot*sn+ct*Qt,_e[9]=st*Mt+at*Ht+ot*jt+ct*nn,_e[13]=st*Bt+at*Wt+ot*Vt+ct*mn,_e[2]=ft*St+ht*Rt+mt*Jt+lt*Lt,_e[6]=ft*Tt+ht*Ut+mt*sn+lt*Qt,_e[10]=ft*Mt+ht*Ht+mt*jt+lt*nn,_e[14]=ft*Bt+ht*Wt+mt*Vt+lt*mn,_e[3]=ut*St+dt*Rt+gt*Jt+Et*Lt,_e[7]=ut*Tt+dt*Ut+gt*sn+Et*Qt,_e[11]=ut*Mt+dt*Ht+gt*jt+Et*nn,_e[15]=ut*Bt+dt*Wt+gt*Vt+Et*mn,this}multiplyScalar(s){const o=this.elements;return o[0]*=s,o[4]*=s,o[8]*=s,o[12]*=s,o[1]*=s,o[5]*=s,o[9]*=s,o[13]*=s,o[2]*=s,o[6]*=s,o[10]*=s,o[14]*=s,o[3]*=s,o[7]*=s,o[11]*=s,o[15]*=s,this}determinant(){const s=this.elements,o=s[0],j=s[4],$=s[8],_e=s[12],tt=s[1],nt=s[5],rt=s[9],it=s[13],st=s[2],at=s[6],ot=s[10],ct=s[14],ft=s[3],ht=s[7],mt=s[11],lt=s[15];return ft*(+_e*rt*at-$*it*at-_e*nt*ot+j*it*ot+$*nt*ct-j*rt*ct)+ht*(+o*rt*ct-o*it*ot+_e*tt*ot-$*tt*ct+$*it*st-_e*rt*st)+mt*(+o*it*at-o*nt*ct-_e*tt*at+j*tt*ct+_e*nt*st-j*it*st)+lt*(-$*nt*st-o*rt*at+o*nt*ot+$*tt*at-j*tt*ot+j*rt*st)}transpose(){const s=this.elements;let o;return o=s[1],s[1]=s[4],s[4]=o,o=s[2],s[2]=s[8],s[8]=o,o=s[6],s[6]=s[9],s[9]=o,o=s[3],s[3]=s[12],s[12]=o,o=s[7],s[7]=s[13],s[13]=o,o=s[11],s[11]=s[14],s[14]=o,this}setPosition(s,o,j){const $=this.elements;return s.isVector3?($[12]=s.x,$[13]=s.y,$[14]=s.z):($[12]=s,$[13]=o,$[14]=j),this}invert(){const s=this.elements,o=s[0],j=s[1],$=s[2],_e=s[3],tt=s[4],nt=s[5],rt=s[6],it=s[7],st=s[8],at=s[9],ot=s[10],ct=s[11],ft=s[12],ht=s[13],mt=s[14],lt=s[15],ut=at*mt*it-ht*ot*it+ht*rt*ct-nt*mt*ct-at*rt*lt+nt*ot*lt,dt=ft*ot*it-st*mt*it-ft*rt*ct+tt*mt*ct+st*rt*lt-tt*ot*lt,gt=st*ht*it-ft*at*it+ft*nt*ct-tt*ht*ct-st*nt*lt+tt*at*lt,Et=ft*at*rt-st*ht*rt-ft*nt*ot+tt*ht*ot+st*nt*mt-tt*at*mt,St=o*ut+j*dt+$*gt+_e*Et;if(St===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Tt=1/St;return s[0]=ut*Tt,s[1]=(ht*ot*_e-at*mt*_e-ht*$*ct+j*mt*ct+at*$*lt-j*ot*lt)*Tt,s[2]=(nt*mt*_e-ht*rt*_e+ht*$*it-j*mt*it-nt*$*lt+j*rt*lt)*Tt,s[3]=(at*rt*_e-nt*ot*_e-at*$*it+j*ot*it+nt*$*ct-j*rt*ct)*Tt,s[4]=dt*Tt,s[5]=(st*mt*_e-ft*ot*_e+ft*$*ct-o*mt*ct-st*$*lt+o*ot*lt)*Tt,s[6]=(ft*rt*_e-tt*mt*_e-ft*$*it+o*mt*it+tt*$*lt-o*rt*lt)*Tt,s[7]=(tt*ot*_e-st*rt*_e+st*$*it-o*ot*it-tt*$*ct+o*rt*ct)*Tt,s[8]=gt*Tt,s[9]=(ft*at*_e-st*ht*_e-ft*j*ct+o*ht*ct+st*j*lt-o*at*lt)*Tt,s[10]=(tt*ht*_e-ft*nt*_e+ft*j*it-o*ht*it-tt*j*lt+o*nt*lt)*Tt,s[11]=(st*nt*_e-tt*at*_e-st*j*it+o*at*it+tt*j*ct-o*nt*ct)*Tt,s[12]=Et*Tt,s[13]=(st*ht*$-ft*at*$+ft*j*ot-o*ht*ot-st*j*mt+o*at*mt)*Tt,s[14]=(ft*nt*$-tt*ht*$-ft*j*rt+o*ht*rt+tt*j*mt-o*nt*mt)*Tt,s[15]=(tt*at*$-st*nt*$+st*j*rt-o*at*rt-tt*j*ot+o*nt*ot)*Tt,this}scale(s){const o=this.elements,j=s.x,$=s.y,_e=s.z;return o[0]*=j,o[4]*=$,o[8]*=_e,o[1]*=j,o[5]*=$,o[9]*=_e,o[2]*=j,o[6]*=$,o[10]*=_e,o[3]*=j,o[7]*=$,o[11]*=_e,this}getMaxScaleOnAxis(){const s=this.elements,o=s[0]*s[0]+s[1]*s[1]+s[2]*s[2],j=s[4]*s[4]+s[5]*s[5]+s[6]*s[6],$=s[8]*s[8]+s[9]*s[9]+s[10]*s[10];return Math.sqrt(Math.max(o,j,$))}makeTranslation(s,o,j){return s.isVector3?this.set(1,0,0,s.x,0,1,0,s.y,0,0,1,s.z,0,0,0,1):this.set(1,0,0,s,0,1,0,o,0,0,1,j,0,0,0,1),this}makeRotationX(s){const o=Math.cos(s),j=Math.sin(s);return this.set(1,0,0,0,0,o,-j,0,0,j,o,0,0,0,0,1),this}makeRotationY(s){const o=Math.cos(s),j=Math.sin(s);return this.set(o,0,j,0,0,1,0,0,-j,0,o,0,0,0,0,1),this}makeRotationZ(s){const o=Math.cos(s),j=Math.sin(s);return this.set(o,-j,0,0,j,o,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(s,o){const j=Math.cos(o),$=Math.sin(o),_e=1-j,tt=s.x,nt=s.y,rt=s.z,it=_e*tt,st=_e*nt;return this.set(it*tt+j,it*nt-$*rt,it*rt+$*nt,0,it*nt+$*rt,st*nt+j,st*rt-$*tt,0,it*rt-$*nt,st*rt+$*tt,_e*rt*rt+j,0,0,0,0,1),this}makeScale(s,o,j){return this.set(s,0,0,0,0,o,0,0,0,0,j,0,0,0,0,1),this}makeShear(s,o,j,$,_e,tt){return this.set(1,j,_e,0,s,1,tt,0,o,$,1,0,0,0,0,1),this}compose(s,o,j){const $=this.elements,_e=o._x,tt=o._y,nt=o._z,rt=o._w,it=_e+_e,st=tt+tt,at=nt+nt,ot=_e*it,ct=_e*st,ft=_e*at,ht=tt*st,mt=tt*at,lt=nt*at,ut=rt*it,dt=rt*st,gt=rt*at,Et=j.x,St=j.y,Tt=j.z;return $[0]=(1-(ht+lt))*Et,$[1]=(ct+gt)*Et,$[2]=(ft-dt)*Et,$[3]=0,$[4]=(ct-gt)*St,$[5]=(1-(ot+lt))*St,$[6]=(mt+ut)*St,$[7]=0,$[8]=(ft+dt)*Tt,$[9]=(mt-ut)*Tt,$[10]=(1-(ot+ht))*Tt,$[11]=0,$[12]=s.x,$[13]=s.y,$[14]=s.z,$[15]=1,this}decompose(s,o,j){const $=this.elements;let _e=_v1$5$1.set($[0],$[1],$[2]).length();const tt=_v1$5$1.set($[4],$[5],$[6]).length(),nt=_v1$5$1.set($[8],$[9],$[10]).length();this.determinant()<0&&(_e=-_e),s.x=$[12],s.y=$[13],s.z=$[14],_m1$2.copy(this);const it=1/_e,st=1/tt,at=1/nt;return _m1$2.elements[0]*=it,_m1$2.elements[1]*=it,_m1$2.elements[2]*=it,_m1$2.elements[4]*=st,_m1$2.elements[5]*=st,_m1$2.elements[6]*=st,_m1$2.elements[8]*=at,_m1$2.elements[9]*=at,_m1$2.elements[10]*=at,o.setFromRotationMatrix(_m1$2),j.x=_e,j.y=tt,j.z=nt,this}makePerspective(s,o,j,$,_e,tt,nt=WebGLCoordinateSystem){const rt=this.elements,it=2*_e/(o-s),st=2*_e/(j-$),at=(o+s)/(o-s),ot=(j+$)/(j-$);let ct,ft;if(nt===WebGLCoordinateSystem)ct=-(tt+_e)/(tt-_e),ft=-2*tt*_e/(tt-_e);else if(nt===WebGPUCoordinateSystem)ct=-tt/(tt-_e),ft=-tt*_e/(tt-_e);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+nt);return rt[0]=it,rt[4]=0,rt[8]=at,rt[12]=0,rt[1]=0,rt[5]=st,rt[9]=ot,rt[13]=0,rt[2]=0,rt[6]=0,rt[10]=ct,rt[14]=ft,rt[3]=0,rt[7]=0,rt[11]=-1,rt[15]=0,this}makeOrthographic(s,o,j,$,_e,tt,nt=WebGLCoordinateSystem){const rt=this.elements,it=1/(o-s),st=1/(j-$),at=1/(tt-_e),ot=(o+s)*it,ct=(j+$)*st;let ft,ht;if(nt===WebGLCoordinateSystem)ft=(tt+_e)*at,ht=-2*at;else if(nt===WebGPUCoordinateSystem)ft=_e*at,ht=-1*at;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+nt);return rt[0]=2*it,rt[4]=0,rt[8]=0,rt[12]=-ot,rt[1]=0,rt[5]=2*st,rt[9]=0,rt[13]=-ct,rt[2]=0,rt[6]=0,rt[10]=ht,rt[14]=-ft,rt[3]=0,rt[7]=0,rt[11]=0,rt[15]=1,this}equals(s){const o=this.elements,j=s.elements;for(let $=0;$<16;$++)if(o[$]!==j[$])return!1;return!0}fromArray(s,o=0){for(let j=0;j<16;j++)this.elements[j]=s[j+o];return this}toArray(s=[],o=0){const j=this.elements;return s[o]=j[0],s[o+1]=j[1],s[o+2]=j[2],s[o+3]=j[3],s[o+4]=j[4],s[o+5]=j[5],s[o+6]=j[6],s[o+7]=j[7],s[o+8]=j[8],s[o+9]=j[9],s[o+10]=j[10],s[o+11]=j[11],s[o+12]=j[12],s[o+13]=j[13],s[o+14]=j[14],s[o+15]=j[15],s}}const _v1$5$1=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(s=0,o=0,j=0,$=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=s,this._y=o,this._z=j,this._order=$}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get order(){return this._order}set order(s){this._order=s,this._onChangeCallback()}set(s,o,j,$=this._order){return this._x=s,this._y=o,this._z=j,this._order=$,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(s){return this._x=s._x,this._y=s._y,this._z=s._z,this._order=s._order,this._onChangeCallback(),this}setFromRotationMatrix(s,o=this._order,j=!0){const $=s.elements,_e=$[0],tt=$[4],nt=$[8],rt=$[1],it=$[5],st=$[9],at=$[2],ot=$[6],ct=$[10];switch(o){case"XYZ":this._y=Math.asin(clamp$2(nt,-1,1)),Math.abs(nt)<.9999999?(this._x=Math.atan2(-st,ct),this._z=Math.atan2(-tt,_e)):(this._x=Math.atan2(ot,it),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$2(st,-1,1)),Math.abs(st)<.9999999?(this._y=Math.atan2(nt,ct),this._z=Math.atan2(rt,it)):(this._y=Math.atan2(-at,_e),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$2(ot,-1,1)),Math.abs(ot)<.9999999?(this._y=Math.atan2(-at,ct),this._z=Math.atan2(-tt,it)):(this._y=0,this._z=Math.atan2(rt,_e));break;case"ZYX":this._y=Math.asin(-clamp$2(at,-1,1)),Math.abs(at)<.9999999?(this._x=Math.atan2(ot,ct),this._z=Math.atan2(rt,_e)):(this._x=0,this._z=Math.atan2(-tt,it));break;case"YZX":this._z=Math.asin(clamp$2(rt,-1,1)),Math.abs(rt)<.9999999?(this._x=Math.atan2(-st,it),this._y=Math.atan2(-at,_e)):(this._x=0,this._y=Math.atan2(nt,ct));break;case"XZY":this._z=Math.asin(-clamp$2(tt,-1,1)),Math.abs(tt)<.9999999?(this._x=Math.atan2(ot,it),this._y=Math.atan2(nt,_e)):(this._x=Math.atan2(-st,ct),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+o)}return this._order=o,j===!0&&this._onChangeCallback(),this}setFromQuaternion(s,o,j){return _matrix.makeRotationFromQuaternion(s),this.setFromRotationMatrix(_matrix,o,j)}setFromVector3(s,o=this._order){return this.set(s.x,s.y,s.z,o)}reorder(s){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,s)}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._order===this._order}fromArray(s){return this._x=s[0],this._y=s[1],this._z=s[2],s[3]!==void 0&&(this._order=s[3]),this._onChangeCallback(),this}toArray(s=[],o=0){return s[o]=this._x,s[o+1]=this._y,s[o+2]=this._z,s[o+3]=this._order,s}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(s){this.mask=(1<<s|0)>>>0}enable(s){this.mask|=1<<s|0}enableAll(){this.mask=-1}toggle(s){this.mask^=1<<s|0}disable(s){this.mask&=~(1<<s|0)}disableAll(){this.mask=0}test(s){return(this.mask&s.mask)!==0}isEnabled(s){return(this.mask&(1<<s|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const s=new Vector3,o=new Euler,j=new Quaternion,$=new Vector3(1,1,1);function _e(){j.setFromEuler(o,!1)}function tt(){o.setFromQuaternion(j,void 0,!1)}o._onChange(_e),j._onChange(tt),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:s},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:j},scale:{configurable:!0,enumerable:!0,value:$},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(s){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(s),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(s){return this.quaternion.premultiply(s),this}setRotationFromAxisAngle(s,o){this.quaternion.setFromAxisAngle(s,o)}setRotationFromEuler(s){this.quaternion.setFromEuler(s,!0)}setRotationFromMatrix(s){this.quaternion.setFromRotationMatrix(s)}setRotationFromQuaternion(s){this.quaternion.copy(s)}rotateOnAxis(s,o){return _q1.setFromAxisAngle(s,o),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(s,o){return _q1.setFromAxisAngle(s,o),this.quaternion.premultiply(_q1),this}rotateX(s){return this.rotateOnAxis(_xAxis,s)}rotateY(s){return this.rotateOnAxis(_yAxis,s)}rotateZ(s){return this.rotateOnAxis(_zAxis,s)}translateOnAxis(s,o){return _v1$4.copy(s).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(o)),this}translateX(s){return this.translateOnAxis(_xAxis,s)}translateY(s){return this.translateOnAxis(_yAxis,s)}translateZ(s){return this.translateOnAxis(_zAxis,s)}localToWorld(s){return this.updateWorldMatrix(!0,!1),s.applyMatrix4(this.matrixWorld)}worldToLocal(s){return this.updateWorldMatrix(!0,!1),s.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(s,o,j){s.isVector3?_target.copy(s):_target.set(s,o,j);const $=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),$&&(_m1$1.extractRotation($.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(s){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return s===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",s),this):(s&&s.isObject3D?(s.parent!==null&&s.parent.remove(s),s.parent=this,this.children.push(s),s.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",s),this)}remove(s){if(arguments.length>1){for(let j=0;j<arguments.length;j++)this.remove(arguments[j]);return this}const o=this.children.indexOf(s);return o!==-1&&(s.parent=null,this.children.splice(o,1),s.dispatchEvent(_removedEvent)),this}removeFromParent(){const s=this.parent;return s!==null&&s.remove(this),this}clear(){for(let s=0;s<this.children.length;s++){const o=this.children[s];o.parent=null,o.dispatchEvent(_removedEvent)}return this.children.length=0,this}attach(s){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),s.parent!==null&&(s.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(s.parent.matrixWorld)),s.applyMatrix4(_m1$1),this.add(s),s.updateWorldMatrix(!1,!0),this}getObjectById(s){return this.getObjectByProperty("id",s)}getObjectByName(s){return this.getObjectByProperty("name",s)}getObjectByProperty(s,o){if(this[s]===o)return this;for(let j=0,$=this.children.length;j<$;j++){const tt=this.children[j].getObjectByProperty(s,o);if(tt!==void 0)return tt}}getObjectsByProperty(s,o){let j=[];this[s]===o&&j.push(this);for(let $=0,_e=this.children.length;$<_e;$++){const tt=this.children[$].getObjectsByProperty(s,o);tt.length>0&&(j=j.concat(tt))}return j}getWorldPosition(s){return this.updateWorldMatrix(!0,!1),s.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(s){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,s,_scale$2),s}getWorldScale(s){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,s),s}getWorldDirection(s){this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return s.set(o[8],o[9],o[10]).normalize()}raycast(){}traverse(s){s(this);const o=this.children;for(let j=0,$=o.length;j<$;j++)o[j].traverse(s)}traverseVisible(s){if(this.visible===!1)return;s(this);const o=this.children;for(let j=0,$=o.length;j<$;j++)o[j].traverseVisible(s)}traverseAncestors(s){const o=this.parent;o!==null&&(s(o),o.traverseAncestors(s))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(s){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||s)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,s=!0);const o=this.children;for(let j=0,$=o.length;j<$;j++){const _e=o[j];(_e.matrixWorldAutoUpdate===!0||s===!0)&&_e.updateMatrixWorld(s)}}updateWorldMatrix(s,o){const j=this.parent;if(s===!0&&j!==null&&j.matrixWorldAutoUpdate===!0&&j.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),o===!0){const $=this.children;for(let _e=0,tt=$.length;_e<tt;_e++){const nt=$[_e];nt.matrixWorldAutoUpdate===!0&&nt.updateWorldMatrix(!1,!0)}}}toJSON(s){const o=s===void 0||typeof s=="string",j={};o&&(s={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},j.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const $={};$.uuid=this.uuid,$.type=this.type,this.name!==""&&($.name=this.name),this.castShadow===!0&&($.castShadow=!0),this.receiveShadow===!0&&($.receiveShadow=!0),this.visible===!1&&($.visible=!1),this.frustumCulled===!1&&($.frustumCulled=!1),this.renderOrder!==0&&($.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&($.userData=this.userData),$.layers=this.layers.mask,$.matrix=this.matrix.toArray(),$.up=this.up.toArray(),this.matrixAutoUpdate===!1&&($.matrixAutoUpdate=!1),this.isInstancedMesh&&($.type="InstancedMesh",$.count=this.count,$.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&($.instanceColor=this.instanceColor.toJSON()));function _e(nt,rt){return nt[rt.uuid]===void 0&&(nt[rt.uuid]=rt.toJSON(s)),rt.uuid}if(this.isScene)this.background&&(this.background.isColor?$.background=this.background.toJSON():this.background.isTexture&&($.background=this.background.toJSON(s).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&($.environment=this.environment.toJSON(s).uuid);else if(this.isMesh||this.isLine||this.isPoints){$.geometry=_e(s.geometries,this.geometry);const nt=this.geometry.parameters;if(nt!==void 0&&nt.shapes!==void 0){const rt=nt.shapes;if(Array.isArray(rt))for(let it=0,st=rt.length;it<st;it++){const at=rt[it];_e(s.shapes,at)}else _e(s.shapes,rt)}}if(this.isSkinnedMesh&&($.bindMode=this.bindMode,$.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(_e(s.skeletons,this.skeleton),$.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const nt=[];for(let rt=0,it=this.material.length;rt<it;rt++)nt.push(_e(s.materials,this.material[rt]));$.material=nt}else $.material=_e(s.materials,this.material);if(this.children.length>0){$.children=[];for(let nt=0;nt<this.children.length;nt++)$.children.push(this.children[nt].toJSON(s).object)}if(this.animations.length>0){$.animations=[];for(let nt=0;nt<this.animations.length;nt++){const rt=this.animations[nt];$.animations.push(_e(s.animations,rt))}}if(o){const nt=tt(s.geometries),rt=tt(s.materials),it=tt(s.textures),st=tt(s.images),at=tt(s.shapes),ot=tt(s.skeletons),ct=tt(s.animations),ft=tt(s.nodes);nt.length>0&&(j.geometries=nt),rt.length>0&&(j.materials=rt),it.length>0&&(j.textures=it),st.length>0&&(j.images=st),at.length>0&&(j.shapes=at),ot.length>0&&(j.skeletons=ot),ct.length>0&&(j.animations=ct),ft.length>0&&(j.nodes=ft)}return j.object=$,j;function tt(nt){const rt=[];for(const it in nt){const st=nt[it];delete st.metadata,rt.push(st)}return rt}}clone(s){return new this.constructor().copy(this,s)}copy(s,o=!0){if(this.name=s.name,this.up.copy(s.up),this.position.copy(s.position),this.rotation.order=s.rotation.order,this.quaternion.copy(s.quaternion),this.scale.copy(s.scale),this.matrix.copy(s.matrix),this.matrixWorld.copy(s.matrixWorld),this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrixWorldNeedsUpdate=s.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=s.matrixWorldAutoUpdate,this.layers.mask=s.layers.mask,this.visible=s.visible,this.castShadow=s.castShadow,this.receiveShadow=s.receiveShadow,this.frustumCulled=s.frustumCulled,this.renderOrder=s.renderOrder,this.animations=s.animations,this.userData=JSON.parse(JSON.stringify(s.userData)),o===!0)for(let j=0;j<s.children.length;j++){const $=s.children[j];this.add($.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(s=new Vector3,o=new Vector3,j=new Vector3){this.a=s,this.b=o,this.c=j}static getNormal(s,o,j,$){$.subVectors(j,o),_v0$1.subVectors(s,o),$.cross(_v0$1);const _e=$.lengthSq();return _e>0?$.multiplyScalar(1/Math.sqrt(_e)):$.set(0,0,0)}static getBarycoord(s,o,j,$,_e){_v0$1.subVectors($,o),_v1$3.subVectors(j,o),_v2$2.subVectors(s,o);const tt=_v0$1.dot(_v0$1),nt=_v0$1.dot(_v1$3),rt=_v0$1.dot(_v2$2),it=_v1$3.dot(_v1$3),st=_v1$3.dot(_v2$2),at=tt*it-nt*nt;if(at===0)return _e.set(-2,-1,-1);const ot=1/at,ct=(it*rt-nt*st)*ot,ft=(tt*st-nt*rt)*ot;return _e.set(1-ct-ft,ft,ct)}static containsPoint(s,o,j,$){return this.getBarycoord(s,o,j,$,_v3$1),_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(s,o,j,$,_e,tt,nt,rt){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(s,o,j,$,_e,tt,nt,rt)}static getInterpolation(s,o,j,$,_e,tt,nt,rt){return this.getBarycoord(s,o,j,$,_v3$1),rt.setScalar(0),rt.addScaledVector(_e,_v3$1.x),rt.addScaledVector(tt,_v3$1.y),rt.addScaledVector(nt,_v3$1.z),rt}static isFrontFacing(s,o,j,$){return _v0$1.subVectors(j,o),_v1$3.subVectors(s,o),_v0$1.cross(_v1$3).dot($)<0}set(s,o,j){return this.a.copy(s),this.b.copy(o),this.c.copy(j),this}setFromPointsAndIndices(s,o,j,$){return this.a.copy(s[o]),this.b.copy(s[j]),this.c.copy(s[$]),this}setFromAttributeAndIndices(s,o,j,$){return this.a.fromBufferAttribute(s,o),this.b.fromBufferAttribute(s,j),this.c.fromBufferAttribute(s,$),this}clone(){return new this.constructor().copy(this)}copy(s){return this.a.copy(s.a),this.b.copy(s.b),this.c.copy(s.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(s){return s.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(s){return Triangle.getNormal(this.a,this.b,this.c,s)}getPlane(s){return s.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(s,o){return Triangle.getBarycoord(s,this.a,this.b,this.c,o)}getUV(s,o,j,$,_e){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(s,this.a,this.b,this.c,o,j,$,_e)}getInterpolation(s,o,j,$,_e){return Triangle.getInterpolation(s,this.a,this.b,this.c,o,j,$,_e)}containsPoint(s){return Triangle.containsPoint(s,this.a,this.b,this.c)}isFrontFacing(s){return Triangle.isFrontFacing(this.a,this.b,this.c,s)}intersectsBox(s){return s.intersectsTriangle(this)}closestPointToPoint(s,o){const j=this.a,$=this.b,_e=this.c;let tt,nt;_vab.subVectors($,j),_vac.subVectors(_e,j),_vap.subVectors(s,j);const rt=_vab.dot(_vap),it=_vac.dot(_vap);if(rt<=0&&it<=0)return o.copy(j);_vbp.subVectors(s,$);const st=_vab.dot(_vbp),at=_vac.dot(_vbp);if(st>=0&&at<=st)return o.copy($);const ot=rt*at-st*it;if(ot<=0&&rt>=0&&st<=0)return tt=rt/(rt-st),o.copy(j).addScaledVector(_vab,tt);_vcp.subVectors(s,_e);const ct=_vab.dot(_vcp),ft=_vac.dot(_vcp);if(ft>=0&&ct<=ft)return o.copy(_e);const ht=ct*it-rt*ft;if(ht<=0&&it>=0&&ft<=0)return nt=it/(it-ft),o.copy(j).addScaledVector(_vac,nt);const mt=st*ft-ct*at;if(mt<=0&&at-st>=0&&ct-ft>=0)return _vbc.subVectors(_e,$),nt=(at-st)/(at-st+(ct-ft)),o.copy($).addScaledVector(_vbc,nt);const lt=1/(mt+ht+ot);return tt=ht*lt,nt=ot*lt,o.copy(j).addScaledVector(_vab,tt).addScaledVector(_vac,nt)}equals(s){return s.a.equals(this.a)&&s.b.equals(this.b)&&s.c.equals(this.c)}}let materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(s){this._alphaTest>0!=s>0&&this.version++,this._alphaTest=s}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(s){if(s!==void 0)for(const o in s){const j=s[o];if(j===void 0){console.warn(`THREE.Material: parameter '${o}' has value of undefined.`);continue}const $=this[o];if($===void 0){console.warn(`THREE.Material: '${o}' is not a property of THREE.${this.type}.`);continue}$&&$.isColor?$.set(j):$&&$.isVector3&&j&&j.isVector3?$.copy(j):this[o]=j}}toJSON(s){const o=s===void 0||typeof s=="string";o&&(s={textures:{},images:{}});const j={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};j.uuid=this.uuid,j.type=this.type,this.name!==""&&(j.name=this.name),this.color&&this.color.isColor&&(j.color=this.color.getHex()),this.roughness!==void 0&&(j.roughness=this.roughness),this.metalness!==void 0&&(j.metalness=this.metalness),this.sheen!==void 0&&(j.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(j.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(j.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(j.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(j.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(j.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(j.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(j.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(j.shininess=this.shininess),this.clearcoat!==void 0&&(j.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(j.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(j.clearcoatMap=this.clearcoatMap.toJSON(s).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(j.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(s).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(j.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(s).uuid,j.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(j.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(j.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(j.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(j.iridescenceMap=this.iridescenceMap.toJSON(s).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(j.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(s).uuid),this.anisotropy!==void 0&&(j.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(j.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(j.anisotropyMap=this.anisotropyMap.toJSON(s).uuid),this.map&&this.map.isTexture&&(j.map=this.map.toJSON(s).uuid),this.matcap&&this.matcap.isTexture&&(j.matcap=this.matcap.toJSON(s).uuid),this.alphaMap&&this.alphaMap.isTexture&&(j.alphaMap=this.alphaMap.toJSON(s).uuid),this.lightMap&&this.lightMap.isTexture&&(j.lightMap=this.lightMap.toJSON(s).uuid,j.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(j.aoMap=this.aoMap.toJSON(s).uuid,j.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(j.bumpMap=this.bumpMap.toJSON(s).uuid,j.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(j.normalMap=this.normalMap.toJSON(s).uuid,j.normalMapType=this.normalMapType,j.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(j.displacementMap=this.displacementMap.toJSON(s).uuid,j.displacementScale=this.displacementScale,j.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(j.roughnessMap=this.roughnessMap.toJSON(s).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(j.metalnessMap=this.metalnessMap.toJSON(s).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(j.emissiveMap=this.emissiveMap.toJSON(s).uuid),this.specularMap&&this.specularMap.isTexture&&(j.specularMap=this.specularMap.toJSON(s).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(j.specularIntensityMap=this.specularIntensityMap.toJSON(s).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(j.specularColorMap=this.specularColorMap.toJSON(s).uuid),this.envMap&&this.envMap.isTexture&&(j.envMap=this.envMap.toJSON(s).uuid,this.combine!==void 0&&(j.combine=this.combine)),this.envMapIntensity!==void 0&&(j.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(j.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(j.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(j.gradientMap=this.gradientMap.toJSON(s).uuid),this.transmission!==void 0&&(j.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(j.transmissionMap=this.transmissionMap.toJSON(s).uuid),this.thickness!==void 0&&(j.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(j.thicknessMap=this.thicknessMap.toJSON(s).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(j.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(j.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(j.size=this.size),this.shadowSide!==null&&(j.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(j.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(j.blending=this.blending),this.side!==FrontSide&&(j.side=this.side),this.vertexColors&&(j.vertexColors=!0),this.opacity<1&&(j.opacity=this.opacity),this.transparent===!0&&(j.transparent=this.transparent),j.depthFunc=this.depthFunc,j.depthTest=this.depthTest,j.depthWrite=this.depthWrite,j.colorWrite=this.colorWrite,j.stencilWrite=this.stencilWrite,j.stencilWriteMask=this.stencilWriteMask,j.stencilFunc=this.stencilFunc,j.stencilRef=this.stencilRef,j.stencilFuncMask=this.stencilFuncMask,j.stencilFail=this.stencilFail,j.stencilZFail=this.stencilZFail,j.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(j.rotation=this.rotation),this.polygonOffset===!0&&(j.polygonOffset=!0),this.polygonOffsetFactor!==0&&(j.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(j.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(j.linewidth=this.linewidth),this.dashSize!==void 0&&(j.dashSize=this.dashSize),this.gapSize!==void 0&&(j.gapSize=this.gapSize),this.scale!==void 0&&(j.scale=this.scale),this.dithering===!0&&(j.dithering=!0),this.alphaTest>0&&(j.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(j.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(j.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(j.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(j.wireframe=this.wireframe),this.wireframeLinewidth>1&&(j.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(j.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(j.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(j.flatShading=this.flatShading),this.visible===!1&&(j.visible=!1),this.toneMapped===!1&&(j.toneMapped=!1),this.fog===!1&&(j.fog=!1),Object.keys(this.userData).length>0&&(j.userData=this.userData);function $(_e){const tt=[];for(const nt in _e){const rt=_e[nt];delete rt.metadata,tt.push(rt)}return tt}if(o){const _e=$(s.textures),tt=$(s.images);_e.length>0&&(j.textures=_e),tt.length>0&&(j.images=tt)}return j}clone(){return new this.constructor().copy(this)}copy(s){this.name=s.name,this.blending=s.blending,this.side=s.side,this.vertexColors=s.vertexColors,this.opacity=s.opacity,this.transparent=s.transparent,this.blendSrc=s.blendSrc,this.blendDst=s.blendDst,this.blendEquation=s.blendEquation,this.blendSrcAlpha=s.blendSrcAlpha,this.blendDstAlpha=s.blendDstAlpha,this.blendEquationAlpha=s.blendEquationAlpha,this.depthFunc=s.depthFunc,this.depthTest=s.depthTest,this.depthWrite=s.depthWrite,this.stencilWriteMask=s.stencilWriteMask,this.stencilFunc=s.stencilFunc,this.stencilRef=s.stencilRef,this.stencilFuncMask=s.stencilFuncMask,this.stencilFail=s.stencilFail,this.stencilZFail=s.stencilZFail,this.stencilZPass=s.stencilZPass,this.stencilWrite=s.stencilWrite;const o=s.clippingPlanes;let j=null;if(o!==null){const $=o.length;j=new Array($);for(let _e=0;_e!==$;++_e)j[_e]=o[_e].clone()}return this.clippingPlanes=j,this.clipIntersection=s.clipIntersection,this.clipShadows=s.clipShadows,this.shadowSide=s.shadowSide,this.colorWrite=s.colorWrite,this.precision=s.precision,this.polygonOffset=s.polygonOffset,this.polygonOffsetFactor=s.polygonOffsetFactor,this.polygonOffsetUnits=s.polygonOffsetUnits,this.dithering=s.dithering,this.alphaTest=s.alphaTest,this.alphaToCoverage=s.alphaToCoverage,this.premultipliedAlpha=s.premultipliedAlpha,this.forceSinglePass=s.forceSinglePass,this.visible=s.visible,this.toneMapped=s.toneMapped,this.userData=JSON.parse(JSON.stringify(s.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(s){s===!0&&this.version++}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(a,s,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?a+(s-a)*6*o:o<1/2?s:o<2/3?a+(s-a)*6*(2/3-o):a}class Color{constructor(s,o,j){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(s,o,j)}set(s,o,j){if(o===void 0&&j===void 0){const $=s;$&&$.isColor?this.copy($):typeof $=="number"?this.setHex($):typeof $=="string"&&this.setStyle($)}else this.setRGB(s,o,j);return this}setScalar(s){return this.r=s,this.g=s,this.b=s,this}setHex(s,o=SRGBColorSpace){return s=Math.floor(s),this.r=(s>>16&255)/255,this.g=(s>>8&255)/255,this.b=(s&255)/255,ColorManagement.toWorkingColorSpace(this,o),this}setRGB(s,o,j,$=ColorManagement.workingColorSpace){return this.r=s,this.g=o,this.b=j,ColorManagement.toWorkingColorSpace(this,$),this}setHSL(s,o,j,$=ColorManagement.workingColorSpace){if(s=euclideanModulo(s,1),o=clamp$2(o,0,1),j=clamp$2(j,0,1),o===0)this.r=this.g=this.b=j;else{const _e=j<=.5?j*(1+o):j+o-j*o,tt=2*j-_e;this.r=hue2rgb(tt,_e,s+1/3),this.g=hue2rgb(tt,_e,s),this.b=hue2rgb(tt,_e,s-1/3)}return ColorManagement.toWorkingColorSpace(this,$),this}setStyle(s,o=SRGBColorSpace){function j(_e){_e!==void 0&&parseFloat(_e)<1&&console.warn("THREE.Color: Alpha component of "+s+" will be ignored.")}let $;if($=/^(\w+)\(([^\)]*)\)/.exec(s)){let _e;const tt=$[1],nt=$[2];switch(tt){case"rgb":case"rgba":if(_e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(nt))return j(_e[4]),this.setRGB(Math.min(255,parseInt(_e[1],10))/255,Math.min(255,parseInt(_e[2],10))/255,Math.min(255,parseInt(_e[3],10))/255,o);if(_e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(nt))return j(_e[4]),this.setRGB(Math.min(100,parseInt(_e[1],10))/100,Math.min(100,parseInt(_e[2],10))/100,Math.min(100,parseInt(_e[3],10))/100,o);break;case"hsl":case"hsla":if(_e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(nt))return j(_e[4]),this.setHSL(parseFloat(_e[1])/360,parseFloat(_e[2])/100,parseFloat(_e[3])/100,o);break;default:console.warn("THREE.Color: Unknown color model "+s)}}else if($=/^\#([A-Fa-f\d]+)$/.exec(s)){const _e=$[1],tt=_e.length;if(tt===3)return this.setRGB(parseInt(_e.charAt(0),16)/15,parseInt(_e.charAt(1),16)/15,parseInt(_e.charAt(2),16)/15,o);if(tt===6)return this.setHex(parseInt(_e,16),o);console.warn("THREE.Color: Invalid hex color "+s)}else if(s&&s.length>0)return this.setColorName(s,o);return this}setColorName(s,o=SRGBColorSpace){const j=_colorKeywords[s.toLowerCase()];return j!==void 0?this.setHex(j,o):console.warn("THREE.Color: Unknown color "+s),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(s){return this.r=s.r,this.g=s.g,this.b=s.b,this}copySRGBToLinear(s){return this.r=SRGBToLinear(s.r),this.g=SRGBToLinear(s.g),this.b=SRGBToLinear(s.b),this}copyLinearToSRGB(s){return this.r=LinearToSRGB(s.r),this.g=LinearToSRGB(s.g),this.b=LinearToSRGB(s.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(s=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),s),Math.round(clamp$2(_color.r*255,0,255))*65536+Math.round(clamp$2(_color.g*255,0,255))*256+Math.round(clamp$2(_color.b*255,0,255))}getHexString(s=SRGBColorSpace){return("000000"+this.getHex(s).toString(16)).slice(-6)}getHSL(s,o=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),o);const j=_color.r,$=_color.g,_e=_color.b,tt=Math.max(j,$,_e),nt=Math.min(j,$,_e);let rt,it;const st=(nt+tt)/2;if(nt===tt)rt=0,it=0;else{const at=tt-nt;switch(it=st<=.5?at/(tt+nt):at/(2-tt-nt),tt){case j:rt=($-_e)/at+($<_e?6:0);break;case $:rt=(_e-j)/at+2;break;case _e:rt=(j-$)/at+4;break}rt/=6}return s.h=rt,s.s=it,s.l=st,s}getRGB(s,o=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),o),s.r=_color.r,s.g=_color.g,s.b=_color.b,s}getStyle(s=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),s);const o=_color.r,j=_color.g,$=_color.b;return s!==SRGBColorSpace?`color(${s} ${o.toFixed(3)} ${j.toFixed(3)} ${$.toFixed(3)})`:`rgb(${Math.round(o*255)},${Math.round(j*255)},${Math.round($*255)})`}offsetHSL(s,o,j){return this.getHSL(_hslA),_hslA.h+=s,_hslA.s+=o,_hslA.l+=j,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this}add(s){return this.r+=s.r,this.g+=s.g,this.b+=s.b,this}addColors(s,o){return this.r=s.r+o.r,this.g=s.g+o.g,this.b=s.b+o.b,this}addScalar(s){return this.r+=s,this.g+=s,this.b+=s,this}sub(s){return this.r=Math.max(0,this.r-s.r),this.g=Math.max(0,this.g-s.g),this.b=Math.max(0,this.b-s.b),this}multiply(s){return this.r*=s.r,this.g*=s.g,this.b*=s.b,this}multiplyScalar(s){return this.r*=s,this.g*=s,this.b*=s,this}lerp(s,o){return this.r+=(s.r-this.r)*o,this.g+=(s.g-this.g)*o,this.b+=(s.b-this.b)*o,this}lerpColors(s,o,j){return this.r=s.r+(o.r-s.r)*j,this.g=s.g+(o.g-s.g)*j,this.b=s.b+(o.b-s.b)*j,this}lerpHSL(s,o){this.getHSL(_hslA),s.getHSL(_hslB);const j=lerp(_hslA.h,_hslB.h,o),$=lerp(_hslA.s,_hslB.s,o),_e=lerp(_hslA.l,_hslB.l,o);return this.setHSL(j,$,_e),this}setFromVector3(s){return this.r=s.x,this.g=s.y,this.b=s.z,this}applyMatrix3(s){const o=this.r,j=this.g,$=this.b,_e=s.elements;return this.r=_e[0]*o+_e[3]*j+_e[6]*$,this.g=_e[1]*o+_e[4]*j+_e[7]*$,this.b=_e[2]*o+_e[5]*j+_e[8]*$,this}equals(s){return s.r===this.r&&s.g===this.g&&s.b===this.b}fromArray(s,o=0){return this.r=s[o],this.g=s[o+1],this.b=s[o+2],this}toArray(s=[],o=0){return s[o]=this.r,s[o+1]=this.g,s[o+2]=this.b,s}fromBufferAttribute(s,o){return this.r=s.getX(o),this.g=s.getY(o),this.b=s.getZ(o),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;class MeshBasicMaterial extends Material{constructor(s){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.fog=s.fog,this}}const _tables=_generateTables();function _generateTables(){const a=new ArrayBuffer(4),s=new Float32Array(a),o=new Uint32Array(a),j=new Uint32Array(512),$=new Uint32Array(512);for(let rt=0;rt<256;++rt){const it=rt-127;it<-27?(j[rt]=0,j[rt|256]=32768,$[rt]=24,$[rt|256]=24):it<-14?(j[rt]=1024>>-it-14,j[rt|256]=1024>>-it-14|32768,$[rt]=-it-1,$[rt|256]=-it-1):it<=15?(j[rt]=it+15<<10,j[rt|256]=it+15<<10|32768,$[rt]=13,$[rt|256]=13):it<128?(j[rt]=31744,j[rt|256]=64512,$[rt]=24,$[rt|256]=24):(j[rt]=31744,j[rt|256]=64512,$[rt]=13,$[rt|256]=13)}const _e=new Uint32Array(2048),tt=new Uint32Array(64),nt=new Uint32Array(64);for(let rt=1;rt<1024;++rt){let it=rt<<13,st=0;for(;!(it&8388608);)it<<=1,st-=8388608;it&=-8388609,st+=947912704,_e[rt]=it|st}for(let rt=1024;rt<2048;++rt)_e[rt]=939524096+(rt-1024<<13);for(let rt=1;rt<31;++rt)tt[rt]=rt<<23;tt[31]=1199570944,tt[32]=2147483648;for(let rt=33;rt<63;++rt)tt[rt]=2147483648+(rt-32<<23);tt[63]=3347054592;for(let rt=1;rt<64;++rt)rt!==32&&(nt[rt]=1024);return{floatView:s,uint32View:o,baseTable:j,shiftTable:$,mantissaTable:_e,exponentTable:tt,offsetTable:nt}}function toHalfFloat(a){Math.abs(a)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),a=clamp$2(a,-65504,65504),_tables.floatView[0]=a;const s=_tables.uint32View[0],o=s>>23&511;return _tables.baseTable[o]+((s&8388607)>>_tables.shiftTable[o])}function fromHalfFloat(a){const s=a>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[s]+(a&1023)]+_tables.exponentTable[s],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$8=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(s,o,j=!1){if(Array.isArray(s))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=s,this.itemSize=o,this.count=s!==void 0?s.length/o:0,this.normalized=j,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(s){s===!0&&this.version++}setUsage(s){return this.usage=s,this}copy(s){return this.name=s.name,this.array=new s.array.constructor(s.array),this.itemSize=s.itemSize,this.count=s.count,this.normalized=s.normalized,this.usage=s.usage,this.gpuType=s.gpuType,this}copyAt(s,o,j){s*=this.itemSize,j*=o.itemSize;for(let $=0,_e=this.itemSize;$<_e;$++)this.array[s+$]=o.array[j+$];return this}copyArray(s){return this.array.set(s),this}applyMatrix3(s){if(this.itemSize===2)for(let o=0,j=this.count;o<j;o++)_vector2$1.fromBufferAttribute(this,o),_vector2$1.applyMatrix3(s),this.setXY(o,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let o=0,j=this.count;o<j;o++)_vector$8.fromBufferAttribute(this,o),_vector$8.applyMatrix3(s),this.setXYZ(o,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyMatrix4(s){for(let o=0,j=this.count;o<j;o++)_vector$8.fromBufferAttribute(this,o),_vector$8.applyMatrix4(s),this.setXYZ(o,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyNormalMatrix(s){for(let o=0,j=this.count;o<j;o++)_vector$8.fromBufferAttribute(this,o),_vector$8.applyNormalMatrix(s),this.setXYZ(o,_vector$8.x,_vector$8.y,_vector$8.z);return this}transformDirection(s){for(let o=0,j=this.count;o<j;o++)_vector$8.fromBufferAttribute(this,o),_vector$8.transformDirection(s),this.setXYZ(o,_vector$8.x,_vector$8.y,_vector$8.z);return this}set(s,o=0){return this.array.set(s,o),this}getX(s){let o=this.array[s*this.itemSize];return this.normalized&&(o=denormalize(o,this.array)),o}setX(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize]=o,this}getY(s){let o=this.array[s*this.itemSize+1];return this.normalized&&(o=denormalize(o,this.array)),o}setY(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+1]=o,this}getZ(s){let o=this.array[s*this.itemSize+2];return this.normalized&&(o=denormalize(o,this.array)),o}setZ(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+2]=o,this}getW(s){let o=this.array[s*this.itemSize+3];return this.normalized&&(o=denormalize(o,this.array)),o}setW(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+3]=o,this}setXY(s,o,j){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array)),this.array[s+0]=o,this.array[s+1]=j,this}setXYZ(s,o,j,$){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array)),this.array[s+0]=o,this.array[s+1]=j,this.array[s+2]=$,this}setXYZW(s,o,j,$,_e){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array),_e=normalize(_e,this.array)),this.array[s+0]=o,this.array[s+1]=j,this.array[s+2]=$,this.array[s+3]=_e,this}onUpload(s){return this.onUploadCallback=s,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const s={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(s.name=this.name),this.usage!==StaticDrawUsage&&(s.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(s.updateRange=this.updateRange),s}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Int8BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Int8Array(s),o,j)}}class Uint8BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Uint8Array(s),o,j)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Uint8ClampedArray(s),o,j)}}class Int16BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Int16Array(s),o,j)}}class Uint16BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Uint16Array(s),o,j)}}class Int32BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Int32Array(s),o,j)}}class Uint32BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Uint32Array(s),o,j)}}class Float16BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Uint16Array(s),o,j),this.isFloat16BufferAttribute=!0}getX(s){let o=fromHalfFloat(this.array[s*this.itemSize]);return this.normalized&&(o=denormalize(o,this.array)),o}setX(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize]=toHalfFloat(o),this}getY(s){let o=fromHalfFloat(this.array[s*this.itemSize+1]);return this.normalized&&(o=denormalize(o,this.array)),o}setY(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+1]=toHalfFloat(o),this}getZ(s){let o=fromHalfFloat(this.array[s*this.itemSize+2]);return this.normalized&&(o=denormalize(o,this.array)),o}setZ(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+2]=toHalfFloat(o),this}getW(s){let o=fromHalfFloat(this.array[s*this.itemSize+3]);return this.normalized&&(o=denormalize(o,this.array)),o}setW(s,o){return this.normalized&&(o=normalize(o,this.array)),this.array[s*this.itemSize+3]=toHalfFloat(o),this}setXY(s,o,j){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array)),this.array[s+0]=toHalfFloat(o),this.array[s+1]=toHalfFloat(j),this}setXYZ(s,o,j,$){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array)),this.array[s+0]=toHalfFloat(o),this.array[s+1]=toHalfFloat(j),this.array[s+2]=toHalfFloat($),this}setXYZW(s,o,j,$,_e){return s*=this.itemSize,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array),_e=normalize(_e,this.array)),this.array[s+0]=toHalfFloat(o),this.array[s+1]=toHalfFloat(j),this.array[s+2]=toHalfFloat($),this.array[s+3]=toHalfFloat(_e),this}}class Float32BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Float32Array(s),o,j)}}class Float64BufferAttribute extends BufferAttribute{constructor(s,o,j){super(new Float64Array(s),o,j)}}let _id$1=0;const _m1$3=new Matrix4,_obj$1=new Object3D,_offset$1=new Vector3,_box$1$1=new Box3,_boxMorphTargets=new Box3,_vector$7=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(s){return Array.isArray(s)?this.index=new(arrayNeedsUint32(s)?Uint32BufferAttribute:Uint16BufferAttribute)(s,1):this.index=s,this}getAttribute(s){return this.attributes[s]}setAttribute(s,o){return this.attributes[s]=o,this}deleteAttribute(s){return delete this.attributes[s],this}hasAttribute(s){return this.attributes[s]!==void 0}addGroup(s,o,j=0){this.groups.push({start:s,count:o,materialIndex:j})}clearGroups(){this.groups=[]}setDrawRange(s,o){this.drawRange.start=s,this.drawRange.count=o}applyMatrix4(s){const o=this.attributes.position;o!==void 0&&(o.applyMatrix4(s),o.needsUpdate=!0);const j=this.attributes.normal;if(j!==void 0){const _e=new Matrix3().getNormalMatrix(s);j.applyNormalMatrix(_e),j.needsUpdate=!0}const $=this.attributes.tangent;return $!==void 0&&($.transformDirection(s),$.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(s){return _m1$3.makeRotationFromQuaternion(s),this.applyMatrix4(_m1$3),this}rotateX(s){return _m1$3.makeRotationX(s),this.applyMatrix4(_m1$3),this}rotateY(s){return _m1$3.makeRotationY(s),this.applyMatrix4(_m1$3),this}rotateZ(s){return _m1$3.makeRotationZ(s),this.applyMatrix4(_m1$3),this}translate(s,o,j){return _m1$3.makeTranslation(s,o,j),this.applyMatrix4(_m1$3),this}scale(s,o,j){return _m1$3.makeScale(s,o,j),this.applyMatrix4(_m1$3),this}lookAt(s){return _obj$1.lookAt(s),_obj$1.updateMatrix(),this.applyMatrix4(_obj$1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset$1).negate(),this.translate(_offset$1.x,_offset$1.y,_offset$1.z),this}setFromPoints(s){const o=[];for(let j=0,$=s.length;j<$;j++){const _e=s[j];o.push(_e.x,_e.y,_e.z||0)}return this.setAttribute("position",new Float32BufferAttribute(o,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const s=this.attributes.position,o=this.morphAttributes.position;if(s&&s.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(s!==void 0){if(this.boundingBox.setFromBufferAttribute(s),o)for(let j=0,$=o.length;j<$;j++){const _e=o[j];_box$1$1.setFromBufferAttribute(_e),this.morphTargetsRelative?(_vector$7.addVectors(this.boundingBox.min,_box$1$1.min),this.boundingBox.expandByPoint(_vector$7),_vector$7.addVectors(this.boundingBox.max,_box$1$1.max),this.boundingBox.expandByPoint(_vector$7)):(this.boundingBox.expandByPoint(_box$1$1.min),this.boundingBox.expandByPoint(_box$1$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const s=this.attributes.position,o=this.morphAttributes.position;if(s&&s.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(s){const j=this.boundingSphere.center;if(_box$1$1.setFromBufferAttribute(s),o)for(let _e=0,tt=o.length;_e<tt;_e++){const nt=o[_e];_boxMorphTargets.setFromBufferAttribute(nt),this.morphTargetsRelative?(_vector$7.addVectors(_box$1$1.min,_boxMorphTargets.min),_box$1$1.expandByPoint(_vector$7),_vector$7.addVectors(_box$1$1.max,_boxMorphTargets.max),_box$1$1.expandByPoint(_vector$7)):(_box$1$1.expandByPoint(_boxMorphTargets.min),_box$1$1.expandByPoint(_boxMorphTargets.max))}_box$1$1.getCenter(j);let $=0;for(let _e=0,tt=s.count;_e<tt;_e++)_vector$7.fromBufferAttribute(s,_e),$=Math.max($,j.distanceToSquared(_vector$7));if(o)for(let _e=0,tt=o.length;_e<tt;_e++){const nt=o[_e],rt=this.morphTargetsRelative;for(let it=0,st=nt.count;it<st;it++)_vector$7.fromBufferAttribute(nt,it),rt&&(_offset$1.fromBufferAttribute(s,it),_vector$7.add(_offset$1)),$=Math.max($,j.distanceToSquared(_vector$7))}this.boundingSphere.radius=Math.sqrt($),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const s=this.index,o=this.attributes;if(s===null||o.position===void 0||o.normal===void 0||o.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const j=s.array,$=o.position.array,_e=o.normal.array,tt=o.uv.array,nt=$.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*nt),4));const rt=this.getAttribute("tangent").array,it=[],st=[];for(let Rt=0;Rt<nt;Rt++)it[Rt]=new Vector3,st[Rt]=new Vector3;const at=new Vector3,ot=new Vector3,ct=new Vector3,ft=new Vector2,ht=new Vector2,mt=new Vector2,lt=new Vector3,ut=new Vector3;function dt(Rt,Ut,Ht){at.fromArray($,Rt*3),ot.fromArray($,Ut*3),ct.fromArray($,Ht*3),ft.fromArray(tt,Rt*2),ht.fromArray(tt,Ut*2),mt.fromArray(tt,Ht*2),ot.sub(at),ct.sub(at),ht.sub(ft),mt.sub(ft);const Wt=1/(ht.x*mt.y-mt.x*ht.y);isFinite(Wt)&&(lt.copy(ot).multiplyScalar(mt.y).addScaledVector(ct,-ht.y).multiplyScalar(Wt),ut.copy(ct).multiplyScalar(ht.x).addScaledVector(ot,-mt.x).multiplyScalar(Wt),it[Rt].add(lt),it[Ut].add(lt),it[Ht].add(lt),st[Rt].add(ut),st[Ut].add(ut),st[Ht].add(ut))}let gt=this.groups;gt.length===0&&(gt=[{start:0,count:j.length}]);for(let Rt=0,Ut=gt.length;Rt<Ut;++Rt){const Ht=gt[Rt],Wt=Ht.start,Jt=Ht.count;for(let sn=Wt,jt=Wt+Jt;sn<jt;sn+=3)dt(j[sn+0],j[sn+1],j[sn+2])}const Et=new Vector3,St=new Vector3,Tt=new Vector3,Mt=new Vector3;function Bt(Rt){Tt.fromArray(_e,Rt*3),Mt.copy(Tt);const Ut=it[Rt];Et.copy(Ut),Et.sub(Tt.multiplyScalar(Tt.dot(Ut))).normalize(),St.crossVectors(Mt,Ut);const Wt=St.dot(st[Rt])<0?-1:1;rt[Rt*4]=Et.x,rt[Rt*4+1]=Et.y,rt[Rt*4+2]=Et.z,rt[Rt*4+3]=Wt}for(let Rt=0,Ut=gt.length;Rt<Ut;++Rt){const Ht=gt[Rt],Wt=Ht.start,Jt=Ht.count;for(let sn=Wt,jt=Wt+Jt;sn<jt;sn+=3)Bt(j[sn+0]),Bt(j[sn+1]),Bt(j[sn+2])}}computeVertexNormals(){const s=this.index,o=this.getAttribute("position");if(o!==void 0){let j=this.getAttribute("normal");if(j===void 0)j=new BufferAttribute(new Float32Array(o.count*3),3),this.setAttribute("normal",j);else for(let ot=0,ct=j.count;ot<ct;ot++)j.setXYZ(ot,0,0,0);const $=new Vector3,_e=new Vector3,tt=new Vector3,nt=new Vector3,rt=new Vector3,it=new Vector3,st=new Vector3,at=new Vector3;if(s)for(let ot=0,ct=s.count;ot<ct;ot+=3){const ft=s.getX(ot+0),ht=s.getX(ot+1),mt=s.getX(ot+2);$.fromBufferAttribute(o,ft),_e.fromBufferAttribute(o,ht),tt.fromBufferAttribute(o,mt),st.subVectors(tt,_e),at.subVectors($,_e),st.cross(at),nt.fromBufferAttribute(j,ft),rt.fromBufferAttribute(j,ht),it.fromBufferAttribute(j,mt),nt.add(st),rt.add(st),it.add(st),j.setXYZ(ft,nt.x,nt.y,nt.z),j.setXYZ(ht,rt.x,rt.y,rt.z),j.setXYZ(mt,it.x,it.y,it.z)}else for(let ot=0,ct=o.count;ot<ct;ot+=3)$.fromBufferAttribute(o,ot+0),_e.fromBufferAttribute(o,ot+1),tt.fromBufferAttribute(o,ot+2),st.subVectors(tt,_e),at.subVectors($,_e),st.cross(at),j.setXYZ(ot+0,st.x,st.y,st.z),j.setXYZ(ot+1,st.x,st.y,st.z),j.setXYZ(ot+2,st.x,st.y,st.z);this.normalizeNormals(),j.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const s=this.attributes.normal;for(let o=0,j=s.count;o<j;o++)_vector$7.fromBufferAttribute(s,o),_vector$7.normalize(),s.setXYZ(o,_vector$7.x,_vector$7.y,_vector$7.z)}toNonIndexed(){function s(nt,rt){const it=nt.array,st=nt.itemSize,at=nt.normalized,ot=new it.constructor(rt.length*st);let ct=0,ft=0;for(let ht=0,mt=rt.length;ht<mt;ht++){nt.isInterleavedBufferAttribute?ct=rt[ht]*nt.data.stride+nt.offset:ct=rt[ht]*st;for(let lt=0;lt<st;lt++)ot[ft++]=it[ct++]}return new BufferAttribute(ot,st,at)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const o=new BufferGeometry,j=this.index.array,$=this.attributes;for(const nt in $){const rt=$[nt],it=s(rt,j);o.setAttribute(nt,it)}const _e=this.morphAttributes;for(const nt in _e){const rt=[],it=_e[nt];for(let st=0,at=it.length;st<at;st++){const ot=it[st],ct=s(ot,j);rt.push(ct)}o.morphAttributes[nt]=rt}o.morphTargetsRelative=this.morphTargetsRelative;const tt=this.groups;for(let nt=0,rt=tt.length;nt<rt;nt++){const it=tt[nt];o.addGroup(it.start,it.count,it.materialIndex)}return o}toJSON(){const s={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),Object.keys(this.userData).length>0&&(s.userData=this.userData),this.parameters!==void 0){const rt=this.parameters;for(const it in rt)rt[it]!==void 0&&(s[it]=rt[it]);return s}s.data={attributes:{}};const o=this.index;o!==null&&(s.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)});const j=this.attributes;for(const rt in j){const it=j[rt];s.data.attributes[rt]=it.toJSON(s.data)}const $={};let _e=!1;for(const rt in this.morphAttributes){const it=this.morphAttributes[rt],st=[];for(let at=0,ot=it.length;at<ot;at++){const ct=it[at];st.push(ct.toJSON(s.data))}st.length>0&&($[rt]=st,_e=!0)}_e&&(s.data.morphAttributes=$,s.data.morphTargetsRelative=this.morphTargetsRelative);const tt=this.groups;tt.length>0&&(s.data.groups=JSON.parse(JSON.stringify(tt)));const nt=this.boundingSphere;return nt!==null&&(s.data.boundingSphere={center:nt.center.toArray(),radius:nt.radius}),s}clone(){return new this.constructor().copy(this)}copy(s){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const o={};this.name=s.name;const j=s.index;j!==null&&this.setIndex(j.clone(o));const $=s.attributes;for(const it in $){const st=$[it];this.setAttribute(it,st.clone(o))}const _e=s.morphAttributes;for(const it in _e){const st=[],at=_e[it];for(let ot=0,ct=at.length;ot<ct;ot++)st.push(at[ot].clone(o));this.morphAttributes[it]=st}this.morphTargetsRelative=s.morphTargetsRelative;const tt=s.groups;for(let it=0,st=tt.length;it<st;it++){const at=tt[it];this.addGroup(at.start,at.count,at.materialIndex)}const nt=s.boundingBox;nt!==null&&(this.boundingBox=nt.clone());const rt=s.boundingSphere;return rt!==null&&(this.boundingSphere=rt.clone()),this.drawRange.start=s.drawRange.start,this.drawRange.count=s.drawRange.count,this.userData=s.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$5=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(s=new BufferGeometry,o=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=s,this.material=o,this.updateMorphTargets()}copy(s,o){return super.copy(s,o),s.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=s.morphTargetInfluences.slice()),s.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},s.morphTargetDictionary)),this.material=s.material,this.geometry=s.geometry,this}updateMorphTargets(){const o=this.geometry.morphAttributes,j=Object.keys(o);if(j.length>0){const $=o[j[0]];if($!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _e=0,tt=$.length;_e<tt;_e++){const nt=$[_e].name||String(_e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[nt]=_e}}}}getVertexPosition(s,o){const j=this.geometry,$=j.attributes.position,_e=j.morphAttributes.position,tt=j.morphTargetsRelative;o.fromBufferAttribute($,s);const nt=this.morphTargetInfluences;if(_e&&nt){_morphA.set(0,0,0);for(let rt=0,it=_e.length;rt<it;rt++){const st=nt[rt],at=_e[rt];st!==0&&(_tempA.fromBufferAttribute(at,s),tt?_morphA.addScaledVector(_tempA,st):_morphA.addScaledVector(_tempA.sub(o),st))}o.add(_morphA)}return o}raycast(s,o){const j=this.geometry,$=this.material,_e=this.matrixWorld;$!==void 0&&(j.boundingSphere===null&&j.computeBoundingSphere(),_sphere$5.copy(j.boundingSphere),_sphere$5.applyMatrix4(_e),_ray$3.copy(s.ray).recast(s.near),!(_sphere$5.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$5,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(s.far-s.near)**2))&&(_inverseMatrix$3.copy(_e).invert(),_ray$3.copy(s.ray).applyMatrix4(_inverseMatrix$3),!(j.boundingBox!==null&&_ray$3.intersectsBox(j.boundingBox)===!1)&&this._computeIntersections(s,o,_ray$3)))}_computeIntersections(s,o,j){let $;const _e=this.geometry,tt=this.material,nt=_e.index,rt=_e.attributes.position,it=_e.attributes.uv,st=_e.attributes.uv1,at=_e.attributes.normal,ot=_e.groups,ct=_e.drawRange;if(nt!==null)if(Array.isArray(tt))for(let ft=0,ht=ot.length;ft<ht;ft++){const mt=ot[ft],lt=tt[mt.materialIndex],ut=Math.max(mt.start,ct.start),dt=Math.min(nt.count,Math.min(mt.start+mt.count,ct.start+ct.count));for(let gt=ut,Et=dt;gt<Et;gt+=3){const St=nt.getX(gt),Tt=nt.getX(gt+1),Mt=nt.getX(gt+2);$=checkGeometryIntersection(this,lt,s,j,it,st,at,St,Tt,Mt),$&&($.faceIndex=Math.floor(gt/3),$.face.materialIndex=mt.materialIndex,o.push($))}}else{const ft=Math.max(0,ct.start),ht=Math.min(nt.count,ct.start+ct.count);for(let mt=ft,lt=ht;mt<lt;mt+=3){const ut=nt.getX(mt),dt=nt.getX(mt+1),gt=nt.getX(mt+2);$=checkGeometryIntersection(this,tt,s,j,it,st,at,ut,dt,gt),$&&($.faceIndex=Math.floor(mt/3),o.push($))}}else if(rt!==void 0)if(Array.isArray(tt))for(let ft=0,ht=ot.length;ft<ht;ft++){const mt=ot[ft],lt=tt[mt.materialIndex],ut=Math.max(mt.start,ct.start),dt=Math.min(rt.count,Math.min(mt.start+mt.count,ct.start+ct.count));for(let gt=ut,Et=dt;gt<Et;gt+=3){const St=gt,Tt=gt+1,Mt=gt+2;$=checkGeometryIntersection(this,lt,s,j,it,st,at,St,Tt,Mt),$&&($.faceIndex=Math.floor(gt/3),$.face.materialIndex=mt.materialIndex,o.push($))}}else{const ft=Math.max(0,ct.start),ht=Math.min(rt.count,ct.start+ct.count);for(let mt=ft,lt=ht;mt<lt;mt+=3){const ut=mt,dt=mt+1,gt=mt+2;$=checkGeometryIntersection(this,tt,s,j,it,st,at,ut,dt,gt),$&&($.faceIndex=Math.floor(mt/3),o.push($))}}}}function checkIntersection(a,s,o,j,$,_e,tt,nt){let rt;if(s.side===BackSide?rt=j.intersectTriangle(tt,_e,$,!0,nt):rt=j.intersectTriangle($,_e,tt,s.side===FrontSide,nt),rt===null)return null;_intersectionPointWorld.copy(nt),_intersectionPointWorld.applyMatrix4(a.matrixWorld);const it=o.ray.origin.distanceTo(_intersectionPointWorld);return it<o.near||it>o.far?null:{distance:it,point:_intersectionPointWorld.clone(),object:a}}function checkGeometryIntersection(a,s,o,j,$,_e,tt,nt,rt,it){a.getVertexPosition(nt,_vA$1),a.getVertexPosition(rt,_vB$1),a.getVertexPosition(it,_vC$1);const st=checkIntersection(a,s,o,j,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(st){$&&(_uvA$1.fromBufferAttribute($,nt),_uvB$1.fromBufferAttribute($,rt),_uvC$1.fromBufferAttribute($,it),st.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),_e&&(_uvA$1.fromBufferAttribute(_e,nt),_uvB$1.fromBufferAttribute(_e,rt),_uvC$1.fromBufferAttribute(_e,it),st.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),st.uv2=st.uv1),tt&&(_normalA.fromBufferAttribute(tt,nt),_normalB.fromBufferAttribute(tt,rt),_normalC.fromBufferAttribute(tt,it),st.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),st.normal.dot(j.direction)>0&&st.normal.multiplyScalar(-1));const at={a:nt,b:rt,c:it,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,at.normal),st.face=at}return st}class BoxGeometry extends BufferGeometry{constructor(s=1,o=1,j=1,$=1,_e=1,tt=1){super(),this.type="BoxGeometry",this.parameters={width:s,height:o,depth:j,widthSegments:$,heightSegments:_e,depthSegments:tt};const nt=this;$=Math.floor($),_e=Math.floor(_e),tt=Math.floor(tt);const rt=[],it=[],st=[],at=[];let ot=0,ct=0;ft("z","y","x",-1,-1,j,o,s,tt,_e,0),ft("z","y","x",1,-1,j,o,-s,tt,_e,1),ft("x","z","y",1,1,s,j,o,$,tt,2),ft("x","z","y",1,-1,s,j,-o,$,tt,3),ft("x","y","z",1,-1,s,o,j,$,_e,4),ft("x","y","z",-1,-1,s,o,-j,$,_e,5),this.setIndex(rt),this.setAttribute("position",new Float32BufferAttribute(it,3)),this.setAttribute("normal",new Float32BufferAttribute(st,3)),this.setAttribute("uv",new Float32BufferAttribute(at,2));function ft(ht,mt,lt,ut,dt,gt,Et,St,Tt,Mt,Bt){const Rt=gt/Tt,Ut=Et/Mt,Ht=gt/2,Wt=Et/2,Jt=St/2,sn=Tt+1,jt=Mt+1;let Vt=0,Lt=0;const Qt=new Vector3;for(let nn=0;nn<jt;nn++){const mn=nn*Ut-Wt;for(let Zt=0;Zt<sn;Zt++){const cn=Zt*Rt-Ht;Qt[ht]=cn*ut,Qt[mt]=mn*dt,Qt[lt]=Jt,it.push(Qt.x,Qt.y,Qt.z),Qt[ht]=0,Qt[mt]=0,Qt[lt]=St>0?1:-1,st.push(Qt.x,Qt.y,Qt.z),at.push(Zt/Tt),at.push(1-nn/Mt),Vt+=1}}for(let nn=0;nn<Mt;nn++)for(let mn=0;mn<Tt;mn++){const Zt=ot+mn+sn*nn,cn=ot+mn+sn*(nn+1),Ot=ot+(mn+1)+sn*(nn+1),rn=ot+(mn+1)+sn*nn;rt.push(Zt,cn,rn),rt.push(cn,Ot,rn),Lt+=6}nt.addGroup(ct,Lt,Bt),ct+=Lt,ot+=Vt}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments)}}function cloneUniforms(a){const s={};for(const o in a){s[o]={};for(const j in a[o]){const $=a[o][j];$&&($.isColor||$.isMatrix3||$.isMatrix4||$.isVector2||$.isVector3||$.isVector4||$.isTexture||$.isQuaternion)?$.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),s[o][j]=null):s[o][j]=$.clone():Array.isArray($)?s[o][j]=$.slice():s[o][j]=$}}return s}function mergeUniforms(a){const s={};for(let o=0;o<a.length;o++){const j=cloneUniforms(a[o]);for(const $ in j)s[$]=j[$]}return s}function cloneUniformsGroups(a){const s=[];for(let o=0;o<a.length;o++)s.push(a[o].clone());return s}function getUnlitUniformColorSpace(a){return a.getRenderTarget()===null?a.outputColorSpace:LinearSRGBColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(s){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,s!==void 0&&this.setValues(s)}copy(s){return super.copy(s),this.fragmentShader=s.fragmentShader,this.vertexShader=s.vertexShader,this.uniforms=cloneUniforms(s.uniforms),this.uniformsGroups=cloneUniformsGroups(s.uniformsGroups),this.defines=Object.assign({},s.defines),this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.fog=s.fog,this.lights=s.lights,this.clipping=s.clipping,this.extensions=Object.assign({},s.extensions),this.glslVersion=s.glslVersion,this}toJSON(s){const o=super.toJSON(s);o.glslVersion=this.glslVersion,o.uniforms={};for(const $ in this.uniforms){const tt=this.uniforms[$].value;tt&&tt.isTexture?o.uniforms[$]={type:"t",value:tt.toJSON(s).uuid}:tt&&tt.isColor?o.uniforms[$]={type:"c",value:tt.getHex()}:tt&&tt.isVector2?o.uniforms[$]={type:"v2",value:tt.toArray()}:tt&&tt.isVector3?o.uniforms[$]={type:"v3",value:tt.toArray()}:tt&&tt.isVector4?o.uniforms[$]={type:"v4",value:tt.toArray()}:tt&&tt.isMatrix3?o.uniforms[$]={type:"m3",value:tt.toArray()}:tt&&tt.isMatrix4?o.uniforms[$]={type:"m4",value:tt.toArray()}:o.uniforms[$]={value:tt}}Object.keys(this.defines).length>0&&(o.defines=this.defines),o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader,o.lights=this.lights,o.clipping=this.clipping;const j={};for(const $ in this.extensions)this.extensions[$]===!0&&(j[$]=!0);return Object.keys(j).length>0&&(o.extensions=j),o}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(s,o){return super.copy(s,o),this.matrixWorldInverse.copy(s.matrixWorldInverse),this.projectionMatrix.copy(s.projectionMatrix),this.projectionMatrixInverse.copy(s.projectionMatrixInverse),this.coordinateSystem=s.coordinateSystem,this}getWorldDirection(s){this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return s.set(-o[8],-o[9],-o[10]).normalize()}updateMatrixWorld(s){super.updateMatrixWorld(s),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(s,o){super.updateWorldMatrix(s,o),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(s=50,o=1,j=.1,$=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=s,this.zoom=1,this.near=j,this.far=$,this.focus=10,this.aspect=o,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(s,o){return super.copy(s,o),this.fov=s.fov,this.zoom=s.zoom,this.near=s.near,this.far=s.far,this.focus=s.focus,this.aspect=s.aspect,this.view=s.view===null?null:Object.assign({},s.view),this.filmGauge=s.filmGauge,this.filmOffset=s.filmOffset,this}setFocalLength(s){const o=.5*this.getFilmHeight()/s;this.fov=RAD2DEG*2*Math.atan(o),this.updateProjectionMatrix()}getFocalLength(){const s=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/s}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(s,o,j,$,_e,tt){this.aspect=s/o,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=s,this.view.fullHeight=o,this.view.offsetX=j,this.view.offsetY=$,this.view.width=_e,this.view.height=tt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const s=this.near;let o=s*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,j=2*o,$=this.aspect*j,_e=-.5*$;const tt=this.view;if(this.view!==null&&this.view.enabled){const rt=tt.fullWidth,it=tt.fullHeight;_e+=tt.offsetX*$/rt,o-=tt.offsetY*j/it,$*=tt.width/rt,j*=tt.height/it}const nt=this.filmOffset;nt!==0&&(_e+=s*nt/this.getFilmWidth()),this.projectionMatrix.makePerspective(_e,_e+$,o,o-j,s,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(s){const o=super.toJSON(s);return o.object.fov=this.fov,o.object.zoom=this.zoom,o.object.near=this.near,o.object.far=this.far,o.object.focus=this.focus,o.object.aspect=this.aspect,this.view!==null&&(o.object.view=Object.assign({},this.view)),o.object.filmGauge=this.filmGauge,o.object.filmOffset=this.filmOffset,o}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(s,o,j){super(),this.type="CubeCamera",this.renderTarget=j,this.coordinateSystem=null;const $=new PerspectiveCamera(fov,aspect,s,o);$.layers=this.layers,this.add($);const _e=new PerspectiveCamera(fov,aspect,s,o);_e.layers=this.layers,this.add(_e);const tt=new PerspectiveCamera(fov,aspect,s,o);tt.layers=this.layers,this.add(tt);const nt=new PerspectiveCamera(fov,aspect,s,o);nt.layers=this.layers,this.add(nt);const rt=new PerspectiveCamera(fov,aspect,s,o);rt.layers=this.layers,this.add(rt);const it=new PerspectiveCamera(fov,aspect,s,o);it.layers=this.layers,this.add(it)}updateCoordinateSystem(){const s=this.coordinateSystem,o=this.children.concat(),[j,$,_e,tt,nt,rt]=o;for(const it of o)this.remove(it);if(s===WebGLCoordinateSystem)j.up.set(0,1,0),j.lookAt(1,0,0),$.up.set(0,1,0),$.lookAt(-1,0,0),_e.up.set(0,0,-1),_e.lookAt(0,1,0),tt.up.set(0,0,1),tt.lookAt(0,-1,0),nt.up.set(0,1,0),nt.lookAt(0,0,1),rt.up.set(0,1,0),rt.lookAt(0,0,-1);else if(s===WebGPUCoordinateSystem)j.up.set(0,-1,0),j.lookAt(-1,0,0),$.up.set(0,-1,0),$.lookAt(1,0,0),_e.up.set(0,0,1),_e.lookAt(0,1,0),tt.up.set(0,0,-1),tt.lookAt(0,-1,0),nt.up.set(0,-1,0),nt.lookAt(0,0,1),rt.up.set(0,-1,0),rt.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+s);for(const it of o)this.add(it),it.updateMatrixWorld()}update(s,o){this.parent===null&&this.updateMatrixWorld();const j=this.renderTarget;this.coordinateSystem!==s.coordinateSystem&&(this.coordinateSystem=s.coordinateSystem,this.updateCoordinateSystem());const[$,_e,tt,nt,rt,it]=this.children,st=s.getRenderTarget(),at=s.toneMapping,ot=s.xr.enabled;s.toneMapping=NoToneMapping,s.xr.enabled=!1;const ct=j.texture.generateMipmaps;j.texture.generateMipmaps=!1,s.setRenderTarget(j,0),s.render(o,$),s.setRenderTarget(j,1),s.render(o,_e),s.setRenderTarget(j,2),s.render(o,tt),s.setRenderTarget(j,3),s.render(o,nt),s.setRenderTarget(j,4),s.render(o,rt),j.texture.generateMipmaps=ct,s.setRenderTarget(j,5),s.render(o,it),s.setRenderTarget(st),s.toneMapping=at,s.xr.enabled=ot,j.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(s,o,j,$,_e,tt,nt,rt,it,st){s=s!==void 0?s:[],o=o!==void 0?o:CubeReflectionMapping,super(s,o,j,$,_e,tt,nt,rt,it,st),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(s){this.image=s}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(s=1,o={}){super(s,s,o),this.isWebGLCubeRenderTarget=!0;const j={width:s,height:s,depth:1},$=[j,j,j,j,j,j];o.encoding!==void 0&&(warnOnce("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),o.colorSpace=o.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new CubeTexture($,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,this.texture.minFilter=o.minFilter!==void 0?o.minFilter:LinearFilter}fromEquirectangularTexture(s,o){this.texture.type=o.type,this.texture.colorSpace=o.colorSpace,this.texture.generateMipmaps=o.generateMipmaps,this.texture.minFilter=o.minFilter,this.texture.magFilter=o.magFilter;const j={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},$=new BoxGeometry(5,5,5),_e=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(j.uniforms),vertexShader:j.vertexShader,fragmentShader:j.fragmentShader,side:BackSide,blending:NoBlending});_e.uniforms.tEquirect.value=o;const tt=new Mesh($,_e),nt=o.minFilter;return o.minFilter===LinearMipmapLinearFilter&&(o.minFilter=LinearFilter),new CubeCamera(1,10,this).update(s,tt),o.minFilter=nt,tt.geometry.dispose(),tt.material.dispose(),this}clear(s,o,j,$){const _e=s.getRenderTarget();for(let tt=0;tt<6;tt++)s.setRenderTarget(this,tt),s.clear(o,j,$);s.setRenderTarget(_e)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix$1=new Matrix3;class Plane{constructor(s=new Vector3(1,0,0),o=0){this.isPlane=!0,this.normal=s,this.constant=o}set(s,o){return this.normal.copy(s),this.constant=o,this}setComponents(s,o,j,$){return this.normal.set(s,o,j),this.constant=$,this}setFromNormalAndCoplanarPoint(s,o){return this.normal.copy(s),this.constant=-o.dot(this.normal),this}setFromCoplanarPoints(s,o,j){const $=_vector1.subVectors(j,o).cross(_vector2.subVectors(s,o)).normalize();return this.setFromNormalAndCoplanarPoint($,s),this}copy(s){return this.normal.copy(s.normal),this.constant=s.constant,this}normalize(){const s=1/this.normal.length();return this.normal.multiplyScalar(s),this.constant*=s,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(s){return this.normal.dot(s)+this.constant}distanceToSphere(s){return this.distanceToPoint(s.center)-s.radius}projectPoint(s,o){return o.copy(s).addScaledVector(this.normal,-this.distanceToPoint(s))}intersectLine(s,o){const j=s.delta(_vector1),$=this.normal.dot(j);if($===0)return this.distanceToPoint(s.start)===0?o.copy(s.start):null;const _e=-(s.start.dot(this.normal)+this.constant)/$;return _e<0||_e>1?null:o.copy(s.start).addScaledVector(j,_e)}intersectsLine(s){const o=this.distanceToPoint(s.start),j=this.distanceToPoint(s.end);return o<0&&j>0||j<0&&o>0}intersectsBox(s){return s.intersectsPlane(this)}intersectsSphere(s){return s.intersectsPlane(this)}coplanarPoint(s){return s.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(s,o){const j=o||_normalMatrix$1.getNormalMatrix(s),$=this.coplanarPoint(_vector1).applyMatrix4(s),_e=this.normal.applyMatrix3(j).normalize();return this.constant=-$.dot(_e),this}translate(s){return this.constant-=s.dot(this.normal),this}equals(s){return s.normal.equals(this.normal)&&s.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$4=new Sphere,_vector$6=new Vector3;class Frustum{constructor(s=new Plane,o=new Plane,j=new Plane,$=new Plane,_e=new Plane,tt=new Plane){this.planes=[s,o,j,$,_e,tt]}set(s,o,j,$,_e,tt){const nt=this.planes;return nt[0].copy(s),nt[1].copy(o),nt[2].copy(j),nt[3].copy($),nt[4].copy(_e),nt[5].copy(tt),this}copy(s){const o=this.planes;for(let j=0;j<6;j++)o[j].copy(s.planes[j]);return this}setFromProjectionMatrix(s,o=WebGLCoordinateSystem){const j=this.planes,$=s.elements,_e=$[0],tt=$[1],nt=$[2],rt=$[3],it=$[4],st=$[5],at=$[6],ot=$[7],ct=$[8],ft=$[9],ht=$[10],mt=$[11],lt=$[12],ut=$[13],dt=$[14],gt=$[15];if(j[0].setComponents(rt-_e,ot-it,mt-ct,gt-lt).normalize(),j[1].setComponents(rt+_e,ot+it,mt+ct,gt+lt).normalize(),j[2].setComponents(rt+tt,ot+st,mt+ft,gt+ut).normalize(),j[3].setComponents(rt-tt,ot-st,mt-ft,gt-ut).normalize(),j[4].setComponents(rt-nt,ot-at,mt-ht,gt-dt).normalize(),o===WebGLCoordinateSystem)j[5].setComponents(rt+nt,ot+at,mt+ht,gt+dt).normalize();else if(o===WebGPUCoordinateSystem)j[5].setComponents(nt,at,ht,dt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+o);return this}intersectsObject(s){if(s.boundingSphere!==void 0)s.boundingSphere===null&&s.computeBoundingSphere(),_sphere$4.copy(s.boundingSphere).applyMatrix4(s.matrixWorld);else{const o=s.geometry;o.boundingSphere===null&&o.computeBoundingSphere(),_sphere$4.copy(o.boundingSphere).applyMatrix4(s.matrixWorld)}return this.intersectsSphere(_sphere$4)}intersectsSprite(s){return _sphere$4.center.set(0,0,0),_sphere$4.radius=.7071067811865476,_sphere$4.applyMatrix4(s.matrixWorld),this.intersectsSphere(_sphere$4)}intersectsSphere(s){const o=this.planes,j=s.center,$=-s.radius;for(let _e=0;_e<6;_e++)if(o[_e].distanceToPoint(j)<$)return!1;return!0}intersectsBox(s){const o=this.planes;for(let j=0;j<6;j++){const $=o[j];if(_vector$6.x=$.normal.x>0?s.max.x:s.min.x,_vector$6.y=$.normal.y>0?s.max.y:s.min.y,_vector$6.z=$.normal.z>0?s.max.z:s.min.z,$.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(s){const o=this.planes;for(let j=0;j<6;j++)if(o[j].distanceToPoint(s)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let a=null,s=!1,o=null,j=null;function $(_e,tt){o(_e,tt),j=a.requestAnimationFrame($)}return{start:function(){s!==!0&&o!==null&&(j=a.requestAnimationFrame($),s=!0)},stop:function(){a.cancelAnimationFrame(j),s=!1},setAnimationLoop:function(_e){o=_e},setContext:function(_e){a=_e}}}function WebGLAttributes(a,s){const o=s.isWebGL2,j=new WeakMap;function $(it,st){const at=it.array,ot=it.usage,ct=a.createBuffer();a.bindBuffer(st,ct),a.bufferData(st,at,ot),it.onUploadCallback();let ft;if(at instanceof Float32Array)ft=a.FLOAT;else if(at instanceof Uint16Array)if(it.isFloat16BufferAttribute)if(o)ft=a.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else ft=a.UNSIGNED_SHORT;else if(at instanceof Int16Array)ft=a.SHORT;else if(at instanceof Uint32Array)ft=a.UNSIGNED_INT;else if(at instanceof Int32Array)ft=a.INT;else if(at instanceof Int8Array)ft=a.BYTE;else if(at instanceof Uint8Array)ft=a.UNSIGNED_BYTE;else if(at instanceof Uint8ClampedArray)ft=a.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+at);return{buffer:ct,type:ft,bytesPerElement:at.BYTES_PER_ELEMENT,version:it.version}}function _e(it,st,at){const ot=st.array,ct=st.updateRange;a.bindBuffer(at,it),ct.count===-1?a.bufferSubData(at,0,ot):(o?a.bufferSubData(at,ct.offset*ot.BYTES_PER_ELEMENT,ot,ct.offset,ct.count):a.bufferSubData(at,ct.offset*ot.BYTES_PER_ELEMENT,ot.subarray(ct.offset,ct.offset+ct.count)),ct.count=-1),st.onUploadCallback()}function tt(it){return it.isInterleavedBufferAttribute&&(it=it.data),j.get(it)}function nt(it){it.isInterleavedBufferAttribute&&(it=it.data);const st=j.get(it);st&&(a.deleteBuffer(st.buffer),j.delete(it))}function rt(it,st){if(it.isGLBufferAttribute){const ot=j.get(it);(!ot||ot.version<it.version)&&j.set(it,{buffer:it.buffer,type:it.type,bytesPerElement:it.elementSize,version:it.version});return}it.isInterleavedBufferAttribute&&(it=it.data);const at=j.get(it);at===void 0?j.set(it,$(it,st)):at.version<it.version&&(_e(at.buffer,it,st),at.version=it.version)}return{get:tt,remove:nt,update:rt}}class PlaneGeometry extends BufferGeometry{constructor(s=1,o=1,j=1,$=1){super(),this.type="PlaneGeometry",this.parameters={width:s,height:o,widthSegments:j,heightSegments:$};const _e=s/2,tt=o/2,nt=Math.floor(j),rt=Math.floor($),it=nt+1,st=rt+1,at=s/nt,ot=o/rt,ct=[],ft=[],ht=[],mt=[];for(let lt=0;lt<st;lt++){const ut=lt*ot-tt;for(let dt=0;dt<it;dt++){const gt=dt*at-_e;ft.push(gt,-ut,0),ht.push(0,0,1),mt.push(dt/nt),mt.push(1-lt/rt)}}for(let lt=0;lt<rt;lt++)for(let ut=0;ut<nt;ut++){const dt=ut+it*lt,gt=ut+it*(lt+1),Et=ut+1+it*(lt+1),St=ut+1+it*lt;ct.push(dt,gt,St),ct.push(gt,Et,St)}this.setIndex(ct),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(ht,3)),this.setAttribute("uv",new Float32BufferAttribute(mt,2))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new PlaneGeometry(s.width,s.height,s.widthSegments,s.heightSegments)}}var alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex="vec3 transformed = vec3( position );",beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common$3=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,output_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common:common$3,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,encodings_fragment,encodings_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,output_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(a,s,o,j,$,_e,tt){const nt=new Color(0);let rt=_e===!0?0:1,it,st,at=null,ot=0,ct=null;function ft(mt,lt){let ut=!1,dt=lt.isScene===!0?lt.background:null;switch(dt&&dt.isTexture&&(dt=(lt.backgroundBlurriness>0?o:s).get(dt)),dt===null?ht(nt,rt):dt&&dt.isColor&&(ht(dt,1),ut=!0),a.xr.getEnvironmentBlendMode()){case"opaque":ut=!0;break;case"additive":j.buffers.color.setClear(0,0,0,1,tt),ut=!0;break;case"alpha-blend":j.buffers.color.setClear(0,0,0,0,tt),ut=!0;break}(a.autoClear||ut)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),dt&&(dt.isCubeTexture||dt.mapping===CubeUVReflectionMapping)?(st===void 0&&(st=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),st.geometry.deleteAttribute("normal"),st.geometry.deleteAttribute("uv"),st.onBeforeRender=function(St,Tt,Mt){this.matrixWorld.copyPosition(Mt.matrixWorld)},Object.defineProperty(st.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),$.update(st)),st.material.uniforms.envMap.value=dt,st.material.uniforms.flipEnvMap.value=dt.isCubeTexture&&dt.isRenderTargetTexture===!1?-1:1,st.material.uniforms.backgroundBlurriness.value=lt.backgroundBlurriness,st.material.uniforms.backgroundIntensity.value=lt.backgroundIntensity,st.material.toneMapped=dt.colorSpace!==SRGBColorSpace,(at!==dt||ot!==dt.version||ct!==a.toneMapping)&&(st.material.needsUpdate=!0,at=dt,ot=dt.version,ct=a.toneMapping),st.layers.enableAll(),mt.unshift(st,st.geometry,st.material,0,0,null)):dt&&dt.isTexture&&(it===void 0&&(it=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),it.geometry.deleteAttribute("normal"),Object.defineProperty(it.material,"map",{get:function(){return this.uniforms.t2D.value}}),$.update(it)),it.material.uniforms.t2D.value=dt,it.material.uniforms.backgroundIntensity.value=lt.backgroundIntensity,it.material.toneMapped=dt.colorSpace!==SRGBColorSpace,dt.matrixAutoUpdate===!0&&dt.updateMatrix(),it.material.uniforms.uvTransform.value.copy(dt.matrix),(at!==dt||ot!==dt.version||ct!==a.toneMapping)&&(it.material.needsUpdate=!0,at=dt,ot=dt.version,ct=a.toneMapping),it.layers.enableAll(),mt.unshift(it,it.geometry,it.material,0,0,null))}function ht(mt,lt){mt.getRGB(_rgb,getUnlitUniformColorSpace(a)),j.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,lt,tt)}return{getClearColor:function(){return nt},setClearColor:function(mt,lt=1){nt.set(mt),rt=lt,ht(nt,rt)},getClearAlpha:function(){return rt},setClearAlpha:function(mt){rt=mt,ht(nt,rt)},render:ft}}function WebGLBindingStates(a,s,o,j){const $=a.getParameter(a.MAX_VERTEX_ATTRIBS),_e=j.isWebGL2?null:s.get("OES_vertex_array_object"),tt=j.isWebGL2||_e!==null,nt={},rt=mt(null);let it=rt,st=!1;function at(Jt,sn,jt,Vt,Lt){let Qt=!1;if(tt){const nn=ht(Vt,jt,sn);it!==nn&&(it=nn,ct(it.object)),Qt=lt(Jt,Vt,jt,Lt),Qt&&ut(Jt,Vt,jt,Lt)}else{const nn=sn.wireframe===!0;(it.geometry!==Vt.id||it.program!==jt.id||it.wireframe!==nn)&&(it.geometry=Vt.id,it.program=jt.id,it.wireframe=nn,Qt=!0)}Lt!==null&&o.update(Lt,a.ELEMENT_ARRAY_BUFFER),(Qt||st)&&(st=!1,Mt(Jt,sn,jt,Vt),Lt!==null&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,o.get(Lt).buffer))}function ot(){return j.isWebGL2?a.createVertexArray():_e.createVertexArrayOES()}function ct(Jt){return j.isWebGL2?a.bindVertexArray(Jt):_e.bindVertexArrayOES(Jt)}function ft(Jt){return j.isWebGL2?a.deleteVertexArray(Jt):_e.deleteVertexArrayOES(Jt)}function ht(Jt,sn,jt){const Vt=jt.wireframe===!0;let Lt=nt[Jt.id];Lt===void 0&&(Lt={},nt[Jt.id]=Lt);let Qt=Lt[sn.id];Qt===void 0&&(Qt={},Lt[sn.id]=Qt);let nn=Qt[Vt];return nn===void 0&&(nn=mt(ot()),Qt[Vt]=nn),nn}function mt(Jt){const sn=[],jt=[],Vt=[];for(let Lt=0;Lt<$;Lt++)sn[Lt]=0,jt[Lt]=0,Vt[Lt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:sn,enabledAttributes:jt,attributeDivisors:Vt,object:Jt,attributes:{},index:null}}function lt(Jt,sn,jt,Vt){const Lt=it.attributes,Qt=sn.attributes;let nn=0;const mn=jt.getAttributes();for(const Zt in mn)if(mn[Zt].location>=0){const Ot=Lt[Zt];let rn=Qt[Zt];if(rn===void 0&&(Zt==="instanceMatrix"&&Jt.instanceMatrix&&(rn=Jt.instanceMatrix),Zt==="instanceColor"&&Jt.instanceColor&&(rn=Jt.instanceColor)),Ot===void 0||Ot.attribute!==rn||rn&&Ot.data!==rn.data)return!0;nn++}return it.attributesNum!==nn||it.index!==Vt}function ut(Jt,sn,jt,Vt){const Lt={},Qt=sn.attributes;let nn=0;const mn=jt.getAttributes();for(const Zt in mn)if(mn[Zt].location>=0){let Ot=Qt[Zt];Ot===void 0&&(Zt==="instanceMatrix"&&Jt.instanceMatrix&&(Ot=Jt.instanceMatrix),Zt==="instanceColor"&&Jt.instanceColor&&(Ot=Jt.instanceColor));const rn={};rn.attribute=Ot,Ot&&Ot.data&&(rn.data=Ot.data),Lt[Zt]=rn,nn++}it.attributes=Lt,it.attributesNum=nn,it.index=Vt}function dt(){const Jt=it.newAttributes;for(let sn=0,jt=Jt.length;sn<jt;sn++)Jt[sn]=0}function gt(Jt){Et(Jt,0)}function Et(Jt,sn){const jt=it.newAttributes,Vt=it.enabledAttributes,Lt=it.attributeDivisors;jt[Jt]=1,Vt[Jt]===0&&(a.enableVertexAttribArray(Jt),Vt[Jt]=1),Lt[Jt]!==sn&&((j.isWebGL2?a:s.get("ANGLE_instanced_arrays"))[j.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Jt,sn),Lt[Jt]=sn)}function St(){const Jt=it.newAttributes,sn=it.enabledAttributes;for(let jt=0,Vt=sn.length;jt<Vt;jt++)sn[jt]!==Jt[jt]&&(a.disableVertexAttribArray(jt),sn[jt]=0)}function Tt(Jt,sn,jt,Vt,Lt,Qt,nn){nn===!0?a.vertexAttribIPointer(Jt,sn,jt,Lt,Qt):a.vertexAttribPointer(Jt,sn,jt,Vt,Lt,Qt)}function Mt(Jt,sn,jt,Vt){if(j.isWebGL2===!1&&(Jt.isInstancedMesh||Vt.isInstancedBufferGeometry)&&s.get("ANGLE_instanced_arrays")===null)return;dt();const Lt=Vt.attributes,Qt=jt.getAttributes(),nn=sn.defaultAttributeValues;for(const mn in Qt){const Zt=Qt[mn];if(Zt.location>=0){let cn=Lt[mn];if(cn===void 0&&(mn==="instanceMatrix"&&Jt.instanceMatrix&&(cn=Jt.instanceMatrix),mn==="instanceColor"&&Jt.instanceColor&&(cn=Jt.instanceColor)),cn!==void 0){const Ot=cn.normalized,rn=cn.itemSize,fn=o.get(cn);if(fn===void 0)continue;const hn=fn.buffer,Tn=fn.type,Nn=fn.bytesPerElement,Pn=j.isWebGL2===!0&&(Tn===a.INT||Tn===a.UNSIGNED_INT||cn.gpuType===IntType);if(cn.isInterleavedBufferAttribute){const Dn=cn.data,ln=Dn.stride,Cn=cn.offset;if(Dn.isInstancedInterleavedBuffer){for(let bn=0;bn<Zt.locationSize;bn++)Et(Zt.location+bn,Dn.meshPerAttribute);Jt.isInstancedMesh!==!0&&Vt._maxInstanceCount===void 0&&(Vt._maxInstanceCount=Dn.meshPerAttribute*Dn.count)}else for(let bn=0;bn<Zt.locationSize;bn++)gt(Zt.location+bn);a.bindBuffer(a.ARRAY_BUFFER,hn);for(let bn=0;bn<Zt.locationSize;bn++)Tt(Zt.location+bn,rn/Zt.locationSize,Tn,Ot,ln*Nn,(Cn+rn/Zt.locationSize*bn)*Nn,Pn)}else{if(cn.isInstancedBufferAttribute){for(let Dn=0;Dn<Zt.locationSize;Dn++)Et(Zt.location+Dn,cn.meshPerAttribute);Jt.isInstancedMesh!==!0&&Vt._maxInstanceCount===void 0&&(Vt._maxInstanceCount=cn.meshPerAttribute*cn.count)}else for(let Dn=0;Dn<Zt.locationSize;Dn++)gt(Zt.location+Dn);a.bindBuffer(a.ARRAY_BUFFER,hn);for(let Dn=0;Dn<Zt.locationSize;Dn++)Tt(Zt.location+Dn,rn/Zt.locationSize,Tn,Ot,rn*Nn,rn/Zt.locationSize*Dn*Nn,Pn)}}else if(nn!==void 0){const Ot=nn[mn];if(Ot!==void 0)switch(Ot.length){case 2:a.vertexAttrib2fv(Zt.location,Ot);break;case 3:a.vertexAttrib3fv(Zt.location,Ot);break;case 4:a.vertexAttrib4fv(Zt.location,Ot);break;default:a.vertexAttrib1fv(Zt.location,Ot)}}}}St()}function Bt(){Ht();for(const Jt in nt){const sn=nt[Jt];for(const jt in sn){const Vt=sn[jt];for(const Lt in Vt)ft(Vt[Lt].object),delete Vt[Lt];delete sn[jt]}delete nt[Jt]}}function Rt(Jt){if(nt[Jt.id]===void 0)return;const sn=nt[Jt.id];for(const jt in sn){const Vt=sn[jt];for(const Lt in Vt)ft(Vt[Lt].object),delete Vt[Lt];delete sn[jt]}delete nt[Jt.id]}function Ut(Jt){for(const sn in nt){const jt=nt[sn];if(jt[Jt.id]===void 0)continue;const Vt=jt[Jt.id];for(const Lt in Vt)ft(Vt[Lt].object),delete Vt[Lt];delete jt[Jt.id]}}function Ht(){Wt(),st=!0,it!==rt&&(it=rt,ct(it.object))}function Wt(){rt.geometry=null,rt.program=null,rt.wireframe=!1}return{setup:at,reset:Ht,resetDefaultState:Wt,dispose:Bt,releaseStatesOfGeometry:Rt,releaseStatesOfProgram:Ut,initAttributes:dt,enableAttribute:gt,disableUnusedAttributes:St}}function WebGLBufferRenderer(a,s,o,j){const $=j.isWebGL2;let _e;function tt(it){_e=it}function nt(it,st){a.drawArrays(_e,it,st),o.update(st,_e,1)}function rt(it,st,at){if(at===0)return;let ot,ct;if($)ot=a,ct="drawArraysInstanced";else if(ot=s.get("ANGLE_instanced_arrays"),ct="drawArraysInstancedANGLE",ot===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}ot[ct](_e,it,st,at),o.update(st,_e,at)}this.setMode=tt,this.render=nt,this.renderInstances=rt}function WebGLCapabilities(a,s,o){let j;function $(){if(j!==void 0)return j;if(s.has("EXT_texture_filter_anisotropic")===!0){const Tt=s.get("EXT_texture_filter_anisotropic");j=a.getParameter(Tt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else j=0;return j}function _e(Tt){if(Tt==="highp"){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";Tt="mediump"}return Tt==="mediump"&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const tt=typeof WebGL2RenderingContext<"u"&&a.constructor.name==="WebGL2RenderingContext";let nt=o.precision!==void 0?o.precision:"highp";const rt=_e(nt);rt!==nt&&(console.warn("THREE.WebGLRenderer:",nt,"not supported, using",rt,"instead."),nt=rt);const it=tt||s.has("WEBGL_draw_buffers"),st=o.logarithmicDepthBuffer===!0,at=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),ot=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ct=a.getParameter(a.MAX_TEXTURE_SIZE),ft=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),ht=a.getParameter(a.MAX_VERTEX_ATTRIBS),mt=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),lt=a.getParameter(a.MAX_VARYING_VECTORS),ut=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),dt=ot>0,gt=tt||s.has("OES_texture_float"),Et=dt&&gt,St=tt?a.getParameter(a.MAX_SAMPLES):0;return{isWebGL2:tt,drawBuffers:it,getMaxAnisotropy:$,getMaxPrecision:_e,precision:nt,logarithmicDepthBuffer:st,maxTextures:at,maxVertexTextures:ot,maxTextureSize:ct,maxCubemapSize:ft,maxAttributes:ht,maxVertexUniforms:mt,maxVaryings:lt,maxFragmentUniforms:ut,vertexTextures:dt,floatFragmentTextures:gt,floatVertexTextures:Et,maxSamples:St}}function WebGLClipping(a){const s=this;let o=null,j=0,$=!1,_e=!1;const tt=new Plane,nt=new Matrix3,rt={value:null,needsUpdate:!1};this.uniform=rt,this.numPlanes=0,this.numIntersection=0,this.init=function(at,ot){const ct=at.length!==0||ot||j!==0||$;return $=ot,j=at.length,ct},this.beginShadows=function(){_e=!0,st(null)},this.endShadows=function(){_e=!1},this.setGlobalState=function(at,ot){o=st(at,ot,0)},this.setState=function(at,ot,ct){const ft=at.clippingPlanes,ht=at.clipIntersection,mt=at.clipShadows,lt=a.get(at);if(!$||ft===null||ft.length===0||_e&&!mt)_e?st(null):it();else{const ut=_e?0:j,dt=ut*4;let gt=lt.clippingState||null;rt.value=gt,gt=st(ft,ot,dt,ct);for(let Et=0;Et!==dt;++Et)gt[Et]=o[Et];lt.clippingState=gt,this.numIntersection=ht?this.numPlanes:0,this.numPlanes+=ut}};function it(){rt.value!==o&&(rt.value=o,rt.needsUpdate=j>0),s.numPlanes=j,s.numIntersection=0}function st(at,ot,ct,ft){const ht=at!==null?at.length:0;let mt=null;if(ht!==0){if(mt=rt.value,ft!==!0||mt===null){const lt=ct+ht*4,ut=ot.matrixWorldInverse;nt.getNormalMatrix(ut),(mt===null||mt.length<lt)&&(mt=new Float32Array(lt));for(let dt=0,gt=ct;dt!==ht;++dt,gt+=4)tt.copy(at[dt]).applyMatrix4(ut,nt),tt.normal.toArray(mt,gt),mt[gt+3]=tt.constant}rt.value=mt,rt.needsUpdate=!0}return s.numPlanes=ht,s.numIntersection=0,mt}}function WebGLCubeMaps(a){let s=new WeakMap;function o(tt,nt){return nt===EquirectangularReflectionMapping?tt.mapping=CubeReflectionMapping:nt===EquirectangularRefractionMapping&&(tt.mapping=CubeRefractionMapping),tt}function j(tt){if(tt&&tt.isTexture&&tt.isRenderTargetTexture===!1){const nt=tt.mapping;if(nt===EquirectangularReflectionMapping||nt===EquirectangularRefractionMapping)if(s.has(tt)){const rt=s.get(tt).texture;return o(rt,tt.mapping)}else{const rt=tt.image;if(rt&&rt.height>0){const it=new WebGLCubeRenderTarget(rt.height/2);return it.fromEquirectangularTexture(a,tt),s.set(tt,it),tt.addEventListener("dispose",$),o(it.texture,tt.mapping)}else return null}}return tt}function $(tt){const nt=tt.target;nt.removeEventListener("dispose",$);const rt=s.get(nt);rt!==void 0&&(s.delete(nt),rt.dispose())}function _e(){s=new WeakMap}return{get:j,dispose:_e}}class OrthographicCamera extends Camera{constructor(s=-1,o=1,j=1,$=-1,_e=.1,tt=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=s,this.right=o,this.top=j,this.bottom=$,this.near=_e,this.far=tt,this.updateProjectionMatrix()}copy(s,o){return super.copy(s,o),this.left=s.left,this.right=s.right,this.top=s.top,this.bottom=s.bottom,this.near=s.near,this.far=s.far,this.zoom=s.zoom,this.view=s.view===null?null:Object.assign({},s.view),this}setViewOffset(s,o,j,$,_e,tt){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=s,this.view.fullHeight=o,this.view.offsetX=j,this.view.offsetY=$,this.view.width=_e,this.view.height=tt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const s=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),j=(this.right+this.left)/2,$=(this.top+this.bottom)/2;let _e=j-s,tt=j+s,nt=$+o,rt=$-o;if(this.view!==null&&this.view.enabled){const it=(this.right-this.left)/this.view.fullWidth/this.zoom,st=(this.top-this.bottom)/this.view.fullHeight/this.zoom;_e+=it*this.view.offsetX,tt=_e+it*this.view.width,nt-=st*this.view.offsetY,rt=nt-st*this.view.height}this.projectionMatrix.makeOrthographic(_e,tt,nt,rt,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(s){const o=super.toJSON(s);return o.object.zoom=this.zoom,o.object.left=this.left,o.object.right=this.right,o.object.top=this.top,o.object.bottom=this.bottom,o.object.near=this.near,o.object.far=this.far,this.view!==null&&(o.object.view=Object.assign({},this.view)),o}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(s){this._renderer=s,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(s,o=0,j=.1,$=100){_oldTarget=this._renderer.getRenderTarget(),this._setSize(256);const _e=this._allocateTargets();return _e.depthBuffer=!0,this._sceneToCubeUV(s,j,$,_e),o>0&&this._blur(_e,0,0,o),this._applyPMREM(_e),this._cleanup(_e),_e}fromEquirectangular(s,o=null){return this._fromTexture(s,o)}fromCubemap(s,o=null){return this._fromTexture(s,o)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(s){this._lodMax=Math.floor(Math.log2(s)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let s=0;s<this._lodPlanes.length;s++)this._lodPlanes[s].dispose()}_cleanup(s){this._renderer.setRenderTarget(_oldTarget),s.scissorTest=!1,_setViewport(s,0,0,s.width,s.height)}_fromTexture(s,o){s.mapping===CubeReflectionMapping||s.mapping===CubeRefractionMapping?this._setSize(s.image.length===0?16:s.image[0].width||s.image[0].image.width):this._setSize(s.image.width/4),_oldTarget=this._renderer.getRenderTarget();const j=o||this._allocateTargets();return this._textureToCubeUV(s,j),this._applyPMREM(j),this._cleanup(j),j}_allocateTargets(){const s=3*Math.max(this._cubeSize,112),o=4*this._cubeSize,j={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},$=_createRenderTarget(s,o,j);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==s||this._pingPongRenderTarget.height!==o){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(s,o,j);const{_lodMax:_e}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(_e)),this._blurMaterial=_getBlurShader(_e,s,o)}return $}_compileMaterial(s){const o=new Mesh(this._lodPlanes[0],s);this._renderer.compile(o,_flatCamera)}_sceneToCubeUV(s,o,j,$){const nt=new PerspectiveCamera(90,1,o,j),rt=[1,-1,1,1,1,1],it=[1,1,1,-1,-1,-1],st=this._renderer,at=st.autoClear,ot=st.toneMapping;st.getClearColor(_clearColor),st.toneMapping=NoToneMapping,st.autoClear=!1;const ct=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ft=new Mesh(new BoxGeometry,ct);let ht=!1;const mt=s.background;mt?mt.isColor&&(ct.color.copy(mt),s.background=null,ht=!0):(ct.color.copy(_clearColor),ht=!0);for(let lt=0;lt<6;lt++){const ut=lt%3;ut===0?(nt.up.set(0,rt[lt],0),nt.lookAt(it[lt],0,0)):ut===1?(nt.up.set(0,0,rt[lt]),nt.lookAt(0,it[lt],0)):(nt.up.set(0,rt[lt],0),nt.lookAt(0,0,it[lt]));const dt=this._cubeSize;_setViewport($,ut*dt,lt>2?dt:0,dt,dt),st.setRenderTarget($),ht&&st.render(ft,nt),st.render(s,nt)}ft.geometry.dispose(),ft.material.dispose(),st.toneMapping=ot,st.autoClear=at,s.background=mt}_textureToCubeUV(s,o){const j=this._renderer,$=s.mapping===CubeReflectionMapping||s.mapping===CubeRefractionMapping;$?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=s.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const _e=$?this._cubemapMaterial:this._equirectMaterial,tt=new Mesh(this._lodPlanes[0],_e),nt=_e.uniforms;nt.envMap.value=s;const rt=this._cubeSize;_setViewport(o,0,0,3*rt,2*rt),j.setRenderTarget(o),j.render(tt,_flatCamera)}_applyPMREM(s){const o=this._renderer,j=o.autoClear;o.autoClear=!1;for(let $=1;$<this._lodPlanes.length;$++){const _e=Math.sqrt(this._sigmas[$]*this._sigmas[$]-this._sigmas[$-1]*this._sigmas[$-1]),tt=_axisDirections[($-1)%_axisDirections.length];this._blur(s,$-1,$,_e,tt)}o.autoClear=j}_blur(s,o,j,$,_e){const tt=this._pingPongRenderTarget;this._halfBlur(s,tt,o,j,$,"latitudinal",_e),this._halfBlur(tt,s,j,j,$,"longitudinal",_e)}_halfBlur(s,o,j,$,_e,tt,nt){const rt=this._renderer,it=this._blurMaterial;tt!=="latitudinal"&&tt!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const st=3,at=new Mesh(this._lodPlanes[$],it),ot=it.uniforms,ct=this._sizeLods[j]-1,ft=isFinite(_e)?Math.PI/(2*ct):2*Math.PI/(2*MAX_SAMPLES-1),ht=_e/ft,mt=isFinite(_e)?1+Math.floor(st*ht):MAX_SAMPLES;mt>MAX_SAMPLES&&console.warn(`sigmaRadians, ${_e}, is too large and will clip, as it requested ${mt} samples when the maximum is set to ${MAX_SAMPLES}`);const lt=[];let ut=0;for(let Tt=0;Tt<MAX_SAMPLES;++Tt){const Mt=Tt/ht,Bt=Math.exp(-Mt*Mt/2);lt.push(Bt),Tt===0?ut+=Bt:Tt<mt&&(ut+=2*Bt)}for(let Tt=0;Tt<lt.length;Tt++)lt[Tt]=lt[Tt]/ut;ot.envMap.value=s.texture,ot.samples.value=mt,ot.weights.value=lt,ot.latitudinal.value=tt==="latitudinal",nt&&(ot.poleAxis.value=nt);const{_lodMax:dt}=this;ot.dTheta.value=ft,ot.mipInt.value=dt-j;const gt=this._sizeLods[$],Et=3*gt*($>dt-LOD_MIN?$-dt+LOD_MIN:0),St=4*(this._cubeSize-gt);_setViewport(o,Et,St,3*gt,2*gt),rt.setRenderTarget(o),rt.render(at,_flatCamera)}}function _createPlanes(a){const s=[],o=[],j=[];let $=a;const _e=a-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let tt=0;tt<_e;tt++){const nt=Math.pow(2,$);o.push(nt);let rt=1/nt;tt>a-LOD_MIN?rt=EXTRA_LOD_SIGMA[tt-a+LOD_MIN-1]:tt===0&&(rt=0),j.push(rt);const it=1/(nt-2),st=-it,at=1+it,ot=[st,st,at,st,at,at,st,st,at,at,st,at],ct=6,ft=6,ht=3,mt=2,lt=1,ut=new Float32Array(ht*ft*ct),dt=new Float32Array(mt*ft*ct),gt=new Float32Array(lt*ft*ct);for(let St=0;St<ct;St++){const Tt=St%3*2/3-1,Mt=St>2?0:-1,Bt=[Tt,Mt,0,Tt+2/3,Mt,0,Tt+2/3,Mt+1,0,Tt,Mt,0,Tt+2/3,Mt+1,0,Tt,Mt+1,0];ut.set(Bt,ht*ft*St),dt.set(ot,mt*ft*St);const Rt=[St,St,St,St,St,St];gt.set(Rt,lt*ft*St)}const Et=new BufferGeometry;Et.setAttribute("position",new BufferAttribute(ut,ht)),Et.setAttribute("uv",new BufferAttribute(dt,mt)),Et.setAttribute("faceIndex",new BufferAttribute(gt,lt)),s.push(Et),$>LOD_MIN&&$--}return{lodPlanes:s,sizeLods:o,sigmas:j}}function _createRenderTarget(a,s,o){const j=new WebGLRenderTarget(a,s,o);return j.texture.mapping=CubeUVReflectionMapping,j.texture.name="PMREM.cubeUv",j.scissorTest=!0,j}function _setViewport(a,s,o,j,$){a.viewport.set(s,o,j,$),a.scissor.set(s,o,j,$)}function _getBlurShader(a,s,o){const j=new Float32Array(MAX_SAMPLES),$=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/s,CUBEUV_TEXEL_HEIGHT:1/o,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:j},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:$}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(a){let s=new WeakMap,o=null;function j(nt){if(nt&&nt.isTexture){const rt=nt.mapping,it=rt===EquirectangularReflectionMapping||rt===EquirectangularRefractionMapping,st=rt===CubeReflectionMapping||rt===CubeRefractionMapping;if(it||st)if(nt.isRenderTargetTexture&&nt.needsPMREMUpdate===!0){nt.needsPMREMUpdate=!1;let at=s.get(nt);return o===null&&(o=new PMREMGenerator(a)),at=it?o.fromEquirectangular(nt,at):o.fromCubemap(nt,at),s.set(nt,at),at.texture}else{if(s.has(nt))return s.get(nt).texture;{const at=nt.image;if(it&&at&&at.height>0||st&&at&&$(at)){o===null&&(o=new PMREMGenerator(a));const ot=it?o.fromEquirectangular(nt):o.fromCubemap(nt);return s.set(nt,ot),nt.addEventListener("dispose",_e),ot.texture}else return null}}}return nt}function $(nt){let rt=0;const it=6;for(let st=0;st<it;st++)nt[st]!==void 0&&rt++;return rt===it}function _e(nt){const rt=nt.target;rt.removeEventListener("dispose",_e);const it=s.get(rt);it!==void 0&&(s.delete(rt),it.dispose())}function tt(){s=new WeakMap,o!==null&&(o.dispose(),o=null)}return{get:j,dispose:tt}}function WebGLExtensions(a){const s={};function o(j){if(s[j]!==void 0)return s[j];let $;switch(j){case"WEBGL_depth_texture":$=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":$=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":$=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":$=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:$=a.getExtension(j)}return s[j]=$,$}return{has:function(j){return o(j)!==null},init:function(j){j.isWebGL2?o("EXT_color_buffer_float"):(o("WEBGL_depth_texture"),o("OES_texture_float"),o("OES_texture_half_float"),o("OES_texture_half_float_linear"),o("OES_standard_derivatives"),o("OES_element_index_uint"),o("OES_vertex_array_object"),o("ANGLE_instanced_arrays")),o("OES_texture_float_linear"),o("EXT_color_buffer_half_float"),o("WEBGL_multisampled_render_to_texture")},get:function(j){const $=o(j);return $===null&&console.warn("THREE.WebGLRenderer: "+j+" extension not supported."),$}}}function WebGLGeometries(a,s,o,j){const $={},_e=new WeakMap;function tt(at){const ot=at.target;ot.index!==null&&s.remove(ot.index);for(const ft in ot.attributes)s.remove(ot.attributes[ft]);for(const ft in ot.morphAttributes){const ht=ot.morphAttributes[ft];for(let mt=0,lt=ht.length;mt<lt;mt++)s.remove(ht[mt])}ot.removeEventListener("dispose",tt),delete $[ot.id];const ct=_e.get(ot);ct&&(s.remove(ct),_e.delete(ot)),j.releaseStatesOfGeometry(ot),ot.isInstancedBufferGeometry===!0&&delete ot._maxInstanceCount,o.memory.geometries--}function nt(at,ot){return $[ot.id]===!0||(ot.addEventListener("dispose",tt),$[ot.id]=!0,o.memory.geometries++),ot}function rt(at){const ot=at.attributes;for(const ft in ot)s.update(ot[ft],a.ARRAY_BUFFER);const ct=at.morphAttributes;for(const ft in ct){const ht=ct[ft];for(let mt=0,lt=ht.length;mt<lt;mt++)s.update(ht[mt],a.ARRAY_BUFFER)}}function it(at){const ot=[],ct=at.index,ft=at.attributes.position;let ht=0;if(ct!==null){const ut=ct.array;ht=ct.version;for(let dt=0,gt=ut.length;dt<gt;dt+=3){const Et=ut[dt+0],St=ut[dt+1],Tt=ut[dt+2];ot.push(Et,St,St,Tt,Tt,Et)}}else{const ut=ft.array;ht=ft.version;for(let dt=0,gt=ut.length/3-1;dt<gt;dt+=3){const Et=dt+0,St=dt+1,Tt=dt+2;ot.push(Et,St,St,Tt,Tt,Et)}}const mt=new(arrayNeedsUint32(ot)?Uint32BufferAttribute:Uint16BufferAttribute)(ot,1);mt.version=ht;const lt=_e.get(at);lt&&s.remove(lt),_e.set(at,mt)}function st(at){const ot=_e.get(at);if(ot){const ct=at.index;ct!==null&&ot.version<ct.version&&it(at)}else it(at);return _e.get(at)}return{get:nt,update:rt,getWireframeAttribute:st}}function WebGLIndexedBufferRenderer(a,s,o,j){const $=j.isWebGL2;let _e;function tt(ot){_e=ot}let nt,rt;function it(ot){nt=ot.type,rt=ot.bytesPerElement}function st(ot,ct){a.drawElements(_e,ct,nt,ot*rt),o.update(ct,_e,1)}function at(ot,ct,ft){if(ft===0)return;let ht,mt;if($)ht=a,mt="drawElementsInstanced";else if(ht=s.get("ANGLE_instanced_arrays"),mt="drawElementsInstancedANGLE",ht===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}ht[mt](_e,ct,nt,ot*rt,ft),o.update(ct,_e,ft)}this.setMode=tt,this.setIndex=it,this.render=st,this.renderInstances=at}function WebGLInfo(a){const s={geometries:0,textures:0},o={frame:0,calls:0,triangles:0,points:0,lines:0};function j(_e,tt,nt){switch(o.calls++,tt){case a.TRIANGLES:o.triangles+=nt*(_e/3);break;case a.LINES:o.lines+=nt*(_e/2);break;case a.LINE_STRIP:o.lines+=nt*(_e-1);break;case a.LINE_LOOP:o.lines+=nt*_e;break;case a.POINTS:o.points+=nt*_e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",tt);break}}function $(){o.calls=0,o.triangles=0,o.points=0,o.lines=0}return{memory:s,render:o,programs:null,autoReset:!0,reset:$,update:j}}function numericalSort(a,s){return a[0]-s[0]}function absNumericalSort(a,s){return Math.abs(s[1])-Math.abs(a[1])}function WebGLMorphtargets(a,s,o){const j={},$=new Float32Array(8),_e=new WeakMap,tt=new Vector4,nt=[];for(let it=0;it<8;it++)nt[it]=[it,0];function rt(it,st,at){const ot=it.morphTargetInfluences;if(s.isWebGL2===!0){const ft=st.morphAttributes.position||st.morphAttributes.normal||st.morphAttributes.color,ht=ft!==void 0?ft.length:0;let mt=_e.get(st);if(mt===void 0||mt.count!==ht){let sn=function(){Wt.dispose(),_e.delete(st),st.removeEventListener("dispose",sn)};var ct=sn;mt!==void 0&&mt.texture.dispose();const dt=st.morphAttributes.position!==void 0,gt=st.morphAttributes.normal!==void 0,Et=st.morphAttributes.color!==void 0,St=st.morphAttributes.position||[],Tt=st.morphAttributes.normal||[],Mt=st.morphAttributes.color||[];let Bt=0;dt===!0&&(Bt=1),gt===!0&&(Bt=2),Et===!0&&(Bt=3);let Rt=st.attributes.position.count*Bt,Ut=1;Rt>s.maxTextureSize&&(Ut=Math.ceil(Rt/s.maxTextureSize),Rt=s.maxTextureSize);const Ht=new Float32Array(Rt*Ut*4*ht),Wt=new DataArrayTexture(Ht,Rt,Ut,ht);Wt.type=FloatType,Wt.needsUpdate=!0;const Jt=Bt*4;for(let jt=0;jt<ht;jt++){const Vt=St[jt],Lt=Tt[jt],Qt=Mt[jt],nn=Rt*Ut*4*jt;for(let mn=0;mn<Vt.count;mn++){const Zt=mn*Jt;dt===!0&&(tt.fromBufferAttribute(Vt,mn),Ht[nn+Zt+0]=tt.x,Ht[nn+Zt+1]=tt.y,Ht[nn+Zt+2]=tt.z,Ht[nn+Zt+3]=0),gt===!0&&(tt.fromBufferAttribute(Lt,mn),Ht[nn+Zt+4]=tt.x,Ht[nn+Zt+5]=tt.y,Ht[nn+Zt+6]=tt.z,Ht[nn+Zt+7]=0),Et===!0&&(tt.fromBufferAttribute(Qt,mn),Ht[nn+Zt+8]=tt.x,Ht[nn+Zt+9]=tt.y,Ht[nn+Zt+10]=tt.z,Ht[nn+Zt+11]=Qt.itemSize===4?tt.w:1)}}mt={count:ht,texture:Wt,size:new Vector2(Rt,Ut)},_e.set(st,mt),st.addEventListener("dispose",sn)}let lt=0;for(let dt=0;dt<ot.length;dt++)lt+=ot[dt];const ut=st.morphTargetsRelative?1:1-lt;at.getUniforms().setValue(a,"morphTargetBaseInfluence",ut),at.getUniforms().setValue(a,"morphTargetInfluences",ot),at.getUniforms().setValue(a,"morphTargetsTexture",mt.texture,o),at.getUniforms().setValue(a,"morphTargetsTextureSize",mt.size)}else{const ft=ot===void 0?0:ot.length;let ht=j[st.id];if(ht===void 0||ht.length!==ft){ht=[];for(let gt=0;gt<ft;gt++)ht[gt]=[gt,0];j[st.id]=ht}for(let gt=0;gt<ft;gt++){const Et=ht[gt];Et[0]=gt,Et[1]=ot[gt]}ht.sort(absNumericalSort);for(let gt=0;gt<8;gt++)gt<ft&&ht[gt][1]?(nt[gt][0]=ht[gt][0],nt[gt][1]=ht[gt][1]):(nt[gt][0]=Number.MAX_SAFE_INTEGER,nt[gt][1]=0);nt.sort(numericalSort);const mt=st.morphAttributes.position,lt=st.morphAttributes.normal;let ut=0;for(let gt=0;gt<8;gt++){const Et=nt[gt],St=Et[0],Tt=Et[1];St!==Number.MAX_SAFE_INTEGER&&Tt?(mt&&st.getAttribute("morphTarget"+gt)!==mt[St]&&st.setAttribute("morphTarget"+gt,mt[St]),lt&&st.getAttribute("morphNormal"+gt)!==lt[St]&&st.setAttribute("morphNormal"+gt,lt[St]),$[gt]=Tt,ut+=Tt):(mt&&st.hasAttribute("morphTarget"+gt)===!0&&st.deleteAttribute("morphTarget"+gt),lt&&st.hasAttribute("morphNormal"+gt)===!0&&st.deleteAttribute("morphNormal"+gt),$[gt]=0)}const dt=st.morphTargetsRelative?1:1-ut;at.getUniforms().setValue(a,"morphTargetBaseInfluence",dt),at.getUniforms().setValue(a,"morphTargetInfluences",$)}}return{update:rt}}function WebGLObjects(a,s,o,j){let $=new WeakMap;function _e(rt){const it=j.render.frame,st=rt.geometry,at=s.get(rt,st);return $.get(at)!==it&&(s.update(at),$.set(at,it)),rt.isInstancedMesh&&(rt.hasEventListener("dispose",nt)===!1&&rt.addEventListener("dispose",nt),o.update(rt.instanceMatrix,a.ARRAY_BUFFER),rt.instanceColor!==null&&o.update(rt.instanceColor,a.ARRAY_BUFFER)),at}function tt(){$=new WeakMap}function nt(rt){const it=rt.target;it.removeEventListener("dispose",nt),o.remove(it.instanceMatrix),it.instanceColor!==null&&o.remove(it.instanceColor)}return{update:_e,dispose:tt}}const emptyTexture=new Texture,emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture$1,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(a,s,o){const j=a[0];if(j<=0||j>0)return a;const $=s*o;let _e=arrayCacheF32[$];if(_e===void 0&&(_e=new Float32Array($),arrayCacheF32[$]=_e),s!==0){j.toArray(_e,0);for(let tt=1,nt=0;tt!==s;++tt)nt+=o,a[tt].toArray(_e,nt)}return _e}function arraysEqual(a,s){if(a.length!==s.length)return!1;for(let o=0,j=a.length;o<j;o++)if(a[o]!==s[o])return!1;return!0}function copyArray(a,s){for(let o=0,j=s.length;o<j;o++)a[o]=s[o]}function allocTexUnits(a,s){let o=arrayCacheI32[s];o===void 0&&(o=new Int32Array(s),arrayCacheI32[s]=o);for(let j=0;j!==s;++j)o[j]=a.allocateTextureUnit();return o}function setValueV1f(a,s){const o=this.cache;o[0]!==s&&(a.uniform1f(this.addr,s),o[0]=s)}function setValueV2f(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y)&&(a.uniform2f(this.addr,s.x,s.y),o[0]=s.x,o[1]=s.y);else{if(arraysEqual(o,s))return;a.uniform2fv(this.addr,s),copyArray(o,s)}}function setValueV3f(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z)&&(a.uniform3f(this.addr,s.x,s.y,s.z),o[0]=s.x,o[1]=s.y,o[2]=s.z);else if(s.r!==void 0)(o[0]!==s.r||o[1]!==s.g||o[2]!==s.b)&&(a.uniform3f(this.addr,s.r,s.g,s.b),o[0]=s.r,o[1]=s.g,o[2]=s.b);else{if(arraysEqual(o,s))return;a.uniform3fv(this.addr,s),copyArray(o,s)}}function setValueV4f(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z||o[3]!==s.w)&&(a.uniform4f(this.addr,s.x,s.y,s.z,s.w),o[0]=s.x,o[1]=s.y,o[2]=s.z,o[3]=s.w);else{if(arraysEqual(o,s))return;a.uniform4fv(this.addr,s),copyArray(o,s)}}function setValueM2(a,s){const o=this.cache,j=s.elements;if(j===void 0){if(arraysEqual(o,s))return;a.uniformMatrix2fv(this.addr,!1,s),copyArray(o,s)}else{if(arraysEqual(o,j))return;mat2array.set(j),a.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(o,j)}}function setValueM3(a,s){const o=this.cache,j=s.elements;if(j===void 0){if(arraysEqual(o,s))return;a.uniformMatrix3fv(this.addr,!1,s),copyArray(o,s)}else{if(arraysEqual(o,j))return;mat3array.set(j),a.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(o,j)}}function setValueM4(a,s){const o=this.cache,j=s.elements;if(j===void 0){if(arraysEqual(o,s))return;a.uniformMatrix4fv(this.addr,!1,s),copyArray(o,s)}else{if(arraysEqual(o,j))return;mat4array.set(j),a.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(o,j)}}function setValueV1i(a,s){const o=this.cache;o[0]!==s&&(a.uniform1i(this.addr,s),o[0]=s)}function setValueV2i(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y)&&(a.uniform2i(this.addr,s.x,s.y),o[0]=s.x,o[1]=s.y);else{if(arraysEqual(o,s))return;a.uniform2iv(this.addr,s),copyArray(o,s)}}function setValueV3i(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z)&&(a.uniform3i(this.addr,s.x,s.y,s.z),o[0]=s.x,o[1]=s.y,o[2]=s.z);else{if(arraysEqual(o,s))return;a.uniform3iv(this.addr,s),copyArray(o,s)}}function setValueV4i(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z||o[3]!==s.w)&&(a.uniform4i(this.addr,s.x,s.y,s.z,s.w),o[0]=s.x,o[1]=s.y,o[2]=s.z,o[3]=s.w);else{if(arraysEqual(o,s))return;a.uniform4iv(this.addr,s),copyArray(o,s)}}function setValueV1ui(a,s){const o=this.cache;o[0]!==s&&(a.uniform1ui(this.addr,s),o[0]=s)}function setValueV2ui(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y)&&(a.uniform2ui(this.addr,s.x,s.y),o[0]=s.x,o[1]=s.y);else{if(arraysEqual(o,s))return;a.uniform2uiv(this.addr,s),copyArray(o,s)}}function setValueV3ui(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z)&&(a.uniform3ui(this.addr,s.x,s.y,s.z),o[0]=s.x,o[1]=s.y,o[2]=s.z);else{if(arraysEqual(o,s))return;a.uniform3uiv(this.addr,s),copyArray(o,s)}}function setValueV4ui(a,s){const o=this.cache;if(s.x!==void 0)(o[0]!==s.x||o[1]!==s.y||o[2]!==s.z||o[3]!==s.w)&&(a.uniform4ui(this.addr,s.x,s.y,s.z,s.w),o[0]=s.x,o[1]=s.y,o[2]=s.z,o[3]=s.w);else{if(arraysEqual(o,s))return;a.uniform4uiv(this.addr,s),copyArray(o,s)}}function setValueT1(a,s,o){const j=this.cache,$=o.allocateTextureUnit();j[0]!==$&&(a.uniform1i(this.addr,$),j[0]=$),o.setTexture2D(s||emptyTexture,$)}function setValueT3D1(a,s,o){const j=this.cache,$=o.allocateTextureUnit();j[0]!==$&&(a.uniform1i(this.addr,$),j[0]=$),o.setTexture3D(s||empty3dTexture,$)}function setValueT6(a,s,o){const j=this.cache,$=o.allocateTextureUnit();j[0]!==$&&(a.uniform1i(this.addr,$),j[0]=$),o.setTextureCube(s||emptyCubeTexture,$)}function setValueT2DArray1(a,s,o){const j=this.cache,$=o.allocateTextureUnit();j[0]!==$&&(a.uniform1i(this.addr,$),j[0]=$),o.setTexture2DArray(s||emptyArrayTexture,$)}function getSingularSetter(a){switch(a){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(a,s){a.uniform1fv(this.addr,s)}function setValueV2fArray(a,s){const o=flatten(s,this.size,2);a.uniform2fv(this.addr,o)}function setValueV3fArray(a,s){const o=flatten(s,this.size,3);a.uniform3fv(this.addr,o)}function setValueV4fArray(a,s){const o=flatten(s,this.size,4);a.uniform4fv(this.addr,o)}function setValueM2Array(a,s){const o=flatten(s,this.size,4);a.uniformMatrix2fv(this.addr,!1,o)}function setValueM3Array(a,s){const o=flatten(s,this.size,9);a.uniformMatrix3fv(this.addr,!1,o)}function setValueM4Array(a,s){const o=flatten(s,this.size,16);a.uniformMatrix4fv(this.addr,!1,o)}function setValueV1iArray(a,s){a.uniform1iv(this.addr,s)}function setValueV2iArray(a,s){a.uniform2iv(this.addr,s)}function setValueV3iArray(a,s){a.uniform3iv(this.addr,s)}function setValueV4iArray(a,s){a.uniform4iv(this.addr,s)}function setValueV1uiArray(a,s){a.uniform1uiv(this.addr,s)}function setValueV2uiArray(a,s){a.uniform2uiv(this.addr,s)}function setValueV3uiArray(a,s){a.uniform3uiv(this.addr,s)}function setValueV4uiArray(a,s){a.uniform4uiv(this.addr,s)}function setValueT1Array(a,s,o){const j=this.cache,$=s.length,_e=allocTexUnits(o,$);arraysEqual(j,_e)||(a.uniform1iv(this.addr,_e),copyArray(j,_e));for(let tt=0;tt!==$;++tt)o.setTexture2D(s[tt]||emptyTexture,_e[tt])}function setValueT3DArray(a,s,o){const j=this.cache,$=s.length,_e=allocTexUnits(o,$);arraysEqual(j,_e)||(a.uniform1iv(this.addr,_e),copyArray(j,_e));for(let tt=0;tt!==$;++tt)o.setTexture3D(s[tt]||empty3dTexture,_e[tt])}function setValueT6Array(a,s,o){const j=this.cache,$=s.length,_e=allocTexUnits(o,$);arraysEqual(j,_e)||(a.uniform1iv(this.addr,_e),copyArray(j,_e));for(let tt=0;tt!==$;++tt)o.setTextureCube(s[tt]||emptyCubeTexture,_e[tt])}function setValueT2DArrayArray(a,s,o){const j=this.cache,$=s.length,_e=allocTexUnits(o,$);arraysEqual(j,_e)||(a.uniform1iv(this.addr,_e),copyArray(j,_e));for(let tt=0;tt!==$;++tt)o.setTexture2DArray(s[tt]||emptyArrayTexture,_e[tt])}function getPureArraySetter(a){switch(a){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(s,o,j){this.id=s,this.addr=j,this.cache=[],this.setValue=getSingularSetter(o.type)}}class PureArrayUniform{constructor(s,o,j){this.id=s,this.addr=j,this.cache=[],this.size=o.size,this.setValue=getPureArraySetter(o.type)}}class StructuredUniform{constructor(s){this.id=s,this.seq=[],this.map={}}setValue(s,o,j){const $=this.seq;for(let _e=0,tt=$.length;_e!==tt;++_e){const nt=$[_e];nt.setValue(s,o[nt.id],j)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(a,s){a.seq.push(s),a.map[s.id]=s}function parseUniform(a,s,o){const j=a.name,$=j.length;for(RePathPart.lastIndex=0;;){const _e=RePathPart.exec(j),tt=RePathPart.lastIndex;let nt=_e[1];const rt=_e[2]==="]",it=_e[3];if(rt&&(nt=nt|0),it===void 0||it==="["&&tt+2===$){addUniform(o,it===void 0?new SingleUniform(nt,a,s):new PureArrayUniform(nt,a,s));break}else{let at=o.map[nt];at===void 0&&(at=new StructuredUniform(nt),addUniform(o,at)),o=at}}}class WebGLUniforms{constructor(s,o){this.seq=[],this.map={};const j=s.getProgramParameter(o,s.ACTIVE_UNIFORMS);for(let $=0;$<j;++$){const _e=s.getActiveUniform(o,$),tt=s.getUniformLocation(o,_e.name);parseUniform(_e,tt,this)}}setValue(s,o,j,$){const _e=this.map[o];_e!==void 0&&_e.setValue(s,j,$)}setOptional(s,o,j){const $=o[j];$!==void 0&&this.setValue(s,j,$)}static upload(s,o,j,$){for(let _e=0,tt=o.length;_e!==tt;++_e){const nt=o[_e],rt=j[nt.id];rt.needsUpdate!==!1&&nt.setValue(s,rt.value,$)}}static seqWithValue(s,o){const j=[];for(let $=0,_e=s.length;$!==_e;++$){const tt=s[$];tt.id in o&&j.push(tt)}return j}}function WebGLShader(a,s,o){const j=a.createShader(s);return a.shaderSource(j,o),a.compileShader(j),j}let programIdCount=0;function handleSource(a,s){const o=a.split(`
`),j=[],$=Math.max(s-6,0),_e=Math.min(s+6,o.length);for(let tt=$;tt<_e;tt++){const nt=tt+1;j.push(`${nt===s?">":" "} ${nt}: ${o[tt]}`)}return j.join(`
`)}function getEncodingComponents(a){switch(a){case LinearSRGBColorSpace:return["Linear","( value )"];case SRGBColorSpace:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",a),["Linear","( value )"]}}function getShaderErrors(a,s,o){const j=a.getShaderParameter(s,a.COMPILE_STATUS),$=a.getShaderInfoLog(s).trim();if(j&&$==="")return"";const _e=/ERROR: 0:(\d+)/.exec($);if(_e){const tt=parseInt(_e[1]);return o.toUpperCase()+`

`+$+`

`+handleSource(a.getShaderSource(s),tt)}else return $}function getTexelEncodingFunction(a,s){const o=getEncodingComponents(s);return"vec4 "+a+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"}function getToneMappingFunction(a,s){let o;switch(s){case LinearToneMapping:o="Linear";break;case ReinhardToneMapping:o="Reinhard";break;case CineonToneMapping:o="OptimizedCineon";break;case ACESFilmicToneMapping:o="ACESFilmic";break;case CustomToneMapping:o="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",s),o="Linear"}return"vec3 "+a+"( vec3 color ) { return "+o+"ToneMapping( color ); }"}function generateExtensions(a){return[a.extensionDerivatives||a.envMapCubeUVHeight||a.bumpMap||a.normalMapTangentSpace||a.clearcoatNormalMap||a.flatShading||a.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateDefines(a){const s=[];for(const o in a){const j=a[o];j!==!1&&s.push("#define "+o+" "+j)}return s.join(`
`)}function fetchAttributeLocations(a,s){const o={},j=a.getProgramParameter(s,a.ACTIVE_ATTRIBUTES);for(let $=0;$<j;$++){const _e=a.getActiveAttrib(s,$),tt=_e.name;let nt=1;_e.type===a.FLOAT_MAT2&&(nt=2),_e.type===a.FLOAT_MAT3&&(nt=3),_e.type===a.FLOAT_MAT4&&(nt=4),o[tt]={type:_e.type,location:a.getAttribLocation(s,tt),locationSize:nt}}return o}function filterEmptyLine(a){return a!==""}function replaceLightNums(a,s){const o=s.numSpotLightShadows+s.numSpotLightMaps-s.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,s.numDirLights).replace(/NUM_SPOT_LIGHTS/g,s.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,s.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,o).replace(/NUM_RECT_AREA_LIGHTS/g,s.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,s.numPointLights).replace(/NUM_HEMI_LIGHTS/g,s.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,s.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,s.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,s.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,s.numPointLightShadows)}function replaceClippingPlaneNums(a,s){return a.replace(/NUM_CLIPPING_PLANES/g,s.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,s.numClippingPlanes-s.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(a){return a.replace(includePattern,includeReplacer)}function includeReplacer(a,s){const o=ShaderChunk[s];if(o===void 0)throw new Error("Can not resolve #include <"+s+">");return resolveIncludes(o)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(a){return a.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(a,s,o,j){let $="";for(let _e=parseInt(s);_e<parseInt(o);_e++)$+=j.replace(/\[\s*i\s*\]/g,"[ "+_e+" ]").replace(/UNROLLED_LOOP_INDEX/g,_e);return $}function generatePrecision(a){let s="precision "+a.precision+` float;
precision `+a.precision+" int;";return a.precision==="highp"?s+=`
#define HIGH_PRECISION`:a.precision==="mediump"?s+=`
#define MEDIUM_PRECISION`:a.precision==="lowp"&&(s+=`
#define LOW_PRECISION`),s}function generateShadowMapTypeDefine(a){let s="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===PCFShadowMap?s="SHADOWMAP_TYPE_PCF":a.shadowMapType===PCFSoftShadowMap?s="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===VSMShadowMap&&(s="SHADOWMAP_TYPE_VSM"),s}function generateEnvMapTypeDefine(a){let s="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:s="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:s="ENVMAP_TYPE_CUBE_UV";break}return s}function generateEnvMapModeDefine(a){let s="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case CubeRefractionMapping:s="ENVMAP_MODE_REFRACTION";break}return s}function generateEnvMapBlendingDefine(a){let s="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case MultiplyOperation:s="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:s="ENVMAP_BLENDING_MIX";break;case AddOperation:s="ENVMAP_BLENDING_ADD";break}return s}function generateCubeUVSize(a){const s=a.envMapCubeUVHeight;if(s===null)return null;const o=Math.log2(s)-2,j=1/s;return{texelWidth:1/(3*Math.max(Math.pow(2,o),7*16)),texelHeight:j,maxMip:o}}function WebGLProgram(a,s,o,j){const $=a.getContext(),_e=o.defines;let tt=o.vertexShader,nt=o.fragmentShader;const rt=generateShadowMapTypeDefine(o),it=generateEnvMapTypeDefine(o),st=generateEnvMapModeDefine(o),at=generateEnvMapBlendingDefine(o),ot=generateCubeUVSize(o),ct=o.isWebGL2?"":generateExtensions(o),ft=generateDefines(_e),ht=$.createProgram();let mt,lt,ut=o.glslVersion?"#version "+o.glslVersion+`
`:"";o.isRawShaderMaterial?(mt=["#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,ft].filter(filterEmptyLine).join(`
`),mt.length>0&&(mt+=`
`),lt=[ct,"#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,ft].filter(filterEmptyLine).join(`
`),lt.length>0&&(lt+=`
`)):(mt=[generatePrecision(o),"#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,ft,o.instancing?"#define USE_INSTANCING":"",o.instancingColor?"#define USE_INSTANCING_COLOR":"",o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+st:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",o.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",o.displacementMap?"#define USE_DISPLACEMENTMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.anisotropyMap?"#define USE_ANISOTROPYMAP":"",o.clearcoatMap?"#define USE_CLEARCOATMAP":"",o.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",o.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",o.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.transmission?"#define USE_TRANSMISSION":"",o.transmissionMap?"#define USE_TRANSMISSIONMAP":"",o.thicknessMap?"#define USE_THICKNESSMAP":"",o.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",o.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",o.mapUv?"#define MAP_UV "+o.mapUv:"",o.alphaMapUv?"#define ALPHAMAP_UV "+o.alphaMapUv:"",o.lightMapUv?"#define LIGHTMAP_UV "+o.lightMapUv:"",o.aoMapUv?"#define AOMAP_UV "+o.aoMapUv:"",o.emissiveMapUv?"#define EMISSIVEMAP_UV "+o.emissiveMapUv:"",o.bumpMapUv?"#define BUMPMAP_UV "+o.bumpMapUv:"",o.normalMapUv?"#define NORMALMAP_UV "+o.normalMapUv:"",o.displacementMapUv?"#define DISPLACEMENTMAP_UV "+o.displacementMapUv:"",o.metalnessMapUv?"#define METALNESSMAP_UV "+o.metalnessMapUv:"",o.roughnessMapUv?"#define ROUGHNESSMAP_UV "+o.roughnessMapUv:"",o.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+o.anisotropyMapUv:"",o.clearcoatMapUv?"#define CLEARCOATMAP_UV "+o.clearcoatMapUv:"",o.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+o.clearcoatNormalMapUv:"",o.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+o.clearcoatRoughnessMapUv:"",o.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+o.iridescenceMapUv:"",o.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+o.iridescenceThicknessMapUv:"",o.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+o.sheenColorMapUv:"",o.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+o.sheenRoughnessMapUv:"",o.specularMapUv?"#define SPECULARMAP_UV "+o.specularMapUv:"",o.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+o.specularColorMapUv:"",o.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+o.specularIntensityMapUv:"",o.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+o.transmissionMapUv:"",o.thicknessMapUv?"#define THICKNESSMAP_UV "+o.thicknessMapUv:"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexAlphas?"#define USE_COLOR_ALPHA":"",o.vertexUv1s?"#define USE_UV1":"",o.vertexUv2s?"#define USE_UV2":"",o.vertexUv3s?"#define USE_UV3":"",o.pointsUvs?"#define USE_POINTS_UV":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&o.flatShading===!1?"#define USE_MORPHNORMALS":"",o.morphColors&&o.isWebGL2?"#define USE_MORPHCOLORS":"",o.morphTargetsCount>0&&o.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",o.morphTargetsCount>0&&o.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+o.morphTextureStride:"",o.morphTargetsCount>0&&o.isWebGL2?"#define MORPHTARGETS_COUNT "+o.morphTargetsCount:"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+rt:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.useLegacyLights?"#define LEGACY_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&o.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),lt=[ct,generatePrecision(o),"#define SHADER_TYPE "+o.shaderType,"#define SHADER_NAME "+o.shaderName,ft,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+it:"",o.envMap?"#define "+st:"",o.envMap?"#define "+at:"",ot?"#define CUBEUV_TEXEL_WIDTH "+ot.texelWidth:"",ot?"#define CUBEUV_TEXEL_HEIGHT "+ot.texelHeight:"",ot?"#define CUBEUV_MAX_MIP "+ot.maxMip+".0":"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",o.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.anisotropy?"#define USE_ANISOTROPY":"",o.anisotropyMap?"#define USE_ANISOTROPYMAP":"",o.clearcoat?"#define USE_CLEARCOAT":"",o.clearcoatMap?"#define USE_CLEARCOATMAP":"",o.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.iridescence?"#define USE_IRIDESCENCE":"",o.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",o.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",o.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.alphaTest?"#define USE_ALPHATEST":"",o.sheen?"#define USE_SHEEN":"",o.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",o.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",o.transmission?"#define USE_TRANSMISSION":"",o.transmissionMap?"#define USE_TRANSMISSIONMAP":"",o.thicknessMap?"#define USE_THICKNESSMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors||o.instancingColor?"#define USE_COLOR":"",o.vertexAlphas?"#define USE_COLOR_ALPHA":"",o.vertexUv1s?"#define USE_UV1":"",o.vertexUv2s?"#define USE_UV2":"",o.vertexUv3s?"#define USE_UV3":"",o.pointsUvs?"#define USE_POINTS_UV":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+rt:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.useLegacyLights?"#define LEGACY_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&o.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",o.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",o.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",o.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.opaque?"#define OPAQUE":"",ShaderChunk.encodings_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",o.outputColorSpace),o.useDepthPacking?"#define DEPTH_PACKING "+o.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),tt=resolveIncludes(tt),tt=replaceLightNums(tt,o),tt=replaceClippingPlaneNums(tt,o),nt=resolveIncludes(nt),nt=replaceLightNums(nt,o),nt=replaceClippingPlaneNums(nt,o),tt=unrollLoops(tt),nt=unrollLoops(nt),o.isWebGL2&&o.isRawShaderMaterial!==!0&&(ut=`#version 300 es
`,mt=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+mt,lt=["#define varying in",o.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",o.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+lt);const dt=ut+mt+tt,gt=ut+lt+nt,Et=WebGLShader($,$.VERTEX_SHADER,dt),St=WebGLShader($,$.FRAGMENT_SHADER,gt);if($.attachShader(ht,Et),$.attachShader(ht,St),o.index0AttributeName!==void 0?$.bindAttribLocation(ht,0,o.index0AttributeName):o.morphTargets===!0&&$.bindAttribLocation(ht,0,"position"),$.linkProgram(ht),a.debug.checkShaderErrors){const Bt=$.getProgramInfoLog(ht).trim(),Rt=$.getShaderInfoLog(Et).trim(),Ut=$.getShaderInfoLog(St).trim();let Ht=!0,Wt=!0;if($.getProgramParameter(ht,$.LINK_STATUS)===!1)if(Ht=!1,typeof a.debug.onShaderError=="function")a.debug.onShaderError($,ht,Et,St);else{const Jt=getShaderErrors($,Et,"vertex"),sn=getShaderErrors($,St,"fragment");console.error("THREE.WebGLProgram: Shader Error "+$.getError()+" - VALIDATE_STATUS "+$.getProgramParameter(ht,$.VALIDATE_STATUS)+`

Program Info Log: `+Bt+`
`+Jt+`
`+sn)}else Bt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Bt):(Rt===""||Ut==="")&&(Wt=!1);Wt&&(this.diagnostics={runnable:Ht,programLog:Bt,vertexShader:{log:Rt,prefix:mt},fragmentShader:{log:Ut,prefix:lt}})}$.deleteShader(Et),$.deleteShader(St);let Tt;this.getUniforms=function(){return Tt===void 0&&(Tt=new WebGLUniforms($,ht)),Tt};let Mt;return this.getAttributes=function(){return Mt===void 0&&(Mt=fetchAttributeLocations($,ht)),Mt},this.destroy=function(){j.releaseStatesOfProgram(this),$.deleteProgram(ht),this.program=void 0},this.type=o.shaderType,this.name=o.shaderName,this.id=programIdCount++,this.cacheKey=s,this.usedTimes=1,this.program=ht,this.vertexShader=Et,this.fragmentShader=St,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(s){const o=s.vertexShader,j=s.fragmentShader,$=this._getShaderStage(o),_e=this._getShaderStage(j),tt=this._getShaderCacheForMaterial(s);return tt.has($)===!1&&(tt.add($),$.usedTimes++),tt.has(_e)===!1&&(tt.add(_e),_e.usedTimes++),this}remove(s){const o=this.materialCache.get(s);for(const j of o)j.usedTimes--,j.usedTimes===0&&this.shaderCache.delete(j.code);return this.materialCache.delete(s),this}getVertexShaderID(s){return this._getShaderStage(s.vertexShader).id}getFragmentShaderID(s){return this._getShaderStage(s.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(s){const o=this.materialCache;let j=o.get(s);return j===void 0&&(j=new Set,o.set(s,j)),j}_getShaderStage(s){const o=this.shaderCache;let j=o.get(s);return j===void 0&&(j=new WebGLShaderStage(s),o.set(s,j)),j}}class WebGLShaderStage{constructor(s){this.id=_id++,this.code=s,this.usedTimes=0}}function WebGLPrograms(a,s,o,j,$,_e,tt){const nt=new Layers,rt=new WebGLShaderCache,it=[],st=$.isWebGL2,at=$.logarithmicDepthBuffer,ot=$.vertexTextures;let ct=$.precision;const ft={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ht(Bt){return Bt===0?"uv":`uv${Bt}`}function mt(Bt,Rt,Ut,Ht,Wt){const Jt=Ht.fog,sn=Wt.geometry,jt=Bt.isMeshStandardMaterial?Ht.environment:null,Vt=(Bt.isMeshStandardMaterial?o:s).get(Bt.envMap||jt),Lt=Vt&&Vt.mapping===CubeUVReflectionMapping?Vt.image.height:null,Qt=ft[Bt.type];Bt.precision!==null&&(ct=$.getMaxPrecision(Bt.precision),ct!==Bt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Bt.precision,"not supported, using",ct,"instead."));const nn=sn.morphAttributes.position||sn.morphAttributes.normal||sn.morphAttributes.color,mn=nn!==void 0?nn.length:0;let Zt=0;sn.morphAttributes.position!==void 0&&(Zt=1),sn.morphAttributes.normal!==void 0&&(Zt=2),sn.morphAttributes.color!==void 0&&(Zt=3);let cn,Ot,rn,fn;if(Qt){const Hr=ShaderLib[Qt];cn=Hr.vertexShader,Ot=Hr.fragmentShader}else cn=Bt.vertexShader,Ot=Bt.fragmentShader,rt.update(Bt),rn=rt.getVertexShaderID(Bt),fn=rt.getFragmentShaderID(Bt);const hn=a.getRenderTarget(),Tn=Wt.isInstancedMesh===!0,Nn=!!Bt.map,Pn=!!Bt.matcap,Dn=!!Vt,ln=!!Bt.aoMap,Cn=!!Bt.lightMap,bn=!!Bt.bumpMap,kn=!!Bt.normalMap,Sn=!!Bt.displacementMap,xn=!!Bt.emissiveMap,Qn=!!Bt.metalnessMap,nr=!!Bt.roughnessMap,or=Bt.anisotropy>0,mr=Bt.clearcoat>0,$n=Bt.iridescence>0,tn=Bt.sheen>0,$t=Bt.transmission>0,An=or&&!!Bt.anisotropyMap,En=mr&&!!Bt.clearcoatMap,In=mr&&!!Bt.clearcoatNormalMap,Hn=mr&&!!Bt.clearcoatRoughnessMap,yn=$n&&!!Bt.iridescenceMap,On=$n&&!!Bt.iridescenceThicknessMap,Mn=tn&&!!Bt.sheenColorMap,tr=tn&&!!Bt.sheenRoughnessMap,gr=!!Bt.specularMap,Cr=!!Bt.specularColorMap,Sr=!!Bt.specularIntensityMap,Un=$t&&!!Bt.transmissionMap,Jn=$t&&!!Bt.thicknessMap,pr=!!Bt.gradientMap,Gn=!!Bt.alphaMap,Zn=Bt.alphaTest>0,qn=!!Bt.extensions,vr=!!sn.attributes.uv1,_r=!!sn.attributes.uv2,$r=!!sn.attributes.uv3;return{isWebGL2:st,shaderID:Qt,shaderType:Bt.type,shaderName:Bt.name,vertexShader:cn,fragmentShader:Ot,defines:Bt.defines,customVertexShaderID:rn,customFragmentShaderID:fn,isRawShaderMaterial:Bt.isRawShaderMaterial===!0,glslVersion:Bt.glslVersion,precision:ct,instancing:Tn,instancingColor:Tn&&Wt.instanceColor!==null,supportsVertexTextures:ot,outputColorSpace:hn===null?a.outputColorSpace:hn.isXRRenderTarget===!0?hn.texture.colorSpace:LinearSRGBColorSpace,map:Nn,matcap:Pn,envMap:Dn,envMapMode:Dn&&Vt.mapping,envMapCubeUVHeight:Lt,aoMap:ln,lightMap:Cn,bumpMap:bn,normalMap:kn,displacementMap:ot&&Sn,emissiveMap:xn,normalMapObjectSpace:kn&&Bt.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:kn&&Bt.normalMapType===TangentSpaceNormalMap,metalnessMap:Qn,roughnessMap:nr,anisotropy:or,anisotropyMap:An,clearcoat:mr,clearcoatMap:En,clearcoatNormalMap:In,clearcoatRoughnessMap:Hn,iridescence:$n,iridescenceMap:yn,iridescenceThicknessMap:On,sheen:tn,sheenColorMap:Mn,sheenRoughnessMap:tr,specularMap:gr,specularColorMap:Cr,specularIntensityMap:Sr,transmission:$t,transmissionMap:Un,thicknessMap:Jn,gradientMap:pr,opaque:Bt.transparent===!1&&Bt.blending===NormalBlending,alphaMap:Gn,alphaTest:Zn,combine:Bt.combine,mapUv:Nn&&ht(Bt.map.channel),aoMapUv:ln&&ht(Bt.aoMap.channel),lightMapUv:Cn&&ht(Bt.lightMap.channel),bumpMapUv:bn&&ht(Bt.bumpMap.channel),normalMapUv:kn&&ht(Bt.normalMap.channel),displacementMapUv:Sn&&ht(Bt.displacementMap.channel),emissiveMapUv:xn&&ht(Bt.emissiveMap.channel),metalnessMapUv:Qn&&ht(Bt.metalnessMap.channel),roughnessMapUv:nr&&ht(Bt.roughnessMap.channel),anisotropyMapUv:An&&ht(Bt.anisotropyMap.channel),clearcoatMapUv:En&&ht(Bt.clearcoatMap.channel),clearcoatNormalMapUv:In&&ht(Bt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Hn&&ht(Bt.clearcoatRoughnessMap.channel),iridescenceMapUv:yn&&ht(Bt.iridescenceMap.channel),iridescenceThicknessMapUv:On&&ht(Bt.iridescenceThicknessMap.channel),sheenColorMapUv:Mn&&ht(Bt.sheenColorMap.channel),sheenRoughnessMapUv:tr&&ht(Bt.sheenRoughnessMap.channel),specularMapUv:gr&&ht(Bt.specularMap.channel),specularColorMapUv:Cr&&ht(Bt.specularColorMap.channel),specularIntensityMapUv:Sr&&ht(Bt.specularIntensityMap.channel),transmissionMapUv:Un&&ht(Bt.transmissionMap.channel),thicknessMapUv:Jn&&ht(Bt.thicknessMap.channel),alphaMapUv:Gn&&ht(Bt.alphaMap.channel),vertexTangents:!!sn.attributes.tangent&&(kn||or),vertexColors:Bt.vertexColors,vertexAlphas:Bt.vertexColors===!0&&!!sn.attributes.color&&sn.attributes.color.itemSize===4,vertexUv1s:vr,vertexUv2s:_r,vertexUv3s:$r,pointsUvs:Wt.isPoints===!0&&!!sn.attributes.uv&&(Nn||Gn),fog:!!Jt,useFog:Bt.fog===!0,fogExp2:Jt&&Jt.isFogExp2,flatShading:Bt.flatShading===!0,sizeAttenuation:Bt.sizeAttenuation===!0,logarithmicDepthBuffer:at,skinning:Wt.isSkinnedMesh===!0,morphTargets:sn.morphAttributes.position!==void 0,morphNormals:sn.morphAttributes.normal!==void 0,morphColors:sn.morphAttributes.color!==void 0,morphTargetsCount:mn,morphTextureStride:Zt,numDirLights:Rt.directional.length,numPointLights:Rt.point.length,numSpotLights:Rt.spot.length,numSpotLightMaps:Rt.spotLightMap.length,numRectAreaLights:Rt.rectArea.length,numHemiLights:Rt.hemi.length,numDirLightShadows:Rt.directionalShadowMap.length,numPointLightShadows:Rt.pointShadowMap.length,numSpotLightShadows:Rt.spotShadowMap.length,numSpotLightShadowsWithMaps:Rt.numSpotLightShadowsWithMaps,numClippingPlanes:tt.numPlanes,numClipIntersection:tt.numIntersection,dithering:Bt.dithering,shadowMapEnabled:a.shadowMap.enabled&&Ut.length>0,shadowMapType:a.shadowMap.type,toneMapping:Bt.toneMapped?a.toneMapping:NoToneMapping,useLegacyLights:a.useLegacyLights,premultipliedAlpha:Bt.premultipliedAlpha,doubleSided:Bt.side===DoubleSide,flipSided:Bt.side===BackSide,useDepthPacking:Bt.depthPacking>=0,depthPacking:Bt.depthPacking||0,index0AttributeName:Bt.index0AttributeName,extensionDerivatives:qn&&Bt.extensions.derivatives===!0,extensionFragDepth:qn&&Bt.extensions.fragDepth===!0,extensionDrawBuffers:qn&&Bt.extensions.drawBuffers===!0,extensionShaderTextureLOD:qn&&Bt.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:st||j.has("EXT_frag_depth"),rendererExtensionDrawBuffers:st||j.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:st||j.has("EXT_shader_texture_lod"),customProgramCacheKey:Bt.customProgramCacheKey()}}function lt(Bt){const Rt=[];if(Bt.shaderID?Rt.push(Bt.shaderID):(Rt.push(Bt.customVertexShaderID),Rt.push(Bt.customFragmentShaderID)),Bt.defines!==void 0)for(const Ut in Bt.defines)Rt.push(Ut),Rt.push(Bt.defines[Ut]);return Bt.isRawShaderMaterial===!1&&(ut(Rt,Bt),dt(Rt,Bt),Rt.push(a.outputColorSpace)),Rt.push(Bt.customProgramCacheKey),Rt.join()}function ut(Bt,Rt){Bt.push(Rt.precision),Bt.push(Rt.outputColorSpace),Bt.push(Rt.envMapMode),Bt.push(Rt.envMapCubeUVHeight),Bt.push(Rt.mapUv),Bt.push(Rt.alphaMapUv),Bt.push(Rt.lightMapUv),Bt.push(Rt.aoMapUv),Bt.push(Rt.bumpMapUv),Bt.push(Rt.normalMapUv),Bt.push(Rt.displacementMapUv),Bt.push(Rt.emissiveMapUv),Bt.push(Rt.metalnessMapUv),Bt.push(Rt.roughnessMapUv),Bt.push(Rt.anisotropyMapUv),Bt.push(Rt.clearcoatMapUv),Bt.push(Rt.clearcoatNormalMapUv),Bt.push(Rt.clearcoatRoughnessMapUv),Bt.push(Rt.iridescenceMapUv),Bt.push(Rt.iridescenceThicknessMapUv),Bt.push(Rt.sheenColorMapUv),Bt.push(Rt.sheenRoughnessMapUv),Bt.push(Rt.specularMapUv),Bt.push(Rt.specularColorMapUv),Bt.push(Rt.specularIntensityMapUv),Bt.push(Rt.transmissionMapUv),Bt.push(Rt.thicknessMapUv),Bt.push(Rt.combine),Bt.push(Rt.fogExp2),Bt.push(Rt.sizeAttenuation),Bt.push(Rt.morphTargetsCount),Bt.push(Rt.morphAttributeCount),Bt.push(Rt.numDirLights),Bt.push(Rt.numPointLights),Bt.push(Rt.numSpotLights),Bt.push(Rt.numSpotLightMaps),Bt.push(Rt.numHemiLights),Bt.push(Rt.numRectAreaLights),Bt.push(Rt.numDirLightShadows),Bt.push(Rt.numPointLightShadows),Bt.push(Rt.numSpotLightShadows),Bt.push(Rt.numSpotLightShadowsWithMaps),Bt.push(Rt.shadowMapType),Bt.push(Rt.toneMapping),Bt.push(Rt.numClippingPlanes),Bt.push(Rt.numClipIntersection),Bt.push(Rt.depthPacking)}function dt(Bt,Rt){nt.disableAll(),Rt.isWebGL2&&nt.enable(0),Rt.supportsVertexTextures&&nt.enable(1),Rt.instancing&&nt.enable(2),Rt.instancingColor&&nt.enable(3),Rt.matcap&&nt.enable(4),Rt.envMap&&nt.enable(5),Rt.normalMapObjectSpace&&nt.enable(6),Rt.normalMapTangentSpace&&nt.enable(7),Rt.clearcoat&&nt.enable(8),Rt.iridescence&&nt.enable(9),Rt.alphaTest&&nt.enable(10),Rt.vertexColors&&nt.enable(11),Rt.vertexAlphas&&nt.enable(12),Rt.vertexUv1s&&nt.enable(13),Rt.vertexUv2s&&nt.enable(14),Rt.vertexUv3s&&nt.enable(15),Rt.vertexTangents&&nt.enable(16),Rt.anisotropy&&nt.enable(17),Bt.push(nt.mask),nt.disableAll(),Rt.fog&&nt.enable(0),Rt.useFog&&nt.enable(1),Rt.flatShading&&nt.enable(2),Rt.logarithmicDepthBuffer&&nt.enable(3),Rt.skinning&&nt.enable(4),Rt.morphTargets&&nt.enable(5),Rt.morphNormals&&nt.enable(6),Rt.morphColors&&nt.enable(7),Rt.premultipliedAlpha&&nt.enable(8),Rt.shadowMapEnabled&&nt.enable(9),Rt.useLegacyLights&&nt.enable(10),Rt.doubleSided&&nt.enable(11),Rt.flipSided&&nt.enable(12),Rt.useDepthPacking&&nt.enable(13),Rt.dithering&&nt.enable(14),Rt.transmission&&nt.enable(15),Rt.sheen&&nt.enable(16),Rt.opaque&&nt.enable(17),Rt.pointsUvs&&nt.enable(18),Bt.push(nt.mask)}function gt(Bt){const Rt=ft[Bt.type];let Ut;if(Rt){const Ht=ShaderLib[Rt];Ut=UniformsUtils.clone(Ht.uniforms)}else Ut=Bt.uniforms;return Ut}function Et(Bt,Rt){let Ut;for(let Ht=0,Wt=it.length;Ht<Wt;Ht++){const Jt=it[Ht];if(Jt.cacheKey===Rt){Ut=Jt,++Ut.usedTimes;break}}return Ut===void 0&&(Ut=new WebGLProgram(a,Rt,Bt,_e),it.push(Ut)),Ut}function St(Bt){if(--Bt.usedTimes===0){const Rt=it.indexOf(Bt);it[Rt]=it[it.length-1],it.pop(),Bt.destroy()}}function Tt(Bt){rt.remove(Bt)}function Mt(){rt.dispose()}return{getParameters:mt,getProgramCacheKey:lt,getUniforms:gt,acquireProgram:Et,releaseProgram:St,releaseShaderCache:Tt,programs:it,dispose:Mt}}function WebGLProperties(){let a=new WeakMap;function s(_e){let tt=a.get(_e);return tt===void 0&&(tt={},a.set(_e,tt)),tt}function o(_e){a.delete(_e)}function j(_e,tt,nt){a.get(_e)[tt]=nt}function $(){a=new WeakMap}return{get:s,remove:o,update:j,dispose:$}}function painterSortStable(a,s){return a.groupOrder!==s.groupOrder?a.groupOrder-s.groupOrder:a.renderOrder!==s.renderOrder?a.renderOrder-s.renderOrder:a.material.id!==s.material.id?a.material.id-s.material.id:a.z!==s.z?a.z-s.z:a.id-s.id}function reversePainterSortStable(a,s){return a.groupOrder!==s.groupOrder?a.groupOrder-s.groupOrder:a.renderOrder!==s.renderOrder?a.renderOrder-s.renderOrder:a.z!==s.z?s.z-a.z:a.id-s.id}function WebGLRenderList(){const a=[];let s=0;const o=[],j=[],$=[];function _e(){s=0,o.length=0,j.length=0,$.length=0}function tt(at,ot,ct,ft,ht,mt){let lt=a[s];return lt===void 0?(lt={id:at.id,object:at,geometry:ot,material:ct,groupOrder:ft,renderOrder:at.renderOrder,z:ht,group:mt},a[s]=lt):(lt.id=at.id,lt.object=at,lt.geometry=ot,lt.material=ct,lt.groupOrder=ft,lt.renderOrder=at.renderOrder,lt.z=ht,lt.group=mt),s++,lt}function nt(at,ot,ct,ft,ht,mt){const lt=tt(at,ot,ct,ft,ht,mt);ct.transmission>0?j.push(lt):ct.transparent===!0?$.push(lt):o.push(lt)}function rt(at,ot,ct,ft,ht,mt){const lt=tt(at,ot,ct,ft,ht,mt);ct.transmission>0?j.unshift(lt):ct.transparent===!0?$.unshift(lt):o.unshift(lt)}function it(at,ot){o.length>1&&o.sort(at||painterSortStable),j.length>1&&j.sort(ot||reversePainterSortStable),$.length>1&&$.sort(ot||reversePainterSortStable)}function st(){for(let at=s,ot=a.length;at<ot;at++){const ct=a[at];if(ct.id===null)break;ct.id=null,ct.object=null,ct.geometry=null,ct.material=null,ct.group=null}}return{opaque:o,transmissive:j,transparent:$,init:_e,push:nt,unshift:rt,finish:st,sort:it}}function WebGLRenderLists(){let a=new WeakMap;function s(j,$){const _e=a.get(j);let tt;return _e===void 0?(tt=new WebGLRenderList,a.set(j,[tt])):$>=_e.length?(tt=new WebGLRenderList,_e.push(tt)):tt=_e[$],tt}function o(){a=new WeakMap}return{get:s,dispose:o}}function UniformsCache(){const a={};return{get:function(s){if(a[s.id]!==void 0)return a[s.id];let o;switch(s.type){case"DirectionalLight":o={direction:new Vector3,color:new Color};break;case"SpotLight":o={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":o={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":o={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":o={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return a[s.id]=o,o}}}function ShadowUniformsCache(){const a={};return{get:function(s){if(a[s.id]!==void 0)return a[s.id];let o;switch(s.type){case"DirectionalLight":o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return a[s.id]=o,o}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(a,s){return(s.castShadow?2:0)-(a.castShadow?2:0)+(s.map?1:0)-(a.map?1:0)}function WebGLLights(a,s){const o=new UniformsCache,j=ShadowUniformsCache(),$={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let st=0;st<9;st++)$.probe.push(new Vector3);const _e=new Vector3,tt=new Matrix4,nt=new Matrix4;function rt(st,at){let ot=0,ct=0,ft=0;for(let Ut=0;Ut<9;Ut++)$.probe[Ut].set(0,0,0);let ht=0,mt=0,lt=0,ut=0,dt=0,gt=0,Et=0,St=0,Tt=0,Mt=0;st.sort(shadowCastingAndTexturingLightsFirst);const Bt=at===!0?Math.PI:1;for(let Ut=0,Ht=st.length;Ut<Ht;Ut++){const Wt=st[Ut],Jt=Wt.color,sn=Wt.intensity,jt=Wt.distance,Vt=Wt.shadow&&Wt.shadow.map?Wt.shadow.map.texture:null;if(Wt.isAmbientLight)ot+=Jt.r*sn*Bt,ct+=Jt.g*sn*Bt,ft+=Jt.b*sn*Bt;else if(Wt.isLightProbe)for(let Lt=0;Lt<9;Lt++)$.probe[Lt].addScaledVector(Wt.sh.coefficients[Lt],sn);else if(Wt.isDirectionalLight){const Lt=o.get(Wt);if(Lt.color.copy(Wt.color).multiplyScalar(Wt.intensity*Bt),Wt.castShadow){const Qt=Wt.shadow,nn=j.get(Wt);nn.shadowBias=Qt.bias,nn.shadowNormalBias=Qt.normalBias,nn.shadowRadius=Qt.radius,nn.shadowMapSize=Qt.mapSize,$.directionalShadow[ht]=nn,$.directionalShadowMap[ht]=Vt,$.directionalShadowMatrix[ht]=Wt.shadow.matrix,gt++}$.directional[ht]=Lt,ht++}else if(Wt.isSpotLight){const Lt=o.get(Wt);Lt.position.setFromMatrixPosition(Wt.matrixWorld),Lt.color.copy(Jt).multiplyScalar(sn*Bt),Lt.distance=jt,Lt.coneCos=Math.cos(Wt.angle),Lt.penumbraCos=Math.cos(Wt.angle*(1-Wt.penumbra)),Lt.decay=Wt.decay,$.spot[lt]=Lt;const Qt=Wt.shadow;if(Wt.map&&($.spotLightMap[Tt]=Wt.map,Tt++,Qt.updateMatrices(Wt),Wt.castShadow&&Mt++),$.spotLightMatrix[lt]=Qt.matrix,Wt.castShadow){const nn=j.get(Wt);nn.shadowBias=Qt.bias,nn.shadowNormalBias=Qt.normalBias,nn.shadowRadius=Qt.radius,nn.shadowMapSize=Qt.mapSize,$.spotShadow[lt]=nn,$.spotShadowMap[lt]=Vt,St++}lt++}else if(Wt.isRectAreaLight){const Lt=o.get(Wt);Lt.color.copy(Jt).multiplyScalar(sn),Lt.halfWidth.set(Wt.width*.5,0,0),Lt.halfHeight.set(0,Wt.height*.5,0),$.rectArea[ut]=Lt,ut++}else if(Wt.isPointLight){const Lt=o.get(Wt);if(Lt.color.copy(Wt.color).multiplyScalar(Wt.intensity*Bt),Lt.distance=Wt.distance,Lt.decay=Wt.decay,Wt.castShadow){const Qt=Wt.shadow,nn=j.get(Wt);nn.shadowBias=Qt.bias,nn.shadowNormalBias=Qt.normalBias,nn.shadowRadius=Qt.radius,nn.shadowMapSize=Qt.mapSize,nn.shadowCameraNear=Qt.camera.near,nn.shadowCameraFar=Qt.camera.far,$.pointShadow[mt]=nn,$.pointShadowMap[mt]=Vt,$.pointShadowMatrix[mt]=Wt.shadow.matrix,Et++}$.point[mt]=Lt,mt++}else if(Wt.isHemisphereLight){const Lt=o.get(Wt);Lt.skyColor.copy(Wt.color).multiplyScalar(sn*Bt),Lt.groundColor.copy(Wt.groundColor).multiplyScalar(sn*Bt),$.hemi[dt]=Lt,dt++}}ut>0&&(s.isWebGL2||a.has("OES_texture_float_linear")===!0?($.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,$.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):a.has("OES_texture_half_float_linear")===!0?($.rectAreaLTC1=UniformsLib.LTC_HALF_1,$.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),$.ambient[0]=ot,$.ambient[1]=ct,$.ambient[2]=ft;const Rt=$.hash;(Rt.directionalLength!==ht||Rt.pointLength!==mt||Rt.spotLength!==lt||Rt.rectAreaLength!==ut||Rt.hemiLength!==dt||Rt.numDirectionalShadows!==gt||Rt.numPointShadows!==Et||Rt.numSpotShadows!==St||Rt.numSpotMaps!==Tt)&&($.directional.length=ht,$.spot.length=lt,$.rectArea.length=ut,$.point.length=mt,$.hemi.length=dt,$.directionalShadow.length=gt,$.directionalShadowMap.length=gt,$.pointShadow.length=Et,$.pointShadowMap.length=Et,$.spotShadow.length=St,$.spotShadowMap.length=St,$.directionalShadowMatrix.length=gt,$.pointShadowMatrix.length=Et,$.spotLightMatrix.length=St+Tt-Mt,$.spotLightMap.length=Tt,$.numSpotLightShadowsWithMaps=Mt,Rt.directionalLength=ht,Rt.pointLength=mt,Rt.spotLength=lt,Rt.rectAreaLength=ut,Rt.hemiLength=dt,Rt.numDirectionalShadows=gt,Rt.numPointShadows=Et,Rt.numSpotShadows=St,Rt.numSpotMaps=Tt,$.version=nextVersion++)}function it(st,at){let ot=0,ct=0,ft=0,ht=0,mt=0;const lt=at.matrixWorldInverse;for(let ut=0,dt=st.length;ut<dt;ut++){const gt=st[ut];if(gt.isDirectionalLight){const Et=$.directional[ot];Et.direction.setFromMatrixPosition(gt.matrixWorld),_e.setFromMatrixPosition(gt.target.matrixWorld),Et.direction.sub(_e),Et.direction.transformDirection(lt),ot++}else if(gt.isSpotLight){const Et=$.spot[ft];Et.position.setFromMatrixPosition(gt.matrixWorld),Et.position.applyMatrix4(lt),Et.direction.setFromMatrixPosition(gt.matrixWorld),_e.setFromMatrixPosition(gt.target.matrixWorld),Et.direction.sub(_e),Et.direction.transformDirection(lt),ft++}else if(gt.isRectAreaLight){const Et=$.rectArea[ht];Et.position.setFromMatrixPosition(gt.matrixWorld),Et.position.applyMatrix4(lt),nt.identity(),tt.copy(gt.matrixWorld),tt.premultiply(lt),nt.extractRotation(tt),Et.halfWidth.set(gt.width*.5,0,0),Et.halfHeight.set(0,gt.height*.5,0),Et.halfWidth.applyMatrix4(nt),Et.halfHeight.applyMatrix4(nt),ht++}else if(gt.isPointLight){const Et=$.point[ct];Et.position.setFromMatrixPosition(gt.matrixWorld),Et.position.applyMatrix4(lt),ct++}else if(gt.isHemisphereLight){const Et=$.hemi[mt];Et.direction.setFromMatrixPosition(gt.matrixWorld),Et.direction.transformDirection(lt),mt++}}}return{setup:rt,setupView:it,state:$}}function WebGLRenderState(a,s){const o=new WebGLLights(a,s),j=[],$=[];function _e(){j.length=0,$.length=0}function tt(at){j.push(at)}function nt(at){$.push(at)}function rt(at){o.setup(j,at)}function it(at){o.setupView(j,at)}return{init:_e,state:{lightsArray:j,shadowsArray:$,lights:o},setupLights:rt,setupLightsView:it,pushLight:tt,pushShadow:nt}}function WebGLRenderStates(a,s){let o=new WeakMap;function j(_e,tt=0){const nt=o.get(_e);let rt;return nt===void 0?(rt=new WebGLRenderState(a,s),o.set(_e,[rt])):tt>=nt.length?(rt=new WebGLRenderState(a,s),nt.push(rt)):rt=nt[tt],rt}function $(){o=new WeakMap}return{get:j,dispose:$}}class MeshDepthMaterial extends Material{constructor(s){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(s)}copy(s){return super.copy(s),this.depthPacking=s.depthPacking,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(s){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(s)}copy(s){return super.copy(s),this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(a,s,o){let j=new Frustum;const $=new Vector2,_e=new Vector2,tt=new Vector4,nt=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),rt=new MeshDistanceMaterial,it={},st=o.maxTextureSize,at={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},ot=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ct=ot.clone();ct.defines.HORIZONTAL_PASS=1;const ft=new BufferGeometry;ft.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ht=new Mesh(ft,ot),mt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let lt=this.type;this.render=function(Et,St,Tt){if(mt.enabled===!1||mt.autoUpdate===!1&&mt.needsUpdate===!1||Et.length===0)return;const Mt=a.getRenderTarget(),Bt=a.getActiveCubeFace(),Rt=a.getActiveMipmapLevel(),Ut=a.state;Ut.setBlending(NoBlending),Ut.buffers.color.setClear(1,1,1,1),Ut.buffers.depth.setTest(!0),Ut.setScissorTest(!1);const Ht=lt!==VSMShadowMap&&this.type===VSMShadowMap,Wt=lt===VSMShadowMap&&this.type!==VSMShadowMap;for(let Jt=0,sn=Et.length;Jt<sn;Jt++){const jt=Et[Jt],Vt=jt.shadow;if(Vt===void 0){console.warn("THREE.WebGLShadowMap:",jt,"has no shadow.");continue}if(Vt.autoUpdate===!1&&Vt.needsUpdate===!1)continue;$.copy(Vt.mapSize);const Lt=Vt.getFrameExtents();if($.multiply(Lt),_e.copy(Vt.mapSize),($.x>st||$.y>st)&&($.x>st&&(_e.x=Math.floor(st/Lt.x),$.x=_e.x*Lt.x,Vt.mapSize.x=_e.x),$.y>st&&(_e.y=Math.floor(st/Lt.y),$.y=_e.y*Lt.y,Vt.mapSize.y=_e.y)),Vt.map===null||Ht===!0||Wt===!0){const nn=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};Vt.map!==null&&Vt.map.dispose(),Vt.map=new WebGLRenderTarget($.x,$.y,nn),Vt.map.texture.name=jt.name+".shadowMap",Vt.camera.updateProjectionMatrix()}a.setRenderTarget(Vt.map),a.clear();const Qt=Vt.getViewportCount();for(let nn=0;nn<Qt;nn++){const mn=Vt.getViewport(nn);tt.set(_e.x*mn.x,_e.y*mn.y,_e.x*mn.z,_e.y*mn.w),Ut.viewport(tt),Vt.updateMatrices(jt,nn),j=Vt.getFrustum(),gt(St,Tt,Vt.camera,jt,this.type)}Vt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&ut(Vt,Tt),Vt.needsUpdate=!1}lt=this.type,mt.needsUpdate=!1,a.setRenderTarget(Mt,Bt,Rt)};function ut(Et,St){const Tt=s.update(ht);ot.defines.VSM_SAMPLES!==Et.blurSamples&&(ot.defines.VSM_SAMPLES=Et.blurSamples,ct.defines.VSM_SAMPLES=Et.blurSamples,ot.needsUpdate=!0,ct.needsUpdate=!0),Et.mapPass===null&&(Et.mapPass=new WebGLRenderTarget($.x,$.y)),ot.uniforms.shadow_pass.value=Et.map.texture,ot.uniforms.resolution.value=Et.mapSize,ot.uniforms.radius.value=Et.radius,a.setRenderTarget(Et.mapPass),a.clear(),a.renderBufferDirect(St,null,Tt,ot,ht,null),ct.uniforms.shadow_pass.value=Et.mapPass.texture,ct.uniforms.resolution.value=Et.mapSize,ct.uniforms.radius.value=Et.radius,a.setRenderTarget(Et.map),a.clear(),a.renderBufferDirect(St,null,Tt,ct,ht,null)}function dt(Et,St,Tt,Mt){let Bt=null;const Rt=Tt.isPointLight===!0?Et.customDistanceMaterial:Et.customDepthMaterial;if(Rt!==void 0)Bt=Rt;else if(Bt=Tt.isPointLight===!0?rt:nt,a.localClippingEnabled&&St.clipShadows===!0&&Array.isArray(St.clippingPlanes)&&St.clippingPlanes.length!==0||St.displacementMap&&St.displacementScale!==0||St.alphaMap&&St.alphaTest>0||St.map&&St.alphaTest>0){const Ut=Bt.uuid,Ht=St.uuid;let Wt=it[Ut];Wt===void 0&&(Wt={},it[Ut]=Wt);let Jt=Wt[Ht];Jt===void 0&&(Jt=Bt.clone(),Wt[Ht]=Jt),Bt=Jt}if(Bt.visible=St.visible,Bt.wireframe=St.wireframe,Mt===VSMShadowMap?Bt.side=St.shadowSide!==null?St.shadowSide:St.side:Bt.side=St.shadowSide!==null?St.shadowSide:at[St.side],Bt.alphaMap=St.alphaMap,Bt.alphaTest=St.alphaTest,Bt.map=St.map,Bt.clipShadows=St.clipShadows,Bt.clippingPlanes=St.clippingPlanes,Bt.clipIntersection=St.clipIntersection,Bt.displacementMap=St.displacementMap,Bt.displacementScale=St.displacementScale,Bt.displacementBias=St.displacementBias,Bt.wireframeLinewidth=St.wireframeLinewidth,Bt.linewidth=St.linewidth,Tt.isPointLight===!0&&Bt.isMeshDistanceMaterial===!0){const Ut=a.properties.get(Bt);Ut.light=Tt}return Bt}function gt(Et,St,Tt,Mt,Bt){if(Et.visible===!1)return;if(Et.layers.test(St.layers)&&(Et.isMesh||Et.isLine||Et.isPoints)&&(Et.castShadow||Et.receiveShadow&&Bt===VSMShadowMap)&&(!Et.frustumCulled||j.intersectsObject(Et))){Et.modelViewMatrix.multiplyMatrices(Tt.matrixWorldInverse,Et.matrixWorld);const Ht=s.update(Et),Wt=Et.material;if(Array.isArray(Wt)){const Jt=Ht.groups;for(let sn=0,jt=Jt.length;sn<jt;sn++){const Vt=Jt[sn],Lt=Wt[Vt.materialIndex];if(Lt&&Lt.visible){const Qt=dt(Et,Lt,Mt,Bt);a.renderBufferDirect(Tt,null,Ht,Qt,Et,Vt)}}}else if(Wt.visible){const Jt=dt(Et,Wt,Mt,Bt);a.renderBufferDirect(Tt,null,Ht,Jt,Et,null)}}const Ut=Et.children;for(let Ht=0,Wt=Ut.length;Ht<Wt;Ht++)gt(Ut[Ht],St,Tt,Mt,Bt)}}function WebGLState(a,s,o){const j=o.isWebGL2;function $(){let Gn=!1;const Zn=new Vector4;let qn=null;const vr=new Vector4(0,0,0,0);return{setMask:function(_r){qn!==_r&&!Gn&&(a.colorMask(_r,_r,_r,_r),qn=_r)},setLocked:function(_r){Gn=_r},setClear:function(_r,$r,es,Hr,Ur){Ur===!0&&(_r*=Hr,$r*=Hr,es*=Hr),Zn.set(_r,$r,es,Hr),vr.equals(Zn)===!1&&(a.clearColor(_r,$r,es,Hr),vr.copy(Zn))},reset:function(){Gn=!1,qn=null,vr.set(-1,0,0,0)}}}function _e(){let Gn=!1,Zn=null,qn=null,vr=null;return{setTest:function(_r){_r?hn(a.DEPTH_TEST):Tn(a.DEPTH_TEST)},setMask:function(_r){Zn!==_r&&!Gn&&(a.depthMask(_r),Zn=_r)},setFunc:function(_r){if(qn!==_r){switch(_r){case NeverDepth:a.depthFunc(a.NEVER);break;case AlwaysDepth:a.depthFunc(a.ALWAYS);break;case LessDepth:a.depthFunc(a.LESS);break;case LessEqualDepth:a.depthFunc(a.LEQUAL);break;case EqualDepth:a.depthFunc(a.EQUAL);break;case GreaterEqualDepth:a.depthFunc(a.GEQUAL);break;case GreaterDepth:a.depthFunc(a.GREATER);break;case NotEqualDepth:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}qn=_r}},setLocked:function(_r){Gn=_r},setClear:function(_r){vr!==_r&&(a.clearDepth(_r),vr=_r)},reset:function(){Gn=!1,Zn=null,qn=null,vr=null}}}function tt(){let Gn=!1,Zn=null,qn=null,vr=null,_r=null,$r=null,es=null,Hr=null,Ur=null;return{setTest:function(Ir){Gn||(Ir?hn(a.STENCIL_TEST):Tn(a.STENCIL_TEST))},setMask:function(Ir){Zn!==Ir&&!Gn&&(a.stencilMask(Ir),Zn=Ir)},setFunc:function(Ir,Fr,Pr){(qn!==Ir||vr!==Fr||_r!==Pr)&&(a.stencilFunc(Ir,Fr,Pr),qn=Ir,vr=Fr,_r=Pr)},setOp:function(Ir,Fr,Pr){($r!==Ir||es!==Fr||Hr!==Pr)&&(a.stencilOp(Ir,Fr,Pr),$r=Ir,es=Fr,Hr=Pr)},setLocked:function(Ir){Gn=Ir},setClear:function(Ir){Ur!==Ir&&(a.clearStencil(Ir),Ur=Ir)},reset:function(){Gn=!1,Zn=null,qn=null,vr=null,_r=null,$r=null,es=null,Hr=null,Ur=null}}}const nt=new $,rt=new _e,it=new tt,st=new WeakMap,at=new WeakMap;let ot={},ct={},ft=new WeakMap,ht=[],mt=null,lt=!1,ut=null,dt=null,gt=null,Et=null,St=null,Tt=null,Mt=null,Bt=!1,Rt=null,Ut=null,Ht=null,Wt=null,Jt=null;const sn=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let jt=!1,Vt=0;const Lt=a.getParameter(a.VERSION);Lt.indexOf("WebGL")!==-1?(Vt=parseFloat(/^WebGL (\d)/.exec(Lt)[1]),jt=Vt>=1):Lt.indexOf("OpenGL ES")!==-1&&(Vt=parseFloat(/^OpenGL ES (\d)/.exec(Lt)[1]),jt=Vt>=2);let Qt=null,nn={};const mn=a.getParameter(a.SCISSOR_BOX),Zt=a.getParameter(a.VIEWPORT),cn=new Vector4().fromArray(mn),Ot=new Vector4().fromArray(Zt);function rn(Gn,Zn,qn,vr){const _r=new Uint8Array(4),$r=a.createTexture();a.bindTexture(Gn,$r),a.texParameteri(Gn,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(Gn,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let es=0;es<qn;es++)j&&(Gn===a.TEXTURE_3D||Gn===a.TEXTURE_2D_ARRAY)?a.texImage3D(Zn,0,a.RGBA,1,1,vr,0,a.RGBA,a.UNSIGNED_BYTE,_r):a.texImage2D(Zn+es,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,_r);return $r}const fn={};fn[a.TEXTURE_2D]=rn(a.TEXTURE_2D,a.TEXTURE_2D,1),fn[a.TEXTURE_CUBE_MAP]=rn(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6),j&&(fn[a.TEXTURE_2D_ARRAY]=rn(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),fn[a.TEXTURE_3D]=rn(a.TEXTURE_3D,a.TEXTURE_3D,1,1)),nt.setClear(0,0,0,1),rt.setClear(1),it.setClear(0),hn(a.DEPTH_TEST),rt.setFunc(LessEqualDepth),Sn(!1),xn(CullFaceBack),hn(a.CULL_FACE),bn(NoBlending);function hn(Gn){ot[Gn]!==!0&&(a.enable(Gn),ot[Gn]=!0)}function Tn(Gn){ot[Gn]!==!1&&(a.disable(Gn),ot[Gn]=!1)}function Nn(Gn,Zn){return ct[Gn]!==Zn?(a.bindFramebuffer(Gn,Zn),ct[Gn]=Zn,j&&(Gn===a.DRAW_FRAMEBUFFER&&(ct[a.FRAMEBUFFER]=Zn),Gn===a.FRAMEBUFFER&&(ct[a.DRAW_FRAMEBUFFER]=Zn)),!0):!1}function Pn(Gn,Zn){let qn=ht,vr=!1;if(Gn)if(qn=ft.get(Zn),qn===void 0&&(qn=[],ft.set(Zn,qn)),Gn.isWebGLMultipleRenderTargets){const _r=Gn.texture;if(qn.length!==_r.length||qn[0]!==a.COLOR_ATTACHMENT0){for(let $r=0,es=_r.length;$r<es;$r++)qn[$r]=a.COLOR_ATTACHMENT0+$r;qn.length=_r.length,vr=!0}}else qn[0]!==a.COLOR_ATTACHMENT0&&(qn[0]=a.COLOR_ATTACHMENT0,vr=!0);else qn[0]!==a.BACK&&(qn[0]=a.BACK,vr=!0);vr&&(o.isWebGL2?a.drawBuffers(qn):s.get("WEBGL_draw_buffers").drawBuffersWEBGL(qn))}function Dn(Gn){return mt!==Gn?(a.useProgram(Gn),mt=Gn,!0):!1}const ln={[AddEquation]:a.FUNC_ADD,[SubtractEquation]:a.FUNC_SUBTRACT,[ReverseSubtractEquation]:a.FUNC_REVERSE_SUBTRACT};if(j)ln[MinEquation]=a.MIN,ln[MaxEquation]=a.MAX;else{const Gn=s.get("EXT_blend_minmax");Gn!==null&&(ln[MinEquation]=Gn.MIN_EXT,ln[MaxEquation]=Gn.MAX_EXT)}const Cn={[ZeroFactor]:a.ZERO,[OneFactor]:a.ONE,[SrcColorFactor]:a.SRC_COLOR,[SrcAlphaFactor]:a.SRC_ALPHA,[SrcAlphaSaturateFactor]:a.SRC_ALPHA_SATURATE,[DstColorFactor]:a.DST_COLOR,[DstAlphaFactor]:a.DST_ALPHA,[OneMinusSrcColorFactor]:a.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:a.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:a.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:a.ONE_MINUS_DST_ALPHA};function bn(Gn,Zn,qn,vr,_r,$r,es,Hr){if(Gn===NoBlending){lt===!0&&(Tn(a.BLEND),lt=!1);return}if(lt===!1&&(hn(a.BLEND),lt=!0),Gn!==CustomBlending){if(Gn!==ut||Hr!==Bt){if((dt!==AddEquation||St!==AddEquation)&&(a.blendEquation(a.FUNC_ADD),dt=AddEquation,St=AddEquation),Hr)switch(Gn){case NormalBlending:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:a.blendFunc(a.ONE,a.ONE);break;case SubtractiveBlending:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case MultiplyBlending:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Gn);break}else switch(Gn){case NormalBlending:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case SubtractiveBlending:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case MultiplyBlending:a.blendFunc(a.ZERO,a.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Gn);break}gt=null,Et=null,Tt=null,Mt=null,ut=Gn,Bt=Hr}return}_r=_r||Zn,$r=$r||qn,es=es||vr,(Zn!==dt||_r!==St)&&(a.blendEquationSeparate(ln[Zn],ln[_r]),dt=Zn,St=_r),(qn!==gt||vr!==Et||$r!==Tt||es!==Mt)&&(a.blendFuncSeparate(Cn[qn],Cn[vr],Cn[$r],Cn[es]),gt=qn,Et=vr,Tt=$r,Mt=es),ut=Gn,Bt=!1}function kn(Gn,Zn){Gn.side===DoubleSide?Tn(a.CULL_FACE):hn(a.CULL_FACE);let qn=Gn.side===BackSide;Zn&&(qn=!qn),Sn(qn),Gn.blending===NormalBlending&&Gn.transparent===!1?bn(NoBlending):bn(Gn.blending,Gn.blendEquation,Gn.blendSrc,Gn.blendDst,Gn.blendEquationAlpha,Gn.blendSrcAlpha,Gn.blendDstAlpha,Gn.premultipliedAlpha),rt.setFunc(Gn.depthFunc),rt.setTest(Gn.depthTest),rt.setMask(Gn.depthWrite),nt.setMask(Gn.colorWrite);const vr=Gn.stencilWrite;it.setTest(vr),vr&&(it.setMask(Gn.stencilWriteMask),it.setFunc(Gn.stencilFunc,Gn.stencilRef,Gn.stencilFuncMask),it.setOp(Gn.stencilFail,Gn.stencilZFail,Gn.stencilZPass)),nr(Gn.polygonOffset,Gn.polygonOffsetFactor,Gn.polygonOffsetUnits),Gn.alphaToCoverage===!0?hn(a.SAMPLE_ALPHA_TO_COVERAGE):Tn(a.SAMPLE_ALPHA_TO_COVERAGE)}function Sn(Gn){Rt!==Gn&&(Gn?a.frontFace(a.CW):a.frontFace(a.CCW),Rt=Gn)}function xn(Gn){Gn!==CullFaceNone?(hn(a.CULL_FACE),Gn!==Ut&&(Gn===CullFaceBack?a.cullFace(a.BACK):Gn===CullFaceFront?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):Tn(a.CULL_FACE),Ut=Gn}function Qn(Gn){Gn!==Ht&&(jt&&a.lineWidth(Gn),Ht=Gn)}function nr(Gn,Zn,qn){Gn?(hn(a.POLYGON_OFFSET_FILL),(Wt!==Zn||Jt!==qn)&&(a.polygonOffset(Zn,qn),Wt=Zn,Jt=qn)):Tn(a.POLYGON_OFFSET_FILL)}function or(Gn){Gn?hn(a.SCISSOR_TEST):Tn(a.SCISSOR_TEST)}function mr(Gn){Gn===void 0&&(Gn=a.TEXTURE0+sn-1),Qt!==Gn&&(a.activeTexture(Gn),Qt=Gn)}function $n(Gn,Zn,qn){qn===void 0&&(Qt===null?qn=a.TEXTURE0+sn-1:qn=Qt);let vr=nn[qn];vr===void 0&&(vr={type:void 0,texture:void 0},nn[qn]=vr),(vr.type!==Gn||vr.texture!==Zn)&&(Qt!==qn&&(a.activeTexture(qn),Qt=qn),a.bindTexture(Gn,Zn||fn[Gn]),vr.type=Gn,vr.texture=Zn)}function tn(){const Gn=nn[Qt];Gn!==void 0&&Gn.type!==void 0&&(a.bindTexture(Gn.type,null),Gn.type=void 0,Gn.texture=void 0)}function $t(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function An(){try{a.compressedTexImage3D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function En(){try{a.texSubImage2D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function In(){try{a.texSubImage3D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function Hn(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function yn(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function On(){try{a.texStorage2D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function Mn(){try{a.texStorage3D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function tr(){try{a.texImage2D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function gr(){try{a.texImage3D.apply(a,arguments)}catch(Gn){console.error("THREE.WebGLState:",Gn)}}function Cr(Gn){cn.equals(Gn)===!1&&(a.scissor(Gn.x,Gn.y,Gn.z,Gn.w),cn.copy(Gn))}function Sr(Gn){Ot.equals(Gn)===!1&&(a.viewport(Gn.x,Gn.y,Gn.z,Gn.w),Ot.copy(Gn))}function Un(Gn,Zn){let qn=at.get(Zn);qn===void 0&&(qn=new WeakMap,at.set(Zn,qn));let vr=qn.get(Gn);vr===void 0&&(vr=a.getUniformBlockIndex(Zn,Gn.name),qn.set(Gn,vr))}function Jn(Gn,Zn){const vr=at.get(Zn).get(Gn);st.get(Zn)!==vr&&(a.uniformBlockBinding(Zn,vr,Gn.__bindingPointIndex),st.set(Zn,vr))}function pr(){a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SCISSOR_TEST),a.disable(a.STENCIL_TEST),a.disable(a.SAMPLE_ALPHA_TO_COVERAGE),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(a.LESS),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(a.ALWAYS,0,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.clearStencil(0),a.cullFace(a.BACK),a.frontFace(a.CCW),a.polygonOffset(0,0),a.activeTexture(a.TEXTURE0),a.bindFramebuffer(a.FRAMEBUFFER,null),j===!0&&(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),ot={},Qt=null,nn={},ct={},ft=new WeakMap,ht=[],mt=null,lt=!1,ut=null,dt=null,gt=null,Et=null,St=null,Tt=null,Mt=null,Bt=!1,Rt=null,Ut=null,Ht=null,Wt=null,Jt=null,cn.set(0,0,a.canvas.width,a.canvas.height),Ot.set(0,0,a.canvas.width,a.canvas.height),nt.reset(),rt.reset(),it.reset()}return{buffers:{color:nt,depth:rt,stencil:it},enable:hn,disable:Tn,bindFramebuffer:Nn,drawBuffers:Pn,useProgram:Dn,setBlending:bn,setMaterial:kn,setFlipSided:Sn,setCullFace:xn,setLineWidth:Qn,setPolygonOffset:nr,setScissorTest:or,activeTexture:mr,bindTexture:$n,unbindTexture:tn,compressedTexImage2D:$t,compressedTexImage3D:An,texImage2D:tr,texImage3D:gr,updateUBOMapping:Un,uniformBlockBinding:Jn,texStorage2D:On,texStorage3D:Mn,texSubImage2D:En,texSubImage3D:In,compressedTexSubImage2D:Hn,compressedTexSubImage3D:yn,scissor:Cr,viewport:Sr,reset:pr}}function WebGLTextures(a,s,o,j,$,_e,tt){const nt=$.isWebGL2,rt=$.maxTextures,it=$.maxCubemapSize,st=$.maxTextureSize,at=$.maxSamples,ot=s.has("WEBGL_multisampled_render_to_texture")?s.get("WEBGL_multisampled_render_to_texture"):null,ct=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ft=new WeakMap;let ht;const mt=new WeakMap;let lt=!1;try{lt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ut(tn,$t){return lt?new OffscreenCanvas(tn,$t):createElementNS("canvas")}function dt(tn,$t,An,En){let In=1;if((tn.width>En||tn.height>En)&&(In=En/Math.max(tn.width,tn.height)),In<1||$t===!0)if(typeof HTMLImageElement<"u"&&tn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tn instanceof ImageBitmap){const Hn=$t?floorPowerOfTwo:Math.floor,yn=Hn(In*tn.width),On=Hn(In*tn.height);ht===void 0&&(ht=ut(yn,On));const Mn=An?ut(yn,On):ht;return Mn.width=yn,Mn.height=On,Mn.getContext("2d").drawImage(tn,0,0,yn,On),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+tn.width+"x"+tn.height+") to ("+yn+"x"+On+")."),Mn}else return"data"in tn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+tn.width+"x"+tn.height+")."),tn;return tn}function gt(tn){return isPowerOfTwo(tn.width)&&isPowerOfTwo(tn.height)}function Et(tn){return nt?!1:tn.wrapS!==ClampToEdgeWrapping||tn.wrapT!==ClampToEdgeWrapping||tn.minFilter!==NearestFilter&&tn.minFilter!==LinearFilter}function St(tn,$t){return tn.generateMipmaps&&$t&&tn.minFilter!==NearestFilter&&tn.minFilter!==LinearFilter}function Tt(tn){a.generateMipmap(tn)}function Mt(tn,$t,An,En,In=!1){if(nt===!1)return $t;if(tn!==null){if(a[tn]!==void 0)return a[tn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+tn+"'")}let Hn=$t;return $t===a.RED&&(An===a.FLOAT&&(Hn=a.R32F),An===a.HALF_FLOAT&&(Hn=a.R16F),An===a.UNSIGNED_BYTE&&(Hn=a.R8)),$t===a.RG&&(An===a.FLOAT&&(Hn=a.RG32F),An===a.HALF_FLOAT&&(Hn=a.RG16F),An===a.UNSIGNED_BYTE&&(Hn=a.RG8)),$t===a.RGBA&&(An===a.FLOAT&&(Hn=a.RGBA32F),An===a.HALF_FLOAT&&(Hn=a.RGBA16F),An===a.UNSIGNED_BYTE&&(Hn=En===SRGBColorSpace&&In===!1?a.SRGB8_ALPHA8:a.RGBA8),An===a.UNSIGNED_SHORT_4_4_4_4&&(Hn=a.RGBA4),An===a.UNSIGNED_SHORT_5_5_5_1&&(Hn=a.RGB5_A1)),(Hn===a.R16F||Hn===a.R32F||Hn===a.RG16F||Hn===a.RG32F||Hn===a.RGBA16F||Hn===a.RGBA32F)&&s.get("EXT_color_buffer_float"),Hn}function Bt(tn,$t,An){return St(tn,An)===!0||tn.isFramebufferTexture&&tn.minFilter!==NearestFilter&&tn.minFilter!==LinearFilter?Math.log2(Math.max($t.width,$t.height))+1:tn.mipmaps!==void 0&&tn.mipmaps.length>0?tn.mipmaps.length:tn.isCompressedTexture&&Array.isArray(tn.image)?$t.mipmaps.length:1}function Rt(tn){return tn===NearestFilter||tn===NearestMipmapNearestFilter||tn===NearestMipmapLinearFilter?a.NEAREST:a.LINEAR}function Ut(tn){const $t=tn.target;$t.removeEventListener("dispose",Ut),Wt($t),$t.isVideoTexture&&ft.delete($t)}function Ht(tn){const $t=tn.target;$t.removeEventListener("dispose",Ht),sn($t)}function Wt(tn){const $t=j.get(tn);if($t.__webglInit===void 0)return;const An=tn.source,En=mt.get(An);if(En){const In=En[$t.__cacheKey];In.usedTimes--,In.usedTimes===0&&Jt(tn),Object.keys(En).length===0&&mt.delete(An)}j.remove(tn)}function Jt(tn){const $t=j.get(tn);a.deleteTexture($t.__webglTexture);const An=tn.source,En=mt.get(An);delete En[$t.__cacheKey],tt.memory.textures--}function sn(tn){const $t=tn.texture,An=j.get(tn),En=j.get($t);if(En.__webglTexture!==void 0&&(a.deleteTexture(En.__webglTexture),tt.memory.textures--),tn.depthTexture&&tn.depthTexture.dispose(),tn.isWebGLCubeRenderTarget)for(let In=0;In<6;In++)a.deleteFramebuffer(An.__webglFramebuffer[In]),An.__webglDepthbuffer&&a.deleteRenderbuffer(An.__webglDepthbuffer[In]);else{if(a.deleteFramebuffer(An.__webglFramebuffer),An.__webglDepthbuffer&&a.deleteRenderbuffer(An.__webglDepthbuffer),An.__webglMultisampledFramebuffer&&a.deleteFramebuffer(An.__webglMultisampledFramebuffer),An.__webglColorRenderbuffer)for(let In=0;In<An.__webglColorRenderbuffer.length;In++)An.__webglColorRenderbuffer[In]&&a.deleteRenderbuffer(An.__webglColorRenderbuffer[In]);An.__webglDepthRenderbuffer&&a.deleteRenderbuffer(An.__webglDepthRenderbuffer)}if(tn.isWebGLMultipleRenderTargets)for(let In=0,Hn=$t.length;In<Hn;In++){const yn=j.get($t[In]);yn.__webglTexture&&(a.deleteTexture(yn.__webglTexture),tt.memory.textures--),j.remove($t[In])}j.remove($t),j.remove(tn)}let jt=0;function Vt(){jt=0}function Lt(){const tn=jt;return tn>=rt&&console.warn("THREE.WebGLTextures: Trying to use "+tn+" texture units while this GPU supports only "+rt),jt+=1,tn}function Qt(tn){const $t=[];return $t.push(tn.wrapS),$t.push(tn.wrapT),$t.push(tn.wrapR||0),$t.push(tn.magFilter),$t.push(tn.minFilter),$t.push(tn.anisotropy),$t.push(tn.internalFormat),$t.push(tn.format),$t.push(tn.type),$t.push(tn.generateMipmaps),$t.push(tn.premultiplyAlpha),$t.push(tn.flipY),$t.push(tn.unpackAlignment),$t.push(tn.colorSpace),$t.join()}function nn(tn,$t){const An=j.get(tn);if(tn.isVideoTexture&&mr(tn),tn.isRenderTargetTexture===!1&&tn.version>0&&An.__version!==tn.version){const En=tn.image;if(En===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(En.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Nn(An,tn,$t);return}}o.bindTexture(a.TEXTURE_2D,An.__webglTexture,a.TEXTURE0+$t)}function mn(tn,$t){const An=j.get(tn);if(tn.version>0&&An.__version!==tn.version){Nn(An,tn,$t);return}o.bindTexture(a.TEXTURE_2D_ARRAY,An.__webglTexture,a.TEXTURE0+$t)}function Zt(tn,$t){const An=j.get(tn);if(tn.version>0&&An.__version!==tn.version){Nn(An,tn,$t);return}o.bindTexture(a.TEXTURE_3D,An.__webglTexture,a.TEXTURE0+$t)}function cn(tn,$t){const An=j.get(tn);if(tn.version>0&&An.__version!==tn.version){Pn(An,tn,$t);return}o.bindTexture(a.TEXTURE_CUBE_MAP,An.__webglTexture,a.TEXTURE0+$t)}const Ot={[RepeatWrapping]:a.REPEAT,[ClampToEdgeWrapping]:a.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:a.MIRRORED_REPEAT},rn={[NearestFilter]:a.NEAREST,[NearestMipmapNearestFilter]:a.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:a.NEAREST_MIPMAP_LINEAR,[LinearFilter]:a.LINEAR,[LinearMipmapNearestFilter]:a.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:a.LINEAR_MIPMAP_LINEAR},fn={[NeverCompare]:a.NEVER,[AlwaysCompare]:a.ALWAYS,[LessCompare]:a.LESS,[LessEqualCompare]:a.LEQUAL,[EqualCompare]:a.EQUAL,[GreaterEqualCompare]:a.GEQUAL,[GreaterCompare]:a.GREATER,[NotEqualCompare]:a.NOTEQUAL};function hn(tn,$t,An){if(An?(a.texParameteri(tn,a.TEXTURE_WRAP_S,Ot[$t.wrapS]),a.texParameteri(tn,a.TEXTURE_WRAP_T,Ot[$t.wrapT]),(tn===a.TEXTURE_3D||tn===a.TEXTURE_2D_ARRAY)&&a.texParameteri(tn,a.TEXTURE_WRAP_R,Ot[$t.wrapR]),a.texParameteri(tn,a.TEXTURE_MAG_FILTER,rn[$t.magFilter]),a.texParameteri(tn,a.TEXTURE_MIN_FILTER,rn[$t.minFilter])):(a.texParameteri(tn,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(tn,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),(tn===a.TEXTURE_3D||tn===a.TEXTURE_2D_ARRAY)&&a.texParameteri(tn,a.TEXTURE_WRAP_R,a.CLAMP_TO_EDGE),($t.wrapS!==ClampToEdgeWrapping||$t.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(tn,a.TEXTURE_MAG_FILTER,Rt($t.magFilter)),a.texParameteri(tn,a.TEXTURE_MIN_FILTER,Rt($t.minFilter)),$t.minFilter!==NearestFilter&&$t.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),$t.compareFunction&&(a.texParameteri(tn,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(tn,a.TEXTURE_COMPARE_FUNC,fn[$t.compareFunction])),s.has("EXT_texture_filter_anisotropic")===!0){const En=s.get("EXT_texture_filter_anisotropic");if($t.magFilter===NearestFilter||$t.minFilter!==NearestMipmapLinearFilter&&$t.minFilter!==LinearMipmapLinearFilter||$t.type===FloatType&&s.has("OES_texture_float_linear")===!1||nt===!1&&$t.type===HalfFloatType&&s.has("OES_texture_half_float_linear")===!1)return;($t.anisotropy>1||j.get($t).__currentAnisotropy)&&(a.texParameterf(tn,En.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($t.anisotropy,$.getMaxAnisotropy())),j.get($t).__currentAnisotropy=$t.anisotropy)}}function Tn(tn,$t){let An=!1;tn.__webglInit===void 0&&(tn.__webglInit=!0,$t.addEventListener("dispose",Ut));const En=$t.source;let In=mt.get(En);In===void 0&&(In={},mt.set(En,In));const Hn=Qt($t);if(Hn!==tn.__cacheKey){In[Hn]===void 0&&(In[Hn]={texture:a.createTexture(),usedTimes:0},tt.memory.textures++,An=!0),In[Hn].usedTimes++;const yn=In[tn.__cacheKey];yn!==void 0&&(In[tn.__cacheKey].usedTimes--,yn.usedTimes===0&&Jt($t)),tn.__cacheKey=Hn,tn.__webglTexture=In[Hn].texture}return An}function Nn(tn,$t,An){let En=a.TEXTURE_2D;($t.isDataArrayTexture||$t.isCompressedArrayTexture)&&(En=a.TEXTURE_2D_ARRAY),$t.isData3DTexture&&(En=a.TEXTURE_3D);const In=Tn(tn,$t),Hn=$t.source;o.bindTexture(En,tn.__webglTexture,a.TEXTURE0+An);const yn=j.get(Hn);if(Hn.version!==yn.__version||In===!0){o.activeTexture(a.TEXTURE0+An),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,$t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,$t.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const On=Et($t)&&gt($t.image)===!1;let Mn=dt($t.image,On,!1,st);Mn=$n($t,Mn);const tr=gt(Mn)||nt,gr=_e.convert($t.format,$t.colorSpace);let Cr=_e.convert($t.type),Sr=Mt($t.internalFormat,gr,Cr,$t.colorSpace);hn(En,$t,tr);let Un;const Jn=$t.mipmaps,pr=nt&&$t.isVideoTexture!==!0,Gn=yn.__version===void 0||In===!0,Zn=Bt($t,Mn,tr);if($t.isDepthTexture)Sr=a.DEPTH_COMPONENT,nt?$t.type===FloatType?Sr=a.DEPTH_COMPONENT32F:$t.type===UnsignedIntType?Sr=a.DEPTH_COMPONENT24:$t.type===UnsignedInt248Type?Sr=a.DEPTH24_STENCIL8:Sr=a.DEPTH_COMPONENT16:$t.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),$t.format===DepthFormat&&Sr===a.DEPTH_COMPONENT&&$t.type!==UnsignedShortType&&$t.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),$t.type=UnsignedIntType,Cr=_e.convert($t.type)),$t.format===DepthStencilFormat&&Sr===a.DEPTH_COMPONENT&&(Sr=a.DEPTH_STENCIL,$t.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),$t.type=UnsignedInt248Type,Cr=_e.convert($t.type))),Gn&&(pr?o.texStorage2D(a.TEXTURE_2D,1,Sr,Mn.width,Mn.height):o.texImage2D(a.TEXTURE_2D,0,Sr,Mn.width,Mn.height,0,gr,Cr,null));else if($t.isDataTexture)if(Jn.length>0&&tr){pr&&Gn&&o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Jn[0].width,Jn[0].height);for(let qn=0,vr=Jn.length;qn<vr;qn++)Un=Jn[qn],pr?o.texSubImage2D(a.TEXTURE_2D,qn,0,0,Un.width,Un.height,gr,Cr,Un.data):o.texImage2D(a.TEXTURE_2D,qn,Sr,Un.width,Un.height,0,gr,Cr,Un.data);$t.generateMipmaps=!1}else pr?(Gn&&o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Mn.width,Mn.height),o.texSubImage2D(a.TEXTURE_2D,0,0,0,Mn.width,Mn.height,gr,Cr,Mn.data)):o.texImage2D(a.TEXTURE_2D,0,Sr,Mn.width,Mn.height,0,gr,Cr,Mn.data);else if($t.isCompressedTexture)if($t.isCompressedArrayTexture){pr&&Gn&&o.texStorage3D(a.TEXTURE_2D_ARRAY,Zn,Sr,Jn[0].width,Jn[0].height,Mn.depth);for(let qn=0,vr=Jn.length;qn<vr;qn++)Un=Jn[qn],$t.format!==RGBAFormat?gr!==null?pr?o.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,qn,0,0,0,Un.width,Un.height,Mn.depth,gr,Un.data,0,0):o.compressedTexImage3D(a.TEXTURE_2D_ARRAY,qn,Sr,Un.width,Un.height,Mn.depth,0,Un.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pr?o.texSubImage3D(a.TEXTURE_2D_ARRAY,qn,0,0,0,Un.width,Un.height,Mn.depth,gr,Cr,Un.data):o.texImage3D(a.TEXTURE_2D_ARRAY,qn,Sr,Un.width,Un.height,Mn.depth,0,gr,Cr,Un.data)}else{pr&&Gn&&o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Jn[0].width,Jn[0].height);for(let qn=0,vr=Jn.length;qn<vr;qn++)Un=Jn[qn],$t.format!==RGBAFormat?gr!==null?pr?o.compressedTexSubImage2D(a.TEXTURE_2D,qn,0,0,Un.width,Un.height,gr,Un.data):o.compressedTexImage2D(a.TEXTURE_2D,qn,Sr,Un.width,Un.height,0,Un.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pr?o.texSubImage2D(a.TEXTURE_2D,qn,0,0,Un.width,Un.height,gr,Cr,Un.data):o.texImage2D(a.TEXTURE_2D,qn,Sr,Un.width,Un.height,0,gr,Cr,Un.data)}else if($t.isDataArrayTexture)pr?(Gn&&o.texStorage3D(a.TEXTURE_2D_ARRAY,Zn,Sr,Mn.width,Mn.height,Mn.depth),o.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,Mn.width,Mn.height,Mn.depth,gr,Cr,Mn.data)):o.texImage3D(a.TEXTURE_2D_ARRAY,0,Sr,Mn.width,Mn.height,Mn.depth,0,gr,Cr,Mn.data);else if($t.isData3DTexture)pr?(Gn&&o.texStorage3D(a.TEXTURE_3D,Zn,Sr,Mn.width,Mn.height,Mn.depth),o.texSubImage3D(a.TEXTURE_3D,0,0,0,0,Mn.width,Mn.height,Mn.depth,gr,Cr,Mn.data)):o.texImage3D(a.TEXTURE_3D,0,Sr,Mn.width,Mn.height,Mn.depth,0,gr,Cr,Mn.data);else if($t.isFramebufferTexture){if(Gn)if(pr)o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Mn.width,Mn.height);else{let qn=Mn.width,vr=Mn.height;for(let _r=0;_r<Zn;_r++)o.texImage2D(a.TEXTURE_2D,_r,Sr,qn,vr,0,gr,Cr,null),qn>>=1,vr>>=1}}else if(Jn.length>0&&tr){pr&&Gn&&o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Jn[0].width,Jn[0].height);for(let qn=0,vr=Jn.length;qn<vr;qn++)Un=Jn[qn],pr?o.texSubImage2D(a.TEXTURE_2D,qn,0,0,gr,Cr,Un):o.texImage2D(a.TEXTURE_2D,qn,Sr,gr,Cr,Un);$t.generateMipmaps=!1}else pr?(Gn&&o.texStorage2D(a.TEXTURE_2D,Zn,Sr,Mn.width,Mn.height),o.texSubImage2D(a.TEXTURE_2D,0,0,0,gr,Cr,Mn)):o.texImage2D(a.TEXTURE_2D,0,Sr,gr,Cr,Mn);St($t,tr)&&Tt(En),yn.__version=Hn.version,$t.onUpdate&&$t.onUpdate($t)}tn.__version=$t.version}function Pn(tn,$t,An){if($t.image.length!==6)return;const En=Tn(tn,$t),In=$t.source;o.bindTexture(a.TEXTURE_CUBE_MAP,tn.__webglTexture,a.TEXTURE0+An);const Hn=j.get(In);if(In.version!==Hn.__version||En===!0){o.activeTexture(a.TEXTURE0+An),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,$t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,$t.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE);const yn=$t.isCompressedTexture||$t.image[0].isCompressedTexture,On=$t.image[0]&&$t.image[0].isDataTexture,Mn=[];for(let qn=0;qn<6;qn++)!yn&&!On?Mn[qn]=dt($t.image[qn],!1,!0,it):Mn[qn]=On?$t.image[qn].image:$t.image[qn],Mn[qn]=$n($t,Mn[qn]);const tr=Mn[0],gr=gt(tr)||nt,Cr=_e.convert($t.format,$t.colorSpace),Sr=_e.convert($t.type),Un=Mt($t.internalFormat,Cr,Sr,$t.colorSpace),Jn=nt&&$t.isVideoTexture!==!0,pr=Hn.__version===void 0||En===!0;let Gn=Bt($t,tr,gr);hn(a.TEXTURE_CUBE_MAP,$t,gr);let Zn;if(yn){Jn&&pr&&o.texStorage2D(a.TEXTURE_CUBE_MAP,Gn,Un,tr.width,tr.height);for(let qn=0;qn<6;qn++){Zn=Mn[qn].mipmaps;for(let vr=0;vr<Zn.length;vr++){const _r=Zn[vr];$t.format!==RGBAFormat?Cr!==null?Jn?o.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr,0,0,_r.width,_r.height,Cr,_r.data):o.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr,Un,_r.width,_r.height,0,_r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Jn?o.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr,0,0,_r.width,_r.height,Cr,Sr,_r.data):o.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr,Un,_r.width,_r.height,0,Cr,Sr,_r.data)}}}else{Zn=$t.mipmaps,Jn&&pr&&(Zn.length>0&&Gn++,o.texStorage2D(a.TEXTURE_CUBE_MAP,Gn,Un,Mn[0].width,Mn[0].height));for(let qn=0;qn<6;qn++)if(On){Jn?o.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,0,0,0,Mn[qn].width,Mn[qn].height,Cr,Sr,Mn[qn].data):o.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,0,Un,Mn[qn].width,Mn[qn].height,0,Cr,Sr,Mn[qn].data);for(let vr=0;vr<Zn.length;vr++){const $r=Zn[vr].image[qn].image;Jn?o.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr+1,0,0,$r.width,$r.height,Cr,Sr,$r.data):o.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr+1,Un,$r.width,$r.height,0,Cr,Sr,$r.data)}}else{Jn?o.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,0,0,0,Cr,Sr,Mn[qn]):o.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,0,Un,Cr,Sr,Mn[qn]);for(let vr=0;vr<Zn.length;vr++){const _r=Zn[vr];Jn?o.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr+1,0,0,Cr,Sr,_r.image[qn]):o.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+qn,vr+1,Un,Cr,Sr,_r.image[qn])}}}St($t,gr)&&Tt(a.TEXTURE_CUBE_MAP),Hn.__version=In.version,$t.onUpdate&&$t.onUpdate($t)}tn.__version=$t.version}function Dn(tn,$t,An,En,In){const Hn=_e.convert(An.format,An.colorSpace),yn=_e.convert(An.type),On=Mt(An.internalFormat,Hn,yn,An.colorSpace);j.get($t).__hasExternalTextures||(In===a.TEXTURE_3D||In===a.TEXTURE_2D_ARRAY?o.texImage3D(In,0,On,$t.width,$t.height,$t.depth,0,Hn,yn,null):o.texImage2D(In,0,On,$t.width,$t.height,0,Hn,yn,null)),o.bindFramebuffer(a.FRAMEBUFFER,tn),or($t)?ot.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,En,In,j.get(An).__webglTexture,0,nr($t)):(In===a.TEXTURE_2D||In>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&In<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,En,In,j.get(An).__webglTexture,0),o.bindFramebuffer(a.FRAMEBUFFER,null)}function ln(tn,$t,An){if(a.bindRenderbuffer(a.RENDERBUFFER,tn),$t.depthBuffer&&!$t.stencilBuffer){let En=a.DEPTH_COMPONENT16;if(An||or($t)){const In=$t.depthTexture;In&&In.isDepthTexture&&(In.type===FloatType?En=a.DEPTH_COMPONENT32F:In.type===UnsignedIntType&&(En=a.DEPTH_COMPONENT24));const Hn=nr($t);or($t)?ot.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Hn,En,$t.width,$t.height):a.renderbufferStorageMultisample(a.RENDERBUFFER,Hn,En,$t.width,$t.height)}else a.renderbufferStorage(a.RENDERBUFFER,En,$t.width,$t.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,tn)}else if($t.depthBuffer&&$t.stencilBuffer){const En=nr($t);An&&or($t)===!1?a.renderbufferStorageMultisample(a.RENDERBUFFER,En,a.DEPTH24_STENCIL8,$t.width,$t.height):or($t)?ot.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,En,a.DEPTH24_STENCIL8,$t.width,$t.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,$t.width,$t.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,tn)}else{const En=$t.isWebGLMultipleRenderTargets===!0?$t.texture:[$t.texture];for(let In=0;In<En.length;In++){const Hn=En[In],yn=_e.convert(Hn.format,Hn.colorSpace),On=_e.convert(Hn.type),Mn=Mt(Hn.internalFormat,yn,On,Hn.colorSpace),tr=nr($t);An&&or($t)===!1?a.renderbufferStorageMultisample(a.RENDERBUFFER,tr,Mn,$t.width,$t.height):or($t)?ot.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,tr,Mn,$t.width,$t.height):a.renderbufferStorage(a.RENDERBUFFER,Mn,$t.width,$t.height)}}a.bindRenderbuffer(a.RENDERBUFFER,null)}function Cn(tn,$t){if($t&&$t.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(o.bindFramebuffer(a.FRAMEBUFFER,tn),!($t.depthTexture&&$t.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!j.get($t.depthTexture).__webglTexture||$t.depthTexture.image.width!==$t.width||$t.depthTexture.image.height!==$t.height)&&($t.depthTexture.image.width=$t.width,$t.depthTexture.image.height=$t.height,$t.depthTexture.needsUpdate=!0),nn($t.depthTexture,0);const En=j.get($t.depthTexture).__webglTexture,In=nr($t);if($t.depthTexture.format===DepthFormat)or($t)?ot.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,En,0,In):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,En,0);else if($t.depthTexture.format===DepthStencilFormat)or($t)?ot.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,En,0,In):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,En,0);else throw new Error("Unknown depthTexture format")}function bn(tn){const $t=j.get(tn),An=tn.isWebGLCubeRenderTarget===!0;if(tn.depthTexture&&!$t.__autoAllocateDepthBuffer){if(An)throw new Error("target.depthTexture not supported in Cube render targets");Cn($t.__webglFramebuffer,tn)}else if(An){$t.__webglDepthbuffer=[];for(let En=0;En<6;En++)o.bindFramebuffer(a.FRAMEBUFFER,$t.__webglFramebuffer[En]),$t.__webglDepthbuffer[En]=a.createRenderbuffer(),ln($t.__webglDepthbuffer[En],tn,!1)}else o.bindFramebuffer(a.FRAMEBUFFER,$t.__webglFramebuffer),$t.__webglDepthbuffer=a.createRenderbuffer(),ln($t.__webglDepthbuffer,tn,!1);o.bindFramebuffer(a.FRAMEBUFFER,null)}function kn(tn,$t,An){const En=j.get(tn);$t!==void 0&&Dn(En.__webglFramebuffer,tn,tn.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D),An!==void 0&&bn(tn)}function Sn(tn){const $t=tn.texture,An=j.get(tn),En=j.get($t);tn.addEventListener("dispose",Ht),tn.isWebGLMultipleRenderTargets!==!0&&(En.__webglTexture===void 0&&(En.__webglTexture=a.createTexture()),En.__version=$t.version,tt.memory.textures++);const In=tn.isWebGLCubeRenderTarget===!0,Hn=tn.isWebGLMultipleRenderTargets===!0,yn=gt(tn)||nt;if(In){An.__webglFramebuffer=[];for(let On=0;On<6;On++)An.__webglFramebuffer[On]=a.createFramebuffer()}else{if(An.__webglFramebuffer=a.createFramebuffer(),Hn)if($.drawBuffers){const On=tn.texture;for(let Mn=0,tr=On.length;Mn<tr;Mn++){const gr=j.get(On[Mn]);gr.__webglTexture===void 0&&(gr.__webglTexture=a.createTexture(),tt.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(nt&&tn.samples>0&&or(tn)===!1){const On=Hn?$t:[$t];An.__webglMultisampledFramebuffer=a.createFramebuffer(),An.__webglColorRenderbuffer=[],o.bindFramebuffer(a.FRAMEBUFFER,An.__webglMultisampledFramebuffer);for(let Mn=0;Mn<On.length;Mn++){const tr=On[Mn];An.__webglColorRenderbuffer[Mn]=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,An.__webglColorRenderbuffer[Mn]);const gr=_e.convert(tr.format,tr.colorSpace),Cr=_e.convert(tr.type),Sr=Mt(tr.internalFormat,gr,Cr,tr.colorSpace,tn.isXRRenderTarget===!0),Un=nr(tn);a.renderbufferStorageMultisample(a.RENDERBUFFER,Un,Sr,tn.width,tn.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Mn,a.RENDERBUFFER,An.__webglColorRenderbuffer[Mn])}a.bindRenderbuffer(a.RENDERBUFFER,null),tn.depthBuffer&&(An.__webglDepthRenderbuffer=a.createRenderbuffer(),ln(An.__webglDepthRenderbuffer,tn,!0)),o.bindFramebuffer(a.FRAMEBUFFER,null)}}if(In){o.bindTexture(a.TEXTURE_CUBE_MAP,En.__webglTexture),hn(a.TEXTURE_CUBE_MAP,$t,yn);for(let On=0;On<6;On++)Dn(An.__webglFramebuffer[On],tn,$t,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+On);St($t,yn)&&Tt(a.TEXTURE_CUBE_MAP),o.unbindTexture()}else if(Hn){const On=tn.texture;for(let Mn=0,tr=On.length;Mn<tr;Mn++){const gr=On[Mn],Cr=j.get(gr);o.bindTexture(a.TEXTURE_2D,Cr.__webglTexture),hn(a.TEXTURE_2D,gr,yn),Dn(An.__webglFramebuffer,tn,gr,a.COLOR_ATTACHMENT0+Mn,a.TEXTURE_2D),St(gr,yn)&&Tt(a.TEXTURE_2D)}o.unbindTexture()}else{let On=a.TEXTURE_2D;(tn.isWebGL3DRenderTarget||tn.isWebGLArrayRenderTarget)&&(nt?On=tn.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),o.bindTexture(On,En.__webglTexture),hn(On,$t,yn),Dn(An.__webglFramebuffer,tn,$t,a.COLOR_ATTACHMENT0,On),St($t,yn)&&Tt(On),o.unbindTexture()}tn.depthBuffer&&bn(tn)}function xn(tn){const $t=gt(tn)||nt,An=tn.isWebGLMultipleRenderTargets===!0?tn.texture:[tn.texture];for(let En=0,In=An.length;En<In;En++){const Hn=An[En];if(St(Hn,$t)){const yn=tn.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D,On=j.get(Hn).__webglTexture;o.bindTexture(yn,On),Tt(yn),o.unbindTexture()}}}function Qn(tn){if(nt&&tn.samples>0&&or(tn)===!1){const $t=tn.isWebGLMultipleRenderTargets?tn.texture:[tn.texture],An=tn.width,En=tn.height;let In=a.COLOR_BUFFER_BIT;const Hn=[],yn=tn.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,On=j.get(tn),Mn=tn.isWebGLMultipleRenderTargets===!0;if(Mn)for(let tr=0;tr<$t.length;tr++)o.bindFramebuffer(a.FRAMEBUFFER,On.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+tr,a.RENDERBUFFER,null),o.bindFramebuffer(a.FRAMEBUFFER,On.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+tr,a.TEXTURE_2D,null,0);o.bindFramebuffer(a.READ_FRAMEBUFFER,On.__webglMultisampledFramebuffer),o.bindFramebuffer(a.DRAW_FRAMEBUFFER,On.__webglFramebuffer);for(let tr=0;tr<$t.length;tr++){Hn.push(a.COLOR_ATTACHMENT0+tr),tn.depthBuffer&&Hn.push(yn);const gr=On.__ignoreDepthValues!==void 0?On.__ignoreDepthValues:!1;if(gr===!1&&(tn.depthBuffer&&(In|=a.DEPTH_BUFFER_BIT),tn.stencilBuffer&&(In|=a.STENCIL_BUFFER_BIT)),Mn&&a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,On.__webglColorRenderbuffer[tr]),gr===!0&&(a.invalidateFramebuffer(a.READ_FRAMEBUFFER,[yn]),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[yn])),Mn){const Cr=j.get($t[tr]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Cr,0)}a.blitFramebuffer(0,0,An,En,0,0,An,En,In,a.NEAREST),ct&&a.invalidateFramebuffer(a.READ_FRAMEBUFFER,Hn)}if(o.bindFramebuffer(a.READ_FRAMEBUFFER,null),o.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),Mn)for(let tr=0;tr<$t.length;tr++){o.bindFramebuffer(a.FRAMEBUFFER,On.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+tr,a.RENDERBUFFER,On.__webglColorRenderbuffer[tr]);const gr=j.get($t[tr]).__webglTexture;o.bindFramebuffer(a.FRAMEBUFFER,On.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+tr,a.TEXTURE_2D,gr,0)}o.bindFramebuffer(a.DRAW_FRAMEBUFFER,On.__webglMultisampledFramebuffer)}}function nr(tn){return Math.min(at,tn.samples)}function or(tn){const $t=j.get(tn);return nt&&tn.samples>0&&s.has("WEBGL_multisampled_render_to_texture")===!0&&$t.__useRenderToTexture!==!1}function mr(tn){const $t=tt.render.frame;ft.get(tn)!==$t&&(ft.set(tn,$t),tn.update())}function $n(tn,$t){const An=tn.colorSpace,En=tn.format,In=tn.type;return tn.isCompressedTexture===!0||tn.format===_SRGBAFormat||An!==LinearSRGBColorSpace&&An!==NoColorSpace&&(An===SRGBColorSpace?nt===!1?s.has("EXT_sRGB")===!0&&En===RGBAFormat?(tn.format=_SRGBAFormat,tn.minFilter=LinearFilter,tn.generateMipmaps=!1):$t=ImageUtils.sRGBToLinear($t):(En!==RGBAFormat||In!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",An)),$t}this.allocateTextureUnit=Lt,this.resetTextureUnits=Vt,this.setTexture2D=nn,this.setTexture2DArray=mn,this.setTexture3D=Zt,this.setTextureCube=cn,this.rebindTextures=kn,this.setupRenderTarget=Sn,this.updateRenderTargetMipmap=xn,this.updateMultisampleRenderTarget=Qn,this.setupDepthRenderbuffer=bn,this.setupFrameBufferTexture=Dn,this.useMultisampledRTT=or}function WebGLUtils(a,s,o){const j=o.isWebGL2;function $(_e,tt=NoColorSpace){let nt;if(_e===UnsignedByteType)return a.UNSIGNED_BYTE;if(_e===UnsignedShort4444Type)return a.UNSIGNED_SHORT_4_4_4_4;if(_e===UnsignedShort5551Type)return a.UNSIGNED_SHORT_5_5_5_1;if(_e===ByteType)return a.BYTE;if(_e===ShortType)return a.SHORT;if(_e===UnsignedShortType)return a.UNSIGNED_SHORT;if(_e===IntType)return a.INT;if(_e===UnsignedIntType)return a.UNSIGNED_INT;if(_e===FloatType)return a.FLOAT;if(_e===HalfFloatType)return j?a.HALF_FLOAT:(nt=s.get("OES_texture_half_float"),nt!==null?nt.HALF_FLOAT_OES:null);if(_e===AlphaFormat)return a.ALPHA;if(_e===RGBAFormat)return a.RGBA;if(_e===LuminanceFormat)return a.LUMINANCE;if(_e===LuminanceAlphaFormat)return a.LUMINANCE_ALPHA;if(_e===DepthFormat)return a.DEPTH_COMPONENT;if(_e===DepthStencilFormat)return a.DEPTH_STENCIL;if(_e===_SRGBAFormat)return nt=s.get("EXT_sRGB"),nt!==null?nt.SRGB_ALPHA_EXT:null;if(_e===RedFormat)return a.RED;if(_e===RedIntegerFormat)return a.RED_INTEGER;if(_e===RGFormat)return a.RG;if(_e===RGIntegerFormat)return a.RG_INTEGER;if(_e===RGBAIntegerFormat)return a.RGBA_INTEGER;if(_e===RGB_S3TC_DXT1_Format||_e===RGBA_S3TC_DXT1_Format||_e===RGBA_S3TC_DXT3_Format||_e===RGBA_S3TC_DXT5_Format)if(tt===SRGBColorSpace)if(nt=s.get("WEBGL_compressed_texture_s3tc_srgb"),nt!==null){if(_e===RGB_S3TC_DXT1_Format)return nt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT1_Format)return nt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT3_Format)return nt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(_e===RGBA_S3TC_DXT5_Format)return nt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(nt=s.get("WEBGL_compressed_texture_s3tc"),nt!==null){if(_e===RGB_S3TC_DXT1_Format)return nt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT1_Format)return nt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_e===RGBA_S3TC_DXT3_Format)return nt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_e===RGBA_S3TC_DXT5_Format)return nt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_e===RGB_PVRTC_4BPPV1_Format||_e===RGB_PVRTC_2BPPV1_Format||_e===RGBA_PVRTC_4BPPV1_Format||_e===RGBA_PVRTC_2BPPV1_Format)if(nt=s.get("WEBGL_compressed_texture_pvrtc"),nt!==null){if(_e===RGB_PVRTC_4BPPV1_Format)return nt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_e===RGB_PVRTC_2BPPV1_Format)return nt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_e===RGBA_PVRTC_4BPPV1_Format)return nt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_e===RGBA_PVRTC_2BPPV1_Format)return nt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_e===RGB_ETC1_Format)return nt=s.get("WEBGL_compressed_texture_etc1"),nt!==null?nt.COMPRESSED_RGB_ETC1_WEBGL:null;if(_e===RGB_ETC2_Format||_e===RGBA_ETC2_EAC_Format)if(nt=s.get("WEBGL_compressed_texture_etc"),nt!==null){if(_e===RGB_ETC2_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ETC2:nt.COMPRESSED_RGB8_ETC2;if(_e===RGBA_ETC2_EAC_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:nt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(_e===RGBA_ASTC_4x4_Format||_e===RGBA_ASTC_5x4_Format||_e===RGBA_ASTC_5x5_Format||_e===RGBA_ASTC_6x5_Format||_e===RGBA_ASTC_6x6_Format||_e===RGBA_ASTC_8x5_Format||_e===RGBA_ASTC_8x6_Format||_e===RGBA_ASTC_8x8_Format||_e===RGBA_ASTC_10x5_Format||_e===RGBA_ASTC_10x6_Format||_e===RGBA_ASTC_10x8_Format||_e===RGBA_ASTC_10x10_Format||_e===RGBA_ASTC_12x10_Format||_e===RGBA_ASTC_12x12_Format)if(nt=s.get("WEBGL_compressed_texture_astc"),nt!==null){if(_e===RGBA_ASTC_4x4_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:nt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(_e===RGBA_ASTC_5x4_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:nt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(_e===RGBA_ASTC_5x5_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:nt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(_e===RGBA_ASTC_6x5_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:nt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(_e===RGBA_ASTC_6x6_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:nt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(_e===RGBA_ASTC_8x5_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:nt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(_e===RGBA_ASTC_8x6_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:nt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(_e===RGBA_ASTC_8x8_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:nt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(_e===RGBA_ASTC_10x5_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:nt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(_e===RGBA_ASTC_10x6_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:nt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(_e===RGBA_ASTC_10x8_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:nt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(_e===RGBA_ASTC_10x10_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:nt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(_e===RGBA_ASTC_12x10_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:nt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(_e===RGBA_ASTC_12x12_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:nt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(_e===RGBA_BPTC_Format)if(nt=s.get("EXT_texture_compression_bptc"),nt!==null){if(_e===RGBA_BPTC_Format)return tt===SRGBColorSpace?nt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:nt.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(_e===RED_RGTC1_Format||_e===SIGNED_RED_RGTC1_Format||_e===RED_GREEN_RGTC2_Format||_e===SIGNED_RED_GREEN_RGTC2_Format)if(nt=s.get("EXT_texture_compression_rgtc"),nt!==null){if(_e===RGBA_BPTC_Format)return nt.COMPRESSED_RED_RGTC1_EXT;if(_e===SIGNED_RED_RGTC1_Format)return nt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(_e===RED_GREEN_RGTC2_Format)return nt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(_e===SIGNED_RED_GREEN_RGTC2_Format)return nt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return _e===UnsignedInt248Type?j?a.UNSIGNED_INT_24_8:(nt=s.get("WEBGL_depth_texture"),nt!==null?nt.UNSIGNED_INT_24_8_WEBGL:null):a[_e]!==void 0?a[_e]:null}return{convert:$}}class ArrayCamera extends PerspectiveCamera{constructor(s=[]){super(),this.isArrayCamera=!0,this.cameras=s}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(s){return this._targetRay!==null&&this._targetRay.dispatchEvent(s),this._grip!==null&&this._grip.dispatchEvent(s),this._hand!==null&&this._hand.dispatchEvent(s),this}connect(s){if(s&&s.hand){const o=this._hand;if(o)for(const j of s.hand.values())this._getHandJoint(o,j)}return this.dispatchEvent({type:"connected",data:s}),this}disconnect(s){return this.dispatchEvent({type:"disconnected",data:s}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(s,o,j){let $=null,_e=null,tt=null;const nt=this._targetRay,rt=this._grip,it=this._hand;if(s&&o.session.visibilityState!=="visible-blurred"){if(it&&s.hand){tt=!0;for(const ht of s.hand.values()){const mt=o.getJointPose(ht,j),lt=this._getHandJoint(it,ht);mt!==null&&(lt.matrix.fromArray(mt.transform.matrix),lt.matrix.decompose(lt.position,lt.rotation,lt.scale),lt.matrixWorldNeedsUpdate=!0,lt.jointRadius=mt.radius),lt.visible=mt!==null}const st=it.joints["index-finger-tip"],at=it.joints["thumb-tip"],ot=st.position.distanceTo(at.position),ct=.02,ft=.005;it.inputState.pinching&&ot>ct+ft?(it.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:s.handedness,target:this})):!it.inputState.pinching&&ot<=ct-ft&&(it.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:s.handedness,target:this}))}else rt!==null&&s.gripSpace&&(_e=o.getPose(s.gripSpace,j),_e!==null&&(rt.matrix.fromArray(_e.transform.matrix),rt.matrix.decompose(rt.position,rt.rotation,rt.scale),rt.matrixWorldNeedsUpdate=!0,_e.linearVelocity?(rt.hasLinearVelocity=!0,rt.linearVelocity.copy(_e.linearVelocity)):rt.hasLinearVelocity=!1,_e.angularVelocity?(rt.hasAngularVelocity=!0,rt.angularVelocity.copy(_e.angularVelocity)):rt.hasAngularVelocity=!1));nt!==null&&($=o.getPose(s.targetRaySpace,j),$===null&&_e!==null&&($=_e),$!==null&&(nt.matrix.fromArray($.transform.matrix),nt.matrix.decompose(nt.position,nt.rotation,nt.scale),nt.matrixWorldNeedsUpdate=!0,$.linearVelocity?(nt.hasLinearVelocity=!0,nt.linearVelocity.copy($.linearVelocity)):nt.hasLinearVelocity=!1,$.angularVelocity?(nt.hasAngularVelocity=!0,nt.angularVelocity.copy($.angularVelocity)):nt.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return nt!==null&&(nt.visible=$!==null),rt!==null&&(rt.visible=_e!==null),it!==null&&(it.visible=tt!==null),this}_getHandJoint(s,o){if(s.joints[o.jointName]===void 0){const j=new Group;j.matrixAutoUpdate=!1,j.visible=!1,s.joints[o.jointName]=j,s.add(j)}return s.joints[o.jointName]}}class DepthTexture extends Texture{constructor(s,o,j,$,_e,tt,nt,rt,it,st){if(st=st!==void 0?st:DepthFormat,st!==DepthFormat&&st!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");j===void 0&&st===DepthFormat&&(j=UnsignedIntType),j===void 0&&st===DepthStencilFormat&&(j=UnsignedInt248Type),super(null,$,_e,tt,nt,rt,st,j,it),this.isDepthTexture=!0,this.image={width:s,height:o},this.magFilter=nt!==void 0?nt:NearestFilter,this.minFilter=rt!==void 0?rt:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(s){return super.copy(s),this.compareFunction=s.compareFunction,this}toJSON(s){const o=super.toJSON(s);return this.compareFunction!==null&&(o.compareFunction=this.compareFunction),o}}class WebXRManager extends EventDispatcher{constructor(s,o){super();const j=this;let $=null,_e=1,tt=null,nt="local-floor",rt=1,it=null,st=null,at=null,ot=null,ct=null,ft=null;const ht=o.getContextAttributes();let mt=null,lt=null;const ut=[],dt=[];let gt=null;const Et=new PerspectiveCamera;Et.layers.enable(1),Et.viewport=new Vector4;const St=new PerspectiveCamera;St.layers.enable(2),St.viewport=new Vector4;const Tt=[Et,St],Mt=new ArrayCamera;Mt.layers.enable(1),Mt.layers.enable(2);let Bt=null,Rt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getCamera=function(){},this.setUserCamera=function(Zt){gt=Zt},this.getController=function(Zt){let cn=ut[Zt];return cn===void 0&&(cn=new WebXRController,ut[Zt]=cn),cn.getTargetRaySpace()},this.getControllerGrip=function(Zt){let cn=ut[Zt];return cn===void 0&&(cn=new WebXRController,ut[Zt]=cn),cn.getGripSpace()},this.getHand=function(Zt){let cn=ut[Zt];return cn===void 0&&(cn=new WebXRController,ut[Zt]=cn),cn.getHandSpace()};function Ut(Zt){const cn=dt.indexOf(Zt.inputSource);if(cn===-1)return;const Ot=ut[cn];Ot!==void 0&&(Ot.update(Zt.inputSource,Zt.frame,it||tt),Ot.dispatchEvent({type:Zt.type,data:Zt.inputSource}))}function Ht(){$.removeEventListener("select",Ut),$.removeEventListener("selectstart",Ut),$.removeEventListener("selectend",Ut),$.removeEventListener("squeeze",Ut),$.removeEventListener("squeezestart",Ut),$.removeEventListener("squeezeend",Ut),$.removeEventListener("end",Ht),$.removeEventListener("inputsourceschange",Wt);for(let Zt=0;Zt<ut.length;Zt++){const cn=dt[Zt];cn!==null&&(dt[Zt]=null,ut[Zt].disconnect(cn))}Bt=null,Rt=null,s.setRenderTarget(mt),ct=null,ot=null,at=null,$=null,lt=null,mn.stop(),j.isPresenting=!1,j.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Zt){_e=Zt,j.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Zt){nt=Zt,j.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return it||tt},this.setReferenceSpace=function(Zt){it=Zt},this.getBaseLayer=function(){return ot!==null?ot:ct},this.getBinding=function(){return at},this.getFrame=function(){return ft},this.getSession=function(){return $},this.setSession=async function(Zt){if($=Zt,$!==null){if(mt=s.getRenderTarget(),$.addEventListener("select",Ut),$.addEventListener("selectstart",Ut),$.addEventListener("selectend",Ut),$.addEventListener("squeeze",Ut),$.addEventListener("squeezestart",Ut),$.addEventListener("squeezeend",Ut),$.addEventListener("end",Ht),$.addEventListener("inputsourceschange",Wt),ht.xrCompatible!==!0&&await o.makeXRCompatible(),$.renderState.layers===void 0||s.capabilities.isWebGL2===!1){const cn={antialias:$.renderState.layers===void 0?ht.antialias:!0,alpha:!0,depth:ht.depth,stencil:ht.stencil,framebufferScaleFactor:_e};ct=new XRWebGLLayer($,o,cn),$.updateRenderState({baseLayer:ct}),lt=new WebGLRenderTarget(ct.framebufferWidth,ct.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:s.outputColorSpace,stencilBuffer:ht.stencil})}else{let cn=null,Ot=null,rn=null;ht.depth&&(rn=ht.stencil?o.DEPTH24_STENCIL8:o.DEPTH_COMPONENT24,cn=ht.stencil?DepthStencilFormat:DepthFormat,Ot=ht.stencil?UnsignedInt248Type:UnsignedIntType);const fn={colorFormat:o.RGBA8,depthFormat:rn,scaleFactor:_e};at=new XRWebGLBinding($,o),ot=at.createProjectionLayer(fn),$.updateRenderState({layers:[ot]}),lt=new WebGLRenderTarget(ot.textureWidth,ot.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(ot.textureWidth,ot.textureHeight,Ot,void 0,void 0,void 0,void 0,void 0,void 0,cn),stencilBuffer:ht.stencil,colorSpace:s.outputColorSpace,samples:ht.antialias?4:0});const hn=s.properties.get(lt);hn.__ignoreDepthValues=ot.ignoreDepthValues}lt.isXRRenderTarget=!0,this.setFoveation(rt),it=null,tt=await $.requestReferenceSpace(nt),mn.setContext($),mn.start(),j.isPresenting=!0,j.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if($!==null)return $.environmentBlendMode};function Wt(Zt){for(let cn=0;cn<Zt.removed.length;cn++){const Ot=Zt.removed[cn],rn=dt.indexOf(Ot);rn>=0&&(dt[rn]=null,ut[rn].disconnect(Ot))}for(let cn=0;cn<Zt.added.length;cn++){const Ot=Zt.added[cn];let rn=dt.indexOf(Ot);if(rn===-1){for(let hn=0;hn<ut.length;hn++)if(hn>=dt.length){dt.push(Ot),rn=hn;break}else if(dt[hn]===null){dt[hn]=Ot,rn=hn;break}if(rn===-1)break}const fn=ut[rn];fn&&fn.connect(Ot)}}const Jt=new Vector3,sn=new Vector3;function jt(Zt,cn,Ot){Jt.setFromMatrixPosition(cn.matrixWorld),sn.setFromMatrixPosition(Ot.matrixWorld);const rn=Jt.distanceTo(sn),fn=cn.projectionMatrix.elements,hn=Ot.projectionMatrix.elements,Tn=fn[14]/(fn[10]-1),Nn=fn[14]/(fn[10]+1),Pn=(fn[9]+1)/fn[5],Dn=(fn[9]-1)/fn[5],ln=(fn[8]-1)/fn[0],Cn=(hn[8]+1)/hn[0],bn=Tn*ln,kn=Tn*Cn,Sn=rn/(-ln+Cn),xn=Sn*-ln;cn.matrixWorld.decompose(Zt.position,Zt.quaternion,Zt.scale),Zt.translateX(xn),Zt.translateZ(Sn),Zt.matrixWorld.compose(Zt.position,Zt.quaternion,Zt.scale),Zt.matrixWorldInverse.copy(Zt.matrixWorld).invert();const Qn=Tn+Sn,nr=Nn+Sn,or=bn-xn,mr=kn+(rn-xn),$n=Pn*Nn/nr*Qn,tn=Dn*Nn/nr*Qn;Zt.projectionMatrix.makePerspective(or,mr,$n,tn,Qn,nr),Zt.projectionMatrixInverse.copy(Zt.projectionMatrix).invert()}function Vt(Zt,cn){cn===null?Zt.matrixWorld.copy(Zt.matrix):Zt.matrixWorld.multiplyMatrices(cn.matrixWorld,Zt.matrix),Zt.matrixWorldInverse.copy(Zt.matrixWorld).invert()}this.updateCameraXR=function(Zt){if($===null)return Zt;gt&&(Zt=gt),Mt.near=St.near=Et.near=Zt.near,Mt.far=St.far=Et.far=Zt.far,(Bt!==Mt.near||Rt!==Mt.far)&&($.updateRenderState({depthNear:Mt.near,depthFar:Mt.far}),Bt=Mt.near,Rt=Mt.far);const cn=Zt.parent,Ot=Mt.cameras;Vt(Mt,cn);for(let rn=0;rn<Ot.length;rn++)Vt(Ot[rn],cn);return Ot.length===2?jt(Mt,Et,St):Mt.projectionMatrix.copy(Et.projectionMatrix),gt&&Lt(Mt,cn),Mt};function Lt(Zt,cn){const Ot=gt;cn===null?Ot.matrix.copy(Zt.matrixWorld):(Ot.matrix.copy(cn.matrixWorld),Ot.matrix.invert(),Ot.matrix.multiply(Zt.matrixWorld)),Ot.matrix.decompose(Ot.position,Ot.quaternion,Ot.scale),Ot.updateMatrixWorld(!0);const rn=Ot.children;for(let fn=0,hn=rn.length;fn<hn;fn++)rn[fn].updateMatrixWorld(!0);Ot.projectionMatrix.copy(Zt.projectionMatrix),Ot.projectionMatrixInverse.copy(Zt.projectionMatrixInverse),Ot.isPerspectiveCamera&&(Ot.fov=RAD2DEG*2*Math.atan(1/Ot.projectionMatrix.elements[5]),Ot.zoom=1)}this.getFoveation=function(){if(!(ot===null&&ct===null))return rt},this.setFoveation=function(Zt){rt=Zt,ot!==null&&(ot.fixedFoveation=Zt),ct!==null&&ct.fixedFoveation!==void 0&&(ct.fixedFoveation=Zt)};let Qt=null;function nn(Zt,cn){if(st=cn.getViewerPose(it||tt),ft=cn,st!==null){const Ot=st.views;ct!==null&&(s.setRenderTargetFramebuffer(lt,ct.framebuffer),s.setRenderTarget(lt));let rn=!1;Ot.length!==Mt.cameras.length&&(Mt.cameras.length=0,rn=!0);for(let fn=0;fn<Ot.length;fn++){const hn=Ot[fn];let Tn=null;if(ct!==null)Tn=ct.getViewport(hn);else{const Pn=at.getViewSubImage(ot,hn);Tn=Pn.viewport,fn===0&&(s.setRenderTargetTextures(lt,Pn.colorTexture,ot.ignoreDepthValues?void 0:Pn.depthStencilTexture),s.setRenderTarget(lt))}let Nn=Tt[fn];Nn===void 0&&(Nn=new PerspectiveCamera,Nn.layers.enable(fn),Nn.viewport=new Vector4,Tt[fn]=Nn),Nn.matrix.fromArray(hn.transform.matrix),Nn.matrix.decompose(Nn.position,Nn.quaternion,Nn.scale),Nn.projectionMatrix.fromArray(hn.projectionMatrix),Nn.projectionMatrixInverse.copy(Nn.projectionMatrix).invert(),Nn.viewport.set(Tn.x,Tn.y,Tn.width,Tn.height),fn===0&&(Mt.matrix.copy(Nn.matrix),Mt.matrix.decompose(Mt.position,Mt.quaternion,Mt.scale)),rn===!0&&Mt.cameras.push(Nn)}}for(let Ot=0;Ot<ut.length;Ot++){const rn=dt[Ot],fn=ut[Ot];rn!==null&&fn!==void 0&&fn.update(rn,cn,it||tt)}Qt&&Qt(Zt,cn),cn.detectedPlanes&&j.dispatchEvent({type:"planesdetected",data:cn}),ft=null}const mn=new WebGLAnimation;mn.setAnimationLoop(nn),this.setAnimationLoop=function(Zt){Qt=Zt},this.dispose=function(){}}}function WebGLMaterials(a,s){function o(mt,lt){mt.matrixAutoUpdate===!0&&mt.updateMatrix(),lt.value.copy(mt.matrix)}function j(mt,lt){lt.color.getRGB(mt.fogColor.value,getUnlitUniformColorSpace(a)),lt.isFog?(mt.fogNear.value=lt.near,mt.fogFar.value=lt.far):lt.isFogExp2&&(mt.fogDensity.value=lt.density)}function $(mt,lt,ut,dt,gt){lt.isMeshBasicMaterial||lt.isMeshLambertMaterial?_e(mt,lt):lt.isMeshToonMaterial?(_e(mt,lt),at(mt,lt)):lt.isMeshPhongMaterial?(_e(mt,lt),st(mt,lt)):lt.isMeshStandardMaterial?(_e(mt,lt),ot(mt,lt),lt.isMeshPhysicalMaterial&&ct(mt,lt,gt)):lt.isMeshMatcapMaterial?(_e(mt,lt),ft(mt,lt)):lt.isMeshDepthMaterial?_e(mt,lt):lt.isMeshDistanceMaterial?(_e(mt,lt),ht(mt,lt)):lt.isMeshNormalMaterial?_e(mt,lt):lt.isLineBasicMaterial?(tt(mt,lt),lt.isLineDashedMaterial&&nt(mt,lt)):lt.isPointsMaterial?rt(mt,lt,ut,dt):lt.isSpriteMaterial?it(mt,lt):lt.isShadowMaterial?(mt.color.value.copy(lt.color),mt.opacity.value=lt.opacity):lt.isShaderMaterial&&(lt.uniformsNeedUpdate=!1)}function _e(mt,lt){mt.opacity.value=lt.opacity,lt.color&&mt.diffuse.value.copy(lt.color),lt.emissive&&mt.emissive.value.copy(lt.emissive).multiplyScalar(lt.emissiveIntensity),lt.map&&(mt.map.value=lt.map,o(lt.map,mt.mapTransform)),lt.alphaMap&&(mt.alphaMap.value=lt.alphaMap,o(lt.alphaMap,mt.alphaMapTransform)),lt.bumpMap&&(mt.bumpMap.value=lt.bumpMap,o(lt.bumpMap,mt.bumpMapTransform),mt.bumpScale.value=lt.bumpScale,lt.side===BackSide&&(mt.bumpScale.value*=-1)),lt.normalMap&&(mt.normalMap.value=lt.normalMap,o(lt.normalMap,mt.normalMapTransform),mt.normalScale.value.copy(lt.normalScale),lt.side===BackSide&&mt.normalScale.value.negate()),lt.displacementMap&&(mt.displacementMap.value=lt.displacementMap,o(lt.displacementMap,mt.displacementMapTransform),mt.displacementScale.value=lt.displacementScale,mt.displacementBias.value=lt.displacementBias),lt.emissiveMap&&(mt.emissiveMap.value=lt.emissiveMap,o(lt.emissiveMap,mt.emissiveMapTransform)),lt.specularMap&&(mt.specularMap.value=lt.specularMap,o(lt.specularMap,mt.specularMapTransform)),lt.alphaTest>0&&(mt.alphaTest.value=lt.alphaTest);const ut=s.get(lt).envMap;if(ut&&(mt.envMap.value=ut,mt.flipEnvMap.value=ut.isCubeTexture&&ut.isRenderTargetTexture===!1?-1:1,mt.reflectivity.value=lt.reflectivity,mt.ior.value=lt.ior,mt.refractionRatio.value=lt.refractionRatio),lt.lightMap){mt.lightMap.value=lt.lightMap;const dt=a.useLegacyLights===!0?Math.PI:1;mt.lightMapIntensity.value=lt.lightMapIntensity*dt,o(lt.lightMap,mt.lightMapTransform)}lt.aoMap&&(mt.aoMap.value=lt.aoMap,mt.aoMapIntensity.value=lt.aoMapIntensity,o(lt.aoMap,mt.aoMapTransform))}function tt(mt,lt){mt.diffuse.value.copy(lt.color),mt.opacity.value=lt.opacity,lt.map&&(mt.map.value=lt.map,o(lt.map,mt.mapTransform))}function nt(mt,lt){mt.dashSize.value=lt.dashSize,mt.totalSize.value=lt.dashSize+lt.gapSize,mt.scale.value=lt.scale}function rt(mt,lt,ut,dt){mt.diffuse.value.copy(lt.color),mt.opacity.value=lt.opacity,mt.size.value=lt.size*ut,mt.scale.value=dt*.5,lt.map&&(mt.map.value=lt.map,o(lt.map,mt.uvTransform)),lt.alphaMap&&(mt.alphaMap.value=lt.alphaMap,o(lt.alphaMap,mt.alphaMapTransform)),lt.alphaTest>0&&(mt.alphaTest.value=lt.alphaTest)}function it(mt,lt){mt.diffuse.value.copy(lt.color),mt.opacity.value=lt.opacity,mt.rotation.value=lt.rotation,lt.map&&(mt.map.value=lt.map,o(lt.map,mt.mapTransform)),lt.alphaMap&&(mt.alphaMap.value=lt.alphaMap,o(lt.alphaMap,mt.alphaMapTransform)),lt.alphaTest>0&&(mt.alphaTest.value=lt.alphaTest)}function st(mt,lt){mt.specular.value.copy(lt.specular),mt.shininess.value=Math.max(lt.shininess,1e-4)}function at(mt,lt){lt.gradientMap&&(mt.gradientMap.value=lt.gradientMap)}function ot(mt,lt){mt.metalness.value=lt.metalness,lt.metalnessMap&&(mt.metalnessMap.value=lt.metalnessMap,o(lt.metalnessMap,mt.metalnessMapTransform)),mt.roughness.value=lt.roughness,lt.roughnessMap&&(mt.roughnessMap.value=lt.roughnessMap,o(lt.roughnessMap,mt.roughnessMapTransform)),s.get(lt).envMap&&(mt.envMapIntensity.value=lt.envMapIntensity)}function ct(mt,lt,ut){mt.ior.value=lt.ior,lt.sheen>0&&(mt.sheenColor.value.copy(lt.sheenColor).multiplyScalar(lt.sheen),mt.sheenRoughness.value=lt.sheenRoughness,lt.sheenColorMap&&(mt.sheenColorMap.value=lt.sheenColorMap,o(lt.sheenColorMap,mt.sheenColorMapTransform)),lt.sheenRoughnessMap&&(mt.sheenRoughnessMap.value=lt.sheenRoughnessMap,o(lt.sheenRoughnessMap,mt.sheenRoughnessMapTransform))),lt.clearcoat>0&&(mt.clearcoat.value=lt.clearcoat,mt.clearcoatRoughness.value=lt.clearcoatRoughness,lt.clearcoatMap&&(mt.clearcoatMap.value=lt.clearcoatMap,o(lt.clearcoatMap,mt.clearcoatMapTransform)),lt.clearcoatRoughnessMap&&(mt.clearcoatRoughnessMap.value=lt.clearcoatRoughnessMap,o(lt.clearcoatRoughnessMap,mt.clearcoatRoughnessMapTransform)),lt.clearcoatNormalMap&&(mt.clearcoatNormalMap.value=lt.clearcoatNormalMap,o(lt.clearcoatNormalMap,mt.clearcoatNormalMapTransform),mt.clearcoatNormalScale.value.copy(lt.clearcoatNormalScale),lt.side===BackSide&&mt.clearcoatNormalScale.value.negate())),lt.iridescence>0&&(mt.iridescence.value=lt.iridescence,mt.iridescenceIOR.value=lt.iridescenceIOR,mt.iridescenceThicknessMinimum.value=lt.iridescenceThicknessRange[0],mt.iridescenceThicknessMaximum.value=lt.iridescenceThicknessRange[1],lt.iridescenceMap&&(mt.iridescenceMap.value=lt.iridescenceMap,o(lt.iridescenceMap,mt.iridescenceMapTransform)),lt.iridescenceThicknessMap&&(mt.iridescenceThicknessMap.value=lt.iridescenceThicknessMap,o(lt.iridescenceThicknessMap,mt.iridescenceThicknessMapTransform))),lt.transmission>0&&(mt.transmission.value=lt.transmission,mt.transmissionSamplerMap.value=ut.texture,mt.transmissionSamplerSize.value.set(ut.width,ut.height),lt.transmissionMap&&(mt.transmissionMap.value=lt.transmissionMap,o(lt.transmissionMap,mt.transmissionMapTransform)),mt.thickness.value=lt.thickness,lt.thicknessMap&&(mt.thicknessMap.value=lt.thicknessMap,o(lt.thicknessMap,mt.thicknessMapTransform)),mt.attenuationDistance.value=lt.attenuationDistance,mt.attenuationColor.value.copy(lt.attenuationColor)),lt.anisotropy>0&&(mt.anisotropyVector.value.set(lt.anisotropy*Math.cos(lt.anisotropyRotation),lt.anisotropy*Math.sin(lt.anisotropyRotation)),lt.anisotropyMap&&(mt.anisotropyMap.value=lt.anisotropyMap,o(lt.anisotropyMap,mt.anisotropyMapTransform))),mt.specularIntensity.value=lt.specularIntensity,mt.specularColor.value.copy(lt.specularColor),lt.specularColorMap&&(mt.specularColorMap.value=lt.specularColorMap,o(lt.specularColorMap,mt.specularColorMapTransform)),lt.specularIntensityMap&&(mt.specularIntensityMap.value=lt.specularIntensityMap,o(lt.specularIntensityMap,mt.specularIntensityMapTransform))}function ft(mt,lt){lt.matcap&&(mt.matcap.value=lt.matcap)}function ht(mt,lt){const ut=s.get(lt).light;mt.referencePosition.value.setFromMatrixPosition(ut.matrixWorld),mt.nearDistance.value=ut.shadow.camera.near,mt.farDistance.value=ut.shadow.camera.far}return{refreshFogUniforms:j,refreshMaterialUniforms:$}}function WebGLUniformsGroups(a,s,o,j){let $={},_e={},tt=[];const nt=o.isWebGL2?a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS):0;function rt(ut,dt){const gt=dt.program;j.uniformBlockBinding(ut,gt)}function it(ut,dt){let gt=$[ut.id];gt===void 0&&(ft(ut),gt=st(ut),$[ut.id]=gt,ut.addEventListener("dispose",mt));const Et=dt.program;j.updateUBOMapping(ut,Et);const St=s.render.frame;_e[ut.id]!==St&&(ot(ut),_e[ut.id]=St)}function st(ut){const dt=at();ut.__bindingPointIndex=dt;const gt=a.createBuffer(),Et=ut.__size,St=ut.usage;return a.bindBuffer(a.UNIFORM_BUFFER,gt),a.bufferData(a.UNIFORM_BUFFER,Et,St),a.bindBuffer(a.UNIFORM_BUFFER,null),a.bindBufferBase(a.UNIFORM_BUFFER,dt,gt),gt}function at(){for(let ut=0;ut<nt;ut++)if(tt.indexOf(ut)===-1)return tt.push(ut),ut;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function ot(ut){const dt=$[ut.id],gt=ut.uniforms,Et=ut.__cache;a.bindBuffer(a.UNIFORM_BUFFER,dt);for(let St=0,Tt=gt.length;St<Tt;St++){const Mt=gt[St];if(ct(Mt,St,Et)===!0){const Bt=Mt.__offset,Rt=Array.isArray(Mt.value)?Mt.value:[Mt.value];let Ut=0;for(let Ht=0;Ht<Rt.length;Ht++){const Wt=Rt[Ht],Jt=ht(Wt);typeof Wt=="number"?(Mt.__data[0]=Wt,a.bufferSubData(a.UNIFORM_BUFFER,Bt+Ut,Mt.__data)):Wt.isMatrix3?(Mt.__data[0]=Wt.elements[0],Mt.__data[1]=Wt.elements[1],Mt.__data[2]=Wt.elements[2],Mt.__data[3]=Wt.elements[0],Mt.__data[4]=Wt.elements[3],Mt.__data[5]=Wt.elements[4],Mt.__data[6]=Wt.elements[5],Mt.__data[7]=Wt.elements[0],Mt.__data[8]=Wt.elements[6],Mt.__data[9]=Wt.elements[7],Mt.__data[10]=Wt.elements[8],Mt.__data[11]=Wt.elements[0]):(Wt.toArray(Mt.__data,Ut),Ut+=Jt.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,Bt,Mt.__data)}}a.bindBuffer(a.UNIFORM_BUFFER,null)}function ct(ut,dt,gt){const Et=ut.value;if(gt[dt]===void 0){if(typeof Et=="number")gt[dt]=Et;else{const St=Array.isArray(Et)?Et:[Et],Tt=[];for(let Mt=0;Mt<St.length;Mt++)Tt.push(St[Mt].clone());gt[dt]=Tt}return!0}else if(typeof Et=="number"){if(gt[dt]!==Et)return gt[dt]=Et,!0}else{const St=Array.isArray(gt[dt])?gt[dt]:[gt[dt]],Tt=Array.isArray(Et)?Et:[Et];for(let Mt=0;Mt<St.length;Mt++){const Bt=St[Mt];if(Bt.equals(Tt[Mt])===!1)return Bt.copy(Tt[Mt]),!0}}return!1}function ft(ut){const dt=ut.uniforms;let gt=0;const Et=16;let St=0;for(let Tt=0,Mt=dt.length;Tt<Mt;Tt++){const Bt=dt[Tt],Rt={boundary:0,storage:0},Ut=Array.isArray(Bt.value)?Bt.value:[Bt.value];for(let Ht=0,Wt=Ut.length;Ht<Wt;Ht++){const Jt=Ut[Ht],sn=ht(Jt);Rt.boundary+=sn.boundary,Rt.storage+=sn.storage}if(Bt.__data=new Float32Array(Rt.storage/Float32Array.BYTES_PER_ELEMENT),Bt.__offset=gt,Tt>0){St=gt%Et;const Ht=Et-St;St!==0&&Ht-Rt.boundary<0&&(gt+=Et-St,Bt.__offset=gt)}gt+=Rt.storage}return St=gt%Et,St>0&&(gt+=Et-St),ut.__size=gt,ut.__cache={},this}function ht(ut){const dt={boundary:0,storage:0};return typeof ut=="number"?(dt.boundary=4,dt.storage=4):ut.isVector2?(dt.boundary=8,dt.storage=8):ut.isVector3||ut.isColor?(dt.boundary=16,dt.storage=12):ut.isVector4?(dt.boundary=16,dt.storage=16):ut.isMatrix3?(dt.boundary=48,dt.storage=48):ut.isMatrix4?(dt.boundary=64,dt.storage=64):ut.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ut),dt}function mt(ut){const dt=ut.target;dt.removeEventListener("dispose",mt);const gt=tt.indexOf(dt.__bindingPointIndex);tt.splice(gt,1),a.deleteBuffer($[dt.id]),delete $[dt.id],delete _e[dt.id]}function lt(){for(const ut in $)a.deleteBuffer($[ut]);tt=[],$={},_e={}}return{bind:rt,update:it,dispose:lt}}function createCanvasElement(){const a=createElementNS("canvas");return a.style.display="block",a}class WebGLRenderer{constructor(s={}){const{canvas:o=createCanvasElement(),context:j=null,depth:$=!0,stencil:_e=!0,alpha:tt=!1,antialias:nt=!1,premultipliedAlpha:rt=!0,preserveDrawingBuffer:it=!1,powerPreference:st="default",failIfMajorPerformanceCaveat:at=!1}=s;this.isWebGLRenderer=!0;let ot;j!==null?ot=j.getContextAttributes().alpha:ot=tt;const ct=new Uint32Array(4),ft=new Int32Array(4);let ht=null,mt=null;const lt=[],ut=[];this.domElement=o,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=SRGBColorSpace,this.useLegacyLights=!0,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const dt=this;let gt=!1,Et=0,St=0,Tt=null,Mt=-1,Bt=null;const Rt=new Vector4,Ut=new Vector4;let Ht=null;const Wt=new Color(0);let Jt=0,sn=o.width,jt=o.height,Vt=1,Lt=null,Qt=null;const nn=new Vector4(0,0,sn,jt),mn=new Vector4(0,0,sn,jt);let Zt=!1;const cn=new Frustum;let Ot=!1,rn=!1,fn=null;const hn=new Matrix4,Tn=new Vector2,Nn=new Vector3,Pn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Dn(){return Tt===null?Vt:1}let ln=j;function Cn(Kt,Gt){for(let zt=0;zt<Kt.length;zt++){const on=Kt[zt],dn=o.getContext(on,Gt);if(dn!==null)return dn}return null}try{const Kt={alpha:!0,depth:$,stencil:_e,antialias:nt,premultipliedAlpha:rt,preserveDrawingBuffer:it,powerPreference:st,failIfMajorPerformanceCaveat:at};if("setAttribute"in o&&o.setAttribute("data-engine",`three.js r${REVISION}`),o.addEventListener("webglcontextlost",Zn,!1),o.addEventListener("webglcontextrestored",qn,!1),o.addEventListener("webglcontextcreationerror",vr,!1),ln===null){const Gt=["webgl2","webgl","experimental-webgl"];if(dt.isWebGL1Renderer===!0&&Gt.shift(),ln=Cn(Gt,Kt),ln===null)throw Cn(Gt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ln instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ln.getShaderPrecisionFormat===void 0&&(ln.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Kt){throw console.error("THREE.WebGLRenderer: "+Kt.message),Kt}let bn,kn,Sn,xn,Qn,nr,or,mr,$n,tn,$t,An,En,In,Hn,yn,On,Mn,tr,gr,Cr,Sr,Un,Jn;function pr(){bn=new WebGLExtensions(ln),kn=new WebGLCapabilities(ln,bn,s),bn.init(kn),Sr=new WebGLUtils(ln,bn,kn),Sn=new WebGLState(ln,bn,kn),xn=new WebGLInfo(ln),Qn=new WebGLProperties,nr=new WebGLTextures(ln,bn,Sn,Qn,kn,Sr,xn),or=new WebGLCubeMaps(dt),mr=new WebGLCubeUVMaps(dt),$n=new WebGLAttributes(ln,kn),Un=new WebGLBindingStates(ln,bn,$n,kn),tn=new WebGLGeometries(ln,$n,xn,Un),$t=new WebGLObjects(ln,tn,$n,xn),tr=new WebGLMorphtargets(ln,kn,nr),yn=new WebGLClipping(Qn),An=new WebGLPrograms(dt,or,mr,bn,kn,Un,yn),En=new WebGLMaterials(dt,Qn),In=new WebGLRenderLists,Hn=new WebGLRenderStates(bn,kn),Mn=new WebGLBackground(dt,or,mr,Sn,$t,ot,rt),On=new WebGLShadowMap(dt,$t,kn),Jn=new WebGLUniformsGroups(ln,xn,kn,Sn),gr=new WebGLBufferRenderer(ln,bn,xn,kn),Cr=new WebGLIndexedBufferRenderer(ln,bn,xn,kn),xn.programs=An.programs,dt.capabilities=kn,dt.extensions=bn,dt.properties=Qn,dt.renderLists=In,dt.shadowMap=On,dt.state=Sn,dt.info=xn}pr();const Gn=new WebXRManager(dt,ln);this.xr=Gn,this.getContext=function(){return ln},this.getContextAttributes=function(){return ln.getContextAttributes()},this.forceContextLoss=function(){const Kt=bn.get("WEBGL_lose_context");Kt&&Kt.loseContext()},this.forceContextRestore=function(){const Kt=bn.get("WEBGL_lose_context");Kt&&Kt.restoreContext()},this.getPixelRatio=function(){return Vt},this.setPixelRatio=function(Kt){Kt!==void 0&&(Vt=Kt,this.setSize(sn,jt,!1))},this.getSize=function(Kt){return Kt.set(sn,jt)},this.setSize=function(Kt,Gt,zt=!0){if(Gn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}sn=Kt,jt=Gt,o.width=Math.floor(Kt*Vt),o.height=Math.floor(Gt*Vt),zt===!0&&(o.style.width=Kt+"px",o.style.height=Gt+"px"),this.setViewport(0,0,Kt,Gt)},this.getDrawingBufferSize=function(Kt){return Kt.set(sn*Vt,jt*Vt).floor()},this.setDrawingBufferSize=function(Kt,Gt,zt){sn=Kt,jt=Gt,Vt=zt,o.width=Math.floor(Kt*zt),o.height=Math.floor(Gt*zt),this.setViewport(0,0,Kt,Gt)},this.getCurrentViewport=function(Kt){return Kt.copy(Rt)},this.getViewport=function(Kt){return Kt.copy(nn)},this.setViewport=function(Kt,Gt,zt,on){Kt.isVector4?nn.set(Kt.x,Kt.y,Kt.z,Kt.w):nn.set(Kt,Gt,zt,on),Sn.viewport(Rt.copy(nn).multiplyScalar(Vt).floor())},this.getScissor=function(Kt){return Kt.copy(mn)},this.setScissor=function(Kt,Gt,zt,on){Kt.isVector4?mn.set(Kt.x,Kt.y,Kt.z,Kt.w):mn.set(Kt,Gt,zt,on),Sn.scissor(Ut.copy(mn).multiplyScalar(Vt).floor())},this.getScissorTest=function(){return Zt},this.setScissorTest=function(Kt){Sn.setScissorTest(Zt=Kt)},this.setOpaqueSort=function(Kt){Lt=Kt},this.setTransparentSort=function(Kt){Qt=Kt},this.getClearColor=function(Kt){return Kt.copy(Mn.getClearColor())},this.setClearColor=function(){Mn.setClearColor.apply(Mn,arguments)},this.getClearAlpha=function(){return Mn.getClearAlpha()},this.setClearAlpha=function(){Mn.setClearAlpha.apply(Mn,arguments)},this.clear=function(Kt=!0,Gt=!0,zt=!0){let on=0;if(Kt){let dn=!1;if(Tt!==null){const Vn=Tt.texture.format;dn=Vn===RGBAIntegerFormat||Vn===RGIntegerFormat||Vn===RedIntegerFormat}if(dn){const Vn=Tt.texture.type,Kn=Vn===UnsignedByteType||Vn===UnsignedIntType||Vn===UnsignedShortType||Vn===UnsignedInt248Type||Vn===UnsignedShort4444Type||Vn===UnsignedShort5551Type,sr=Mn.getClearColor(),ar=Mn.getClearAlpha(),cr=sr.r,ur=sr.g,wr=sr.b,Mr=Qn.get(Tt).__webglFramebuffer;Kn?(ct[0]=cr,ct[1]=ur,ct[2]=wr,ct[3]=ar,ln.clearBufferuiv(ln.COLOR,Mr,ct)):(ft[0]=cr,ft[1]=ur,ft[2]=wr,ft[3]=ar,ln.clearBufferiv(ln.COLOR,Mr,ft))}else on|=ln.COLOR_BUFFER_BIT}Gt&&(on|=ln.DEPTH_BUFFER_BIT),zt&&(on|=ln.STENCIL_BUFFER_BIT),ln.clear(on)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){o.removeEventListener("webglcontextlost",Zn,!1),o.removeEventListener("webglcontextrestored",qn,!1),o.removeEventListener("webglcontextcreationerror",vr,!1),In.dispose(),Hn.dispose(),Qn.dispose(),or.dispose(),mr.dispose(),$t.dispose(),Un.dispose(),Jn.dispose(),An.dispose(),Gn.dispose(),Gn.removeEventListener("sessionstart",Ir),Gn.removeEventListener("sessionend",Fr),fn&&(fn.dispose(),fn=null),Pr.stop()};function Zn(Kt){Kt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),gt=!0}function qn(){console.log("THREE.WebGLRenderer: Context Restored."),gt=!1;const Kt=xn.autoReset,Gt=On.enabled,zt=On.autoUpdate,on=On.needsUpdate,dn=On.type;pr(),xn.autoReset=Kt,On.enabled=Gt,On.autoUpdate=zt,On.needsUpdate=on,On.type=dn}function vr(Kt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Kt.statusMessage)}function _r(Kt){const Gt=Kt.target;Gt.removeEventListener("dispose",_r),$r(Gt)}function $r(Kt){es(Kt),Qn.remove(Kt)}function es(Kt){const Gt=Qn.get(Kt).programs;Gt!==void 0&&(Gt.forEach(function(zt){An.releaseProgram(zt)}),Kt.isShaderMaterial&&An.releaseShaderCache(Kt))}this.renderBufferDirect=function(Kt,Gt,zt,on,dn,Vn){Gt===null&&(Gt=Pn);const Kn=dn.isMesh&&dn.matrixWorld.determinant()<0,sr=Do(Kt,Gt,zt,on,dn);Sn.setMaterial(on,Kn);let ar=zt.index,cr=1;on.wireframe===!0&&(ar=tn.getWireframeAttribute(zt),cr=2);const ur=zt.drawRange,wr=zt.attributes.position;let Mr=ur.start*cr,Rr=(ur.start+ur.count)*cr;Vn!==null&&(Mr=Math.max(Mr,Vn.start*cr),Rr=Math.min(Rr,(Vn.start+Vn.count)*cr)),ar!==null?(Mr=Math.max(Mr,0),Rr=Math.min(Rr,ar.count)):wr!=null&&(Mr=Math.max(Mr,0),Rr=Math.min(Rr,wr.count));const cs=Rr-Mr;if(cs<0||cs===1/0)return;Un.setup(dn,on,sr,zt,ar);let ps,us=gr;if(ar!==null&&(ps=$n.get(ar),us=Cr,us.setIndex(ps)),dn.isMesh)on.wireframe===!0?(Sn.setLineWidth(on.wireframeLinewidth*Dn()),us.setMode(ln.LINES)):us.setMode(ln.TRIANGLES);else if(dn.isLine){let Kr=on.linewidth;Kr===void 0&&(Kr=1),Sn.setLineWidth(Kr*Dn()),dn.isLineSegments?us.setMode(ln.LINES):dn.isLineLoop?us.setMode(ln.LINE_LOOP):us.setMode(ln.LINE_STRIP)}else dn.isPoints?us.setMode(ln.POINTS):dn.isSprite&&us.setMode(ln.TRIANGLES);if(dn.isInstancedMesh)us.renderInstances(Mr,cs,dn.count);else if(zt.isInstancedBufferGeometry){const Kr=zt._maxInstanceCount!==void 0?zt._maxInstanceCount:1/0,As=Math.min(zt.instanceCount,Kr);us.renderInstances(Mr,cs,As)}else us.render(Mr,cs)},this.compile=function(Kt,Gt){function zt(on,dn,Vn){on.transparent===!0&&on.side===DoubleSide&&on.forceSinglePass===!1?(on.side=BackSide,on.needsUpdate=!0,Ks(on,dn,Vn),on.side=FrontSide,on.needsUpdate=!0,Ks(on,dn,Vn),on.side=DoubleSide):Ks(on,dn,Vn)}mt=Hn.get(Kt),mt.init(),ut.push(mt),Kt.traverseVisible(function(on){on.isLight&&on.layers.test(Gt.layers)&&(mt.pushLight(on),on.castShadow&&mt.pushShadow(on))}),mt.setupLights(dt.useLegacyLights),Kt.traverse(function(on){const dn=on.material;if(dn)if(Array.isArray(dn))for(let Vn=0;Vn<dn.length;Vn++){const Kn=dn[Vn];zt(Kn,Kt,on)}else zt(dn,Kt,on)}),ut.pop(),mt=null};let Hr=null;function Ur(Kt){Hr&&Hr(Kt)}function Ir(){Pr.stop()}function Fr(){Pr.start()}const Pr=new WebGLAnimation;Pr.setAnimationLoop(Ur),typeof self<"u"&&Pr.setContext(self),this.setAnimationLoop=function(Kt){Hr=Kt,Gn.setAnimationLoop(Kt),Kt===null?Pr.stop():Pr.start()},Gn.addEventListener("sessionstart",Ir),Gn.addEventListener("sessionend",Fr),this.render=function(Kt,Gt){if(Gt!==void 0&&Gt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(gt===!0)return;Kt.matrixWorldAutoUpdate===!0&&Kt.updateMatrixWorld(),Gt.parent===null&&Gt.matrixWorldAutoUpdate===!0&&Gt.updateMatrixWorld(),Gn.enabled===!0&&Gn.isPresenting===!0&&(Gt=Gn.updateCameraXR(Gt)),Kt.isScene===!0&&Kt.onBeforeRender(dt,Kt,Gt,Tt),mt=Hn.get(Kt,ut.length),mt.init(),ut.push(mt),hn.multiplyMatrices(Gt.projectionMatrix,Gt.matrixWorldInverse),cn.setFromProjectionMatrix(hn),rn=this.localClippingEnabled,Ot=yn.init(this.clippingPlanes,rn),ht=In.get(Kt,lt.length),ht.init(),lt.push(ht),Jr(Kt,Gt,0,dt.sortObjects),ht.finish(),dt.sortObjects===!0&&ht.sort(Lt,Qt),Ot===!0&&yn.beginShadows();const zt=mt.state.shadowsArray;if(On.render(zt,Kt,Gt),Ot===!0&&yn.endShadows(),this.info.autoReset===!0&&this.info.reset(),this.info.render.frame++,Mn.render(ht,Kt),mt.setupLights(dt.useLegacyLights),Gt.isArrayCamera){const on=Gt.cameras;for(let dn=0,Vn=on.length;dn<Vn;dn++){const Kn=on[dn];zs(ht,Kt,Kn,Kn.viewport)}}else zs(ht,Kt,Gt);Tt!==null&&(nr.updateMultisampleRenderTarget(Tt),nr.updateRenderTargetMipmap(Tt)),Kt.isScene===!0&&Kt.onAfterRender(dt,Kt,Gt),Un.resetDefaultState(),Mt=-1,Bt=null,ut.pop(),ut.length>0?mt=ut[ut.length-1]:mt=null,lt.pop(),lt.length>0?ht=lt[lt.length-1]:ht=null};function Jr(Kt,Gt,zt,on){if(Kt.visible===!1)return;if(Kt.layers.test(Gt.layers)){if(Kt.isGroup)zt=Kt.renderOrder;else if(Kt.isLOD)Kt.autoUpdate===!0&&Kt.update(Gt);else if(Kt.isLight)mt.pushLight(Kt),Kt.castShadow&&mt.pushShadow(Kt);else if(Kt.isSprite){if(!Kt.frustumCulled||cn.intersectsSprite(Kt)){on&&Nn.setFromMatrixPosition(Kt.matrixWorld).applyMatrix4(hn);const Kn=$t.update(Kt),sr=Kt.material;sr.visible&&ht.push(Kt,Kn,sr,zt,Nn.z,null)}}else if((Kt.isMesh||Kt.isLine||Kt.isPoints)&&(!Kt.frustumCulled||cn.intersectsObject(Kt))){Kt.isSkinnedMesh&&Kt.skeleton.frame!==xn.render.frame&&(Kt.skeleton.update(),Kt.skeleton.frame=xn.render.frame);const Kn=$t.update(Kt),sr=Kt.material;if(on&&(Kt.boundingSphere!==void 0?(Kt.boundingSphere===null&&Kt.computeBoundingSphere(),Nn.copy(Kt.boundingSphere.center)):(Kn.boundingSphere===null&&Kn.computeBoundingSphere(),Nn.copy(Kn.boundingSphere.center)),Nn.applyMatrix4(Kt.matrixWorld).applyMatrix4(hn)),Array.isArray(sr)){const ar=Kn.groups;for(let cr=0,ur=ar.length;cr<ur;cr++){const wr=ar[cr],Mr=sr[wr.materialIndex];Mr&&Mr.visible&&ht.push(Kt,Kn,Mr,zt,Nn.z,wr)}}else sr.visible&&ht.push(Kt,Kn,sr,zt,Nn.z,null)}}const Vn=Kt.children;for(let Kn=0,sr=Vn.length;Kn<sr;Kn++)Jr(Vn[Kn],Gt,zt,on)}function zs(Kt,Gt,zt,on){const dn=Kt.opaque,Vn=Kt.transmissive,Kn=Kt.transparent;mt.setupLightsView(zt),Ot===!0&&yn.setGlobalState(dt.clippingPlanes,zt),Vn.length>0&&Ws(dn,Vn,Gt,zt),on&&Sn.viewport(Rt.copy(on)),dn.length>0&&Js(dn,Gt,zt),Vn.length>0&&Js(Vn,Gt,zt),Kn.length>0&&Js(Kn,Gt,zt),Sn.buffers.depth.setTest(!0),Sn.buffers.depth.setMask(!0),Sn.buffers.color.setMask(!0),Sn.setPolygonOffset(!1)}function Ws(Kt,Gt,zt,on){const dn=kn.isWebGL2;fn===null&&(fn=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:bn.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:dn&&nt===!0?4:0})),dt.getDrawingBufferSize(Tn),dn?fn.setSize(Tn.x,Tn.y):fn.setSize(floorPowerOfTwo(Tn.x),floorPowerOfTwo(Tn.y));const Vn=dt.getRenderTarget();dt.setRenderTarget(fn),dt.getClearColor(Wt),Jt=dt.getClearAlpha(),Jt<1&&dt.setClearColor(16777215,.5),dt.clear();const Kn=dt.toneMapping;dt.toneMapping=NoToneMapping,Js(Kt,zt,on),nr.updateMultisampleRenderTarget(fn),nr.updateRenderTargetMipmap(fn);let sr=!1;for(let ar=0,cr=Gt.length;ar<cr;ar++){const ur=Gt[ar],wr=ur.object,Mr=ur.geometry,Rr=ur.material,cs=ur.group;if(Rr.side===DoubleSide&&wr.layers.test(on.layers)){const ps=Rr.side;Rr.side=BackSide,Rr.needsUpdate=!0,ao(wr,zt,on,Mr,Rr,cs),Rr.side=ps,Rr.needsUpdate=!0,sr=!0}}sr===!0&&(nr.updateMultisampleRenderTarget(fn),nr.updateRenderTargetMipmap(fn)),dt.setRenderTarget(Vn),dt.setClearColor(Wt,Jt),dt.toneMapping=Kn}function Js(Kt,Gt,zt){const on=Gt.isScene===!0?Gt.overrideMaterial:null;for(let dn=0,Vn=Kt.length;dn<Vn;dn++){const Kn=Kt[dn],sr=Kn.object,ar=Kn.geometry,cr=on===null?Kn.material:on,ur=Kn.group;sr.layers.test(zt.layers)&&ao(sr,Gt,zt,ar,cr,ur)}}function ao(Kt,Gt,zt,on,dn,Vn){Kt.onBeforeRender(dt,Gt,zt,on,dn,Vn),Kt.modelViewMatrix.multiplyMatrices(zt.matrixWorldInverse,Kt.matrixWorld),Kt.normalMatrix.getNormalMatrix(Kt.modelViewMatrix),dn.onBeforeRender(dt,Gt,zt,on,Kt,Vn),dn.transparent===!0&&dn.side===DoubleSide&&dn.forceSinglePass===!1?(dn.side=BackSide,dn.needsUpdate=!0,dt.renderBufferDirect(zt,Gt,on,dn,Kt,Vn),dn.side=FrontSide,dn.needsUpdate=!0,dt.renderBufferDirect(zt,Gt,on,dn,Kt,Vn),dn.side=DoubleSide):dt.renderBufferDirect(zt,Gt,on,dn,Kt,Vn),Kt.onAfterRender(dt,Gt,zt,on,dn,Vn)}function Ks(Kt,Gt,zt){Gt.isScene!==!0&&(Gt=Pn);const on=Qn.get(Kt),dn=mt.state.lights,Vn=mt.state.shadowsArray,Kn=dn.state.version,sr=An.getParameters(Kt,dn.state,Vn,Gt,zt),ar=An.getProgramCacheKey(sr);let cr=on.programs;on.environment=Kt.isMeshStandardMaterial?Gt.environment:null,on.fog=Gt.fog,on.envMap=(Kt.isMeshStandardMaterial?mr:or).get(Kt.envMap||on.environment),cr===void 0&&(Kt.addEventListener("dispose",_r),cr=new Map,on.programs=cr);let ur=cr.get(ar);if(ur!==void 0){if(on.currentProgram===ur&&on.lightsStateVersion===Kn)return Es(Kt,sr),ur}else sr.uniforms=An.getUniforms(Kt),Kt.onBuild(zt,sr,dt),Kt.onBeforeCompile(sr,dt),ur=An.acquireProgram(sr,ar),cr.set(ar,ur),on.uniforms=sr.uniforms;const wr=on.uniforms;(!Kt.isShaderMaterial&&!Kt.isRawShaderMaterial||Kt.clipping===!0)&&(wr.clippingPlanes=yn.uniform),Es(Kt,sr),on.needsLights=pn(Kt),on.lightsStateVersion=Kn,on.needsLights&&(wr.ambientLightColor.value=dn.state.ambient,wr.lightProbe.value=dn.state.probe,wr.directionalLights.value=dn.state.directional,wr.directionalLightShadows.value=dn.state.directionalShadow,wr.spotLights.value=dn.state.spot,wr.spotLightShadows.value=dn.state.spotShadow,wr.rectAreaLights.value=dn.state.rectArea,wr.ltc_1.value=dn.state.rectAreaLTC1,wr.ltc_2.value=dn.state.rectAreaLTC2,wr.pointLights.value=dn.state.point,wr.pointLightShadows.value=dn.state.pointShadow,wr.hemisphereLights.value=dn.state.hemi,wr.directionalShadowMap.value=dn.state.directionalShadowMap,wr.directionalShadowMatrix.value=dn.state.directionalShadowMatrix,wr.spotShadowMap.value=dn.state.spotShadowMap,wr.spotLightMatrix.value=dn.state.spotLightMatrix,wr.spotLightMap.value=dn.state.spotLightMap,wr.pointShadowMap.value=dn.state.pointShadowMap,wr.pointShadowMatrix.value=dn.state.pointShadowMatrix);const Mr=ur.getUniforms(),Rr=WebGLUniforms.seqWithValue(Mr.seq,wr);return on.currentProgram=ur,on.uniformsList=Rr,ur}function Es(Kt,Gt){const zt=Qn.get(Kt);zt.outputColorSpace=Gt.outputColorSpace,zt.instancing=Gt.instancing,zt.skinning=Gt.skinning,zt.morphTargets=Gt.morphTargets,zt.morphNormals=Gt.morphNormals,zt.morphColors=Gt.morphColors,zt.morphTargetsCount=Gt.morphTargetsCount,zt.numClippingPlanes=Gt.numClippingPlanes,zt.numIntersection=Gt.numClipIntersection,zt.vertexAlphas=Gt.vertexAlphas,zt.vertexTangents=Gt.vertexTangents,zt.toneMapping=Gt.toneMapping}function Do(Kt,Gt,zt,on,dn){Gt.isScene!==!0&&(Gt=Pn),nr.resetTextureUnits();const Vn=Gt.fog,Kn=on.isMeshStandardMaterial?Gt.environment:null,sr=Tt===null?dt.outputColorSpace:Tt.isXRRenderTarget===!0?Tt.texture.colorSpace:LinearSRGBColorSpace,ar=(on.isMeshStandardMaterial?mr:or).get(on.envMap||Kn),cr=on.vertexColors===!0&&!!zt.attributes.color&&zt.attributes.color.itemSize===4,ur=!!zt.attributes.tangent&&(!!on.normalMap||on.anisotropy>0),wr=!!zt.morphAttributes.position,Mr=!!zt.morphAttributes.normal,Rr=!!zt.morphAttributes.color,cs=on.toneMapped?dt.toneMapping:NoToneMapping,ps=zt.morphAttributes.position||zt.morphAttributes.normal||zt.morphAttributes.color,us=ps!==void 0?ps.length:0,Kr=Qn.get(on),As=mt.state.lights;if(Ot===!0&&(rn===!0||Kt!==Bt)){const Cs=Kt===Bt&&on.id===Mt;yn.setState(on,Kt,Cs)}let ts=!1;on.version===Kr.__version?(Kr.needsLights&&Kr.lightsStateVersion!==As.state.version||Kr.outputColorSpace!==sr||dn.isInstancedMesh&&Kr.instancing===!1||!dn.isInstancedMesh&&Kr.instancing===!0||dn.isSkinnedMesh&&Kr.skinning===!1||!dn.isSkinnedMesh&&Kr.skinning===!0||Kr.envMap!==ar||on.fog===!0&&Kr.fog!==Vn||Kr.numClippingPlanes!==void 0&&(Kr.numClippingPlanes!==yn.numPlanes||Kr.numIntersection!==yn.numIntersection)||Kr.vertexAlphas!==cr||Kr.vertexTangents!==ur||Kr.morphTargets!==wr||Kr.morphNormals!==Mr||Kr.morphColors!==Rr||Kr.toneMapping!==cs||kn.isWebGL2===!0&&Kr.morphTargetsCount!==us)&&(ts=!0):(ts=!0,Kr.__version=on.version);let Ts=Kr.currentProgram;ts===!0&&(Ts=Ks(on,Gt,dn));let Us=!1,Ss=!1,$s=!1;const Hs=Ts.getUniforms(),Ys=Kr.uniforms;if(Sn.useProgram(Ts.program)&&(Us=!0,Ss=!0,$s=!0),on.id!==Mt&&(Mt=on.id,Ss=!0),Us||Bt!==Kt){if(Hs.setValue(ln,"projectionMatrix",Kt.projectionMatrix),kn.logarithmicDepthBuffer&&Hs.setValue(ln,"logDepthBufFC",2/(Math.log(Kt.far+1)/Math.LN2)),Bt!==Kt&&(Bt=Kt,Ss=!0,$s=!0),on.isShaderMaterial||on.isMeshPhongMaterial||on.isMeshToonMaterial||on.isMeshStandardMaterial||on.envMap){const Cs=Hs.map.cameraPosition;Cs!==void 0&&Cs.setValue(ln,Nn.setFromMatrixPosition(Kt.matrixWorld))}(on.isMeshPhongMaterial||on.isMeshToonMaterial||on.isMeshLambertMaterial||on.isMeshBasicMaterial||on.isMeshStandardMaterial||on.isShaderMaterial)&&Hs.setValue(ln,"isOrthographic",Kt.isOrthographicCamera===!0),(on.isMeshPhongMaterial||on.isMeshToonMaterial||on.isMeshLambertMaterial||on.isMeshBasicMaterial||on.isMeshStandardMaterial||on.isShaderMaterial||on.isShadowMaterial||dn.isSkinnedMesh)&&Hs.setValue(ln,"viewMatrix",Kt.matrixWorldInverse)}if(dn.isSkinnedMesh){Hs.setOptional(ln,dn,"bindMatrix"),Hs.setOptional(ln,dn,"bindMatrixInverse");const Cs=dn.skeleton;Cs&&(kn.floatVertexTextures?(Cs.boneTexture===null&&Cs.computeBoneTexture(),Hs.setValue(ln,"boneTexture",Cs.boneTexture,nr),Hs.setValue(ln,"boneTextureSize",Cs.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const co=zt.morphAttributes;if((co.position!==void 0||co.normal!==void 0||co.color!==void 0&&kn.isWebGL2===!0)&&tr.update(dn,zt,Ts),(Ss||Kr.receiveShadow!==dn.receiveShadow)&&(Kr.receiveShadow=dn.receiveShadow,Hs.setValue(ln,"receiveShadow",dn.receiveShadow)),on.isMeshGouraudMaterial&&on.envMap!==null&&(Ys.envMap.value=ar,Ys.flipEnvMap.value=ar.isCubeTexture&&ar.isRenderTargetTexture===!1?-1:1),Ss&&(Hs.setValue(ln,"toneMappingExposure",dt.toneMappingExposure),Kr.needsLights&&js(Ys,$s),Vn&&on.fog===!0&&En.refreshFogUniforms(Ys,Vn),En.refreshMaterialUniforms(Ys,on,Vt,jt,fn),WebGLUniforms.upload(ln,Kr.uniformsList,Ys,nr)),on.isShaderMaterial&&on.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(ln,Kr.uniformsList,Ys,nr),on.uniformsNeedUpdate=!1),on.isSpriteMaterial&&Hs.setValue(ln,"center",dn.center),Hs.setValue(ln,"modelViewMatrix",dn.modelViewMatrix),Hs.setValue(ln,"normalMatrix",dn.normalMatrix),Hs.setValue(ln,"modelMatrix",dn.matrixWorld),on.isShaderMaterial||on.isRawShaderMaterial){const Cs=on.uniformsGroups;for(let Ps=0,Ns=Cs.length;Ps<Ns;Ps++)if(kn.isWebGL2){const Gs=Cs[Ps];Jn.update(Gs,Ts),Jn.bind(Gs,Ts)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ts}function js(Kt,Gt){Kt.ambientLightColor.needsUpdate=Gt,Kt.lightProbe.needsUpdate=Gt,Kt.directionalLights.needsUpdate=Gt,Kt.directionalLightShadows.needsUpdate=Gt,Kt.pointLights.needsUpdate=Gt,Kt.pointLightShadows.needsUpdate=Gt,Kt.spotLights.needsUpdate=Gt,Kt.spotLightShadows.needsUpdate=Gt,Kt.rectAreaLights.needsUpdate=Gt,Kt.hemisphereLights.needsUpdate=Gt}function pn(Kt){return Kt.isMeshLambertMaterial||Kt.isMeshToonMaterial||Kt.isMeshPhongMaterial||Kt.isMeshStandardMaterial||Kt.isShadowMaterial||Kt.isShaderMaterial&&Kt.lights===!0}this.getActiveCubeFace=function(){return Et},this.getActiveMipmapLevel=function(){return St},this.getRenderTarget=function(){return Tt},this.setRenderTargetTextures=function(Kt,Gt,zt){Qn.get(Kt.texture).__webglTexture=Gt,Qn.get(Kt.depthTexture).__webglTexture=zt;const on=Qn.get(Kt);on.__hasExternalTextures=!0,on.__hasExternalTextures&&(on.__autoAllocateDepthBuffer=zt===void 0,on.__autoAllocateDepthBuffer||bn.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),on.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Kt,Gt){const zt=Qn.get(Kt);zt.__webglFramebuffer=Gt,zt.__useDefaultFramebuffer=Gt===void 0},this.setRenderTarget=function(Kt,Gt=0,zt=0){Tt=Kt,Et=Gt,St=zt;let on=!0,dn=null,Vn=!1,Kn=!1;if(Kt){const ar=Qn.get(Kt);ar.__useDefaultFramebuffer!==void 0?(Sn.bindFramebuffer(ln.FRAMEBUFFER,null),on=!1):ar.__webglFramebuffer===void 0?nr.setupRenderTarget(Kt):ar.__hasExternalTextures&&nr.rebindTextures(Kt,Qn.get(Kt.texture).__webglTexture,Qn.get(Kt.depthTexture).__webglTexture);const cr=Kt.texture;(cr.isData3DTexture||cr.isDataArrayTexture||cr.isCompressedArrayTexture)&&(Kn=!0);const ur=Qn.get(Kt).__webglFramebuffer;Kt.isWebGLCubeRenderTarget?(dn=ur[Gt],Vn=!0):kn.isWebGL2&&Kt.samples>0&&nr.useMultisampledRTT(Kt)===!1?dn=Qn.get(Kt).__webglMultisampledFramebuffer:dn=ur,Rt.copy(Kt.viewport),Ut.copy(Kt.scissor),Ht=Kt.scissorTest}else Rt.copy(nn).multiplyScalar(Vt).floor(),Ut.copy(mn).multiplyScalar(Vt).floor(),Ht=Zt;if(Sn.bindFramebuffer(ln.FRAMEBUFFER,dn)&&kn.drawBuffers&&on&&Sn.drawBuffers(Kt,dn),Sn.viewport(Rt),Sn.scissor(Ut),Sn.setScissorTest(Ht),Vn){const ar=Qn.get(Kt.texture);ln.framebufferTexture2D(ln.FRAMEBUFFER,ln.COLOR_ATTACHMENT0,ln.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,ar.__webglTexture,zt)}else if(Kn){const ar=Qn.get(Kt.texture),cr=Gt||0;ln.framebufferTextureLayer(ln.FRAMEBUFFER,ln.COLOR_ATTACHMENT0,ar.__webglTexture,zt||0,cr)}Mt=-1},this.readRenderTargetPixels=function(Kt,Gt,zt,on,dn,Vn,Kn){if(!(Kt&&Kt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let sr=Qn.get(Kt).__webglFramebuffer;if(Kt.isWebGLCubeRenderTarget&&Kn!==void 0&&(sr=sr[Kn]),sr){Sn.bindFramebuffer(ln.FRAMEBUFFER,sr);try{const ar=Kt.texture,cr=ar.format,ur=ar.type;if(cr!==RGBAFormat&&Sr.convert(cr)!==ln.getParameter(ln.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const wr=ur===HalfFloatType&&(bn.has("EXT_color_buffer_half_float")||kn.isWebGL2&&bn.has("EXT_color_buffer_float"));if(ur!==UnsignedByteType&&Sr.convert(ur)!==ln.getParameter(ln.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ur===FloatType&&(kn.isWebGL2||bn.has("OES_texture_float")||bn.has("WEBGL_color_buffer_float")))&&!wr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Gt>=0&&Gt<=Kt.width-on&&zt>=0&&zt<=Kt.height-dn&&ln.readPixels(Gt,zt,on,dn,Sr.convert(cr),Sr.convert(ur),Vn)}finally{const ar=Tt!==null?Qn.get(Tt).__webglFramebuffer:null;Sn.bindFramebuffer(ln.FRAMEBUFFER,ar)}}},this.copyFramebufferToTexture=function(Kt,Gt,zt=0){const on=Math.pow(2,-zt),dn=Math.floor(Gt.image.width*on),Vn=Math.floor(Gt.image.height*on);nr.setTexture2D(Gt,0),ln.copyTexSubImage2D(ln.TEXTURE_2D,zt,0,0,Kt.x,Kt.y,dn,Vn),Sn.unbindTexture()},this.copyTextureToTexture=function(Kt,Gt,zt,on=0){const dn=Gt.image.width,Vn=Gt.image.height,Kn=Sr.convert(zt.format),sr=Sr.convert(zt.type);nr.setTexture2D(zt,0),ln.pixelStorei(ln.UNPACK_FLIP_Y_WEBGL,zt.flipY),ln.pixelStorei(ln.UNPACK_PREMULTIPLY_ALPHA_WEBGL,zt.premultiplyAlpha),ln.pixelStorei(ln.UNPACK_ALIGNMENT,zt.unpackAlignment),Gt.isDataTexture?ln.texSubImage2D(ln.TEXTURE_2D,on,Kt.x,Kt.y,dn,Vn,Kn,sr,Gt.image.data):Gt.isCompressedTexture?ln.compressedTexSubImage2D(ln.TEXTURE_2D,on,Kt.x,Kt.y,Gt.mipmaps[0].width,Gt.mipmaps[0].height,Kn,Gt.mipmaps[0].data):ln.texSubImage2D(ln.TEXTURE_2D,on,Kt.x,Kt.y,Kn,sr,Gt.image),on===0&&zt.generateMipmaps&&ln.generateMipmap(ln.TEXTURE_2D),Sn.unbindTexture()},this.copyTextureToTexture3D=function(Kt,Gt,zt,on,dn=0){if(dt.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Vn=Kt.max.x-Kt.min.x+1,Kn=Kt.max.y-Kt.min.y+1,sr=Kt.max.z-Kt.min.z+1,ar=Sr.convert(on.format),cr=Sr.convert(on.type);let ur;if(on.isData3DTexture)nr.setTexture3D(on,0),ur=ln.TEXTURE_3D;else if(on.isDataArrayTexture)nr.setTexture2DArray(on,0),ur=ln.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ln.pixelStorei(ln.UNPACK_FLIP_Y_WEBGL,on.flipY),ln.pixelStorei(ln.UNPACK_PREMULTIPLY_ALPHA_WEBGL,on.premultiplyAlpha),ln.pixelStorei(ln.UNPACK_ALIGNMENT,on.unpackAlignment);const wr=ln.getParameter(ln.UNPACK_ROW_LENGTH),Mr=ln.getParameter(ln.UNPACK_IMAGE_HEIGHT),Rr=ln.getParameter(ln.UNPACK_SKIP_PIXELS),cs=ln.getParameter(ln.UNPACK_SKIP_ROWS),ps=ln.getParameter(ln.UNPACK_SKIP_IMAGES),us=zt.isCompressedTexture?zt.mipmaps[0]:zt.image;ln.pixelStorei(ln.UNPACK_ROW_LENGTH,us.width),ln.pixelStorei(ln.UNPACK_IMAGE_HEIGHT,us.height),ln.pixelStorei(ln.UNPACK_SKIP_PIXELS,Kt.min.x),ln.pixelStorei(ln.UNPACK_SKIP_ROWS,Kt.min.y),ln.pixelStorei(ln.UNPACK_SKIP_IMAGES,Kt.min.z),zt.isDataTexture||zt.isData3DTexture?ln.texSubImage3D(ur,dn,Gt.x,Gt.y,Gt.z,Vn,Kn,sr,ar,cr,us.data):zt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ln.compressedTexSubImage3D(ur,dn,Gt.x,Gt.y,Gt.z,Vn,Kn,sr,ar,us.data)):ln.texSubImage3D(ur,dn,Gt.x,Gt.y,Gt.z,Vn,Kn,sr,ar,cr,us),ln.pixelStorei(ln.UNPACK_ROW_LENGTH,wr),ln.pixelStorei(ln.UNPACK_IMAGE_HEIGHT,Mr),ln.pixelStorei(ln.UNPACK_SKIP_PIXELS,Rr),ln.pixelStorei(ln.UNPACK_SKIP_ROWS,cs),ln.pixelStorei(ln.UNPACK_SKIP_IMAGES,ps),dn===0&&on.generateMipmaps&&ln.generateMipmap(ur),Sn.unbindTexture()},this.initTexture=function(Kt){Kt.isCubeTexture?nr.setTextureCube(Kt,0):Kt.isData3DTexture?nr.setTexture3D(Kt,0):Kt.isDataArrayTexture||Kt.isCompressedArrayTexture?nr.setTexture2DArray(Kt,0):nr.setTexture2D(Kt,0),Sn.unbindTexture()},this.resetState=function(){Et=0,St=0,Tt=null,Sn.reset(),Un.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(s){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!s}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set outputEncoding(s){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=s===sRGBEncoding?SRGBColorSpace:LinearSRGBColorSpace}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(s,o=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color(s),this.density=o}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Fog{constructor(s,o=1,j=1e3){this.isFog=!0,this.name="",this.color=new Color(s),this.near=o,this.far=j}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(s,o){return super.copy(s,o),s.background!==null&&(this.background=s.background.clone()),s.environment!==null&&(this.environment=s.environment.clone()),s.fog!==null&&(this.fog=s.fog.clone()),this.backgroundBlurriness=s.backgroundBlurriness,this.backgroundIntensity=s.backgroundIntensity,s.overrideMaterial!==null&&(this.overrideMaterial=s.overrideMaterial.clone()),this.matrixAutoUpdate=s.matrixAutoUpdate,this}toJSON(s){const o=super.toJSON(s);return this.fog!==null&&(o.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(o.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(o.object.backgroundIntensity=this.backgroundIntensity),o}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(s){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=s}}class InterleavedBuffer{constructor(s,o){this.isInterleavedBuffer=!0,this.array=s,this.stride=o,this.count=s!==void 0?s.length/o:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(s){s===!0&&this.version++}setUsage(s){return this.usage=s,this}copy(s){return this.array=new s.array.constructor(s.array),this.count=s.count,this.stride=s.stride,this.usage=s.usage,this}copyAt(s,o,j){s*=this.stride,j*=o.stride;for(let $=0,_e=this.stride;$<_e;$++)this.array[s+$]=o.array[j+$];return this}set(s,o=0){return this.array.set(s,o),this}clone(s){s.arrayBuffers===void 0&&(s.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),s.arrayBuffers[this.array.buffer._uuid]===void 0&&(s.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const o=new this.array.constructor(s.arrayBuffers[this.array.buffer._uuid]),j=new this.constructor(o,this.stride);return j.setUsage(this.usage),j}onUpload(s){return this.onUploadCallback=s,this}toJSON(s){return s.arrayBuffers===void 0&&(s.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),s.arrayBuffers[this.array.buffer._uuid]===void 0&&(s.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$5=new Vector3;class InterleavedBufferAttribute{constructor(s,o,j,$=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=s,this.itemSize=o,this.offset=j,this.normalized=$}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(s){this.data.needsUpdate=s}applyMatrix4(s){for(let o=0,j=this.data.count;o<j;o++)_vector$5.fromBufferAttribute(this,o),_vector$5.applyMatrix4(s),this.setXYZ(o,_vector$5.x,_vector$5.y,_vector$5.z);return this}applyNormalMatrix(s){for(let o=0,j=this.count;o<j;o++)_vector$5.fromBufferAttribute(this,o),_vector$5.applyNormalMatrix(s),this.setXYZ(o,_vector$5.x,_vector$5.y,_vector$5.z);return this}transformDirection(s){for(let o=0,j=this.count;o<j;o++)_vector$5.fromBufferAttribute(this,o),_vector$5.transformDirection(s),this.setXYZ(o,_vector$5.x,_vector$5.y,_vector$5.z);return this}setX(s,o){return this.normalized&&(o=normalize(o,this.array)),this.data.array[s*this.data.stride+this.offset]=o,this}setY(s,o){return this.normalized&&(o=normalize(o,this.array)),this.data.array[s*this.data.stride+this.offset+1]=o,this}setZ(s,o){return this.normalized&&(o=normalize(o,this.array)),this.data.array[s*this.data.stride+this.offset+2]=o,this}setW(s,o){return this.normalized&&(o=normalize(o,this.array)),this.data.array[s*this.data.stride+this.offset+3]=o,this}getX(s){let o=this.data.array[s*this.data.stride+this.offset];return this.normalized&&(o=denormalize(o,this.array)),o}getY(s){let o=this.data.array[s*this.data.stride+this.offset+1];return this.normalized&&(o=denormalize(o,this.array)),o}getZ(s){let o=this.data.array[s*this.data.stride+this.offset+2];return this.normalized&&(o=denormalize(o,this.array)),o}getW(s){let o=this.data.array[s*this.data.stride+this.offset+3];return this.normalized&&(o=denormalize(o,this.array)),o}setXY(s,o,j){return s=s*this.data.stride+this.offset,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array)),this.data.array[s+0]=o,this.data.array[s+1]=j,this}setXYZ(s,o,j,$){return s=s*this.data.stride+this.offset,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array)),this.data.array[s+0]=o,this.data.array[s+1]=j,this.data.array[s+2]=$,this}setXYZW(s,o,j,$,_e){return s=s*this.data.stride+this.offset,this.normalized&&(o=normalize(o,this.array),j=normalize(j,this.array),$=normalize($,this.array),_e=normalize(_e,this.array)),this.data.array[s+0]=o,this.data.array[s+1]=j,this.data.array[s+2]=$,this.data.array[s+3]=_e,this}clone(s){if(s===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const o=[];for(let j=0;j<this.count;j++){const $=j*this.data.stride+this.offset;for(let _e=0;_e<this.itemSize;_e++)o.push(this.data.array[$+_e])}return new BufferAttribute(new this.array.constructor(o),this.itemSize,this.normalized)}else return s.interleavedBuffers===void 0&&(s.interleavedBuffers={}),s.interleavedBuffers[this.data.uuid]===void 0&&(s.interleavedBuffers[this.data.uuid]=this.data.clone(s)),new InterleavedBufferAttribute(s.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(s){if(s===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const o=[];for(let j=0;j<this.count;j++){const $=j*this.data.stride+this.offset;for(let _e=0;_e<this.itemSize;_e++)o.push(this.data.array[$+_e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:o,normalized:this.normalized}}else return s.interleavedBuffers===void 0&&(s.interleavedBuffers={}),s.interleavedBuffers[this.data.uuid]===void 0&&(s.interleavedBuffers[this.data.uuid]=this.data.toJSON(s)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(s){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.rotation=s.rotation,this.sizeAttenuation=s.sizeAttenuation,this.fog=s.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$2=new Vector3,_vB$2=new Vector3,_vC$2=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(s){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const o=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),j=new InterleavedBuffer(o,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(j,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(j,2,3,!1))}this.geometry=_geometry,this.material=s!==void 0?s:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(s,o){s.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(s.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(s.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),s.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const j=this.material.rotation;let $,_e;j!==0&&(_e=Math.cos(j),$=Math.sin(j));const tt=this.center;transformVertex(_vA$2.set(-.5,-.5,0),_mvPosition,tt,_worldScale,$,_e),transformVertex(_vB$2.set(.5,-.5,0),_mvPosition,tt,_worldScale,$,_e),transformVertex(_vC$2.set(.5,.5,0),_mvPosition,tt,_worldScale,$,_e),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let nt=s.ray.intersectTriangle(_vA$2,_vB$2,_vC$2,!1,_intersectPoint);if(nt===null&&(transformVertex(_vB$2.set(-.5,.5,0),_mvPosition,tt,_worldScale,$,_e),_uvB.set(0,1),nt=s.ray.intersectTriangle(_vA$2,_vC$2,_vB$2,!1,_intersectPoint),nt===null))return;const rt=s.ray.origin.distanceTo(_intersectPoint);rt<s.near||rt>s.far||o.push({distance:rt,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA$2,_vB$2,_vC$2,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(s,o){return super.copy(s,o),s.center!==void 0&&this.center.copy(s.center),this.material=s.material,this}}function transformVertex(a,s,o,j,$,_e){_alignedPosition.subVectors(a,o).addScalar(.5).multiply(j),$!==void 0?(_rotatedPosition.x=_e*_alignedPosition.x-$*_alignedPosition.y,_rotatedPosition.y=$*_alignedPosition.x+_e*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),a.copy(s),a.x+=_rotatedPosition.x,a.y+=_rotatedPosition.y,a.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(s){super.copy(s,!1);const o=s.levels;for(let j=0,$=o.length;j<$;j++){const _e=o[j];this.addLevel(_e.object.clone(),_e.distance,_e.hysteresis)}return this.autoUpdate=s.autoUpdate,this}addLevel(s,o=0,j=0){o=Math.abs(o);const $=this.levels;let _e;for(_e=0;_e<$.length&&!(o<$[_e].distance);_e++);return $.splice(_e,0,{distance:o,hysteresis:j,object:s}),this.add(s),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(s){const o=this.levels;if(o.length>0){let j,$;for(j=1,$=o.length;j<$;j++){let _e=o[j].distance;if(o[j].object.visible&&(_e-=_e*o[j].hysteresis),s<_e)break}return o[j-1].object}return null}raycast(s,o){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const $=s.ray.origin.distanceTo(_v1$2);this.getObjectForDistance($).raycast(s,o)}}update(s){const o=this.levels;if(o.length>1){_v1$2.setFromMatrixPosition(s.matrixWorld),_v2$1$1.setFromMatrixPosition(this.matrixWorld);const j=_v1$2.distanceTo(_v2$1$1)/s.zoom;o[0].object.visible=!0;let $,_e;for($=1,_e=o.length;$<_e;$++){let tt=o[$].distance;if(o[$].object.visible&&(tt-=tt*o[$].hysteresis),j>=tt)o[$-1].object.visible=!1,o[$].object.visible=!0;else break}for(this._currentLevel=$-1;$<_e;$++)o[$].object.visible=!1}}toJSON(s){const o=super.toJSON(s);this.autoUpdate===!1&&(o.object.autoUpdate=!1),o.object.levels=[];const j=this.levels;for(let $=0,_e=j.length;$<_e;$++){const tt=j[$];o.object.levels.push({object:tt.object.uuid,distance:tt.distance,hysteresis:tt.hysteresis})}return o}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$3=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2$1=new Ray;class SkinnedMesh extends Mesh{constructor(s,o){super(s,o),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const s=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const o=s.getAttribute("position");for(let j=0;j<o.count;j++)_vertex.fromBufferAttribute(o,j),this.applyBoneTransform(j,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const s=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const o=s.getAttribute("position");for(let j=0;j<o.count;j++)_vertex.fromBufferAttribute(o,j),this.applyBoneTransform(j,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(s,o){return super.copy(s,o),this.bindMode=s.bindMode,this.bindMatrix.copy(s.bindMatrix),this.bindMatrixInverse.copy(s.bindMatrixInverse),this.skeleton=s.skeleton,s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone()),s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),this}raycast(s,o){const j=this.material,$=this.matrixWorld;j!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4($),s.ray.intersectsSphere(_sphere$3)!==!1&&(_inverseMatrix$2.copy($).invert(),_ray$2$1.copy(s.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2$1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(s,o,_ray$2$1)))}getVertexPosition(s,o){return super.getVertexPosition(s,o),this.applyBoneTransform(s,o),o}bind(s,o){this.skeleton=s,o===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.copy(o).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const s=new Vector4,o=this.geometry.attributes.skinWeight;for(let j=0,$=o.count;j<$;j++){s.fromBufferAttribute(o,j);const _e=1/s.manhattanLength();_e!==1/0?s.multiplyScalar(_e):s.set(1,0,0,0),o.setXYZW(j,s.x,s.y,s.z,s.w)}}updateMatrixWorld(s){super.updateMatrixWorld(s),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(s,o){const j=this.skeleton,$=this.geometry;_skinIndex.fromBufferAttribute($.attributes.skinIndex,s),_skinWeight.fromBufferAttribute($.attributes.skinWeight,s),_basePosition.copy(o).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let _e=0;_e<4;_e++){const tt=_skinWeight.getComponent(_e);if(tt!==0){const nt=_skinIndex.getComponent(_e);_matrix4.multiplyMatrices(j.bones[nt].matrixWorld,j.boneInverses[nt]),o.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),tt)}}return o.applyMatrix4(this.bindMatrixInverse)}boneTransform(s,o){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(s,o)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(s=null,o=1,j=1,$,_e,tt,nt,rt,it=NearestFilter,st=NearestFilter,at,ot){super(null,tt,nt,rt,it,st,$,_e,at,ot),this.isDataTexture=!0,this.image={data:s,width:o,height:j},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(s=[],o=[]){this.uuid=generateUUID(),this.bones=s.slice(0),this.boneInverses=o,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const s=this.bones,o=this.boneInverses;if(this.boneMatrices=new Float32Array(s.length*16),o.length===0)this.calculateInverses();else if(s.length!==o.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let j=0,$=this.bones.length;j<$;j++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let s=0,o=this.bones.length;s<o;s++){const j=new Matrix4;this.bones[s]&&j.copy(this.bones[s].matrixWorld).invert(),this.boneInverses.push(j)}}pose(){for(let s=0,o=this.bones.length;s<o;s++){const j=this.bones[s];j&&j.matrixWorld.copy(this.boneInverses[s]).invert()}for(let s=0,o=this.bones.length;s<o;s++){const j=this.bones[s];j&&(j.parent&&j.parent.isBone?(j.matrix.copy(j.parent.matrixWorld).invert(),j.matrix.multiply(j.matrixWorld)):j.matrix.copy(j.matrixWorld),j.matrix.decompose(j.position,j.quaternion,j.scale))}}update(){const s=this.bones,o=this.boneInverses,j=this.boneMatrices,$=this.boneTexture;for(let _e=0,tt=s.length;_e<tt;_e++){const nt=s[_e]?s[_e].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(nt,o[_e]),_offsetMatrix.toArray(j,_e*16)}$!==null&&($.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let s=Math.sqrt(this.bones.length*4);s=ceilPowerOfTwo(s),s=Math.max(s,4);const o=new Float32Array(s*s*4);o.set(this.boneMatrices);const j=new DataTexture(o,s,s,RGBAFormat,FloatType);return j.needsUpdate=!0,this.boneMatrices=o,this.boneTexture=j,this.boneTextureSize=s,this}getBoneByName(s){for(let o=0,j=this.bones.length;o<j;o++){const $=this.bones[o];if($.name===s)return $}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(s,o){this.uuid=s.uuid;for(let j=0,$=s.bones.length;j<$;j++){const _e=s.bones[j];let tt=o[_e];tt===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",_e),tt=new Bone),this.bones.push(tt),this.boneInverses.push(new Matrix4().fromArray(s.boneInverses[j]))}return this.init(),this}toJSON(){const s={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};s.uuid=this.uuid;const o=this.bones,j=this.boneInverses;for(let $=0,_e=o.length;$<_e;$++){const tt=o[$];s.bones.push(tt.uuid);const nt=j[$];s.boneInverses.push(nt.toArray())}return s}}class InstancedBufferAttribute extends BufferAttribute{constructor(s,o,j,$=1){super(s,o,j),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=$}copy(s){return super.copy(s),this.meshPerAttribute=s.meshPerAttribute,this}toJSON(){const s=super.toJSON();return s.meshPerAttribute=this.meshPerAttribute,s.isInstancedBufferAttribute=!0,s}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh=new Mesh,_sphere$2=new Sphere;class InstancedMesh extends Mesh{constructor(s,o,j){super(s,o),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(j*16),16),this.instanceColor=null,this.count=j,this.boundingBox=null,this.boundingSphere=null;for(let $=0;$<j;$++)this.setMatrixAt($,_identity)}computeBoundingBox(){const s=this.geometry,o=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),s.boundingBox===null&&s.computeBoundingBox(),this.boundingBox.makeEmpty();for(let j=0;j<o;j++)this.getMatrixAt(j,_instanceLocalMatrix),_box3.copy(s.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const s=this.geometry,o=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),s.boundingSphere===null&&s.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let j=0;j<o;j++)this.getMatrixAt(j,_instanceLocalMatrix),_sphere$2.copy(s.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$2)}copy(s,o){return super.copy(s,o),this.instanceMatrix.copy(s.instanceMatrix),s.instanceColor!==null&&(this.instanceColor=s.instanceColor.clone()),this.count=s.count,s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone()),s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),this}getColorAt(s,o){o.fromArray(this.instanceColor.array,s*3)}getMatrixAt(s,o){o.fromArray(this.instanceMatrix.array,s*16)}raycast(s,o){const j=this.matrixWorld,$=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,_mesh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$2.copy(this.boundingSphere),_sphere$2.applyMatrix4(j),s.ray.intersectsSphere(_sphere$2)!==!1))for(let _e=0;_e<$;_e++){this.getMatrixAt(_e,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(j,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast(s,_instanceIntersects);for(let tt=0,nt=_instanceIntersects.length;tt<nt;tt++){const rt=_instanceIntersects[tt];rt.instanceId=_e,rt.object=this,o.push(rt)}_instanceIntersects.length=0}}setColorAt(s,o){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),o.toArray(this.instanceColor.array,s*3)}setMatrixAt(s,o){o.toArray(this.instanceMatrix.array,s*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class LineBasicMaterial extends Material{constructor(s){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.linewidth=s.linewidth,this.linecap=s.linecap,this.linejoin=s.linejoin,this.fog=s.fog,this}}const _start$1$1=new Vector3,_end$1$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1$1=new Ray,_sphere$1=new Sphere;class Line extends Object3D{constructor(s=new BufferGeometry,o=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=s,this.material=o,this.updateMorphTargets()}copy(s,o){return super.copy(s,o),this.material=s.material,this.geometry=s.geometry,this}computeLineDistances(){const s=this.geometry;if(s.index===null){const o=s.attributes.position,j=[0];for(let $=1,_e=o.count;$<_e;$++)_start$1$1.fromBufferAttribute(o,$-1),_end$1$1.fromBufferAttribute(o,$),j[$]=j[$-1],j[$]+=_start$1$1.distanceTo(_end$1$1);s.setAttribute("lineDistance",new Float32BufferAttribute(j,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(s,o){const j=this.geometry,$=this.matrixWorld,_e=s.params.Line.threshold,tt=j.drawRange;if(j.boundingSphere===null&&j.computeBoundingSphere(),_sphere$1.copy(j.boundingSphere),_sphere$1.applyMatrix4($),_sphere$1.radius+=_e,s.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy($).invert(),_ray$1$1.copy(s.ray).applyMatrix4(_inverseMatrix$1);const nt=_e/((this.scale.x+this.scale.y+this.scale.z)/3),rt=nt*nt,it=new Vector3,st=new Vector3,at=new Vector3,ot=new Vector3,ct=this.isLineSegments?2:1,ft=j.index,mt=j.attributes.position;if(ft!==null){const lt=Math.max(0,tt.start),ut=Math.min(ft.count,tt.start+tt.count);for(let dt=lt,gt=ut-1;dt<gt;dt+=ct){const Et=ft.getX(dt),St=ft.getX(dt+1);if(it.fromBufferAttribute(mt,Et),st.fromBufferAttribute(mt,St),_ray$1$1.distanceSqToSegment(it,st,ot,at)>rt)continue;ot.applyMatrix4(this.matrixWorld);const Mt=s.ray.origin.distanceTo(ot);Mt<s.near||Mt>s.far||o.push({distance:Mt,point:at.clone().applyMatrix4(this.matrixWorld),index:dt,face:null,faceIndex:null,object:this})}}else{const lt=Math.max(0,tt.start),ut=Math.min(mt.count,tt.start+tt.count);for(let dt=lt,gt=ut-1;dt<gt;dt+=ct){if(it.fromBufferAttribute(mt,dt),st.fromBufferAttribute(mt,dt+1),_ray$1$1.distanceSqToSegment(it,st,ot,at)>rt)continue;ot.applyMatrix4(this.matrixWorld);const St=s.ray.origin.distanceTo(ot);St<s.near||St>s.far||o.push({distance:St,point:at.clone().applyMatrix4(this.matrixWorld),index:dt,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const o=this.geometry.morphAttributes,j=Object.keys(o);if(j.length>0){const $=o[j[0]];if($!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _e=0,tt=$.length;_e<tt;_e++){const nt=$[_e].name||String(_e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[nt]=_e}}}}}const _start$2=new Vector3,_end$2=new Vector3;class LineSegments extends Line{constructor(s,o){super(s,o),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const s=this.geometry;if(s.index===null){const o=s.attributes.position,j=[];for(let $=0,_e=o.count;$<_e;$+=2)_start$2.fromBufferAttribute(o,$),_end$2.fromBufferAttribute(o,$+1),j[$]=$===0?0:j[$-1],j[$+1]=j[$]+_start$2.distanceTo(_end$2);s.setAttribute("lineDistance",new Float32BufferAttribute(j,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(s,o){super(s,o),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(s){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.size=s.size,this.sizeAttenuation=s.sizeAttenuation,this.fog=s.fog,this}}const _inverseMatrix=new Matrix4,_ray$4=new Ray,_sphere$6=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(s=new BufferGeometry,o=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=s,this.material=o,this.updateMorphTargets()}copy(s,o){return super.copy(s,o),this.material=s.material,this.geometry=s.geometry,this}raycast(s,o){const j=this.geometry,$=this.matrixWorld,_e=s.params.Points.threshold,tt=j.drawRange;if(j.boundingSphere===null&&j.computeBoundingSphere(),_sphere$6.copy(j.boundingSphere),_sphere$6.applyMatrix4($),_sphere$6.radius+=_e,s.ray.intersectsSphere(_sphere$6)===!1)return;_inverseMatrix.copy($).invert(),_ray$4.copy(s.ray).applyMatrix4(_inverseMatrix);const nt=_e/((this.scale.x+this.scale.y+this.scale.z)/3),rt=nt*nt,it=j.index,at=j.attributes.position;if(it!==null){const ot=Math.max(0,tt.start),ct=Math.min(it.count,tt.start+tt.count);for(let ft=ot,ht=ct;ft<ht;ft++){const mt=it.getX(ft);_position$2.fromBufferAttribute(at,mt),testPoint(_position$2,mt,rt,$,s,o,this)}}else{const ot=Math.max(0,tt.start),ct=Math.min(at.count,tt.start+tt.count);for(let ft=ot,ht=ct;ft<ht;ft++)_position$2.fromBufferAttribute(at,ft),testPoint(_position$2,ft,rt,$,s,o,this)}}updateMorphTargets(){const o=this.geometry.morphAttributes,j=Object.keys(o);if(j.length>0){const $=o[j[0]];if($!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let _e=0,tt=$.length;_e<tt;_e++){const nt=$[_e].name||String(_e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[nt]=_e}}}}}function testPoint(a,s,o,j,$,_e,tt){const nt=_ray$4.distanceSqToPoint(a);if(nt<o){const rt=new Vector3;_ray$4.closestPointToPoint(a,rt),rt.applyMatrix4(j);const it=$.ray.origin.distanceTo(rt);if(it<$.near||it>$.far)return;_e.push({distance:it,distanceToRay:Math.sqrt(nt),point:rt,index:s,face:null,object:tt})}}class VideoTexture extends Texture{constructor(s,o,j,$,_e,tt,nt,rt,it){super(s,o,j,$,_e,tt,nt,rt,it),this.isVideoTexture=!0,this.minFilter=tt!==void 0?tt:LinearFilter,this.magFilter=_e!==void 0?_e:LinearFilter,this.generateMipmaps=!1;const st=this;function at(){st.needsUpdate=!0,s.requestVideoFrameCallback(at)}"requestVideoFrameCallback"in s&&s.requestVideoFrameCallback(at)}clone(){return new this.constructor(this.image).copy(this)}update(){const s=this.image;"requestVideoFrameCallback"in s===!1&&s.readyState>=s.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(s,o){super({width:s,height:o}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(s,o,j,$,_e,tt,nt,rt,it,st,at,ot){super(null,tt,nt,rt,it,st,$,_e,at,ot),this.isCompressedTexture=!0,this.image={width:o,height:j},this.mipmaps=s,this.flipY=!1,this.generateMipmaps=!1}}let CompressedArrayTexture$1=class extends CompressedTexture{constructor(s,o,j,$,_e,tt){super(s,o,j,_e,tt),this.isCompressedArrayTexture=!0,this.image.depth=$,this.wrapR=ClampToEdgeWrapping}};class CanvasTexture extends Texture{constructor(s,o,j,$,_e,tt,nt,rt,it){super(s,o,j,$,_e,tt,nt,rt,it),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(s,o){const j=this.getUtoTmapping(s);return this.getPoint(j,o)}getPoints(s=5){const o=[];for(let j=0;j<=s;j++)o.push(this.getPoint(j/s));return o}getSpacedPoints(s=5){const o=[];for(let j=0;j<=s;j++)o.push(this.getPointAt(j/s));return o}getLength(){const s=this.getLengths();return s[s.length-1]}getLengths(s=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===s+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const o=[];let j,$=this.getPoint(0),_e=0;o.push(0);for(let tt=1;tt<=s;tt++)j=this.getPoint(tt/s),_e+=j.distanceTo($),o.push(_e),$=j;return this.cacheArcLengths=o,o}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(s,o){const j=this.getLengths();let $=0;const _e=j.length;let tt;o?tt=o:tt=s*j[_e-1];let nt=0,rt=_e-1,it;for(;nt<=rt;)if($=Math.floor(nt+(rt-nt)/2),it=j[$]-tt,it<0)nt=$+1;else if(it>0)rt=$-1;else{rt=$;break}if($=rt,j[$]===tt)return $/(_e-1);const st=j[$],ot=j[$+1]-st,ct=(tt-st)/ot;return($+ct)/(_e-1)}getTangent(s,o){let $=s-1e-4,_e=s+1e-4;$<0&&($=0),_e>1&&(_e=1);const tt=this.getPoint($),nt=this.getPoint(_e),rt=o||(tt.isVector2?new Vector2:new Vector3);return rt.copy(nt).sub(tt).normalize(),rt}getTangentAt(s,o){const j=this.getUtoTmapping(s);return this.getTangent(j,o)}computeFrenetFrames(s,o){const j=new Vector3,$=[],_e=[],tt=[],nt=new Vector3,rt=new Matrix4;for(let ct=0;ct<=s;ct++){const ft=ct/s;$[ct]=this.getTangentAt(ft,new Vector3)}_e[0]=new Vector3,tt[0]=new Vector3;let it=Number.MAX_VALUE;const st=Math.abs($[0].x),at=Math.abs($[0].y),ot=Math.abs($[0].z);st<=it&&(it=st,j.set(1,0,0)),at<=it&&(it=at,j.set(0,1,0)),ot<=it&&j.set(0,0,1),nt.crossVectors($[0],j).normalize(),_e[0].crossVectors($[0],nt),tt[0].crossVectors($[0],_e[0]);for(let ct=1;ct<=s;ct++){if(_e[ct]=_e[ct-1].clone(),tt[ct]=tt[ct-1].clone(),nt.crossVectors($[ct-1],$[ct]),nt.length()>Number.EPSILON){nt.normalize();const ft=Math.acos(clamp$2($[ct-1].dot($[ct]),-1,1));_e[ct].applyMatrix4(rt.makeRotationAxis(nt,ft))}tt[ct].crossVectors($[ct],_e[ct])}if(o===!0){let ct=Math.acos(clamp$2(_e[0].dot(_e[s]),-1,1));ct/=s,$[0].dot(nt.crossVectors(_e[0],_e[s]))>0&&(ct=-ct);for(let ft=1;ft<=s;ft++)_e[ft].applyMatrix4(rt.makeRotationAxis($[ft],ct*ft)),tt[ft].crossVectors($[ft],_e[ft])}return{tangents:$,normals:_e,binormals:tt}}clone(){return new this.constructor().copy(this)}copy(s){return this.arcLengthDivisions=s.arcLengthDivisions,this}toJSON(){const s={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return s.arcLengthDivisions=this.arcLengthDivisions,s.type=this.type,s}fromJSON(s){return this.arcLengthDivisions=s.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(s=0,o=0,j=1,$=1,_e=0,tt=Math.PI*2,nt=!1,rt=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=s,this.aY=o,this.xRadius=j,this.yRadius=$,this.aStartAngle=_e,this.aEndAngle=tt,this.aClockwise=nt,this.aRotation=rt}getPoint(s,o){const j=o||new Vector2,$=Math.PI*2;let _e=this.aEndAngle-this.aStartAngle;const tt=Math.abs(_e)<Number.EPSILON;for(;_e<0;)_e+=$;for(;_e>$;)_e-=$;_e<Number.EPSILON&&(tt?_e=0:_e=$),this.aClockwise===!0&&!tt&&(_e===$?_e=-$:_e=_e-$);const nt=this.aStartAngle+s*_e;let rt=this.aX+this.xRadius*Math.cos(nt),it=this.aY+this.yRadius*Math.sin(nt);if(this.aRotation!==0){const st=Math.cos(this.aRotation),at=Math.sin(this.aRotation),ot=rt-this.aX,ct=it-this.aY;rt=ot*st-ct*at+this.aX,it=ot*at+ct*st+this.aY}return j.set(rt,it)}copy(s){return super.copy(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}toJSON(){const s=super.toJSON();return s.aX=this.aX,s.aY=this.aY,s.xRadius=this.xRadius,s.yRadius=this.yRadius,s.aStartAngle=this.aStartAngle,s.aEndAngle=this.aEndAngle,s.aClockwise=this.aClockwise,s.aRotation=this.aRotation,s}fromJSON(s){return super.fromJSON(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(s,o,j,$,_e,tt){super(s,o,j,j,$,_e,tt),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let a=0,s=0,o=0,j=0;function $(_e,tt,nt,rt){a=_e,s=nt,o=-3*_e+3*tt-2*nt-rt,j=2*_e-2*tt+nt+rt}return{initCatmullRom:function(_e,tt,nt,rt,it){$(tt,nt,it*(nt-_e),it*(rt-tt))},initNonuniformCatmullRom:function(_e,tt,nt,rt,it,st,at){let ot=(tt-_e)/it-(nt-_e)/(it+st)+(nt-tt)/st,ct=(nt-tt)/st-(rt-tt)/(st+at)+(rt-nt)/at;ot*=st,ct*=st,$(tt,nt,ot,ct)},calc:function(_e){const tt=_e*_e,nt=tt*_e;return a+s*_e+o*tt+j*nt}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(s=[],o=!1,j="centripetal",$=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=s,this.closed=o,this.curveType=j,this.tension=$}getPoint(s,o=new Vector3){const j=o,$=this.points,_e=$.length,tt=(_e-(this.closed?0:1))*s;let nt=Math.floor(tt),rt=tt-nt;this.closed?nt+=nt>0?0:(Math.floor(Math.abs(nt)/_e)+1)*_e:rt===0&&nt===_e-1&&(nt=_e-2,rt=1);let it,st;this.closed||nt>0?it=$[(nt-1)%_e]:(tmp.subVectors($[0],$[1]).add($[0]),it=tmp);const at=$[nt%_e],ot=$[(nt+1)%_e];if(this.closed||nt+2<_e?st=$[(nt+2)%_e]:(tmp.subVectors($[_e-1],$[_e-2]).add($[_e-1]),st=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ct=this.curveType==="chordal"?.5:.25;let ft=Math.pow(it.distanceToSquared(at),ct),ht=Math.pow(at.distanceToSquared(ot),ct),mt=Math.pow(ot.distanceToSquared(st),ct);ht<1e-4&&(ht=1),ft<1e-4&&(ft=ht),mt<1e-4&&(mt=ht),px.initNonuniformCatmullRom(it.x,at.x,ot.x,st.x,ft,ht,mt),py.initNonuniformCatmullRom(it.y,at.y,ot.y,st.y,ft,ht,mt),pz.initNonuniformCatmullRom(it.z,at.z,ot.z,st.z,ft,ht,mt)}else this.curveType==="catmullrom"&&(px.initCatmullRom(it.x,at.x,ot.x,st.x,this.tension),py.initCatmullRom(it.y,at.y,ot.y,st.y,this.tension),pz.initCatmullRom(it.z,at.z,ot.z,st.z,this.tension));return j.set(px.calc(rt),py.calc(rt),pz.calc(rt)),j}copy(s){super.copy(s),this.points=[];for(let o=0,j=s.points.length;o<j;o++){const $=s.points[o];this.points.push($.clone())}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}toJSON(){const s=super.toJSON();s.points=[];for(let o=0,j=this.points.length;o<j;o++){const $=this.points[o];s.points.push($.toArray())}return s.closed=this.closed,s.curveType=this.curveType,s.tension=this.tension,s}fromJSON(s){super.fromJSON(s),this.points=[];for(let o=0,j=s.points.length;o<j;o++){const $=s.points[o];this.points.push(new Vector3().fromArray($))}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}}function CatmullRom(a,s,o,j,$){const _e=(j-s)*.5,tt=($-o)*.5,nt=a*a,rt=a*nt;return(2*o-2*j+_e+tt)*rt+(-3*o+3*j-2*_e-tt)*nt+_e*a+o}function QuadraticBezierP0(a,s){const o=1-a;return o*o*s}function QuadraticBezierP1(a,s){return 2*(1-a)*a*s}function QuadraticBezierP2(a,s){return a*a*s}function QuadraticBezier(a,s,o,j){return QuadraticBezierP0(a,s)+QuadraticBezierP1(a,o)+QuadraticBezierP2(a,j)}function CubicBezierP0(a,s){const o=1-a;return o*o*o*s}function CubicBezierP1(a,s){const o=1-a;return 3*o*o*a*s}function CubicBezierP2(a,s){return 3*(1-a)*a*a*s}function CubicBezierP3(a,s){return a*a*a*s}function CubicBezier(a,s,o,j,$){return CubicBezierP0(a,s)+CubicBezierP1(a,o)+CubicBezierP2(a,j)+CubicBezierP3(a,$)}class CubicBezierCurve extends Curve{constructor(s=new Vector2,o=new Vector2,j=new Vector2,$=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=s,this.v1=o,this.v2=j,this.v3=$}getPoint(s,o=new Vector2){const j=o,$=this.v0,_e=this.v1,tt=this.v2,nt=this.v3;return j.set(CubicBezier(s,$.x,_e.x,tt.x,nt.x),CubicBezier(s,$.y,_e.y,tt.y,nt.y)),j}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}class CubicBezierCurve3 extends Curve{constructor(s=new Vector3,o=new Vector3,j=new Vector3,$=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=s,this.v1=o,this.v2=j,this.v3=$}getPoint(s,o=new Vector3){const j=o,$=this.v0,_e=this.v1,tt=this.v2,nt=this.v3;return j.set(CubicBezier(s,$.x,_e.x,tt.x,nt.x),CubicBezier(s,$.y,_e.y,tt.y,nt.y),CubicBezier(s,$.z,_e.z,tt.z,nt.z)),j}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}class LineCurve extends Curve{constructor(s=new Vector2,o=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=s,this.v2=o}getPoint(s,o=new Vector2){const j=o;return s===1?j.copy(this.v2):(j.copy(this.v2).sub(this.v1),j.multiplyScalar(s).add(this.v1)),j}getPointAt(s,o){return this.getPoint(s,o)}getTangent(s,o=new Vector2){return o.subVectors(this.v2,this.v1).normalize()}getTangentAt(s,o){return this.getTangent(s,o)}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class LineCurve3 extends Curve{constructor(s=new Vector3,o=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=s,this.v2=o}getPoint(s,o=new Vector3){const j=o;return s===1?j.copy(this.v2):(j.copy(this.v2).sub(this.v1),j.multiplyScalar(s).add(this.v1)),j}getPointAt(s,o){return this.getPoint(s,o)}getTangent(s,o=new Vector3){return o.subVectors(this.v2,this.v1).normalize()}getTangentAt(s,o){return this.getTangent(s,o)}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class QuadraticBezierCurve extends Curve{constructor(s=new Vector2,o=new Vector2,j=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=s,this.v1=o,this.v2=j}getPoint(s,o=new Vector2){const j=o,$=this.v0,_e=this.v1,tt=this.v2;return j.set(QuadraticBezier(s,$.x,_e.x,tt.x),QuadraticBezier(s,$.y,_e.y,tt.y)),j}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(s=new Vector3,o=new Vector3,j=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=s,this.v1=o,this.v2=j}getPoint(s,o=new Vector3){const j=o,$=this.v0,_e=this.v1,tt=this.v2;return j.set(QuadraticBezier(s,$.x,_e.x,tt.x),QuadraticBezier(s,$.y,_e.y,tt.y),QuadraticBezier(s,$.z,_e.z,tt.z)),j}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class SplineCurve extends Curve{constructor(s=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=s}getPoint(s,o=new Vector2){const j=o,$=this.points,_e=($.length-1)*s,tt=Math.floor(_e),nt=_e-tt,rt=$[tt===0?tt:tt-1],it=$[tt],st=$[tt>$.length-2?$.length-1:tt+1],at=$[tt>$.length-3?$.length-1:tt+2];return j.set(CatmullRom(nt,rt.x,it.x,st.x,at.x),CatmullRom(nt,rt.y,it.y,st.y,at.y)),j}copy(s){super.copy(s),this.points=[];for(let o=0,j=s.points.length;o<j;o++){const $=s.points[o];this.points.push($.clone())}return this}toJSON(){const s=super.toJSON();s.points=[];for(let o=0,j=this.points.length;o<j;o++){const $=this.points[o];s.points.push($.toArray())}return s}fromJSON(s){super.fromJSON(s),this.points=[];for(let o=0,j=s.points.length;o<j;o++){const $=s.points[o];this.points.push(new Vector2().fromArray($))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(s){this.curves.push(s)}closePath(){const s=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);s.equals(o)||this.curves.push(new LineCurve(o,s))}getPoint(s,o){const j=s*this.getLength(),$=this.getCurveLengths();let _e=0;for(;_e<$.length;){if($[_e]>=j){const tt=$[_e]-j,nt=this.curves[_e],rt=nt.getLength(),it=rt===0?0:1-tt/rt;return nt.getPointAt(it,o)}_e++}return null}getLength(){const s=this.getCurveLengths();return s[s.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const s=[];let o=0;for(let j=0,$=this.curves.length;j<$;j++)o+=this.curves[j].getLength(),s.push(o);return this.cacheLengths=s,s}getSpacedPoints(s=40){const o=[];for(let j=0;j<=s;j++)o.push(this.getPoint(j/s));return this.autoClose&&o.push(o[0]),o}getPoints(s=12){const o=[];let j;for(let $=0,_e=this.curves;$<_e.length;$++){const tt=_e[$],nt=tt.isEllipseCurve?s*2:tt.isLineCurve||tt.isLineCurve3?1:tt.isSplineCurve?s*tt.points.length:s,rt=tt.getPoints(nt);for(let it=0;it<rt.length;it++){const st=rt[it];j&&j.equals(st)||(o.push(st),j=st)}}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o}copy(s){super.copy(s),this.curves=[];for(let o=0,j=s.curves.length;o<j;o++){const $=s.curves[o];this.curves.push($.clone())}return this.autoClose=s.autoClose,this}toJSON(){const s=super.toJSON();s.autoClose=this.autoClose,s.curves=[];for(let o=0,j=this.curves.length;o<j;o++){const $=this.curves[o];s.curves.push($.toJSON())}return s}fromJSON(s){super.fromJSON(s),this.autoClose=s.autoClose,this.curves=[];for(let o=0,j=s.curves.length;o<j;o++){const $=s.curves[o];this.curves.push(new Curves[$.type]().fromJSON($))}return this}}class Path extends CurvePath{constructor(s){super(),this.type="Path",this.currentPoint=new Vector2,s&&this.setFromPoints(s)}setFromPoints(s){this.moveTo(s[0].x,s[0].y);for(let o=1,j=s.length;o<j;o++)this.lineTo(s[o].x,s[o].y);return this}moveTo(s,o){return this.currentPoint.set(s,o),this}lineTo(s,o){const j=new LineCurve(this.currentPoint.clone(),new Vector2(s,o));return this.curves.push(j),this.currentPoint.set(s,o),this}quadraticCurveTo(s,o,j,$){const _e=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(s,o),new Vector2(j,$));return this.curves.push(_e),this.currentPoint.set(j,$),this}bezierCurveTo(s,o,j,$,_e,tt){const nt=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(s,o),new Vector2(j,$),new Vector2(_e,tt));return this.curves.push(nt),this.currentPoint.set(_e,tt),this}splineThru(s){const o=[this.currentPoint.clone()].concat(s),j=new SplineCurve(o);return this.curves.push(j),this.currentPoint.copy(s[s.length-1]),this}arc(s,o,j,$,_e,tt){const nt=this.currentPoint.x,rt=this.currentPoint.y;return this.absarc(s+nt,o+rt,j,$,_e,tt),this}absarc(s,o,j,$,_e,tt){return this.absellipse(s,o,j,j,$,_e,tt),this}ellipse(s,o,j,$,_e,tt,nt,rt){const it=this.currentPoint.x,st=this.currentPoint.y;return this.absellipse(s+it,o+st,j,$,_e,tt,nt,rt),this}absellipse(s,o,j,$,_e,tt,nt,rt){const it=new EllipseCurve(s,o,j,$,_e,tt,nt,rt);if(this.curves.length>0){const at=it.getPoint(0);at.equals(this.currentPoint)||this.lineTo(at.x,at.y)}this.curves.push(it);const st=it.getPoint(1);return this.currentPoint.copy(st),this}copy(s){return super.copy(s),this.currentPoint.copy(s.currentPoint),this}toJSON(){const s=super.toJSON();return s.currentPoint=this.currentPoint.toArray(),s}fromJSON(s){return super.fromJSON(s),this.currentPoint.fromArray(s.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(s=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],o=12,j=0,$=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:s,segments:o,phiStart:j,phiLength:$},o=Math.floor(o),$=clamp$2($,0,Math.PI*2);const _e=[],tt=[],nt=[],rt=[],it=[],st=1/o,at=new Vector3,ot=new Vector2,ct=new Vector3,ft=new Vector3,ht=new Vector3;let mt=0,lt=0;for(let ut=0;ut<=s.length-1;ut++)switch(ut){case 0:mt=s[ut+1].x-s[ut].x,lt=s[ut+1].y-s[ut].y,ct.x=lt*1,ct.y=-mt,ct.z=lt*0,ht.copy(ct),ct.normalize(),rt.push(ct.x,ct.y,ct.z);break;case s.length-1:rt.push(ht.x,ht.y,ht.z);break;default:mt=s[ut+1].x-s[ut].x,lt=s[ut+1].y-s[ut].y,ct.x=lt*1,ct.y=-mt,ct.z=lt*0,ft.copy(ct),ct.x+=ht.x,ct.y+=ht.y,ct.z+=ht.z,ct.normalize(),rt.push(ct.x,ct.y,ct.z),ht.copy(ft)}for(let ut=0;ut<=o;ut++){const dt=j+ut*st*$,gt=Math.sin(dt),Et=Math.cos(dt);for(let St=0;St<=s.length-1;St++){at.x=s[St].x*gt,at.y=s[St].y,at.z=s[St].x*Et,tt.push(at.x,at.y,at.z),ot.x=ut/o,ot.y=St/(s.length-1),nt.push(ot.x,ot.y);const Tt=rt[3*St+0]*gt,Mt=rt[3*St+1],Bt=rt[3*St+0]*Et;it.push(Tt,Mt,Bt)}}for(let ut=0;ut<o;ut++)for(let dt=0;dt<s.length-1;dt++){const gt=dt+ut*s.length,Et=gt,St=gt+s.length,Tt=gt+s.length+1,Mt=gt+1;_e.push(Et,St,Mt),_e.push(Tt,Mt,St)}this.setIndex(_e),this.setAttribute("position",new Float32BufferAttribute(tt,3)),this.setAttribute("uv",new Float32BufferAttribute(nt,2)),this.setAttribute("normal",new Float32BufferAttribute(it,3))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new LatheGeometry(s.points,s.segments,s.phiStart,s.phiLength)}}let CapsuleGeometry$1=class zA extends LatheGeometry{constructor(s=1,o=1,j=4,$=8){const _e=new Path;_e.absarc(0,-o/2,s,Math.PI*1.5,0),_e.absarc(0,o/2,s,0,Math.PI*.5),super(_e.getPoints(j),$),this.type="CapsuleGeometry",this.parameters={radius:s,height:o,capSegments:j,radialSegments:$}}static fromJSON(s){return new zA(s.radius,s.length,s.capSegments,s.radialSegments)}};class CircleGeometry extends BufferGeometry{constructor(s=1,o=32,j=0,$=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:s,segments:o,thetaStart:j,thetaLength:$},o=Math.max(3,o);const _e=[],tt=[],nt=[],rt=[],it=new Vector3,st=new Vector2;tt.push(0,0,0),nt.push(0,0,1),rt.push(.5,.5);for(let at=0,ot=3;at<=o;at++,ot+=3){const ct=j+at/o*$;it.x=s*Math.cos(ct),it.y=s*Math.sin(ct),tt.push(it.x,it.y,it.z),nt.push(0,0,1),st.x=(tt[ot]/s+1)/2,st.y=(tt[ot+1]/s+1)/2,rt.push(st.x,st.y)}for(let at=1;at<=o;at++)_e.push(at,at+1,0);this.setIndex(_e),this.setAttribute("position",new Float32BufferAttribute(tt,3)),this.setAttribute("normal",new Float32BufferAttribute(nt,3)),this.setAttribute("uv",new Float32BufferAttribute(rt,2))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new CircleGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(s=1,o=1,j=1,$=32,_e=1,tt=!1,nt=0,rt=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:s,radiusBottom:o,height:j,radialSegments:$,heightSegments:_e,openEnded:tt,thetaStart:nt,thetaLength:rt};const it=this;$=Math.floor($),_e=Math.floor(_e);const st=[],at=[],ot=[],ct=[];let ft=0;const ht=[],mt=j/2;let lt=0;ut(),tt===!1&&(s>0&&dt(!0),o>0&&dt(!1)),this.setIndex(st),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(ot,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2));function ut(){const gt=new Vector3,Et=new Vector3;let St=0;const Tt=(o-s)/j;for(let Mt=0;Mt<=_e;Mt++){const Bt=[],Rt=Mt/_e,Ut=Rt*(o-s)+s;for(let Ht=0;Ht<=$;Ht++){const Wt=Ht/$,Jt=Wt*rt+nt,sn=Math.sin(Jt),jt=Math.cos(Jt);Et.x=Ut*sn,Et.y=-Rt*j+mt,Et.z=Ut*jt,at.push(Et.x,Et.y,Et.z),gt.set(sn,Tt,jt).normalize(),ot.push(gt.x,gt.y,gt.z),ct.push(Wt,1-Rt),Bt.push(ft++)}ht.push(Bt)}for(let Mt=0;Mt<$;Mt++)for(let Bt=0;Bt<_e;Bt++){const Rt=ht[Bt][Mt],Ut=ht[Bt+1][Mt],Ht=ht[Bt+1][Mt+1],Wt=ht[Bt][Mt+1];st.push(Rt,Ut,Wt),st.push(Ut,Ht,Wt),St+=6}it.addGroup(lt,St,0),lt+=St}function dt(gt){const Et=ft,St=new Vector2,Tt=new Vector3;let Mt=0;const Bt=gt===!0?s:o,Rt=gt===!0?1:-1;for(let Ht=1;Ht<=$;Ht++)at.push(0,mt*Rt,0),ot.push(0,Rt,0),ct.push(.5,.5),ft++;const Ut=ft;for(let Ht=0;Ht<=$;Ht++){const Jt=Ht/$*rt+nt,sn=Math.cos(Jt),jt=Math.sin(Jt);Tt.x=Bt*jt,Tt.y=mt*Rt,Tt.z=Bt*sn,at.push(Tt.x,Tt.y,Tt.z),ot.push(0,Rt,0),St.x=sn*.5+.5,St.y=jt*.5*Rt+.5,ct.push(St.x,St.y),ft++}for(let Ht=0;Ht<$;Ht++){const Wt=Et+Ht,Jt=Ut+Ht;gt===!0?st.push(Jt,Jt+1,Wt):st.push(Jt+1,Jt,Wt),Mt+=3}it.addGroup(lt,Mt,gt===!0?1:2),lt+=Mt}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(s=1,o=1,j=32,$=1,_e=!1,tt=0,nt=Math.PI*2){super(0,s,o,j,$,_e,tt,nt),this.type="ConeGeometry",this.parameters={radius:s,height:o,radialSegments:j,heightSegments:$,openEnded:_e,thetaStart:tt,thetaLength:nt}}static fromJSON(s){return new ConeGeometry(s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(s=[],o=[],j=1,$=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:s,indices:o,radius:j,detail:$};const _e=[],tt=[];nt($),it(j),st(),this.setAttribute("position",new Float32BufferAttribute(_e,3)),this.setAttribute("normal",new Float32BufferAttribute(_e.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(tt,2)),$===0?this.computeVertexNormals():this.normalizeNormals();function nt(ut){const dt=new Vector3,gt=new Vector3,Et=new Vector3;for(let St=0;St<o.length;St+=3)ct(o[St+0],dt),ct(o[St+1],gt),ct(o[St+2],Et),rt(dt,gt,Et,ut)}function rt(ut,dt,gt,Et){const St=Et+1,Tt=[];for(let Mt=0;Mt<=St;Mt++){Tt[Mt]=[];const Bt=ut.clone().lerp(gt,Mt/St),Rt=dt.clone().lerp(gt,Mt/St),Ut=St-Mt;for(let Ht=0;Ht<=Ut;Ht++)Ht===0&&Mt===St?Tt[Mt][Ht]=Bt:Tt[Mt][Ht]=Bt.clone().lerp(Rt,Ht/Ut)}for(let Mt=0;Mt<St;Mt++)for(let Bt=0;Bt<2*(St-Mt)-1;Bt++){const Rt=Math.floor(Bt/2);Bt%2===0?(ot(Tt[Mt][Rt+1]),ot(Tt[Mt+1][Rt]),ot(Tt[Mt][Rt])):(ot(Tt[Mt][Rt+1]),ot(Tt[Mt+1][Rt+1]),ot(Tt[Mt+1][Rt]))}}function it(ut){const dt=new Vector3;for(let gt=0;gt<_e.length;gt+=3)dt.x=_e[gt+0],dt.y=_e[gt+1],dt.z=_e[gt+2],dt.normalize().multiplyScalar(ut),_e[gt+0]=dt.x,_e[gt+1]=dt.y,_e[gt+2]=dt.z}function st(){const ut=new Vector3;for(let dt=0;dt<_e.length;dt+=3){ut.x=_e[dt+0],ut.y=_e[dt+1],ut.z=_e[dt+2];const gt=mt(ut)/2/Math.PI+.5,Et=lt(ut)/Math.PI+.5;tt.push(gt,1-Et)}ft(),at()}function at(){for(let ut=0;ut<tt.length;ut+=6){const dt=tt[ut+0],gt=tt[ut+2],Et=tt[ut+4],St=Math.max(dt,gt,Et),Tt=Math.min(dt,gt,Et);St>.9&&Tt<.1&&(dt<.2&&(tt[ut+0]+=1),gt<.2&&(tt[ut+2]+=1),Et<.2&&(tt[ut+4]+=1))}}function ot(ut){_e.push(ut.x,ut.y,ut.z)}function ct(ut,dt){const gt=ut*3;dt.x=s[gt+0],dt.y=s[gt+1],dt.z=s[gt+2]}function ft(){const ut=new Vector3,dt=new Vector3,gt=new Vector3,Et=new Vector3,St=new Vector2,Tt=new Vector2,Mt=new Vector2;for(let Bt=0,Rt=0;Bt<_e.length;Bt+=9,Rt+=6){ut.set(_e[Bt+0],_e[Bt+1],_e[Bt+2]),dt.set(_e[Bt+3],_e[Bt+4],_e[Bt+5]),gt.set(_e[Bt+6],_e[Bt+7],_e[Bt+8]),St.set(tt[Rt+0],tt[Rt+1]),Tt.set(tt[Rt+2],tt[Rt+3]),Mt.set(tt[Rt+4],tt[Rt+5]),Et.copy(ut).add(dt).add(gt).divideScalar(3);const Ut=mt(Et);ht(St,Rt+0,ut,Ut),ht(Tt,Rt+2,dt,Ut),ht(Mt,Rt+4,gt,Ut)}}function ht(ut,dt,gt,Et){Et<0&&ut.x===1&&(tt[dt]=ut.x-1),gt.x===0&&gt.z===0&&(tt[dt]=Et/2/Math.PI+.5)}function mt(ut){return Math.atan2(ut.z,-ut.x)}function lt(ut){return Math.atan2(-ut.y,Math.sqrt(ut.x*ut.x+ut.z*ut.z))}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new PolyhedronGeometry(s.vertices,s.indices,s.radius,s.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(s=1,o=0){const j=(1+Math.sqrt(5))/2,$=1/j,_e=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-$,-j,0,-$,j,0,$,-j,0,$,j,-$,-j,0,-$,j,0,$,-j,0,$,j,0,-j,0,-$,j,0,-$,-j,0,$,j,0,$],tt=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(_e,tt,s,o),this.type="DodecahedronGeometry",this.parameters={radius:s,detail:o}}static fromJSON(s){return new DodecahedronGeometry(s.radius,s.detail)}}const _v0=new Vector3,_v1$1$1=new Vector3,_normal=new Vector3,_triangle$1=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(s=null,o=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:s,thresholdAngle:o},s!==null){const $=Math.pow(10,4),_e=Math.cos(DEG2RAD*o),tt=s.getIndex(),nt=s.getAttribute("position"),rt=tt?tt.count:nt.count,it=[0,0,0],st=["a","b","c"],at=new Array(3),ot={},ct=[];for(let ft=0;ft<rt;ft+=3){tt?(it[0]=tt.getX(ft),it[1]=tt.getX(ft+1),it[2]=tt.getX(ft+2)):(it[0]=ft,it[1]=ft+1,it[2]=ft+2);const{a:ht,b:mt,c:lt}=_triangle$1;if(ht.fromBufferAttribute(nt,it[0]),mt.fromBufferAttribute(nt,it[1]),lt.fromBufferAttribute(nt,it[2]),_triangle$1.getNormal(_normal),at[0]=`${Math.round(ht.x*$)},${Math.round(ht.y*$)},${Math.round(ht.z*$)}`,at[1]=`${Math.round(mt.x*$)},${Math.round(mt.y*$)},${Math.round(mt.z*$)}`,at[2]=`${Math.round(lt.x*$)},${Math.round(lt.y*$)},${Math.round(lt.z*$)}`,!(at[0]===at[1]||at[1]===at[2]||at[2]===at[0]))for(let ut=0;ut<3;ut++){const dt=(ut+1)%3,gt=at[ut],Et=at[dt],St=_triangle$1[st[ut]],Tt=_triangle$1[st[dt]],Mt=`${gt}_${Et}`,Bt=`${Et}_${gt}`;Bt in ot&&ot[Bt]?(_normal.dot(ot[Bt].normal)<=_e&&(ct.push(St.x,St.y,St.z),ct.push(Tt.x,Tt.y,Tt.z)),ot[Bt]=null):Mt in ot||(ot[Mt]={index0:it[ut],index1:it[dt],normal:_normal.clone()})}}for(const ft in ot)if(ot[ft]){const{index0:ht,index1:mt}=ot[ft];_v0.fromBufferAttribute(nt,ht),_v1$1$1.fromBufferAttribute(nt,mt),ct.push(_v0.x,_v0.y,_v0.z),ct.push(_v1$1$1.x,_v1$1$1.y,_v1$1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ct,3))}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}}class Shape extends Path{constructor(s){super(s),this.uuid=generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(s){const o=[];for(let j=0,$=this.holes.length;j<$;j++)o[j]=this.holes[j].getPoints(s);return o}extractPoints(s){return{shape:this.getPoints(s),holes:this.getPointsHoles(s)}}copy(s){super.copy(s),this.holes=[];for(let o=0,j=s.holes.length;o<j;o++){const $=s.holes[o];this.holes.push($.clone())}return this}toJSON(){const s=super.toJSON();s.uuid=this.uuid,s.holes=[];for(let o=0,j=this.holes.length;o<j;o++){const $=this.holes[o];s.holes.push($.toJSON())}return s}fromJSON(s){super.fromJSON(s),this.uuid=s.uuid,this.holes=[];for(let o=0,j=s.holes.length;o<j;o++){const $=s.holes[o];this.holes.push(new Path().fromJSON($))}return this}}const Earcut={triangulate:function(a,s,o=2){const j=s&&s.length,$=j?s[0]*o:a.length;let _e=linkedList(a,0,$,o,!0);const tt=[];if(!_e||_e.next===_e.prev)return tt;let nt,rt,it,st,at,ot,ct;if(j&&(_e=eliminateHoles(a,s,_e,o)),a.length>80*o){nt=it=a[0],rt=st=a[1];for(let ft=o;ft<$;ft+=o)at=a[ft],ot=a[ft+1],at<nt&&(nt=at),ot<rt&&(rt=ot),at>it&&(it=at),ot>st&&(st=ot);ct=Math.max(it-nt,st-rt),ct=ct!==0?32767/ct:0}return earcutLinked(_e,tt,o,nt,rt,ct,0),tt}};function linkedList(a,s,o,j,$){let _e,tt;if($===signedArea(a,s,o,j)>0)for(_e=s;_e<o;_e+=j)tt=insertNode(_e,a[_e],a[_e+1],tt);else for(_e=o-j;_e>=s;_e-=j)tt=insertNode(_e,a[_e],a[_e+1],tt);return tt&&equals(tt,tt.next)&&(removeNode(tt),tt=tt.next),tt}function filterPoints(a,s){if(!a)return a;s||(s=a);let o=a,j;do if(j=!1,!o.steiner&&(equals(o,o.next)||area(o.prev,o,o.next)===0)){if(removeNode(o),o=s=o.prev,o===o.next)break;j=!0}else o=o.next;while(j||o!==s);return s}function earcutLinked(a,s,o,j,$,_e,tt){if(!a)return;!tt&&_e&&indexCurve(a,j,$,_e);let nt=a,rt,it;for(;a.prev!==a.next;){if(rt=a.prev,it=a.next,_e?isEarHashed(a,j,$,_e):isEar(a)){s.push(rt.i/o|0),s.push(a.i/o|0),s.push(it.i/o|0),removeNode(a),a=it.next,nt=it.next;continue}if(a=it,a===nt){tt?tt===1?(a=cureLocalIntersections(filterPoints(a),s,o),earcutLinked(a,s,o,j,$,_e,2)):tt===2&&splitEarcut(a,s,o,j,$,_e):earcutLinked(filterPoints(a),s,o,j,$,_e,1);break}}}function isEar(a){const s=a.prev,o=a,j=a.next;if(area(s,o,j)>=0)return!1;const $=s.x,_e=o.x,tt=j.x,nt=s.y,rt=o.y,it=j.y,st=$<_e?$<tt?$:tt:_e<tt?_e:tt,at=nt<rt?nt<it?nt:it:rt<it?rt:it,ot=$>_e?$>tt?$:tt:_e>tt?_e:tt,ct=nt>rt?nt>it?nt:it:rt>it?rt:it;let ft=j.next;for(;ft!==s;){if(ft.x>=st&&ft.x<=ot&&ft.y>=at&&ft.y<=ct&&pointInTriangle($,nt,_e,rt,tt,it,ft.x,ft.y)&&area(ft.prev,ft,ft.next)>=0)return!1;ft=ft.next}return!0}function isEarHashed(a,s,o,j){const $=a.prev,_e=a,tt=a.next;if(area($,_e,tt)>=0)return!1;const nt=$.x,rt=_e.x,it=tt.x,st=$.y,at=_e.y,ot=tt.y,ct=nt<rt?nt<it?nt:it:rt<it?rt:it,ft=st<at?st<ot?st:ot:at<ot?at:ot,ht=nt>rt?nt>it?nt:it:rt>it?rt:it,mt=st>at?st>ot?st:ot:at>ot?at:ot,lt=zOrder(ct,ft,s,o,j),ut=zOrder(ht,mt,s,o,j);let dt=a.prevZ,gt=a.nextZ;for(;dt&&dt.z>=lt&&gt&&gt.z<=ut;){if(dt.x>=ct&&dt.x<=ht&&dt.y>=ft&&dt.y<=mt&&dt!==$&&dt!==tt&&pointInTriangle(nt,st,rt,at,it,ot,dt.x,dt.y)&&area(dt.prev,dt,dt.next)>=0||(dt=dt.prevZ,gt.x>=ct&&gt.x<=ht&&gt.y>=ft&&gt.y<=mt&&gt!==$&&gt!==tt&&pointInTriangle(nt,st,rt,at,it,ot,gt.x,gt.y)&&area(gt.prev,gt,gt.next)>=0))return!1;gt=gt.nextZ}for(;dt&&dt.z>=lt;){if(dt.x>=ct&&dt.x<=ht&&dt.y>=ft&&dt.y<=mt&&dt!==$&&dt!==tt&&pointInTriangle(nt,st,rt,at,it,ot,dt.x,dt.y)&&area(dt.prev,dt,dt.next)>=0)return!1;dt=dt.prevZ}for(;gt&&gt.z<=ut;){if(gt.x>=ct&&gt.x<=ht&&gt.y>=ft&&gt.y<=mt&&gt!==$&&gt!==tt&&pointInTriangle(nt,st,rt,at,it,ot,gt.x,gt.y)&&area(gt.prev,gt,gt.next)>=0)return!1;gt=gt.nextZ}return!0}function cureLocalIntersections(a,s,o){let j=a;do{const $=j.prev,_e=j.next.next;!equals($,_e)&&intersects($,j,j.next,_e)&&locallyInside($,_e)&&locallyInside(_e,$)&&(s.push($.i/o|0),s.push(j.i/o|0),s.push(_e.i/o|0),removeNode(j),removeNode(j.next),j=a=_e),j=j.next}while(j!==a);return filterPoints(j)}function splitEarcut(a,s,o,j,$,_e){let tt=a;do{let nt=tt.next.next;for(;nt!==tt.prev;){if(tt.i!==nt.i&&isValidDiagonal(tt,nt)){let rt=splitPolygon(tt,nt);tt=filterPoints(tt,tt.next),rt=filterPoints(rt,rt.next),earcutLinked(tt,s,o,j,$,_e,0),earcutLinked(rt,s,o,j,$,_e,0);return}nt=nt.next}tt=tt.next}while(tt!==a)}function eliminateHoles(a,s,o,j){const $=[];let _e,tt,nt,rt,it;for(_e=0,tt=s.length;_e<tt;_e++)nt=s[_e]*j,rt=_e<tt-1?s[_e+1]*j:a.length,it=linkedList(a,nt,rt,j,!1),it===it.next&&(it.steiner=!0),$.push(getLeftmost(it));for($.sort(compareX),_e=0;_e<$.length;_e++)o=eliminateHole($[_e],o);return o}function compareX(a,s){return a.x-s.x}function eliminateHole(a,s){const o=findHoleBridge(a,s);if(!o)return s;const j=splitPolygon(o,a);return filterPoints(j,j.next),filterPoints(o,o.next)}function findHoleBridge(a,s){let o=s,j=-1/0,$;const _e=a.x,tt=a.y;do{if(tt<=o.y&&tt>=o.next.y&&o.next.y!==o.y){const ot=o.x+(tt-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(ot<=_e&&ot>j&&(j=ot,$=o.x<o.next.x?o:o.next,ot===_e))return $}o=o.next}while(o!==s);if(!$)return null;const nt=$,rt=$.x,it=$.y;let st=1/0,at;o=$;do _e>=o.x&&o.x>=rt&&_e!==o.x&&pointInTriangle(tt<it?_e:j,tt,rt,it,tt<it?j:_e,tt,o.x,o.y)&&(at=Math.abs(tt-o.y)/(_e-o.x),locallyInside(o,a)&&(at<st||at===st&&(o.x>$.x||o.x===$.x&&sectorContainsSector($,o)))&&($=o,st=at)),o=o.next;while(o!==nt);return $}function sectorContainsSector(a,s){return area(a.prev,a,s.prev)<0&&area(s.next,a,a.next)<0}function indexCurve(a,s,o,j){let $=a;do $.z===0&&($.z=zOrder($.x,$.y,s,o,j)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==a);$.prevZ.nextZ=null,$.prevZ=null,sortLinked($)}function sortLinked(a){let s,o,j,$,_e,tt,nt,rt,it=1;do{for(o=a,a=null,_e=null,tt=0;o;){for(tt++,j=o,nt=0,s=0;s<it&&(nt++,j=j.nextZ,!!j);s++);for(rt=it;nt>0||rt>0&&j;)nt!==0&&(rt===0||!j||o.z<=j.z)?($=o,o=o.nextZ,nt--):($=j,j=j.nextZ,rt--),_e?_e.nextZ=$:a=$,$.prevZ=_e,_e=$;o=j}_e.nextZ=null,it*=2}while(tt>1);return a}function zOrder(a,s,o,j,$){return a=(a-o)*$|0,s=(s-j)*$|0,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,a|s<<1}function getLeftmost(a){let s=a,o=a;do(s.x<o.x||s.x===o.x&&s.y<o.y)&&(o=s),s=s.next;while(s!==a);return o}function pointInTriangle(a,s,o,j,$,_e,tt,nt){return($-tt)*(s-nt)>=(a-tt)*(_e-nt)&&(a-tt)*(j-nt)>=(o-tt)*(s-nt)&&(o-tt)*(_e-nt)>=($-tt)*(j-nt)}function isValidDiagonal(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!intersectsPolygon(a,s)&&(locallyInside(a,s)&&locallyInside(s,a)&&middleInside(a,s)&&(area(a.prev,a,s.prev)||area(a,s.prev,s))||equals(a,s)&&area(a.prev,a,a.next)>0&&area(s.prev,s,s.next)>0)}function area(a,s,o){return(s.y-a.y)*(o.x-s.x)-(s.x-a.x)*(o.y-s.y)}function equals(a,s){return a.x===s.x&&a.y===s.y}function intersects(a,s,o,j){const $=sign(area(a,s,o)),_e=sign(area(a,s,j)),tt=sign(area(o,j,a)),nt=sign(area(o,j,s));return!!($!==_e&&tt!==nt||$===0&&onSegment(a,o,s)||_e===0&&onSegment(a,j,s)||tt===0&&onSegment(o,a,j)||nt===0&&onSegment(o,s,j))}function onSegment(a,s,o){return s.x<=Math.max(a.x,o.x)&&s.x>=Math.min(a.x,o.x)&&s.y<=Math.max(a.y,o.y)&&s.y>=Math.min(a.y,o.y)}function sign(a){return a>0?1:a<0?-1:0}function intersectsPolygon(a,s){let o=a;do{if(o.i!==a.i&&o.next.i!==a.i&&o.i!==s.i&&o.next.i!==s.i&&intersects(o,o.next,a,s))return!0;o=o.next}while(o!==a);return!1}function locallyInside(a,s){return area(a.prev,a,a.next)<0?area(a,s,a.next)>=0&&area(a,a.prev,s)>=0:area(a,s,a.prev)<0||area(a,a.next,s)<0}function middleInside(a,s){let o=a,j=!1;const $=(a.x+s.x)/2,_e=(a.y+s.y)/2;do o.y>_e!=o.next.y>_e&&o.next.y!==o.y&&$<(o.next.x-o.x)*(_e-o.y)/(o.next.y-o.y)+o.x&&(j=!j),o=o.next;while(o!==a);return j}function splitPolygon(a,s){const o=new Node$1(a.i,a.x,a.y),j=new Node$1(s.i,s.x,s.y),$=a.next,_e=s.prev;return a.next=s,s.prev=a,o.next=$,$.prev=o,j.next=o,o.prev=j,_e.next=j,j.prev=_e,j}function insertNode(a,s,o,j){const $=new Node$1(a,s,o);return j?($.next=j.next,$.prev=j,j.next.prev=$,j.next=$):($.prev=$,$.next=$),$}function removeNode(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Node$1(a,s,o){this.i=a,this.x=s,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(a,s,o,j){let $=0;for(let _e=s,tt=o-j;_e<o;_e+=j)$+=(a[tt]-a[_e])*(a[_e+1]+a[tt+1]),tt=_e;return $}class ShapeUtils{static area(s){const o=s.length;let j=0;for(let $=o-1,_e=0;_e<o;$=_e++)j+=s[$].x*s[_e].y-s[_e].x*s[$].y;return j*.5}static isClockWise(s){return ShapeUtils.area(s)<0}static triangulateShape(s,o){const j=[],$=[],_e=[];removeDupEndPts(s),addContour(j,s);let tt=s.length;o.forEach(removeDupEndPts);for(let rt=0;rt<o.length;rt++)$.push(tt),tt+=o[rt].length,addContour(j,o[rt]);const nt=Earcut.triangulate(j,$);for(let rt=0;rt<nt.length;rt+=3)_e.push(nt.slice(rt,rt+3));return _e}}function removeDupEndPts(a){const s=a.length;s>2&&a[s-1].equals(a[0])&&a.pop()}function addContour(a,s){for(let o=0;o<s.length;o++)a.push(s[o].x),a.push(s[o].y)}class ExtrudeGeometry extends BufferGeometry{constructor(s=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),o={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:s,options:o},s=Array.isArray(s)?s:[s];const j=this,$=[],_e=[];for(let nt=0,rt=s.length;nt<rt;nt++){const it=s[nt];tt(it)}this.setAttribute("position",new Float32BufferAttribute($,3)),this.setAttribute("uv",new Float32BufferAttribute(_e,2)),this.computeVertexNormals();function tt(nt){const rt=[],it=o.curveSegments!==void 0?o.curveSegments:12,st=o.steps!==void 0?o.steps:1,at=o.depth!==void 0?o.depth:1;let ot=o.bevelEnabled!==void 0?o.bevelEnabled:!0,ct=o.bevelThickness!==void 0?o.bevelThickness:.2,ft=o.bevelSize!==void 0?o.bevelSize:ct-.1,ht=o.bevelOffset!==void 0?o.bevelOffset:0,mt=o.bevelSegments!==void 0?o.bevelSegments:3;const lt=o.extrudePath,ut=o.UVGenerator!==void 0?o.UVGenerator:WorldUVGenerator;let dt,gt=!1,Et,St,Tt,Mt;lt&&(dt=lt.getSpacedPoints(st),gt=!0,ot=!1,Et=lt.computeFrenetFrames(st,!1),St=new Vector3,Tt=new Vector3,Mt=new Vector3),ot||(mt=0,ct=0,ft=0,ht=0);const Bt=nt.extractPoints(it);let Rt=Bt.shape;const Ut=Bt.holes;if(!ShapeUtils.isClockWise(Rt)){Rt=Rt.reverse();for(let ln=0,Cn=Ut.length;ln<Cn;ln++){const bn=Ut[ln];ShapeUtils.isClockWise(bn)&&(Ut[ln]=bn.reverse())}}const Wt=ShapeUtils.triangulateShape(Rt,Ut),Jt=Rt;for(let ln=0,Cn=Ut.length;ln<Cn;ln++){const bn=Ut[ln];Rt=Rt.concat(bn)}function sn(ln,Cn,bn){return Cn||console.error("THREE.ExtrudeGeometry: vec does not exist"),ln.clone().addScaledVector(Cn,bn)}const jt=Rt.length,Vt=Wt.length;function Lt(ln,Cn,bn){let kn,Sn,xn;const Qn=ln.x-Cn.x,nr=ln.y-Cn.y,or=bn.x-ln.x,mr=bn.y-ln.y,$n=Qn*Qn+nr*nr,tn=Qn*mr-nr*or;if(Math.abs(tn)>Number.EPSILON){const $t=Math.sqrt($n),An=Math.sqrt(or*or+mr*mr),En=Cn.x-nr/$t,In=Cn.y+Qn/$t,Hn=bn.x-mr/An,yn=bn.y+or/An,On=((Hn-En)*mr-(yn-In)*or)/(Qn*mr-nr*or);kn=En+Qn*On-ln.x,Sn=In+nr*On-ln.y;const Mn=kn*kn+Sn*Sn;if(Mn<=2)return new Vector2(kn,Sn);xn=Math.sqrt(Mn/2)}else{let $t=!1;Qn>Number.EPSILON?or>Number.EPSILON&&($t=!0):Qn<-Number.EPSILON?or<-Number.EPSILON&&($t=!0):Math.sign(nr)===Math.sign(mr)&&($t=!0),$t?(kn=-nr,Sn=Qn,xn=Math.sqrt($n)):(kn=Qn,Sn=nr,xn=Math.sqrt($n/2))}return new Vector2(kn/xn,Sn/xn)}const Qt=[];for(let ln=0,Cn=Jt.length,bn=Cn-1,kn=ln+1;ln<Cn;ln++,bn++,kn++)bn===Cn&&(bn=0),kn===Cn&&(kn=0),Qt[ln]=Lt(Jt[ln],Jt[bn],Jt[kn]);const nn=[];let mn,Zt=Qt.concat();for(let ln=0,Cn=Ut.length;ln<Cn;ln++){const bn=Ut[ln];mn=[];for(let kn=0,Sn=bn.length,xn=Sn-1,Qn=kn+1;kn<Sn;kn++,xn++,Qn++)xn===Sn&&(xn=0),Qn===Sn&&(Qn=0),mn[kn]=Lt(bn[kn],bn[xn],bn[Qn]);nn.push(mn),Zt=Zt.concat(mn)}for(let ln=0;ln<mt;ln++){const Cn=ln/mt,bn=ct*Math.cos(Cn*Math.PI/2),kn=ft*Math.sin(Cn*Math.PI/2)+ht;for(let Sn=0,xn=Jt.length;Sn<xn;Sn++){const Qn=sn(Jt[Sn],Qt[Sn],kn);hn(Qn.x,Qn.y,-bn)}for(let Sn=0,xn=Ut.length;Sn<xn;Sn++){const Qn=Ut[Sn];mn=nn[Sn];for(let nr=0,or=Qn.length;nr<or;nr++){const mr=sn(Qn[nr],mn[nr],kn);hn(mr.x,mr.y,-bn)}}}const cn=ft+ht;for(let ln=0;ln<jt;ln++){const Cn=ot?sn(Rt[ln],Zt[ln],cn):Rt[ln];gt?(Tt.copy(Et.normals[0]).multiplyScalar(Cn.x),St.copy(Et.binormals[0]).multiplyScalar(Cn.y),Mt.copy(dt[0]).add(Tt).add(St),hn(Mt.x,Mt.y,Mt.z)):hn(Cn.x,Cn.y,0)}for(let ln=1;ln<=st;ln++)for(let Cn=0;Cn<jt;Cn++){const bn=ot?sn(Rt[Cn],Zt[Cn],cn):Rt[Cn];gt?(Tt.copy(Et.normals[ln]).multiplyScalar(bn.x),St.copy(Et.binormals[ln]).multiplyScalar(bn.y),Mt.copy(dt[ln]).add(Tt).add(St),hn(Mt.x,Mt.y,Mt.z)):hn(bn.x,bn.y,at/st*ln)}for(let ln=mt-1;ln>=0;ln--){const Cn=ln/mt,bn=ct*Math.cos(Cn*Math.PI/2),kn=ft*Math.sin(Cn*Math.PI/2)+ht;for(let Sn=0,xn=Jt.length;Sn<xn;Sn++){const Qn=sn(Jt[Sn],Qt[Sn],kn);hn(Qn.x,Qn.y,at+bn)}for(let Sn=0,xn=Ut.length;Sn<xn;Sn++){const Qn=Ut[Sn];mn=nn[Sn];for(let nr=0,or=Qn.length;nr<or;nr++){const mr=sn(Qn[nr],mn[nr],kn);gt?hn(mr.x,mr.y+dt[st-1].y,dt[st-1].x+bn):hn(mr.x,mr.y,at+bn)}}}Ot(),rn();function Ot(){const ln=$.length/3;if(ot){let Cn=0,bn=jt*Cn;for(let kn=0;kn<Vt;kn++){const Sn=Wt[kn];Tn(Sn[2]+bn,Sn[1]+bn,Sn[0]+bn)}Cn=st+mt*2,bn=jt*Cn;for(let kn=0;kn<Vt;kn++){const Sn=Wt[kn];Tn(Sn[0]+bn,Sn[1]+bn,Sn[2]+bn)}}else{for(let Cn=0;Cn<Vt;Cn++){const bn=Wt[Cn];Tn(bn[2],bn[1],bn[0])}for(let Cn=0;Cn<Vt;Cn++){const bn=Wt[Cn];Tn(bn[0]+jt*st,bn[1]+jt*st,bn[2]+jt*st)}}j.addGroup(ln,$.length/3-ln,0)}function rn(){const ln=$.length/3;let Cn=0;fn(Jt,Cn),Cn+=Jt.length;for(let bn=0,kn=Ut.length;bn<kn;bn++){const Sn=Ut[bn];fn(Sn,Cn),Cn+=Sn.length}j.addGroup(ln,$.length/3-ln,1)}function fn(ln,Cn){let bn=ln.length;for(;--bn>=0;){const kn=bn;let Sn=bn-1;Sn<0&&(Sn=ln.length-1);for(let xn=0,Qn=st+mt*2;xn<Qn;xn++){const nr=jt*xn,or=jt*(xn+1),mr=Cn+kn+nr,$n=Cn+Sn+nr,tn=Cn+Sn+or,$t=Cn+kn+or;Nn(mr,$n,tn,$t)}}}function hn(ln,Cn,bn){rt.push(ln),rt.push(Cn),rt.push(bn)}function Tn(ln,Cn,bn){Pn(ln),Pn(Cn),Pn(bn);const kn=$.length/3,Sn=ut.generateTopUV(j,$,kn-3,kn-2,kn-1);Dn(Sn[0]),Dn(Sn[1]),Dn(Sn[2])}function Nn(ln,Cn,bn,kn){Pn(ln),Pn(Cn),Pn(kn),Pn(Cn),Pn(bn),Pn(kn);const Sn=$.length/3,xn=ut.generateSideWallUV(j,$,Sn-6,Sn-3,Sn-2,Sn-1);Dn(xn[0]),Dn(xn[1]),Dn(xn[3]),Dn(xn[1]),Dn(xn[2]),Dn(xn[3])}function Pn(ln){$.push(rt[ln*3+0]),$.push(rt[ln*3+1]),$.push(rt[ln*3+2])}function Dn(ln){_e.push(ln.x),_e.push(ln.y)}}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}toJSON(){const s=super.toJSON(),o=this.parameters.shapes,j=this.parameters.options;return toJSON$1(o,j,s)}static fromJSON(s,o){const j=[];for(let _e=0,tt=s.shapes.length;_e<tt;_e++){const nt=o[s.shapes[_e]];j.push(nt)}const $=s.options.extrudePath;return $!==void 0&&(s.options.extrudePath=new Curves[$.type]().fromJSON($)),new ExtrudeGeometry(j,s.options)}}const WorldUVGenerator={generateTopUV:function(a,s,o,j,$){const _e=s[o*3],tt=s[o*3+1],nt=s[j*3],rt=s[j*3+1],it=s[$*3],st=s[$*3+1];return[new Vector2(_e,tt),new Vector2(nt,rt),new Vector2(it,st)]},generateSideWallUV:function(a,s,o,j,$,_e){const tt=s[o*3],nt=s[o*3+1],rt=s[o*3+2],it=s[j*3],st=s[j*3+1],at=s[j*3+2],ot=s[$*3],ct=s[$*3+1],ft=s[$*3+2],ht=s[_e*3],mt=s[_e*3+1],lt=s[_e*3+2];return Math.abs(nt-st)<Math.abs(tt-it)?[new Vector2(tt,1-rt),new Vector2(it,1-at),new Vector2(ot,1-ft),new Vector2(ht,1-lt)]:[new Vector2(nt,1-rt),new Vector2(st,1-at),new Vector2(ct,1-ft),new Vector2(mt,1-lt)]}};function toJSON$1(a,s,o){if(o.shapes=[],Array.isArray(a))for(let j=0,$=a.length;j<$;j++){const _e=a[j];o.shapes.push(_e.uuid)}else o.shapes.push(a.uuid);return o.options=Object.assign({},s),s.extrudePath!==void 0&&(o.options.extrudePath=s.extrudePath.toJSON()),o}class IcosahedronGeometry extends PolyhedronGeometry{constructor(s=1,o=0){const j=(1+Math.sqrt(5))/2,$=[-1,j,0,1,j,0,-1,-j,0,1,-j,0,0,-1,j,0,1,j,0,-1,-j,0,1,-j,j,0,-1,j,0,1,-j,0,-1,-j,0,1],_e=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super($,_e,s,o),this.type="IcosahedronGeometry",this.parameters={radius:s,detail:o}}static fromJSON(s){return new IcosahedronGeometry(s.radius,s.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(s=1,o=0){const j=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],$=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(j,$,s,o),this.type="OctahedronGeometry",this.parameters={radius:s,detail:o}}static fromJSON(s){return new OctahedronGeometry(s.radius,s.detail)}}class RingGeometry extends BufferGeometry{constructor(s=.5,o=1,j=32,$=1,_e=0,tt=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:s,outerRadius:o,thetaSegments:j,phiSegments:$,thetaStart:_e,thetaLength:tt},j=Math.max(3,j),$=Math.max(1,$);const nt=[],rt=[],it=[],st=[];let at=s;const ot=(o-s)/$,ct=new Vector3,ft=new Vector2;for(let ht=0;ht<=$;ht++){for(let mt=0;mt<=j;mt++){const lt=_e+mt/j*tt;ct.x=at*Math.cos(lt),ct.y=at*Math.sin(lt),rt.push(ct.x,ct.y,ct.z),it.push(0,0,1),ft.x=(ct.x/o+1)/2,ft.y=(ct.y/o+1)/2,st.push(ft.x,ft.y)}at+=ot}for(let ht=0;ht<$;ht++){const mt=ht*(j+1);for(let lt=0;lt<j;lt++){const ut=lt+mt,dt=ut,gt=ut+j+1,Et=ut+j+2,St=ut+1;nt.push(dt,gt,St),nt.push(gt,Et,St)}}this.setIndex(nt),this.setAttribute("position",new Float32BufferAttribute(rt,3)),this.setAttribute("normal",new Float32BufferAttribute(it,3)),this.setAttribute("uv",new Float32BufferAttribute(st,2))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new RingGeometry(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(s=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),o=12){super(),this.type="ShapeGeometry",this.parameters={shapes:s,curveSegments:o};const j=[],$=[],_e=[],tt=[];let nt=0,rt=0;if(Array.isArray(s)===!1)it(s);else for(let st=0;st<s.length;st++)it(s[st]),this.addGroup(nt,rt,st),nt+=rt,rt=0;this.setIndex(j),this.setAttribute("position",new Float32BufferAttribute($,3)),this.setAttribute("normal",new Float32BufferAttribute(_e,3)),this.setAttribute("uv",new Float32BufferAttribute(tt,2));function it(st){const at=$.length/3,ot=st.extractPoints(o);let ct=ot.shape;const ft=ot.holes;ShapeUtils.isClockWise(ct)===!1&&(ct=ct.reverse());for(let mt=0,lt=ft.length;mt<lt;mt++){const ut=ft[mt];ShapeUtils.isClockWise(ut)===!0&&(ft[mt]=ut.reverse())}const ht=ShapeUtils.triangulateShape(ct,ft);for(let mt=0,lt=ft.length;mt<lt;mt++){const ut=ft[mt];ct=ct.concat(ut)}for(let mt=0,lt=ct.length;mt<lt;mt++){const ut=ct[mt];$.push(ut.x,ut.y,0),_e.push(0,0,1),tt.push(ut.x,ut.y)}for(let mt=0,lt=ht.length;mt<lt;mt++){const ut=ht[mt],dt=ut[0]+at,gt=ut[1]+at,Et=ut[2]+at;j.push(dt,gt,Et),rt+=3}}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}toJSON(){const s=super.toJSON(),o=this.parameters.shapes;return toJSON(o,s)}static fromJSON(s,o){const j=[];for(let $=0,_e=s.shapes.length;$<_e;$++){const tt=o[s.shapes[$]];j.push(tt)}return new ShapeGeometry(j,s.curveSegments)}}function toJSON(a,s){if(s.shapes=[],Array.isArray(a))for(let o=0,j=a.length;o<j;o++){const $=a[o];s.shapes.push($.uuid)}else s.shapes.push(a.uuid);return s}class SphereGeometry extends BufferGeometry{constructor(s=1,o=32,j=16,$=0,_e=Math.PI*2,tt=0,nt=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:s,widthSegments:o,heightSegments:j,phiStart:$,phiLength:_e,thetaStart:tt,thetaLength:nt},o=Math.max(3,Math.floor(o)),j=Math.max(2,Math.floor(j));const rt=Math.min(tt+nt,Math.PI);let it=0;const st=[],at=new Vector3,ot=new Vector3,ct=[],ft=[],ht=[],mt=[];for(let lt=0;lt<=j;lt++){const ut=[],dt=lt/j;let gt=0;lt===0&&tt===0?gt=.5/o:lt===j&&rt===Math.PI&&(gt=-.5/o);for(let Et=0;Et<=o;Et++){const St=Et/o;at.x=-s*Math.cos($+St*_e)*Math.sin(tt+dt*nt),at.y=s*Math.cos(tt+dt*nt),at.z=s*Math.sin($+St*_e)*Math.sin(tt+dt*nt),ft.push(at.x,at.y,at.z),ot.copy(at).normalize(),ht.push(ot.x,ot.y,ot.z),mt.push(St+gt,1-dt),ut.push(it++)}st.push(ut)}for(let lt=0;lt<j;lt++)for(let ut=0;ut<o;ut++){const dt=st[lt][ut+1],gt=st[lt][ut],Et=st[lt+1][ut],St=st[lt+1][ut+1];(lt!==0||tt>0)&&ct.push(dt,gt,St),(lt!==j-1||rt<Math.PI)&&ct.push(gt,Et,St)}this.setIndex(ct),this.setAttribute("position",new Float32BufferAttribute(ft,3)),this.setAttribute("normal",new Float32BufferAttribute(ht,3)),this.setAttribute("uv",new Float32BufferAttribute(mt,2))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(s=1,o=0){const j=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],$=[2,1,0,0,3,2,1,3,0,2,3,1];super(j,$,s,o),this.type="TetrahedronGeometry",this.parameters={radius:s,detail:o}}static fromJSON(s){return new TetrahedronGeometry(s.radius,s.detail)}}class TorusGeometry extends BufferGeometry{constructor(s=1,o=.4,j=12,$=48,_e=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:s,tube:o,radialSegments:j,tubularSegments:$,arc:_e},j=Math.floor(j),$=Math.floor($);const tt=[],nt=[],rt=[],it=[],st=new Vector3,at=new Vector3,ot=new Vector3;for(let ct=0;ct<=j;ct++)for(let ft=0;ft<=$;ft++){const ht=ft/$*_e,mt=ct/j*Math.PI*2;at.x=(s+o*Math.cos(mt))*Math.cos(ht),at.y=(s+o*Math.cos(mt))*Math.sin(ht),at.z=o*Math.sin(mt),nt.push(at.x,at.y,at.z),st.x=s*Math.cos(ht),st.y=s*Math.sin(ht),ot.subVectors(at,st).normalize(),rt.push(ot.x,ot.y,ot.z),it.push(ft/$),it.push(ct/j)}for(let ct=1;ct<=j;ct++)for(let ft=1;ft<=$;ft++){const ht=($+1)*ct+ft-1,mt=($+1)*(ct-1)+ft-1,lt=($+1)*(ct-1)+ft,ut=($+1)*ct+ft;tt.push(ht,mt,ut),tt.push(mt,lt,ut)}this.setIndex(tt),this.setAttribute("position",new Float32BufferAttribute(nt,3)),this.setAttribute("normal",new Float32BufferAttribute(rt,3)),this.setAttribute("uv",new Float32BufferAttribute(it,2))}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(s=1,o=.4,j=64,$=8,_e=2,tt=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:s,tube:o,tubularSegments:j,radialSegments:$,p:_e,q:tt},j=Math.floor(j),$=Math.floor($);const nt=[],rt=[],it=[],st=[],at=new Vector3,ot=new Vector3,ct=new Vector3,ft=new Vector3,ht=new Vector3,mt=new Vector3,lt=new Vector3;for(let dt=0;dt<=j;++dt){const gt=dt/j*_e*Math.PI*2;ut(gt,_e,tt,s,ct),ut(gt+.01,_e,tt,s,ft),mt.subVectors(ft,ct),lt.addVectors(ft,ct),ht.crossVectors(mt,lt),lt.crossVectors(ht,mt),ht.normalize(),lt.normalize();for(let Et=0;Et<=$;++Et){const St=Et/$*Math.PI*2,Tt=-o*Math.cos(St),Mt=o*Math.sin(St);at.x=ct.x+(Tt*lt.x+Mt*ht.x),at.y=ct.y+(Tt*lt.y+Mt*ht.y),at.z=ct.z+(Tt*lt.z+Mt*ht.z),rt.push(at.x,at.y,at.z),ot.subVectors(at,ct).normalize(),it.push(ot.x,ot.y,ot.z),st.push(dt/j),st.push(Et/$)}}for(let dt=1;dt<=j;dt++)for(let gt=1;gt<=$;gt++){const Et=($+1)*(dt-1)+(gt-1),St=($+1)*dt+(gt-1),Tt=($+1)*dt+gt,Mt=($+1)*(dt-1)+gt;nt.push(Et,St,Mt),nt.push(St,Tt,Mt)}this.setIndex(nt),this.setAttribute("position",new Float32BufferAttribute(rt,3)),this.setAttribute("normal",new Float32BufferAttribute(it,3)),this.setAttribute("uv",new Float32BufferAttribute(st,2));function ut(dt,gt,Et,St,Tt){const Mt=Math.cos(dt),Bt=Math.sin(dt),Rt=Et/gt*dt,Ut=Math.cos(Rt);Tt.x=St*(2+Ut)*.5*Mt,Tt.y=St*(2+Ut)*Bt*.5,Tt.z=St*Math.sin(Rt)*.5}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}static fromJSON(s){return new TorusKnotGeometry(s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q)}}class TubeGeometry extends BufferGeometry{constructor(s=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),o=64,j=1,$=8,_e=!1){super(),this.type="TubeGeometry",this.parameters={path:s,tubularSegments:o,radius:j,radialSegments:$,closed:_e};const tt=s.computeFrenetFrames(o,_e);this.tangents=tt.tangents,this.normals=tt.normals,this.binormals=tt.binormals;const nt=new Vector3,rt=new Vector3,it=new Vector2;let st=new Vector3;const at=[],ot=[],ct=[],ft=[];ht(),this.setIndex(ft),this.setAttribute("position",new Float32BufferAttribute(at,3)),this.setAttribute("normal",new Float32BufferAttribute(ot,3)),this.setAttribute("uv",new Float32BufferAttribute(ct,2));function ht(){for(let dt=0;dt<o;dt++)mt(dt);mt(_e===!1?o:0),ut(),lt()}function mt(dt){st=s.getPointAt(dt/o,st);const gt=tt.normals[dt],Et=tt.binormals[dt];for(let St=0;St<=$;St++){const Tt=St/$*Math.PI*2,Mt=Math.sin(Tt),Bt=-Math.cos(Tt);rt.x=Bt*gt.x+Mt*Et.x,rt.y=Bt*gt.y+Mt*Et.y,rt.z=Bt*gt.z+Mt*Et.z,rt.normalize(),ot.push(rt.x,rt.y,rt.z),nt.x=st.x+j*rt.x,nt.y=st.y+j*rt.y,nt.z=st.z+j*rt.z,at.push(nt.x,nt.y,nt.z)}}function lt(){for(let dt=1;dt<=o;dt++)for(let gt=1;gt<=$;gt++){const Et=($+1)*(dt-1)+(gt-1),St=($+1)*dt+(gt-1),Tt=($+1)*dt+gt,Mt=($+1)*(dt-1)+gt;ft.push(Et,St,Mt),ft.push(St,Tt,Mt)}}function ut(){for(let dt=0;dt<=o;dt++)for(let gt=0;gt<=$;gt++)it.x=dt/o,it.y=gt/$,ct.push(it.x,it.y)}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}toJSON(){const s=super.toJSON();return s.path=this.parameters.path.toJSON(),s}static fromJSON(s){return new TubeGeometry(new Curves[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed)}}class WireframeGeometry extends BufferGeometry{constructor(s=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:s},s!==null){const o=[],j=new Set,$=new Vector3,_e=new Vector3;if(s.index!==null){const tt=s.attributes.position,nt=s.index;let rt=s.groups;rt.length===0&&(rt=[{start:0,count:nt.count,materialIndex:0}]);for(let it=0,st=rt.length;it<st;++it){const at=rt[it],ot=at.start,ct=at.count;for(let ft=ot,ht=ot+ct;ft<ht;ft+=3)for(let mt=0;mt<3;mt++){const lt=nt.getX(ft+mt),ut=nt.getX(ft+(mt+1)%3);$.fromBufferAttribute(tt,lt),_e.fromBufferAttribute(tt,ut),isUniqueEdge($,_e,j)===!0&&(o.push($.x,$.y,$.z),o.push(_e.x,_e.y,_e.z))}}}else{const tt=s.attributes.position;for(let nt=0,rt=tt.count/3;nt<rt;nt++)for(let it=0;it<3;it++){const st=3*nt+it,at=3*nt+(it+1)%3;$.fromBufferAttribute(tt,st),_e.fromBufferAttribute(tt,at),isUniqueEdge($,_e,j)===!0&&(o.push($.x,$.y,$.z),o.push(_e.x,_e.y,_e.z))}}this.setAttribute("position",new Float32BufferAttribute(o,3))}}copy(s){return super.copy(s),this.parameters=Object.assign({},s.parameters),this}}function isUniqueEdge(a,s,o){const j=`${a.x},${a.y},${a.z}-${s.x},${s.y},${s.z}`,$=`${s.x},${s.y},${s.z}-${a.x},${a.y},${a.z}`;return o.has(j)===!0||o.has($)===!0?!1:(o.add(j),o.add($),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry:CapsuleGeometry$1,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(s){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.fog=s.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(s){super(s),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(s){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.defines={STANDARD:""},this.color.copy(s.color),this.roughness=s.roughness,this.metalness=s.metalness,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.roughnessMap=s.roughnessMap,this.metalnessMap=s.metalnessMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.envMapIntensity=s.envMapIntensity,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.flatShading=s.flatShading,this.fog=s.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(s){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$2(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(o){this.ior=(1+.4*o)/(1-.4*o)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(s)}get anisotropy(){return this._anisotropy}set anisotropy(s){this._anisotropy>0!=s>0&&this.version++,this._anisotropy=s}get clearcoat(){return this._clearcoat}set clearcoat(s){this._clearcoat>0!=s>0&&this.version++,this._clearcoat=s}get iridescence(){return this._iridescence}set iridescence(s){this._iridescence>0!=s>0&&this.version++,this._iridescence=s}get sheen(){return this._sheen}set sheen(s){this._sheen>0!=s>0&&this.version++,this._sheen=s}get transmission(){return this._transmission}set transmission(s){this._transmission>0!=s>0&&this.version++,this._transmission=s}copy(s){return super.copy(s),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=s.anisotropy,this.anisotropyRotation=s.anisotropyRotation,this.anisotropyMap=s.anisotropyMap,this.clearcoat=s.clearcoat,this.clearcoatMap=s.clearcoatMap,this.clearcoatRoughness=s.clearcoatRoughness,this.clearcoatRoughnessMap=s.clearcoatRoughnessMap,this.clearcoatNormalMap=s.clearcoatNormalMap,this.clearcoatNormalScale.copy(s.clearcoatNormalScale),this.ior=s.ior,this.iridescence=s.iridescence,this.iridescenceMap=s.iridescenceMap,this.iridescenceIOR=s.iridescenceIOR,this.iridescenceThicknessRange=[...s.iridescenceThicknessRange],this.iridescenceThicknessMap=s.iridescenceThicknessMap,this.sheen=s.sheen,this.sheenColor.copy(s.sheenColor),this.sheenColorMap=s.sheenColorMap,this.sheenRoughness=s.sheenRoughness,this.sheenRoughnessMap=s.sheenRoughnessMap,this.transmission=s.transmission,this.transmissionMap=s.transmissionMap,this.thickness=s.thickness,this.thicknessMap=s.thicknessMap,this.attenuationDistance=s.attenuationDistance,this.attenuationColor.copy(s.attenuationColor),this.specularIntensity=s.specularIntensity,this.specularIntensityMap=s.specularIntensityMap,this.specularColor.copy(s.specularColor),this.specularColorMap=s.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(s){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.specular.copy(s.specular),this.shininess=s.shininess,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.flatShading=s.flatShading,this.fog=s.fog,this}}class MeshToonMaterial extends Material{constructor(s){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.gradientMap=s.gradientMap,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.fog=s.fog,this}}class MeshNormalMaterial extends Material{constructor(s){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.flatShading=s.flatShading,this}}class MeshLambertMaterial extends Material{constructor(s){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.flatShading=s.flatShading,this.fog=s.fog,this}}class MeshMatcapMaterial extends Material{constructor(s){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(s)}copy(s){return super.copy(s),this.defines={MATCAP:""},this.color.copy(s.color),this.matcap=s.matcap,this.map=s.map,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.flatShading=s.flatShading,this.fog=s.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(s){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(s)}copy(s){return super.copy(s),this.scale=s.scale,this.dashSize=s.dashSize,this.gapSize=s.gapSize,this}}function arraySlice(a,s,o){return isTypedArray(a)?new a.constructor(a.subarray(s,o!==void 0?o:a.length)):a.slice(s,o)}function convertArray(a,s,o){return!a||!o&&a.constructor===s?a:typeof s.BYTES_PER_ELEMENT=="number"?new s(a):Array.prototype.slice.call(a)}function isTypedArray(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function getKeyframeOrder(a){function s($,_e){return a[$]-a[_e]}const o=a.length,j=new Array(o);for(let $=0;$!==o;++$)j[$]=$;return j.sort(s),j}function sortedArray(a,s,o){const j=a.length,$=new a.constructor(j);for(let _e=0,tt=0;tt!==j;++_e){const nt=o[_e]*s;for(let rt=0;rt!==s;++rt)$[tt++]=a[nt+rt]}return $}function flattenJSON(a,s,o,j){let $=1,_e=a[0];for(;_e!==void 0&&_e[j]===void 0;)_e=a[$++];if(_e===void 0)return;let tt=_e[j];if(tt!==void 0)if(Array.isArray(tt))do tt=_e[j],tt!==void 0&&(s.push(_e.time),o.push.apply(o,tt)),_e=a[$++];while(_e!==void 0);else if(tt.toArray!==void 0)do tt=_e[j],tt!==void 0&&(s.push(_e.time),tt.toArray(o,o.length)),_e=a[$++];while(_e!==void 0);else do tt=_e[j],tt!==void 0&&(s.push(_e.time),o.push(tt)),_e=a[$++];while(_e!==void 0)}function subclip(a,s,o,j,$=30){const _e=a.clone();_e.name=s;const tt=[];for(let rt=0;rt<_e.tracks.length;++rt){const it=_e.tracks[rt],st=it.getValueSize(),at=[],ot=[];for(let ct=0;ct<it.times.length;++ct){const ft=it.times[ct]*$;if(!(ft<o||ft>=j)){at.push(it.times[ct]);for(let ht=0;ht<st;++ht)ot.push(it.values[ct*st+ht])}}at.length!==0&&(it.times=convertArray(at,it.times.constructor),it.values=convertArray(ot,it.values.constructor),tt.push(it))}_e.tracks=tt;let nt=1/0;for(let rt=0;rt<_e.tracks.length;++rt)nt>_e.tracks[rt].times[0]&&(nt=_e.tracks[rt].times[0]);for(let rt=0;rt<_e.tracks.length;++rt)_e.tracks[rt].shift(-1*nt);return _e.resetDuration(),_e}function makeClipAdditive(a,s=0,o=a,j=30){j<=0&&(j=30);const $=o.tracks.length,_e=s/j;for(let tt=0;tt<$;++tt){const nt=o.tracks[tt],rt=nt.ValueTypeName;if(rt==="bool"||rt==="string")continue;const it=a.tracks.find(function(lt){return lt.name===nt.name&&lt.ValueTypeName===rt});if(it===void 0)continue;let st=0;const at=nt.getValueSize();nt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(st=at/3);let ot=0;const ct=it.getValueSize();it.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ot=ct/3);const ft=nt.times.length-1;let ht;if(_e<=nt.times[0]){const lt=st,ut=at-st;ht=arraySlice(nt.values,lt,ut)}else if(_e>=nt.times[ft]){const lt=ft*at+st,ut=lt+at-st;ht=arraySlice(nt.values,lt,ut)}else{const lt=nt.createInterpolant(),ut=st,dt=at-st;lt.evaluate(_e),ht=arraySlice(lt.resultBuffer,ut,dt)}rt==="quaternion"&&new Quaternion().fromArray(ht).normalize().conjugate().toArray(ht);const mt=it.times.length;for(let lt=0;lt<mt;++lt){const ut=lt*ct+ot;if(rt==="quaternion")Quaternion.multiplyQuaternionsFlat(it.values,ut,ht,0,it.values,ut);else{const dt=ct-ot*2;for(let gt=0;gt<dt;++gt)it.values[ut+gt]-=ht[gt]}}}return a.blendMode=AdditiveAnimationBlendMode,a}const AnimationUtils={arraySlice,convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(s,o,j,$){this.parameterPositions=s,this._cachedIndex=0,this.resultBuffer=$!==void 0?$:new o.constructor(j),this.sampleValues=o,this.valueSize=j,this.settings=null,this.DefaultSettings_={}}evaluate(s){const o=this.parameterPositions;let j=this._cachedIndex,$=o[j],_e=o[j-1];e:{t:{let tt;n:{r:if(!(s<$)){for(let nt=j+2;;){if($===void 0){if(s<_e)break r;return j=o.length,this._cachedIndex=j,this.copySampleValue_(j-1)}if(j===nt)break;if(_e=$,$=o[++j],s<$)break t}tt=o.length;break n}if(!(s>=_e)){const nt=o[1];s<nt&&(j=2,_e=nt);for(let rt=j-2;;){if(_e===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(j===rt)break;if($=_e,_e=o[--j-1],s>=_e)break t}tt=j,j=0;break n}break e}for(;j<tt;){const nt=j+tt>>>1;s<o[nt]?tt=nt:j=nt+1}if($=o[j],_e=o[j-1],_e===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if($===void 0)return j=o.length,this._cachedIndex=j,this.copySampleValue_(j-1)}this._cachedIndex=j,this.intervalChanged_(j,_e,$)}return this.interpolate_(j,_e,s,$)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(s){const o=this.resultBuffer,j=this.sampleValues,$=this.valueSize,_e=s*$;for(let tt=0;tt!==$;++tt)o[tt]=j[_e+tt];return o}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(s,o,j,$){super(s,o,j,$),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(s,o,j){const $=this.parameterPositions;let _e=s-2,tt=s+1,nt=$[_e],rt=$[tt];if(nt===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:_e=s,nt=2*o-j;break;case WrapAroundEnding:_e=$.length-2,nt=o+$[_e]-$[_e+1];break;default:_e=s,nt=j}if(rt===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:tt=s,rt=2*j-o;break;case WrapAroundEnding:tt=1,rt=j+$[1]-$[0];break;default:tt=s-1,rt=o}const it=(j-o)*.5,st=this.valueSize;this._weightPrev=it/(o-nt),this._weightNext=it/(rt-j),this._offsetPrev=_e*st,this._offsetNext=tt*st}interpolate_(s,o,j,$){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=s*nt,it=rt-nt,st=this._offsetPrev,at=this._offsetNext,ot=this._weightPrev,ct=this._weightNext,ft=(j-o)/($-o),ht=ft*ft,mt=ht*ft,lt=-ot*mt+2*ot*ht-ot*ft,ut=(1+ot)*mt+(-1.5-2*ot)*ht+(-.5+ot)*ft+1,dt=(-1-ct)*mt+(1.5+ct)*ht+.5*ft,gt=ct*mt-ct*ht;for(let Et=0;Et!==nt;++Et)_e[Et]=lt*tt[st+Et]+ut*tt[it+Et]+dt*tt[rt+Et]+gt*tt[at+Et];return _e}}class LinearInterpolant extends Interpolant{constructor(s,o,j,$){super(s,o,j,$)}interpolate_(s,o,j,$){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=s*nt,it=rt-nt,st=(j-o)/($-o),at=1-st;for(let ot=0;ot!==nt;++ot)_e[ot]=tt[it+ot]*at+tt[rt+ot]*st;return _e}}class DiscreteInterpolant extends Interpolant{constructor(s,o,j,$){super(s,o,j,$)}interpolate_(s){return this.copySampleValue_(s-1)}}class KeyframeTrack{constructor(s,o,j,$){if(s===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(o===void 0||o.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+s);this.name=s,this.times=convertArray(o,this.TimeBufferType),this.values=convertArray(j,this.ValueBufferType),this.setInterpolation($||this.DefaultInterpolation)}static toJSON(s){const o=s.constructor;let j;if(o.toJSON!==this.toJSON)j=o.toJSON(s);else{j={name:s.name,times:convertArray(s.times,Array),values:convertArray(s.values,Array)};const $=s.getInterpolation();$!==s.DefaultInterpolation&&(j.interpolation=$)}return j.type=s.ValueTypeName,j}InterpolantFactoryMethodDiscrete(s){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodLinear(s){return new LinearInterpolant(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodSmooth(s){return new CubicInterpolant(this.times,this.values,this.getValueSize(),s)}setInterpolation(s){let o;switch(s){case InterpolateDiscrete:o=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:o=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:o=this.InterpolantFactoryMethodSmooth;break}if(o===void 0){const j="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(s!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(j);return console.warn("THREE.KeyframeTrack:",j),this}return this.createInterpolant=o,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(s){if(s!==0){const o=this.times;for(let j=0,$=o.length;j!==$;++j)o[j]+=s}return this}scale(s){if(s!==1){const o=this.times;for(let j=0,$=o.length;j!==$;++j)o[j]*=s}return this}trim(s,o){const j=this.times,$=j.length;let _e=0,tt=$-1;for(;_e!==$&&j[_e]<s;)++_e;for(;tt!==-1&&j[tt]>o;)--tt;if(++tt,_e!==0||tt!==$){_e>=tt&&(tt=Math.max(tt,1),_e=tt-1);const nt=this.getValueSize();this.times=arraySlice(j,_e,tt),this.values=arraySlice(this.values,_e*nt,tt*nt)}return this}validate(){let s=!0;const o=this.getValueSize();o-Math.floor(o)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),s=!1);const j=this.times,$=this.values,_e=j.length;_e===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),s=!1);let tt=null;for(let nt=0;nt!==_e;nt++){const rt=j[nt];if(typeof rt=="number"&&isNaN(rt)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,nt,rt),s=!1;break}if(tt!==null&&tt>rt){console.error("THREE.KeyframeTrack: Out of order keys.",this,nt,rt,tt),s=!1;break}tt=rt}if($!==void 0&&isTypedArray($))for(let nt=0,rt=$.length;nt!==rt;++nt){const it=$[nt];if(isNaN(it)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,nt,it),s=!1;break}}return s}optimize(){const s=arraySlice(this.times),o=arraySlice(this.values),j=this.getValueSize(),$=this.getInterpolation()===InterpolateSmooth,_e=s.length-1;let tt=1;for(let nt=1;nt<_e;++nt){let rt=!1;const it=s[nt],st=s[nt+1];if(it!==st&&(nt!==1||it!==s[0]))if($)rt=!0;else{const at=nt*j,ot=at-j,ct=at+j;for(let ft=0;ft!==j;++ft){const ht=o[at+ft];if(ht!==o[ot+ft]||ht!==o[ct+ft]){rt=!0;break}}}if(rt){if(nt!==tt){s[tt]=s[nt];const at=nt*j,ot=tt*j;for(let ct=0;ct!==j;++ct)o[ot+ct]=o[at+ct]}++tt}}if(_e>0){s[tt]=s[_e];for(let nt=_e*j,rt=tt*j,it=0;it!==j;++it)o[rt+it]=o[nt+it];++tt}return tt!==s.length?(this.times=arraySlice(s,0,tt),this.values=arraySlice(o,0,tt*j)):(this.times=s,this.values=o),this}clone(){const s=arraySlice(this.times,0),o=arraySlice(this.values,0),j=this.constructor,$=new j(this.name,s,o);return $.createInterpolant=this.createInterpolant,$}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(s,o,j,$){super(s,o,j,$)}interpolate_(s,o,j,$){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=(j-o)/($-o);let it=s*nt;for(let st=it+nt;it!==st;it+=4)Quaternion.slerpFlat(_e,0,tt,it-nt,tt,it,rt);return _e}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(s){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),s)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(s,o=-1,j,$=NormalAnimationBlendMode){this.name=s,this.tracks=j,this.duration=o,this.blendMode=$,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(s){const o=[],j=s.tracks,$=1/(s.fps||1);for(let tt=0,nt=j.length;tt!==nt;++tt)o.push(parseKeyframeTrack(j[tt]).scale($));const _e=new this(s.name,s.duration,o,s.blendMode);return _e.uuid=s.uuid,_e}static toJSON(s){const o=[],j=s.tracks,$={name:s.name,duration:s.duration,tracks:o,uuid:s.uuid,blendMode:s.blendMode};for(let _e=0,tt=j.length;_e!==tt;++_e)o.push(KeyframeTrack.toJSON(j[_e]));return $}static CreateFromMorphTargetSequence(s,o,j,$){const _e=o.length,tt=[];for(let nt=0;nt<_e;nt++){let rt=[],it=[];rt.push((nt+_e-1)%_e,nt,(nt+1)%_e),it.push(0,1,0);const st=getKeyframeOrder(rt);rt=sortedArray(rt,1,st),it=sortedArray(it,1,st),!$&&rt[0]===0&&(rt.push(_e),it.push(it[0])),tt.push(new NumberKeyframeTrack(".morphTargetInfluences["+o[nt].name+"]",rt,it).scale(1/j))}return new this(s,-1,tt)}static findByName(s,o){let j=s;if(!Array.isArray(s)){const $=s;j=$.geometry&&$.geometry.animations||$.animations}for(let $=0;$<j.length;$++)if(j[$].name===o)return j[$];return null}static CreateClipsFromMorphTargetSequences(s,o,j){const $={},_e=/^([\w-]*?)([\d]+)$/;for(let nt=0,rt=s.length;nt<rt;nt++){const it=s[nt],st=it.name.match(_e);if(st&&st.length>1){const at=st[1];let ot=$[at];ot||($[at]=ot=[]),ot.push(it)}}const tt=[];for(const nt in $)tt.push(this.CreateFromMorphTargetSequence(nt,$[nt],o,j));return tt}static parseAnimation(s,o){if(!s)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const j=function(at,ot,ct,ft,ht){if(ct.length!==0){const mt=[],lt=[];flattenJSON(ct,mt,lt,ft),mt.length!==0&&ht.push(new at(ot,mt,lt))}},$=[],_e=s.name||"default",tt=s.fps||30,nt=s.blendMode;let rt=s.length||-1;const it=s.hierarchy||[];for(let at=0;at<it.length;at++){const ot=it[at].keys;if(!(!ot||ot.length===0))if(ot[0].morphTargets){const ct={};let ft;for(ft=0;ft<ot.length;ft++)if(ot[ft].morphTargets)for(let ht=0;ht<ot[ft].morphTargets.length;ht++)ct[ot[ft].morphTargets[ht]]=-1;for(const ht in ct){const mt=[],lt=[];for(let ut=0;ut!==ot[ft].morphTargets.length;++ut){const dt=ot[ft];mt.push(dt.time),lt.push(dt.morphTarget===ht?1:0)}$.push(new NumberKeyframeTrack(".morphTargetInfluence["+ht+"]",mt,lt))}rt=ct.length*tt}else{const ct=".bones["+o[at].name+"]";j(VectorKeyframeTrack,ct+".position",ot,"pos",$),j(QuaternionKeyframeTrack,ct+".quaternion",ot,"rot",$),j(VectorKeyframeTrack,ct+".scale",ot,"scl",$)}}return $.length===0?null:new this(_e,rt,$,nt)}resetDuration(){const s=this.tracks;let o=0;for(let j=0,$=s.length;j!==$;++j){const _e=this.tracks[j];o=Math.max(o,_e.times[_e.times.length-1])}return this.duration=o,this}trim(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].trim(0,this.duration);return this}validate(){let s=!0;for(let o=0;o<this.tracks.length;o++)s=s&&this.tracks[o].validate();return s}optimize(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].optimize();return this}clone(){const s=[];for(let o=0;o<this.tracks.length;o++)s.push(this.tracks[o].clone());return new this.constructor(this.name,this.duration,s,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function parseKeyframeTrack(a){if(a.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const s=getTrackTypeForValueTypeName(a.type);if(a.times===void 0){const o=[],j=[];flattenJSON(a.keys,o,j,"value"),a.times=o,a.values=j}return s.parse!==void 0?s.parse(a):new s(a.name,a.times,a.values,a.interpolation)}const Cache={enabled:!1,files:{},add:function(a,s){this.enabled!==!1&&(this.files[a]=s)},get:function(a){if(this.enabled!==!1)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class LoadingManager{constructor(s,o,j){const $=this;let _e=!1,tt=0,nt=0,rt;const it=[];this.onStart=void 0,this.onLoad=s,this.onProgress=o,this.onError=j,this.itemStart=function(st){nt++,_e===!1&&$.onStart!==void 0&&$.onStart(st,tt,nt),_e=!0},this.itemEnd=function(st){tt++,$.onProgress!==void 0&&$.onProgress(st,tt,nt),tt===nt&&(_e=!1,$.onLoad!==void 0&&$.onLoad())},this.itemError=function(st){$.onError!==void 0&&$.onError(st)},this.resolveURL=function(st){return rt?rt(st):st},this.setURLModifier=function(st){return rt=st,this},this.addHandler=function(st,at){return it.push(st,at),this},this.removeHandler=function(st){const at=it.indexOf(st);return at!==-1&&it.splice(at,2),this},this.getHandler=function(st){for(let at=0,ot=it.length;at<ot;at+=2){const ct=it[at],ft=it[at+1];if(ct.global&&(ct.lastIndex=0),ct.test(st))return ft}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(s){this.manager=s!==void 0?s:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(s,o){const j=this;return new Promise(function($,_e){j.load(s,$,o,_e)})}parse(){}setCrossOrigin(s){return this.crossOrigin=s,this}setWithCredentials(s){return this.withCredentials=s,this}setPath(s){return this.path=s,this}setResourcePath(s){return this.resourcePath=s,this}setRequestHeader(s){return this.requestHeader=s,this}}const loading={};class HttpError extends Error{constructor(s,o){super(s),this.response=o}}class FileLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){s===void 0&&(s=""),this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const _e=Cache.get(s);if(_e!==void 0)return this.manager.itemStart(s),setTimeout(()=>{o&&o(_e),this.manager.itemEnd(s)},0),_e;if(loading[s]!==void 0){loading[s].push({onLoad:o,onProgress:j,onError:$});return}loading[s]=[],loading[s].push({onLoad:o,onProgress:j,onError:$});const tt=new Request(s,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),nt=this.mimeType,rt=this.responseType;fetch(tt).then(it=>{if(it.status===200||it.status===0){if(it.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||it.body===void 0||it.body.getReader===void 0)return it;const st=loading[s],at=it.body.getReader(),ot=it.headers.get("Content-Length")||it.headers.get("X-File-Size"),ct=ot?parseInt(ot):0,ft=ct!==0;let ht=0;const mt=new ReadableStream({start(lt){ut();function ut(){at.read().then(({done:dt,value:gt})=>{if(dt)lt.close();else{ht+=gt.byteLength;const Et=new ProgressEvent("progress",{lengthComputable:ft,loaded:ht,total:ct});for(let St=0,Tt=st.length;St<Tt;St++){const Mt=st[St];Mt.onProgress&&Mt.onProgress(Et)}lt.enqueue(gt),ut()}})}}});return new Response(mt)}else throw new HttpError(`fetch for "${it.url}" responded with ${it.status}: ${it.statusText}`,it)}).then(it=>{switch(rt){case"arraybuffer":return it.arrayBuffer();case"blob":return it.blob();case"document":return it.text().then(st=>new DOMParser().parseFromString(st,nt));case"json":return it.json();default:if(nt===void 0)return it.text();{const at=/charset="?([^;"\s]*)"?/i.exec(nt),ot=at&&at[1]?at[1].toLowerCase():void 0,ct=new TextDecoder(ot);return it.arrayBuffer().then(ft=>ct.decode(ft))}}}).then(it=>{Cache.add(s,it);const st=loading[s];delete loading[s];for(let at=0,ot=st.length;at<ot;at++){const ct=st[at];ct.onLoad&&ct.onLoad(it)}}).catch(it=>{const st=loading[s];if(st===void 0)throw this.manager.itemError(s),it;delete loading[s];for(let at=0,ot=st.length;at<ot;at++){const ct=st[at];ct.onError&&ct.onError(it)}this.manager.itemError(s)}).finally(()=>{this.manager.itemEnd(s)}),this.manager.itemStart(s)}setResponseType(s){return this.responseType=s,this}setMimeType(s){return this.mimeType=s,this}}class AnimationLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(JSON.parse(nt)))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=[];for(let j=0;j<s.length;j++){const $=AnimationClip.parse(s[j]);o.push($)}return o}}class CompressedTextureLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=[],nt=new CompressedTexture,rt=new FileLoader(this.manager);rt.setPath(this.path),rt.setResponseType("arraybuffer"),rt.setRequestHeader(this.requestHeader),rt.setWithCredentials(_e.withCredentials);let it=0;function st(at){rt.load(s[at],function(ot){const ct=_e.parse(ot,!0);tt[at]={width:ct.width,height:ct.height,format:ct.format,mipmaps:ct.mipmaps},it+=1,it===6&&(ct.mipmapCount===1&&(nt.minFilter=LinearFilter),nt.image=tt,nt.format=ct.format,nt.needsUpdate=!0,o&&o(nt))},j,$)}if(Array.isArray(s))for(let at=0,ot=s.length;at<ot;++at)st(at);else rt.load(s,function(at){const ot=_e.parse(at,!0);if(ot.isCubemap){const ct=ot.mipmaps.length/ot.mipmapCount;for(let ft=0;ft<ct;ft++){tt[ft]={mipmaps:[]};for(let ht=0;ht<ot.mipmapCount;ht++)tt[ft].mipmaps.push(ot.mipmaps[ft*ot.mipmapCount+ht]),tt[ft].format=ot.format,tt[ft].width=ot.width,tt[ft].height=ot.height}nt.image=tt}else nt.image.width=ot.width,nt.image.height=ot.height,nt.mipmaps=ot.mipmaps;ot.mipmapCount===1&&(nt.minFilter=LinearFilter),nt.format=ot.format,nt.needsUpdate=!0,o&&o(nt)},j,$);return nt}}class ImageLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const _e=this,tt=Cache.get(s);if(tt!==void 0)return _e.manager.itemStart(s),setTimeout(function(){o&&o(tt),_e.manager.itemEnd(s)},0),tt;const nt=createElementNS("img");function rt(){st(),Cache.add(s,this),o&&o(this),_e.manager.itemEnd(s)}function it(at){st(),$&&$(at),_e.manager.itemError(s),_e.manager.itemEnd(s)}function st(){nt.removeEventListener("load",rt,!1),nt.removeEventListener("error",it,!1)}return nt.addEventListener("load",rt,!1),nt.addEventListener("error",it,!1),s.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(nt.crossOrigin=this.crossOrigin),_e.manager.itemStart(s),nt.src=s,nt}}class CubeTextureLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=new CubeTexture;_e.colorSpace=SRGBColorSpace;const tt=new ImageLoader(this.manager);tt.setCrossOrigin(this.crossOrigin),tt.setPath(this.path);let nt=0;function rt(it){tt.load(s[it],function(st){_e.images[it]=st,nt++,nt===6&&(_e.needsUpdate=!0,o&&o(_e))},void 0,$)}for(let it=0;it<s.length;++it)rt(it);return _e}}class DataTextureLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new DataTexture,nt=new FileLoader(this.manager);return nt.setResponseType("arraybuffer"),nt.setRequestHeader(this.requestHeader),nt.setPath(this.path),nt.setWithCredentials(_e.withCredentials),nt.load(s,function(rt){const it=_e.parse(rt);it&&(it.image!==void 0?tt.image=it.image:it.data!==void 0&&(tt.image.width=it.width,tt.image.height=it.height,tt.image.data=it.data),tt.wrapS=it.wrapS!==void 0?it.wrapS:ClampToEdgeWrapping,tt.wrapT=it.wrapT!==void 0?it.wrapT:ClampToEdgeWrapping,tt.magFilter=it.magFilter!==void 0?it.magFilter:LinearFilter,tt.minFilter=it.minFilter!==void 0?it.minFilter:LinearFilter,tt.anisotropy=it.anisotropy!==void 0?it.anisotropy:1,it.colorSpace!==void 0?tt.colorSpace=it.colorSpace:it.encoding!==void 0&&(tt.encoding=it.encoding),it.flipY!==void 0&&(tt.flipY=it.flipY),it.format!==void 0&&(tt.format=it.format),it.type!==void 0&&(tt.type=it.type),it.mipmaps!==void 0&&(tt.mipmaps=it.mipmaps,tt.minFilter=LinearMipmapLinearFilter),it.mipmapCount===1&&(tt.minFilter=LinearFilter),it.generateMipmaps!==void 0&&(tt.generateMipmaps=it.generateMipmaps),tt.needsUpdate=!0,o&&o(tt,it))},j,$),tt}}class TextureLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=new Texture,tt=new ImageLoader(this.manager);return tt.setCrossOrigin(this.crossOrigin),tt.setPath(this.path),tt.load(s,function(nt){_e.image=nt,_e.needsUpdate=!0,o!==void 0&&o(_e)},j,$),_e}}class Light extends Object3D{constructor(s,o=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(s),this.intensity=o}dispose(){}copy(s,o){return super.copy(s,o),this.color.copy(s.color),this.intensity=s.intensity,this}toJSON(s){const o=super.toJSON(s);return o.object.color=this.color.getHex(),o.object.intensity=this.intensity,this.groundColor!==void 0&&(o.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(o.object.distance=this.distance),this.angle!==void 0&&(o.object.angle=this.angle),this.decay!==void 0&&(o.object.decay=this.decay),this.penumbra!==void 0&&(o.object.penumbra=this.penumbra),this.shadow!==void 0&&(o.object.shadow=this.shadow.toJSON()),o}}class HemisphereLight extends Light{constructor(s,o,j){super(s,j),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color(o)}copy(s,o){return super.copy(s,o),this.groundColor.copy(s.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(s){this.camera=s,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(s){const o=this.camera,j=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(s.matrixWorld),o.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(s.target.matrixWorld),o.lookAt(_lookTarget$1),o.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),j.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),j.multiply(_projScreenMatrix$1)}getViewport(s){return this._viewports[s]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(s){return this.camera=s.camera.clone(),this.bias=s.bias,this.radius=s.radius,this.mapSize.copy(s.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const s={};return this.bias!==0&&(s.bias=this.bias),this.normalBias!==0&&(s.normalBias=this.normalBias),this.radius!==1&&(s.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(s.mapSize=this.mapSize.toArray()),s.camera=this.camera.toJSON(!1).object,delete s.camera.matrix,s}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(s){const o=this.camera,j=RAD2DEG*2*s.angle*this.focus,$=this.mapSize.width/this.mapSize.height,_e=s.distance||o.far;(j!==o.fov||$!==o.aspect||_e!==o.far)&&(o.fov=j,o.aspect=$,o.far=_e,o.updateProjectionMatrix()),super.updateMatrices(s)}copy(s){return super.copy(s),this.focus=s.focus,this}}class SpotLight extends Light{constructor(s,o,j=0,$=Math.PI/3,_e=0,tt=2){super(s,o),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=j,this.angle=$,this.penumbra=_e,this.decay=tt,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(s){this.intensity=s/Math.PI}dispose(){this.shadow.dispose()}copy(s,o){return super.copy(s,o),this.distance=s.distance,this.angle=s.angle,this.penumbra=s.penumbra,this.decay=s.decay,this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(s,o=0){const j=this.camera,$=this.matrix,_e=s.distance||j.far;_e!==j.far&&(j.far=_e,j.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(s.matrixWorld),j.position.copy(_lightPositionWorld),_lookTarget.copy(j.position),_lookTarget.add(this._cubeDirections[o]),j.up.copy(this._cubeUps[o]),j.lookAt(_lookTarget),j.updateMatrixWorld(),$.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(j.projectionMatrix,j.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(s,o,j=0,$=2){super(s,o),this.isPointLight=!0,this.type="PointLight",this.distance=j,this.decay=$,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(s){this.intensity=s/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(s,o){return super.copy(s,o),this.distance=s.distance,this.decay=s.decay,this.shadow=s.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(s,o){super(s,o),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(s){return super.copy(s),this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}class AmbientLight extends Light{constructor(s,o){super(s,o),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(s,o,j=10,$=10){super(s,o),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=j,this.height=$}get power(){return this.intensity*this.width*this.height*Math.PI}set power(s){this.intensity=s/(this.width*this.height*Math.PI)}copy(s){return super.copy(s),this.width=s.width,this.height=s.height,this}toJSON(s){const o=super.toJSON(s);return o.object.width=this.width,o.object.height=this.height,o}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let s=0;s<9;s++)this.coefficients.push(new Vector3)}set(s){for(let o=0;o<9;o++)this.coefficients[o].copy(s[o]);return this}zero(){for(let s=0;s<9;s++)this.coefficients[s].set(0,0,0);return this}getAt(s,o){const j=s.x,$=s.y,_e=s.z,tt=this.coefficients;return o.copy(tt[0]).multiplyScalar(.282095),o.addScaledVector(tt[1],.488603*$),o.addScaledVector(tt[2],.488603*_e),o.addScaledVector(tt[3],.488603*j),o.addScaledVector(tt[4],1.092548*(j*$)),o.addScaledVector(tt[5],1.092548*($*_e)),o.addScaledVector(tt[6],.315392*(3*_e*_e-1)),o.addScaledVector(tt[7],1.092548*(j*_e)),o.addScaledVector(tt[8],.546274*(j*j-$*$)),o}getIrradianceAt(s,o){const j=s.x,$=s.y,_e=s.z,tt=this.coefficients;return o.copy(tt[0]).multiplyScalar(.886227),o.addScaledVector(tt[1],2*.511664*$),o.addScaledVector(tt[2],2*.511664*_e),o.addScaledVector(tt[3],2*.511664*j),o.addScaledVector(tt[4],2*.429043*j*$),o.addScaledVector(tt[5],2*.429043*$*_e),o.addScaledVector(tt[6],.743125*_e*_e-.247708),o.addScaledVector(tt[7],2*.429043*j*_e),o.addScaledVector(tt[8],.429043*(j*j-$*$)),o}add(s){for(let o=0;o<9;o++)this.coefficients[o].add(s.coefficients[o]);return this}addScaledSH(s,o){for(let j=0;j<9;j++)this.coefficients[j].addScaledVector(s.coefficients[j],o);return this}scale(s){for(let o=0;o<9;o++)this.coefficients[o].multiplyScalar(s);return this}lerp(s,o){for(let j=0;j<9;j++)this.coefficients[j].lerp(s.coefficients[j],o);return this}equals(s){for(let o=0;o<9;o++)if(!this.coefficients[o].equals(s.coefficients[o]))return!1;return!0}copy(s){return this.set(s.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(s,o=0){const j=this.coefficients;for(let $=0;$<9;$++)j[$].fromArray(s,o+$*3);return this}toArray(s=[],o=0){const j=this.coefficients;for(let $=0;$<9;$++)j[$].toArray(s,o+$*3);return s}static getBasisAt(s,o){const j=s.x,$=s.y,_e=s.z;o[0]=.282095,o[1]=.488603*$,o[2]=.488603*_e,o[3]=.488603*j,o[4]=1.092548*j*$,o[5]=1.092548*$*_e,o[6]=.315392*(3*_e*_e-1),o[7]=1.092548*j*_e,o[8]=.546274*(j*j-$*$)}}class LightProbe extends Light{constructor(s=new SphericalHarmonics3,o=1){super(void 0,o),this.isLightProbe=!0,this.sh=s}copy(s){return super.copy(s),this.sh.copy(s.sh),this}fromJSON(s){return this.intensity=s.intensity,this.sh.fromArray(s.sh),this}toJSON(s){const o=super.toJSON(s);return o.object.sh=this.sh.toArray(),o}}class MaterialLoader extends Loader{constructor(s){super(s),this.textures={}}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(JSON.parse(nt)))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=this.textures;function j(_e){return o[_e]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",_e),o[_e]}const $=MaterialLoader.createMaterialFromType(s.type);if(s.uuid!==void 0&&($.uuid=s.uuid),s.name!==void 0&&($.name=s.name),s.color!==void 0&&$.color!==void 0&&$.color.setHex(s.color),s.roughness!==void 0&&($.roughness=s.roughness),s.metalness!==void 0&&($.metalness=s.metalness),s.sheen!==void 0&&($.sheen=s.sheen),s.sheenColor!==void 0&&($.sheenColor=new Color().setHex(s.sheenColor)),s.sheenRoughness!==void 0&&($.sheenRoughness=s.sheenRoughness),s.emissive!==void 0&&$.emissive!==void 0&&$.emissive.setHex(s.emissive),s.specular!==void 0&&$.specular!==void 0&&$.specular.setHex(s.specular),s.specularIntensity!==void 0&&($.specularIntensity=s.specularIntensity),s.specularColor!==void 0&&$.specularColor!==void 0&&$.specularColor.setHex(s.specularColor),s.shininess!==void 0&&($.shininess=s.shininess),s.clearcoat!==void 0&&($.clearcoat=s.clearcoat),s.clearcoatRoughness!==void 0&&($.clearcoatRoughness=s.clearcoatRoughness),s.iridescence!==void 0&&($.iridescence=s.iridescence),s.iridescenceIOR!==void 0&&($.iridescenceIOR=s.iridescenceIOR),s.iridescenceThicknessRange!==void 0&&($.iridescenceThicknessRange=s.iridescenceThicknessRange),s.transmission!==void 0&&($.transmission=s.transmission),s.thickness!==void 0&&($.thickness=s.thickness),s.attenuationDistance!==void 0&&($.attenuationDistance=s.attenuationDistance),s.attenuationColor!==void 0&&$.attenuationColor!==void 0&&$.attenuationColor.setHex(s.attenuationColor),s.anisotropy!==void 0&&($.anisotropy=s.anisotropy),s.anisotropyRotation!==void 0&&($.anisotropyRotation=s.anisotropyRotation),s.fog!==void 0&&($.fog=s.fog),s.flatShading!==void 0&&($.flatShading=s.flatShading),s.blending!==void 0&&($.blending=s.blending),s.combine!==void 0&&($.combine=s.combine),s.side!==void 0&&($.side=s.side),s.shadowSide!==void 0&&($.shadowSide=s.shadowSide),s.opacity!==void 0&&($.opacity=s.opacity),s.transparent!==void 0&&($.transparent=s.transparent),s.alphaTest!==void 0&&($.alphaTest=s.alphaTest),s.depthTest!==void 0&&($.depthTest=s.depthTest),s.depthWrite!==void 0&&($.depthWrite=s.depthWrite),s.colorWrite!==void 0&&($.colorWrite=s.colorWrite),s.stencilWrite!==void 0&&($.stencilWrite=s.stencilWrite),s.stencilWriteMask!==void 0&&($.stencilWriteMask=s.stencilWriteMask),s.stencilFunc!==void 0&&($.stencilFunc=s.stencilFunc),s.stencilRef!==void 0&&($.stencilRef=s.stencilRef),s.stencilFuncMask!==void 0&&($.stencilFuncMask=s.stencilFuncMask),s.stencilFail!==void 0&&($.stencilFail=s.stencilFail),s.stencilZFail!==void 0&&($.stencilZFail=s.stencilZFail),s.stencilZPass!==void 0&&($.stencilZPass=s.stencilZPass),s.wireframe!==void 0&&($.wireframe=s.wireframe),s.wireframeLinewidth!==void 0&&($.wireframeLinewidth=s.wireframeLinewidth),s.wireframeLinecap!==void 0&&($.wireframeLinecap=s.wireframeLinecap),s.wireframeLinejoin!==void 0&&($.wireframeLinejoin=s.wireframeLinejoin),s.rotation!==void 0&&($.rotation=s.rotation),s.linewidth!==1&&($.linewidth=s.linewidth),s.dashSize!==void 0&&($.dashSize=s.dashSize),s.gapSize!==void 0&&($.gapSize=s.gapSize),s.scale!==void 0&&($.scale=s.scale),s.polygonOffset!==void 0&&($.polygonOffset=s.polygonOffset),s.polygonOffsetFactor!==void 0&&($.polygonOffsetFactor=s.polygonOffsetFactor),s.polygonOffsetUnits!==void 0&&($.polygonOffsetUnits=s.polygonOffsetUnits),s.dithering!==void 0&&($.dithering=s.dithering),s.alphaToCoverage!==void 0&&($.alphaToCoverage=s.alphaToCoverage),s.premultipliedAlpha!==void 0&&($.premultipliedAlpha=s.premultipliedAlpha),s.forceSinglePass!==void 0&&($.forceSinglePass=s.forceSinglePass),s.visible!==void 0&&($.visible=s.visible),s.toneMapped!==void 0&&($.toneMapped=s.toneMapped),s.userData!==void 0&&($.userData=s.userData),s.vertexColors!==void 0&&(typeof s.vertexColors=="number"?$.vertexColors=s.vertexColors>0:$.vertexColors=s.vertexColors),s.uniforms!==void 0)for(const _e in s.uniforms){const tt=s.uniforms[_e];switch($.uniforms[_e]={},tt.type){case"t":$.uniforms[_e].value=j(tt.value);break;case"c":$.uniforms[_e].value=new Color().setHex(tt.value);break;case"v2":$.uniforms[_e].value=new Vector2().fromArray(tt.value);break;case"v3":$.uniforms[_e].value=new Vector3().fromArray(tt.value);break;case"v4":$.uniforms[_e].value=new Vector4().fromArray(tt.value);break;case"m3":$.uniforms[_e].value=new Matrix3().fromArray(tt.value);break;case"m4":$.uniforms[_e].value=new Matrix4().fromArray(tt.value);break;default:$.uniforms[_e].value=tt.value}}if(s.defines!==void 0&&($.defines=s.defines),s.vertexShader!==void 0&&($.vertexShader=s.vertexShader),s.fragmentShader!==void 0&&($.fragmentShader=s.fragmentShader),s.glslVersion!==void 0&&($.glslVersion=s.glslVersion),s.extensions!==void 0)for(const _e in s.extensions)$.extensions[_e]=s.extensions[_e];if(s.lights!==void 0&&($.lights=s.lights),s.clipping!==void 0&&($.clipping=s.clipping),s.size!==void 0&&($.size=s.size),s.sizeAttenuation!==void 0&&($.sizeAttenuation=s.sizeAttenuation),s.map!==void 0&&($.map=j(s.map)),s.matcap!==void 0&&($.matcap=j(s.matcap)),s.alphaMap!==void 0&&($.alphaMap=j(s.alphaMap)),s.bumpMap!==void 0&&($.bumpMap=j(s.bumpMap)),s.bumpScale!==void 0&&($.bumpScale=s.bumpScale),s.normalMap!==void 0&&($.normalMap=j(s.normalMap)),s.normalMapType!==void 0&&($.normalMapType=s.normalMapType),s.normalScale!==void 0){let _e=s.normalScale;Array.isArray(_e)===!1&&(_e=[_e,_e]),$.normalScale=new Vector2().fromArray(_e)}return s.displacementMap!==void 0&&($.displacementMap=j(s.displacementMap)),s.displacementScale!==void 0&&($.displacementScale=s.displacementScale),s.displacementBias!==void 0&&($.displacementBias=s.displacementBias),s.roughnessMap!==void 0&&($.roughnessMap=j(s.roughnessMap)),s.metalnessMap!==void 0&&($.metalnessMap=j(s.metalnessMap)),s.emissiveMap!==void 0&&($.emissiveMap=j(s.emissiveMap)),s.emissiveIntensity!==void 0&&($.emissiveIntensity=s.emissiveIntensity),s.specularMap!==void 0&&($.specularMap=j(s.specularMap)),s.specularIntensityMap!==void 0&&($.specularIntensityMap=j(s.specularIntensityMap)),s.specularColorMap!==void 0&&($.specularColorMap=j(s.specularColorMap)),s.envMap!==void 0&&($.envMap=j(s.envMap)),s.envMapIntensity!==void 0&&($.envMapIntensity=s.envMapIntensity),s.reflectivity!==void 0&&($.reflectivity=s.reflectivity),s.refractionRatio!==void 0&&($.refractionRatio=s.refractionRatio),s.lightMap!==void 0&&($.lightMap=j(s.lightMap)),s.lightMapIntensity!==void 0&&($.lightMapIntensity=s.lightMapIntensity),s.aoMap!==void 0&&($.aoMap=j(s.aoMap)),s.aoMapIntensity!==void 0&&($.aoMapIntensity=s.aoMapIntensity),s.gradientMap!==void 0&&($.gradientMap=j(s.gradientMap)),s.clearcoatMap!==void 0&&($.clearcoatMap=j(s.clearcoatMap)),s.clearcoatRoughnessMap!==void 0&&($.clearcoatRoughnessMap=j(s.clearcoatRoughnessMap)),s.clearcoatNormalMap!==void 0&&($.clearcoatNormalMap=j(s.clearcoatNormalMap)),s.clearcoatNormalScale!==void 0&&($.clearcoatNormalScale=new Vector2().fromArray(s.clearcoatNormalScale)),s.iridescenceMap!==void 0&&($.iridescenceMap=j(s.iridescenceMap)),s.iridescenceThicknessMap!==void 0&&($.iridescenceThicknessMap=j(s.iridescenceThicknessMap)),s.transmissionMap!==void 0&&($.transmissionMap=j(s.transmissionMap)),s.thicknessMap!==void 0&&($.thicknessMap=j(s.thicknessMap)),s.anisotropyMap!==void 0&&($.anisotropyMap=j(s.anisotropyMap)),s.sheenColorMap!==void 0&&($.sheenColorMap=j(s.sheenColorMap)),s.sheenRoughnessMap!==void 0&&($.sheenRoughnessMap=j(s.sheenRoughnessMap)),$}setTextures(s){return this.textures=s,this}static createMaterialFromType(s){const o={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new o[s]}}class LoaderUtils{static decodeText(s){if(typeof TextDecoder<"u")return new TextDecoder().decode(s);let o="";for(let j=0,$=s.length;j<$;j++)o+=String.fromCharCode(s[j]);try{return decodeURIComponent(escape(o))}catch{return o}}static extractUrlBase(s){const o=s.lastIndexOf("/");return o===-1?"./":s.slice(0,o+1)}static resolveURL(s,o){return typeof s!="string"||s===""?"":(/^https?:\/\//i.test(o)&&/^\//.test(s)&&(o=o.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(s)||/^data:.*,.*$/i.test(s)||/^blob:.*$/i.test(s)?s:o+s)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(s){return super.copy(s),this.instanceCount=s.instanceCount,this}toJSON(){const s=super.toJSON();return s.instanceCount=this.instanceCount,s.isInstancedBufferGeometry=!0,s}}class BufferGeometryLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(JSON.parse(nt)))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o={},j={};function $(ct,ft){if(o[ft]!==void 0)return o[ft];const mt=ct.interleavedBuffers[ft],lt=_e(ct,mt.buffer),ut=getTypedArray(mt.type,lt),dt=new InterleavedBuffer(ut,mt.stride);return dt.uuid=mt.uuid,o[ft]=dt,dt}function _e(ct,ft){if(j[ft]!==void 0)return j[ft];const mt=ct.arrayBuffers[ft],lt=new Uint32Array(mt).buffer;return j[ft]=lt,lt}const tt=s.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,nt=s.data.index;if(nt!==void 0){const ct=getTypedArray(nt.type,nt.array);tt.setIndex(new BufferAttribute(ct,1))}const rt=s.data.attributes;for(const ct in rt){const ft=rt[ct];let ht;if(ft.isInterleavedBufferAttribute){const mt=$(s.data,ft.data);ht=new InterleavedBufferAttribute(mt,ft.itemSize,ft.offset,ft.normalized)}else{const mt=getTypedArray(ft.type,ft.array),lt=ft.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;ht=new lt(mt,ft.itemSize,ft.normalized)}ft.name!==void 0&&(ht.name=ft.name),ft.usage!==void 0&&ht.setUsage(ft.usage),ft.updateRange!==void 0&&(ht.updateRange.offset=ft.updateRange.offset,ht.updateRange.count=ft.updateRange.count),tt.setAttribute(ct,ht)}const it=s.data.morphAttributes;if(it)for(const ct in it){const ft=it[ct],ht=[];for(let mt=0,lt=ft.length;mt<lt;mt++){const ut=ft[mt];let dt;if(ut.isInterleavedBufferAttribute){const gt=$(s.data,ut.data);dt=new InterleavedBufferAttribute(gt,ut.itemSize,ut.offset,ut.normalized)}else{const gt=getTypedArray(ut.type,ut.array);dt=new BufferAttribute(gt,ut.itemSize,ut.normalized)}ut.name!==void 0&&(dt.name=ut.name),ht.push(dt)}tt.morphAttributes[ct]=ht}s.data.morphTargetsRelative&&(tt.morphTargetsRelative=!0);const at=s.data.groups||s.data.drawcalls||s.data.offsets;if(at!==void 0)for(let ct=0,ft=at.length;ct!==ft;++ct){const ht=at[ct];tt.addGroup(ht.start,ht.count,ht.materialIndex)}const ot=s.data.boundingSphere;if(ot!==void 0){const ct=new Vector3;ot.center!==void 0&&ct.fromArray(ot.center),tt.boundingSphere=new Sphere(ct,ot.radius)}return s.name&&(tt.name=s.name),s.userData&&(tt.userData=s.userData),tt}}class ObjectLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=this.path===""?LoaderUtils.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||tt;const nt=new FileLoader(this.manager);nt.setPath(this.path),nt.setRequestHeader(this.requestHeader),nt.setWithCredentials(this.withCredentials),nt.load(s,function(rt){let it=null;try{it=JSON.parse(rt)}catch(at){$!==void 0&&$(at),console.error("THREE:ObjectLoader: Can't parse "+s+".",at.message);return}const st=it.metadata;if(st===void 0||st.type===void 0||st.type.toLowerCase()==="geometry"){$!==void 0&&$(new Error("THREE.ObjectLoader: Can't load "+s)),console.error("THREE.ObjectLoader: Can't load "+s);return}_e.parse(it,o)},j,$)}async loadAsync(s,o){const j=this,$=this.path===""?LoaderUtils.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||$;const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials);const tt=await _e.loadAsync(s,o),nt=JSON.parse(tt),rt=nt.metadata;if(rt===void 0||rt.type===void 0||rt.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+s);return await j.parseAsync(nt)}parse(s,o){const j=this.parseAnimations(s.animations),$=this.parseShapes(s.shapes),_e=this.parseGeometries(s.geometries,$),tt=this.parseImages(s.images,function(){o!==void 0&&o(it)}),nt=this.parseTextures(s.textures,tt),rt=this.parseMaterials(s.materials,nt),it=this.parseObject(s.object,_e,rt,nt,j),st=this.parseSkeletons(s.skeletons,it);if(this.bindSkeletons(it,st),o!==void 0){let at=!1;for(const ot in tt)if(tt[ot].data instanceof HTMLImageElement){at=!0;break}at===!1&&o(it)}return it}async parseAsync(s){const o=this.parseAnimations(s.animations),j=this.parseShapes(s.shapes),$=this.parseGeometries(s.geometries,j),_e=await this.parseImagesAsync(s.images),tt=this.parseTextures(s.textures,_e),nt=this.parseMaterials(s.materials,tt),rt=this.parseObject(s.object,$,nt,tt,o),it=this.parseSkeletons(s.skeletons,rt);return this.bindSkeletons(rt,it),rt}parseShapes(s){const o={};if(s!==void 0)for(let j=0,$=s.length;j<$;j++){const _e=new Shape().fromJSON(s[j]);o[_e.uuid]=_e}return o}parseSkeletons(s,o){const j={},$={};if(o.traverse(function(_e){_e.isBone&&($[_e.uuid]=_e)}),s!==void 0)for(let _e=0,tt=s.length;_e<tt;_e++){const nt=new Skeleton().fromJSON(s[_e],$);j[nt.uuid]=nt}return j}parseGeometries(s,o){const j={};if(s!==void 0){const $=new BufferGeometryLoader;for(let _e=0,tt=s.length;_e<tt;_e++){let nt;const rt=s[_e];switch(rt.type){case"BufferGeometry":case"InstancedBufferGeometry":nt=$.parse(rt);break;default:rt.type in Geometries?nt=Geometries[rt.type].fromJSON(rt,o):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${rt.type}"`)}nt.uuid=rt.uuid,rt.name!==void 0&&(nt.name=rt.name),rt.userData!==void 0&&(nt.userData=rt.userData),j[rt.uuid]=nt}}return j}parseMaterials(s,o){const j={},$={};if(s!==void 0){const _e=new MaterialLoader;_e.setTextures(o);for(let tt=0,nt=s.length;tt<nt;tt++){const rt=s[tt];j[rt.uuid]===void 0&&(j[rt.uuid]=_e.parse(rt)),$[rt.uuid]=j[rt.uuid]}}return $}parseAnimations(s){const o={};if(s!==void 0)for(let j=0;j<s.length;j++){const $=s[j],_e=AnimationClip.parse($);o[_e.uuid]=_e}return o}parseImages(s,o){const j=this,$={};let _e;function tt(rt){return j.manager.itemStart(rt),_e.load(rt,function(){j.manager.itemEnd(rt)},void 0,function(){j.manager.itemError(rt),j.manager.itemEnd(rt)})}function nt(rt){if(typeof rt=="string"){const it=rt,st=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(it)?it:j.resourcePath+it;return tt(st)}else return rt.data?{data:getTypedArray(rt.type,rt.data),width:rt.width,height:rt.height}:null}if(s!==void 0&&s.length>0){const rt=new LoadingManager(o);_e=new ImageLoader(rt),_e.setCrossOrigin(this.crossOrigin);for(let it=0,st=s.length;it<st;it++){const at=s[it],ot=at.url;if(Array.isArray(ot)){const ct=[];for(let ft=0,ht=ot.length;ft<ht;ft++){const mt=ot[ft],lt=nt(mt);lt!==null&&(lt instanceof HTMLImageElement?ct.push(lt):ct.push(new DataTexture(lt.data,lt.width,lt.height)))}$[at.uuid]=new Source(ct)}else{const ct=nt(at.url);$[at.uuid]=new Source(ct)}}}return $}async parseImagesAsync(s){const o=this,j={};let $;async function _e(tt){if(typeof tt=="string"){const nt=tt,rt=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(nt)?nt:o.resourcePath+nt;return await $.loadAsync(rt)}else return tt.data?{data:getTypedArray(tt.type,tt.data),width:tt.width,height:tt.height}:null}if(s!==void 0&&s.length>0){$=new ImageLoader(this.manager),$.setCrossOrigin(this.crossOrigin);for(let tt=0,nt=s.length;tt<nt;tt++){const rt=s[tt],it=rt.url;if(Array.isArray(it)){const st=[];for(let at=0,ot=it.length;at<ot;at++){const ct=it[at],ft=await _e(ct);ft!==null&&(ft instanceof HTMLImageElement?st.push(ft):st.push(new DataTexture(ft.data,ft.width,ft.height)))}j[rt.uuid]=new Source(st)}else{const st=await _e(rt.url);j[rt.uuid]=new Source(st)}}}return j}parseTextures(s,o){function j(_e,tt){return typeof _e=="number"?_e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",_e),tt[_e])}const $={};if(s!==void 0)for(let _e=0,tt=s.length;_e<tt;_e++){const nt=s[_e];nt.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',nt.uuid),o[nt.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",nt.image);const rt=o[nt.image],it=rt.data;let st;Array.isArray(it)?(st=new CubeTexture,it.length===6&&(st.needsUpdate=!0)):(it&&it.data?st=new DataTexture:st=new Texture,it&&(st.needsUpdate=!0)),st.source=rt,st.uuid=nt.uuid,nt.name!==void 0&&(st.name=nt.name),nt.mapping!==void 0&&(st.mapping=j(nt.mapping,TEXTURE_MAPPING)),nt.channel!==void 0&&(st.channel=nt.channel),nt.offset!==void 0&&st.offset.fromArray(nt.offset),nt.repeat!==void 0&&st.repeat.fromArray(nt.repeat),nt.center!==void 0&&st.center.fromArray(nt.center),nt.rotation!==void 0&&(st.rotation=nt.rotation),nt.wrap!==void 0&&(st.wrapS=j(nt.wrap[0],TEXTURE_WRAPPING),st.wrapT=j(nt.wrap[1],TEXTURE_WRAPPING)),nt.format!==void 0&&(st.format=nt.format),nt.internalFormat!==void 0&&(st.internalFormat=nt.internalFormat),nt.type!==void 0&&(st.type=nt.type),nt.colorSpace!==void 0&&(st.colorSpace=nt.colorSpace),nt.encoding!==void 0&&(st.encoding=nt.encoding),nt.minFilter!==void 0&&(st.minFilter=j(nt.minFilter,TEXTURE_FILTER)),nt.magFilter!==void 0&&(st.magFilter=j(nt.magFilter,TEXTURE_FILTER)),nt.anisotropy!==void 0&&(st.anisotropy=nt.anisotropy),nt.flipY!==void 0&&(st.flipY=nt.flipY),nt.generateMipmaps!==void 0&&(st.generateMipmaps=nt.generateMipmaps),nt.premultiplyAlpha!==void 0&&(st.premultiplyAlpha=nt.premultiplyAlpha),nt.unpackAlignment!==void 0&&(st.unpackAlignment=nt.unpackAlignment),nt.compareFunction!==void 0&&(st.compareFunction=nt.compareFunction),nt.userData!==void 0&&(st.userData=nt.userData),$[nt.uuid]=st}return $}parseObject(s,o,j,$,_e){let tt;function nt(ot){return o[ot]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",ot),o[ot]}function rt(ot){if(ot!==void 0){if(Array.isArray(ot)){const ct=[];for(let ft=0,ht=ot.length;ft<ht;ft++){const mt=ot[ft];j[mt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",mt),ct.push(j[mt])}return ct}return j[ot]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ot),j[ot]}}function it(ot){return $[ot]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",ot),$[ot]}let st,at;switch(s.type){case"Scene":tt=new Scene,s.background!==void 0&&(Number.isInteger(s.background)?tt.background=new Color(s.background):tt.background=it(s.background)),s.environment!==void 0&&(tt.environment=it(s.environment)),s.fog!==void 0&&(s.fog.type==="Fog"?tt.fog=new Fog(s.fog.color,s.fog.near,s.fog.far):s.fog.type==="FogExp2"&&(tt.fog=new FogExp2(s.fog.color,s.fog.density))),s.backgroundBlurriness!==void 0&&(tt.backgroundBlurriness=s.backgroundBlurriness),s.backgroundIntensity!==void 0&&(tt.backgroundIntensity=s.backgroundIntensity);break;case"PerspectiveCamera":tt=new PerspectiveCamera(s.fov,s.aspect,s.near,s.far),s.focus!==void 0&&(tt.focus=s.focus),s.zoom!==void 0&&(tt.zoom=s.zoom),s.filmGauge!==void 0&&(tt.filmGauge=s.filmGauge),s.filmOffset!==void 0&&(tt.filmOffset=s.filmOffset),s.view!==void 0&&(tt.view=Object.assign({},s.view));break;case"OrthographicCamera":tt=new OrthographicCamera(s.left,s.right,s.top,s.bottom,s.near,s.far),s.zoom!==void 0&&(tt.zoom=s.zoom),s.view!==void 0&&(tt.view=Object.assign({},s.view));break;case"AmbientLight":tt=new AmbientLight(s.color,s.intensity);break;case"DirectionalLight":tt=new DirectionalLight(s.color,s.intensity);break;case"PointLight":tt=new PointLight(s.color,s.intensity,s.distance,s.decay);break;case"RectAreaLight":tt=new RectAreaLight(s.color,s.intensity,s.width,s.height);break;case"SpotLight":tt=new SpotLight(s.color,s.intensity,s.distance,s.angle,s.penumbra,s.decay);break;case"HemisphereLight":tt=new HemisphereLight(s.color,s.groundColor,s.intensity);break;case"LightProbe":tt=new LightProbe().fromJSON(s);break;case"SkinnedMesh":st=nt(s.geometry),at=rt(s.material),tt=new SkinnedMesh(st,at),s.bindMode!==void 0&&(tt.bindMode=s.bindMode),s.bindMatrix!==void 0&&tt.bindMatrix.fromArray(s.bindMatrix),s.skeleton!==void 0&&(tt.skeleton=s.skeleton);break;case"Mesh":st=nt(s.geometry),at=rt(s.material),tt=new Mesh(st,at);break;case"InstancedMesh":st=nt(s.geometry),at=rt(s.material);const ot=s.count,ct=s.instanceMatrix,ft=s.instanceColor;tt=new InstancedMesh(st,at,ot),tt.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ct.array),16),ft!==void 0&&(tt.instanceColor=new InstancedBufferAttribute(new Float32Array(ft.array),ft.itemSize));break;case"LOD":tt=new LOD;break;case"Line":tt=new Line(nt(s.geometry),rt(s.material));break;case"LineLoop":tt=new LineLoop(nt(s.geometry),rt(s.material));break;case"LineSegments":tt=new LineSegments(nt(s.geometry),rt(s.material));break;case"PointCloud":case"Points":tt=new Points(nt(s.geometry),rt(s.material));break;case"Sprite":tt=new Sprite(rt(s.material));break;case"Group":tt=new Group;break;case"Bone":tt=new Bone;break;default:tt=new Object3D}if(tt.uuid=s.uuid,s.name!==void 0&&(tt.name=s.name),s.matrix!==void 0?(tt.matrix.fromArray(s.matrix),s.matrixAutoUpdate!==void 0&&(tt.matrixAutoUpdate=s.matrixAutoUpdate),tt.matrixAutoUpdate&&tt.matrix.decompose(tt.position,tt.quaternion,tt.scale)):(s.position!==void 0&&tt.position.fromArray(s.position),s.rotation!==void 0&&tt.rotation.fromArray(s.rotation),s.quaternion!==void 0&&tt.quaternion.fromArray(s.quaternion),s.scale!==void 0&&tt.scale.fromArray(s.scale)),s.up!==void 0&&tt.up.fromArray(s.up),s.castShadow!==void 0&&(tt.castShadow=s.castShadow),s.receiveShadow!==void 0&&(tt.receiveShadow=s.receiveShadow),s.shadow&&(s.shadow.bias!==void 0&&(tt.shadow.bias=s.shadow.bias),s.shadow.normalBias!==void 0&&(tt.shadow.normalBias=s.shadow.normalBias),s.shadow.radius!==void 0&&(tt.shadow.radius=s.shadow.radius),s.shadow.mapSize!==void 0&&tt.shadow.mapSize.fromArray(s.shadow.mapSize),s.shadow.camera!==void 0&&(tt.shadow.camera=this.parseObject(s.shadow.camera))),s.visible!==void 0&&(tt.visible=s.visible),s.frustumCulled!==void 0&&(tt.frustumCulled=s.frustumCulled),s.renderOrder!==void 0&&(tt.renderOrder=s.renderOrder),s.userData!==void 0&&(tt.userData=s.userData),s.layers!==void 0&&(tt.layers.mask=s.layers),s.children!==void 0){const ot=s.children;for(let ct=0;ct<ot.length;ct++)tt.add(this.parseObject(ot[ct],o,j,$,_e))}if(s.animations!==void 0){const ot=s.animations;for(let ct=0;ct<ot.length;ct++){const ft=ot[ct];tt.animations.push(_e[ft])}}if(s.type==="LOD"){s.autoUpdate!==void 0&&(tt.autoUpdate=s.autoUpdate);const ot=s.levels;for(let ct=0;ct<ot.length;ct++){const ft=ot[ct],ht=tt.getObjectByProperty("uuid",ft.object);ht!==void 0&&tt.addLevel(ht,ft.distance,ft.hysteresis)}}return tt}bindSkeletons(s,o){Object.keys(o).length!==0&&s.traverse(function(j){if(j.isSkinnedMesh===!0&&j.skeleton!==void 0){const $=o[j.skeleton];$===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",j.skeleton):j.bind($,j.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(s){super(s),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(s){return this.options=s,this}load(s,o,j,$){s===void 0&&(s=""),this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const _e=this,tt=Cache.get(s);if(tt!==void 0)return _e.manager.itemStart(s),setTimeout(function(){o&&o(tt),_e.manager.itemEnd(s)},0),tt;const nt={};nt.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",nt.headers=this.requestHeader,fetch(s,nt).then(function(rt){return rt.blob()}).then(function(rt){return createImageBitmap(rt,Object.assign(_e.options,{colorSpaceConversion:"none"}))}).then(function(rt){Cache.add(s,rt),o&&o(rt),_e.manager.itemEnd(s)}).catch(function(rt){$&&$(rt),_e.manager.itemError(s),_e.manager.itemEnd(s)}),_e.manager.itemStart(s)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(s){_context=s}}class AudioLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setResponseType("arraybuffer"),tt.setPath(this.path),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(rt){try{const it=rt.slice(0);AudioContext.getContext().decodeAudioData(it,function(at){o(at)},nt)}catch(it){nt(it)}},j,$);function nt(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}}}class HemisphereLightProbe extends LightProbe{constructor(s,o,j=1){super(void 0,j),this.isHemisphereLightProbe=!0;const $=new Color().set(s),_e=new Color().set(o),tt=new Vector3($.r,$.g,$.b),nt=new Vector3(_e.r,_e.g,_e.b),rt=Math.sqrt(Math.PI),it=rt*Math.sqrt(.75);this.sh.coefficients[0].copy(tt).add(nt).multiplyScalar(rt),this.sh.coefficients[1].copy(tt).sub(nt).multiplyScalar(it)}}class AmbientLightProbe extends LightProbe{constructor(s,o=1){super(void 0,o),this.isAmbientLightProbe=!0;const j=new Color().set(s);this.sh.coefficients[0].set(j.r,j.g,j.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(s){const o=this._cache;if(o.focus!==s.focus||o.fov!==s.fov||o.aspect!==s.aspect*this.aspect||o.near!==s.near||o.far!==s.far||o.zoom!==s.zoom||o.eyeSep!==this.eyeSep){o.focus=s.focus,o.fov=s.fov,o.aspect=s.aspect*this.aspect,o.near=s.near,o.far=s.far,o.zoom=s.zoom,o.eyeSep=this.eyeSep,_projectionMatrix.copy(s.projectionMatrix);const $=o.eyeSep/2,_e=$*o.near/o.focus,tt=o.near*Math.tan(DEG2RAD*o.fov*.5)/o.zoom;let nt,rt;_eyeLeft.elements[12]=-$,_eyeRight.elements[12]=$,nt=-tt*o.aspect+_e,rt=tt*o.aspect+_e,_projectionMatrix.elements[0]=2*o.near/(rt-nt),_projectionMatrix.elements[8]=(rt+nt)/(rt-nt),this.cameraL.projectionMatrix.copy(_projectionMatrix),nt=-tt*o.aspect-_e,rt=tt*o.aspect-_e,_projectionMatrix.elements[0]=2*o.near/(rt-nt),_projectionMatrix.elements[8]=(rt+nt)/(rt-nt),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(s=!0){this.autoStart=s,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let s=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const o=now();s=(o-this.oldTime)/1e3,this.oldTime=o,this.elapsedTime+=s}return s}}function now(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(s){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=s,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}updateMatrixWorld(s){super.updateMatrixWorld(s);const o=this.context.listener,j=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),o.positionX){const $=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(_position$1.x,$),o.positionY.linearRampToValueAtTime(_position$1.y,$),o.positionZ.linearRampToValueAtTime(_position$1.z,$),o.forwardX.linearRampToValueAtTime(_orientation$1.x,$),o.forwardY.linearRampToValueAtTime(_orientation$1.y,$),o.forwardZ.linearRampToValueAtTime(_orientation$1.z,$),o.upX.linearRampToValueAtTime(j.x,$),o.upY.linearRampToValueAtTime(j.y,$),o.upZ.linearRampToValueAtTime(j.z,$)}else o.setPosition(_position$1.x,_position$1.y,_position$1.z),o.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,j.x,j.y,j.z)}}class Audio extends Object3D{constructor(s){super(),this.type="Audio",this.listener=s,this.context=s.context,this.gain=this.context.createGain(),this.gain.connect(s.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(s){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=s,this.connect(),this}setMediaElementSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(s),this.connect(),this}setMediaStreamSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(s),this.connect(),this}setBuffer(s){return this.buffer=s,this.sourceType="buffer",this.autoplay&&this.play(),this}play(s=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+s;const o=this.context.createBufferSource();return o.buffer=this.buffer,o.loop=this.loop,o.loopStart=this.loopStart,o.loopEnd=this.loopEnd,o.onended=this.onEnded.bind(this),o.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=o,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let s=1,o=this.filters.length;s<o;s++)this.filters[s-1].connect(this.filters[s]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let s=1,o=this.filters.length;s<o;s++)this.filters[s-1].disconnect(this.filters[s]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(s){return s||(s=[]),this._connected===!0?(this.disconnect(),this.filters=s.slice(),this.connect()):this.filters=s.slice(),this}setDetune(s){if(this.detune=s,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(s){return this.setFilters(s?[s]:[])}setPlaybackRate(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=s,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=s,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(s){return this.loopStart=s,this}setLoopEnd(s){return this.loopEnd=s,this}getVolume(){return this.gain.gain.value}setVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}}const _position$4=new Vector3,_quaternion$5=new Quaternion,_scale$3=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(s){super(s),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(s){return this.panner.refDistance=s,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(s){return this.panner.rolloffFactor=s,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(s){return this.panner.distanceModel=s,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(s){return this.panner.maxDistance=s,this}setDirectionalCone(s,o,j){return this.panner.coneInnerAngle=s,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=j,this}updateMatrixWorld(s){if(super.updateMatrixWorld(s),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position$4,_quaternion$5,_scale$3),_orientation.set(0,0,1).applyQuaternion(_quaternion$5);const o=this.panner;if(o.positionX){const j=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(_position$4.x,j),o.positionY.linearRampToValueAtTime(_position$4.y,j),o.positionZ.linearRampToValueAtTime(_position$4.z,j),o.orientationX.linearRampToValueAtTime(_orientation.x,j),o.orientationY.linearRampToValueAtTime(_orientation.y,j),o.orientationZ.linearRampToValueAtTime(_orientation.z,j)}else o.setPosition(_position$4.x,_position$4.y,_position$4.z),o.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(s,o=2048){this.analyser=s.context.createAnalyser(),this.analyser.fftSize=o,this.data=new Uint8Array(this.analyser.frequencyBinCount),s.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let s=0;const o=this.getFrequencyData();for(let j=0;j<o.length;j++)s+=o[j];return s/o.length}}class PropertyMixer{constructor(s,o,j){this.binding=s,this.valueSize=j;let $,_e,tt;switch(o){case"quaternion":$=this._slerp,_e=this._slerpAdditive,tt=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(j*6),this._workIndex=5;break;case"string":case"bool":$=this._select,_e=this._select,tt=this._setAdditiveIdentityOther,this.buffer=new Array(j*5);break;default:$=this._lerp,_e=this._lerpAdditive,tt=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(j*5)}this._mixBufferRegion=$,this._mixBufferRegionAdditive=_e,this._setIdentity=tt,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(s,o){const j=this.buffer,$=this.valueSize,_e=s*$+$;let tt=this.cumulativeWeight;if(tt===0){for(let nt=0;nt!==$;++nt)j[_e+nt]=j[nt];tt=o}else{tt+=o;const nt=o/tt;this._mixBufferRegion(j,_e,0,nt,$)}this.cumulativeWeight=tt}accumulateAdditive(s){const o=this.buffer,j=this.valueSize,$=j*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(o,$,0,s,j),this.cumulativeWeightAdditive+=s}apply(s){const o=this.valueSize,j=this.buffer,$=s*o+o,_e=this.cumulativeWeight,tt=this.cumulativeWeightAdditive,nt=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,_e<1){const rt=o*this._origIndex;this._mixBufferRegion(j,$,rt,1-_e,o)}tt>0&&this._mixBufferRegionAdditive(j,$,this._addIndex*o,1,o);for(let rt=o,it=o+o;rt!==it;++rt)if(j[rt]!==j[rt+o]){nt.setValue(j,$);break}}saveOriginalState(){const s=this.binding,o=this.buffer,j=this.valueSize,$=j*this._origIndex;s.getValue(o,$);for(let _e=j,tt=$;_e!==tt;++_e)o[_e]=o[$+_e%j];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const s=this.valueSize*3;this.binding.setValue(this.buffer,s)}_setAdditiveIdentityNumeric(){const s=this._addIndex*this.valueSize,o=s+this.valueSize;for(let j=s;j<o;j++)this.buffer[j]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const s=this._origIndex*this.valueSize,o=this._addIndex*this.valueSize;for(let j=0;j<this.valueSize;j++)this.buffer[o+j]=this.buffer[s+j]}_select(s,o,j,$,_e){if($>=.5)for(let tt=0;tt!==_e;++tt)s[o+tt]=s[j+tt]}_slerp(s,o,j,$){Quaternion.slerpFlat(s,o,s,o,s,j,$)}_slerpAdditive(s,o,j,$,_e){const tt=this._workIndex*_e;Quaternion.multiplyQuaternionsFlat(s,tt,s,o,s,j),Quaternion.slerpFlat(s,o,s,o,s,tt,$)}_lerp(s,o,j,$,_e){const tt=1-$;for(let nt=0;nt!==_e;++nt){const rt=o+nt;s[rt]=s[rt]*tt+s[j+nt]*$}}_lerpAdditive(s,o,j,$,_e){for(let tt=0;tt!==_e;++tt){const nt=o+tt;s[nt]=s[nt]+s[j+tt]*$}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(s,o,j){const $=j||PropertyBinding.parseTrackName(o);this._targetGroup=s,this._bindings=s.subscribe_(o,$)}getValue(s,o){this.bind();const j=this._targetGroup.nCachedObjects_,$=this._bindings[j];$!==void 0&&$.getValue(s,o)}setValue(s,o){const j=this._bindings;for(let $=this._targetGroup.nCachedObjects_,_e=j.length;$!==_e;++$)j[$].setValue(s,o)}bind(){const s=this._bindings;for(let o=this._targetGroup.nCachedObjects_,j=s.length;o!==j;++o)s[o].bind()}unbind(){const s=this._bindings;for(let o=this._targetGroup.nCachedObjects_,j=s.length;o!==j;++o)s[o].unbind()}}class PropertyBinding{constructor(s,o,j){this.path=o,this.parsedPath=j||PropertyBinding.parseTrackName(o),this.node=PropertyBinding.findNode(s,this.parsedPath.nodeName),this.rootNode=s,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(s,o,j){return s&&s.isAnimationObjectGroup?new PropertyBinding.Composite(s,o,j):new PropertyBinding(s,o,j)}static sanitizeNodeName(s){return s.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(s){const o=_trackRe.exec(s);if(o===null)throw new Error("PropertyBinding: Cannot parse trackName: "+s);const j={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]},$=j.nodeName&&j.nodeName.lastIndexOf(".");if($!==void 0&&$!==-1){const _e=j.nodeName.substring($+1);_supportedObjectNames.indexOf(_e)!==-1&&(j.nodeName=j.nodeName.substring(0,$),j.objectName=_e)}if(j.propertyName===null||j.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+s);return j}static findNode(s,o){if(o===void 0||o===""||o==="."||o===-1||o===s.name||o===s.uuid)return s;if(s.skeleton){const j=s.skeleton.getBoneByName(o);if(j!==void 0)return j}if(s.children){const j=function(_e){for(let tt=0;tt<_e.length;tt++){const nt=_e[tt];if(nt.name===o||nt.uuid===o)return nt;const rt=j(nt.children);if(rt)return rt}return null},$=j(s.children);if($)return $}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(s,o){s[o]=this.targetObject[this.propertyName]}_getValue_array(s,o){const j=this.resolvedProperty;for(let $=0,_e=j.length;$!==_e;++$)s[o++]=j[$]}_getValue_arrayElement(s,o){s[o]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(s,o){this.resolvedProperty.toArray(s,o)}_setValue_direct(s,o){this.targetObject[this.propertyName]=s[o]}_setValue_direct_setNeedsUpdate(s,o){this.targetObject[this.propertyName]=s[o],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(s,o){this.targetObject[this.propertyName]=s[o],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(s,o){const j=this.resolvedProperty;for(let $=0,_e=j.length;$!==_e;++$)j[$]=s[o++]}_setValue_array_setNeedsUpdate(s,o){const j=this.resolvedProperty;for(let $=0,_e=j.length;$!==_e;++$)j[$]=s[o++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(s,o){const j=this.resolvedProperty;for(let $=0,_e=j.length;$!==_e;++$)j[$]=s[o++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(s,o){this.resolvedProperty[this.propertyIndex]=s[o]}_setValue_arrayElement_setNeedsUpdate(s,o){this.resolvedProperty[this.propertyIndex]=s[o],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(s,o){this.resolvedProperty[this.propertyIndex]=s[o],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(s,o){this.resolvedProperty.fromArray(s,o)}_setValue_fromArray_setNeedsUpdate(s,o){this.resolvedProperty.fromArray(s,o),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(s,o){this.resolvedProperty.fromArray(s,o),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(s,o){this.bind(),this.getValue(s,o)}_setValue_unbound(s,o){this.bind(),this.setValue(s,o)}bind(){let s=this.node;const o=this.parsedPath,j=o.objectName,$=o.propertyName;let _e=o.propertyIndex;if(s||(s=PropertyBinding.findNode(this.rootNode,o.nodeName),this.node=s),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!s){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(j){let it=o.objectIndex;switch(j){case"materials":if(!s.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!s.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}s=s.material.materials;break;case"bones":if(!s.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}s=s.skeleton.bones;for(let st=0;st<s.length;st++)if(s[st].name===it){it=st;break}break;case"map":if("map"in s){s=s.map;break}if(!s.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!s.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}s=s.material.map;break;default:if(s[j]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}s=s[j]}if(it!==void 0){if(s[it]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,s);return}s=s[it]}}const tt=s[$];if(tt===void 0){const it=o.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+it+"."+$+" but it wasn't found.",s);return}let nt=this.Versioning.None;this.targetObject=s,s.needsUpdate!==void 0?nt=this.Versioning.NeedsUpdate:s.matrixWorldNeedsUpdate!==void 0&&(nt=this.Versioning.MatrixWorldNeedsUpdate);let rt=this.BindingType.Direct;if(_e!==void 0){if($==="morphTargetInfluences"){if(!s.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!s.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}s.morphTargetDictionary[_e]!==void 0&&(_e=s.morphTargetDictionary[_e])}rt=this.BindingType.ArrayElement,this.resolvedProperty=tt,this.propertyIndex=_e}else tt.fromArray!==void 0&&tt.toArray!==void 0?(rt=this.BindingType.HasFromToArray,this.resolvedProperty=tt):Array.isArray(tt)?(rt=this.BindingType.EntireArray,this.resolvedProperty=tt):this.propertyName=$;this.getValue=this.GetterByBindingType[rt],this.setValue=this.SetterByBindingTypeAndVersioning[rt][nt]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const s={};this._indicesByUUID=s;for(let j=0,$=arguments.length;j!==$;++j)s[arguments[j].uuid]=j;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}add(){const s=this._objects,o=this._indicesByUUID,j=this._paths,$=this._parsedPaths,_e=this._bindings,tt=_e.length;let nt,rt=s.length,it=this.nCachedObjects_;for(let st=0,at=arguments.length;st!==at;++st){const ot=arguments[st],ct=ot.uuid;let ft=o[ct];if(ft===void 0){ft=rt++,o[ct]=ft,s.push(ot);for(let ht=0,mt=tt;ht!==mt;++ht)_e[ht].push(new PropertyBinding(ot,j[ht],$[ht]))}else if(ft<it){nt=s[ft];const ht=--it,mt=s[ht];o[mt.uuid]=ft,s[ft]=mt,o[ct]=ht,s[ht]=ot;for(let lt=0,ut=tt;lt!==ut;++lt){const dt=_e[lt],gt=dt[ht];let Et=dt[ft];dt[ft]=gt,Et===void 0&&(Et=new PropertyBinding(ot,j[lt],$[lt])),dt[ht]=Et}}else s[ft]!==nt&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=it}remove(){const s=this._objects,o=this._indicesByUUID,j=this._bindings,$=j.length;let _e=this.nCachedObjects_;for(let tt=0,nt=arguments.length;tt!==nt;++tt){const rt=arguments[tt],it=rt.uuid,st=o[it];if(st!==void 0&&st>=_e){const at=_e++,ot=s[at];o[ot.uuid]=st,s[st]=ot,o[it]=at,s[at]=rt;for(let ct=0,ft=$;ct!==ft;++ct){const ht=j[ct],mt=ht[at],lt=ht[st];ht[st]=mt,ht[at]=lt}}}this.nCachedObjects_=_e}uncache(){const s=this._objects,o=this._indicesByUUID,j=this._bindings,$=j.length;let _e=this.nCachedObjects_,tt=s.length;for(let nt=0,rt=arguments.length;nt!==rt;++nt){const it=arguments[nt],st=it.uuid,at=o[st];if(at!==void 0)if(delete o[st],at<_e){const ot=--_e,ct=s[ot],ft=--tt,ht=s[ft];o[ct.uuid]=at,s[at]=ct,o[ht.uuid]=ot,s[ot]=ht,s.pop();for(let mt=0,lt=$;mt!==lt;++mt){const ut=j[mt],dt=ut[ot],gt=ut[ft];ut[at]=dt,ut[ot]=gt,ut.pop()}}else{const ot=--tt,ct=s[ot];ot>0&&(o[ct.uuid]=at),s[at]=ct,s.pop();for(let ft=0,ht=$;ft!==ht;++ft){const mt=j[ft];mt[at]=mt[ot],mt.pop()}}}this.nCachedObjects_=_e}subscribe_(s,o){const j=this._bindingsIndicesByPath;let $=j[s];const _e=this._bindings;if($!==void 0)return _e[$];const tt=this._paths,nt=this._parsedPaths,rt=this._objects,it=rt.length,st=this.nCachedObjects_,at=new Array(it);$=_e.length,j[s]=$,tt.push(s),nt.push(o),_e.push(at);for(let ot=st,ct=rt.length;ot!==ct;++ot){const ft=rt[ot];at[ot]=new PropertyBinding(ft,s,o)}return at}unsubscribe_(s){const o=this._bindingsIndicesByPath,j=o[s];if(j!==void 0){const $=this._paths,_e=this._parsedPaths,tt=this._bindings,nt=tt.length-1,rt=tt[nt],it=s[nt];o[it]=j,tt[j]=rt,tt.pop(),_e[j]=_e[nt],_e.pop(),$[j]=$[nt],$.pop()}}}class AnimationAction{constructor(s,o,j=null,$=o.blendMode){this._mixer=s,this._clip=o,this._localRoot=j,this.blendMode=$;const _e=o.tracks,tt=_e.length,nt=new Array(tt),rt={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let it=0;it!==tt;++it){const st=_e[it].createInterpolant(null);nt[it]=st,st.settings=rt}this._interpolantSettings=rt,this._interpolants=nt,this._propertyBindings=new Array(tt),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(s){return this._startTime=s,this}setLoop(s,o){return this.loop=s,this.repetitions=o,this}setEffectiveWeight(s){return this.weight=s,this._effectiveWeight=this.enabled?s:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(s){return this._scheduleFading(s,0,1)}fadeOut(s){return this._scheduleFading(s,1,0)}crossFadeFrom(s,o,j){if(s.fadeOut(o),this.fadeIn(o),j){const $=this._clip.duration,_e=s._clip.duration,tt=_e/$,nt=$/_e;s.warp(1,tt,o),this.warp(nt,1,o)}return this}crossFadeTo(s,o,j){return s.crossFadeFrom(this,o,j)}stopFading(){const s=this._weightInterpolant;return s!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}setEffectiveTimeScale(s){return this.timeScale=s,this._effectiveTimeScale=this.paused?0:s,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(s){return this.timeScale=this._clip.duration/s,this.stopWarping()}syncWith(s){return this.time=s.time,this.timeScale=s.timeScale,this.stopWarping()}halt(s){return this.warp(this._effectiveTimeScale,0,s)}warp(s,o,j){const $=this._mixer,_e=$.time,tt=this.timeScale;let nt=this._timeScaleInterpolant;nt===null&&(nt=$._lendControlInterpolant(),this._timeScaleInterpolant=nt);const rt=nt.parameterPositions,it=nt.sampleValues;return rt[0]=_e,rt[1]=_e+j,it[0]=s/tt,it[1]=o/tt,this}stopWarping(){const s=this._timeScaleInterpolant;return s!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(s,o,j,$){if(!this.enabled){this._updateWeight(s);return}const _e=this._startTime;if(_e!==null){const rt=(s-_e)*j;rt<0||j===0?o=0:(this._startTime=null,o=j*rt)}o*=this._updateTimeScale(s);const tt=this._updateTime(o),nt=this._updateWeight(s);if(nt>0){const rt=this._interpolants,it=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let st=0,at=rt.length;st!==at;++st)rt[st].evaluate(tt),it[st].accumulateAdditive(nt);break;case NormalAnimationBlendMode:default:for(let st=0,at=rt.length;st!==at;++st)rt[st].evaluate(tt),it[st].accumulate($,nt)}}}_updateWeight(s){let o=0;if(this.enabled){o=this.weight;const j=this._weightInterpolant;if(j!==null){const $=j.evaluate(s)[0];o*=$,s>j.parameterPositions[1]&&(this.stopFading(),$===0&&(this.enabled=!1))}}return this._effectiveWeight=o,o}_updateTimeScale(s){let o=0;if(!this.paused){o=this.timeScale;const j=this._timeScaleInterpolant;if(j!==null){const $=j.evaluate(s)[0];o*=$,s>j.parameterPositions[1]&&(this.stopWarping(),o===0?this.paused=!0:this.timeScale=o)}}return this._effectiveTimeScale=o,o}_updateTime(s){const o=this._clip.duration,j=this.loop;let $=this.time+s,_e=this._loopCount;const tt=j===LoopPingPong;if(s===0)return _e===-1?$:tt&&(_e&1)===1?o-$:$;if(j===LoopOnce){_e===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if($>=o)$=o;else if($<0)$=0;else{this.time=$;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=$,this._mixer.dispatchEvent({type:"finished",action:this,direction:s<0?-1:1})}}else{if(_e===-1&&(s>=0?(_e=0,this._setEndings(!0,this.repetitions===0,tt)):this._setEndings(this.repetitions===0,!0,tt)),$>=o||$<0){const nt=Math.floor($/o);$-=o*nt,_e+=Math.abs(nt);const rt=this.repetitions-_e;if(rt<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,$=s>0?o:0,this.time=$,this._mixer.dispatchEvent({type:"finished",action:this,direction:s>0?1:-1});else{if(rt===1){const it=s<0;this._setEndings(it,!it,tt)}else this._setEndings(!1,!1,tt);this._loopCount=_e,this.time=$,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:nt})}}else this.time=$;if(tt&&(_e&1)===1)return o-$}return $}_setEndings(s,o,j){const $=this._interpolantSettings;j?($.endingStart=ZeroSlopeEnding,$.endingEnd=ZeroSlopeEnding):(s?$.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:$.endingStart=WrapAroundEnding,o?$.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:$.endingEnd=WrapAroundEnding)}_scheduleFading(s,o,j){const $=this._mixer,_e=$.time;let tt=this._weightInterpolant;tt===null&&(tt=$._lendControlInterpolant(),this._weightInterpolant=tt);const nt=tt.parameterPositions,rt=tt.sampleValues;return nt[0]=_e,rt[0]=o,nt[1]=_e+s,rt[1]=j,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(s){super(),this._root=s,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(s,o){const j=s._localRoot||this._root,$=s._clip.tracks,_e=$.length,tt=s._propertyBindings,nt=s._interpolants,rt=j.uuid,it=this._bindingsByRootAndName;let st=it[rt];st===void 0&&(st={},it[rt]=st);for(let at=0;at!==_e;++at){const ot=$[at],ct=ot.name;let ft=st[ct];if(ft!==void 0)++ft.referenceCount,tt[at]=ft;else{if(ft=tt[at],ft!==void 0){ft._cacheIndex===null&&(++ft.referenceCount,this._addInactiveBinding(ft,rt,ct));continue}const ht=o&&o._propertyBindings[at].binding.parsedPath;ft=new PropertyMixer(PropertyBinding.create(j,ct,ht),ot.ValueTypeName,ot.getValueSize()),++ft.referenceCount,this._addInactiveBinding(ft,rt,ct),tt[at]=ft}nt[at].resultBuffer=ft.buffer}}_activateAction(s){if(!this._isActiveAction(s)){if(s._cacheIndex===null){const j=(s._localRoot||this._root).uuid,$=s._clip.uuid,_e=this._actionsByClip[$];this._bindAction(s,_e&&_e.knownActions[0]),this._addInactiveAction(s,$,j)}const o=s._propertyBindings;for(let j=0,$=o.length;j!==$;++j){const _e=o[j];_e.useCount++===0&&(this._lendBinding(_e),_e.saveOriginalState())}this._lendAction(s)}}_deactivateAction(s){if(this._isActiveAction(s)){const o=s._propertyBindings;for(let j=0,$=o.length;j!==$;++j){const _e=o[j];--_e.useCount===0&&(_e.restoreOriginalState(),this._takeBackBinding(_e))}this._takeBackAction(s)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const s=this;this.stats={actions:{get total(){return s._actions.length},get inUse(){return s._nActiveActions}},bindings:{get total(){return s._bindings.length},get inUse(){return s._nActiveBindings}},controlInterpolants:{get total(){return s._controlInterpolants.length},get inUse(){return s._nActiveControlInterpolants}}}}_isActiveAction(s){const o=s._cacheIndex;return o!==null&&o<this._nActiveActions}_addInactiveAction(s,o,j){const $=this._actions,_e=this._actionsByClip;let tt=_e[o];if(tt===void 0)tt={knownActions:[s],actionByRoot:{}},s._byClipCacheIndex=0,_e[o]=tt;else{const nt=tt.knownActions;s._byClipCacheIndex=nt.length,nt.push(s)}s._cacheIndex=$.length,$.push(s),tt.actionByRoot[j]=s}_removeInactiveAction(s){const o=this._actions,j=o[o.length-1],$=s._cacheIndex;j._cacheIndex=$,o[$]=j,o.pop(),s._cacheIndex=null;const _e=s._clip.uuid,tt=this._actionsByClip,nt=tt[_e],rt=nt.knownActions,it=rt[rt.length-1],st=s._byClipCacheIndex;it._byClipCacheIndex=st,rt[st]=it,rt.pop(),s._byClipCacheIndex=null;const at=nt.actionByRoot,ot=(s._localRoot||this._root).uuid;delete at[ot],rt.length===0&&delete tt[_e],this._removeInactiveBindingsForAction(s)}_removeInactiveBindingsForAction(s){const o=s._propertyBindings;for(let j=0,$=o.length;j!==$;++j){const _e=o[j];--_e.referenceCount===0&&this._removeInactiveBinding(_e)}}_lendAction(s){const o=this._actions,j=s._cacheIndex,$=this._nActiveActions++,_e=o[$];s._cacheIndex=$,o[$]=s,_e._cacheIndex=j,o[j]=_e}_takeBackAction(s){const o=this._actions,j=s._cacheIndex,$=--this._nActiveActions,_e=o[$];s._cacheIndex=$,o[$]=s,_e._cacheIndex=j,o[j]=_e}_addInactiveBinding(s,o,j){const $=this._bindingsByRootAndName,_e=this._bindings;let tt=$[o];tt===void 0&&(tt={},$[o]=tt),tt[j]=s,s._cacheIndex=_e.length,_e.push(s)}_removeInactiveBinding(s){const o=this._bindings,j=s.binding,$=j.rootNode.uuid,_e=j.path,tt=this._bindingsByRootAndName,nt=tt[$],rt=o[o.length-1],it=s._cacheIndex;rt._cacheIndex=it,o[it]=rt,o.pop(),delete nt[_e],Object.keys(nt).length===0&&delete tt[$]}_lendBinding(s){const o=this._bindings,j=s._cacheIndex,$=this._nActiveBindings++,_e=o[$];s._cacheIndex=$,o[$]=s,_e._cacheIndex=j,o[j]=_e}_takeBackBinding(s){const o=this._bindings,j=s._cacheIndex,$=--this._nActiveBindings,_e=o[$];s._cacheIndex=$,o[$]=s,_e._cacheIndex=j,o[j]=_e}_lendControlInterpolant(){const s=this._controlInterpolants,o=this._nActiveControlInterpolants++;let j=s[o];return j===void 0&&(j=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),j.__cacheIndex=o,s[o]=j),j}_takeBackControlInterpolant(s){const o=this._controlInterpolants,j=s.__cacheIndex,$=--this._nActiveControlInterpolants,_e=o[$];s.__cacheIndex=$,o[$]=s,_e.__cacheIndex=j,o[j]=_e}clipAction(s,o,j){const $=o||this._root,_e=$.uuid;let tt=typeof s=="string"?AnimationClip.findByName($,s):s;const nt=tt!==null?tt.uuid:s,rt=this._actionsByClip[nt];let it=null;if(j===void 0&&(tt!==null?j=tt.blendMode:j=NormalAnimationBlendMode),rt!==void 0){const at=rt.actionByRoot[_e];if(at!==void 0&&at.blendMode===j)return at;it=rt.knownActions[0],tt===null&&(tt=it._clip)}if(tt===null)return null;const st=new AnimationAction(this,tt,o,j);return this._bindAction(st,it),this._addInactiveAction(st,nt,_e),st}existingAction(s,o){const j=o||this._root,$=j.uuid,_e=typeof s=="string"?AnimationClip.findByName(j,s):s,tt=_e?_e.uuid:s,nt=this._actionsByClip[tt];return nt!==void 0&&nt.actionByRoot[$]||null}stopAllAction(){const s=this._actions,o=this._nActiveActions;for(let j=o-1;j>=0;--j)s[j].stop();return this}update(s){s*=this.timeScale;const o=this._actions,j=this._nActiveActions,$=this.time+=s,_e=Math.sign(s),tt=this._accuIndex^=1;for(let it=0;it!==j;++it)o[it]._update($,s,_e,tt);const nt=this._bindings,rt=this._nActiveBindings;for(let it=0;it!==rt;++it)nt[it].apply(tt);return this}setTime(s){this.time=0;for(let o=0;o<this._actions.length;o++)this._actions[o].time=0;return this.update(s)}getRoot(){return this._root}uncacheClip(s){const o=this._actions,j=s.uuid,$=this._actionsByClip,_e=$[j];if(_e!==void 0){const tt=_e.knownActions;for(let nt=0,rt=tt.length;nt!==rt;++nt){const it=tt[nt];this._deactivateAction(it);const st=it._cacheIndex,at=o[o.length-1];it._cacheIndex=null,it._byClipCacheIndex=null,at._cacheIndex=st,o[st]=at,o.pop(),this._removeInactiveBindingsForAction(it)}delete $[j]}}uncacheRoot(s){const o=s.uuid,j=this._actionsByClip;for(const tt in j){const nt=j[tt].actionByRoot,rt=nt[o];rt!==void 0&&(this._deactivateAction(rt),this._removeInactiveAction(rt))}const $=this._bindingsByRootAndName,_e=$[o];if(_e!==void 0)for(const tt in _e){const nt=_e[tt];nt.restoreOriginalState(),this._removeInactiveBinding(nt)}}uncacheAction(s,o){const j=this.existingAction(s,o);j!==null&&(this._deactivateAction(j),this._removeInactiveAction(j))}}class Uniform{constructor(s){this.value=s}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(s){return this.uniforms.push(s),this}remove(s){const o=this.uniforms.indexOf(s);return o!==-1&&this.uniforms.splice(o,1),this}setName(s){return this.name=s,this}setUsage(s){return this.usage=s,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(s){this.name=s.name,this.usage=s.usage;const o=s.uniforms;this.uniforms.length=0;for(let j=0,$=o.length;j<$;j++)this.uniforms.push(o[j].clone());return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(s,o,j=1){super(s,o),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=j}copy(s){return super.copy(s),this.meshPerAttribute=s.meshPerAttribute,this}clone(s){const o=super.clone(s);return o.meshPerAttribute=this.meshPerAttribute,o}toJSON(s){const o=super.toJSON(s);return o.isInstancedInterleavedBuffer=!0,o.meshPerAttribute=this.meshPerAttribute,o}}class GLBufferAttribute{constructor(s,o,j,$,_e){this.isGLBufferAttribute=!0,this.name="",this.buffer=s,this.type=o,this.itemSize=j,this.elementSize=$,this.count=_e,this.version=0}set needsUpdate(s){s===!0&&this.version++}setBuffer(s){return this.buffer=s,this}setType(s,o){return this.type=s,this.elementSize=o,this}setItemSize(s){return this.itemSize=s,this}setCount(s){return this.count=s,this}}class Raycaster{constructor(s,o,j=0,$=1/0){this.ray=new Ray(s,o),this.near=j,this.far=$,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(s,o){this.ray.set(s,o)}setFromCamera(s,o){o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(s.x,s.y,.5).unproject(o).sub(this.ray.origin).normalize(),this.camera=o):o.isOrthographicCamera?(this.ray.origin.set(s.x,s.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld),this.camera=o):console.error("THREE.Raycaster: Unsupported camera type: "+o.type)}intersectObject(s,o=!0,j=[]){return intersectObject(s,this,j,o),j.sort(ascSort),j}intersectObjects(s,o=!0,j=[]){for(let $=0,_e=s.length;$<_e;$++)intersectObject(s[$],this,j,o);return j.sort(ascSort),j}}function ascSort(a,s){return a.distance-s.distance}function intersectObject(a,s,o,j){if(a.layers.test(s.layers)&&a.raycast(s,o),j===!0){const $=a.children;for(let _e=0,tt=$.length;_e<tt;_e++)intersectObject($[_e],s,o,!0)}}class Spherical{constructor(s=1,o=0,j=0){return this.radius=s,this.phi=o,this.theta=j,this}set(s,o,j){return this.radius=s,this.phi=o,this.theta=j,this}copy(s){return this.radius=s.radius,this.phi=s.phi,this.theta=s.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,o,j){return this.radius=Math.sqrt(s*s+o*o+j*j),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(s,j),this.phi=Math.acos(clamp$2(o/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(s=1,o=0,j=0){return this.radius=s,this.theta=o,this.y=j,this}set(s,o,j){return this.radius=s,this.theta=o,this.y=j,this}copy(s){return this.radius=s.radius,this.theta=s.theta,this.y=s.y,this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,o,j){return this.radius=Math.sqrt(s*s+j*j),this.theta=Math.atan2(s,j),this.y=o,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(s=new Vector2(1/0,1/0),o=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=s,this.max=o}set(s,o){return this.min.copy(s),this.max.copy(o),this}setFromPoints(s){this.makeEmpty();for(let o=0,j=s.length;o<j;o++)this.expandByPoint(s[o]);return this}setFromCenterAndSize(s,o){const j=_vector$4.copy(o).multiplyScalar(.5);return this.min.copy(s).sub(j),this.max.copy(s).add(j),this}clone(){return new this.constructor().copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(s){return this.isEmpty()?s.set(0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return this.isEmpty()?s.set(0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y}getParameter(s,o){return o.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y)}clampPoint(s,o){return o.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return this.clampPoint(s,_vector$4).distanceTo(s)}intersect(s){return this.min.max(s.min),this.max.min(s.max),this.isEmpty()&&this.makeEmpty(),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(s=new Vector3,o=new Vector3){this.start=s,this.end=o}set(s,o){return this.start.copy(s),this.end.copy(o),this}copy(s){return this.start.copy(s.start),this.end.copy(s.end),this}getCenter(s){return s.addVectors(this.start,this.end).multiplyScalar(.5)}delta(s){return s.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(s,o){return this.delta(o).multiplyScalar(s).add(this.start)}closestPointToPointParameter(s,o){_startP.subVectors(s,this.start),_startEnd.subVectors(this.end,this.start);const j=_startEnd.dot(_startEnd);let _e=_startEnd.dot(_startP)/j;return o&&(_e=clamp$2(_e,0,1)),_e}closestPointToPoint(s,o,j){const $=this.closestPointToPointParameter(s,o);return this.delta(j).multiplyScalar($).add(this.start)}applyMatrix4(s){return this.start.applyMatrix4(s),this.end.applyMatrix4(s),this}equals(s){return s.start.equals(this.start)&&s.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3$1=new Vector3;class SpotLightHelper extends Object3D{constructor(s,o){super(),this.light=s,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="SpotLightHelper";const j=new BufferGeometry,$=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let tt=0,nt=1,rt=32;tt<rt;tt++,nt++){const it=tt/rt*Math.PI*2,st=nt/rt*Math.PI*2;$.push(Math.cos(it),Math.sin(it),1,Math.cos(st),Math.sin(st),1)}j.setAttribute("position",new Float32BufferAttribute($,3));const _e=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(j,_e),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const s=this.light.distance?this.light.distance:1e3,o=s*Math.tan(this.light.angle);this.cone.scale.set(o,o,s),_vector$3$1.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3$1),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2$1=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv$1=new Matrix4;class SkeletonHelper extends LineSegments{constructor(s){const o=getBoneList(s),j=new BufferGeometry,$=[],_e=[],tt=new Color(0,0,1),nt=new Color(0,1,0);for(let it=0;it<o.length;it++){const st=o[it];st.parent&&st.parent.isBone&&($.push(0,0,0),$.push(0,0,0),_e.push(tt.r,tt.g,tt.b),_e.push(nt.r,nt.g,nt.b))}j.setAttribute("position",new Float32BufferAttribute($,3)),j.setAttribute("color",new Float32BufferAttribute(_e,3));const rt=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(j,rt),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=s,this.bones=o,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(s){const o=this.bones,j=this.geometry,$=j.getAttribute("position");_matrixWorldInv$1.copy(this.root.matrixWorld).invert();for(let _e=0,tt=0;_e<o.length;_e++){const nt=o[_e];nt.parent&&nt.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv$1,nt.matrixWorld),_vector$2$1.setFromMatrixPosition(_boneMatrix),$.setXYZ(tt,_vector$2$1.x,_vector$2$1.y,_vector$2$1.z),_boneMatrix.multiplyMatrices(_matrixWorldInv$1,nt.parent.matrixWorld),_vector$2$1.setFromMatrixPosition(_boneMatrix),$.setXYZ(tt+1,_vector$2$1.x,_vector$2$1.y,_vector$2$1.z),tt+=2)}j.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(s)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(a){const s=[];a.isBone===!0&&s.push(a);for(let o=0;o<a.children.length;o++)s.push.apply(s,getBoneList(a.children[o]));return s}class PointLightHelper extends Mesh{constructor(s,o,j){const $=new SphereGeometry(o,4,2),_e=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super($,_e),this.light=s,this.color=j,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color,_color2=new Color;class HemisphereLightHelper extends Object3D{constructor(s,o,j){super(),this.light=s,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=j,this.type="HemisphereLightHelper";const $=new OctahedronGeometry(o);$.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const _e=$.getAttribute("position"),tt=new Float32Array(_e.count*3);$.setAttribute("color",new BufferAttribute(tt,3)),this.add(new Mesh($,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const s=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const o=s.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let j=0,$=o.count;j<$;j++){const _e=j<$/2?_color1:_color2;o.setXYZ(j,_e.r,_e.g,_e.b)}o.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),s.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(s=10,o=10,j=4473924,$=8947848){j=new Color(j),$=new Color($);const _e=o/2,tt=s/o,nt=s/2,rt=[],it=[];for(let ot=0,ct=0,ft=-nt;ot<=o;ot++,ft+=tt){rt.push(-nt,0,ft,nt,0,ft),rt.push(ft,0,-nt,ft,0,nt);const ht=ot===_e?j:$;ht.toArray(it,ct),ct+=3,ht.toArray(it,ct),ct+=3,ht.toArray(it,ct),ct+=3,ht.toArray(it,ct),ct+=3}const st=new BufferGeometry;st.setAttribute("position",new Float32BufferAttribute(rt,3)),st.setAttribute("color",new Float32BufferAttribute(it,3));const at=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(st,at),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(s=10,o=16,j=8,$=64,_e=4473924,tt=8947848){_e=new Color(_e),tt=new Color(tt);const nt=[],rt=[];if(o>1)for(let at=0;at<o;at++){const ot=at/o*(Math.PI*2),ct=Math.sin(ot)*s,ft=Math.cos(ot)*s;nt.push(0,0,0),nt.push(ct,0,ft);const ht=at&1?_e:tt;rt.push(ht.r,ht.g,ht.b),rt.push(ht.r,ht.g,ht.b)}for(let at=0;at<j;at++){const ot=at&1?_e:tt,ct=s-s/j*at;for(let ft=0;ft<$;ft++){let ht=ft/$*(Math.PI*2),mt=Math.sin(ht)*ct,lt=Math.cos(ht)*ct;nt.push(mt,0,lt),rt.push(ot.r,ot.g,ot.b),ht=(ft+1)/$*(Math.PI*2),mt=Math.sin(ht)*ct,lt=Math.cos(ht)*ct,nt.push(mt,0,lt),rt.push(ot.r,ot.g,ot.b)}}const it=new BufferGeometry;it.setAttribute("position",new Float32BufferAttribute(nt,3)),it.setAttribute("color",new Float32BufferAttribute(rt,3));const st=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(it,st),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1$8=new Vector3,_v2$5=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(s,o,j){super(),this.light=s,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=j,this.type="DirectionalLightHelper",o===void 0&&(o=1);let $=new BufferGeometry;$.setAttribute("position",new Float32BufferAttribute([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3));const _e=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line($,_e),this.add(this.lightPlane),$=new BufferGeometry,$.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line($,_e),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1$8.setFromMatrixPosition(this.light.matrixWorld),_v2$5.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2$5,_v1$8),this.lightPlane.lookAt(_v2$5),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2$5),this.targetLine.scale.z=_v3.length()}}const _vector$c=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(s){const o=new BufferGeometry,j=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),$=[],_e=[],tt={};nt("n1","n2"),nt("n2","n4"),nt("n4","n3"),nt("n3","n1"),nt("f1","f2"),nt("f2","f4"),nt("f4","f3"),nt("f3","f1"),nt("n1","f1"),nt("n2","f2"),nt("n3","f3"),nt("n4","f4"),nt("p","n1"),nt("p","n2"),nt("p","n3"),nt("p","n4"),nt("u1","u2"),nt("u2","u3"),nt("u3","u1"),nt("c","t"),nt("p","c"),nt("cn1","cn2"),nt("cn3","cn4"),nt("cf1","cf2"),nt("cf3","cf4");function nt(ft,ht){rt(ft),rt(ht)}function rt(ft){$.push(0,0,0),_e.push(0,0,0),tt[ft]===void 0&&(tt[ft]=[]),tt[ft].push($.length/3-1)}o.setAttribute("position",new Float32BufferAttribute($,3)),o.setAttribute("color",new Float32BufferAttribute(_e,3)),super(o,j),this.type="CameraHelper",this.camera=s,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=tt,this.update();const it=new Color(16755200),st=new Color(16711680),at=new Color(43775),ot=new Color(16777215),ct=new Color(3355443);this.setColors(it,st,at,ot,ct)}setColors(s,o,j,$,_e){const nt=this.geometry.getAttribute("color");nt.setXYZ(0,s.r,s.g,s.b),nt.setXYZ(1,s.r,s.g,s.b),nt.setXYZ(2,s.r,s.g,s.b),nt.setXYZ(3,s.r,s.g,s.b),nt.setXYZ(4,s.r,s.g,s.b),nt.setXYZ(5,s.r,s.g,s.b),nt.setXYZ(6,s.r,s.g,s.b),nt.setXYZ(7,s.r,s.g,s.b),nt.setXYZ(8,s.r,s.g,s.b),nt.setXYZ(9,s.r,s.g,s.b),nt.setXYZ(10,s.r,s.g,s.b),nt.setXYZ(11,s.r,s.g,s.b),nt.setXYZ(12,s.r,s.g,s.b),nt.setXYZ(13,s.r,s.g,s.b),nt.setXYZ(14,s.r,s.g,s.b),nt.setXYZ(15,s.r,s.g,s.b),nt.setXYZ(16,s.r,s.g,s.b),nt.setXYZ(17,s.r,s.g,s.b),nt.setXYZ(18,s.r,s.g,s.b),nt.setXYZ(19,s.r,s.g,s.b),nt.setXYZ(20,s.r,s.g,s.b),nt.setXYZ(21,s.r,s.g,s.b),nt.setXYZ(22,s.r,s.g,s.b),nt.setXYZ(23,s.r,s.g,s.b),nt.setXYZ(24,o.r,o.g,o.b),nt.setXYZ(25,o.r,o.g,o.b),nt.setXYZ(26,o.r,o.g,o.b),nt.setXYZ(27,o.r,o.g,o.b),nt.setXYZ(28,o.r,o.g,o.b),nt.setXYZ(29,o.r,o.g,o.b),nt.setXYZ(30,o.r,o.g,o.b),nt.setXYZ(31,o.r,o.g,o.b),nt.setXYZ(32,j.r,j.g,j.b),nt.setXYZ(33,j.r,j.g,j.b),nt.setXYZ(34,j.r,j.g,j.b),nt.setXYZ(35,j.r,j.g,j.b),nt.setXYZ(36,j.r,j.g,j.b),nt.setXYZ(37,j.r,j.g,j.b),nt.setXYZ(38,$.r,$.g,$.b),nt.setXYZ(39,$.r,$.g,$.b),nt.setXYZ(40,_e.r,_e.g,_e.b),nt.setXYZ(41,_e.r,_e.g,_e.b),nt.setXYZ(42,_e.r,_e.g,_e.b),nt.setXYZ(43,_e.r,_e.g,_e.b),nt.setXYZ(44,_e.r,_e.g,_e.b),nt.setXYZ(45,_e.r,_e.g,_e.b),nt.setXYZ(46,_e.r,_e.g,_e.b),nt.setXYZ(47,_e.r,_e.g,_e.b),nt.setXYZ(48,_e.r,_e.g,_e.b),nt.setXYZ(49,_e.r,_e.g,_e.b),nt.needsUpdate=!0}update(){const s=this.geometry,o=this.pointMap,j=1,$=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",o,s,_camera,0,0,-1),setPoint("t",o,s,_camera,0,0,1),setPoint("n1",o,s,_camera,-j,-$,-1),setPoint("n2",o,s,_camera,j,-$,-1),setPoint("n3",o,s,_camera,-j,$,-1),setPoint("n4",o,s,_camera,j,$,-1),setPoint("f1",o,s,_camera,-j,-$,1),setPoint("f2",o,s,_camera,j,-$,1),setPoint("f3",o,s,_camera,-j,$,1),setPoint("f4",o,s,_camera,j,$,1),setPoint("u1",o,s,_camera,j*.7,$*1.1,-1),setPoint("u2",o,s,_camera,-j*.7,$*1.1,-1),setPoint("u3",o,s,_camera,0,$*2,-1),setPoint("cf1",o,s,_camera,-j,0,1),setPoint("cf2",o,s,_camera,j,0,1),setPoint("cf3",o,s,_camera,0,-$,1),setPoint("cf4",o,s,_camera,0,$,1),setPoint("cn1",o,s,_camera,-j,0,-1),setPoint("cn2",o,s,_camera,j,0,-1),setPoint("cn3",o,s,_camera,0,-$,-1),setPoint("cn4",o,s,_camera,0,$,-1),s.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(a,s,o,j,$,_e,tt){_vector$c.set($,_e,tt).unproject(j);const nt=s[a];if(nt!==void 0){const rt=o.getAttribute("position");for(let it=0,st=nt.length;it<st;it++)rt.setXYZ(nt[it],_vector$c.x,_vector$c.y,_vector$c.z)}}const _box$4=new Box3;class BoxHelper extends LineSegments{constructor(s,o=16776960){const j=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),$=new Float32Array(8*3),_e=new BufferGeometry;_e.setIndex(new BufferAttribute(j,1)),_e.setAttribute("position",new BufferAttribute($,3)),super(_e,new LineBasicMaterial({color:o,toneMapped:!1})),this.object=s,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(s){if(s!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box$4.setFromObject(this.object),_box$4.isEmpty())return;const o=_box$4.min,j=_box$4.max,$=this.geometry.attributes.position,_e=$.array;_e[0]=j.x,_e[1]=j.y,_e[2]=j.z,_e[3]=o.x,_e[4]=j.y,_e[5]=j.z,_e[6]=o.x,_e[7]=o.y,_e[8]=j.z,_e[9]=j.x,_e[10]=o.y,_e[11]=j.z,_e[12]=j.x,_e[13]=j.y,_e[14]=o.z,_e[15]=o.x,_e[16]=j.y,_e[17]=o.z,_e[18]=o.x,_e[19]=o.y,_e[20]=o.z,_e[21]=j.x,_e[22]=o.y,_e[23]=o.z,$.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(s){return this.object=s,this.update(),this}copy(s,o){return super.copy(s,o),this.object=s.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(s,o=16776960){const j=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),$=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],_e=new BufferGeometry;_e.setIndex(new BufferAttribute(j,1)),_e.setAttribute("position",new Float32BufferAttribute($,3)),super(_e,new LineBasicMaterial({color:o,toneMapped:!1})),this.box=s,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(s){const o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(s))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(s,o=1,j=16776960){const $=j,_e=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],tt=new BufferGeometry;tt.setAttribute("position",new Float32BufferAttribute(_e,3)),tt.computeBoundingSphere(),super(tt,new LineBasicMaterial({color:$,toneMapped:!1})),this.type="PlaneHelper",this.plane=s,this.size=o;const nt=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],rt=new BufferGeometry;rt.setAttribute("position",new Float32BufferAttribute(nt,3)),rt.computeBoundingSphere(),this.add(new Mesh(rt,new MeshBasicMaterial({color:$,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(s){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(s)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(s=new Vector3(0,0,1),o=new Vector3(0,0,0),j=1,$=16776960,_e=j*.2,tt=_e*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(o),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:$,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:$,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(s),this.setLength(j,_e,tt)}setDirection(s){if(s.y>.99999)this.quaternion.set(0,0,0,1);else if(s.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(s.z,0,-s.x).normalize();const o=Math.acos(s.y);this.quaternion.setFromAxisAngle(_axis,o)}}setLength(s,o=s*.2,j=o*.2){this.line.scale.set(1,Math.max(1e-4,s-o),1),this.line.updateMatrix(),this.cone.scale.set(j,o,j),this.cone.position.y=s,this.cone.updateMatrix()}setColor(s){this.line.material.color.set(s),this.cone.material.color.set(s)}copy(s){return super.copy(s,!1),this.line.copy(s.line),this.cone.copy(s.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(s=1){const o=[0,0,0,s,0,0,0,0,0,0,s,0,0,0,0,0,0,s],j=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],$=new BufferGeometry;$.setAttribute("position",new Float32BufferAttribute(o,3)),$.setAttribute("color",new Float32BufferAttribute(j,3));const _e=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super($,_e),this.type="AxesHelper"}setColors(s,o,j){const $=new Color,_e=this.geometry.attributes.color.array;return $.set(s),$.toArray(_e,0),$.toArray(_e,3),$.set(o),$.toArray(_e,6),$.toArray(_e,9),$.set(j),$.toArray(_e,12),$.toArray(_e,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(s,o){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(s,o),this}lineTo(s,o){return this.currentPath.lineTo(s,o),this}quadraticCurveTo(s,o,j,$){return this.currentPath.quadraticCurveTo(s,o,j,$),this}bezierCurveTo(s,o,j,$,_e,tt){return this.currentPath.bezierCurveTo(s,o,j,$,_e,tt),this}splineThru(s){return this.currentPath.splineThru(s),this}toShapes(s){function o(lt){const ut=[];for(let dt=0,gt=lt.length;dt<gt;dt++){const Et=lt[dt],St=new Shape;St.curves=Et.curves,ut.push(St)}return ut}function j(lt,ut){const dt=ut.length;let gt=!1;for(let Et=dt-1,St=0;St<dt;Et=St++){let Tt=ut[Et],Mt=ut[St],Bt=Mt.x-Tt.x,Rt=Mt.y-Tt.y;if(Math.abs(Rt)>Number.EPSILON){if(Rt<0&&(Tt=ut[St],Bt=-Bt,Mt=ut[Et],Rt=-Rt),lt.y<Tt.y||lt.y>Mt.y)continue;if(lt.y===Tt.y){if(lt.x===Tt.x)return!0}else{const Ut=Rt*(lt.x-Tt.x)-Bt*(lt.y-Tt.y);if(Ut===0)return!0;if(Ut<0)continue;gt=!gt}}else{if(lt.y!==Tt.y)continue;if(Mt.x<=lt.x&&lt.x<=Tt.x||Tt.x<=lt.x&&lt.x<=Mt.x)return!0}}return gt}const $=ShapeUtils.isClockWise,_e=this.subPaths;if(_e.length===0)return[];let tt,nt,rt;const it=[];if(_e.length===1)return nt=_e[0],rt=new Shape,rt.curves=nt.curves,it.push(rt),it;let st=!$(_e[0].getPoints());st=s?!st:st;const at=[],ot=[];let ct=[],ft=0,ht;ot[ft]=void 0,ct[ft]=[];for(let lt=0,ut=_e.length;lt<ut;lt++)nt=_e[lt],ht=nt.getPoints(),tt=$(ht),tt=s?!tt:tt,tt?(!st&&ot[ft]&&ft++,ot[ft]={s:new Shape,p:ht},ot[ft].s.curves=nt.curves,st&&ft++,ct[ft]=[]):ct[ft].push({h:nt,p:ht[0]});if(!ot[0])return o(_e);if(ot.length>1){let lt=!1,ut=0;for(let dt=0,gt=ot.length;dt<gt;dt++)at[dt]=[];for(let dt=0,gt=ot.length;dt<gt;dt++){const Et=ct[dt];for(let St=0;St<Et.length;St++){const Tt=Et[St];let Mt=!0;for(let Bt=0;Bt<ot.length;Bt++)j(Tt.p,ot[Bt].p)&&(dt!==Bt&&ut++,Mt?(Mt=!1,at[Bt].push(Tt)):lt=!0);Mt&&at[dt].push(Tt)}}ut>0&&lt===!1&&(ct=at)}let mt;for(let lt=0,ut=ot.length;lt<ut;lt++){rt=ot[lt].s,it.push(rt),mt=ct[lt];for(let dt=0,gt=mt.length;dt<gt;dt++)rt.holes.push(mt[dt].h)}return it}}class BoxBufferGeometry extends BoxGeometry{constructor(s,o,j,$,_e,tt){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(s,o,j,$,_e,tt)}}class CapsuleBufferGeometry extends CapsuleGeometry$1{constructor(s,o,j,$){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(s,o,j,$)}}class CircleBufferGeometry extends CircleGeometry{constructor(s,o,j,$){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(s,o,j,$)}}class ConeBufferGeometry extends ConeGeometry{constructor(s,o,j,$,_e,tt,nt){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(s,o,j,$,_e,tt,nt)}}class CylinderBufferGeometry extends CylinderGeometry{constructor(s,o,j,$,_e,tt,nt,rt){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(s,o,j,$,_e,tt,nt,rt)}}class DodecahedronBufferGeometry extends DodecahedronGeometry{constructor(s,o){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(s,o)}}class ExtrudeBufferGeometry extends ExtrudeGeometry{constructor(s,o){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(s,o)}}class IcosahedronBufferGeometry extends IcosahedronGeometry{constructor(s,o){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(s,o)}}class LatheBufferGeometry extends LatheGeometry{constructor(s,o,j,$){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(s,o,j,$)}}class OctahedronBufferGeometry extends OctahedronGeometry{constructor(s,o){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(s,o)}}class PlaneBufferGeometry extends PlaneGeometry{constructor(s,o,j,$){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(s,o,j,$)}}class PolyhedronBufferGeometry extends PolyhedronGeometry{constructor(s,o,j,$){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(s,o,j,$)}}class RingBufferGeometry extends RingGeometry{constructor(s,o,j,$,_e,tt){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(s,o,j,$,_e,tt)}}class ShapeBufferGeometry extends ShapeGeometry{constructor(s,o){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(s,o)}}class SphereBufferGeometry extends SphereGeometry{constructor(s,o,j,$,_e,tt,nt){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(s,o,j,$,_e,tt,nt)}}class TetrahedronBufferGeometry extends TetrahedronGeometry{constructor(s,o){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(s,o)}}class TorusBufferGeometry extends TorusGeometry{constructor(s,o,j,$,_e){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(s,o,j,$,_e)}}class TorusKnotBufferGeometry extends TorusKnotGeometry{constructor(s,o,j,$,_e,tt){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(s,o,j,$,_e,tt)}}class TubeBufferGeometry extends TubeGeometry{constructor(s,o,j,$,_e){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(s,o,j,$,_e)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AmbientLightProbe,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxBufferGeometry,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleBufferGeometry,CapsuleGeometry:CapsuleGeometry$1,CatmullRomCurve3,CineonToneMapping,CircleBufferGeometry,CircleGeometry,ClampToEdgeWrapping,Clock,Color,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture:CompressedArrayTexture$1,CompressedTexture,CompressedTextureLoader,ConeBufferGeometry,ConeGeometry,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderBufferGeometry,CylinderGeometry,Cylindrical,Data3DTexture:Data3DTexture$1,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronBufferGeometry,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeBufferGeometry,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Float64BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HalfFloatType,HemisphereLight,HemisphereLightHelper,HemisphereLightProbe,IcosahedronBufferGeometry,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheBufferGeometry,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearEncoding,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronBufferGeometry,OctahedronGeometry,OneFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera,Plane,PlaneBufferGeometry,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronBufferGeometry,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingBufferGeometry,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeBufferGeometry,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereBufferGeometry,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronBufferGeometry,TetrahedronGeometry,Texture,TextureLoader,TorusBufferGeometry,TorusGeometry,TorusKnotBufferGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeBufferGeometry,TubeGeometry,TwoPassDoubleSide,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL1Renderer,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,_SRGBAFormat,sRGBEncoding},Symbol.toStringTag,{value:"Module"}));var constantsExports={},constants={get exports(){return constantsExports},set exports(a){constantsExports=a}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;(function(a){a.exports=reactReconcilerConstants_production_min})(constants);function createStore$1(a){let s;const o=new Set,j=(it,st)=>{const at=typeof it=="function"?it(s):it;if(at!==s){const ot=s;s=st?at:Object.assign({},s,at),o.forEach(ct=>ct(s,ot))}},$=()=>s,_e=(it,st=$,at=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let ot=st(s);function ct(){const ft=st(s);if(!at(ot,ft)){const ht=ot;it(ot=ft,ht)}}return o.add(ct),()=>o.delete(ct)},rt={setState:j,getState:$,subscribe:(it,st,at)=>st||at?_e(it,st,at):(o.add(it),()=>o.delete(it)),destroy:()=>o.clear()};return s=a(j,$,rt),rt}const isSSR=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$1=isSSR?reactExports.useEffect:reactExports.useLayoutEffect;function create(a){const s=typeof a=="function"?createStore$1(a):a,o=(j=s.getState,$=Object.is)=>{const[,_e]=reactExports.useReducer(mt=>mt+1,0),tt=s.getState(),nt=reactExports.useRef(tt),rt=reactExports.useRef(j),it=reactExports.useRef($),st=reactExports.useRef(!1),at=reactExports.useRef();at.current===void 0&&(at.current=j(tt));let ot,ct=!1;(nt.current!==tt||rt.current!==j||it.current!==$||st.current)&&(ot=j(tt),ct=!$(at.current,ot)),useIsomorphicLayoutEffect$1(()=>{ct&&(at.current=ot),nt.current=tt,rt.current=j,it.current=$,st.current=!1});const ft=reactExports.useRef(tt);useIsomorphicLayoutEffect$1(()=>{const mt=()=>{try{const ut=s.getState(),dt=rt.current(ut);it.current(at.current,dt)||(nt.current=ut,at.current=dt,_e())}catch{st.current=!0,_e()}},lt=s.subscribe(mt);return s.getState()!==ft.current&&mt(),lt},[]);const ht=ct?ot:at.current;return reactExports.useDebugValue(ht),ht};return Object.assign(o,s),o[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const j=[o,s];return{next(){const $=j.length<=0;return{value:j.shift(),done:$}}}},o}var reactReconcilerExports={},reactReconciler={get exports(){return reactReconcilerExports},set exports(a){reactReconcilerExports=a}},schedulerExports={},scheduler={get exports(){return schedulerExports},set exports(a){schedulerExports=a}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function s(Lt,Qt){var nn=Lt.length;Lt.push(Qt);e:for(;0<nn;){var mn=nn-1>>>1,Zt=Lt[mn];if(0<$(Zt,Qt))Lt[mn]=Qt,Lt[nn]=Zt,nn=mn;else break e}}function o(Lt){return Lt.length===0?null:Lt[0]}function j(Lt){if(Lt.length===0)return null;var Qt=Lt[0],nn=Lt.pop();if(nn!==Qt){Lt[0]=nn;e:for(var mn=0,Zt=Lt.length,cn=Zt>>>1;mn<cn;){var Ot=2*(mn+1)-1,rn=Lt[Ot],fn=Ot+1,hn=Lt[fn];if(0>$(rn,nn))fn<Zt&&0>$(hn,rn)?(Lt[mn]=hn,Lt[fn]=nn,mn=fn):(Lt[mn]=rn,Lt[Ot]=nn,mn=Ot);else if(fn<Zt&&0>$(hn,nn))Lt[mn]=hn,Lt[fn]=nn,mn=fn;else break e}}return Qt}function $(Lt,Qt){var nn=Lt.sortIndex-Qt.sortIndex;return nn!==0?nn:Lt.id-Qt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _e=performance;a.unstable_now=function(){return _e.now()}}else{var tt=Date,nt=tt.now();a.unstable_now=function(){return tt.now()-nt}}var rt=[],it=[],st=1,at=null,ot=3,ct=!1,ft=!1,ht=!1,mt=typeof setTimeout=="function"?setTimeout:null,lt=typeof clearTimeout=="function"?clearTimeout:null,ut=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function dt(Lt){for(var Qt=o(it);Qt!==null;){if(Qt.callback===null)j(it);else if(Qt.startTime<=Lt)j(it),Qt.sortIndex=Qt.expirationTime,s(rt,Qt);else break;Qt=o(it)}}function gt(Lt){if(ht=!1,dt(Lt),!ft)if(o(rt)!==null)ft=!0,jt(Et);else{var Qt=o(it);Qt!==null&&Vt(gt,Qt.startTime-Lt)}}function Et(Lt,Qt){ft=!1,ht&&(ht=!1,lt(Mt),Mt=-1),ct=!0;var nn=ot;try{for(dt(Qt),at=o(rt);at!==null&&(!(at.expirationTime>Qt)||Lt&&!Ut());){var mn=at.callback;if(typeof mn=="function"){at.callback=null,ot=at.priorityLevel;var Zt=mn(at.expirationTime<=Qt);Qt=a.unstable_now(),typeof Zt=="function"?at.callback=Zt:at===o(rt)&&j(rt),dt(Qt)}else j(rt);at=o(rt)}if(at!==null)var cn=!0;else{var Ot=o(it);Ot!==null&&Vt(gt,Ot.startTime-Qt),cn=!1}return cn}finally{at=null,ot=nn,ct=!1}}var St=!1,Tt=null,Mt=-1,Bt=5,Rt=-1;function Ut(){return!(a.unstable_now()-Rt<Bt)}function Ht(){if(Tt!==null){var Lt=a.unstable_now();Rt=Lt;var Qt=!0;try{Qt=Tt(!0,Lt)}finally{Qt?Wt():(St=!1,Tt=null)}}else St=!1}var Wt;if(typeof ut=="function")Wt=function(){ut(Ht)};else if(typeof MessageChannel<"u"){var Jt=new MessageChannel,sn=Jt.port2;Jt.port1.onmessage=Ht,Wt=function(){sn.postMessage(null)}}else Wt=function(){mt(Ht,0)};function jt(Lt){Tt=Lt,St||(St=!0,Wt())}function Vt(Lt,Qt){Mt=mt(function(){Lt(a.unstable_now())},Qt)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Lt){Lt.callback=null},a.unstable_continueExecution=function(){ft||ct||(ft=!0,jt(Et))},a.unstable_forceFrameRate=function(Lt){0>Lt||125<Lt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Bt=0<Lt?Math.floor(1e3/Lt):5},a.unstable_getCurrentPriorityLevel=function(){return ot},a.unstable_getFirstCallbackNode=function(){return o(rt)},a.unstable_next=function(Lt){switch(ot){case 1:case 2:case 3:var Qt=3;break;default:Qt=ot}var nn=ot;ot=Qt;try{return Lt()}finally{ot=nn}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Lt,Qt){switch(Lt){case 1:case 2:case 3:case 4:case 5:break;default:Lt=3}var nn=ot;ot=Lt;try{return Qt()}finally{ot=nn}},a.unstable_scheduleCallback=function(Lt,Qt,nn){var mn=a.unstable_now();switch(typeof nn=="object"&&nn!==null?(nn=nn.delay,nn=typeof nn=="number"&&0<nn?mn+nn:mn):nn=mn,Lt){case 1:var Zt=-1;break;case 2:Zt=250;break;case 5:Zt=1073741823;break;case 4:Zt=1e4;break;default:Zt=5e3}return Zt=nn+Zt,Lt={id:st++,callback:Qt,priorityLevel:Lt,startTime:nn,expirationTime:Zt,sortIndex:-1},nn>mn?(Lt.sortIndex=nn,s(it,Lt),o(rt)===null&&Lt===o(it)&&(ht?(lt(Mt),Mt=-1):ht=!0,Vt(gt,nn-mn))):(Lt.sortIndex=Zt,s(rt,Lt),ft||ct||(ft=!0,jt(Et))),Lt},a.unstable_shouldYield=Ut,a.unstable_wrapCallback=function(Lt){var Qt=ot;return function(){var nn=ot;ot=Qt;try{return Lt.apply(this,arguments)}finally{ot=nn}}}})(scheduler_production_min);(function(a){a.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function(s){var o={},j=reactExports,$=schedulerExports,_e=Object.assign;function tt(vt){for(var yt="https://reactjs.org/docs/error-decoder.html?invariant="+vt,Ft=1;Ft<arguments.length;Ft++)yt+="&args[]="+encodeURIComponent(arguments[Ft]);return"Minified React error #"+vt+"; visit "+yt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nt=j.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rt=Symbol.for("react.element"),it=Symbol.for("react.portal"),st=Symbol.for("react.fragment"),at=Symbol.for("react.strict_mode"),ot=Symbol.for("react.profiler"),ct=Symbol.for("react.provider"),ft=Symbol.for("react.context"),ht=Symbol.for("react.forward_ref"),mt=Symbol.for("react.suspense"),lt=Symbol.for("react.suspense_list"),ut=Symbol.for("react.memo"),dt=Symbol.for("react.lazy"),gt=Symbol.for("react.offscreen"),Et=Symbol.iterator;function St(vt){return vt===null||typeof vt!="object"?null:(vt=Et&&vt[Et]||vt["@@iterator"],typeof vt=="function"?vt:null)}function Tt(vt){if(vt==null)return null;if(typeof vt=="function")return vt.displayName||vt.name||null;if(typeof vt=="string")return vt;switch(vt){case st:return"Fragment";case it:return"Portal";case ot:return"Profiler";case at:return"StrictMode";case mt:return"Suspense";case lt:return"SuspenseList"}if(typeof vt=="object")switch(vt.$$typeof){case ft:return(vt.displayName||"Context")+".Consumer";case ct:return(vt._context.displayName||"Context")+".Provider";case ht:var yt=vt.render;return vt=vt.displayName,vt||(vt=yt.displayName||yt.name||"",vt=vt!==""?"ForwardRef("+vt+")":"ForwardRef"),vt;case ut:return yt=vt.displayName||null,yt!==null?yt:Tt(vt.type)||"Memo";case dt:yt=vt._payload,vt=vt._init;try{return Tt(vt(yt))}catch{}}return null}function Mt(vt){var yt=vt.type;switch(vt.tag){case 24:return"Cache";case 9:return(yt.displayName||"Context")+".Consumer";case 10:return(yt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return vt=yt.render,vt=vt.displayName||vt.name||"",yt.displayName||(vt!==""?"ForwardRef("+vt+")":"ForwardRef");case 7:return"Fragment";case 5:return yt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tt(yt);case 8:return yt===at?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof yt=="function")return yt.displayName||yt.name||null;if(typeof yt=="string")return yt}return null}function Bt(vt){var yt=vt,Ft=vt;if(vt.alternate)for(;yt.return;)yt=yt.return;else{vt=yt;do yt=vt,yt.flags&4098&&(Ft=yt.return),vt=yt.return;while(vt)}return yt.tag===3?Ft:null}function Rt(vt){if(Bt(vt)!==vt)throw Error(tt(188))}function Ut(vt){var yt=vt.alternate;if(!yt){if(yt=Bt(vt),yt===null)throw Error(tt(188));return yt!==vt?null:vt}for(var Ft=vt,Nt=yt;;){var Xt=Ft.return;if(Xt===null)break;var en=Xt.alternate;if(en===null){if(Nt=Xt.return,Nt!==null){Ft=Nt;continue}break}if(Xt.child===en.child){for(en=Xt.child;en;){if(en===Ft)return Rt(Xt),vt;if(en===Nt)return Rt(Xt),yt;en=en.sibling}throw Error(tt(188))}if(Ft.return!==Nt.return)Ft=Xt,Nt=en;else{for(var zn=!1,ir=Xt.child;ir;){if(ir===Ft){zn=!0,Ft=Xt,Nt=en;break}if(ir===Nt){zn=!0,Nt=Xt,Ft=en;break}ir=ir.sibling}if(!zn){for(ir=en.child;ir;){if(ir===Ft){zn=!0,Ft=en,Nt=Xt;break}if(ir===Nt){zn=!0,Nt=en,Ft=Xt;break}ir=ir.sibling}if(!zn)throw Error(tt(189))}}if(Ft.alternate!==Nt)throw Error(tt(190))}if(Ft.tag!==3)throw Error(tt(188));return Ft.stateNode.current===Ft?vt:yt}function Ht(vt){return vt=Ut(vt),vt!==null?Wt(vt):null}function Wt(vt){if(vt.tag===5||vt.tag===6)return vt;for(vt=vt.child;vt!==null;){var yt=Wt(vt);if(yt!==null)return yt;vt=vt.sibling}return null}function Jt(vt){if(vt.tag===5||vt.tag===6)return vt;for(vt=vt.child;vt!==null;){if(vt.tag!==4){var yt=Jt(vt);if(yt!==null)return yt}vt=vt.sibling}return null}var sn=Array.isArray,jt=s.getPublicInstance,Vt=s.getRootHostContext,Lt=s.getChildHostContext,Qt=s.prepareForCommit,nn=s.resetAfterCommit,mn=s.createInstance,Zt=s.appendInitialChild,cn=s.finalizeInitialChildren,Ot=s.prepareUpdate,rn=s.shouldSetTextContent,fn=s.createTextInstance,hn=s.scheduleTimeout,Tn=s.cancelTimeout,Nn=s.noTimeout,Pn=s.isPrimaryRenderer,Dn=s.supportsMutation,ln=s.supportsPersistence,Cn=s.supportsHydration,bn=s.getInstanceFromNode,kn=s.preparePortalMount,Sn=s.getCurrentEventPriority,xn=s.detachDeletedInstance,Qn=s.supportsMicrotasks,nr=s.scheduleMicrotask,or=s.supportsTestSelectors,mr=s.findFiberRoot,$n=s.getBoundingRect,tn=s.getTextContent,$t=s.isHiddenSubtree,An=s.matchAccessibilityRole,En=s.setFocusIfFocusable,In=s.setupIntersectionObserver,Hn=s.appendChild,yn=s.appendChildToContainer,On=s.commitTextUpdate,Mn=s.commitMount,tr=s.commitUpdate,gr=s.insertBefore,Cr=s.insertInContainerBefore,Sr=s.removeChild,Un=s.removeChildFromContainer,Jn=s.resetTextContent,pr=s.hideInstance,Gn=s.hideTextInstance,Zn=s.unhideInstance,qn=s.unhideTextInstance,vr=s.clearContainer,_r=s.cloneInstance,$r=s.createContainerChildSet,es=s.appendChildToContainerChildSet,Hr=s.finalizeContainerChildren,Ur=s.replaceContainerChildren,Ir=s.cloneHiddenInstance,Fr=s.cloneHiddenTextInstance,Pr=s.canHydrateInstance,Jr=s.canHydrateTextInstance,zs=s.canHydrateSuspenseInstance,Ws=s.isSuspenseInstancePending,Js=s.isSuspenseInstanceFallback,ao=s.registerSuspenseInstanceRetry,Ks=s.getNextHydratableSibling,Es=s.getFirstHydratableChild,Do=s.getFirstHydratableChildWithinContainer,js=s.getFirstHydratableChildWithinSuspenseInstance,pn=s.hydrateInstance,Kt=s.hydrateTextInstance,Gt=s.hydrateSuspenseInstance,zt=s.getNextHydratableInstanceAfterSuspenseInstance,on=s.commitHydratedContainer,dn=s.commitHydratedSuspenseInstance,Vn=s.clearSuspenseBoundary,Kn=s.clearSuspenseBoundaryFromContainer,sr=s.shouldDeleteUnhydratedTailInstances,ar=s.didNotMatchHydratedContainerTextInstance,cr=s.didNotMatchHydratedTextInstance,ur;function wr(vt){if(ur===void 0)try{throw Error()}catch(Ft){var yt=Ft.stack.trim().match(/\n( *(at )?)/);ur=yt&&yt[1]||""}return`
`+ur+vt}var Mr=!1;function Rr(vt,yt){if(!vt||Mr)return"";Mr=!0;var Ft=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(yt)if(yt=function(){throw Error()},Object.defineProperty(yt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(yt,[])}catch(Nr){var Nt=Nr}Reflect.construct(vt,[],yt)}else{try{yt.call()}catch(Nr){Nt=Nr}vt.call(yt.prototype)}else{try{throw Error()}catch(Nr){Nt=Nr}vt()}}catch(Nr){if(Nr&&Nt&&typeof Nr.stack=="string"){for(var Xt=Nr.stack.split(`
`),en=Nt.stack.split(`
`),zn=Xt.length-1,ir=en.length-1;1<=zn&&0<=ir&&Xt[zn]!==en[ir];)ir--;for(;1<=zn&&0<=ir;zn--,ir--)if(Xt[zn]!==en[ir]){if(zn!==1||ir!==1)do if(zn--,ir--,0>ir||Xt[zn]!==en[ir]){var yr=`
`+Xt[zn].replace(" at new "," at ");return vt.displayName&&yr.includes("<anonymous>")&&(yr=yr.replace("<anonymous>",vt.displayName)),yr}while(1<=zn&&0<=ir);break}}}finally{Mr=!1,Error.prepareStackTrace=Ft}return(vt=vt?vt.displayName||vt.name:"")?wr(vt):""}var cs=Object.prototype.hasOwnProperty,ps=[],us=-1;function Kr(vt){return{current:vt}}function As(vt){0>us||(vt.current=ps[us],ps[us]=null,us--)}function ts(vt,yt){us++,ps[us]=vt.current,vt.current=yt}var Ts={},Us=Kr(Ts),Ss=Kr(!1),$s=Ts;function Hs(vt,yt){var Ft=vt.type.contextTypes;if(!Ft)return Ts;var Nt=vt.stateNode;if(Nt&&Nt.__reactInternalMemoizedUnmaskedChildContext===yt)return Nt.__reactInternalMemoizedMaskedChildContext;var Xt={},en;for(en in Ft)Xt[en]=yt[en];return Nt&&(vt=vt.stateNode,vt.__reactInternalMemoizedUnmaskedChildContext=yt,vt.__reactInternalMemoizedMaskedChildContext=Xt),Xt}function Ys(vt){return vt=vt.childContextTypes,vt!=null}function co(){As(Ss),As(Us)}function Cs(vt,yt,Ft){if(Us.current!==Ts)throw Error(tt(168));ts(Us,yt),ts(Ss,Ft)}function Ps(vt,yt,Ft){var Nt=vt.stateNode;if(yt=yt.childContextTypes,typeof Nt.getChildContext!="function")return Ft;Nt=Nt.getChildContext();for(var Xt in Nt)if(!(Xt in yt))throw Error(tt(108,Mt(vt)||"Unknown",Xt));return _e({},Ft,Nt)}function Ns(vt){return vt=(vt=vt.stateNode)&&vt.__reactInternalMemoizedMergedChildContext||Ts,$s=Us.current,ts(Us,vt),ts(Ss,Ss.current),!0}function Gs(vt,yt,Ft){var Nt=vt.stateNode;if(!Nt)throw Error(tt(169));Ft?(vt=Ps(vt,yt,$s),Nt.__reactInternalMemoizedMergedChildContext=vt,As(Ss),As(Us),ts(Us,vt)):As(Ss),ts(Ss,Ft)}var ro=Math.clz32?Math.clz32:$o,Gl=Math.log,Bo=Math.LN2;function $o(vt){return vt>>>=0,vt===0?32:31-(Gl(vt)/Bo|0)|0}var Lu=64,_d=4194304;function fs(vt){switch(vt&-vt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return vt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return vt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return vt}}function gu(vt,yt){var Ft=vt.pendingLanes;if(Ft===0)return 0;var Nt=0,Xt=vt.suspendedLanes,en=vt.pingedLanes,zn=Ft&268435455;if(zn!==0){var ir=zn&~Xt;ir!==0?Nt=fs(ir):(en&=zn,en!==0&&(Nt=fs(en)))}else zn=Ft&~Xt,zn!==0?Nt=fs(zn):en!==0&&(Nt=fs(en));if(Nt===0)return 0;if(yt!==0&&yt!==Nt&&!(yt&Xt)&&(Xt=Nt&-Nt,en=yt&-yt,Xt>=en||Xt===16&&(en&4194240)!==0))return yt;if(Nt&4&&(Nt|=Ft&16),yt=vt.entangledLanes,yt!==0)for(vt=vt.entanglements,yt&=Nt;0<yt;)Ft=31-ro(yt),Xt=1<<Ft,Nt|=vt[Ft],yt&=~Xt;return Nt}function _n(vt,yt){switch(vt){case 1:case 2:case 4:return yt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return yt+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vn(vt,yt){for(var Ft=vt.suspendedLanes,Nt=vt.pingedLanes,Xt=vt.expirationTimes,en=vt.pendingLanes;0<en;){var zn=31-ro(en),ir=1<<zn,yr=Xt[zn];yr===-1?(!(ir&Ft)||ir&Nt)&&(Xt[zn]=_n(ir,yt)):yr<=yt&&(vt.expiredLanes|=ir),en&=~ir}}function Bn(vt){return vt=vt.pendingLanes&-1073741825,vt!==0?vt:vt&1073741824?1073741824:0}function wn(vt){for(var yt=[],Ft=0;31>Ft;Ft++)yt.push(vt);return yt}function Fn(vt,yt,Ft){vt.pendingLanes|=yt,yt!==536870912&&(vt.suspendedLanes=0,vt.pingedLanes=0),vt=vt.eventTimes,yt=31-ro(yt),vt[yt]=Ft}function fr(vt,yt){var Ft=vt.pendingLanes&~yt;vt.pendingLanes=yt,vt.suspendedLanes=0,vt.pingedLanes=0,vt.expiredLanes&=yt,vt.mutableReadLanes&=yt,vt.entangledLanes&=yt,yt=vt.entanglements;var Nt=vt.eventTimes;for(vt=vt.expirationTimes;0<Ft;){var Xt=31-ro(Ft),en=1<<Xt;yt[Xt]=0,Nt[Xt]=-1,vt[Xt]=-1,Ft&=~en}}function Er(vt,yt){var Ft=vt.entangledLanes|=yt;for(vt=vt.entanglements;Ft;){var Nt=31-ro(Ft),Xt=1<<Nt;Xt&yt|vt[Nt]&yt&&(vt[Nt]|=yt),Ft&=~Xt}}var Tr=0;function _i(vt){return vt&=-vt,1<vt?4<vt?vt&268435455?16:536870912:4:1}var Yr=$.unstable_scheduleCallback,Qr=$.unstable_cancelCallback,Dr=$.unstable_shouldYield,vs=$.unstable_requestPaint,Vr=$.unstable_now,ms=$.unstable_ImmediatePriority,Zr=$.unstable_UserBlockingPriority,io=$.unstable_NormalPriority,Xs=$.unstable_IdlePriority,Vs=null,Ms=null;function Yl(vt){if(Ms&&typeof Ms.onCommitFiberRoot=="function")try{Ms.onCommitFiberRoot(Vs,vt,void 0,(vt.current.flags&128)===128)}catch{}}function Ro(vt,yt){return vt===yt&&(vt!==0||1/vt===1/yt)||vt!==vt&&yt!==yt}var Wo=typeof Object.is=="function"?Object.is:Ro,To=null,Au=!1,Gm=!1;function xp(vt){To===null?To=[vt]:To.push(vt)}function u1(vt){Au=!0,xp(vt)}function Jl(){if(!Gm&&To!==null){Gm=!0;var vt=0,yt=Tr;try{var Ft=To;for(Tr=1;vt<Ft.length;vt++){var Nt=Ft[vt];do Nt=Nt(!0);while(Nt!==null)}To=null,Au=!1}catch(Xt){throw To!==null&&(To=To.slice(vt+1)),Yr(ms,Jl),Xt}finally{Tr=yt,Gm=!1}}return null}var Jp=nt.ReactCurrentBatchConfig;function Ep(vt,yt){if(Wo(vt,yt))return!0;if(typeof vt!="object"||vt===null||typeof yt!="object"||yt===null)return!1;var Ft=Object.keys(vt),Nt=Object.keys(yt);if(Ft.length!==Nt.length)return!1;for(Nt=0;Nt<Ft.length;Nt++){var Xt=Ft[Nt];if(!cs.call(yt,Xt)||!Wo(vt[Xt],yt[Xt]))return!1}return!0}function h1(vt){switch(vt.tag){case 5:return wr(vt.type);case 16:return wr("Lazy");case 13:return wr("Suspense");case 19:return wr("SuspenseList");case 0:case 2:case 15:return vt=Rr(vt.type,!1),vt;case 11:return vt=Rr(vt.type.render,!1),vt;case 1:return vt=Rr(vt.type,!0),vt;default:return""}}function Zl(vt,yt){if(vt&&vt.defaultProps){yt=_e({},yt),vt=vt.defaultProps;for(var Ft in vt)yt[Ft]===void 0&&(yt[Ft]=vt[Ft]);return yt}return yt}var ep=Kr(null),Zp=null,ku=null,Xo=null;function Rl(){Xo=ku=Zp=null}function Nu(vt,yt,Ft){Pn?(ts(ep,yt._currentValue),yt._currentValue=Ft):(ts(ep,yt._currentValue2),yt._currentValue2=Ft)}function Vm(vt){var yt=ep.current;As(ep),Pn?vt._currentValue=yt:vt._currentValue2=yt}function Mo(vt,yt,Ft){for(;vt!==null;){var Nt=vt.alternate;if((vt.childLanes&yt)!==yt?(vt.childLanes|=yt,Nt!==null&&(Nt.childLanes|=yt)):Nt!==null&&(Nt.childLanes&yt)!==yt&&(Nt.childLanes|=yt),vt===Ft)break;vt=vt.return}}function tp(vt,yt){Zp=vt,Xo=ku=null,vt=vt.dependencies,vt!==null&&vt.firstContext!==null&&(vt.lanes&yt&&(Jo=!0),vt.firstContext=null)}function Fl(vt){var yt=Pn?vt._currentValue:vt._currentValue2;if(Xo!==vt)if(vt={context:vt,memoizedValue:yt,next:null},ku===null){if(Zp===null)throw Error(tt(308));ku=vt,Zp.dependencies={lanes:0,firstContext:vt}}else ku=ku.next=vt;return yt}var su=null,Tu=!1;function Du(vt){vt.updateQueue={baseState:vt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zm(vt,yt){vt=vt.updateQueue,yt.updateQueue===vt&&(yt.updateQueue={baseState:vt.baseState,firstBaseUpdate:vt.firstBaseUpdate,lastBaseUpdate:vt.lastBaseUpdate,shared:vt.shared,effects:vt.effects})}function _c(vt,yt){return{eventTime:vt,lane:yt,tag:0,payload:null,callback:null,next:null}}function eu(vt,yt){var Ft=vt.updateQueue;Ft!==null&&(Ft=Ft.shared,wo!==null&&vt.mode&1&&!(Ds&2)?(vt=Ft.interleaved,vt===null?(yt.next=yt,su===null?su=[Ft]:su.push(Ft)):(yt.next=vt.next,vt.next=yt),Ft.interleaved=yt):(vt=Ft.pending,vt===null?yt.next=yt:(yt.next=vt.next,vt.next=yt),Ft.pending=yt))}function Sp(vt,yt,Ft){if(yt=yt.updateQueue,yt!==null&&(yt=yt.shared,(Ft&4194240)!==0)){var Nt=yt.lanes;Nt&=vt.pendingLanes,Ft|=Nt,yt.lanes=Ft,Er(vt,Ft)}}function Ou(vt,yt){var Ft=vt.updateQueue,Nt=vt.alternate;if(Nt!==null&&(Nt=Nt.updateQueue,Ft===Nt)){var Xt=null,en=null;if(Ft=Ft.firstBaseUpdate,Ft!==null){do{var zn={eventTime:Ft.eventTime,lane:Ft.lane,tag:Ft.tag,payload:Ft.payload,callback:Ft.callback,next:null};en===null?Xt=en=zn:en=en.next=zn,Ft=Ft.next}while(Ft!==null);en===null?Xt=en=yt:en=en.next=yt}else Xt=en=yt;Ft={baseState:Nt.baseState,firstBaseUpdate:Xt,lastBaseUpdate:en,shared:Nt.shared,effects:Nt.effects},vt.updateQueue=Ft;return}vt=Ft.lastBaseUpdate,vt===null?Ft.firstBaseUpdate=yt:vt.next=yt,Ft.lastBaseUpdate=yt}function em(vt,yt,Ft,Nt){var Xt=vt.updateQueue;Tu=!1;var en=Xt.firstBaseUpdate,zn=Xt.lastBaseUpdate,ir=Xt.shared.pending;if(ir!==null){Xt.shared.pending=null;var yr=ir,Nr=yr.next;yr.next=null,zn===null?en=Nr:zn.next=Nr,zn=yr;var os=vt.alternate;os!==null&&(os=os.updateQueue,ir=os.lastBaseUpdate,ir!==zn&&(ir===null?os.firstBaseUpdate=Nr:ir.next=Nr,os.lastBaseUpdate=yr))}if(en!==null){var Ls=Xt.baseState;zn=0,os=Nr=yr=null,ir=en;do{var _s=ir.lane,mo=ir.eventTime;if((Nt&_s)===_s){os!==null&&(os=os.next={eventTime:mo,lane:0,tag:ir.tag,payload:ir.payload,callback:ir.callback,next:null});e:{var Br=vt,Bl=ir;switch(_s=yt,mo=Ft,Bl.tag){case 1:if(Br=Bl.payload,typeof Br=="function"){Ls=Br.call(mo,Ls,_s);break e}Ls=Br;break e;case 3:Br.flags=Br.flags&-65537|128;case 0:if(Br=Bl.payload,_s=typeof Br=="function"?Br.call(mo,Ls,_s):Br,_s==null)break e;Ls=_e({},Ls,_s);break e;case 2:Tu=!0}}ir.callback!==null&&ir.lane!==0&&(vt.flags|=64,_s=Xt.effects,_s===null?Xt.effects=[ir]:_s.push(ir))}else mo={eventTime:mo,lane:_s,tag:ir.tag,payload:ir.payload,callback:ir.callback,next:null},os===null?(Nr=os=mo,yr=Ls):os=os.next=mo,zn|=_s;if(ir=ir.next,ir===null){if(ir=Xt.shared.pending,ir===null)break;_s=ir,ir=_s.next,_s.next=null,Xt.lastBaseUpdate=_s,Xt.shared.pending=null}}while(1);if(os===null&&(yr=Ls),Xt.baseState=yr,Xt.firstBaseUpdate=Nr,Xt.lastBaseUpdate=os,yt=Xt.shared.interleaved,yt!==null){Xt=yt;do zn|=Xt.lane,Xt=Xt.next;while(Xt!==yt)}else en===null&&(Xt.shared.lanes=0);dp|=zn,vt.lanes=zn,vt.memoizedState=Ls}}function _0(vt,yt,Ft){if(vt=yt.effects,yt.effects=null,vt!==null)for(yt=0;yt<vt.length;yt++){var Nt=vt[yt],Xt=Nt.callback;if(Xt!==null){if(Nt.callback=null,Nt=Ft,typeof Xt!="function")throw Error(tt(191,Xt));Xt.call(Nt)}}}var x0=new j.Component().refs;function bp(vt,yt,Ft,Nt){yt=vt.memoizedState,Ft=Ft(Nt,yt),Ft=Ft==null?yt:_e({},yt,Ft),vt.memoizedState=Ft,vt.lanes===0&&(vt.updateQueue.baseState=Ft)}var Cp={isMounted:function(vt){return(vt=vt._reactInternals)?Bt(vt)===vt:!1},enqueueSetState:function(vt,yt,Ft){vt=vt._reactInternals;var Nt=Al(),Xt=du(vt),en=_c(Nt,Xt);en.payload=yt,Ft!=null&&(en.callback=Ft),eu(vt,en),yt=$l(vt,Xt,Nt),yt!==null&&Sp(yt,vt,Xt)},enqueueReplaceState:function(vt,yt,Ft){vt=vt._reactInternals;var Nt=Al(),Xt=du(vt),en=_c(Nt,Xt);en.tag=1,en.payload=yt,Ft!=null&&(en.callback=Ft),eu(vt,en),yt=$l(vt,Xt,Nt),yt!==null&&Sp(yt,vt,Xt)},enqueueForceUpdate:function(vt,yt){vt=vt._reactInternals;var Ft=Al(),Nt=du(vt),Xt=_c(Ft,Nt);Xt.tag=2,yt!=null&&(Xt.callback=yt),eu(vt,Xt),yt=$l(vt,Nt,Ft),yt!==null&&Sp(yt,vt,Nt)}};function Hm(vt,yt,Ft,Nt,Xt,en,zn){return vt=vt.stateNode,typeof vt.shouldComponentUpdate=="function"?vt.shouldComponentUpdate(Nt,en,zn):yt.prototype&&yt.prototype.isPureReactComponent?!Ep(Ft,Nt)||!Ep(Xt,en):!0}function np(vt,yt,Ft){var Nt=!1,Xt=Ts,en=yt.contextType;return typeof en=="object"&&en!==null?en=Fl(en):(Xt=Ys(yt)?$s:Us.current,Nt=yt.contextTypes,en=(Nt=Nt!=null)?Hs(vt,Xt):Ts),yt=new yt(Ft,en),vt.memoizedState=yt.state!==null&&yt.state!==void 0?yt.state:null,yt.updater=Cp,vt.stateNode=yt,yt._reactInternals=vt,Nt&&(vt=vt.stateNode,vt.__reactInternalMemoizedUnmaskedChildContext=Xt,vt.__reactInternalMemoizedMaskedChildContext=en),yt}function rp(vt,yt,Ft,Nt){vt=yt.state,typeof yt.componentWillReceiveProps=="function"&&yt.componentWillReceiveProps(Ft,Nt),typeof yt.UNSAFE_componentWillReceiveProps=="function"&&yt.UNSAFE_componentWillReceiveProps(Ft,Nt),yt.state!==vt&&Cp.enqueueReplaceState(yt,yt.state,null)}function ga(vt,yt,Ft,Nt){var Xt=vt.stateNode;Xt.props=Ft,Xt.state=vt.memoizedState,Xt.refs=x0,Du(vt);var en=yt.contextType;typeof en=="object"&&en!==null?Xt.context=Fl(en):(en=Ys(yt)?$s:Us.current,Xt.context=Hs(vt,en)),Xt.state=vt.memoizedState,en=yt.getDerivedStateFromProps,typeof en=="function"&&(bp(vt,yt,en,Ft),Xt.state=vt.memoizedState),typeof yt.getDerivedStateFromProps=="function"||typeof Xt.getSnapshotBeforeUpdate=="function"||typeof Xt.UNSAFE_componentWillMount!="function"&&typeof Xt.componentWillMount!="function"||(yt=Xt.state,typeof Xt.componentWillMount=="function"&&Xt.componentWillMount(),typeof Xt.UNSAFE_componentWillMount=="function"&&Xt.UNSAFE_componentWillMount(),yt!==Xt.state&&Cp.enqueueReplaceState(Xt,Xt.state,null),em(vt,Ft,Xt,Nt),Xt.state=vt.memoizedState),typeof Xt.componentDidMount=="function"&&(vt.flags|=4194308)}var ip=[],Mu=0,_l=null,Tp=0,Ko=[],xl=0,Uu=null,ou=1,au="";function Gu(vt,yt){ip[Mu++]=Tp,ip[Mu++]=_l,_l=vt,Tp=yt}function E0(vt,yt,Ft){Ko[xl++]=ou,Ko[xl++]=au,Ko[xl++]=Uu,Uu=vt;var Nt=ou;vt=au;var Xt=32-ro(Nt)-1;Nt&=~(1<<Xt),Ft+=1;var en=32-ro(yt)+Xt;if(30<en){var zn=Xt-Xt%5;en=(Nt&(1<<zn)-1).toString(32),Nt>>=zn,Xt-=zn,ou=1<<32-ro(yt)+Xt|Ft<<Xt|Nt,au=en+vt}else ou=1<<en|Ft<<Xt|Nt,au=vt}function tu(vt){vt.return!==null&&(Gu(vt,1),E0(vt,1,0))}function tm(vt){for(;vt===_l;)_l=ip[--Mu],ip[Mu]=null,Tp=ip[--Mu],ip[Mu]=null;for(;vt===Uu;)Uu=Ko[--xl],Ko[xl]=null,au=Ko[--xl],Ko[xl]=null,ou=Ko[--xl],Ko[xl]=null}var Oo=null,Fo=null,uo=!1,lu=!1,Vl=null;function S0(vt,yt){var Ft=lo(5,null,null,0);Ft.elementType="DELETED",Ft.stateNode=yt,Ft.return=vt,yt=vt.deletions,yt===null?(vt.deletions=[Ft],vt.flags|=16):yt.push(Ft)}function Qm(vt,yt){switch(vt.tag){case 5:return yt=Pr(yt,vt.type,vt.pendingProps),yt!==null?(vt.stateNode=yt,Oo=vt,Fo=Es(yt),!0):!1;case 6:return yt=Jr(yt,vt.pendingProps),yt!==null?(vt.stateNode=yt,Oo=vt,Fo=null,!0):!1;case 13:if(yt=zs(yt),yt!==null){var Ft=Uu!==null?{id:ou,overflow:au}:null;return vt.memoizedState={dehydrated:yt,treeContext:Ft,retryLane:1073741824},Ft=lo(18,null,null,0),Ft.stateNode=yt,Ft.return=vt,vt.child=Ft,Oo=vt,Fo=null,!0}return!1;default:return!1}}function Wm(vt){return(vt.mode&1)!==0&&(vt.flags&128)===0}function nu(vt){if(uo){var yt=Fo;if(yt){var Ft=yt;if(!Qm(vt,yt)){if(Wm(vt))throw Error(tt(418));yt=Ks(Ft);var Nt=Oo;yt&&Qm(vt,yt)?S0(Nt,Ft):(vt.flags=vt.flags&-4097|2,uo=!1,Oo=vt)}}else{if(Wm(vt))throw Error(tt(418));vt.flags=vt.flags&-4097|2,uo=!1,Oo=vt}}}function b0(vt){for(vt=vt.return;vt!==null&&vt.tag!==5&&vt.tag!==3&&vt.tag!==13;)vt=vt.return;Oo=vt}function Vu(vt){if(!Cn||vt!==Oo)return!1;if(!uo)return b0(vt),uo=!0,!1;if(vt.tag!==3&&(vt.tag!==5||sr(vt.type)&&!rn(vt.type,vt.memoizedProps))){var yt=Fo;if(yt){if(Wm(vt)){for(vt=Fo;vt;)vt=Ks(vt);throw Error(tt(418))}for(;yt;)S0(vt,yt),yt=Ks(yt)}}if(b0(vt),vt.tag===13){if(!Cn)throw Error(tt(316));if(vt=vt.memoizedState,vt=vt!==null?vt.dehydrated:null,!vt)throw Error(tt(317));Fo=zt(vt)}else Fo=Oo?Ks(vt.stateNode):null;return!0}function zu(){Cn&&(Fo=Oo=null,lu=uo=!1)}function zl(vt){Vl===null?Vl=[vt]:Vl.push(vt)}function Pl(vt,yt,Ft){if(vt=Ft.ref,vt!==null&&typeof vt!="function"&&typeof vt!="object"){if(Ft._owner){if(Ft=Ft._owner,Ft){if(Ft.tag!==1)throw Error(tt(309));var Nt=Ft.stateNode}if(!Nt)throw Error(tt(147,vt));var Xt=Nt,en=""+vt;return yt!==null&&yt.ref!==null&&typeof yt.ref=="function"&&yt.ref._stringRef===en?yt.ref:(yt=function(zn){var ir=Xt.refs;ir===x0&&(ir=Xt.refs={}),zn===null?delete ir[en]:ir[en]=zn},yt._stringRef=en,yt)}if(typeof vt!="string")throw Error(tt(284));if(!Ft._owner)throw Error(tt(290,vt))}return vt}function wu(vt,yt){throw vt=Object.prototype.toString.call(yt),Error(tt(31,vt==="[object Object]"?"object with keys {"+Object.keys(yt).join(", ")+"}":vt))}function sp(vt){var yt=vt._init;return yt(vt._payload)}function cu(vt){function yt(dr,er){if(vt){var Ar=dr.deletions;Ar===null?(dr.deletions=[er],dr.flags|=16):Ar.push(er)}}function Ft(dr,er){if(!vt)return null;for(;er!==null;)yt(dr,er),er=er.sibling;return null}function Nt(dr,er){for(dr=new Map;er!==null;)er.key!==null?dr.set(er.key,er):dr.set(er.index,er),er=er.sibling;return dr}function Xt(dr,er){return dr=oo(dr,er),dr.index=0,dr.sibling=null,dr}function en(dr,er,Ar){return dr.index=Ar,vt?(Ar=dr.alternate,Ar!==null?(Ar=Ar.index,Ar<er?(dr.flags|=2,er):Ar):(dr.flags|=2,er)):(dr.flags|=1048576,er)}function zn(dr){return vt&&dr.alternate===null&&(dr.flags|=2),dr}function ir(dr,er,Ar,Or){return er===null||er.tag!==6?(er=_o(Ar,dr.mode,Or),er.return=dr,er):(er=Xt(er,Ar),er.return=dr,er)}function yr(dr,er,Ar,Or){var ds=Ar.type;return ds===st?os(dr,er,Ar.props.children,Or,Ar.key):er!==null&&(er.elementType===ds||typeof ds=="object"&&ds!==null&&ds.$$typeof===dt&&sp(ds)===er.type)?(Or=Xt(er,Ar.props),Or.ref=Pl(dr,er,Ar),Or.return=dr,Or):(Or=go(Ar.type,Ar.key,Ar.props,null,dr.mode,Or),Or.ref=Pl(dr,er,Ar),Or.return=dr,Or)}function Nr(dr,er,Ar,Or){return er===null||er.tag!==4||er.stateNode.containerInfo!==Ar.containerInfo||er.stateNode.implementation!==Ar.implementation?(er=Io(Ar,dr.mode,Or),er.return=dr,er):(er=Xt(er,Ar.children||[]),er.return=dr,er)}function os(dr,er,Ar,Or,ds){return er===null||er.tag!==7?(er=no(Ar,dr.mode,Or,ds),er.return=dr,er):(er=Xt(er,Ar),er.return=dr,er)}function Ls(dr,er,Ar){if(typeof er=="string"&&er!==""||typeof er=="number")return er=_o(""+er,dr.mode,Ar),er.return=dr,er;if(typeof er=="object"&&er!==null){switch(er.$$typeof){case rt:return Ar=go(er.type,er.key,er.props,null,dr.mode,Ar),Ar.ref=Pl(dr,null,er),Ar.return=dr,Ar;case it:return er=Io(er,dr.mode,Ar),er.return=dr,er;case dt:var Or=er._init;return Ls(dr,Or(er._payload),Ar)}if(sn(er)||St(er))return er=no(er,dr.mode,Ar,null),er.return=dr,er;wu(dr,er)}return null}function _s(dr,er,Ar,Or){var ds=er!==null?er.key:null;if(typeof Ar=="string"&&Ar!==""||typeof Ar=="number")return ds!==null?null:ir(dr,er,""+Ar,Or);if(typeof Ar=="object"&&Ar!==null){switch(Ar.$$typeof){case rt:return Ar.key===ds?yr(dr,er,Ar,Or):null;case it:return Ar.key===ds?Nr(dr,er,Ar,Or):null;case dt:return ds=Ar._init,_s(dr,er,ds(Ar._payload),Or)}if(sn(Ar)||St(Ar))return ds!==null?null:os(dr,er,Ar,Or,null);wu(dr,Ar)}return null}function mo(dr,er,Ar,Or,ds){if(typeof Or=="string"&&Or!==""||typeof Or=="number")return dr=dr.get(Ar)||null,ir(er,dr,""+Or,ds);if(typeof Or=="object"&&Or!==null){switch(Or.$$typeof){case rt:return dr=dr.get(Or.key===null?Ar:Or.key)||null,yr(er,dr,Or,ds);case it:return dr=dr.get(Or.key===null?Ar:Or.key)||null,Nr(er,dr,Or,ds);case dt:var Os=Or._init;return mo(dr,er,Ar,Os(Or._payload),ds)}if(sn(Or)||St(Or))return dr=dr.get(Ar)||null,os(er,dr,Or,ds,null);wu(er,Or)}return null}function Br(dr,er,Ar,Or){for(var ds=null,Os=null,ks=er,eo=er=0,na=null;ks!==null&&eo<Ar.length;eo++){ks.index>eo?(na=ks,ks=null):na=ks.sibling;var to=_s(dr,ks,Ar[eo],Or);if(to===null){ks===null&&(ks=na);break}vt&&ks&&to.alternate===null&&yt(dr,ks),er=en(to,er,eo),Os===null?ds=to:Os.sibling=to,Os=to,ks=na}if(eo===Ar.length)return Ft(dr,ks),uo&&Gu(dr,eo),ds;if(ks===null){for(;eo<Ar.length;eo++)ks=Ls(dr,Ar[eo],Or),ks!==null&&(er=en(ks,er,eo),Os===null?ds=ks:Os.sibling=ks,Os=ks);return uo&&Gu(dr,eo),ds}for(ks=Nt(dr,ks);eo<Ar.length;eo++)na=mo(ks,dr,eo,Ar[eo],Or),na!==null&&(vt&&na.alternate!==null&&ks.delete(na.key===null?eo:na.key),er=en(na,er,eo),Os===null?ds=na:Os.sibling=na,Os=na);return vt&&ks.forEach(function(qs){return yt(dr,qs)}),uo&&Gu(dr,eo),ds}function Bl(dr,er,Ar,Or){var ds=St(Ar);if(typeof ds!="function")throw Error(tt(150));if(Ar=ds.call(Ar),Ar==null)throw Error(tt(151));for(var Os=ds=null,ks=er,eo=er=0,na=null,to=Ar.next();ks!==null&&!to.done;eo++,to=Ar.next()){ks.index>eo?(na=ks,ks=null):na=ks.sibling;var qs=_s(dr,ks,to.value,Or);if(qs===null){ks===null&&(ks=na);break}vt&&ks&&qs.alternate===null&&yt(dr,ks),er=en(qs,er,eo),Os===null?ds=qs:Os.sibling=qs,Os=qs,ks=na}if(to.done)return Ft(dr,ks),uo&&Gu(dr,eo),ds;if(ks===null){for(;!to.done;eo++,to=Ar.next())to=Ls(dr,to.value,Or),to!==null&&(er=en(to,er,eo),Os===null?ds=to:Os.sibling=to,Os=to);return uo&&Gu(dr,eo),ds}for(ks=Nt(dr,ks);!to.done;eo++,to=Ar.next())to=mo(ks,dr,eo,to.value,Or),to!==null&&(vt&&to.alternate!==null&&ks.delete(to.key===null?eo:to.key),er=en(to,er,eo),Os===null?ds=to:Os.sibling=to,Os=to);return vt&&ks.forEach(function(o3){return yt(dr,o3)}),uo&&Gu(dr,eo),ds}function xo(dr,er,Ar,Or){if(typeof Ar=="object"&&Ar!==null&&Ar.type===st&&Ar.key===null&&(Ar=Ar.props.children),typeof Ar=="object"&&Ar!==null){switch(Ar.$$typeof){case rt:e:{for(var ds=Ar.key,Os=er;Os!==null;){if(Os.key===ds){if(ds=Ar.type,ds===st){if(Os.tag===7){Ft(dr,Os.sibling),er=Xt(Os,Ar.props.children),er.return=dr,dr=er;break e}}else if(Os.elementType===ds||typeof ds=="object"&&ds!==null&&ds.$$typeof===dt&&sp(ds)===Os.type){Ft(dr,Os.sibling),er=Xt(Os,Ar.props),er.ref=Pl(dr,Os,Ar),er.return=dr,dr=er;break e}Ft(dr,Os);break}else yt(dr,Os);Os=Os.sibling}Ar.type===st?(er=no(Ar.props.children,dr.mode,Or,Ar.key),er.return=dr,dr=er):(Or=go(Ar.type,Ar.key,Ar.props,null,dr.mode,Or),Or.ref=Pl(dr,er,Ar),Or.return=dr,dr=Or)}return zn(dr);case it:e:{for(Os=Ar.key;er!==null;){if(er.key===Os)if(er.tag===4&&er.stateNode.containerInfo===Ar.containerInfo&&er.stateNode.implementation===Ar.implementation){Ft(dr,er.sibling),er=Xt(er,Ar.children||[]),er.return=dr,dr=er;break e}else{Ft(dr,er);break}else yt(dr,er);er=er.sibling}er=Io(Ar,dr.mode,Or),er.return=dr,dr=er}return zn(dr);case dt:return Os=Ar._init,xo(dr,er,Os(Ar._payload),Or)}if(sn(Ar))return Br(dr,er,Ar,Or);if(St(Ar))return Bl(dr,er,Ar,Or);wu(dr,Ar)}return typeof Ar=="string"&&Ar!==""||typeof Ar=="number"?(Ar=""+Ar,er!==null&&er.tag===6?(Ft(dr,er.sibling),er=Xt(er,Ar),er.return=dr,dr=er):(Ft(dr,er),er=_o(Ar,dr.mode,Or),er.return=dr,dr=er),zn(dr)):Ft(dr,er)}return xo}var uu=cu(!0),Mp=cu(!1),Hl={},Po=Kr(Hl),Iu=Kr(Hl),Hu=Kr(Hl);function Ll(vt){if(vt===Hl)throw Error(tt(174));return vt}function wp(vt,yt){ts(Hu,yt),ts(Iu,vt),ts(Po,Hl),vt=Vt(yt),As(Po),ts(Po,vt)}function Qu(){As(Po),As(Iu),As(Hu)}function op(vt){var yt=Ll(Hu.current),Ft=Ll(Po.current);yt=Lt(Ft,vt.type,yt),Ft!==yt&&(ts(Iu,vt),ts(Po,yt))}function Nl(vt){Iu.current===vt&&(As(Po),As(Iu))}var Ao=Kr(0);function Ip(vt){for(var yt=vt;yt!==null;){if(yt.tag===13){var Ft=yt.memoizedState;if(Ft!==null&&(Ft=Ft.dehydrated,Ft===null||Ws(Ft)||Js(Ft)))return yt}else if(yt.tag===19&&yt.memoizedProps.revealOrder!==void 0){if(yt.flags&128)return yt}else if(yt.child!==null){yt.child.return=yt,yt=yt.child;continue}if(yt===vt)break;for(;yt.sibling===null;){if(yt.return===null||yt.return===vt)return null;yt=yt.return}yt.sibling.return=yt.return,yt=yt.sibling}return null}var nm=[];function jm(){for(var vt=0;vt<nm.length;vt++){var yt=nm[vt];Pn?yt._workInProgressVersionPrimary=null:yt._workInProgressVersionSecondary=null}nm.length=0}var rm=nt.ReactCurrentDispatcher,Ql=nt.ReactCurrentBatchConfig,ap=0,So=null,Yo=null,Uo=null,Dl=!1,Bp=!1,Rp=0,C0=0;function jo(){throw Error(tt(321))}function $m(vt,yt){if(yt===null)return!1;for(var Ft=0;Ft<yt.length&&Ft<vt.length;Ft++)if(!Wo(vt[Ft],yt[Ft]))return!1;return!0}function im(vt,yt,Ft,Nt,Xt,en){if(ap=en,So=yt,yt.memoizedState=null,yt.updateQueue=null,yt.lanes=0,rm.current=vt===null||vt.memoizedState===null?up:f1,vt=Ft(Nt,Xt),Bp){en=0;do{if(Bp=!1,Rp=0,25<=en)throw Error(tt(301));en+=1,Uo=Yo=null,yt.updateQueue=null,rm.current=d1,vt=Ft(Nt,Xt)}while(Bp)}if(rm.current=fu,yt=Yo!==null&&Yo.next!==null,ap=0,Uo=Yo=So=null,Dl=!1,yt)throw Error(tt(300));return vt}function sm(){var vt=Rp!==0;return Rp=0,vt}function vu(){var vt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Uo===null?So.memoizedState=Uo=vt:Uo=Uo.next=vt,Uo}function Wl(){if(Yo===null){var vt=So.alternate;vt=vt!==null?vt.memoizedState:null}else vt=Yo.next;var yt=Uo===null?So.memoizedState:Uo.next;if(yt!==null)Uo=yt,Yo=vt;else{if(vt===null)throw Error(tt(310));Yo=vt,vt={memoizedState:Yo.memoizedState,baseState:Yo.baseState,baseQueue:Yo.baseQueue,queue:Yo.queue,next:null},Uo===null?So.memoizedState=Uo=vt:Uo=Uo.next=vt}return Uo}function hu(vt,yt){return typeof yt=="function"?yt(vt):yt}function om(vt){var yt=Wl(),Ft=yt.queue;if(Ft===null)throw Error(tt(311));Ft.lastRenderedReducer=vt;var Nt=Yo,Xt=Nt.baseQueue,en=Ft.pending;if(en!==null){if(Xt!==null){var zn=Xt.next;Xt.next=en.next,en.next=zn}Nt.baseQueue=Xt=en,Ft.pending=null}if(Xt!==null){en=Xt.next,Nt=Nt.baseState;var ir=zn=null,yr=null,Nr=en;do{var os=Nr.lane;if((ap&os)===os)yr!==null&&(yr=yr.next={lane:0,action:Nr.action,hasEagerState:Nr.hasEagerState,eagerState:Nr.eagerState,next:null}),Nt=Nr.hasEagerState?Nr.eagerState:vt(Nt,Nr.action);else{var Ls={lane:os,action:Nr.action,hasEagerState:Nr.hasEagerState,eagerState:Nr.eagerState,next:null};yr===null?(ir=yr=Ls,zn=Nt):yr=yr.next=Ls,So.lanes|=os,dp|=os}Nr=Nr.next}while(Nr!==null&&Nr!==en);yr===null?zn=Nt:yr.next=ir,Wo(Nt,yt.memoizedState)||(Jo=!0),yt.memoizedState=Nt,yt.baseState=zn,yt.baseQueue=yr,Ft.lastRenderedState=Nt}if(vt=Ft.interleaved,vt!==null){Xt=vt;do en=Xt.lane,So.lanes|=en,dp|=en,Xt=Xt.next;while(Xt!==vt)}else Xt===null&&(Ft.lanes=0);return[yt.memoizedState,Ft.dispatch]}function am(vt){var yt=Wl(),Ft=yt.queue;if(Ft===null)throw Error(tt(311));Ft.lastRenderedReducer=vt;var Nt=Ft.dispatch,Xt=Ft.pending,en=yt.memoizedState;if(Xt!==null){Ft.pending=null;var zn=Xt=Xt.next;do en=vt(en,zn.action),zn=zn.next;while(zn!==Xt);Wo(en,yt.memoizedState)||(Jo=!0),yt.memoizedState=en,yt.baseQueue===null&&(yt.baseState=en),Ft.lastRenderedState=en}return[en,Nt]}function Xm(){}function T0(vt,yt){var Ft=So,Nt=Wl(),Xt=yt(),en=!Wo(Nt.memoizedState,Xt);if(en&&(Nt.memoizedState=Xt,Jo=!0),Nt=Nt.queue,ju(w0.bind(null,Ft,Nt,vt),[vt]),Nt.getSnapshot!==yt||en||Uo!==null&&Uo.memoizedState.tag&1){if(Ft.flags|=2048,lp(9,M0.bind(null,Ft,Nt,Xt,yt),void 0,null),wo===null)throw Error(tt(349));ap&30||lm(Ft,yt,Xt)}return Xt}function lm(vt,yt,Ft){vt.flags|=16384,vt={getSnapshot:yt,value:Ft},yt=So.updateQueue,yt===null?(yt={lastEffect:null,stores:null},So.updateQueue=yt,yt.stores=[vt]):(Ft=yt.stores,Ft===null?yt.stores=[vt]:Ft.push(vt))}function M0(vt,yt,Ft,Nt){yt.value=Ft,yt.getSnapshot=Nt,I0(yt)&&$l(vt,1,-1)}function w0(vt,yt,Ft){return Ft(function(){I0(yt)&&$l(vt,1,-1)})}function I0(vt){var yt=vt.getSnapshot;vt=vt.value;try{var Ft=yt();return!Wo(vt,Ft)}catch{return!0}}function Fp(vt){var yt=vu();return typeof vt=="function"&&(vt=vt()),yt.memoizedState=yt.baseState=vt,vt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hu,lastRenderedState:vt},yt.queue=vt,vt=vt.dispatch=L0.bind(null,So,vt),[yt.memoizedState,vt]}function lp(vt,yt,Ft,Nt){return vt={tag:vt,create:yt,destroy:Ft,deps:Nt,next:null},yt=So.updateQueue,yt===null?(yt={lastEffect:null,stores:null},So.updateQueue=yt,yt.lastEffect=vt.next=vt):(Ft=yt.lastEffect,Ft===null?yt.lastEffect=vt.next=vt:(Nt=Ft.next,Ft.next=vt,vt.next=Nt,yt.lastEffect=vt)),vt}function cm(){return Wl().memoizedState}function Wu(vt,yt,Ft,Nt){var Xt=vu();So.flags|=vt,Xt.memoizedState=lp(1|yt,Ft,void 0,Nt===void 0?null:Nt)}function cp(vt,yt,Ft,Nt){var Xt=Wl();Nt=Nt===void 0?null:Nt;var en=void 0;if(Yo!==null){var zn=Yo.memoizedState;if(en=zn.destroy,Nt!==null&&$m(Nt,zn.deps)){Xt.memoizedState=lp(yt,Ft,en,Nt);return}}So.flags|=vt,Xt.memoizedState=lp(1|yt,Ft,en,Nt)}function Km(vt,yt){return Wu(8390656,8,vt,yt)}function ju(vt,yt){return cp(2048,8,vt,yt)}function Ym(vt,yt){return cp(4,2,vt,yt)}function um(vt,yt){return cp(4,4,vt,yt)}function B0(vt,yt){if(typeof yt=="function")return vt=vt(),yt(vt),function(){yt(null)};if(yt!=null)return vt=vt(),yt.current=vt,function(){yt.current=null}}function Bu(vt,yt,Ft){return Ft=Ft!=null?Ft.concat([vt]):null,cp(4,4,B0.bind(null,yt,vt),Ft)}function hm(){}function R0(vt,yt){var Ft=Wl();yt=yt===void 0?null:yt;var Nt=Ft.memoizedState;return Nt!==null&&yt!==null&&$m(yt,Nt[1])?Nt[0]:(Ft.memoizedState=[vt,yt],vt)}function qm(vt,yt){var Ft=Wl();yt=yt===void 0?null:yt;var Nt=Ft.memoizedState;return Nt!==null&&yt!==null&&$m(yt,Nt[1])?Nt[0]:(vt=vt(),Ft.memoizedState=[vt,yt],vt)}function F0(vt,yt){var Ft=Tr;Tr=Ft!==0&&4>Ft?Ft:4,vt(!0);var Nt=Ql.transition;Ql.transition={};try{vt(!1),yt()}finally{Tr=Ft,Ql.transition=Nt}}function Jm(){return Wl().memoizedState}function P0(vt,yt,Ft){var Nt=du(vt);Ft={lane:Nt,action:Ft,hasEagerState:!1,eagerState:null,next:null},Zm(vt)?k0(yt,Ft):(N0(vt,yt,Ft),Ft=Al(),vt=$l(vt,Nt,Ft),vt!==null&&D0(vt,yt,Nt))}function L0(vt,yt,Ft){var Nt=du(vt),Xt={lane:Nt,action:Ft,hasEagerState:!1,eagerState:null,next:null};if(Zm(vt))k0(yt,Xt);else{N0(vt,yt,Xt);var en=vt.alternate;if(vt.lanes===0&&(en===null||en.lanes===0)&&(en=yt.lastRenderedReducer,en!==null))try{var zn=yt.lastRenderedState,ir=en(zn,Ft);if(Xt.hasEagerState=!0,Xt.eagerState=ir,Wo(ir,zn))return}catch{}finally{}Ft=Al(),vt=$l(vt,Nt,Ft),vt!==null&&D0(vt,yt,Nt)}}function Zm(vt){var yt=vt.alternate;return vt===So||yt!==null&&yt===So}function k0(vt,yt){Bp=Dl=!0;var Ft=vt.pending;Ft===null?yt.next=yt:(yt.next=Ft.next,Ft.next=yt),vt.pending=yt}function N0(vt,yt,Ft){wo!==null&&vt.mode&1&&!(Ds&2)?(vt=yt.interleaved,vt===null?(Ft.next=Ft,su===null?su=[yt]:su.push(yt)):(Ft.next=vt.next,vt.next=Ft),yt.interleaved=Ft):(vt=yt.pending,vt===null?Ft.next=Ft:(Ft.next=vt.next,vt.next=Ft),yt.pending=Ft)}function D0(vt,yt,Ft){if(Ft&4194240){var Nt=yt.lanes;Nt&=vt.pendingLanes,Ft|=Nt,yt.lanes=Ft,Er(vt,Ft)}}var fu={readContext:Fl,useCallback:jo,useContext:jo,useEffect:jo,useImperativeHandle:jo,useInsertionEffect:jo,useLayoutEffect:jo,useMemo:jo,useReducer:jo,useRef:jo,useState:jo,useDebugValue:jo,useDeferredValue:jo,useTransition:jo,useMutableSource:jo,useSyncExternalStore:jo,useId:jo,unstable_isNewReconciler:!1},up={readContext:Fl,useCallback:function(vt,yt){return vu().memoizedState=[vt,yt===void 0?null:yt],vt},useContext:Fl,useEffect:Km,useImperativeHandle:function(vt,yt,Ft){return Ft=Ft!=null?Ft.concat([vt]):null,Wu(4194308,4,B0.bind(null,yt,vt),Ft)},useLayoutEffect:function(vt,yt){return Wu(4194308,4,vt,yt)},useInsertionEffect:function(vt,yt){return Wu(4,2,vt,yt)},useMemo:function(vt,yt){var Ft=vu();return yt=yt===void 0?null:yt,vt=vt(),Ft.memoizedState=[vt,yt],vt},useReducer:function(vt,yt,Ft){var Nt=vu();return yt=Ft!==void 0?Ft(yt):yt,Nt.memoizedState=Nt.baseState=yt,vt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vt,lastRenderedState:yt},Nt.queue=vt,vt=vt.dispatch=P0.bind(null,So,vt),[Nt.memoizedState,vt]},useRef:function(vt){var yt=vu();return vt={current:vt},yt.memoizedState=vt},useState:Fp,useDebugValue:hm,useDeferredValue:function(vt){var yt=Fp(vt),Ft=yt[0],Nt=yt[1];return Km(function(){var Xt=Ql.transition;Ql.transition={};try{Nt(vt)}finally{Ql.transition=Xt}},[vt]),Ft},useTransition:function(){var vt=Fp(!1),yt=vt[0];return vt=F0.bind(null,vt[1]),vu().memoizedState=vt,[yt,vt]},useMutableSource:function(){},useSyncExternalStore:function(vt,yt,Ft){var Nt=So,Xt=vu();if(uo){if(Ft===void 0)throw Error(tt(407));Ft=Ft()}else{if(Ft=yt(),wo===null)throw Error(tt(349));ap&30||lm(Nt,yt,Ft)}Xt.memoizedState=Ft;var en={value:Ft,getSnapshot:yt};return Xt.queue=en,Km(w0.bind(null,Nt,en,vt),[vt]),Nt.flags|=2048,lp(9,M0.bind(null,Nt,en,Ft,yt),void 0,null),Ft},useId:function(){var vt=vu(),yt=wo.identifierPrefix;if(uo){var Ft=au,Nt=ou;Ft=(Nt&~(1<<32-ro(Nt)-1)).toString(32)+Ft,yt=":"+yt+"R"+Ft,Ft=Rp++,0<Ft&&(yt+="H"+Ft.toString(32)),yt+=":"}else Ft=C0++,yt=":"+yt+"r"+Ft.toString(32)+":";return vt.memoizedState=yt},unstable_isNewReconciler:!1},f1={readContext:Fl,useCallback:R0,useContext:Fl,useEffect:ju,useImperativeHandle:Bu,useInsertionEffect:Ym,useLayoutEffect:um,useMemo:qm,useReducer:om,useRef:cm,useState:function(){return om(hu)},useDebugValue:hm,useDeferredValue:function(vt){var yt=om(hu),Ft=yt[0],Nt=yt[1];return ju(function(){var Xt=Ql.transition;Ql.transition={};try{Nt(vt)}finally{Ql.transition=Xt}},[vt]),Ft},useTransition:function(){var vt=om(hu)[0],yt=Wl().memoizedState;return[vt,yt]},useMutableSource:Xm,useSyncExternalStore:T0,useId:Jm,unstable_isNewReconciler:!1},d1={readContext:Fl,useCallback:R0,useContext:Fl,useEffect:ju,useImperativeHandle:Bu,useInsertionEffect:Ym,useLayoutEffect:um,useMemo:qm,useReducer:am,useRef:cm,useState:function(){return am(hu)},useDebugValue:hm,useDeferredValue:function(vt){var yt=am(hu),Ft=yt[0],Nt=yt[1];return ju(function(){var Xt=Ql.transition;Ql.transition={};try{Nt(vt)}finally{Ql.transition=Xt}},[vt]),Ft},useTransition:function(){var vt=am(hu)[0],yt=Wl().memoizedState;return[vt,yt]},useMutableSource:Xm,useSyncExternalStore:T0,useId:Jm,unstable_isNewReconciler:!1};function e0(vt,yt){try{var Ft="",Nt=yt;do Ft+=h1(Nt),Nt=Nt.return;while(Nt);var Xt=Ft}catch(en){Xt=`
Error generating stack: `+en.message+`
`+en.stack}return{value:vt,source:yt,stack:Xt}}function t0(vt,yt){try{console.error(yt.value)}catch(Ft){setTimeout(function(){throw Ft})}}var fm=typeof WeakMap=="function"?WeakMap:Map;function dm(vt,yt,Ft){Ft=_c(-1,Ft),Ft.tag=3,Ft.payload={element:null};var Nt=yt.value;return Ft.callback=function(){Rm||(Rm=!0,h0=Nt),t0(vt,yt)},Ft}function O0(vt,yt,Ft){Ft=_c(-1,Ft),Ft.tag=3;var Nt=vt.type.getDerivedStateFromError;if(typeof Nt=="function"){var Xt=yt.value;Ft.payload=function(){return Nt(Xt)},Ft.callback=function(){t0(vt,yt)}}var en=vt.stateNode;return en!==null&&typeof en.componentDidCatch=="function"&&(Ft.callback=function(){t0(vt,yt),typeof Nt!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var zn=yt.stack;this.componentDidCatch(yt.value,{componentStack:zn!==null?zn:""})}),Ft}function U0(vt,yt,Ft){var Nt=vt.pingCache;if(Nt===null){Nt=vt.pingCache=new fm;var Xt=new Set;Nt.set(yt,Xt)}else Xt=Nt.get(yt),Xt===void 0&&(Xt=new Set,Nt.set(yt,Xt));Xt.has(Ft)||(Xt.add(Ft),vt=Zs.bind(null,vt,yt,Ft),yt.then(vt,vt))}function G0(vt){do{var yt;if((yt=vt.tag===13)&&(yt=vt.memoizedState,yt=yt!==null?yt.dehydrated!==null:!0),yt)return vt;vt=vt.return}while(vt!==null);return null}function n0(vt,yt,Ft,Nt,Xt){return vt.mode&1?(vt.flags|=65536,vt.lanes=Xt,vt):(vt===yt?vt.flags|=65536:(vt.flags|=128,Ft.flags|=131072,Ft.flags&=-52805,Ft.tag===1&&(Ft.alternate===null?Ft.tag=17:(yt=_c(-1,1),yt.tag=2,eu(Ft,yt))),Ft.lanes|=1),vt)}function Ol(vt){vt.flags|=4}function V0(vt,yt){if(vt!==null&&vt.child===yt.child)return!0;if(yt.flags&16)return!1;for(vt=yt.child;vt!==null;){if(vt.flags&12854||vt.subtreeFlags&12854)return!1;vt=vt.sibling}return!0}var Pp,Lp,pm,mm;if(Dn)Pp=function(vt,yt){for(var Ft=yt.child;Ft!==null;){if(Ft.tag===5||Ft.tag===6)Zt(vt,Ft.stateNode);else if(Ft.tag!==4&&Ft.child!==null){Ft.child.return=Ft,Ft=Ft.child;continue}if(Ft===yt)break;for(;Ft.sibling===null;){if(Ft.return===null||Ft.return===yt)return;Ft=Ft.return}Ft.sibling.return=Ft.return,Ft=Ft.sibling}},Lp=function(){},pm=function(vt,yt,Ft,Nt,Xt){if(vt=vt.memoizedProps,vt!==Nt){var en=yt.stateNode,zn=Ll(Po.current);Ft=Ot(en,Ft,vt,Nt,Xt,zn),(yt.updateQueue=Ft)&&Ol(yt)}},mm=function(vt,yt,Ft,Nt){Ft!==Nt&&Ol(yt)};else if(ln){Pp=function(vt,yt,Ft,Nt){for(var Xt=yt.child;Xt!==null;){if(Xt.tag===5){var en=Xt.stateNode;Ft&&Nt&&(en=Ir(en,Xt.type,Xt.memoizedProps,Xt)),Zt(vt,en)}else if(Xt.tag===6)en=Xt.stateNode,Ft&&Nt&&(en=Fr(en,Xt.memoizedProps,Xt)),Zt(vt,en);else if(Xt.tag!==4){if(Xt.tag===22&&Xt.memoizedState!==null)en=Xt.child,en!==null&&(en.return=Xt),Pp(vt,Xt,!0,!0);else if(Xt.child!==null){Xt.child.return=Xt,Xt=Xt.child;continue}}if(Xt===yt)break;for(;Xt.sibling===null;){if(Xt.return===null||Xt.return===yt)return;Xt=Xt.return}Xt.sibling.return=Xt.return,Xt=Xt.sibling}};var z0=function(vt,yt,Ft,Nt){for(var Xt=yt.child;Xt!==null;){if(Xt.tag===5){var en=Xt.stateNode;Ft&&Nt&&(en=Ir(en,Xt.type,Xt.memoizedProps,Xt)),es(vt,en)}else if(Xt.tag===6)en=Xt.stateNode,Ft&&Nt&&(en=Fr(en,Xt.memoizedProps,Xt)),es(vt,en);else if(Xt.tag!==4){if(Xt.tag===22&&Xt.memoizedState!==null)en=Xt.child,en!==null&&(en.return=Xt),z0(vt,Xt,!0,!0);else if(Xt.child!==null){Xt.child.return=Xt,Xt=Xt.child;continue}}if(Xt===yt)break;for(;Xt.sibling===null;){if(Xt.return===null||Xt.return===yt)return;Xt=Xt.return}Xt.sibling.return=Xt.return,Xt=Xt.sibling}};Lp=function(vt,yt){var Ft=yt.stateNode;if(!V0(vt,yt)){vt=Ft.containerInfo;var Nt=$r(vt);z0(Nt,yt,!1,!1),Ft.pendingChildren=Nt,Ol(yt),Hr(vt,Nt)}},pm=function(vt,yt,Ft,Nt,Xt){var en=vt.stateNode,zn=vt.memoizedProps;if((vt=V0(vt,yt))&&zn===Nt)yt.stateNode=en;else{var ir=yt.stateNode,yr=Ll(Po.current),Nr=null;zn!==Nt&&(Nr=Ot(ir,Ft,zn,Nt,Xt,yr)),vt&&Nr===null?yt.stateNode=en:(en=_r(en,Nr,Ft,zn,Nt,yt,vt,ir),cn(en,Ft,Nt,Xt,yr)&&Ol(yt),yt.stateNode=en,vt?Ol(yt):Pp(en,yt,!1,!1))}},mm=function(vt,yt,Ft,Nt){Ft!==Nt?(vt=Ll(Hu.current),Ft=Ll(Po.current),yt.stateNode=fn(Nt,vt,Ft,yt),Ol(yt)):yt.stateNode=vt.stateNode}}else Lp=function(){},pm=function(){},mm=function(){};function kp(vt,yt){if(!uo)switch(vt.tailMode){case"hidden":yt=vt.tail;for(var Ft=null;yt!==null;)yt.alternate!==null&&(Ft=yt),yt=yt.sibling;Ft===null?vt.tail=null:Ft.sibling=null;break;case"collapsed":Ft=vt.tail;for(var Nt=null;Ft!==null;)Ft.alternate!==null&&(Nt=Ft),Ft=Ft.sibling;Nt===null?yt||vt.tail===null?vt.tail=null:vt.tail.sibling=null:Nt.sibling=null}}function qo(vt){var yt=vt.alternate!==null&&vt.alternate.child===vt.child,Ft=0,Nt=0;if(yt)for(var Xt=vt.child;Xt!==null;)Ft|=Xt.lanes|Xt.childLanes,Nt|=Xt.subtreeFlags&14680064,Nt|=Xt.flags&14680064,Xt.return=vt,Xt=Xt.sibling;else for(Xt=vt.child;Xt!==null;)Ft|=Xt.lanes|Xt.childLanes,Nt|=Xt.subtreeFlags,Nt|=Xt.flags,Xt.return=vt,Xt=Xt.sibling;return vt.subtreeFlags|=Nt,vt.childLanes=Ft,yt}function p1(vt,yt,Ft){var Nt=yt.pendingProps;switch(tm(yt),yt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(yt),null;case 1:return Ys(yt.type)&&co(),qo(yt),null;case 3:return Nt=yt.stateNode,Qu(),As(Ss),As(Us),jm(),Nt.pendingContext&&(Nt.context=Nt.pendingContext,Nt.pendingContext=null),(vt===null||vt.child===null)&&(Vu(yt)?Ol(yt):vt===null||vt.memoizedState.isDehydrated&&!(yt.flags&256)||(yt.flags|=1024,Vl!==null&&(pt(Vl),Vl=null))),Lp(vt,yt),qo(yt),null;case 5:Nl(yt),Ft=Ll(Hu.current);var Xt=yt.type;if(vt!==null&&yt.stateNode!=null)pm(vt,yt,Xt,Nt,Ft),vt.ref!==yt.ref&&(yt.flags|=512,yt.flags|=2097152);else{if(!Nt){if(yt.stateNode===null)throw Error(tt(166));return qo(yt),null}if(vt=Ll(Po.current),Vu(yt)){if(!Cn)throw Error(tt(175));vt=pn(yt.stateNode,yt.type,yt.memoizedProps,Ft,vt,yt,!lu),yt.updateQueue=vt,vt!==null&&Ol(yt)}else{var en=mn(Xt,Nt,Ft,vt,yt);Pp(en,yt,!1,!1),yt.stateNode=en,cn(en,Xt,Nt,Ft,vt)&&Ol(yt)}yt.ref!==null&&(yt.flags|=512,yt.flags|=2097152)}return qo(yt),null;case 6:if(vt&&yt.stateNode!=null)mm(vt,yt,vt.memoizedProps,Nt);else{if(typeof Nt!="string"&&yt.stateNode===null)throw Error(tt(166));if(vt=Ll(Hu.current),Ft=Ll(Po.current),Vu(yt)){if(!Cn)throw Error(tt(176));if(vt=yt.stateNode,Nt=yt.memoizedProps,(Ft=Kt(vt,Nt,yt,!lu))&&(Xt=Oo,Xt!==null))switch(en=(Xt.mode&1)!==0,Xt.tag){case 3:ar(Xt.stateNode.containerInfo,vt,Nt,en);break;case 5:cr(Xt.type,Xt.memoizedProps,Xt.stateNode,vt,Nt,en)}Ft&&Ol(yt)}else yt.stateNode=fn(Nt,vt,Ft,yt)}return qo(yt),null;case 13:if(As(Ao),Nt=yt.memoizedState,uo&&Fo!==null&&yt.mode&1&&!(yt.flags&128)){for(vt=Fo;vt;)vt=Ks(vt);return zu(),yt.flags|=98560,yt}if(Nt!==null&&Nt.dehydrated!==null){if(Nt=Vu(yt),vt===null){if(!Nt)throw Error(tt(318));if(!Cn)throw Error(tt(344));if(vt=yt.memoizedState,vt=vt!==null?vt.dehydrated:null,!vt)throw Error(tt(317));Gt(vt,yt)}else zu(),!(yt.flags&128)&&(yt.memoizedState=null),yt.flags|=4;return qo(yt),null}return Vl!==null&&(pt(Vl),Vl=null),yt.flags&128?(yt.lanes=Ft,yt):(Nt=Nt!==null,Ft=!1,vt===null?Vu(yt):Ft=vt.memoizedState!==null,Nt&&!Ft&&(yt.child.flags|=8192,yt.mode&1&&(vt===null||Ao.current&1?ko===0&&(ko=3):jn())),yt.updateQueue!==null&&(yt.flags|=4),qo(yt),null);case 4:return Qu(),Lp(vt,yt),vt===null&&kn(yt.stateNode.containerInfo),qo(yt),null;case 10:return Vm(yt.type._context),qo(yt),null;case 17:return Ys(yt.type)&&co(),qo(yt),null;case 19:if(As(Ao),Xt=yt.memoizedState,Xt===null)return qo(yt),null;if(Nt=(yt.flags&128)!==0,en=Xt.rendering,en===null)if(Nt)kp(Xt,!1);else{if(ko!==0||vt!==null&&vt.flags&128)for(vt=yt.child;vt!==null;){if(en=Ip(vt),en!==null){for(yt.flags|=128,kp(Xt,!1),vt=en.updateQueue,vt!==null&&(yt.updateQueue=vt,yt.flags|=4),yt.subtreeFlags=0,vt=Ft,Nt=yt.child;Nt!==null;)Ft=Nt,Xt=vt,Ft.flags&=14680066,en=Ft.alternate,en===null?(Ft.childLanes=0,Ft.lanes=Xt,Ft.child=null,Ft.subtreeFlags=0,Ft.memoizedProps=null,Ft.memoizedState=null,Ft.updateQueue=null,Ft.dependencies=null,Ft.stateNode=null):(Ft.childLanes=en.childLanes,Ft.lanes=en.lanes,Ft.child=en.child,Ft.subtreeFlags=0,Ft.deletions=null,Ft.memoizedProps=en.memoizedProps,Ft.memoizedState=en.memoizedState,Ft.updateQueue=en.updateQueue,Ft.type=en.type,Xt=en.dependencies,Ft.dependencies=Xt===null?null:{lanes:Xt.lanes,firstContext:Xt.firstContext}),Nt=Nt.sibling;return ts(Ao,Ao.current&1|2),yt.child}vt=vt.sibling}Xt.tail!==null&&Vr()>Hp&&(yt.flags|=128,Nt=!0,kp(Xt,!1),yt.lanes=4194304)}else{if(!Nt)if(vt=Ip(en),vt!==null){if(yt.flags|=128,Nt=!0,vt=vt.updateQueue,vt!==null&&(yt.updateQueue=vt,yt.flags|=4),kp(Xt,!0),Xt.tail===null&&Xt.tailMode==="hidden"&&!en.alternate&&!uo)return qo(yt),null}else 2*Vr()-Xt.renderingStartTime>Hp&&Ft!==1073741824&&(yt.flags|=128,Nt=!0,kp(Xt,!1),yt.lanes=4194304);Xt.isBackwards?(en.sibling=yt.child,yt.child=en):(vt=Xt.last,vt!==null?vt.sibling=en:yt.child=en,Xt.last=en)}return Xt.tail!==null?(yt=Xt.tail,Xt.rendering=yt,Xt.tail=yt.sibling,Xt.renderingStartTime=Vr(),yt.sibling=null,vt=Ao.current,ts(Ao,Nt?vt&1|2:vt&1),yt):(qo(yt),null);case 22:case 23:return kt(),Nt=yt.memoizedState!==null,vt!==null&&vt.memoizedState!==null!==Nt&&(yt.flags|=8192),Nt&&yt.mode&1?Ul&1073741824&&(qo(yt),Dn&&yt.subtreeFlags&6&&(yt.flags|=8192)):qo(yt),null;case 24:return null;case 25:return null}throw Error(tt(156,yt.tag))}var m1=nt.ReactCurrentOwner,Jo=!1;function xa(vt,yt,Ft,Nt){yt.child=vt===null?Mp(yt,null,Ft,Nt):uu(yt,vt.child,Ft,Nt)}function gm(vt,yt,Ft,Nt,Xt){Ft=Ft.render;var en=yt.ref;return tp(yt,Xt),Nt=im(vt,yt,Ft,Nt,en,Xt),Ft=sm(),vt!==null&&!Jo?(yt.updateQueue=vt.updateQueue,yt.flags&=-2053,vt.lanes&=~Xt,Lo(vt,yt,Xt)):(uo&&Ft&&tu(yt),yt.flags|=1,xa(vt,yt,Nt,Xt),yt.child)}function H0(vt,yt,Ft,Nt,Xt){if(vt===null){var en=Ft.type;return typeof en=="function"&&!Tl(en)&&en.defaultProps===void 0&&Ft.compare===null&&Ft.defaultProps===void 0?(yt.tag=15,yt.type=en,Q0(vt,yt,en,Nt,Xt)):(vt=go(Ft.type,null,Nt,yt,yt.mode,Xt),vt.ref=yt.ref,vt.return=yt,yt.child=vt)}if(en=vt.child,!(vt.lanes&Xt)){var zn=en.memoizedProps;if(Ft=Ft.compare,Ft=Ft!==null?Ft:Ep,Ft(zn,Nt)&&vt.ref===yt.ref)return Lo(vt,yt,Xt)}return yt.flags|=1,vt=oo(en,Nt),vt.ref=yt.ref,vt.return=yt,yt.child=vt}function Q0(vt,yt,Ft,Nt,Xt){if(vt!==null&&Ep(vt.memoizedProps,Nt)&&vt.ref===yt.ref)if(Jo=!1,(vt.lanes&Xt)!==0)vt.flags&131072&&(Jo=!0);else return yt.lanes=vt.lanes,Lo(vt,yt,Xt);return r0(vt,yt,Ft,Nt,Xt)}function W0(vt,yt,Ft){var Nt=yt.pendingProps,Xt=Nt.children,en=vt!==null?vt.memoizedState:null;if(Nt.mode==="hidden")if(!(yt.mode&1))yt.memoizedState={baseLanes:0,cachePool:null},ts(fp,Ul),Ul|=Ft;else if(Ft&1073741824)yt.memoizedState={baseLanes:0,cachePool:null},Nt=en!==null?en.baseLanes:Ft,ts(fp,Ul),Ul|=Nt;else return vt=en!==null?en.baseLanes|Ft:Ft,yt.lanes=yt.childLanes=1073741824,yt.memoizedState={baseLanes:vt,cachePool:null},yt.updateQueue=null,ts(fp,Ul),Ul|=vt,null;else en!==null?(Nt=en.baseLanes|Ft,yt.memoizedState=null):Nt=Ft,ts(fp,Ul),Ul|=Nt;return xa(vt,yt,Xt,Ft),yt.child}function j0(vt,yt){var Ft=yt.ref;(vt===null&&Ft!==null||vt!==null&&vt.ref!==Ft)&&(yt.flags|=512,yt.flags|=2097152)}function r0(vt,yt,Ft,Nt,Xt){var en=Ys(Ft)?$s:Us.current;return en=Hs(yt,en),tp(yt,Xt),Ft=im(vt,yt,Ft,Nt,en,Xt),Nt=sm(),vt!==null&&!Jo?(yt.updateQueue=vt.updateQueue,yt.flags&=-2053,vt.lanes&=~Xt,Lo(vt,yt,Xt)):(uo&&Nt&&tu(yt),yt.flags|=1,xa(vt,yt,Ft,Xt),yt.child)}function $0(vt,yt,Ft,Nt,Xt){if(Ys(Ft)){var en=!0;Ns(yt)}else en=!1;if(tp(yt,Xt),yt.stateNode===null)vt!==null&&(vt.alternate=null,yt.alternate=null,yt.flags|=2),np(yt,Ft,Nt),ga(yt,Ft,Nt,Xt),Nt=!0;else if(vt===null){var zn=yt.stateNode,ir=yt.memoizedProps;zn.props=ir;var yr=zn.context,Nr=Ft.contextType;typeof Nr=="object"&&Nr!==null?Nr=Fl(Nr):(Nr=Ys(Ft)?$s:Us.current,Nr=Hs(yt,Nr));var os=Ft.getDerivedStateFromProps,Ls=typeof os=="function"||typeof zn.getSnapshotBeforeUpdate=="function";Ls||typeof zn.UNSAFE_componentWillReceiveProps!="function"&&typeof zn.componentWillReceiveProps!="function"||(ir!==Nt||yr!==Nr)&&rp(yt,zn,Nt,Nr),Tu=!1;var _s=yt.memoizedState;zn.state=_s,em(yt,Nt,zn,Xt),yr=yt.memoizedState,ir!==Nt||_s!==yr||Ss.current||Tu?(typeof os=="function"&&(bp(yt,Ft,os,Nt),yr=yt.memoizedState),(ir=Tu||Hm(yt,Ft,ir,Nt,_s,yr,Nr))?(Ls||typeof zn.UNSAFE_componentWillMount!="function"&&typeof zn.componentWillMount!="function"||(typeof zn.componentWillMount=="function"&&zn.componentWillMount(),typeof zn.UNSAFE_componentWillMount=="function"&&zn.UNSAFE_componentWillMount()),typeof zn.componentDidMount=="function"&&(yt.flags|=4194308)):(typeof zn.componentDidMount=="function"&&(yt.flags|=4194308),yt.memoizedProps=Nt,yt.memoizedState=yr),zn.props=Nt,zn.state=yr,zn.context=Nr,Nt=ir):(typeof zn.componentDidMount=="function"&&(yt.flags|=4194308),Nt=!1)}else{zn=yt.stateNode,zm(vt,yt),ir=yt.memoizedProps,Nr=yt.type===yt.elementType?ir:Zl(yt.type,ir),zn.props=Nr,Ls=yt.pendingProps,_s=zn.context,yr=Ft.contextType,typeof yr=="object"&&yr!==null?yr=Fl(yr):(yr=Ys(Ft)?$s:Us.current,yr=Hs(yt,yr));var mo=Ft.getDerivedStateFromProps;(os=typeof mo=="function"||typeof zn.getSnapshotBeforeUpdate=="function")||typeof zn.UNSAFE_componentWillReceiveProps!="function"&&typeof zn.componentWillReceiveProps!="function"||(ir!==Ls||_s!==yr)&&rp(yt,zn,Nt,yr),Tu=!1,_s=yt.memoizedState,zn.state=_s,em(yt,Nt,zn,Xt);var Br=yt.memoizedState;ir!==Ls||_s!==Br||Ss.current||Tu?(typeof mo=="function"&&(bp(yt,Ft,mo,Nt),Br=yt.memoizedState),(Nr=Tu||Hm(yt,Ft,Nr,Nt,_s,Br,yr)||!1)?(os||typeof zn.UNSAFE_componentWillUpdate!="function"&&typeof zn.componentWillUpdate!="function"||(typeof zn.componentWillUpdate=="function"&&zn.componentWillUpdate(Nt,Br,yr),typeof zn.UNSAFE_componentWillUpdate=="function"&&zn.UNSAFE_componentWillUpdate(Nt,Br,yr)),typeof zn.componentDidUpdate=="function"&&(yt.flags|=4),typeof zn.getSnapshotBeforeUpdate=="function"&&(yt.flags|=1024)):(typeof zn.componentDidUpdate!="function"||ir===vt.memoizedProps&&_s===vt.memoizedState||(yt.flags|=4),typeof zn.getSnapshotBeforeUpdate!="function"||ir===vt.memoizedProps&&_s===vt.memoizedState||(yt.flags|=1024),yt.memoizedProps=Nt,yt.memoizedState=Br),zn.props=Nt,zn.state=Br,zn.context=yr,Nt=Nr):(typeof zn.componentDidUpdate!="function"||ir===vt.memoizedProps&&_s===vt.memoizedState||(yt.flags|=4),typeof zn.getSnapshotBeforeUpdate!="function"||ir===vt.memoizedProps&&_s===vt.memoizedState||(yt.flags|=1024),Nt=!1)}return Am(vt,yt,Ft,Nt,en,Xt)}function Am(vt,yt,Ft,Nt,Xt,en){j0(vt,yt);var zn=(yt.flags&128)!==0;if(!Nt&&!zn)return Xt&&Gs(yt,Ft,!1),Lo(vt,yt,en);Nt=yt.stateNode,m1.current=yt;var ir=zn&&typeof Ft.getDerivedStateFromError!="function"?null:Nt.render();return yt.flags|=1,vt!==null&&zn?(yt.child=uu(yt,vt.child,null,en),yt.child=uu(yt,null,ir,en)):xa(vt,yt,ir,en),yt.memoizedState=Nt.state,Xt&&Gs(yt,Ft,!0),yt.child}function X0(vt){var yt=vt.stateNode;yt.pendingContext?Cs(vt,yt.pendingContext,yt.pendingContext!==yt.context):yt.context&&Cs(vt,yt.context,!1),wp(vt,yt.containerInfo)}function K0(vt,yt,Ft,Nt,Xt){return zu(),zl(Xt),yt.flags|=256,xa(vt,yt,Ft,Nt),yt.child}var vm={dehydrated:null,treeContext:null,retryLane:0};function ym(vt){return{baseLanes:vt,cachePool:null}}function Y0(vt,yt,Ft){var Nt=yt.pendingProps,Xt=Ao.current,en=!1,zn=(yt.flags&128)!==0,ir;if((ir=zn)||(ir=vt!==null&&vt.memoizedState===null?!1:(Xt&2)!==0),ir?(en=!0,yt.flags&=-129):(vt===null||vt.memoizedState!==null)&&(Xt|=1),ts(Ao,Xt&1),vt===null)return nu(yt),vt=yt.memoizedState,vt!==null&&(vt=vt.dehydrated,vt!==null)?(yt.mode&1?Js(vt)?yt.lanes=8:yt.lanes=1073741824:yt.lanes=1,null):(Xt=Nt.children,vt=Nt.fallback,en?(Nt=yt.mode,en=yt.child,Xt={mode:"hidden",children:Xt},!(Nt&1)&&en!==null?(en.childLanes=0,en.pendingProps=Xt):en=Qs(Xt,Nt,0,null),vt=no(vt,Nt,Ft,null),en.return=yt,vt.return=yt,en.sibling=vt,yt.child=en,yt.child.memoizedState=ym(Ft),yt.memoizedState=vm,vt):_m(yt,Xt));if(Xt=vt.memoizedState,Xt!==null){if(ir=Xt.dehydrated,ir!==null){if(zn)return yt.flags&256?(yt.flags&=-257,ns(vt,yt,Ft,Error(tt(422)))):yt.memoizedState!==null?(yt.child=vt.child,yt.flags|=128,null):(en=Nt.fallback,Xt=yt.mode,Nt=Qs({mode:"visible",children:Nt.children},Xt,0,null),en=no(en,Xt,Ft,null),en.flags|=2,Nt.return=yt,en.return=yt,Nt.sibling=en,yt.child=Nt,yt.mode&1&&uu(yt,vt.child,null,Ft),yt.child.memoizedState=ym(Ft),yt.memoizedState=vm,en);if(!(yt.mode&1))yt=ns(vt,yt,Ft,null);else if(Js(ir))yt=ns(vt,yt,Ft,Error(tt(419)));else if(Nt=(Ft&vt.childLanes)!==0,Jo||Nt){if(Nt=wo,Nt!==null){switch(Ft&-Ft){case 4:en=2;break;case 16:en=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:en=32;break;case 536870912:en=268435456;break;default:en=0}Nt=en&(Nt.suspendedLanes|Ft)?0:en,Nt!==0&&Nt!==Xt.retryLane&&(Xt.retryLane=Nt,$l(vt,Nt,-1))}jn(),yt=ns(vt,yt,Ft,Error(tt(421)))}else Ws(ir)?(yt.flags|=128,yt.child=vt.child,yt=fo.bind(null,vt),ao(ir,yt),yt=null):(Ft=Xt.treeContext,Cn&&(Fo=js(ir),Oo=yt,uo=!0,Vl=null,lu=!1,Ft!==null&&(Ko[xl++]=ou,Ko[xl++]=au,Ko[xl++]=Uu,ou=Ft.id,au=Ft.overflow,Uu=yt)),yt=_m(yt,yt.pendingProps.children),yt.flags|=4096);return yt}return en?(Nt=_u(vt,yt,Nt.children,Nt.fallback,Ft),en=yt.child,Xt=vt.child.memoizedState,en.memoizedState=Xt===null?ym(Ft):{baseLanes:Xt.baseLanes|Ft,cachePool:null},en.childLanes=vt.childLanes&~Ft,yt.memoizedState=vm,Nt):(Ft=yu(vt,yt,Nt.children,Ft),yt.memoizedState=null,Ft)}return en?(Nt=_u(vt,yt,Nt.children,Nt.fallback,Ft),en=yt.child,Xt=vt.child.memoizedState,en.memoizedState=Xt===null?ym(Ft):{baseLanes:Xt.baseLanes|Ft,cachePool:null},en.childLanes=vt.childLanes&~Ft,yt.memoizedState=vm,Nt):(Ft=yu(vt,yt,Nt.children,Ft),yt.memoizedState=null,Ft)}function _m(vt,yt){return yt=Qs({mode:"visible",children:yt},vt.mode,0,null),yt.return=vt,vt.child=yt}function yu(vt,yt,Ft,Nt){var Xt=vt.child;return vt=Xt.sibling,Ft=oo(Xt,{mode:"visible",children:Ft}),!(yt.mode&1)&&(Ft.lanes=Nt),Ft.return=yt,Ft.sibling=null,vt!==null&&(Nt=yt.deletions,Nt===null?(yt.deletions=[vt],yt.flags|=16):Nt.push(vt)),yt.child=Ft}function _u(vt,yt,Ft,Nt,Xt){var en=yt.mode;vt=vt.child;var zn=vt.sibling,ir={mode:"hidden",children:Ft};return!(en&1)&&yt.child!==vt?(Ft=yt.child,Ft.childLanes=0,Ft.pendingProps=ir,yt.deletions=null):(Ft=oo(vt,ir),Ft.subtreeFlags=vt.subtreeFlags&14680064),zn!==null?Nt=oo(zn,Nt):(Nt=no(Nt,en,Xt,null),Nt.flags|=2),Nt.return=yt,Ft.return=yt,Ft.sibling=Nt,yt.child=Ft,Nt}function ns(vt,yt,Ft,Nt){return Nt!==null&&zl(Nt),uu(yt,vt.child,null,Ft),vt=_m(yt,yt.pendingProps.children),vt.flags|=2,yt.memoizedState=null,vt}function $u(vt,yt,Ft){vt.lanes|=yt;var Nt=vt.alternate;Nt!==null&&(Nt.lanes|=yt),Mo(vt.return,yt,Ft)}function hp(vt,yt,Ft,Nt,Xt){var en=vt.memoizedState;en===null?vt.memoizedState={isBackwards:yt,rendering:null,renderingStartTime:0,last:Nt,tail:Ft,tailMode:Xt}:(en.isBackwards=yt,en.rendering=null,en.renderingStartTime=0,en.last=Nt,en.tail=Ft,en.tailMode=Xt)}function q0(vt,yt,Ft){var Nt=yt.pendingProps,Xt=Nt.revealOrder,en=Nt.tail;if(xa(vt,yt,Nt.children,Ft),Nt=Ao.current,Nt&2)Nt=Nt&1|2,yt.flags|=128;else{if(vt!==null&&vt.flags&128)e:for(vt=yt.child;vt!==null;){if(vt.tag===13)vt.memoizedState!==null&&$u(vt,Ft,yt);else if(vt.tag===19)$u(vt,Ft,yt);else if(vt.child!==null){vt.child.return=vt,vt=vt.child;continue}if(vt===yt)break e;for(;vt.sibling===null;){if(vt.return===null||vt.return===yt)break e;vt=vt.return}vt.sibling.return=vt.return,vt=vt.sibling}Nt&=1}if(ts(Ao,Nt),!(yt.mode&1))yt.memoizedState=null;else switch(Xt){case"forwards":for(Ft=yt.child,Xt=null;Ft!==null;)vt=Ft.alternate,vt!==null&&Ip(vt)===null&&(Xt=Ft),Ft=Ft.sibling;Ft=Xt,Ft===null?(Xt=yt.child,yt.child=null):(Xt=Ft.sibling,Ft.sibling=null),hp(yt,!1,Xt,Ft,en);break;case"backwards":for(Ft=null,Xt=yt.child,yt.child=null;Xt!==null;){if(vt=Xt.alternate,vt!==null&&Ip(vt)===null){yt.child=Xt;break}vt=Xt.sibling,Xt.sibling=Ft,Ft=Xt,Xt=vt}hp(yt,!0,Ft,null,en);break;case"together":hp(yt,!1,null,null,void 0);break;default:yt.memoizedState=null}return yt.child}function Lo(vt,yt,Ft){if(vt!==null&&(yt.dependencies=vt.dependencies),dp|=yt.lanes,!(Ft&yt.childLanes))return null;if(vt!==null&&yt.child!==vt.child)throw Error(tt(153));if(yt.child!==null){for(vt=yt.child,Ft=oo(vt,vt.pendingProps),yt.child=Ft,Ft.return=yt;vt.sibling!==null;)vt=vt.sibling,Ft=Ft.sibling=oo(vt,vt.pendingProps),Ft.return=yt;Ft.sibling=null}return yt.child}function xm(vt,yt,Ft){switch(yt.tag){case 3:X0(yt),zu();break;case 5:op(yt);break;case 1:Ys(yt.type)&&Ns(yt);break;case 4:wp(yt,yt.stateNode.containerInfo);break;case 10:Nu(yt,yt.type._context,yt.memoizedProps.value);break;case 13:var Nt=yt.memoizedState;if(Nt!==null)return Nt.dehydrated!==null?(ts(Ao,Ao.current&1),yt.flags|=128,null):Ft&yt.child.childLanes?Y0(vt,yt,Ft):(ts(Ao,Ao.current&1),vt=Lo(vt,yt,Ft),vt!==null?vt.sibling:null);ts(Ao,Ao.current&1);break;case 19:if(Nt=(Ft&yt.childLanes)!==0,vt.flags&128){if(Nt)return q0(vt,yt,Ft);yt.flags|=128}var Xt=yt.memoizedState;if(Xt!==null&&(Xt.rendering=null,Xt.tail=null,Xt.lastEffect=null),ts(Ao,Ao.current),Nt)break;return null;case 22:case 23:return yt.lanes=0,W0(vt,yt,Ft)}return Lo(vt,yt,Ft)}function g1(vt,yt){switch(tm(yt),yt.tag){case 1:return Ys(yt.type)&&co(),vt=yt.flags,vt&65536?(yt.flags=vt&-65537|128,yt):null;case 3:return Qu(),As(Ss),As(Us),jm(),vt=yt.flags,vt&65536&&!(vt&128)?(yt.flags=vt&-65537|128,yt):null;case 5:return Nl(yt),null;case 13:if(As(Ao),vt=yt.memoizedState,vt!==null&&vt.dehydrated!==null){if(yt.alternate===null)throw Error(tt(340));zu()}return vt=yt.flags,vt&65536?(yt.flags=vt&-65537|128,yt):null;case 19:return As(Ao),null;case 4:return Qu(),null;case 10:return Vm(yt.type._context),null;case 22:case 23:return kt(),null;case 24:return null;default:return null}}var ho=!1,ba=!1,J0=typeof WeakSet=="function"?WeakSet:Set,zr=null;function Xu(vt,yt){var Ft=vt.ref;if(Ft!==null)if(typeof Ft=="function")try{Ft(null)}catch(Nt){kr(vt,yt,Nt)}else Ft.current=null}function i0(vt,yt,Ft){try{Ft()}catch(Nt){kr(vt,yt,Nt)}}var $a=!1;function Ku(vt,yt){for(Qt(vt.containerInfo),zr=yt;zr!==null;)if(vt=zr,yt=vt.child,(vt.subtreeFlags&1028)!==0&&yt!==null)yt.return=vt,zr=yt;else for(;zr!==null;){vt=zr;try{var Ft=vt.alternate;if(vt.flags&1024)switch(vt.tag){case 0:case 11:case 15:break;case 1:if(Ft!==null){var Nt=Ft.memoizedProps,Xt=Ft.memoizedState,en=vt.stateNode,zn=en.getSnapshotBeforeUpdate(vt.elementType===vt.type?Nt:Zl(vt.type,Nt),Xt);en.__reactInternalSnapshotBeforeUpdate=zn}break;case 3:Dn&&vr(vt.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(ir){kr(vt,vt.return,ir)}if(yt=vt.sibling,yt!==null){yt.return=vt.return,zr=yt;break}zr=vt.return}return Ft=$a,$a=!1,Ft}function ru(vt,yt,Ft){var Nt=yt.updateQueue;if(Nt=Nt!==null?Nt.lastEffect:null,Nt!==null){var Xt=Nt=Nt.next;do{if((Xt.tag&vt)===vt){var en=Xt.destroy;Xt.destroy=void 0,en!==void 0&&i0(yt,Ft,en)}Xt=Xt.next}while(Xt!==Nt)}}function Np(vt,yt){if(yt=yt.updateQueue,yt=yt!==null?yt.lastEffect:null,yt!==null){var Ft=yt=yt.next;do{if((Ft.tag&vt)===vt){var Nt=Ft.create;Ft.destroy=Nt()}Ft=Ft.next}while(Ft!==yt)}}function Em(vt){var yt=vt.ref;if(yt!==null){var Ft=vt.stateNode;switch(vt.tag){case 5:vt=jt(Ft);break;default:vt=Ft}typeof yt=="function"?yt(vt):yt.current=vt}}function Sm(vt,yt,Ft){if(Ms&&typeof Ms.onCommitFiberUnmount=="function")try{Ms.onCommitFiberUnmount(Vs,yt)}catch{}switch(yt.tag){case 0:case 11:case 14:case 15:if(vt=yt.updateQueue,vt!==null&&(vt=vt.lastEffect,vt!==null)){var Nt=vt=vt.next;do{var Xt=Nt,en=Xt.destroy;Xt=Xt.tag,en!==void 0&&(Xt&2||Xt&4)&&i0(yt,Ft,en),Nt=Nt.next}while(Nt!==vt)}break;case 1:if(Xu(yt,Ft),vt=yt.stateNode,typeof vt.componentWillUnmount=="function")try{vt.props=yt.memoizedProps,vt.state=yt.memoizedState,vt.componentWillUnmount()}catch(zn){kr(yt,Ft,zn)}break;case 5:Xu(yt,Ft);break;case 4:Dn?r1(vt,yt,Ft):ln&&ln&&(yt=yt.stateNode.containerInfo,Ft=$r(yt),Ur(yt,Ft))}}function Z0(vt,yt,Ft){for(var Nt=yt;;)if(Sm(vt,Nt,Ft),Nt.child===null||Dn&&Nt.tag===4){if(Nt===yt)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===yt)return;Nt=Nt.return}Nt.sibling.return=Nt.return,Nt=Nt.sibling}else Nt.child.return=Nt,Nt=Nt.child}function _g(vt){var yt=vt.alternate;yt!==null&&(vt.alternate=null,_g(yt)),vt.child=null,vt.deletions=null,vt.sibling=null,vt.tag===5&&(yt=vt.stateNode,yt!==null&&xn(yt)),vt.stateNode=null,vt.return=null,vt.dependencies=null,vt.memoizedProps=null,vt.memoizedState=null,vt.pendingProps=null,vt.stateNode=null,vt.updateQueue=null}function e1(vt){return vt.tag===5||vt.tag===3||vt.tag===4}function t1(vt){e:for(;;){for(;vt.sibling===null;){if(vt.return===null||e1(vt.return))return null;vt=vt.return}for(vt.sibling.return=vt.return,vt=vt.sibling;vt.tag!==5&&vt.tag!==6&&vt.tag!==18;){if(vt.flags&2||vt.child===null||vt.tag===4)continue e;vt.child.return=vt,vt=vt.child}if(!(vt.flags&2))return vt.stateNode}}function n1(vt){if(Dn){e:{for(var yt=vt.return;yt!==null;){if(e1(yt))break e;yt=yt.return}throw Error(tt(160))}var Ft=yt;switch(Ft.tag){case 5:yt=Ft.stateNode,Ft.flags&32&&(Jn(yt),Ft.flags&=-33),Ft=t1(vt),o0(vt,Ft,yt);break;case 3:case 4:yt=Ft.stateNode.containerInfo,Ft=t1(vt),s0(vt,Ft,yt);break;default:throw Error(tt(161))}}}function s0(vt,yt,Ft){var Nt=vt.tag;if(Nt===5||Nt===6)vt=vt.stateNode,yt?Cr(Ft,vt,yt):yn(Ft,vt);else if(Nt!==4&&(vt=vt.child,vt!==null))for(s0(vt,yt,Ft),vt=vt.sibling;vt!==null;)s0(vt,yt,Ft),vt=vt.sibling}function o0(vt,yt,Ft){var Nt=vt.tag;if(Nt===5||Nt===6)vt=vt.stateNode,yt?gr(Ft,vt,yt):Hn(Ft,vt);else if(Nt!==4&&(vt=vt.child,vt!==null))for(o0(vt,yt,Ft),vt=vt.sibling;vt!==null;)o0(vt,yt,Ft),vt=vt.sibling}function r1(vt,yt,Ft){for(var Nt=yt,Xt=!1,en,zn;;){if(!Xt){Xt=Nt.return;e:for(;;){if(Xt===null)throw Error(tt(160));switch(en=Xt.stateNode,Xt.tag){case 5:zn=!1;break e;case 3:en=en.containerInfo,zn=!0;break e;case 4:en=en.containerInfo,zn=!0;break e}Xt=Xt.return}Xt=!0}if(Nt.tag===5||Nt.tag===6)Z0(vt,Nt,Ft),zn?Un(en,Nt.stateNode):Sr(en,Nt.stateNode);else if(Nt.tag===18)zn?Kn(en,Nt.stateNode):Vn(en,Nt.stateNode);else if(Nt.tag===4){if(Nt.child!==null){en=Nt.stateNode.containerInfo,zn=!0,Nt.child.return=Nt,Nt=Nt.child;continue}}else if(Sm(vt,Nt,Ft),Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}if(Nt===yt)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===yt)return;Nt=Nt.return,Nt.tag===4&&(Xt=!1)}Nt.sibling.return=Nt.return,Nt=Nt.sibling}}function a0(vt,yt){if(Dn){switch(yt.tag){case 0:case 11:case 14:case 15:ru(3,yt,yt.return),Np(3,yt),ru(5,yt,yt.return);return;case 1:return;case 5:var Ft=yt.stateNode;if(Ft!=null){var Nt=yt.memoizedProps;vt=vt!==null?vt.memoizedProps:Nt;var Xt=yt.type,en=yt.updateQueue;yt.updateQueue=null,en!==null&&tr(Ft,en,Xt,vt,Nt,yt)}return;case 6:if(yt.stateNode===null)throw Error(tt(162));Ft=yt.memoizedProps,On(yt.stateNode,vt!==null?vt.memoizedProps:Ft,Ft);return;case 3:Cn&&vt!==null&&vt.memoizedState.isDehydrated&&on(yt.stateNode.containerInfo);return;case 12:return;case 13:bm(yt);return;case 19:bm(yt);return;case 17:return}throw Error(tt(163))}switch(yt.tag){case 0:case 11:case 14:case 15:ru(3,yt,yt.return),Np(3,yt),ru(5,yt,yt.return);return;case 12:return;case 13:bm(yt);return;case 19:bm(yt);return;case 3:Cn&&vt!==null&&vt.memoizedState.isDehydrated&&on(yt.stateNode.containerInfo);break;case 22:case 23:return}e:if(ln){switch(yt.tag){case 1:case 5:case 6:break e;case 3:case 4:yt=yt.stateNode,Ur(yt.containerInfo,yt.pendingChildren);break e}throw Error(tt(163))}}function bm(vt){var yt=vt.updateQueue;if(yt!==null){vt.updateQueue=null;var Ft=vt.stateNode;Ft===null&&(Ft=vt.stateNode=new J0),yt.forEach(function(Nt){var Xt=Rs.bind(null,vt,Nt);Ft.has(Nt)||(Ft.add(Nt),Nt.then(Xt,Xt))})}}function A1(vt,yt){for(zr=yt;zr!==null;){yt=zr;var Ft=yt.deletions;if(Ft!==null)for(var Nt=0;Nt<Ft.length;Nt++){var Xt=Ft[Nt];try{var en=vt;Dn?r1(en,Xt,yt):Z0(en,Xt,yt);var zn=Xt.alternate;zn!==null&&(zn.return=null),Xt.return=null}catch(ds){kr(Xt,yt,ds)}}if(Ft=yt.child,yt.subtreeFlags&12854&&Ft!==null)Ft.return=yt,zr=Ft;else for(;zr!==null;){yt=zr;try{var ir=yt.flags;if(ir&32&&Dn&&Jn(yt.stateNode),ir&512){var yr=yt.alternate;if(yr!==null){var Nr=yr.ref;Nr!==null&&(typeof Nr=="function"?Nr(null):Nr.current=null)}}if(ir&8192)switch(yt.tag){case 13:if(yt.memoizedState!==null){var os=yt.alternate;(os===null||os.memoizedState===null)&&(Bm=Vr())}break;case 22:var Ls=yt.memoizedState!==null,_s=yt.alternate,mo=_s!==null&&_s.memoizedState!==null;if(Ft=yt,Dn){e:if(Nt=Ft,Xt=Ls,en=null,Dn)for(var Br=Nt;;){if(Br.tag===5){if(en===null){en=Br;var Bl=Br.stateNode;Xt?pr(Bl):Zn(Br.stateNode,Br.memoizedProps)}}else if(Br.tag===6){if(en===null){var xo=Br.stateNode;Xt?Gn(xo):qn(xo,Br.memoizedProps)}}else if((Br.tag!==22&&Br.tag!==23||Br.memoizedState===null||Br===Nt)&&Br.child!==null){Br.child.return=Br,Br=Br.child;continue}if(Br===Nt)break;for(;Br.sibling===null;){if(Br.return===null||Br.return===Nt)break e;en===Br&&(en=null),Br=Br.return}en===Br&&(en=null),Br.sibling.return=Br.return,Br=Br.sibling}}if(Ls&&!mo&&Ft.mode&1){zr=Ft;for(var dr=Ft.child;dr!==null;){for(Ft=zr=dr;zr!==null;){Nt=zr;var er=Nt.child;switch(Nt.tag){case 0:case 11:case 14:case 15:ru(4,Nt,Nt.return);break;case 1:Xu(Nt,Nt.return);var Ar=Nt.stateNode;if(typeof Ar.componentWillUnmount=="function"){var Or=Nt.return;try{Ar.props=Nt.memoizedProps,Ar.state=Nt.memoizedState,Ar.componentWillUnmount()}catch(ds){kr(Nt,Or,ds)}}break;case 5:Xu(Nt,Nt.return);break;case 22:if(Nt.memoizedState!==null){Cm(Ft);continue}}er!==null?(er.return=Nt,zr=er):Cm(Ft)}dr=dr.sibling}}}switch(ir&4102){case 2:n1(yt),yt.flags&=-3;break;case 6:n1(yt),yt.flags&=-3,a0(yt.alternate,yt);break;case 4096:yt.flags&=-4097;break;case 4100:yt.flags&=-4097,a0(yt.alternate,yt);break;case 4:a0(yt.alternate,yt)}}catch(ds){kr(yt,yt.return,ds)}if(Ft=yt.sibling,Ft!==null){Ft.return=yt.return,zr=Ft;break}zr=yt.return}}}function v1(vt,yt,Ft){zr=vt,i1(vt)}function i1(vt,yt,Ft){for(var Nt=(vt.mode&1)!==0;zr!==null;){var Xt=zr,en=Xt.child;if(Xt.tag===22&&Nt){var zn=Xt.memoizedState!==null||ho;if(!zn){var ir=Xt.alternate,yr=ir!==null&&ir.memoizedState!==null||ba;ir=ho;var Nr=ba;if(ho=zn,(ba=yr)&&!Nr)for(zr=Xt;zr!==null;)zn=zr,yr=zn.child,zn.tag===22&&zn.memoizedState!==null?so(Xt):yr!==null?(yr.return=zn,zr=yr):so(Xt);for(;en!==null;)zr=en,i1(en),en=en.sibling;zr=Xt,ho=ir,ba=Nr}l0(vt)}else Xt.subtreeFlags&8772&&en!==null?(en.return=Xt,zr=en):l0(vt)}}function l0(vt){for(;zr!==null;){var yt=zr;if(yt.flags&8772){var Ft=yt.alternate;try{if(yt.flags&8772)switch(yt.tag){case 0:case 11:case 15:ba||Np(5,yt);break;case 1:var Nt=yt.stateNode;if(yt.flags&4&&!ba)if(Ft===null)Nt.componentDidMount();else{var Xt=yt.elementType===yt.type?Ft.memoizedProps:Zl(yt.type,Ft.memoizedProps);Nt.componentDidUpdate(Xt,Ft.memoizedState,Nt.__reactInternalSnapshotBeforeUpdate)}var en=yt.updateQueue;en!==null&&_0(yt,en,Nt);break;case 3:var zn=yt.updateQueue;if(zn!==null){if(Ft=null,yt.child!==null)switch(yt.child.tag){case 5:Ft=jt(yt.child.stateNode);break;case 1:Ft=yt.child.stateNode}_0(yt,zn,Ft)}break;case 5:var ir=yt.stateNode;Ft===null&&yt.flags&4&&Mn(ir,yt.type,yt.memoizedProps,yt);break;case 6:break;case 4:break;case 12:break;case 13:if(Cn&&yt.memoizedState===null){var yr=yt.alternate;if(yr!==null){var Nr=yr.memoizedState;if(Nr!==null){var os=Nr.dehydrated;os!==null&&dn(os)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(tt(163))}ba||yt.flags&512&&Em(yt)}catch(Ls){kr(yt,yt.return,Ls)}}if(yt===vt){zr=null;break}if(Ft=yt.sibling,Ft!==null){Ft.return=yt.return,zr=Ft;break}zr=yt.return}}function Cm(vt){for(;zr!==null;){var yt=zr;if(yt===vt){zr=null;break}var Ft=yt.sibling;if(Ft!==null){Ft.return=yt.return,zr=Ft;break}zr=yt.return}}function so(vt){for(;zr!==null;){var yt=zr;try{switch(yt.tag){case 0:case 11:case 15:var Ft=yt.return;try{Np(4,yt)}catch(yr){kr(yt,Ft,yr)}break;case 1:var Nt=yt.stateNode;if(typeof Nt.componentDidMount=="function"){var Xt=yt.return;try{Nt.componentDidMount()}catch(yr){kr(yt,Xt,yr)}}var en=yt.return;try{Em(yt)}catch(yr){kr(yt,en,yr)}break;case 5:var zn=yt.return;try{Em(yt)}catch(yr){kr(yt,zn,yr)}}}catch(yr){kr(yt,yt.return,yr)}if(yt===vt){zr=null;break}var ir=yt.sibling;if(ir!==null){ir.return=yt.return,zr=ir;break}zr=yt.return}}var Yu=0,Tm=1,Co=2,Ru=3,Mm=4;if(typeof Symbol=="function"&&Symbol.for){var Dp=Symbol.for;Yu=Dp("selector.component"),Tm=Dp("selector.has_pseudo_class"),Co=Dp("selector.role"),Ru=Dp("selector.test_id"),Mm=Dp("selector.text")}function c0(vt){var yt=bn(vt);if(yt!=null){if(typeof yt.memoizedProps["data-testname"]!="string")throw Error(tt(364));return yt}if(vt=mr(vt),vt===null)throw Error(tt(362));return vt.stateNode.current}function xu(vt,yt){switch(yt.$$typeof){case Yu:if(vt.type===yt.value)return!0;break;case Tm:e:{yt=yt.value,vt=[vt,0];for(var Ft=0;Ft<vt.length;){var Nt=vt[Ft++],Xt=vt[Ft++],en=yt[Xt];if(Nt.tag!==5||!$t(Nt)){for(;en!=null&&xu(Nt,en);)Xt++,en=yt[Xt];if(Xt===yt.length){yt=!0;break e}else for(Nt=Nt.child;Nt!==null;)vt.push(Nt,Xt),Nt=Nt.sibling}}yt=!1}return yt;case Co:if(vt.tag===5&&An(vt.stateNode,yt.value))return!0;break;case Mm:if((vt.tag===5||vt.tag===6)&&(vt=tn(vt),vt!==null&&0<=vt.indexOf(yt.value)))return!0;break;case Ru:if(vt.tag===5&&(vt=vt.memoizedProps["data-testname"],typeof vt=="string"&&vt.toLowerCase()===yt.value.toLowerCase()))return!0;break;default:throw Error(tt(365))}return!1}function wm(vt){switch(vt.$$typeof){case Yu:return"<"+(Tt(vt.value)||"Unknown")+">";case Tm:return":has("+(wm(vt)||"")+")";case Co:return'[role="'+vt.value+'"]';case Mm:return'"'+vt.value+'"';case Ru:return'[data-testname="'+vt.value+'"]';default:throw Error(tt(365))}}function El(vt,yt){var Ft=[];vt=[vt,0];for(var Nt=0;Nt<vt.length;){var Xt=vt[Nt++],en=vt[Nt++],zn=yt[en];if(Xt.tag!==5||!$t(Xt)){for(;zn!=null&&xu(Xt,zn);)en++,zn=yt[en];if(en===yt.length)Ft.push(Xt);else for(Xt=Xt.child;Xt!==null;)vt.push(Xt,en),Xt=Xt.sibling}}return Ft}function Op(vt,yt){if(!or)throw Error(tt(363));vt=c0(vt),vt=El(vt,yt),yt=[],vt=Array.from(vt);for(var Ft=0;Ft<vt.length;){var Nt=vt[Ft++];if(Nt.tag===5)$t(Nt)||yt.push(Nt.stateNode);else for(Nt=Nt.child;Nt!==null;)vt.push(Nt),Nt=Nt.sibling}return yt}var y1=Math.ceil,Up=nt.ReactCurrentDispatcher,Gp=nt.ReactCurrentOwner,vo=nt.ReactCurrentBatchConfig,Ds=0,wo=null,ws=null,Go=0,Ul=0,fp=Kr(0),ko=0,Vp=null,dp=0,Im=0,u0=0,zp=null,Sl=null,Bm=0,Hp=1/0;function pp(){Hp=Vr()+500}var Rm=!1,h0=null,Vo=null,Fm=!1,Fu=null,Qp=0,mp=0,gp=null,Pm=-1,Wp=0;function Al(){return Ds&6?Vr():Pm!==-1?Pm:Pm=Vr()}function du(vt){return vt.mode&1?Ds&2&&Go!==0?Go&-Go:Jp.transition!==null?(Wp===0&&(vt=Lu,Lu<<=1,!(Lu&4194240)&&(Lu=64),Wp=vt),Wp):(vt=Tr,vt!==0?vt:Sn()):1}function $l(vt,yt,Ft){if(50<mp)throw mp=0,gp=null,Error(tt(185));var Nt=jp(vt,yt);return Nt===null?null:(Fn(Nt,yt,Ft),(!(Ds&2)||Nt!==wo)&&(Nt===wo&&(!(Ds&2)&&(Im|=yt),ko===4&&Ct(Nt,Go)),Cl(Nt,Ft),yt===1&&Ds===0&&!(vt.mode&1)&&(pp(),Au&&Jl())),Nt)}function jp(vt,yt){vt.lanes|=yt;var Ft=vt.alternate;for(Ft!==null&&(Ft.lanes|=yt),Ft=vt,vt=vt.return;vt!==null;)vt.childLanes|=yt,Ft=vt.alternate,Ft!==null&&(Ft.childLanes|=yt),Ft=vt,vt=vt.return;return Ft.tag===3?Ft.stateNode:null}function Cl(vt,yt){var Ft=vt.callbackNode;vn(vt,yt);var Nt=gu(vt,vt===wo?Go:0);if(Nt===0)Ft!==null&&Qr(Ft),vt.callbackNode=null,vt.callbackPriority=0;else if(yt=Nt&-Nt,vt.callbackPriority!==yt){if(Ft!=null&&Qr(Ft),yt===1)vt.tag===0?u1(It.bind(null,vt)):xp(It.bind(null,vt)),Qn?nr(function(){Ds===0&&Jl()}):Yr(ms,Jl),Ft=null;else{switch(_i(Nt)){case 1:Ft=ms;break;case 4:Ft=Zr;break;case 16:Ft=io;break;case 536870912:Ft=Xs;break;default:Ft=io}Ft=bo(Ft,yo.bind(null,vt))}vt.callbackPriority=yt,vt.callbackNode=Ft}}function yo(vt,yt){if(Pm=-1,Wp=0,Ds&6)throw Error(tt(327));var Ft=vt.callbackNode;if(Wr()&&vt.callbackNode!==Ft)return null;var Nt=gu(vt,vt===wo?Go:0);if(Nt===0)return null;if(Nt&30||Nt&vt.expiredLanes||yt)yt=Wn(vt,Nt);else{yt=Nt;var Xt=Ds;Ds|=2;var en=an();(wo!==vt||Go!==yt)&&(pp(),Yt(vt,yt));do try{Yn();break}catch(ir){un(vt,ir)}while(1);Rl(),Up.current=en,Ds=Xt,ws!==null?yt=0:(wo=null,Go=0,yt=ko)}if(yt!==0){if(yt===2&&(Xt=Bn(vt),Xt!==0&&(Nt=Xt,yt=f0(vt,Xt))),yt===1)throw Ft=Vp,Yt(vt,0),Ct(vt,Nt),Cl(vt,Vr()),Ft;if(yt===6)Ct(vt,Nt);else{if(Xt=vt.current.alternate,!(Nt&30)&&!xt(Xt)&&(yt=Wn(vt,Nt),yt===2&&(en=Bn(vt),en!==0&&(Nt=en,yt=f0(vt,en))),yt===1))throw Ft=Vp,Yt(vt,0),Ct(vt,Nt),Cl(vt,Vr()),Ft;switch(vt.finishedWork=Xt,vt.finishedLanes=Nt,yt){case 0:case 1:throw Error(tt(345));case 2:jr(vt,Sl);break;case 3:if(Ct(vt,Nt),(Nt&130023424)===Nt&&(yt=Bm+500-Vr(),10<yt)){if(gu(vt,0)!==0)break;if(Xt=vt.suspendedLanes,(Xt&Nt)!==Nt){Al(),vt.pingedLanes|=vt.suspendedLanes&Xt;break}vt.timeoutHandle=hn(jr.bind(null,vt,Sl),yt);break}jr(vt,Sl);break;case 4:if(Ct(vt,Nt),(Nt&4194240)===Nt)break;for(yt=vt.eventTimes,Xt=-1;0<Nt;){var zn=31-ro(Nt);en=1<<zn,zn=yt[zn],zn>Xt&&(Xt=zn),Nt&=~en}if(Nt=Xt,Nt=Vr()-Nt,Nt=(120>Nt?120:480>Nt?480:1080>Nt?1080:1920>Nt?1920:3e3>Nt?3e3:4320>Nt?4320:1960*y1(Nt/1960))-Nt,10<Nt){vt.timeoutHandle=hn(jr.bind(null,vt,Sl),Nt);break}jr(vt,Sl);break;case 5:jr(vt,Sl);break;default:throw Error(tt(329))}}}return Cl(vt,Vr()),vt.callbackNode===Ft?yo.bind(null,vt):null}function f0(vt,yt){var Ft=zp;return vt.current.memoizedState.isDehydrated&&(Yt(vt,yt).flags|=256),vt=Wn(vt,yt),vt!==2&&(yt=Sl,Sl=Ft,yt!==null&&pt(yt)),vt}function pt(vt){Sl===null?Sl=vt:Sl.push.apply(Sl,vt)}function xt(vt){for(var yt=vt;;){if(yt.flags&16384){var Ft=yt.updateQueue;if(Ft!==null&&(Ft=Ft.stores,Ft!==null))for(var Nt=0;Nt<Ft.length;Nt++){var Xt=Ft[Nt],en=Xt.getSnapshot;Xt=Xt.value;try{if(!Wo(en(),Xt))return!1}catch{return!1}}}if(Ft=yt.child,yt.subtreeFlags&16384&&Ft!==null)Ft.return=yt,yt=Ft;else{if(yt===vt)break;for(;yt.sibling===null;){if(yt.return===null||yt.return===vt)return!0;yt=yt.return}yt.sibling.return=yt.return,yt=yt.sibling}}return!0}function Ct(vt,yt){for(yt&=~u0,yt&=~Im,vt.suspendedLanes|=yt,vt.pingedLanes&=~yt,vt=vt.expirationTimes;0<yt;){var Ft=31-ro(yt),Nt=1<<Ft;vt[Ft]=-1,yt&=~Nt}}function It(vt){if(Ds&6)throw Error(tt(327));Wr();var yt=gu(vt,0);if(!(yt&1))return Cl(vt,Vr()),null;var Ft=Wn(vt,yt);if(vt.tag!==0&&Ft===2){var Nt=Bn(vt);Nt!==0&&(yt=Nt,Ft=f0(vt,Nt))}if(Ft===1)throw Ft=Vp,Yt(vt,0),Ct(vt,yt),Cl(vt,Vr()),Ft;if(Ft===6)throw Error(tt(345));return vt.finishedWork=vt.current.alternate,vt.finishedLanes=yt,jr(vt,Sl),Cl(vt,Vr()),null}function Pt(vt){Fu!==null&&Fu.tag===0&&!(Ds&6)&&Wr();var yt=Ds;Ds|=1;var Ft=vo.transition,Nt=Tr;try{if(vo.transition=null,Tr=1,vt)return vt()}finally{Tr=Nt,vo.transition=Ft,Ds=yt,!(Ds&6)&&Jl()}}function kt(){Ul=fp.current,As(fp)}function Yt(vt,yt){vt.finishedWork=null,vt.finishedLanes=0;var Ft=vt.timeoutHandle;if(Ft!==Nn&&(vt.timeoutHandle=Nn,Tn(Ft)),ws!==null)for(Ft=ws.return;Ft!==null;){var Nt=Ft;switch(tm(Nt),Nt.tag){case 1:Nt=Nt.type.childContextTypes,Nt!=null&&co();break;case 3:Qu(),As(Ss),As(Us),jm();break;case 5:Nl(Nt);break;case 4:Qu();break;case 13:As(Ao);break;case 19:As(Ao);break;case 10:Vm(Nt.type._context);break;case 22:case 23:kt()}Ft=Ft.return}if(wo=vt,ws=vt=oo(vt.current,null),Go=Ul=yt,ko=0,Vp=null,u0=Im=dp=0,Sl=zp=null,su!==null){for(yt=0;yt<su.length;yt++)if(Ft=su[yt],Nt=Ft.interleaved,Nt!==null){Ft.interleaved=null;var Xt=Nt.next,en=Ft.pending;if(en!==null){var zn=en.next;en.next=Xt,Nt.next=zn}Ft.pending=Nt}su=null}return vt}function un(vt,yt){do{var Ft=ws;try{if(Rl(),rm.current=fu,Dl){for(var Nt=So.memoizedState;Nt!==null;){var Xt=Nt.queue;Xt!==null&&(Xt.pending=null),Nt=Nt.next}Dl=!1}if(ap=0,Uo=Yo=So=null,Bp=!1,Rp=0,Gp.current=null,Ft===null||Ft.return===null){ko=1,Vp=yt,ws=null;break}e:{var en=vt,zn=Ft.return,ir=Ft,yr=yt;if(yt=Go,ir.flags|=32768,yr!==null&&typeof yr=="object"&&typeof yr.then=="function"){var Nr=yr,os=ir,Ls=os.tag;if(!(os.mode&1)&&(Ls===0||Ls===11||Ls===15)){var _s=os.alternate;_s?(os.updateQueue=_s.updateQueue,os.memoizedState=_s.memoizedState,os.lanes=_s.lanes):(os.updateQueue=null,os.memoizedState=null)}var mo=G0(zn);if(mo!==null){mo.flags&=-257,n0(mo,zn,ir,en,yt),mo.mode&1&&U0(en,Nr,yt),yt=mo,yr=Nr;var Br=yt.updateQueue;if(Br===null){var Bl=new Set;Bl.add(yr),yt.updateQueue=Bl}else Br.add(yr);break e}else{if(!(yt&1)){U0(en,Nr,yt),jn();break e}yr=Error(tt(426))}}else if(uo&&ir.mode&1){var xo=G0(zn);if(xo!==null){!(xo.flags&65536)&&(xo.flags|=256),n0(xo,zn,ir,en,yt),zl(yr);break e}}en=yr,ko!==4&&(ko=2),zp===null?zp=[en]:zp.push(en),yr=e0(yr,ir),ir=zn;do{switch(ir.tag){case 3:ir.flags|=65536,yt&=-yt,ir.lanes|=yt;var dr=dm(ir,yr,yt);Ou(ir,dr);break e;case 1:en=yr;var er=ir.type,Ar=ir.stateNode;if(!(ir.flags&128)&&(typeof er.getDerivedStateFromError=="function"||Ar!==null&&typeof Ar.componentDidCatch=="function"&&(Vo===null||!Vo.has(Ar)))){ir.flags|=65536,yt&=-yt,ir.lanes|=yt;var Or=O0(ir,en,yt);Ou(ir,Or);break e}}ir=ir.return}while(ir!==null)}Lr(Ft)}catch(ds){yt=ds,ws===Ft&&Ft!==null&&(ws=Ft=Ft.return);continue}break}while(1)}function an(){var vt=Up.current;return Up.current=fu,vt===null?fu:vt}function jn(){(ko===0||ko===3||ko===2)&&(ko=4),wo===null||!(dp&268435455)&&!(Im&268435455)||Ct(wo,Go)}function Wn(vt,yt){var Ft=Ds;Ds|=2;var Nt=an();wo===vt&&Go===yt||Yt(vt,yt);do try{lr();break}catch(Xt){un(vt,Xt)}while(1);if(Rl(),Ds=Ft,Up.current=Nt,ws!==null)throw Error(tt(261));return wo=null,Go=0,ko}function lr(){for(;ws!==null;)hr(ws)}function Yn(){for(;ws!==null&&!Dr();)hr(ws)}function hr(vt){var yt=hs(vt.alternate,vt,Ul);vt.memoizedProps=vt.pendingProps,yt===null?Lr(vt):ws=yt,Gp.current=null}function Lr(vt){var yt=vt;do{var Ft=yt.alternate;if(vt=yt.return,yt.flags&32768){if(Ft=g1(Ft,yt),Ft!==null){Ft.flags&=32767,ws=Ft;return}if(vt!==null)vt.flags|=32768,vt.subtreeFlags=0,vt.deletions=null;else{ko=6,ws=null;return}}else if(Ft=p1(Ft,yt,Ul),Ft!==null){ws=Ft;return}if(yt=yt.sibling,yt!==null){ws=yt;return}ws=yt=vt}while(yt!==null);ko===0&&(ko=5)}function jr(vt,yt){var Ft=Tr,Nt=vo.transition;try{vo.transition=null,Tr=1,Xr(vt,yt,Ft)}finally{vo.transition=Nt,Tr=Ft}return null}function Xr(vt,yt,Ft){do Wr();while(Fu!==null);if(Ds&6)throw Error(tt(327));var Nt=vt.finishedWork,Xt=vt.finishedLanes;if(Nt===null)return null;if(vt.finishedWork=null,vt.finishedLanes=0,Nt===vt.current)throw Error(tt(177));vt.callbackNode=null,vt.callbackPriority=0;var en=Nt.lanes|Nt.childLanes;if(fr(vt,en),vt===wo&&(ws=wo=null,Go=0),!(Nt.subtreeFlags&2064)&&!(Nt.flags&2064)||Fm||(Fm=!0,bo(io,function(){return Wr(),null})),en=(Nt.flags&15990)!==0,Nt.subtreeFlags&15990||en){en=vo.transition,vo.transition=null;var zn=Tr;Tr=1;var ir=Ds;Ds|=4,Gp.current=null,Ku(vt,Nt),A1(vt,Nt),nn(vt.containerInfo),vt.current=Nt,v1(Nt),vs(),Ds=ir,Tr=zn,vo.transition=en}else vt.current=Nt;if(Fm&&(Fm=!1,Fu=vt,Qp=Xt),en=vt.pendingLanes,en===0&&(Vo=null),Yl(Nt.stateNode),Cl(vt,Vr()),yt!==null)for(Ft=vt.onRecoverableError,Nt=0;Nt<yt.length;Nt++)Ft(yt[Nt]);if(Rm)throw Rm=!1,vt=h0,h0=null,vt;return Qp&1&&vt.tag!==0&&Wr(),en=vt.pendingLanes,en&1?vt===gp?mp++:(mp=0,gp=vt):mp=0,Jl(),null}function Wr(){if(Fu!==null){var vt=_i(Qp),yt=vo.transition,Ft=Tr;try{if(vo.transition=null,Tr=16>vt?16:vt,Fu===null)var Nt=!1;else{if(vt=Fu,Fu=null,Qp=0,Ds&6)throw Error(tt(331));var Xt=Ds;for(Ds|=4,zr=vt.current;zr!==null;){var en=zr,zn=en.child;if(zr.flags&16){var ir=en.deletions;if(ir!==null){for(var yr=0;yr<ir.length;yr++){var Nr=ir[yr];for(zr=Nr;zr!==null;){var os=zr;switch(os.tag){case 0:case 11:case 15:ru(8,os,en)}var Ls=os.child;if(Ls!==null)Ls.return=os,zr=Ls;else for(;zr!==null;){os=zr;var _s=os.sibling,mo=os.return;if(_g(os),os===Nr){zr=null;break}if(_s!==null){_s.return=mo,zr=_s;break}zr=mo}}}var Br=en.alternate;if(Br!==null){var Bl=Br.child;if(Bl!==null){Br.child=null;do{var xo=Bl.sibling;Bl.sibling=null,Bl=xo}while(Bl!==null)}}zr=en}}if(en.subtreeFlags&2064&&zn!==null)zn.return=en,zr=zn;else e:for(;zr!==null;){if(en=zr,en.flags&2048)switch(en.tag){case 0:case 11:case 15:ru(9,en,en.return)}var dr=en.sibling;if(dr!==null){dr.return=en.return,zr=dr;break e}zr=en.return}}var er=vt.current;for(zr=er;zr!==null;){zn=zr;var Ar=zn.child;if(zn.subtreeFlags&2064&&Ar!==null)Ar.return=zn,zr=Ar;else e:for(zn=er;zr!==null;){if(ir=zr,ir.flags&2048)try{switch(ir.tag){case 0:case 11:case 15:Np(9,ir)}}catch(ds){kr(ir,ir.return,ds)}if(ir===zn){zr=null;break e}var Or=ir.sibling;if(Or!==null){Or.return=ir.return,zr=Or;break e}zr=ir.return}}if(Ds=Xt,Jl(),Ms&&typeof Ms.onPostCommitFiberRoot=="function")try{Ms.onPostCommitFiberRoot(Vs,vt)}catch{}Nt=!0}return Nt}finally{Tr=Ft,vo.transition=yt}}return!1}function bs(vt,yt,Ft){yt=e0(Ft,yt),yt=dm(vt,yt,1),eu(vt,yt),yt=Al(),vt=jp(vt,1),vt!==null&&(Fn(vt,1,yt),Cl(vt,yt))}function kr(vt,yt,Ft){if(vt.tag===3)bs(vt,vt,Ft);else for(;yt!==null;){if(yt.tag===3){bs(yt,vt,Ft);break}else if(yt.tag===1){var Nt=yt.stateNode;if(typeof yt.type.getDerivedStateFromError=="function"||typeof Nt.componentDidCatch=="function"&&(Vo===null||!Vo.has(Nt))){vt=e0(Ft,vt),vt=O0(yt,vt,1),eu(yt,vt),vt=Al(),yt=jp(yt,1),yt!==null&&(Fn(yt,1,vt),Cl(yt,vt));break}}yt=yt.return}}function Zs(vt,yt,Ft){var Nt=vt.pingCache;Nt!==null&&Nt.delete(yt),yt=Al(),vt.pingedLanes|=vt.suspendedLanes&Ft,wo===vt&&(Go&Ft)===Ft&&(ko===4||ko===3&&(Go&130023424)===Go&&500>Vr()-Bm?Yt(vt,0):u0|=Ft),Cl(vt,yt)}function Is(vt,yt){yt===0&&(vt.mode&1?(yt=_d,_d<<=1,!(_d&130023424)&&(_d=4194304)):yt=1);var Ft=Al();vt=jp(vt,yt),vt!==null&&(Fn(vt,yt,Ft),Cl(vt,Ft))}function fo(vt){var yt=vt.memoizedState,Ft=0;yt!==null&&(Ft=yt.retryLane),Is(vt,Ft)}function Rs(vt,yt){var Ft=0;switch(vt.tag){case 13:var Nt=vt.stateNode,Xt=vt.memoizedState;Xt!==null&&(Ft=Xt.retryLane);break;case 19:Nt=vt.stateNode;break;default:throw Error(tt(314))}Nt!==null&&Nt.delete(yt),Is(vt,Ft)}var hs;hs=function(vt,yt,Ft){if(vt!==null)if(vt.memoizedProps!==yt.pendingProps||Ss.current)Jo=!0;else{if(!(vt.lanes&Ft)&&!(yt.flags&128))return Jo=!1,xm(vt,yt,Ft);Jo=!!(vt.flags&131072)}else Jo=!1,uo&&yt.flags&1048576&&E0(yt,Tp,yt.index);switch(yt.lanes=0,yt.tag){case 2:var Nt=yt.type;vt!==null&&(vt.alternate=null,yt.alternate=null,yt.flags|=2),vt=yt.pendingProps;var Xt=Hs(yt,Us.current);tp(yt,Ft),Xt=im(null,yt,Nt,vt,Xt,Ft);var en=sm();return yt.flags|=1,typeof Xt=="object"&&Xt!==null&&typeof Xt.render=="function"&&Xt.$$typeof===void 0?(yt.tag=1,yt.memoizedState=null,yt.updateQueue=null,Ys(Nt)?(en=!0,Ns(yt)):en=!1,yt.memoizedState=Xt.state!==null&&Xt.state!==void 0?Xt.state:null,Du(yt),Xt.updater=Cp,yt.stateNode=Xt,Xt._reactInternals=yt,ga(yt,Nt,vt,Ft),yt=Am(null,yt,Nt,!0,en,Ft)):(yt.tag=0,uo&&en&&tu(yt),xa(null,yt,Xt,Ft),yt=yt.child),yt;case 16:Nt=yt.elementType;e:{switch(vt!==null&&(vt.alternate=null,yt.alternate=null,yt.flags|=2),vt=yt.pendingProps,Xt=Nt._init,Nt=Xt(Nt._payload),yt.type=Nt,Xt=yt.tag=Xl(Nt),vt=Zl(Nt,vt),Xt){case 0:yt=r0(null,yt,Nt,vt,Ft);break e;case 1:yt=$0(null,yt,Nt,vt,Ft);break e;case 11:yt=gm(null,yt,Nt,vt,Ft);break e;case 14:yt=H0(null,yt,Nt,Zl(Nt.type,vt),Ft);break e}throw Error(tt(306,Nt,""))}return yt;case 0:return Nt=yt.type,Xt=yt.pendingProps,Xt=yt.elementType===Nt?Xt:Zl(Nt,Xt),r0(vt,yt,Nt,Xt,Ft);case 1:return Nt=yt.type,Xt=yt.pendingProps,Xt=yt.elementType===Nt?Xt:Zl(Nt,Xt),$0(vt,yt,Nt,Xt,Ft);case 3:e:{if(X0(yt),vt===null)throw Error(tt(387));Nt=yt.pendingProps,en=yt.memoizedState,Xt=en.element,zm(vt,yt),em(yt,Nt,null,Ft);var zn=yt.memoizedState;if(Nt=zn.element,Cn&&en.isDehydrated)if(en={element:Nt,isDehydrated:!1,cache:zn.cache,transitions:zn.transitions},yt.updateQueue.baseState=en,yt.memoizedState=en,yt.flags&256){Xt=Error(tt(423)),yt=K0(vt,yt,Nt,Ft,Xt);break e}else if(Nt!==Xt){Xt=Error(tt(424)),yt=K0(vt,yt,Nt,Ft,Xt);break e}else for(Cn&&(Fo=Do(yt.stateNode.containerInfo),Oo=yt,uo=!0,Vl=null,lu=!1),Ft=Mp(yt,null,Nt,Ft),yt.child=Ft;Ft;)Ft.flags=Ft.flags&-3|4096,Ft=Ft.sibling;else{if(zu(),Nt===Xt){yt=Lo(vt,yt,Ft);break e}xa(vt,yt,Nt,Ft)}yt=yt.child}return yt;case 5:return op(yt),vt===null&&nu(yt),Nt=yt.type,Xt=yt.pendingProps,en=vt!==null?vt.memoizedProps:null,zn=Xt.children,rn(Nt,Xt)?zn=null:en!==null&&rn(Nt,en)&&(yt.flags|=32),j0(vt,yt),xa(vt,yt,zn,Ft),yt.child;case 6:return vt===null&&nu(yt),null;case 13:return Y0(vt,yt,Ft);case 4:return wp(yt,yt.stateNode.containerInfo),Nt=yt.pendingProps,vt===null?yt.child=uu(yt,null,Nt,Ft):xa(vt,yt,Nt,Ft),yt.child;case 11:return Nt=yt.type,Xt=yt.pendingProps,Xt=yt.elementType===Nt?Xt:Zl(Nt,Xt),gm(vt,yt,Nt,Xt,Ft);case 7:return xa(vt,yt,yt.pendingProps,Ft),yt.child;case 8:return xa(vt,yt,yt.pendingProps.children,Ft),yt.child;case 12:return xa(vt,yt,yt.pendingProps.children,Ft),yt.child;case 10:e:{if(Nt=yt.type._context,Xt=yt.pendingProps,en=yt.memoizedProps,zn=Xt.value,Nu(yt,Nt,zn),en!==null)if(Wo(en.value,zn)){if(en.children===Xt.children&&!Ss.current){yt=Lo(vt,yt,Ft);break e}}else for(en=yt.child,en!==null&&(en.return=yt);en!==null;){var ir=en.dependencies;if(ir!==null){zn=en.child;for(var yr=ir.firstContext;yr!==null;){if(yr.context===Nt){if(en.tag===1){yr=_c(-1,Ft&-Ft),yr.tag=2;var Nr=en.updateQueue;if(Nr!==null){Nr=Nr.shared;var os=Nr.pending;os===null?yr.next=yr:(yr.next=os.next,os.next=yr),Nr.pending=yr}}en.lanes|=Ft,yr=en.alternate,yr!==null&&(yr.lanes|=Ft),Mo(en.return,Ft,yt),ir.lanes|=Ft;break}yr=yr.next}}else if(en.tag===10)zn=en.type===yt.type?null:en.child;else if(en.tag===18){if(zn=en.return,zn===null)throw Error(tt(341));zn.lanes|=Ft,ir=zn.alternate,ir!==null&&(ir.lanes|=Ft),Mo(zn,Ft,yt),zn=en.sibling}else zn=en.child;if(zn!==null)zn.return=en;else for(zn=en;zn!==null;){if(zn===yt){zn=null;break}if(en=zn.sibling,en!==null){en.return=zn.return,zn=en;break}zn=zn.return}en=zn}xa(vt,yt,Xt.children,Ft),yt=yt.child}return yt;case 9:return Xt=yt.type,Nt=yt.pendingProps.children,tp(yt,Ft),Xt=Fl(Xt),Nt=Nt(Xt),yt.flags|=1,xa(vt,yt,Nt,Ft),yt.child;case 14:return Nt=yt.type,Xt=Zl(Nt,yt.pendingProps),Xt=Zl(Nt.type,Xt),H0(vt,yt,Nt,Xt,Ft);case 15:return Q0(vt,yt,yt.type,yt.pendingProps,Ft);case 17:return Nt=yt.type,Xt=yt.pendingProps,Xt=yt.elementType===Nt?Xt:Zl(Nt,Xt),vt!==null&&(vt.alternate=null,yt.alternate=null,yt.flags|=2),yt.tag=1,Ys(Nt)?(vt=!0,Ns(yt)):vt=!1,tp(yt,Ft),np(yt,Nt,Xt),ga(yt,Nt,Xt,Ft),Am(null,yt,Nt,!0,vt,Ft);case 19:return q0(vt,yt,Ft);case 22:return W0(vt,yt,Ft)}throw Error(tt(156,yt.tag))};function bo(vt,yt){return Yr(vt,yt)}function Zo(vt,yt,Ft,Nt){this.tag=vt,this.key=Ft,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=yt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Nt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(vt,yt,Ft,Nt){return new Zo(vt,yt,Ft,Nt)}function Tl(vt){return vt=vt.prototype,!(!vt||!vt.isReactComponent)}function Xl(vt){if(typeof vt=="function")return Tl(vt)?1:0;if(vt!=null){if(vt=vt.$$typeof,vt===ht)return 11;if(vt===ut)return 14}return 2}function oo(vt,yt){var Ft=vt.alternate;return Ft===null?(Ft=lo(vt.tag,yt,vt.key,vt.mode),Ft.elementType=vt.elementType,Ft.type=vt.type,Ft.stateNode=vt.stateNode,Ft.alternate=vt,vt.alternate=Ft):(Ft.pendingProps=yt,Ft.type=vt.type,Ft.flags=0,Ft.subtreeFlags=0,Ft.deletions=null),Ft.flags=vt.flags&14680064,Ft.childLanes=vt.childLanes,Ft.lanes=vt.lanes,Ft.child=vt.child,Ft.memoizedProps=vt.memoizedProps,Ft.memoizedState=vt.memoizedState,Ft.updateQueue=vt.updateQueue,yt=vt.dependencies,Ft.dependencies=yt===null?null:{lanes:yt.lanes,firstContext:yt.firstContext},Ft.sibling=vt.sibling,Ft.index=vt.index,Ft.ref=vt.ref,Ft}function go(vt,yt,Ft,Nt,Xt,en){var zn=2;if(Nt=vt,typeof vt=="function")Tl(vt)&&(zn=1);else if(typeof vt=="string")zn=5;else e:switch(vt){case st:return no(Ft.children,Xt,en,yt);case at:zn=8,Xt|=8;break;case ot:return vt=lo(12,Ft,yt,Xt|2),vt.elementType=ot,vt.lanes=en,vt;case mt:return vt=lo(13,Ft,yt,Xt),vt.elementType=mt,vt.lanes=en,vt;case lt:return vt=lo(19,Ft,yt,Xt),vt.elementType=lt,vt.lanes=en,vt;case gt:return Qs(Ft,Xt,en,yt);default:if(typeof vt=="object"&&vt!==null)switch(vt.$$typeof){case ct:zn=10;break e;case ft:zn=9;break e;case ht:zn=11;break e;case ut:zn=14;break e;case dt:zn=16,Nt=null;break e}throw Error(tt(130,vt==null?vt:typeof vt,""))}return yt=lo(zn,Ft,yt,Xt),yt.elementType=vt,yt.type=Nt,yt.lanes=en,yt}function no(vt,yt,Ft,Nt){return vt=lo(7,vt,Nt,yt),vt.lanes=Ft,vt}function Qs(vt,yt,Ft,Nt){return vt=lo(22,vt,Nt,yt),vt.elementType=gt,vt.lanes=Ft,vt.stateNode={},vt}function _o(vt,yt,Ft){return vt=lo(6,vt,null,yt),vt.lanes=Ft,vt}function Io(vt,yt,Ft){return yt=lo(4,vt.children!==null?vt.children:[],vt.key,yt),yt.lanes=Ft,yt.stateNode={containerInfo:vt.containerInfo,pendingChildren:null,implementation:vt.implementation},yt}function ss(vt,yt,Ft,Nt,Xt){this.tag=yt,this.containerInfo=vt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Nn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wn(0),this.expirationTimes=wn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wn(0),this.identifierPrefix=Nt,this.onRecoverableError=Xt,Cn&&(this.mutableSourceEagerHydrationData=null)}function po(vt,yt,Ft,Nt,Xt,en,zn,ir,yr){return vt=new ss(vt,yt,Ft,ir,yr),yt===1?(yt=1,en===!0&&(yt|=8)):yt=0,en=lo(3,null,null,yt),vt.current=en,en.stateNode=vt,en.memoizedState={element:Nt,isDehydrated:Ft,cache:null,transitions:null},Du(en),vt}function zo(vt){if(!vt)return Ts;vt=vt._reactInternals;e:{if(Bt(vt)!==vt||vt.tag!==1)throw Error(tt(170));var yt=vt;do{switch(yt.tag){case 3:yt=yt.stateNode.context;break e;case 1:if(Ys(yt.type)){yt=yt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}yt=yt.return}while(yt!==null);throw Error(tt(171))}if(vt.tag===1){var Ft=vt.type;if(Ys(Ft))return Ps(vt,Ft,yt)}return yt}function Ml(vt){var yt=vt._reactInternals;if(yt===void 0)throw typeof vt.render=="function"?Error(tt(188)):(vt=Object.keys(vt).join(","),Error(tt(268,vt)));return vt=Ht(yt),vt===null?null:vt.stateNode}function d0(vt,yt){if(vt=vt.memoizedState,vt!==null&&vt.dehydrated!==null){var Ft=vt.retryLane;vt.retryLane=Ft!==0&&Ft<yt?Ft:yt}}function Il(vt,yt){d0(vt,yt),(vt=vt.alternate)&&d0(vt,yt)}function p0(vt){return vt=Ht(vt),vt===null?null:vt.stateNode}function s1(){return null}return o.attemptContinuousHydration=function(vt){if(vt.tag===13){var yt=Al();$l(vt,134217728,yt),Il(vt,134217728)}},o.attemptHydrationAtCurrentPriority=function(vt){if(vt.tag===13){var yt=Al(),Ft=du(vt);$l(vt,Ft,yt),Il(vt,Ft)}},o.attemptSynchronousHydration=function(vt){switch(vt.tag){case 3:var yt=vt.stateNode;if(yt.current.memoizedState.isDehydrated){var Ft=fs(yt.pendingLanes);Ft!==0&&(Er(yt,Ft|1),Cl(yt,Vr()),!(Ds&6)&&(pp(),Jl()))}break;case 13:var Nt=Al();Pt(function(){return $l(vt,1,Nt)}),Il(vt,1)}},o.batchedUpdates=function(vt,yt){var Ft=Ds;Ds|=1;try{return vt(yt)}finally{Ds=Ft,Ds===0&&(pp(),Au&&Jl())}},o.createComponentSelector=function(vt){return{$$typeof:Yu,value:vt}},o.createContainer=function(vt,yt,Ft,Nt,Xt,en,zn){return po(vt,yt,!1,null,Ft,Nt,Xt,en,zn)},o.createHasPseudoClassSelector=function(vt){return{$$typeof:Tm,value:vt}},o.createHydrationContainer=function(vt,yt,Ft,Nt,Xt,en,zn,ir,yr){return vt=po(Ft,Nt,!0,vt,Xt,en,zn,ir,yr),vt.context=zo(null),Ft=vt.current,Nt=Al(),Xt=du(Ft),en=_c(Nt,Xt),en.callback=yt??null,eu(Ft,en),vt.current.lanes=Xt,Fn(vt,Xt,Nt),Cl(vt,Nt),vt},o.createPortal=function(vt,yt,Ft){var Nt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:it,key:Nt==null?null:""+Nt,children:vt,containerInfo:yt,implementation:Ft}},o.createRoleSelector=function(vt){return{$$typeof:Co,value:vt}},o.createTestNameSelector=function(vt){return{$$typeof:Ru,value:vt}},o.createTextSelector=function(vt){return{$$typeof:Mm,value:vt}},o.deferredUpdates=function(vt){var yt=Tr,Ft=vo.transition;try{return vo.transition=null,Tr=16,vt()}finally{Tr=yt,vo.transition=Ft}},o.discreteUpdates=function(vt,yt,Ft,Nt,Xt){var en=Tr,zn=vo.transition;try{return vo.transition=null,Tr=1,vt(yt,Ft,Nt,Xt)}finally{Tr=en,vo.transition=zn,Ds===0&&pp()}},o.findAllNodes=Op,o.findBoundingRects=function(vt,yt){if(!or)throw Error(tt(363));yt=Op(vt,yt),vt=[];for(var Ft=0;Ft<yt.length;Ft++)vt.push($n(yt[Ft]));for(yt=vt.length-1;0<yt;yt--){Ft=vt[yt];for(var Nt=Ft.x,Xt=Nt+Ft.width,en=Ft.y,zn=en+Ft.height,ir=yt-1;0<=ir;ir--)if(yt!==ir){var yr=vt[ir],Nr=yr.x,os=Nr+yr.width,Ls=yr.y,_s=Ls+yr.height;if(Nt>=Nr&&en>=Ls&&Xt<=os&&zn<=_s){vt.splice(yt,1);break}else if(Nt!==Nr||Ft.width!==yr.width||_s<en||Ls>zn){if(!(en!==Ls||Ft.height!==yr.height||os<Nt||Nr>Xt)){Nr>Nt&&(yr.width+=Nr-Nt,yr.x=Nt),os<Xt&&(yr.width=Xt-Nr),vt.splice(yt,1);break}}else{Ls>en&&(yr.height+=Ls-en,yr.y=en),_s<zn&&(yr.height=zn-Ls),vt.splice(yt,1);break}}}return vt},o.findHostInstance=Ml,o.findHostInstanceWithNoPortals=function(vt){return vt=Ut(vt),vt=vt!==null?Jt(vt):null,vt===null?null:vt.stateNode},o.findHostInstanceWithWarning=function(vt){return Ml(vt)},o.flushControlled=function(vt){var yt=Ds;Ds|=1;var Ft=vo.transition,Nt=Tr;try{vo.transition=null,Tr=1,vt()}finally{Tr=Nt,vo.transition=Ft,Ds=yt,Ds===0&&(pp(),Jl())}},o.flushPassiveEffects=Wr,o.flushSync=Pt,o.focusWithin=function(vt,yt){if(!or)throw Error(tt(363));for(vt=c0(vt),yt=El(vt,yt),yt=Array.from(yt),vt=0;vt<yt.length;){var Ft=yt[vt++];if(!$t(Ft)){if(Ft.tag===5&&En(Ft.stateNode))return!0;for(Ft=Ft.child;Ft!==null;)yt.push(Ft),Ft=Ft.sibling}}return!1},o.getCurrentUpdatePriority=function(){return Tr},o.getFindAllNodesFailureDescription=function(vt,yt){if(!or)throw Error(tt(363));var Ft=0,Nt=[];vt=[c0(vt),0];for(var Xt=0;Xt<vt.length;){var en=vt[Xt++],zn=vt[Xt++],ir=yt[zn];if((en.tag!==5||!$t(en))&&(xu(en,ir)&&(Nt.push(wm(ir)),zn++,zn>Ft&&(Ft=zn)),zn<yt.length))for(en=en.child;en!==null;)vt.push(en,zn),en=en.sibling}if(Ft<yt.length){for(vt=[];Ft<yt.length;Ft++)vt.push(wm(yt[Ft]));return`findAllNodes was able to match part of the selector:
  `+(Nt.join(" > ")+`

No matching component was found for:
  `)+vt.join(" > ")}return null},o.getPublicRootInstance=function(vt){if(vt=vt.current,!vt.child)return null;switch(vt.child.tag){case 5:return jt(vt.child.stateNode);default:return vt.child.stateNode}},o.injectIntoDevTools=function(vt){if(vt={bundleType:vt.bundleType,version:vt.version,rendererPackageName:vt.rendererPackageName,rendererConfig:vt.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nt.ReactCurrentDispatcher,findHostInstanceByFiber:p0,findFiberByHostInstance:vt.findFiberByHostInstance||s1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")vt=!1;else{var yt=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(yt.isDisabled||!yt.supportsFiber)vt=!0;else{try{Vs=yt.inject(vt),Ms=yt}catch{}vt=!!yt.checkDCE}}return vt},o.isAlreadyRendering=function(){return!1},o.observeVisibleRects=function(vt,yt,Ft,Nt){if(!or)throw Error(tt(363));vt=Op(vt,yt);var Xt=In(vt,Ft,Nt).disconnect;return{disconnect:function(){Xt()}}},o.registerMutableSourceForHydration=function(vt,yt){var Ft=yt._getVersion;Ft=Ft(yt._source),vt.mutableSourceEagerHydrationData==null?vt.mutableSourceEagerHydrationData=[yt,Ft]:vt.mutableSourceEagerHydrationData.push(yt,Ft)},o.runWithPriority=function(vt,yt){var Ft=Tr;try{return Tr=vt,yt()}finally{Tr=Ft}},o.shouldError=function(){return null},o.shouldSuspend=function(){return!1},o.updateContainer=function(vt,yt,Ft,Nt){var Xt=yt.current,en=Al(),zn=du(Xt);return Ft=zo(Ft),yt.context===null?yt.context=Ft:yt.pendingContext=Ft,yt=_c(en,zn),yt.payload={element:vt},Nt=Nt===void 0?null:Nt,Nt!==null&&(yt.callback=Nt),eu(Xt,yt),vt=$l(Xt,zn,en),vt!==null&&Sp(vt,Xt,zn),zn},o};(function(a){a.exports=reactReconciler_production_min})(reactReconciler);const Reconciler=getDefaultExportFromCjs(reactReconcilerExports),isPromise=a=>typeof a=="object"&&typeof a.then=="function",globalCache=[];function shallowEqualArrays(a,s,o=(j,$)=>j===$){if(a===s)return!0;if(!a||!s)return!1;const j=a.length;if(s.length!==j)return!1;for(let $=0;$<j;$++)if(!o(a[$],s[$]))return!1;return!0}function query(a,s=null,o=!1,j={}){s===null&&(s=[a]);for(const _e of globalCache)if(shallowEqualArrays(s,_e.keys,_e.equal)){if(o)return;if(Object.prototype.hasOwnProperty.call(_e,"error"))throw _e.error;if(Object.prototype.hasOwnProperty.call(_e,"response"))return j.lifespan&&j.lifespan>0&&(_e.timeout&&clearTimeout(_e.timeout),_e.timeout=setTimeout(_e.remove,j.lifespan)),_e.response;if(!o)throw _e.promise}const $={keys:s,equal:j.equal,remove:()=>{const _e=globalCache.indexOf($);_e!==-1&&globalCache.splice(_e,1)},promise:(isPromise(a)?a:a(...s)).then(_e=>{$.response=_e,j.lifespan&&j.lifespan>0&&($.timeout=setTimeout($.remove,j.lifespan))}).catch(_e=>$.error=_e)};if(globalCache.push($),!o)throw $.promise}const suspend=(a,s,o)=>query(a,s,!1,o),preload=(a,s,o)=>void query(a,s,!0,o),clear=a=>{if(a===void 0||a.length===0)globalCache.splice(0,globalCache.length);else{const s=globalCache.find(o=>shallowEqualArrays(a,o.keys,o.equal));s&&s.remove()}},catalogue={},extend=a=>void Object.assign(catalogue,a);function createRenderer(a,s){function o(st,{args:at=[],attach:ot,...ct},ft){let ht=`${st[0].toUpperCase()}${st.slice(1)}`,mt;if(st==="primitive"){if(ct.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const lt=ct.object;mt=prepare$1(lt,{type:st,root:ft,attach:ot,primitive:!0})}else{const lt=catalogue[ht];if(!lt)throw new Error(`R3F: ${ht} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(at))throw new Error("R3F: The args prop must be an array!");mt=prepare$1(new lt(...at),{type:st,root:ft,attach:ot,memoizedProps:{args:at}})}return mt.__r3f.attach===void 0&&(mt instanceof BufferGeometry?mt.__r3f.attach="geometry":mt instanceof Material&&(mt.__r3f.attach="material")),ht!=="inject"&&applyProps$1(mt,ct),mt}function j(st,at){let ot=!1;if(at){var ct,ft;(ct=at.__r3f)!=null&&ct.attach?attach(st,at,at.__r3f.attach):at.isObject3D&&st.isObject3D&&(st.add(at),ot=!0),ot||(ft=st.__r3f)==null||ft.objects.push(at),at.__r3f||prepare$1(at,{}),at.__r3f.parent=st,updateInstance(at),invalidateInstance(at)}}function $(st,at,ot){let ct=!1;if(at){var ft,ht;if((ft=at.__r3f)!=null&&ft.attach)attach(st,at,at.__r3f.attach);else if(at.isObject3D&&st.isObject3D){at.parent=st,at.dispatchEvent({type:"added"});const mt=st.children.filter(ut=>ut!==at),lt=mt.indexOf(ot);st.children=[...mt.slice(0,lt),at,...mt.slice(lt)],ct=!0}ct||(ht=st.__r3f)==null||ht.objects.push(at),at.__r3f||prepare$1(at,{}),at.__r3f.parent=st,updateInstance(at),invalidateInstance(at)}}function _e(st,at,ot=!1){st&&[...st].forEach(ct=>tt(at,ct,ot))}function tt(st,at,ot){if(at){var ct,ft,ht;if(at.__r3f&&(at.__r3f.parent=null),(ct=st.__r3f)!=null&&ct.objects&&(st.__r3f.objects=st.__r3f.objects.filter(gt=>gt!==at)),(ft=at.__r3f)!=null&&ft.attach)detach(st,at,at.__r3f.attach);else if(at.isObject3D&&st.isObject3D){var mt;st.remove(at),(mt=at.__r3f)!=null&&mt.root&&removeInteractivity(at.__r3f.root,at)}const ut=(ht=at.__r3f)==null?void 0:ht.primitive,dt=ot===void 0?at.dispose!==null&&!ut:ot;if(!ut){var lt;_e((lt=at.__r3f)==null?void 0:lt.objects,at,dt),_e(at.children,at,dt)}delete at.__r3f,dt&&at.dispose&&at.type!=="Scene"&&schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,()=>{try{at.dispose()}catch{}}),invalidateInstance(st)}}function nt(st,at,ot,ct){var ft;const ht=(ft=st.__r3f)==null?void 0:ft.parent;if(!ht)return;const mt=o(at,ot,st.__r3f.root);if(st.children){for(const lt of st.children)lt.__r3f&&j(mt,lt);st.children=st.children.filter(lt=>!lt.__r3f)}st.__r3f.objects.forEach(lt=>j(mt,lt)),st.__r3f.objects=[],st.__r3f.autoRemovedBeforeAppend||tt(ht,st),mt.parent&&(mt.__r3f.autoRemovedBeforeAppend=!0),j(ht,mt),mt.raycast&&mt.__r3f.eventCount&&mt.__r3f.root.getState().internal.interaction.push(mt),[ct,ct.alternate].forEach(lt=>{lt!==null&&(lt.stateNode=mt,lt.ref&&(typeof lt.ref=="function"?lt.ref(mt):lt.ref.current=mt))})}const rt=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:o,removeChild:tt,appendChild:j,appendInitialChild:j,insertBefore:$,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(st,at)=>{if(!at)return;const ot=st.getState().scene;ot.__r3f&&(ot.__r3f.root=st,j(ot,at))},removeChildFromContainer:(st,at)=>{at&&tt(st.getState().scene,at)},insertInContainerBefore:(st,at,ot)=>{if(!at||!ot)return;const ct=st.getState().scene;ct.__r3f&&$(ct,at,ot)},getRootHostContext:()=>null,getChildHostContext:st=>st,finalizeInitialChildren(st){var at;const ot=(at=st==null?void 0:st.__r3f)!=null?at:{};return Boolean(ot.handlers)},prepareUpdate(st,at,ot,ct){if(st.__r3f.primitive&&ct.object&&ct.object!==st)return[!0];{const{args:ft=[],children:ht,...mt}=ct,{args:lt=[],children:ut,...dt}=ot;if(!Array.isArray(ft))throw new Error("R3F: the args prop must be an array!");if(ft.some((Et,St)=>Et!==lt[St]))return[!0];const gt=diffProps(st,mt,dt,!0);return gt.changes.length?[!1,gt]:null}},commitUpdate(st,[at,ot],ct,ft,ht,mt){at?nt(st,ct,ht,mt):applyProps$1(st,ot)},commitMount(st,at,ot,ct){var ft;const ht=(ft=st.__r3f)!=null?ft:{};st.raycast&&ht.handlers&&ht.eventCount&&st.__r3f.root.getState().internal.interaction.push(st)},getPublicInstance:st=>st,prepareForCommit:()=>null,preparePortalMount:st=>prepare$1(st.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(st){var at;const{attach:ot,parent:ct}=(at=st.__r3f)!=null?at:{};ot&&ct&&detach(ct,st,ot),st.isObject3D&&(st.visible=!1),invalidateInstance(st)},unhideInstance(st,at){var ot;const{attach:ct,parent:ft}=(ot=st.__r3f)!=null?ot:{};ct&&ft&&attach(ft,st,ct),(st.isObject3D&&at.visible==null||at.visible)&&(st.visible=!0),invalidateInstance(st)},createTextInstance:rt,hideTextInstance:rt,unhideTextInstance:rt,getCurrentEventPriority:()=>s?s():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is.fun(performance.now)?performance.now:is.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const hasColorSpace$1=a=>"colorSpace"in a||"outputColorSpace"in a,getColorManagement=()=>{var a;return(a=catalogue.ColorManagement)!=null?a:null},isOrthographicCamera=a=>a&&a.isOrthographicCamera,isRef$1=a=>a&&a.hasOwnProperty("current"),useIsomorphicLayoutEffect=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(a){const s=reactExports.useRef(a);return useIsomorphicLayoutEffect(()=>void(s.current=a),[a]),s}function Block({set:a}){return useIsomorphicLayoutEffect(()=>(a(new Promise(()=>null)),()=>a(!1)),[a]),null}class ErrorBoundary extends reactExports.Component{constructor(...s){super(...s),this.state={error:!1}}componentDidCatch(s){this.props.set(s)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=a=>a&&!!a.memoized&&!!a.changes;function calculateDpr(a){var s;const o=typeof window<"u"?(s=window.devicePixelRatio)!=null?s:2:1;return Array.isArray(a)?Math.min(Math.max(a[0],o),a[1]):a}const getRootState=a=>{var s;return(s=a.__r3f)==null?void 0:s.root.getState()},is={obj:a=>a===Object(a)&&!is.arr(a)&&typeof a!="function",fun:a=>typeof a=="function",str:a=>typeof a=="string",num:a=>typeof a=="number",boo:a=>typeof a=="boolean",und:a=>a===void 0,arr:a=>Array.isArray(a),equ(a,s,{arrays:o="shallow",objects:j="reference",strict:$=!0}={}){if(typeof a!=typeof s||!!a!=!!s)return!1;if(is.str(a)||is.num(a))return a===s;const _e=is.obj(a);if(_e&&j==="reference")return a===s;const tt=is.arr(a);if(tt&&o==="reference")return a===s;if((tt||_e)&&a===s)return!0;let nt;for(nt in a)if(!(nt in s))return!1;if(_e&&o==="shallow"&&j==="shallow"){for(nt in $?s:a)if(!is.equ(a[nt],s[nt],{strict:$,objects:"reference"}))return!1}else for(nt in $?s:a)if(a[nt]!==s[nt])return!1;if(is.und(nt)){if(tt&&a.length===0&&s.length===0||_e&&Object.keys(a).length===0&&Object.keys(s).length===0)return!0;if(a!==s)return!1}return!0}};function buildGraph(a){const s={nodes:{},materials:{}};return a&&a.traverse(o=>{o.name&&(s.nodes[o.name]=o),o.material&&!s.materials[o.material.name]&&(s.materials[o.material.name]=o.material)}),s}function dispose(a){a.dispose&&a.type!=="Scene"&&a.dispose();for(const s in a)s.dispose==null||s.dispose(),delete a[s]}function prepare$1(a,s){const o=a;return(s!=null&&s.primitive||!o.__r3f)&&(o.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...s}),a}function resolve(a,s){let o=a;if(s.includes("-")){const j=s.split("-"),$=j.pop();return o=j.reduce((_e,tt)=>_e[tt],a),{target:o,key:$}}else return{target:o,key:s}}const INDEX_REGEX=/-\d+$/;function attach(a,s,o){if(is.str(o)){if(INDEX_REGEX.test(o)){const _e=o.replace(INDEX_REGEX,""),{target:tt,key:nt}=resolve(a,_e);Array.isArray(tt[nt])||(tt[nt]=[])}const{target:j,key:$}=resolve(a,o);s.__r3f.previousAttach=j[$],j[$]=s}else s.__r3f.previousAttach=o(a,s)}function detach(a,s,o){var j,$;if(is.str(o)){const{target:_e,key:tt}=resolve(a,o),nt=s.__r3f.previousAttach;nt===void 0?delete _e[tt]:_e[tt]=nt}else(j=s.__r3f)==null||j.previousAttach==null||j.previousAttach(a,s);($=s.__r3f)==null||delete $.previousAttach}function diffProps(a,{children:s,key:o,ref:j,...$},{children:_e,key:tt,ref:nt,...rt}={},it=!1){var st;const at=(st=a==null?void 0:a.__r3f)!=null?st:{},ot=Object.entries($),ct=[];if(it){const ht=Object.keys(rt);for(let mt=0;mt<ht.length;mt++)$.hasOwnProperty(ht[mt])||ot.unshift([ht[mt],DEFAULT+"remove"])}ot.forEach(([ht,mt])=>{var lt;if((lt=a.__r3f)!=null&&lt.primitive&&ht==="object"||is.equ(mt,rt[ht]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(ht))return ct.push([ht,mt,!0,[]]);let ut=[];ht.includes("-")&&(ut=ht.split("-")),ct.push([ht,mt,!1,ut]);for(const dt in $){const gt=$[dt];dt.startsWith(`${ht}-`)&&ct.push([dt,gt,!1,dt.split("-")])}});const ft={...$};return at.memoizedProps&&at.memoizedProps.args&&(ft.args=at.memoizedProps.args),at.memoizedProps&&at.memoizedProps.attach&&(ft.attach=at.memoizedProps.attach),{memoized:ft,changes:ct}}function applyProps$1(a,s){var o,j,$;const _e=(o=a.__r3f)!=null?o:{},tt=_e.root,nt=(j=tt==null||tt.getState==null?void 0:tt.getState())!=null?j:{},{memoized:rt,changes:it}=isDiffSet(s)?s:diffProps(a,s),st=_e.eventCount;a.__r3f&&(a.__r3f.memoizedProps=rt);for(let ot=0;ot<it.length;ot++){let[ct,ft,ht,mt]=it[ot];if(hasColorSpace$1(a)){const gt="srgb",Et="srgb-linear";ct==="encoding"?(ct="colorSpace",ft=ft===3001?gt:Et):ct==="outputEncoding"&&(ct="outputColorSpace",ft=ft===3001?gt:Et)}let lt=a,ut=lt[ct];if(mt.length&&(ut=mt.reduce((dt,gt)=>dt[gt],a),!(ut&&ut.set))){const[dt,...gt]=mt.reverse();lt=gt.reverse().reduce((Et,St)=>Et[St],a),ct=dt}if(ft===DEFAULT+"remove")if(lt.constructor){let dt=DEFAULTS.get(lt.constructor);dt||(dt=new lt.constructor,DEFAULTS.set(lt.constructor,dt)),ft=dt[ct]}else ft=0;if(ht)ft?_e.handlers[ct]=ft:delete _e.handlers[ct],_e.eventCount=Object.keys(_e.handlers).length;else if(ut&&ut.set&&(ut.copy||ut instanceof Layers)){if(Array.isArray(ft))ut.fromArray?ut.fromArray(ft):ut.set(...ft);else if(ut.copy&&ft&&ft.constructor&&ut.constructor===ft.constructor)ut.copy(ft);else if(ft!==void 0){const dt=ut instanceof Color;!dt&&ut.setScalar?ut.setScalar(ft):ut instanceof Layers&&ft instanceof Layers?ut.mask=ft.mask:ut.set(ft),!getColorManagement()&&!nt.linear&&dt&&ut.convertSRGBToLinear()}}else if(lt[ct]=ft,lt[ct]instanceof Texture&&lt[ct].format===RGBAFormat&&lt[ct].type===UnsignedByteType){const dt=lt[ct];hasColorSpace$1(dt)&&hasColorSpace$1(nt.gl)?dt.colorSpace=nt.gl.outputColorSpace:dt.encoding=nt.gl.outputEncoding}invalidateInstance(a)}if(_e.parent&&nt.internal&&a.raycast&&st!==_e.eventCount){const ot=nt.internal.interaction.indexOf(a);ot>-1&&nt.internal.interaction.splice(ot,1),_e.eventCount&&nt.internal.interaction.push(a)}return!(it.length===1&&it[0][0]==="onUpdate")&&it.length&&($=a.__r3f)!=null&&$.parent&&updateInstance(a),a}function invalidateInstance(a){var s,o;const j=(s=a.__r3f)==null||(o=s.root)==null||o.getState==null?void 0:o.getState();j&&j.internal.frames===0&&j.invalidate()}function updateInstance(a){a.onUpdate==null||a.onUpdate(a)}function updateCamera(a,s){a.manual||(isOrthographicCamera(a)?(a.left=s.width/-2,a.right=s.width/2,a.top=s.height/2,a.bottom=s.height/-2):a.aspect=s.width/s.height,a.updateProjectionMatrix(),a.updateMatrixWorld())}function makeId(a){return(a.eventObject||a.object).uuid+"/"+a.index+a.instanceId}function getEventPriority(){var a;const s=typeof self<"u"&&self||typeof window<"u"&&window;if(!s)return constantsExports.DefaultEventPriority;switch((a=s.event)==null?void 0:a.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(a,s,o,j){const $=o.get(s);$&&(o.delete(s),o.size===0&&(a.delete(j),$.target.releasePointerCapture(j)))}function removeInteractivity(a,s){const{internal:o}=a.getState();o.interaction=o.interaction.filter(j=>j!==s),o.initialHits=o.initialHits.filter(j=>j!==s),o.hovered.forEach((j,$)=>{(j.eventObject===s||j.object===s)&&o.hovered.delete($)}),o.capturedMap.forEach((j,$)=>{releaseInternalPointerCapture(o.capturedMap,s,j,$)})}function createEvents(a){function s(rt){const{internal:it}=a.getState(),st=rt.offsetX-it.initialClick[0],at=rt.offsetY-it.initialClick[1];return Math.round(Math.sqrt(st*st+at*at))}function o(rt){return rt.filter(it=>["Move","Over","Enter","Out","Leave"].some(st=>{var at;return(at=it.__r3f)==null?void 0:at.handlers["onPointer"+st]}))}function j(rt,it){const st=a.getState(),at=new Set,ot=[],ct=it?it(st.internal.interaction):st.internal.interaction;for(let lt=0;lt<ct.length;lt++){const ut=getRootState(ct[lt]);ut&&(ut.raycaster.camera=void 0)}st.previousRoot||st.events.compute==null||st.events.compute(rt,st);function ft(lt){const ut=getRootState(lt);if(!ut||!ut.events.enabled||ut.raycaster.camera===null)return[];if(ut.raycaster.camera===void 0){var dt;ut.events.compute==null||ut.events.compute(rt,ut,(dt=ut.previousRoot)==null?void 0:dt.getState()),ut.raycaster.camera===void 0&&(ut.raycaster.camera=null)}return ut.raycaster.camera?ut.raycaster.intersectObject(lt,!0):[]}let ht=ct.flatMap(ft).sort((lt,ut)=>{const dt=getRootState(lt.object),gt=getRootState(ut.object);return!dt||!gt?lt.distance-ut.distance:gt.events.priority-dt.events.priority||lt.distance-ut.distance}).filter(lt=>{const ut=makeId(lt);return at.has(ut)?!1:(at.add(ut),!0)});st.events.filter&&(ht=st.events.filter(ht,st));for(const lt of ht){let ut=lt.object;for(;ut;){var mt;(mt=ut.__r3f)!=null&&mt.eventCount&&ot.push({...lt,eventObject:ut}),ut=ut.parent}}if("pointerId"in rt&&st.internal.capturedMap.has(rt.pointerId))for(let lt of st.internal.capturedMap.get(rt.pointerId).values())at.has(makeId(lt.intersection))||ot.push(lt.intersection);return ot}function $(rt,it,st,at){const ot=a.getState();if(rt.length){const ct={stopped:!1};for(const ft of rt){const ht=getRootState(ft.object)||ot,{raycaster:mt,pointer:lt,camera:ut,internal:dt}=ht,gt=new Vector3(lt.x,lt.y,0).unproject(ut),Et=Rt=>{var Ut,Ht;return(Ut=(Ht=dt.capturedMap.get(Rt))==null?void 0:Ht.has(ft.eventObject))!=null?Ut:!1},St=Rt=>{const Ut={intersection:ft,target:it.target};dt.capturedMap.has(Rt)?dt.capturedMap.get(Rt).set(ft.eventObject,Ut):dt.capturedMap.set(Rt,new Map([[ft.eventObject,Ut]])),it.target.setPointerCapture(Rt)},Tt=Rt=>{const Ut=dt.capturedMap.get(Rt);Ut&&releaseInternalPointerCapture(dt.capturedMap,ft.eventObject,Ut,Rt)};let Mt={};for(let Rt in it){let Ut=it[Rt];typeof Ut!="function"&&(Mt[Rt]=Ut)}let Bt={...ft,...Mt,pointer:lt,intersections:rt,stopped:ct.stopped,delta:st,unprojectedPoint:gt,ray:mt.ray,camera:ut,stopPropagation(){const Rt="pointerId"in it&&dt.capturedMap.get(it.pointerId);if((!Rt||Rt.has(ft.eventObject))&&(Bt.stopped=ct.stopped=!0,dt.hovered.size&&Array.from(dt.hovered.values()).find(Ut=>Ut.eventObject===ft.eventObject))){const Ut=rt.slice(0,rt.indexOf(ft));_e([...Ut,ft])}},target:{hasPointerCapture:Et,setPointerCapture:St,releasePointerCapture:Tt},currentTarget:{hasPointerCapture:Et,setPointerCapture:St,releasePointerCapture:Tt},nativeEvent:it};if(at(Bt),ct.stopped===!0)break}}return rt}function _e(rt){const{internal:it}=a.getState();for(const st of it.hovered.values())if(!rt.length||!rt.find(at=>at.object===st.object&&at.index===st.index&&at.instanceId===st.instanceId)){const ot=st.eventObject.__r3f,ct=ot==null?void 0:ot.handlers;if(it.hovered.delete(makeId(st)),ot!=null&&ot.eventCount){const ft={...st,intersections:rt};ct.onPointerOut==null||ct.onPointerOut(ft),ct.onPointerLeave==null||ct.onPointerLeave(ft)}}}function tt(rt,it){for(let st=0;st<it.length;st++){const at=it[st].__r3f;at==null||at.handlers.onPointerMissed==null||at.handlers.onPointerMissed(rt)}}function nt(rt){switch(rt){case"onPointerLeave":case"onPointerCancel":return()=>_e([]);case"onLostPointerCapture":return it=>{const{internal:st}=a.getState();"pointerId"in it&&st.capturedMap.has(it.pointerId)&&requestAnimationFrame(()=>{st.capturedMap.has(it.pointerId)&&(st.capturedMap.delete(it.pointerId),_e([]))})}}return function(st){const{onPointerMissed:at,internal:ot}=a.getState();ot.lastEvent.current=st;const ct=rt==="onPointerMove",ft=rt==="onClick"||rt==="onContextMenu"||rt==="onDoubleClick",mt=j(st,ct?o:void 0),lt=ft?s(st):0;rt==="onPointerDown"&&(ot.initialClick=[st.offsetX,st.offsetY],ot.initialHits=mt.map(dt=>dt.eventObject)),ft&&!mt.length&&lt<=2&&(tt(st,ot.interaction),at&&at(st)),ct&&_e(mt);function ut(dt){const gt=dt.eventObject,Et=gt.__r3f,St=Et==null?void 0:Et.handlers;if(Et!=null&&Et.eventCount)if(ct){if(St.onPointerOver||St.onPointerEnter||St.onPointerOut||St.onPointerLeave){const Tt=makeId(dt),Mt=ot.hovered.get(Tt);Mt?Mt.stopped&&dt.stopPropagation():(ot.hovered.set(Tt,dt),St.onPointerOver==null||St.onPointerOver(dt),St.onPointerEnter==null||St.onPointerEnter(dt))}St.onPointerMove==null||St.onPointerMove(dt)}else{const Tt=St[rt];Tt?(!ft||ot.initialHits.includes(gt))&&(tt(st,ot.interaction.filter(Mt=>!ot.initialHits.includes(Mt))),Tt(dt)):ft&&ot.initialHits.includes(gt)&&tt(st,ot.interaction.filter(Mt=>!ot.initialHits.includes(Mt)))}}$(mt,st,lt,ut)}}return{handlePointer:nt}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=a=>!!(a!=null&&a.render),context$1=reactExports.createContext(null),createStore=(a,s)=>{const o=create((nt,rt)=>{const it=new Vector3,st=new Vector3,at=new Vector3;function ot(lt=rt().camera,ut=st,dt=rt().size){const{width:gt,height:Et,top:St,left:Tt}=dt,Mt=gt/Et;ut instanceof Vector3?at.copy(ut):at.set(...ut);const Bt=lt.getWorldPosition(it).distanceTo(at);if(isOrthographicCamera(lt))return{width:gt/lt.zoom,height:Et/lt.zoom,top:St,left:Tt,factor:1,distance:Bt,aspect:Mt};{const Rt=lt.fov*Math.PI/180,Ut=2*Math.tan(Rt/2)*Bt,Ht=Ut*(gt/Et);return{width:Ht,height:Ut,top:St,left:Tt,factor:gt/Ht,distance:Bt,aspect:Mt}}}let ct;const ft=lt=>nt(ut=>({performance:{...ut.performance,current:lt}})),ht=new Vector2;return{set:nt,get:rt,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(lt=1)=>a(rt(),lt),advance:(lt,ut)=>s(lt,ut,rt()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock,pointer:ht,mouse:ht,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const lt=rt();ct&&clearTimeout(ct),lt.performance.current!==lt.performance.min&&ft(lt.performance.min),ct=setTimeout(()=>ft(rt().performance.max),lt.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:ot},setEvents:lt=>nt(ut=>({...ut,events:{...ut.events,...lt}})),setSize:(lt,ut,dt,gt,Et)=>{const St=rt().camera,Tt={width:lt,height:ut,top:gt||0,left:Et||0,updateStyle:dt};nt(Mt=>({size:Tt,viewport:{...Mt.viewport,...ot(St,st,Tt)}}))},setDpr:lt=>nt(ut=>{const dt=calculateDpr(lt);return{viewport:{...ut.viewport,dpr:dt,initialDpr:ut.viewport.initialDpr||dt}}}),setFrameloop:(lt="always")=>{const ut=rt().clock;ut.stop(),ut.elapsedTime=0,lt!=="never"&&(ut.start(),ut.elapsedTime=0),nt(()=>({frameloop:lt}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(lt,ut,dt)=>{const gt=rt().internal;return gt.priority=gt.priority+(ut>0?1:0),gt.subscribers.push({ref:lt,priority:ut,store:dt}),gt.subscribers=gt.subscribers.sort((Et,St)=>Et.priority-St.priority),()=>{const Et=rt().internal;Et!=null&&Et.subscribers&&(Et.priority=Et.priority-(ut>0?1:0),Et.subscribers=Et.subscribers.filter(St=>St.ref!==lt))}}}}}),j=o.getState();let $=j.size,_e=j.viewport.dpr,tt=j.camera;return o.subscribe(()=>{const{camera:nt,size:rt,viewport:it,gl:st,set:at}=o.getState();if(rt!==$||it.dpr!==_e){var ot;$=rt,_e=it.dpr,updateCamera(nt,rt),st.setPixelRatio(it.dpr);const ct=(ot=rt.updateStyle)!=null?ot:typeof HTMLCanvasElement<"u"&&st.domElement instanceof HTMLCanvasElement;st.setSize(rt.width,rt.height,ct)}nt!==tt&&(tt=nt,at(ct=>({viewport:{...ct.viewport,...ct.viewport.getCurrentViewport(nt)}})))}),o.subscribe(nt=>a(nt)),o};let i$1,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;function run(a,s){if(a.size)for(const{callback:o}of a.values())o(s)}function flushGlobalEffects(a,s){switch(a){case"before":return run(globalEffects,s);case"after":return run(globalAfterEffects,s);case"tail":return run(globalTailEffects,s)}}let subscribers,subscription;function render$1(a,s,o){let j=s.clock.getDelta();for(s.frameloop==="never"&&typeof a=="number"&&(j=a-s.clock.elapsedTime,s.clock.oldTime=s.clock.elapsedTime,s.clock.elapsedTime=a),subscribers=s.internal.subscribers,i$1=0;i$1<subscribers.length;i$1++)subscription=subscribers[i$1],subscription.ref.current(subscription.store.getState(),j,o);return!s.internal.priority&&s.gl.render&&s.gl.render(s.scene,s.camera),s.internal.frames=Math.max(0,s.internal.frames-1),s.frameloop==="always"?1:s.internal.frames}function createLoop(a){let s=!1,o,j,$;function _e(rt){j=requestAnimationFrame(_e),s=!0,o=0,flushGlobalEffects("before",rt);for(const st of a.values()){var it;$=st.store.getState(),$.internal.active&&($.frameloop==="always"||$.internal.frames>0)&&!((it=$.gl.xr)!=null&&it.isPresenting)&&(o+=render$1(rt,$))}if(flushGlobalEffects("after",rt),o===0)return flushGlobalEffects("tail",rt),s=!1,cancelAnimationFrame(j)}function tt(rt,it=1){var st;if(!rt)return a.forEach(at=>tt(at.store.getState()),it);(st=rt.gl.xr)!=null&&st.isPresenting||!rt.internal.active||rt.frameloop==="never"||(rt.internal.frames=Math.min(60,rt.internal.frames+it),s||(s=!0,requestAnimationFrame(_e)))}function nt(rt,it=!0,st,at){if(it&&flushGlobalEffects("before",rt),st)render$1(rt,st,at);else for(const ot of a.values())render$1(rt,ot.store.getState());it&&flushGlobalEffects("after",rt)}return{loop:_e,invalidate:tt,advance:nt}}function useStore(){const a=reactExports.useContext(context$1);if(!a)throw new Error("R3F: Hooks can only be used within the Canvas component!");return a}function useThree(a=o=>o,s){return useStore()(a,s)}function useFrame(a,s=0){const o=useStore(),j=o.getState().internal.subscribe,$=useMutableCallback(a);return useIsomorphicLayoutEffect(()=>j($,s,o),[s,j,o]),null}function loadingFn(a,s){return function(o,...j){const $=new o;return a&&a($),Promise.all(j.map(_e=>new Promise((tt,nt)=>$.load(_e,rt=>{rt.scene&&Object.assign(rt,buildGraph(rt.scene)),tt(rt)},s,rt=>nt(new Error(`Could not load ${_e}: ${rt.message})`))))))}}function useLoader(a,s,o,j){const $=Array.isArray(s)?s:[s],_e=suspend(loadingFn(o,j),[a,...$],{equal:is.equ});return Array.isArray(s)?_e:_e[0]}useLoader.preload=function(a,s,o){const j=Array.isArray(s)?s:[s];return preload(loadingFn(o),[a,...j])};useLoader.clear=function(a,s){const o=Array.isArray(s)?s:[s];return clear([a,...o])};const roots=new Map,{invalidate,advance}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(a,s)=>{const o=typeof a=="function"?a(s):a;return isRenderer(o)?o:new WebGLRenderer({powerPreference:"high-performance",canvas:s,antialias:!0,alpha:!0,...a})};function computeInitialSize(a,s){if(s)return s;if(typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&a.parentElement){const{width:o,height:j,top:$,left:_e}=a.parentElement.getBoundingClientRect();return{width:o,height:j,top:$,left:_e}}else if(typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas)return{width:a.width,height:a.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function createRoot(a){const s=roots.get(a),o=s==null?void 0:s.fiber,j=s==null?void 0:s.store;s&&console.warn("R3F.createRoot should only be called once!");const $=typeof reportError=="function"?reportError:console.error,_e=j||createStore(invalidate,advance),tt=o||reconciler.createContainer(_e,constantsExports.ConcurrentRoot,null,!1,null,"",$,null);s||roots.set(a,{fiber:tt,store:_e});let nt,rt=!1,it;return{configure(st={}){let{gl:at,size:ot,scene:ct,events:ft,onCreated:ht,shadows:mt=!1,linear:lt=!1,flat:ut=!1,legacy:dt=!1,orthographic:gt=!1,frameloop:Et="always",dpr:St=[1,2],performance:Tt,raycaster:Mt,camera:Bt,onPointerMissed:Rt}=st,Ut=_e.getState(),Ht=Ut.gl;Ut.gl||Ut.set({gl:Ht=createRendererInstance(at,a)});let Wt=Ut.raycaster;Wt||Ut.set({raycaster:Wt=new Raycaster});const{params:Jt,...sn}=Mt||{};if(is.equ(sn,Wt,shallowLoose)||applyProps(Wt,{...sn}),is.equ(Jt,Wt.params,shallowLoose)||applyProps(Wt,{params:{...Wt.params,...Jt}}),!Ut.camera||Ut.camera===it&&!is.equ(it,Bt,shallowLoose)){it=Bt;const mn=Bt instanceof Camera,Zt=mn?Bt:gt?new OrthographicCamera(0,0,0,0,.1,1e3):new PerspectiveCamera(75,0,.1,1e3);mn||(Zt.position.z=5,Bt&&applyProps(Zt,Bt),!Ut.camera&&!(Bt!=null&&Bt.rotation)&&Zt.lookAt(0,0,0)),Ut.set({camera:Zt})}if(!Ut.scene){let mn;ct instanceof Scene?mn=ct:(mn=new Scene,ct&&applyProps(mn,ct)),Ut.set({scene:prepare$1(mn)})}if(!Ut.xr){const mn=(Ot,rn)=>{const fn=_e.getState();fn.frameloop!=="never"&&advance(Ot,!0,fn,rn)},Zt=()=>{const Ot=_e.getState();Ot.gl.xr.enabled=Ot.gl.xr.isPresenting,Ot.gl.xr.setAnimationLoop(Ot.gl.xr.isPresenting?mn:null),Ot.gl.xr.isPresenting||invalidate(Ot)},cn={connect(){const Ot=_e.getState().gl;Ot.xr.addEventListener("sessionstart",Zt),Ot.xr.addEventListener("sessionend",Zt)},disconnect(){const Ot=_e.getState().gl;Ot.xr.removeEventListener("sessionstart",Zt),Ot.xr.removeEventListener("sessionend",Zt)}};Ht.xr&&cn.connect(),Ut.set({xr:cn})}if(Ht.shadowMap){const mn=Ht.shadowMap.enabled,Zt=Ht.shadowMap.type;if(Ht.shadowMap.enabled=!!mt,is.boo(mt))Ht.shadowMap.type=PCFSoftShadowMap;else if(is.str(mt)){var jt;const cn={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};Ht.shadowMap.type=(jt=cn[mt])!=null?jt:PCFSoftShadowMap}else is.obj(mt)&&Object.assign(Ht.shadowMap,mt);(mn!==Ht.shadowMap.enabled||Zt!==Ht.shadowMap.type)&&(Ht.shadowMap.needsUpdate=!0)}const Vt=getColorManagement();Vt&&("enabled"in Vt?Vt.enabled=!dt:"legacyMode"in Vt&&(Vt.legacyMode=dt)),applyProps(Ht,{outputEncoding:lt?3e3:3001,toneMapping:ut?NoToneMapping:ACESFilmicToneMapping}),Ut.legacy!==dt&&Ut.set(()=>({legacy:dt})),Ut.linear!==lt&&Ut.set(()=>({linear:lt})),Ut.flat!==ut&&Ut.set(()=>({flat:ut})),at&&!is.fun(at)&&!isRenderer(at)&&!is.equ(at,Ht,shallowLoose)&&applyProps(Ht,at),ft&&!Ut.events.handlers&&Ut.set({events:ft(_e)});const nn=computeInitialSize(a,ot);return is.equ(nn,Ut.size,shallowLoose)||Ut.setSize(nn.width,nn.height,nn.updateStyle,nn.top,nn.left),St&&Ut.viewport.dpr!==calculateDpr(St)&&Ut.setDpr(St),Ut.frameloop!==Et&&Ut.setFrameloop(Et),Ut.onPointerMissed||Ut.set({onPointerMissed:Rt}),Tt&&!is.equ(Tt,Ut.performance,shallowLoose)&&Ut.set(mn=>({performance:{...mn.performance,...Tt}})),nt=ht,rt=!0,this},render(st){return rt||this.configure(),reconciler.updateContainer(reactExports.createElement(Provider,{store:_e,children:st,onCreated:nt,rootElement:a}),tt,null,()=>{}),_e},unmount(){unmountComponentAtNode(a)}}}function Provider({store:a,children:s,onCreated:o,rootElement:j}){return useIsomorphicLayoutEffect(()=>{const $=a.getState();$.set(_e=>({internal:{..._e.internal,active:!0}})),o&&o($),a.getState().events.connected||$.events.connect==null||$.events.connect(j)},[]),reactExports.createElement(context$1.Provider,{value:a},s)}function unmountComponentAtNode(a,s){const o=roots.get(a),j=o==null?void 0:o.fiber;if(j){const $=o==null?void 0:o.store.getState();$&&($.internal.active=!1),reconciler.updateContainer(null,j,null,()=>{$&&setTimeout(()=>{try{var _e,tt,nt,rt;$.events.disconnect==null||$.events.disconnect(),(_e=$.gl)==null||(tt=_e.renderLists)==null||tt.dispose==null||tt.dispose(),(nt=$.gl)==null||nt.forceContextLoss==null||nt.forceContextLoss(),(rt=$.gl)!=null&&rt.xr&&$.xr.disconnect(),dispose($),roots.delete(a),s&&s(a)}catch{}},500)})}}function createPortal(a,s,o){return reactExports.createElement(Portal,{key:s.uuid,children:a,container:s,state:o})}function Portal({state:a={},children:s,container:o}){const{events:j,size:$,..._e}=a,tt=useStore(),[nt]=reactExports.useState(()=>new Raycaster),[rt]=reactExports.useState(()=>new Vector2),it=reactExports.useCallback((at,ot)=>{const ct={...at};Object.keys(at).forEach(ht=>{(privateKeys.includes(ht)||at[ht]!==ot[ht]&&ot[ht])&&delete ct[ht]});let ft;if(ot&&$){const ht=ot.camera;ft=at.viewport.getCurrentViewport(ht,new Vector3,$),ht!==at.camera&&updateCamera(ht,$)}return{...ct,scene:o,raycaster:nt,pointer:rt,mouse:rt,previousRoot:tt,events:{...at.events,...ot==null?void 0:ot.events,...j},size:{...at.size,...$},viewport:{...at.viewport,...ft},..._e}},[a]),[st]=reactExports.useState(()=>{const at=tt.getState();return create((ct,ft)=>({...at,scene:o,raycaster:nt,pointer:rt,mouse:rt,previousRoot:tt,events:{...at.events,...j},size:{...at.size,...$},..._e,set:ct,get:ft,setEvents:ht=>ct(mt=>({...mt,events:{...mt.events,...ht}}))}))});return reactExports.useEffect(()=>{const at=tt.subscribe(ot=>st.setState(ct=>it(ot,ct)));return()=>{at(),st.destroy()}},[]),reactExports.useEffect(()=>{st.setState(at=>it(tt.getState(),at))},[it]),reactExports.createElement(reactExports.Fragment,null,reconciler.createPortal(reactExports.createElement(context$1.Provider,{value:st},s),st,null))}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var j in o)Object.prototype.hasOwnProperty.call(o,j)&&(a[j]=o[j])}return a},_extends.apply(this,arguments)}function debounce(a,s,o){var j,$,_e,tt,nt;s==null&&(s=100);function rt(){var st=Date.now()-tt;st<s&&st>=0?j=setTimeout(rt,s-st):(j=null,o||(nt=a.apply(_e,$),_e=$=null))}var it=function(){_e=this,$=arguments,tt=Date.now();var st=o&&!j;return j||(j=setTimeout(rt,s)),st&&(nt=a.apply(_e,$),_e=$=null),nt};return it.clear=function(){j&&(clearTimeout(j),j=null)},it.flush=function(){j&&(nt=a.apply(_e,$),_e=$=null,clearTimeout(j),j=null)},it}debounce.debounce=debounce;var debounce_1=debounce;function useMeasure(a){let{debounce:s,scroll:o,polyfill:j,offsetSize:$}=a===void 0?{debounce:0,scroll:!1,offsetSize:!1}:a;const _e=j||(typeof window>"u"?class{}:window.ResizeObserver);if(!_e)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[tt,nt]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),rt=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:tt}),it=s?typeof s=="number"?s:s.scroll:null,st=s?typeof s=="number"?s:s.resize:null,at=reactExports.useRef(!1);reactExports.useEffect(()=>(at.current=!0,()=>void(at.current=!1)));const[ot,ct,ft]=reactExports.useMemo(()=>{const ut=()=>{if(!rt.current.element)return;const{left:dt,top:gt,width:Et,height:St,bottom:Tt,right:Mt,x:Bt,y:Rt}=rt.current.element.getBoundingClientRect(),Ut={left:dt,top:gt,width:Et,height:St,bottom:Tt,right:Mt,x:Bt,y:Rt};rt.current.element instanceof HTMLElement&&$&&(Ut.height=rt.current.element.offsetHeight,Ut.width=rt.current.element.offsetWidth),Object.freeze(Ut),at.current&&!areBoundsEqual(rt.current.lastBounds,Ut)&&nt(rt.current.lastBounds=Ut)};return[ut,st?debounce_1(ut,st):ut,it?debounce_1(ut,it):ut]},[nt,$,it,st]);function ht(){rt.current.scrollContainers&&(rt.current.scrollContainers.forEach(ut=>ut.removeEventListener("scroll",ft,!0)),rt.current.scrollContainers=null),rt.current.resizeObserver&&(rt.current.resizeObserver.disconnect(),rt.current.resizeObserver=null)}function mt(){rt.current.element&&(rt.current.resizeObserver=new _e(ft),rt.current.resizeObserver.observe(rt.current.element),o&&rt.current.scrollContainers&&rt.current.scrollContainers.forEach(ut=>ut.addEventListener("scroll",ft,{capture:!0,passive:!0})))}const lt=ut=>{!ut||ut===rt.current.element||(ht(),rt.current.element=ut,rt.current.scrollContainers=findScrollContainers(ut),mt())};return useOnWindowScroll(ft,Boolean(o)),useOnWindowResize(ct),reactExports.useEffect(()=>{ht(),mt()},[o,ft,ct]),reactExports.useEffect(()=>ht,[]),[lt,tt,ot]}function useOnWindowResize(a){reactExports.useEffect(()=>{const s=a;return window.addEventListener("resize",s),()=>void window.removeEventListener("resize",s)},[a])}function useOnWindowScroll(a,s){reactExports.useEffect(()=>{if(s){const o=a;return window.addEventListener("scroll",o,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",o,!0)}},[a,s])}function findScrollContainers(a){const s=[];if(!a||a===document.body)return s;const{overflow:o,overflowX:j,overflowY:$}=window.getComputedStyle(a);return[o,j,$].some(_e=>_e==="auto"||_e==="scroll")&&s.push(a),[...s,...findScrollContainers(a.parentElement)]}const keys=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(a,s)=>keys.every(o=>a[o]===s[o]);var __defProp$1=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$1=(a,s,o)=>s in a?__defProp$1(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o,__spreadValues=(a,s)=>{for(var o in s||(s={}))__hasOwnProp.call(s,o)&&__defNormalProp$1(a,o,s[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(s))__propIsEnum.call(s,o)&&__defNormalProp$1(a,o,s[o]);return a},__spreadProps=(a,s)=>__defProps(a,__getOwnPropDescs(s));function traverseFiber(a,s,o){if(!a)return;if(o(a)===!0)return a;let j=s?a.return:a.child;for(;j;){const $=traverseFiber(j,s,o);if($)return $;j=s?null:j.sibling}}function wrapContext(a){try{return Object.defineProperties(a,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return a}}const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner,ReactCurrentDispatcher}=reactExports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function useFiber(){const a=reactExports.useContext(FiberContext);if(!a)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const s=reactExports.useId();return reactExports.useMemo(()=>{var j;return(j=ReactCurrentOwner.current)!=null?j:traverseFiber(a,!1,$=>{let _e=$.memoizedState;for(;_e;){if(_e.memoizedState===s)return!0;_e=_e.next}})},[a,s])}function useContextBridge(){var a,s;const o=useFiber(),[j]=reactExports.useState(()=>new Map);j.clear();let $=o;for(;$;){const _e=(a=$.type)==null?void 0:a._context;_e&&_e!==FiberContext&&!j.has(_e)&&j.set(_e,(s=ReactCurrentDispatcher.current)==null?void 0:s.readContext(wrapContext(_e))),$=$.return}return reactExports.useMemo(()=>Array.from(j.keys()).reduce((_e,tt)=>nt=>reactExports.createElement(_e,null,reactExports.createElement(tt.Provider,__spreadProps(__spreadValues({},nt),{value:j.get(tt)}))),_e=>reactExports.createElement(FiberProvider,__spreadValues({},_e))),[j])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(a){const{handlePointer:s}=createEvents(a);return{priority:1,enabled:!0,compute(o,j,$){j.pointer.set(o.offsetX/j.size.width*2-1,-(o.offsetY/j.size.height)*2+1),j.raycaster.setFromCamera(j.pointer,j.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((o,j)=>({...o,[j]:s(j)}),{}),update:()=>{var o;const{events:j,internal:$}=a.getState();(o=$.lastEvent)!=null&&o.current&&j.handlers&&j.handlers.onPointerMove($.lastEvent.current)},connect:o=>{var j;const{set:$,events:_e}=a.getState();_e.disconnect==null||_e.disconnect(),$(tt=>({events:{...tt.events,connected:o}})),Object.entries((j=_e.handlers)!=null?j:[]).forEach(([tt,nt])=>{const[rt,it]=DOM_EVENTS[tt];o.addEventListener(rt,nt,{passive:it})})},disconnect:()=>{const{set:o,events:j}=a.getState();if(j.connected){var $;Object.entries(($=j.handlers)!=null?$:[]).forEach(([_e,tt])=>{if(j&&j.connected instanceof HTMLElement){const[nt]=DOM_EVENTS[_e];j.connected.removeEventListener(nt,tt)}}),o(_e=>({events:{..._e.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function({children:s,fallback:o,resize:j,style:$,gl:_e,events:tt=createPointerEvents,eventSource:nt,eventPrefix:rt,shadows:it,linear:st,flat:at,legacy:ot,orthographic:ct,frameloop:ft,dpr:ht,performance:mt,raycaster:lt,camera:ut,onPointerMissed:dt,onCreated:gt,...Et},St){reactExports.useMemo(()=>extend(THREE),[]);const Tt=useContextBridge(),[Mt,Bt]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...j}),Rt=reactExports.useRef(null),Ut=reactExports.useRef(null);reactExports.useImperativeHandle(St,()=>Rt.current);const Ht=useMutableCallback(dt),[Wt,Jt]=reactExports.useState(!1),[sn,jt]=reactExports.useState(!1);if(Wt)throw Wt;if(sn)throw sn;const Vt=reactExports.useRef(null);useIsomorphicLayoutEffect(()=>{const Qt=Rt.current;Bt.width>0&&Bt.height>0&&Qt&&(Vt.current||(Vt.current=createRoot(Qt)),Vt.current.configure({gl:_e,events:tt,shadows:it,linear:st,flat:at,legacy:ot,orthographic:ct,frameloop:ft,dpr:ht,performance:mt,raycaster:lt,camera:ut,size:Bt,onPointerMissed:(...nn)=>Ht.current==null?void 0:Ht.current(...nn),onCreated:nn=>{nn.events.connect==null||nn.events.connect(nt?isRef$1(nt)?nt.current:nt:Ut.current),rt&&nn.setEvents({compute:(mn,Zt)=>{const cn=mn[rt+"X"],Ot=mn[rt+"Y"];Zt.pointer.set(cn/Zt.size.width*2-1,-(Ot/Zt.size.height)*2+1),Zt.raycaster.setFromCamera(Zt.pointer,Zt.camera)}}),gt==null||gt(nn)}}),Vt.current.render(reactExports.createElement(Tt,null,reactExports.createElement(ErrorBoundary,{set:jt},reactExports.createElement(reactExports.Suspense,{fallback:reactExports.createElement(Block,{set:Jt})},s)))))}),reactExports.useEffect(()=>{const Qt=Rt.current;if(Qt)return()=>unmountComponentAtNode(Qt)},[]);const Lt=nt?"none":"auto";return reactExports.createElement("div",_extends({ref:Ut,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Lt,...$}},Et),reactExports.createElement("div",{ref:Mt,style:{width:"100%",height:"100%"}},reactExports.createElement("canvas",{ref:Rt,style:{display:"block"}},o)))}),Canvas=reactExports.forwardRef(function(s,o){return reactExports.createElement(FiberProvider,null,reactExports.createElement(CanvasImpl,_extends({},s,{ref:o})))});var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(a,s){for(var o=new u16(31),j=0;j<31;++j)o[j]=s+=1<<a[j-1];for(var $=new u32(o[30]),j=1;j<30;++j)for(var _e=o[j];_e<o[j+1];++_e)$[_e]=_e-o[j]<<5|j;return[o,$]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b[0],rev=new u16(32768);for(var i=0;i<32768;++i){var x$1=(i&43690)>>>1|(i&21845)<<1;x$1=(x$1&52428)>>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>>4|(x$1&3855)<<4,rev[i]=((x$1&65280)>>>8|(x$1&255)<<8)>>>1}var hMap=function(a,s,o){for(var j=a.length,$=0,_e=new u16(s);$<j;++$)++_e[a[$]-1];var tt=new u16(s);for($=0;$<s;++$)tt[$]=tt[$-1]+_e[$-1]<<1;var nt;if(o){nt=new u16(1<<s);var rt=15-s;for($=0;$<j;++$)if(a[$])for(var it=$<<4|a[$],st=s-a[$],at=tt[a[$]-1]++<<st,ot=at|(1<<st)-1;at<=ot;++at)nt[rev[at]>>>rt]=it}else for(nt=new u16(j),$=0;$<j;++$)a[$]&&(nt[$]=rev[tt[a[$]-1]++]>>>15-a[$]);return nt},flt=new u8(288);for(var i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;var fdt=new u8(32);for(var i=0;i<32;++i)fdt[i]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(a){for(var s=a[0],o=1;o<a.length;++o)a[o]>s&&(s=a[o]);return s},bits=function(a,s,o){var j=s/8|0;return(a[j]|a[j+1]<<8)>>(s&7)&o},bits16=function(a,s){var o=s/8|0;return(a[o]|a[o+1]<<8|a[o+2]<<16)>>(s&7)},shft=function(a){return(a/8|0)+(a&7&&1)},slc=function(a,s,o){(s==null||s<0)&&(s=0),(o==null||o>a.length)&&(o=a.length);var j=new(a instanceof u16?u16:a instanceof u32?u32:u8)(o-s);return j.set(a.subarray(s,o)),j},inflt=function(a,s,o){var j=a.length;if(!j||o&&!o.l&&j<5)return s||new u8(0);var $=!s||o,_e=!o||o.i;o||(o={}),s||(s=new u8(j*3));var tt=function(fn){var hn=s.length;if(fn>hn){var Tn=new u8(Math.max(hn*2,fn));Tn.set(s),s=Tn}},nt=o.f||0,rt=o.p||0,it=o.b||0,st=o.l,at=o.d,ot=o.m,ct=o.n,ft=j*8;do{if(!st){o.f=nt=bits(a,rt,1);var ht=bits(a,rt+1,3);if(rt+=3,ht)if(ht==1)st=flrm,at=fdrm,ot=9,ct=5;else if(ht==2){var dt=bits(a,rt,31)+257,gt=bits(a,rt+10,15)+4,Et=dt+bits(a,rt+5,31)+1;rt+=14;for(var St=new u8(Et),Tt=new u8(19),Mt=0;Mt<gt;++Mt)Tt[clim[Mt]]=bits(a,rt+Mt*3,7);rt+=gt*3;for(var Bt=max(Tt),Rt=(1<<Bt)-1,Ut=hMap(Tt,Bt,1),Mt=0;Mt<Et;){var Ht=Ut[bits(a,rt,Rt)];rt+=Ht&15;var mt=Ht>>>4;if(mt<16)St[Mt++]=mt;else{var Wt=0,Jt=0;for(mt==16?(Jt=3+bits(a,rt,3),rt+=2,Wt=St[Mt-1]):mt==17?(Jt=3+bits(a,rt,7),rt+=3):mt==18&&(Jt=11+bits(a,rt,127),rt+=7);Jt--;)St[Mt++]=Wt}}var sn=St.subarray(0,dt),jt=St.subarray(dt);ot=max(sn),ct=max(jt),st=hMap(sn,ot,1),at=hMap(jt,ct,1)}else throw"invalid block type";else{var mt=shft(rt)+4,lt=a[mt-4]|a[mt-3]<<8,ut=mt+lt;if(ut>j){if(_e)throw"unexpected EOF";break}$&&tt(it+lt),s.set(a.subarray(mt,ut),it),o.b=it+=lt,o.p=rt=ut*8;continue}if(rt>ft){if(_e)throw"unexpected EOF";break}}$&&tt(it+131072);for(var Vt=(1<<ot)-1,Lt=(1<<ct)-1,Qt=rt;;Qt=rt){var Wt=st[bits16(a,rt)&Vt],nn=Wt>>>4;if(rt+=Wt&15,rt>ft){if(_e)throw"unexpected EOF";break}if(!Wt)throw"invalid length/literal";if(nn<256)s[it++]=nn;else if(nn==256){Qt=rt,st=null;break}else{var mn=nn-254;if(nn>264){var Mt=nn-257,Zt=fleb[Mt];mn=bits(a,rt,(1<<Zt)-1)+fl[Mt],rt+=Zt}var cn=at[bits16(a,rt)&Lt],Ot=cn>>>4;if(!cn)throw"invalid distance";rt+=cn&15;var jt=fd[Ot];if(Ot>3){var Zt=fdeb[Ot];jt+=bits16(a,rt)&(1<<Zt)-1,rt+=Zt}if(rt>ft){if(_e)throw"unexpected EOF";break}$&&tt(it+131072);for(var rn=it+mn;it<rn;it+=4)s[it]=s[it-jt],s[it+1]=s[it+1-jt],s[it+2]=s[it+2-jt],s[it+3]=s[it+3-jt];it=rn}}o.l=st,o.p=Qt,o.b=it,st&&(nt=1,o.m=ot,o.d=at,o.n=ct)}while(!nt);return it==s.length?s:slc(s,0,it)},et=new u8(0),b2=function(a,s){return a[s]|a[s+1]<<8},b4=function(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16|a[s+3]<<24)>>>0},b8=function(a,s){return b4(a,s)+b4(a,s+4)*4294967296},gzs=function(a){if(a[0]!=31||a[1]!=139||a[2]!=8)throw"invalid gzip data";var s=a[3],o=10;s&4&&(o+=a[10]|(a[11]<<8)+2);for(var j=(s>>3&1)+(s>>4&1);j>0;j-=!a[o++]);return o+(s&2)},gzl=function(a){var s=a.length;return(a[s-4]|a[s-3]<<8|a[s-2]<<16|a[s-1]<<24)>>>0},zlv=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function inflateSync(a,s){return inflt(a,s)}function gunzipSync(a,s){return inflt(a.subarray(gzs(a),-8),s||new u8(gzl(a)))}function unzlibSync(a,s){return inflt((zlv(a),a.subarray(2,-4)),s)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}var dutf8=function(a){for(var s="",o=0;;){var j=a[o++],$=(j>127)+(j>223)+(j>239);if(o+$>a.length)return[s,slc(a,o-1)];$?$==3?(j=((j&15)<<18|(a[o++]&63)<<12|(a[o++]&63)<<6|a[o++]&63)-65536,s+=String.fromCharCode(55296|j>>10,56320|j&1023)):$&1?s+=String.fromCharCode((j&31)<<6|a[o++]&63):s+=String.fromCharCode((j&15)<<12|(a[o++]&63)<<6|a[o++]&63):s+=String.fromCharCode(j)}};function strFromU8(a,s){if(s){for(var o="",j=0;j<a.length;j+=16384)o+=String.fromCharCode.apply(null,a.subarray(j,j+16384));return o}else{if(td)return td.decode(a);var $=dutf8(a),_e=$[0],tt=$[1];if(tt.length)throw"invalid utf-8 data";return _e}}var slzh=function(a,s){return s+30+b2(a,s+26)+b2(a,s+28)},zh=function(a,s,o){var j=b2(a,s+28),$=strFromU8(a.subarray(s+46,s+46+j),!(b2(a,s+8)&2048)),_e=s+46+j,tt=b4(a,s+20),nt=o&&tt==4294967295?z64e(a,_e):[tt,b4(a,s+24),b4(a,s+42)],rt=nt[0],it=nt[1],st=nt[2];return[b2(a,s+10),rt,it,$,_e+b2(a,s+30)+b2(a,s+32),st]},z64e=function(a,s){for(;b2(a,s)!=1;s+=4+b2(a,s+2));return[b8(a,s+12),b8(a,s+4),b8(a,s+20)]};function unzipSync(a){for(var s={},o=a.length-22;b4(a,o)!=101010256;--o)if(!o||a.length-o>65558)throw"invalid zip file";var j=b2(a,o+8);if(!j)return{};var $=b4(a,o+16),_e=$==4294967295;if(_e){if(o=b4(a,o-12),b4(a,o)!=101075792)throw"invalid zip file";j=b4(a,o+32),$=b4(a,o+48)}for(var tt=0;tt<j;++tt){var nt=zh(a,$,_e),rt=nt[0],it=nt[1],st=nt[2],at=nt[3],ot=nt[4],ct=nt[5],ft=slzh(a,ct);if($=ot,!rt)s[at]=slc(a,ft,ft+it);else if(rt==8)s[at]=inflateSync(a.subarray(ft,ft+it),new u8(st));else throw"unknown compression type "+rt}return s}var __defProp=Object.defineProperty,__defNormalProp=(a,s,o)=>s in a?__defProp(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o,__publicField=(a,s,o)=>(__defNormalProp(a,typeof s!="symbol"?s+"":s,o),o);const _normalData=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];class MD2Loader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=new DataView(s),j={},$=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"];for(let Et=0;Et<$.length;Et++)j[$[Et]]=o.getInt32(Et*4,!0);if(j.ident!==844121161||j.version!==8){console.error("Not a valid MD2 file");return}if(j.offset_end!==o.byteLength){console.error("Corrupted MD2 file");return}const _e=new BufferGeometry,tt=[];let nt=j.offset_st;for(let Et=0,St=j.num_st;Et<St;Et++){const Tt=o.getInt16(nt+0,!0),Mt=o.getInt16(nt+2,!0);tt.push(Tt/j.skinwidth,1-Mt/j.skinheight),nt+=4}nt=j.offset_tris;const rt=[],it=[];for(let Et=0,St=j.num_tris;Et<St;Et++)rt.push(o.getUint16(nt+0,!0),o.getUint16(nt+2,!0),o.getUint16(nt+4,!0)),it.push(o.getUint16(nt+6,!0),o.getUint16(nt+8,!0),o.getUint16(nt+10,!0)),nt+=12;const st=new Vector3,at=new Vector3,ot=[],ct=[];nt=j.offset_frames;for(let Et=0,St=j.num_frames;Et<St;Et++){at.set(o.getFloat32(nt+0,!0),o.getFloat32(nt+4,!0),o.getFloat32(nt+8,!0)),st.set(o.getFloat32(nt+12,!0),o.getFloat32(nt+16,!0),o.getFloat32(nt+20,!0)),nt+=24;for(let Mt=0;Mt<16;Mt++){const Bt=o.getUint8(nt+Mt,!0);if(Bt===0)break;ot[Mt]=Bt}const Tt={name:String.fromCharCode.apply(null,ot),vertices:[],normals:[]};nt+=16;for(let Mt=0;Mt<j.num_vertices;Mt++){let Bt=o.getUint8(nt++,!0),Rt=o.getUint8(nt++,!0),Ut=o.getUint8(nt++,!0);const Ht=_normalData[o.getUint8(nt++,!0)];Bt=Bt*at.x+st.x,Rt=Rt*at.y+st.y,Ut=Ut*at.z+st.z,Tt.vertices.push(Bt,Ut,Rt),Tt.normals.push(Ht[0],Ht[2],Ht[1])}ct.push(Tt)}const ft=[],ht=[],mt=[],lt=ct[0].vertices,ut=ct[0].normals;for(let Et=0,St=rt.length;Et<St;Et++){let Mt=rt[Et]*3;const Bt=lt[Mt],Rt=lt[Mt+1],Ut=lt[Mt+2];ft.push(Bt,Rt,Ut);const Ht=ut[Mt],Wt=ut[Mt+1],Jt=ut[Mt+2];ht.push(Ht,Wt,Jt),Mt=it[Et]*2;const jt=tt[Mt],Vt=tt[Mt+1];mt.push(jt,Vt)}_e.setAttribute("position",new Float32BufferAttribute(ft,3)),_e.setAttribute("normal",new Float32BufferAttribute(ht,3)),_e.setAttribute("uv",new Float32BufferAttribute(mt,2));const dt=[],gt=[];for(let Et=0,St=ct.length;Et<St;Et++){const Tt=ct[Et],Mt=Tt.name;if(Tt.vertices.length>0){const Bt=[];for(let Ut=0,Ht=rt.length;Ut<Ht;Ut++){const Jt=rt[Ut]*3,sn=Tt.vertices[Jt],jt=Tt.vertices[Jt+1],Vt=Tt.vertices[Jt+2];Bt.push(sn,jt,Vt)}const Rt=new Float32BufferAttribute(Bt,3);Rt.name=Mt,dt.push(Rt)}if(Tt.normals.length>0){const Bt=[];for(let Ut=0,Ht=rt.length;Ut<Ht;Ut++){const Jt=rt[Ut]*3,sn=Tt.normals[Jt],jt=Tt.normals[Jt+1],Vt=Tt.normals[Jt+2];Bt.push(sn,jt,Vt)}const Rt=new Float32BufferAttribute(Bt,3);Rt.name=Mt,gt.push(Rt)}}return _e.morphAttributes.position=dt,_e.morphAttributes.normal=gt,_e.morphTargetsRelative=!1,_e.animations=AnimationClip.CreateClipsFromMorphTargetSequences(ct,10),_e}}class MorphBlendMesh extends Mesh{constructor(s,o){super(s,o),this.animationsMap={},this.animationsList=[];const j=Object.keys(this.morphTargetDictionary).length,$="__default",_e=0,tt=j-1,nt=j/1;this.createAnimation($,_e,tt,nt),this.setAnimationWeight($,1)}createAnimation(s,o,j,$){const _e={start:o,end:j,length:j-o+1,fps:$,duration:(j-o)/$,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[s]=_e,this.animationsList.push(_e)}autoCreateAnimations(s){const o=/([a-z]+)_?(\d+)/i;let j;const $={};let _e=0;for(const tt in this.morphTargetDictionary){const nt=tt.match(o);if(nt&&nt.length>1){const rt=nt[1];$[rt]||($[rt]={start:1/0,end:-1/0});const it=$[rt];_e<it.start&&(it.start=_e),_e>it.end&&(it.end=_e),j||(j=rt)}_e++}for(const tt in $){const nt=$[tt];this.createAnimation(tt,nt.start,nt.end,s)}this.firstAnimation=j}setAnimationDirectionForward(s){const o=this.animationsMap[s];o&&(o.direction=1,o.directionBackwards=!1)}setAnimationDirectionBackward(s){const o=this.animationsMap[s];o&&(o.direction=-1,o.directionBackwards=!0)}setAnimationFPS(s,o){const j=this.animationsMap[s];j&&(j.fps=o,j.duration=(j.end-j.start)/j.fps)}setAnimationDuration(s,o){const j=this.animationsMap[s];j&&(j.duration=o,j.fps=(j.end-j.start)/j.duration)}setAnimationWeight(s,o){const j=this.animationsMap[s];j&&(j.weight=o)}setAnimationTime(s,o){const j=this.animationsMap[s];j&&(j.time=o)}getAnimationTime(s){let o=0;const j=this.animationsMap[s];return j&&(o=j.time),o}getAnimationDuration(s){let o=-1;const j=this.animationsMap[s];return j&&(o=j.duration),o}playAnimation(s){const o=this.animationsMap[s];o?(o.time=0,o.active=!0):console.warn("THREE.MorphBlendMesh: animation["+s+"] undefined in .playAnimation()")}stopAnimation(s){const o=this.animationsMap[s];o&&(o.active=!1)}update(s){for(let o=0,j=this.animationsList.length;o<j;o++){const $=this.animationsList[o];if(!$.active)continue;const _e=$.duration/$.length;$.time+=$.direction*s,$.mirroredLoop?($.time>$.duration||$.time<0)&&($.direction*=-1,$.time>$.duration&&($.time=$.duration,$.directionBackwards=!0),$.time<0&&($.time=0,$.directionBackwards=!1)):($.time=$.time%$.duration,$.time<0&&($.time+=$.duration));const tt=$.start+MathUtils.clamp(Math.floor($.time/_e),0,$.length-1),nt=$.weight;tt!==$.currentFrame&&(this.morphTargetInfluences[$.lastFrame]=0,this.morphTargetInfluences[$.currentFrame]=1*nt,this.morphTargetInfluences[tt]=0,$.lastFrame=$.currentFrame,$.currentFrame=tt);let rt=$.time%_e/_e;$.directionBackwards&&(rt=1-rt),$.currentFrame!==$.lastFrame?(this.morphTargetInfluences[$.currentFrame]=rt*nt,this.morphTargetInfluences[$.lastFrame]=(1-rt)*nt):this.morphTargetInfluences[$.currentFrame]=nt}}}const Visible=0,Deleted=1,_v1$5=new Vector3,_line3=new Line3,_plane$2=new Plane,_closestPoint$1=new Vector3,_triangle=new Triangle;class ConvexHull{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new VertexList,this.unassigned=new VertexList,this.vertices=[]}setFromPoints(s){if(s.length>=4){this.makeEmpty();for(let o=0,j=s.length;o<j;o++)this.vertices.push(new VertexNode(s[o]));this.compute()}return this}setFromObject(s){const o=[];return s.updateMatrixWorld(!0),s.traverse(function(j){const $=j.geometry;if($!==void 0){const _e=$.attributes.position;if(_e!==void 0)for(let tt=0,nt=_e.count;tt<nt;tt++){const rt=new Vector3;rt.fromBufferAttribute(_e,tt).applyMatrix4(j.matrixWorld),o.push(rt)}}}),this.setFromPoints(o)}containsPoint(s){const o=this.faces;for(let j=0,$=o.length;j<$;j++)if(o[j].distanceToPoint(s)>this.tolerance)return!1;return!0}intersectRay(s,o){const j=this.faces;let $=-1/0,_e=1/0;for(let tt=0,nt=j.length;tt<nt;tt++){const rt=j[tt],it=rt.distanceToPoint(s.origin),st=rt.normal.dot(s.direction);if(it>0&&st>=0)return null;const at=st!==0?-it/st:0;if(!(at<=0)&&(st>0?_e=Math.min(at,_e):$=Math.max(at,$),$>_e))return null}return $!==-1/0?s.at($,o):s.at(_e,o),o}intersectsRay(s){return this.intersectRay(s,_v1$5)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(s,o){return s.face=o,o.outside===null?this.assigned.append(s):this.assigned.insertBefore(o.outside,s),o.outside=s,this}removeVertexFromFace(s,o){return s===o.outside&&(s.next!==null&&s.next.face===o?o.outside=s.next:o.outside=null),this.assigned.remove(s),this}removeAllVerticesFromFace(s){if(s.outside!==null){const o=s.outside;let j=s.outside;for(;j.next!==null&&j.next.face===s;)j=j.next;return this.assigned.removeSubList(o,j),o.prev=j.next=null,s.outside=null,o}}deleteFaceVertices(s,o){const j=this.removeAllVerticesFromFace(s);if(j!==void 0)if(o===void 0)this.unassigned.appendChain(j);else{let $=j;do{const _e=$.next;o.distanceToPoint($.point)>this.tolerance?this.addVertexToFace($,o):this.unassigned.append($),$=_e}while($!==null)}return this}resolveUnassignedPoints(s){if(this.unassigned.isEmpty()===!1){let o=this.unassigned.first();do{const j=o.next;let $=this.tolerance,_e=null;for(let tt=0;tt<s.length;tt++){const nt=s[tt];if(nt.mark===Visible){const rt=nt.distanceToPoint(o.point);if(rt>$&&($=rt,_e=nt),$>1e3*this.tolerance)break}}_e!==null&&this.addVertexToFace(o,_e),o=j}while(o!==null)}return this}computeExtremes(){const s=new Vector3,o=new Vector3,j=[],$=[];for(let _e=0;_e<3;_e++)j[_e]=$[_e]=this.vertices[0];s.copy(this.vertices[0].point),o.copy(this.vertices[0].point);for(let _e=0,tt=this.vertices.length;_e<tt;_e++){const nt=this.vertices[_e],rt=nt.point;for(let it=0;it<3;it++)rt.getComponent(it)<s.getComponent(it)&&(s.setComponent(it,rt.getComponent(it)),j[it]=nt);for(let it=0;it<3;it++)rt.getComponent(it)>o.getComponent(it)&&(o.setComponent(it,rt.getComponent(it)),$[it]=nt)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(s.x),Math.abs(o.x))+Math.max(Math.abs(s.y),Math.abs(o.y))+Math.max(Math.abs(s.z),Math.abs(o.z))),{min:j,max:$}}computeInitialHull(){const s=this.vertices,o=this.computeExtremes(),j=o.min,$=o.max;let _e=0,tt=0;for(let ot=0;ot<3;ot++){const ct=$[ot].point.getComponent(ot)-j[ot].point.getComponent(ot);ct>_e&&(_e=ct,tt=ot)}const nt=j[tt],rt=$[tt];let it,st;_e=0,_line3.set(nt.point,rt.point);for(let ot=0,ct=this.vertices.length;ot<ct;ot++){const ft=s[ot];if(ft!==nt&&ft!==rt){_line3.closestPointToPoint(ft.point,!0,_closestPoint$1);const ht=_closestPoint$1.distanceToSquared(ft.point);ht>_e&&(_e=ht,it=ft)}}_e=-1,_plane$2.setFromCoplanarPoints(nt.point,rt.point,it.point);for(let ot=0,ct=this.vertices.length;ot<ct;ot++){const ft=s[ot];if(ft!==nt&&ft!==rt&&ft!==it){const ht=Math.abs(_plane$2.distanceToPoint(ft.point));ht>_e&&(_e=ht,st=ft)}}const at=[];if(_plane$2.distanceToPoint(st.point)<0){at.push(Face$1.create(nt,rt,it),Face$1.create(st,rt,nt),Face$1.create(st,it,rt),Face$1.create(st,nt,it));for(let ot=0;ot<3;ot++){const ct=(ot+1)%3;at[ot+1].getEdge(2).setTwin(at[0].getEdge(ct)),at[ot+1].getEdge(1).setTwin(at[ct+1].getEdge(0))}}else{at.push(Face$1.create(nt,it,rt),Face$1.create(st,nt,rt),Face$1.create(st,rt,it),Face$1.create(st,it,nt));for(let ot=0;ot<3;ot++){const ct=(ot+1)%3;at[ot+1].getEdge(2).setTwin(at[0].getEdge((3-ot)%3)),at[ot+1].getEdge(0).setTwin(at[ct+1].getEdge(1))}}for(let ot=0;ot<4;ot++)this.faces.push(at[ot]);for(let ot=0,ct=s.length;ot<ct;ot++){const ft=s[ot];if(ft!==nt&&ft!==rt&&ft!==it&&ft!==st){_e=this.tolerance;let ht=null;for(let mt=0;mt<4;mt++){const lt=this.faces[mt].distanceToPoint(ft.point);lt>_e&&(_e=lt,ht=this.faces[mt])}ht!==null&&this.addVertexToFace(ft,ht)}}return this}reindexFaces(){const s=[];for(let o=0;o<this.faces.length;o++){const j=this.faces[o];j.mark===Visible&&s.push(j)}return this.faces=s,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let s,o=0;const j=this.assigned.first().face;let $=j.outside;do{const _e=j.distanceToPoint($.point);_e>o&&(o=_e,s=$),$=$.next}while($!==null&&$.face===j);return s}}computeHorizon(s,o,j,$){this.deleteFaceVertices(j),j.mark=Deleted;let _e;o===null?_e=o=j.getEdge(0):_e=o.next;do{const tt=_e.twin,nt=tt.face;nt.mark===Visible&&(nt.distanceToPoint(s)>this.tolerance?this.computeHorizon(s,tt,nt,$):$.push(_e)),_e=_e.next}while(_e!==o);return this}addAdjoiningFace(s,o){const j=Face$1.create(s,o.tail(),o.head());return this.faces.push(j),j.getEdge(-1).setTwin(o.twin),j.getEdge(0)}addNewFaces(s,o){this.newFaces=[];let j=null,$=null;for(let _e=0;_e<o.length;_e++){const tt=o[_e],nt=this.addAdjoiningFace(s,tt);j===null?j=nt:nt.next.setTwin($),this.newFaces.push(nt.face),$=nt}return j.next.setTwin($),this}addVertexToHull(s){const o=[];return this.unassigned.clear(),this.removeVertexFromFace(s,s.face),this.computeHorizon(s.point,null,s.face,o),this.addNewFaces(s,o),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let s;for(this.computeInitialHull();(s=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(s);return this.reindexFaces(),this.cleanup(),this}}let Face$1=class HA{constructor(){this.normal=new Vector3,this.midpoint=new Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=Visible,this.edge=null}static create(s,o,j){const $=new HA,_e=new HalfEdge(s,$),tt=new HalfEdge(o,$),nt=new HalfEdge(j,$);return _e.next=nt.prev=tt,tt.next=_e.prev=nt,nt.next=tt.prev=_e,$.edge=_e,$.compute()}getEdge(s){let o=this.edge;for(;s>0;)o=o.next,s--;for(;s<0;)o=o.prev,s++;return o}compute(){const s=this.edge.tail(),o=this.edge.head(),j=this.edge.next.head();return _triangle.set(s.point,o.point,j.point),_triangle.getNormal(this.normal),_triangle.getMidpoint(this.midpoint),this.area=_triangle.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(s){return this.normal.dot(s)-this.constant}};class HalfEdge{constructor(s,o){this.vertex=s,this.prev=null,this.next=null,this.twin=null,this.face=o}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const s=this.head(),o=this.tail();return o!==null?o.point.distanceTo(s.point):-1}lengthSquared(){const s=this.head(),o=this.tail();return o!==null?o.point.distanceToSquared(s.point):-1}setTwin(s){return this.twin=s,s.twin=this,this}}class VertexNode{constructor(s){this.point=s,this.prev=null,this.next=null,this.face=null}}class VertexList{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(s,o){return o.prev=s.prev,o.next=s,o.prev===null?this.head=o:o.prev.next=o,s.prev=o,this}insertAfter(s,o){return o.prev=s,o.next=s.next,o.next===null?this.tail=o:o.next.prev=o,s.next=o,this}append(s){return this.head===null?this.head=s:this.tail.next=s,s.prev=this.tail,s.next=null,this.tail=s,this}appendChain(s){for(this.head===null?this.head=s:this.tail.next=s,s.prev=this.tail;s.next!==null;)s=s.next;return this.tail=s,this}remove(s){return s.prev===null?this.head=s.next:s.prev.next=s.next,s.next===null?this.tail=s.prev:s.next.prev=s.prev,this}removeSubList(s,o){return s.prev===null?this.head=o.next:s.prev.next=o.next,o.next===null?this.tail=s.prev:o.next.prev=s.prev,this}isEmpty(){return this.head===null}}class ConvexGeometry extends BufferGeometry{constructor(s=[]){super();const o=[],j=[],_e=new ConvexHull().setFromPoints(s).faces;for(let tt=0;tt<_e.length;tt++){const nt=_e[tt];let rt=nt.edge;do{const it=rt.head().point;o.push(it.x,it.y,it.z),j.push(nt.normal.x,nt.normal.y,nt.normal.z),rt=rt.next}while(rt!==nt.edge)}this.setAttribute("position",new Float32BufferAttribute(o,3)),this.setAttribute("normal",new Float32BufferAttribute(j,3))}}const _translationObject=new Vector3,_quaternionObject=new Quaternion,_scaleObject=new Vector3,_translationWorld=new Vector3,_quaternionWorld=new Quaternion,_scaleWorld=new Vector3;class Gyroscope extends Object3D{constructor(){super()}updateMatrixWorld(s){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||s)&&(this.parent!==null?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(_translationWorld,_quaternionWorld,_scaleWorld),this.matrix.decompose(_translationObject,_quaternionObject,_scaleObject),this.matrixWorld.compose(_translationWorld,_quaternionObject,_scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,s=!0);for(let o=0,j=this.children.length;o<j;o++)this.children[o].updateMatrixWorld(s)}}class MorphAnimMesh extends Mesh{constructor(s,o){super(s,o),this.type="MorphAnimMesh",this.mixer=new AnimationMixer(this),this.activeAction=null}setDirectionForward(){this.mixer.timeScale=1}setDirectionBackward(){this.mixer.timeScale=-1}playAnimation(s,o){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);const j=AnimationClip.findByName(this,s);if(j){const $=this.mixer.clipAction(j);$.timeScale=j.tracks.length*o/j.duration,this.activeAction=$.play()}else throw new Error("THREE.MorphAnimMesh: animations["+s+"] undefined in .playAnimation()")}updateAnimation(s){this.mixer.update(s)}copy(s,o){return super.copy(s,o),this.mixer=new AnimationMixer(this),this}}class RollerCoasterGeometry extends BufferGeometry{constructor(s,o){super();const j=[],$=[],_e=[],tt=[1,1,1],nt=[1,1,0],rt=new Vector3(0,1,0),it=new Vector3,st=new Vector3,at=new Quaternion,ot=new Quaternion;ot.setFromAxisAngle(rt,Math.PI/2);const ct=new Vector3,ft=new Vector3;ft.copy(s.getPointAt(0));const ht=[new Vector3(-.225,0,0),new Vector3(0,-.05,0),new Vector3(0,-.175,0),new Vector3(0,-.05,0),new Vector3(.225,0,0),new Vector3(0,-.175,0)],mt=Math.PI*2;let lt=5;const ut=[];for(let Vt=0;Vt<lt;Vt++){const Lt=Vt/lt*mt;ut.push(new Vector3(Math.sin(Lt)*.06,Math.cos(Lt)*.06,0))}lt=6;const dt=[];for(let Vt=0;Vt<lt;Vt++){const Lt=Vt/lt*mt;dt.push(new Vector3(Math.sin(Lt)*.025,Math.cos(Lt)*.025,0))}const gt=new Vector3,Et=new Vector3;function St(Vt,Lt){Et.set(0,0,-1).applyQuaternion(at);for(let Qt=0;Qt<Vt.length;Qt++)gt.copy(Vt[Qt]),gt.applyQuaternion(at),gt.add(ct),j.push(gt.x,gt.y,gt.z),$.push(Et.x,Et.y,Et.z),_e.push(Lt[0],Lt[1],Lt[2]);Et.set(0,0,1).applyQuaternion(at);for(let Qt=Vt.length-1;Qt>=0;Qt--)gt.copy(Vt[Qt]),gt.applyQuaternion(at),gt.add(ct),j.push(gt.x,gt.y,gt.z),$.push(Et.x,Et.y,Et.z),_e.push(Lt[0],Lt[1],Lt[2])}const Tt=new Vector3,Mt=new Vector3,Bt=new Vector3,Rt=new Vector3,Ut=new Vector3,Ht=new Vector3,Wt=new Vector3,Jt=new Vector3;function sn(Vt,Lt,Qt){for(let nn=0,mn=Vt.length;nn<mn;nn++){const Zt=Vt[nn],cn=Vt[(nn+1)%mn];Tt.copy(Zt).add(Lt),Tt.applyQuaternion(at),Tt.add(ct),Mt.copy(cn).add(Lt),Mt.applyQuaternion(at),Mt.add(ct),Bt.copy(cn).add(Lt),Bt.applyQuaternion(ot),Bt.add(ft),Rt.copy(Zt).add(Lt),Rt.applyQuaternion(ot),Rt.add(ft),j.push(Tt.x,Tt.y,Tt.z),j.push(Mt.x,Mt.y,Mt.z),j.push(Rt.x,Rt.y,Rt.z),j.push(Mt.x,Mt.y,Mt.z),j.push(Bt.x,Bt.y,Bt.z),j.push(Rt.x,Rt.y,Rt.z),Ut.copy(Zt),Ut.applyQuaternion(at),Ut.normalize(),Ht.copy(cn),Ht.applyQuaternion(at),Ht.normalize(),Wt.copy(cn),Wt.applyQuaternion(ot),Wt.normalize(),Jt.copy(Zt),Jt.applyQuaternion(ot),Jt.normalize(),$.push(Ut.x,Ut.y,Ut.z),$.push(Ht.x,Ht.y,Ht.z),$.push(Jt.x,Jt.y,Jt.z),$.push(Ht.x,Ht.y,Ht.z),$.push(Wt.x,Wt.y,Wt.z),$.push(Jt.x,Jt.y,Jt.z),_e.push(Qt[0],Qt[1],Qt[2]),_e.push(Qt[0],Qt[1],Qt[2]),_e.push(Qt[0],Qt[1],Qt[2]),_e.push(Qt[0],Qt[1],Qt[2]),_e.push(Qt[0],Qt[1],Qt[2]),_e.push(Qt[0],Qt[1],Qt[2])}}const jt=new Vector3;for(let Vt=1;Vt<=o;Vt++){ct.copy(s.getPointAt(Vt/o)),rt.set(0,1,0),it.subVectors(ct,ft).normalize(),st.crossVectors(rt,it).normalize(),rt.crossVectors(it,st);const Lt=Math.atan2(it.x,it.z);at.setFromAxisAngle(rt,Lt),Vt%2===0&&St(ht,nt),sn(ut,jt.set(0,-.125,0),nt),sn(dt,jt.set(.2,0,0),tt),sn(dt,jt.set(-.2,0,0),tt),ft.copy(ct),ot.copy(at)}this.setAttribute("position",new BufferAttribute(new Float32Array(j),3)),this.setAttribute("normal",new BufferAttribute(new Float32Array($),3)),this.setAttribute("color",new BufferAttribute(new Float32Array(_e),3))}}class RollerCoasterLiftersGeometry extends BufferGeometry{constructor(s,o){super();const j=[],$=[],_e=new Quaternion,tt=new Vector3(0,1,0),nt=new Vector3,rt=new Vector3,it=[new Vector3(0,.05,-.05),new Vector3(0,.05,.05),new Vector3(0,-.05,0)],st=[new Vector3(-.05,0,.05),new Vector3(-.05,0,-.05),new Vector3(.05,0,0)],at=[new Vector3(.05,0,-.05),new Vector3(.05,0,.05),new Vector3(-.05,0,0)],ot=new Vector3,ct=new Vector3,ft=new Vector3,ht=new Vector3,mt=new Vector3,lt=new Vector3,ut=new Vector3,dt=new Vector3;function gt(Tt,Mt,Bt){for(let Rt=0,Ut=Tt.length;Rt<Ut;Rt++){const Ht=Tt[Rt],Wt=Tt[(Rt+1)%Ut];ot.copy(Ht),ot.applyQuaternion(_e),ot.add(Mt),ct.copy(Wt),ct.applyQuaternion(_e),ct.add(Mt),ft.copy(Wt),ft.applyQuaternion(_e),ft.add(Bt),ht.copy(Ht),ht.applyQuaternion(_e),ht.add(Bt),j.push(ot.x,ot.y,ot.z),j.push(ct.x,ct.y,ct.z),j.push(ht.x,ht.y,ht.z),j.push(ct.x,ct.y,ct.z),j.push(ft.x,ft.y,ft.z),j.push(ht.x,ht.y,ht.z),mt.copy(Ht),mt.applyQuaternion(_e),mt.normalize(),lt.copy(Wt),lt.applyQuaternion(_e),lt.normalize(),ut.copy(Wt),ut.applyQuaternion(_e),ut.normalize(),dt.copy(Ht),dt.applyQuaternion(_e),dt.normalize(),$.push(mt.x,mt.y,mt.z),$.push(lt.x,lt.y,lt.z),$.push(dt.x,dt.y,dt.z),$.push(lt.x,lt.y,lt.z),$.push(ut.x,ut.y,ut.z),$.push(dt.x,dt.y,dt.z)}}const Et=new Vector3,St=new Vector3;for(let Tt=1;Tt<=o;Tt++){nt.copy(s.getPointAt(Tt/o)),rt.copy(s.getTangentAt(Tt/o));const Mt=Math.atan2(rt.x,rt.z);_e.setFromAxisAngle(tt,Mt),nt.y>10?(Et.set(-.75,-.35,0),Et.applyQuaternion(_e),Et.add(nt),St.set(.75,-.35,0),St.applyQuaternion(_e),St.add(nt),gt(it,Et,St),Et.set(-.7,-.3,0),Et.applyQuaternion(_e),Et.add(nt),St.set(-.7,-nt.y,0),St.applyQuaternion(_e),St.add(nt),gt(st,Et,St),Et.set(.7,-.3,0),Et.applyQuaternion(_e),Et.add(nt),St.set(.7,-nt.y,0),St.applyQuaternion(_e),St.add(nt),gt(at,Et,St)):(Et.set(0,-.2,0),Et.applyQuaternion(_e),Et.add(nt),St.set(0,-nt.y,0),St.applyQuaternion(_e),St.add(nt),gt(at,Et,St))}this.setAttribute("position",new BufferAttribute(new Float32Array(j),3)),this.setAttribute("normal",new BufferAttribute(new Float32Array($),3))}}class RollerCoasterShadowGeometry extends BufferGeometry{constructor(s,o){super();const j=[],$=new Vector3(0,1,0),_e=new Vector3,tt=new Quaternion,nt=new Quaternion;nt.setFromAxisAngle($,Math.PI/2);const rt=new Vector3,it=new Vector3;it.copy(s.getPointAt(0)),it.y=0;const st=new Vector3,at=new Vector3,ot=new Vector3,ct=new Vector3;for(let ft=1;ft<=o;ft++){rt.copy(s.getPointAt(ft/o)),rt.y=0,_e.subVectors(rt,it);const ht=Math.atan2(_e.x,_e.z);tt.setFromAxisAngle($,ht),st.set(-.3,0,0),st.applyQuaternion(tt),st.add(rt),at.set(.3,0,0),at.applyQuaternion(tt),at.add(rt),ot.set(.3,0,0),ot.applyQuaternion(nt),ot.add(it),ct.set(-.3,0,0),ct.applyQuaternion(nt),ct.add(it),j.push(st.x,st.y,st.z),j.push(at.x,at.y,at.z),j.push(ct.x,ct.y,ct.z),j.push(at.x,at.y,at.z),j.push(ot.x,ot.y,ot.z),j.push(ct.x,ct.y,ct.z),it.copy(rt),nt.copy(tt)}this.setAttribute("position",new BufferAttribute(new Float32Array(j),3))}}class SkyGeometry extends BufferGeometry{constructor(){super();const s=[];for(let o=0;o<100;o++){const j=Math.random()*800-400,$=Math.random()*50+50,_e=Math.random()*800-400,tt=Math.random()*40+20;s.push(j-tt,$,_e-tt),s.push(j+tt,$,_e-tt),s.push(j-tt,$,_e+tt),s.push(j+tt,$,_e-tt),s.push(j+tt,$,_e+tt),s.push(j-tt,$,_e+tt)}this.setAttribute("position",new BufferAttribute(new Float32Array(s),3))}}class TreesGeometry extends BufferGeometry{constructor(s){super();const o=[],j=[],$=new Raycaster;$.ray.direction.set(0,-1,0);const _e=new Color;for(let tt=0;tt<2e3;tt++){const nt=Math.random()*500-250,rt=Math.random()*500-250;$.ray.origin.set(nt,50,rt);const it=$.intersectObject(s);if(it.length===0)continue;const st=it[0].point.y,at=Math.random()*5+.5;let ot=Math.random()*Math.PI*2;o.push(nt+Math.sin(ot),st,rt+Math.cos(ot)),o.push(nt,st+at,rt),o.push(nt+Math.sin(ot+Math.PI),st,rt+Math.cos(ot+Math.PI)),ot+=Math.PI/2,o.push(nt+Math.sin(ot),st,rt+Math.cos(ot)),o.push(nt,st+at,rt),o.push(nt+Math.sin(ot+Math.PI),st,rt+Math.cos(ot+Math.PI));const ct=Math.random()*.1;for(let ft=0;ft<6;ft++)_e.setRGB(.2+ct,.4+ct,0,"srgb"),j.push(_e.r,_e.g,_e.b)}this.setAttribute("position",new BufferAttribute(new Float32Array(o),3)),this.setAttribute("color",new BufferAttribute(new Float32Array(j),3))}}class VolumeSlice{constructor(s,o,j){const $=this;this.volume=s,o=o||0,Object.defineProperty(this,"index",{get:function(){return o},set:function(nt){return o=nt,$.geometryNeedsUpdate=!0,o}}),this.axis=j||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();const _e=new Texture(this.canvas);_e.minFilter=LinearFilter,_e.wrapS=_e.wrapT=ClampToEdgeWrapping,"colorSpace"in _e?_e.colorSpace="srgb":_e.encoding=3001;const tt=new MeshBasicMaterial({map:_e,side:DoubleSide,transparent:!0});this.mesh=new Mesh(this.geometry,tt),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()}repaint(){this.geometryNeedsUpdate&&this.updateGeometry();const s=this.iLength,o=this.jLength,j=this.sliceAccess,$=this.volume,_e=this.canvasBuffer,tt=this.ctxBuffer,nt=tt.getImageData(0,0,s,o),rt=nt.data,it=$.data,st=$.upperThreshold,at=$.lowerThreshold,ot=$.windowLow,ct=$.windowHigh;let ft=0;if($.dataType==="label")for(let ht=0;ht<o;ht++)for(let mt=0;mt<s;mt++){let lt=it[j(mt,ht)];lt=lt>=this.colorMap.length?lt%this.colorMap.length+1:lt;const ut=this.colorMap[lt];rt[4*ft]=ut>>24&255,rt[4*ft+1]=ut>>16&255,rt[4*ft+2]=ut>>8&255,rt[4*ft+3]=ut&255,ft++}else for(let ht=0;ht<o;ht++)for(let mt=0;mt<s;mt++){let lt=it[j(mt,ht)],ut=255;ut=st>=lt&&at<=lt?ut:0,lt=Math.floor(255*(lt-ot)/(ct-ot)),lt=lt>255?255:lt<0?0:lt|0,rt[4*ft]=lt,rt[4*ft+1]=lt,rt[4*ft+2]=lt,rt[4*ft+3]=ut,ft++}tt.putImageData(nt,0,0),this.ctx.drawImage(_e,0,0,s,o,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0}updateGeometry(){const s=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=s.sliceAccess,this.jLength=s.jLength,this.iLength=s.iLength,this.matrix=s.matrix,this.canvas.width=s.planeWidth,this.canvas.height=s.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new PlaneGeometry(s.planeWidth,s.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix4(this.matrix)),this.geometryNeedsUpdate=!1}}class Volume{constructor(s,o,j,$,_e){if(s!==void 0){switch(this.xLength=Number(s)||1,this.yLength=Number(o)||1,this.zLength=Number(j)||1,this.axisOrder=["x","y","z"],$){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(_e);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(_e);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(_e);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(_e);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(_e);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(_e);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw new Error("Error in Volume constructor : this type is not supported in JavaScript");case"Float32":case"float32":case"float":this.data=new Float32Array(_e);break;case"Float64":case"float64":case"double":this.data=new Float64Array(_e);break;default:this.data=new Uint8Array(_e)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw new Error("Error in Volume constructor, lengths are not matching arrayBuffer size")}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new Matrix3,this.matrix.identity();let tt=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return tt},set:function(rt){tt=rt,this.sliceList.forEach(function(it){it.geometryNeedsUpdate=!0})}});let nt=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return nt},set:function(rt){nt=rt,this.sliceList.forEach(function(it){it.geometryNeedsUpdate=!0})}}),this.sliceList=[],this.segmentation=!1}getData(s,o,j){return this.data[j*this.xLength*this.yLength+o*this.xLength+s]}access(s,o,j){return j*this.xLength*this.yLength+o*this.xLength+s}reverseAccess(s){const o=Math.floor(s/(this.yLength*this.xLength)),j=Math.floor((s-o*this.yLength*this.xLength)/this.xLength);return[s-o*this.yLength*this.xLength-j*this.xLength,j,o]}map(s,o){const j=this.data.length;o=o||this;for(let $=0;$<j;$++)this.data[$]=s.call(o,this.data[$],$,this.data);return this}extractPerpendicularPlane(s,o){let j,$,_e,tt;const nt=new Vector3,rt=new Vector3,it=new Vector3,st=new Matrix4().identity(),at=this,ot=new Vector3(this.xLength,this.yLength,this.zLength);switch(s){case"x":nt.set(1,0,0),rt.set(0,0,-1),it.set(0,-1,0),j=this.spacing[this.axisOrder.indexOf("z")],$=this.spacing[this.axisOrder.indexOf("y")],tt=new Vector3(o,0,0),st.multiply(new Matrix4().makeRotationY(Math.PI/2)),_e=(at.RASDimensions[0]-1)/2,st.setPosition(new Vector3(o-_e,0,0));break;case"y":nt.set(0,1,0),rt.set(1,0,0),it.set(0,0,1),j=this.spacing[this.axisOrder.indexOf("x")],$=this.spacing[this.axisOrder.indexOf("z")],tt=new Vector3(0,o,0),st.multiply(new Matrix4().makeRotationX(-Math.PI/2)),_e=(at.RASDimensions[1]-1)/2,st.setPosition(new Vector3(0,o-_e,0));break;case"z":default:nt.set(0,0,1),rt.set(1,0,0),it.set(0,-1,0),j=this.spacing[this.axisOrder.indexOf("x")],$=this.spacing[this.axisOrder.indexOf("y")],tt=new Vector3(0,0,o),_e=(at.RASDimensions[2]-1)/2,st.setPosition(new Vector3(0,0,o-_e));break}let ct,ft;this.segmentation||(rt.applyMatrix4(at.inverseMatrix).normalize(),it.applyMatrix4(at.inverseMatrix).normalize(),nt.applyMatrix4(at.inverseMatrix).normalize()),rt.arglet="i",it.arglet="j",ct=Math.floor(Math.abs(rt.dot(ot))),ft=Math.floor(Math.abs(it.dot(ot)));const ht=Math.abs(ct*j),mt=Math.abs(ft*$);tt=Math.abs(Math.round(tt.applyMatrix4(at.inverseMatrix).dot(nt)));const lt=[new Vector3(1,0,0),new Vector3(0,1,0),new Vector3(0,0,1)],ut=[rt,it,nt].find(function(St){return Math.abs(St.dot(lt[0]))>.9}),dt=[rt,it,nt].find(function(St){return Math.abs(St.dot(lt[1]))>.9}),gt=[rt,it,nt].find(function(St){return Math.abs(St.dot(lt[2]))>.9});function Et(St,Tt){const Mt=ut===nt?tt:ut.arglet==="i"?St:Tt,Bt=dt===nt?tt:dt.arglet==="i"?St:Tt,Rt=gt===nt?tt:gt.arglet==="i"?St:Tt,Ut=ut.dot(lt[0])>0?Mt:at.xLength-1-Mt,Ht=dt.dot(lt[1])>0?Bt:at.yLength-1-Bt,Wt=gt.dot(lt[2])>0?Rt:at.zLength-1-Rt;return at.access(Ut,Ht,Wt)}return{iLength:ct,jLength:ft,sliceAccess:Et,matrix:st,planeWidth:ht,planeHeight:mt}}extractSlice(s,o){const j=new VolumeSlice(this,o,s);return this.sliceList.push(j),j}repaintAllSlices(){return this.sliceList.forEach(function(s){s.repaint()}),this}computeMinMax(){let s=1/0,o=-1/0;const j=this.data.length;let $=0;for($=0;$<j;$++)if(!isNaN(this.data[$])){const _e=this.data[$];s=Math.min(s,_e),o=Math.max(o,_e)}return this.min=s,this.max=o,[s,o]}}class CSS2DObject extends Object3D{constructor(s=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=s,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Vector2(.5,.5),this.addEventListener("removed",function(){this.traverse(function(o){o.element instanceof Element&&o.element.parentNode!==null&&o.element.parentNode.removeChild(o.element)})})}copy(s,o){return super.copy(s,o),this.element=s.element.cloneNode(!0),this.center=s.center,this}}class CSS3DObject extends Object3D{constructor(s=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=s,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(o){o.element instanceof Element&&o.element.parentNode!==null&&o.element.parentNode.removeChild(o.element)})})}copy(s,o){return super.copy(s,o),this.element=s.element.cloneNode(!0),this}}class SVGObject extends Object3D{constructor(s){super(),this.isSVGObject=!0,this.node=s}}function toTrianglesDrawMode(a,s){if(s===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),a;if(s===TriangleFanDrawMode||s===TriangleStripDrawMode){let o=a.getIndex();if(o===null){const tt=[],nt=a.getAttribute("position");if(nt!==void 0){for(let rt=0;rt<nt.count;rt++)tt.push(rt);a.setIndex(tt),o=a.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),a}const j=o.count-2,$=[];if(o)if(s===TriangleFanDrawMode)for(let tt=1;tt<=j;tt++)$.push(o.getX(0)),$.push(o.getX(tt)),$.push(o.getX(tt+1));else for(let tt=0;tt<j;tt++)tt%2===0?($.push(o.getX(tt)),$.push(o.getX(tt+1)),$.push(o.getX(tt+2))):($.push(o.getX(tt+2)),$.push(o.getX(tt+1)),$.push(o.getX(tt)));$.length/3!==j&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const _e=a.clone();return _e.setIndex($),_e.clearGroups(),_e}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",s),a}const version=parseInt(REVISION.replace(/\D+/g,"")),WEBGL_CONSTANTS$1={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},THREE_TO_WEBGL={};THREE_TO_WEBGL[NearestFilter]=WEBGL_CONSTANTS$1.NEAREST;THREE_TO_WEBGL[NearestMipmapNearestFilter]=WEBGL_CONSTANTS$1.NEAREST_MIPMAP_NEAREST;THREE_TO_WEBGL[NearestMipmapLinearFilter]=WEBGL_CONSTANTS$1.NEAREST_MIPMAP_LINEAR;THREE_TO_WEBGL[LinearFilter]=WEBGL_CONSTANTS$1.LINEAR;THREE_TO_WEBGL[LinearMipmapNearestFilter]=WEBGL_CONSTANTS$1.LINEAR_MIPMAP_NEAREST;THREE_TO_WEBGL[LinearMipmapLinearFilter]=WEBGL_CONSTANTS$1.LINEAR_MIPMAP_LINEAR;THREE_TO_WEBGL[ClampToEdgeWrapping]=WEBGL_CONSTANTS$1.CLAMP_TO_EDGE;THREE_TO_WEBGL[RepeatWrapping]=WEBGL_CONSTANTS$1.REPEAT;THREE_TO_WEBGL[MirroredRepeatWrapping]=WEBGL_CONSTANTS$1.MIRRORED_REPEAT;class CharsetEncoder{constructor(){this.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657}}s2u(s){for(var o=this.s2uTable,j="",$=0;$<s.length;){var _e=s[$++];if(!(_e>=0&&_e<=126||_e>=161&&_e<=223)&&$<s.length&&(_e=_e<<8|s[$++]),o[_e]===void 0)return console.error("unknown char code "+_e+"."),j;j+=String.fromCharCode(o[_e])}return j}}class DataViewEx{constructor(s,o){this.dv=new DataView(s),this.offset=0,this.littleEndian=o!==void 0?o:!0,this.encoder=new CharsetEncoder}getInt8(){var s=this.dv.getInt8(this.offset);return this.offset+=1,s}getInt8Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getInt8());return o}getUint8(){var s=this.dv.getUint8(this.offset);return this.offset+=1,s}getUint8Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getUint8());return o}getInt16(){var s=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,s}getInt16Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getInt16());return o}getUint16(){var s=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,s}getUint16Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getUint16());return o}getInt32(){var s=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,s}getInt32Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getInt32());return o}getUint32(){var s=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,s}getUint32Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getUint32());return o}getFloat32(){var s=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,s}getFloat32Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getFloat32());return o}getFloat64(){var s=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,s}getFloat64Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getFloat64());return o}getIndex(s,o){switch(s){case 1:return o===!0?this.getUint8():this.getInt8();case 2:return o===!0?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+s+" exception."}}getIndexArray(s,o,j){for(var $=[],_e=0;_e<o;_e++)$.push(this.getIndex(s,j));return $}getChars(s){for(var o="";s>0;){var j=this.getUint8();if(s--,j===0)break;o+=String.fromCharCode(j)}for(;s>0;)this.getUint8(),s--;return o}getSjisStringsAsUnicode(s){for(var o=[];s>0;){var j=this.getUint8();if(s--,j===0)break;o.push(j)}for(;s>0;)this.getUint8(),s--;return this.encoder.s2u(new Uint8Array(o))}getUnicodeStrings(s){for(var o="";s>0;){var j=this.getUint16();if(s-=2,j===0)break;o+=String.fromCharCode(j)}for(;s>0;)this.getUint8(),s--;return o}getTextBuffer(){var s=this.getUint32();return this.getUnicodeStrings(s)}}class DataCreationHelper{leftToRightVector3(s){s[2]=-s[2]}leftToRightQuaternion(s){s[0]=-s[0],s[1]=-s[1]}leftToRightEuler(s){s[0]=-s[0],s[1]=-s[1]}leftToRightIndexOrder(s){var o=s[2];s[2]=s[0],s[0]=o}leftToRightVector3Range(s,o){var j=-o[2];o[2]=-s[2],s[2]=j}leftToRightEulerRange(s,o){var j=-o[0],$=-o[1];o[0]=-s[0],o[1]=-s[1],s[0]=j,s[1]=$}}class Parser{constructor(){}parsePmd(s,o){var j={},$=new DataViewEx(s);j.metadata={},j.metadata.format="pmd",j.metadata.coordinateSystem="left";var _e=function(){var St=j.metadata;if(St.magic=$.getChars(3),St.magic!=="Pmd")throw"PMD file magic is not Pmd, but "+St.magic;St.version=$.getFloat32(),St.modelName=$.getSjisStringsAsUnicode(20),St.comment=$.getSjisStringsAsUnicode(256)},tt=function(){var St=function(){var Bt={};return Bt.position=$.getFloat32Array(3),Bt.normal=$.getFloat32Array(3),Bt.uv=$.getFloat32Array(2),Bt.skinIndices=$.getUint16Array(2),Bt.skinWeights=[$.getUint8()/100],Bt.skinWeights.push(1-Bt.skinWeights[0]),Bt.edgeFlag=$.getUint8(),Bt},Tt=j.metadata;Tt.vertexCount=$.getUint32(),j.vertices=[];for(var Mt=0;Mt<Tt.vertexCount;Mt++)j.vertices.push(St())},nt=function(){var St=function(){var Bt={};return Bt.indices=$.getUint16Array(3),Bt},Tt=j.metadata;Tt.faceCount=$.getUint32()/3,j.faces=[];for(var Mt=0;Mt<Tt.faceCount;Mt++)j.faces.push(St())},rt=function(){var St=function(){var Bt={};return Bt.diffuse=$.getFloat32Array(4),Bt.shininess=$.getFloat32(),Bt.specular=$.getFloat32Array(3),Bt.ambient=$.getFloat32Array(3),Bt.toonIndex=$.getInt8(),Bt.edgeFlag=$.getUint8(),Bt.faceCount=$.getUint32()/3,Bt.fileName=$.getSjisStringsAsUnicode(20),Bt},Tt=j.metadata;Tt.materialCount=$.getUint32(),j.materials=[];for(var Mt=0;Mt<Tt.materialCount;Mt++)j.materials.push(St())},it=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(20),Bt.parentIndex=$.getInt16(),Bt.tailIndex=$.getInt16(),Bt.type=$.getUint8(),Bt.ikIndex=$.getInt16(),Bt.position=$.getFloat32Array(3),Bt},Tt=j.metadata;Tt.boneCount=$.getUint16(),j.bones=[];for(var Mt=0;Mt<Tt.boneCount;Mt++)j.bones.push(St())},st=function(){var St=function(){var Bt={};Bt.target=$.getUint16(),Bt.effector=$.getUint16(),Bt.linkCount=$.getUint8(),Bt.iteration=$.getUint16(),Bt.maxAngle=$.getFloat32(),Bt.links=[];for(var Rt=0;Rt<Bt.linkCount;Rt++){var Ut={};Ut.index=$.getUint16(),Bt.links.push(Ut)}return Bt},Tt=j.metadata;Tt.ikCount=$.getUint16(),j.iks=[];for(var Mt=0;Mt<Tt.ikCount;Mt++)j.iks.push(St())},at=function(){var St=function(){var Bt={};Bt.name=$.getSjisStringsAsUnicode(20),Bt.elementCount=$.getUint32(),Bt.type=$.getUint8(),Bt.elements=[];for(var Rt=0;Rt<Bt.elementCount;Rt++)Bt.elements.push({index:$.getUint32(),position:$.getFloat32Array(3)});return Bt},Tt=j.metadata;Tt.morphCount=$.getUint16(),j.morphs=[];for(var Mt=0;Mt<Tt.morphCount;Mt++)j.morphs.push(St())},ot=function(){var St=function(){var Bt={};return Bt.index=$.getUint16(),Bt},Tt=j.metadata;Tt.morphFrameCount=$.getUint8(),j.morphFrames=[];for(var Mt=0;Mt<Tt.morphFrameCount;Mt++)j.morphFrames.push(St())},ct=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(50),Bt},Tt=j.metadata;Tt.boneFrameNameCount=$.getUint8(),j.boneFrameNames=[];for(var Mt=0;Mt<Tt.boneFrameNameCount;Mt++)j.boneFrameNames.push(St())},ft=function(){var St=function(){var Bt={};return Bt.boneIndex=$.getInt16(),Bt.frameIndex=$.getUint8(),Bt},Tt=j.metadata;Tt.boneFrameCount=$.getUint32(),j.boneFrames=[];for(var Mt=0;Mt<Tt.boneFrameCount;Mt++)j.boneFrames.push(St())},ht=function(){var St=j.metadata;St.englishCompatibility=$.getUint8(),St.englishCompatibility>0&&(St.englishModelName=$.getSjisStringsAsUnicode(20),St.englishComment=$.getSjisStringsAsUnicode(256))},mt=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(20),Bt},Tt=j.metadata;if(Tt.englishCompatibility!==0){j.englishBoneNames=[];for(var Mt=0;Mt<Tt.boneCount;Mt++)j.englishBoneNames.push(St())}},lt=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(20),Bt},Tt=j.metadata;if(Tt.englishCompatibility!==0){j.englishMorphNames=[];for(var Mt=0;Mt<Tt.morphCount-1;Mt++)j.englishMorphNames.push(St())}},ut=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(50),Bt},Tt=j.metadata;if(Tt.englishCompatibility!==0){j.englishBoneFrameNames=[];for(var Mt=0;Mt<Tt.boneFrameNameCount;Mt++)j.englishBoneFrameNames.push(St())}},dt=function(){var St=function(){var Mt={};return Mt.fileName=$.getSjisStringsAsUnicode(100),Mt};j.toonTextures=[];for(var Tt=0;Tt<10;Tt++)j.toonTextures.push(St())},gt=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(20),Bt.boneIndex=$.getInt16(),Bt.groupIndex=$.getUint8(),Bt.groupTarget=$.getUint16(),Bt.shapeType=$.getUint8(),Bt.width=$.getFloat32(),Bt.height=$.getFloat32(),Bt.depth=$.getFloat32(),Bt.position=$.getFloat32Array(3),Bt.rotation=$.getFloat32Array(3),Bt.weight=$.getFloat32(),Bt.positionDamping=$.getFloat32(),Bt.rotationDamping=$.getFloat32(),Bt.restitution=$.getFloat32(),Bt.friction=$.getFloat32(),Bt.type=$.getUint8(),Bt},Tt=j.metadata;Tt.rigidBodyCount=$.getUint32(),j.rigidBodies=[];for(var Mt=0;Mt<Tt.rigidBodyCount;Mt++)j.rigidBodies.push(St())},Et=function(){var St=function(){var Bt={};return Bt.name=$.getSjisStringsAsUnicode(20),Bt.rigidBodyIndex1=$.getUint32(),Bt.rigidBodyIndex2=$.getUint32(),Bt.position=$.getFloat32Array(3),Bt.rotation=$.getFloat32Array(3),Bt.translationLimitation1=$.getFloat32Array(3),Bt.translationLimitation2=$.getFloat32Array(3),Bt.rotationLimitation1=$.getFloat32Array(3),Bt.rotationLimitation2=$.getFloat32Array(3),Bt.springPosition=$.getFloat32Array(3),Bt.springRotation=$.getFloat32Array(3),Bt},Tt=j.metadata;Tt.constraintCount=$.getUint32(),j.constraints=[];for(var Mt=0;Mt<Tt.constraintCount;Mt++)j.constraints.push(St())};return _e(),tt(),nt(),rt(),it(),st(),at(),ot(),ct(),ft(),ht(),mt(),lt(),ut(),dt(),gt(),Et(),o===!0&&this.leftToRightModel(j),j}parsePmx(s,o){var j={},$=new DataViewEx(s);j.metadata={},j.metadata.format="pmx",j.metadata.coordinateSystem="left";var _e=function(){var ht=j.metadata;if(ht.magic=$.getChars(4),ht.magic!=="PMX ")throw"PMX file magic is not PMX , but "+ht.magic;if(ht.version=$.getFloat32(),ht.version!==2&&ht.version!==2.1)throw"PMX version "+ht.version+" is not supported.";ht.headerSize=$.getUint8(),ht.encoding=$.getUint8(),ht.additionalUvNum=$.getUint8(),ht.vertexIndexSize=$.getUint8(),ht.textureIndexSize=$.getUint8(),ht.materialIndexSize=$.getUint8(),ht.boneIndexSize=$.getUint8(),ht.morphIndexSize=$.getUint8(),ht.rigidBodyIndexSize=$.getUint8(),ht.modelName=$.getTextBuffer(),ht.englishModelName=$.getTextBuffer(),ht.comment=$.getTextBuffer(),ht.englishComment=$.getTextBuffer()},tt=function(){var ht=function(){var ut={};ut.position=$.getFloat32Array(3),ut.normal=$.getFloat32Array(3),ut.uv=$.getFloat32Array(2),ut.auvs=[];for(var dt=0;dt<j.metadata.additionalUvNum;dt++)ut.auvs.push($.getFloat32Array(4));ut.type=$.getUint8();var gt=mt.boneIndexSize;if(ut.type===0)ut.skinIndices=$.getIndexArray(gt,1),ut.skinWeights=[1];else if(ut.type===1)ut.skinIndices=$.getIndexArray(gt,2),ut.skinWeights=$.getFloat32Array(1),ut.skinWeights.push(1-ut.skinWeights[0]);else if(ut.type===2)ut.skinIndices=$.getIndexArray(gt,4),ut.skinWeights=$.getFloat32Array(4);else if(ut.type===3)ut.skinIndices=$.getIndexArray(gt,2),ut.skinWeights=$.getFloat32Array(1),ut.skinWeights.push(1-ut.skinWeights[0]),ut.skinC=$.getFloat32Array(3),ut.skinR0=$.getFloat32Array(3),ut.skinR1=$.getFloat32Array(3),ut.type=1;else throw"unsupport bone type "+ut.type+" exception.";return ut.edgeRatio=$.getFloat32(),ut},mt=j.metadata;mt.vertexCount=$.getUint32(),j.vertices=[];for(var lt=0;lt<mt.vertexCount;lt++)j.vertices.push(ht())},nt=function(){var ht=function(){var ut={};return ut.indices=$.getIndexArray(mt.vertexIndexSize,3,!0),ut},mt=j.metadata;mt.faceCount=$.getUint32()/3,j.faces=[];for(var lt=0;lt<mt.faceCount;lt++)j.faces.push(ht())},rt=function(){var ht=function(){return $.getTextBuffer()},mt=j.metadata;mt.textureCount=$.getUint32(),j.textures=[];for(var lt=0;lt<mt.textureCount;lt++)j.textures.push(ht())},it=function(){var ht=function(){var ut={};if(ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.diffuse=$.getFloat32Array(4),ut.specular=$.getFloat32Array(3),ut.shininess=$.getFloat32(),ut.ambient=$.getFloat32Array(3),ut.flag=$.getUint8(),ut.edgeColor=$.getFloat32Array(4),ut.edgeSize=$.getFloat32(),ut.textureIndex=$.getIndex(j.metadata.textureIndexSize),ut.envTextureIndex=$.getIndex(j.metadata.textureIndexSize),ut.envFlag=$.getUint8(),ut.toonFlag=$.getUint8(),ut.toonFlag===0)ut.toonIndex=$.getIndex(j.metadata.textureIndexSize);else if(ut.toonFlag===1)ut.toonIndex=$.getInt8();else throw"unknown toon flag "+ut.toonFlag+" exception.";return ut.comment=$.getTextBuffer(),ut.faceCount=$.getUint32()/3,ut},mt=j.metadata;mt.materialCount=$.getUint32(),j.materials=[];for(var lt=0;lt<mt.materialCount;lt++)j.materials.push(ht())},st=function(){var ht=function(){var ut={};if(ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.position=$.getFloat32Array(3),ut.parentIndex=$.getIndex(j.metadata.boneIndexSize),ut.transformationClass=$.getUint32(),ut.flag=$.getUint16(),ut.flag&1?ut.connectIndex=$.getIndex(j.metadata.boneIndexSize):ut.offsetPosition=$.getFloat32Array(3),ut.flag&256||ut.flag&512){var dt={};dt.isLocal=!!(ut.flag&128),dt.affectRotation=!!(ut.flag&256),dt.affectPosition=!!(ut.flag&512),dt.parentIndex=$.getIndex(j.metadata.boneIndexSize),dt.ratio=$.getFloat32(),ut.grant=dt}if(ut.flag&1024&&(ut.fixAxis=$.getFloat32Array(3)),ut.flag&2048&&(ut.localXVector=$.getFloat32Array(3),ut.localZVector=$.getFloat32Array(3)),ut.flag&8192&&(ut.key=$.getUint32()),ut.flag&32){var gt={};gt.effector=$.getIndex(j.metadata.boneIndexSize),gt.target=null,gt.iteration=$.getUint32(),gt.maxAngle=$.getFloat32(),gt.linkCount=$.getUint32(),gt.links=[];for(var Et=0;Et<gt.linkCount;Et++){var St={};St.index=$.getIndex(j.metadata.boneIndexSize),St.angleLimitation=$.getUint8(),St.angleLimitation===1&&(St.lowerLimitationAngle=$.getFloat32Array(3),St.upperLimitationAngle=$.getFloat32Array(3)),gt.links.push(St)}ut.ik=gt}return ut},mt=j.metadata;mt.boneCount=$.getUint32(),j.bones=[];for(var lt=0;lt<mt.boneCount;lt++)j.bones.push(ht())},at=function(){var ht=function(){var ut={};ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.panel=$.getUint8(),ut.type=$.getUint8(),ut.elementCount=$.getUint32(),ut.elements=[];for(var dt=0;dt<ut.elementCount;dt++)if(ut.type===0){var gt={};gt.index=$.getIndex(j.metadata.morphIndexSize),gt.ratio=$.getFloat32(),ut.elements.push(gt)}else if(ut.type===1){var gt={};gt.index=$.getIndex(j.metadata.vertexIndexSize,!0),gt.position=$.getFloat32Array(3),ut.elements.push(gt)}else if(ut.type===2){var gt={};gt.index=$.getIndex(j.metadata.boneIndexSize),gt.position=$.getFloat32Array(3),gt.rotation=$.getFloat32Array(4),ut.elements.push(gt)}else if(ut.type===3){var gt={};gt.index=$.getIndex(j.metadata.vertexIndexSize,!0),gt.uv=$.getFloat32Array(4),ut.elements.push(gt)}else if(ut.type!==4){if(ut.type!==5){if(ut.type!==6){if(ut.type!==7){if(ut.type===8){var gt={};gt.index=$.getIndex(j.metadata.materialIndexSize),gt.type=$.getUint8(),gt.diffuse=$.getFloat32Array(4),gt.specular=$.getFloat32Array(3),gt.shininess=$.getFloat32(),gt.ambient=$.getFloat32Array(3),gt.edgeColor=$.getFloat32Array(4),gt.edgeSize=$.getFloat32(),gt.textureColor=$.getFloat32Array(4),gt.sphereTextureColor=$.getFloat32Array(4),gt.toonColor=$.getFloat32Array(4),ut.elements.push(gt)}}}}}return ut},mt=j.metadata;mt.morphCount=$.getUint32(),j.morphs=[];for(var lt=0;lt<mt.morphCount;lt++)j.morphs.push(ht())},ot=function(){var ht=function(){var ut={};ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.type=$.getUint8(),ut.elementCount=$.getUint32(),ut.elements=[];for(var dt=0;dt<ut.elementCount;dt++){var gt={};gt.target=$.getUint8(),gt.index=gt.target===0?$.getIndex(j.metadata.boneIndexSize):$.getIndex(j.metadata.morphIndexSize),ut.elements.push(gt)}return ut},mt=j.metadata;mt.frameCount=$.getUint32(),j.frames=[];for(var lt=0;lt<mt.frameCount;lt++)j.frames.push(ht())},ct=function(){var ht=function(){var ut={};return ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.boneIndex=$.getIndex(j.metadata.boneIndexSize),ut.groupIndex=$.getUint8(),ut.groupTarget=$.getUint16(),ut.shapeType=$.getUint8(),ut.width=$.getFloat32(),ut.height=$.getFloat32(),ut.depth=$.getFloat32(),ut.position=$.getFloat32Array(3),ut.rotation=$.getFloat32Array(3),ut.weight=$.getFloat32(),ut.positionDamping=$.getFloat32(),ut.rotationDamping=$.getFloat32(),ut.restitution=$.getFloat32(),ut.friction=$.getFloat32(),ut.type=$.getUint8(),ut},mt=j.metadata;mt.rigidBodyCount=$.getUint32(),j.rigidBodies=[];for(var lt=0;lt<mt.rigidBodyCount;lt++)j.rigidBodies.push(ht())},ft=function(){var ht=function(){var ut={};return ut.name=$.getTextBuffer(),ut.englishName=$.getTextBuffer(),ut.type=$.getUint8(),ut.rigidBodyIndex1=$.getIndex(j.metadata.rigidBodyIndexSize),ut.rigidBodyIndex2=$.getIndex(j.metadata.rigidBodyIndexSize),ut.position=$.getFloat32Array(3),ut.rotation=$.getFloat32Array(3),ut.translationLimitation1=$.getFloat32Array(3),ut.translationLimitation2=$.getFloat32Array(3),ut.rotationLimitation1=$.getFloat32Array(3),ut.rotationLimitation2=$.getFloat32Array(3),ut.springPosition=$.getFloat32Array(3),ut.springRotation=$.getFloat32Array(3),ut},mt=j.metadata;mt.constraintCount=$.getUint32(),j.constraints=[];for(var lt=0;lt<mt.constraintCount;lt++)j.constraints.push(ht())};return _e(),tt(),nt(),rt(),it(),st(),at(),ot(),ct(),ft(),o===!0&&this.leftToRightModel(j),j}parseVmd(s,o){var j={},$=new DataViewEx(s);j.metadata={},j.metadata.coordinateSystem="left";var _e=function(){var it=j.metadata;if(it.magic=$.getChars(30),it.magic!=="Vocaloid Motion Data 0002")throw"VMD file magic is not Vocaloid Motion Data 0002, but "+it.magic;it.name=$.getSjisStringsAsUnicode(20)},tt=function(){var it=function(){var ot={};return ot.boneName=$.getSjisStringsAsUnicode(15),ot.frameNum=$.getUint32(),ot.position=$.getFloat32Array(3),ot.rotation=$.getFloat32Array(4),ot.interpolation=$.getUint8Array(64),ot},st=j.metadata;st.motionCount=$.getUint32(),j.motions=[];for(var at=0;at<st.motionCount;at++)j.motions.push(it())},nt=function(){var it=function(){var ot={};return ot.morphName=$.getSjisStringsAsUnicode(15),ot.frameNum=$.getUint32(),ot.weight=$.getFloat32(),ot},st=j.metadata;st.morphCount=$.getUint32(),j.morphs=[];for(var at=0;at<st.morphCount;at++)j.morphs.push(it())},rt=function(){var it=function(){var ot={};return ot.frameNum=$.getUint32(),ot.distance=$.getFloat32(),ot.position=$.getFloat32Array(3),ot.rotation=$.getFloat32Array(3),ot.interpolation=$.getUint8Array(24),ot.fov=$.getUint32(),ot.perspective=$.getUint8(),ot},st=j.metadata;st.cameraCount=$.getUint32(),j.cameras=[];for(var at=0;at<st.cameraCount;at++)j.cameras.push(it())};return _e(),tt(),nt(),rt(),o===!0&&this.leftToRightVmd(j),j}parseVpd(s,o){var j={};j.metadata={},j.metadata.coordinateSystem="left",j.bones=[];var $=/\/\/\w*(\r|\n|\r\n)/g,_e=/\r|\n|\r\n/,tt=s.replace($,"").split(_e);function nt(){throw"the file seems not vpd file."}function rt(){tt[0]!=="Vocaloid Pose Data file"&&nt()}function it(){tt.length<4&&nt(),j.metadata.parentFile=tt[2],j.metadata.boneCount=parseInt(tt[3])}function st(){for(var at=/^\s*(Bone[0-9]+)\s*\{\s*(.*)$/,ot=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,ct=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,ft=/^\s*}/,ht=j.bones,mt=null,lt=null,ut=null,dt=4;dt<tt.length;dt++){var gt=tt[dt],Et;Et=gt.match(at),Et!==null&&(mt!==null&&nt(),mt=Et[2]),Et=gt.match(ot),Et!==null&&(lt!==null&&nt(),lt=[parseFloat(Et[1]),parseFloat(Et[2]),parseFloat(Et[3])]),Et=gt.match(ct),Et!==null&&(ut!==null&&nt(),ut=[parseFloat(Et[1]),parseFloat(Et[2]),parseFloat(Et[3]),parseFloat(Et[4])]),Et=gt.match(ft),Et!==null&&((mt===null||lt===null||ut===null)&&nt(),ht.push({name:mt,translation:lt,quaternion:ut}),mt=null,lt=null,ut=null)}(mt!==null||lt!==null||ut!==null)&&nt()}return rt(),it(),st(),o===!0&&this.leftToRightVpd(j),j}mergeVmds(s){var o={};o.metadata={},o.metadata.name=s[0].metadata.name,o.metadata.coordinateSystem=s[0].metadata.coordinateSystem,o.metadata.motionCount=0,o.metadata.morphCount=0,o.metadata.cameraCount=0,o.motions=[],o.morphs=[],o.cameras=[];for(var j=0;j<s.length;j++){var $=s[j];o.metadata.motionCount+=$.metadata.motionCount,o.metadata.morphCount+=$.metadata.morphCount,o.metadata.cameraCount+=$.metadata.cameraCount;for(var _e=0;_e<$.metadata.motionCount;_e++)o.motions.push($.motions[_e]);for(var _e=0;_e<$.metadata.morphCount;_e++)o.morphs.push($.morphs[_e]);for(var _e=0;_e<$.metadata.cameraCount;_e++)o.cameras.push($.cameras[_e])}return o}leftToRightModel(s){if(s.metadata.coordinateSystem!=="right"){s.metadata.coordinateSystem="right";for(var o=new DataCreationHelper,j=0;j<s.metadata.vertexCount;j++)o.leftToRightVector3(s.vertices[j].position),o.leftToRightVector3(s.vertices[j].normal);for(var j=0;j<s.metadata.faceCount;j++)o.leftToRightIndexOrder(s.faces[j].indices);for(var j=0;j<s.metadata.boneCount;j++)o.leftToRightVector3(s.bones[j].position);for(var j=0;j<s.metadata.morphCount;j++){var $=s.morphs[j];if(!(s.metadata.format==="pmx"&&$.type!==1))for(var _e=0;_e<$.elements.length;_e++)o.leftToRightVector3($.elements[_e].position)}for(var j=0;j<s.metadata.rigidBodyCount;j++)o.leftToRightVector3(s.rigidBodies[j].position),o.leftToRightEuler(s.rigidBodies[j].rotation);for(var j=0;j<s.metadata.constraintCount;j++)o.leftToRightVector3(s.constraints[j].position),o.leftToRightEuler(s.constraints[j].rotation),o.leftToRightVector3Range(s.constraints[j].translationLimitation1,s.constraints[j].translationLimitation2),o.leftToRightEulerRange(s.constraints[j].rotationLimitation1,s.constraints[j].rotationLimitation2)}}leftToRightVmd(s){if(s.metadata.coordinateSystem!=="right"){s.metadata.coordinateSystem="right";for(var o=new DataCreationHelper,j=0;j<s.metadata.motionCount;j++)o.leftToRightVector3(s.motions[j].position),o.leftToRightQuaternion(s.motions[j].rotation);for(var j=0;j<s.metadata.cameraCount;j++)o.leftToRightVector3(s.cameras[j].position),o.leftToRightEuler(s.cameras[j].rotation)}}leftToRightVpd(s){if(s.metadata.coordinateSystem!=="right"){s.metadata.coordinateSystem="right";for(var o=new DataCreationHelper,j=0;j<s.bones.length;j++)o.leftToRightVector3(s.bones[j].translation),o.leftToRightQuaternion(s.bones[j].quaternion)}}}const _vector$3=new Vector3,_matrix$1=new Matrix4;function getPosition(a,s){return _vector$3.setFromMatrixPosition(a.matrixWorld).applyMatrix4(s)}function setPositionOfBoneToAttributeArray(a,s,o,j){const $=getPosition(o,j);a[s*3+0]=$.x,a[s*3+1]=$.y,a[s*3+2]=$.z}class CCDIKHelper extends Object3D{constructor(s,o=[],j=.25){super(),this.root=s,this.iks=o,this.matrix.copy(s.matrixWorld),this.matrixAutoUpdate=!1,this.sphereGeometry=new SphereGeometry(j,16,8),this.targetSphereMaterial=new MeshBasicMaterial({color:new Color(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new MeshBasicMaterial({color:new Color(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new MeshBasicMaterial({color:new Color(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new LineBasicMaterial({color:new Color(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init()}updateMatrixWorld(s){const o=this.root;if(this.visible){let j=0;const $=this.iks,_e=o.skeleton.bones;_matrix$1.copy(o.matrixWorld).invert();for(let tt=0,nt=$.length;tt<nt;tt++){const rt=$[tt],it=_e[rt.target],st=_e[rt.effector],at=this.children[j++],ot=this.children[j++];at.position.copy(getPosition(it,_matrix$1)),ot.position.copy(getPosition(st,_matrix$1));for(let ht=0,mt=rt.links.length;ht<mt;ht++){const lt=rt.links[ht],ut=_e[lt.index];this.children[j++].position.copy(getPosition(ut,_matrix$1))}const ct=this.children[j++],ft=ct.geometry.attributes.position.array;setPositionOfBoneToAttributeArray(ft,0,it,_matrix$1),setPositionOfBoneToAttributeArray(ft,1,st,_matrix$1);for(let ht=0,mt=rt.links.length;ht<mt;ht++){const lt=rt.links[ht],ut=_e[lt.index];setPositionOfBoneToAttributeArray(ft,ht+2,ut,_matrix$1)}ct.geometry.attributes.position.needsUpdate=!0}}this.matrix.copy(o.matrixWorld),super.updateMatrixWorld(s)}dispose(){this.sphereGeometry.dispose(),this.targetSphereMaterial.dispose(),this.effectorSphereMaterial.dispose(),this.linkSphereMaterial.dispose(),this.lineMaterial.dispose();const s=this.children;for(let o=0;o<s.length;o++){const j=s[o];j.isLine&&j.geometry.dispose()}}_init(){const s=this,o=this.iks;function j(rt){const it=new BufferGeometry,st=new Float32Array((2+rt.links.length)*3);return it.setAttribute("position",new BufferAttribute(st,3)),it}function $(){return new Mesh(s.sphereGeometry,s.targetSphereMaterial)}function _e(){return new Mesh(s.sphereGeometry,s.effectorSphereMaterial)}function tt(){return new Mesh(s.sphereGeometry,s.linkSphereMaterial)}function nt(rt){return new Line(j(rt),s.lineMaterial)}for(let rt=0,it=o.length;rt<it;rt++){const st=o[rt];this.add($()),this.add(_e());for(let at=0,ot=st.links.length;at<ot;at++)this.add(tt());this.add(nt(st))}}}class CapsuleGeometry extends LatheGeometry{constructor(s=1,o=1,j=4,$=8){const _e=new Path;_e.absarc(0,-o/2,s,Math.PI*1.5,0),_e.absarc(0,o/2,s,0,Math.PI*.5),super(_e.getPoints(j),$),this.type="CapsuleGeometry",this.parameters={radius:s,height:o,capSegments:j,radialSegments:$}}static fromJSON(s){return new CapsuleGeometry(s.radius,s.length,s.capSegments,s.radialSegments)}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_matrixWorldInv=new Matrix4;class MMDPhysicsHelper extends Object3D{constructor(s,o){super(),this.root=s,this.physics=o,this.matrix.copy(s.matrixWorld),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new MeshBasicMaterial({color:new Color(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init()}dispose(){const s=this.materials,o=this.children;for(let j=0;j<s.length;j++)s[j].dispose();for(let j=0;j<o.length;j++){const $=o[j];$.isMesh&&$.geometry.dispose()}}updateMatrixWorld(s){var o=this.root;if(this.visible){var j=this.physics.bodies;_matrixWorldInv.copy(o.matrixWorld).decompose(_position,_quaternion,_scale).compose(_position,_quaternion,_scale.set(1,1,1)).invert();for(var $=0,_e=j.length;$<_e;$++){var tt=j[$].body,nt=this.children[$],rt=tt.getCenterOfMassTransform(),it=rt.getOrigin(),st=rt.getRotation();nt.position.set(it.x(),it.y(),it.z()).applyMatrix4(_matrixWorldInv),nt.quaternion.setFromRotationMatrix(_matrixWorldInv).multiply(_quaternion.set(st.x(),st.y(),st.z(),st.w()))}}this.matrix.copy(o.matrixWorld).decompose(_position,_quaternion,_scale).compose(_position,_quaternion,_scale.set(1,1,1)),super.updateMatrixWorld(s)}_init(){var s=this.physics.bodies;function o(tt){switch(tt.shapeType){case 0:return new SphereGeometry(tt.width,16,8);case 1:return new BoxGeometry(tt.width*2,tt.height*2,tt.depth*2,8,8,8);case 2:return new CapsuleGeometry(tt.width,tt.height,8,16);default:return null}}for(var j=0,$=s.length;j<$;j++){var _e=s[j].params;this.add(new Mesh(o(_e),this.materials[_e.type]))}}}const _Reflector=class extends Mesh{constructor(a,s={}){super(a),this.isReflector=!0,this.type="Reflector",this.camera=new PerspectiveCamera;const o=this,j=s.color!==void 0?new Color(s.color):new Color(8355711),$=s.textureWidth||512,_e=s.textureHeight||512,tt=s.clipBias||0,nt=s.shader||_Reflector.ReflectorShader,rt=s.multisample!==void 0?s.multisample:4,it=new Plane,st=new Vector3,at=new Vector3,ot=new Vector3,ct=new Matrix4,ft=new Vector3(0,0,-1),ht=new Vector4,mt=new Vector3,lt=new Vector3,ut=new Vector4,dt=new Matrix4,gt=this.camera,Et=new WebGLRenderTarget($,_e,{samples:rt,type:HalfFloatType}),St=new ShaderMaterial({uniforms:UniformsUtils.clone(nt.uniforms),fragmentShader:nt.fragmentShader,vertexShader:nt.vertexShader});St.uniforms.tDiffuse.value=Et.texture,St.uniforms.color.value=j,St.uniforms.textureMatrix.value=dt,this.material=St,this.onBeforeRender=function(Tt,Mt,Bt){if(at.setFromMatrixPosition(o.matrixWorld),ot.setFromMatrixPosition(Bt.matrixWorld),ct.extractRotation(o.matrixWorld),st.set(0,0,1),st.applyMatrix4(ct),mt.subVectors(at,ot),mt.dot(st)>0)return;mt.reflect(st).negate(),mt.add(at),ct.extractRotation(Bt.matrixWorld),ft.set(0,0,-1),ft.applyMatrix4(ct),ft.add(ot),lt.subVectors(at,ft),lt.reflect(st).negate(),lt.add(at),gt.position.copy(mt),gt.up.set(0,1,0),gt.up.applyMatrix4(ct),gt.up.reflect(st),gt.lookAt(lt),gt.far=Bt.far,gt.updateMatrixWorld(),gt.projectionMatrix.copy(Bt.projectionMatrix),dt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),dt.multiply(gt.projectionMatrix),dt.multiply(gt.matrixWorldInverse),dt.multiply(o.matrixWorld),it.setFromNormalAndCoplanarPoint(st,at),it.applyMatrix4(gt.matrixWorldInverse),ht.set(it.normal.x,it.normal.y,it.normal.z,it.constant);const Rt=gt.projectionMatrix;ut.x=(Math.sign(ht.x)+Rt.elements[8])/Rt.elements[0],ut.y=(Math.sign(ht.y)+Rt.elements[9])/Rt.elements[5],ut.z=-1,ut.w=(1+Rt.elements[10])/Rt.elements[14],ht.multiplyScalar(2/ht.dot(ut)),Rt.elements[2]=ht.x,Rt.elements[6]=ht.y,Rt.elements[10]=ht.z+1-tt,Rt.elements[14]=ht.w,o.visible=!1;const Ut=Tt.getRenderTarget(),Ht=Tt.xr.enabled,Wt=Tt.shadowMap.autoUpdate,Jt=Tt.toneMapping;let sn=!1;"outputColorSpace"in Tt?sn=Tt.outputColorSpace==="srgb":sn=Tt.outputEncoding===3001,Tt.xr.enabled=!1,Tt.shadowMap.autoUpdate=!1,"outputColorSpace"in Tt?Tt.outputColorSpace="linear-srgb":Tt.outputEncoding=3e3,Tt.toneMapping=NoToneMapping,Tt.setRenderTarget(Et),Tt.state.buffers.depth.setMask(!0),Tt.autoClear===!1&&Tt.clear(),Tt.render(Mt,gt),Tt.xr.enabled=Ht,Tt.shadowMap.autoUpdate=Wt,Tt.toneMapping=Jt,"outputColorSpace"in Tt?Tt.outputColorSpace=sn?"srgb":"srgb-linear":Tt.outputEncoding=sn?3001:3e3,Tt.setRenderTarget(Ut);const jt=Bt.viewport;jt!==void 0&&Tt.state.viewport(jt),o.visible=!0},this.getRenderTarget=function(){return Et},this.dispose=function(){Et.dispose(),o.material.dispose()}}};let Reflector=_Reflector;const _Refractor=class extends Mesh{constructor(a,s={}){super(a),this.isRefractor=!0,this.type="Refractor",this.camera=new PerspectiveCamera;const o=this,j=s.color!==void 0?new Color(s.color):new Color(8355711),$=s.textureWidth||512,_e=s.textureHeight||512,tt=s.clipBias||0,nt=s.shader||_Refractor.RefractorShader,rt=s.multisample!==void 0?s.multisample:4,it=this.camera;it.matrixAutoUpdate=!1,it.userData.refractor=!0;const st=new Plane,at=new Matrix4,ot=new WebGLRenderTarget($,_e,{samples:rt,type:HalfFloatType});this.material=new ShaderMaterial({uniforms:UniformsUtils.clone(nt.uniforms),vertexShader:nt.vertexShader,fragmentShader:nt.fragmentShader,transparent:!0}),this.material.uniforms.color.value=j,this.material.uniforms.tDiffuse.value=ot.texture,this.material.uniforms.textureMatrix.value=at;const ct=function(){const ut=new Vector3,dt=new Vector3,gt=new Matrix4,Et=new Vector3,St=new Vector3;return function(Mt){return ut.setFromMatrixPosition(o.matrixWorld),dt.setFromMatrixPosition(Mt.matrixWorld),Et.subVectors(ut,dt),gt.extractRotation(o.matrixWorld),St.set(0,0,1),St.applyMatrix4(gt),Et.dot(St)<0}}(),ft=function(){const ut=new Vector3,dt=new Vector3,gt=new Quaternion,Et=new Vector3;return function(){o.matrixWorld.decompose(dt,gt,Et),ut.set(0,0,1).applyQuaternion(gt).normalize(),ut.negate(),st.setFromNormalAndCoplanarPoint(ut,dt)}}(),ht=function(){const ut=new Plane,dt=new Vector4,gt=new Vector4;return function(St){it.matrixWorld.copy(St.matrixWorld),it.matrixWorldInverse.copy(it.matrixWorld).invert(),it.projectionMatrix.copy(St.projectionMatrix),it.far=St.far,ut.copy(st),ut.applyMatrix4(it.matrixWorldInverse),dt.set(ut.normal.x,ut.normal.y,ut.normal.z,ut.constant);const Tt=it.projectionMatrix;gt.x=(Math.sign(dt.x)+Tt.elements[8])/Tt.elements[0],gt.y=(Math.sign(dt.y)+Tt.elements[9])/Tt.elements[5],gt.z=-1,gt.w=(1+Tt.elements[10])/Tt.elements[14],dt.multiplyScalar(2/dt.dot(gt)),Tt.elements[2]=dt.x,Tt.elements[6]=dt.y,Tt.elements[10]=dt.z+1-tt,Tt.elements[14]=dt.w}}();function mt(ut){at.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),at.multiply(ut.projectionMatrix),at.multiply(ut.matrixWorldInverse),at.multiply(o.matrixWorld)}function lt(ut,dt,gt){o.visible=!1;const Et=ut.getRenderTarget(),St=ut.xr.enabled,Tt=ut.shadowMap.autoUpdate,Mt=ut.toneMapping;let Bt=!1;"outputColorSpace"in ut?Bt=ut.outputColorSpace==="srgb":Bt=ut.outputEncoding===3001,ut.xr.enabled=!1,ut.shadowMap.autoUpdate=!1,"outputColorSpace"in ut?ut.outputColorSpace="linear-srgb":ut.outputEncoding=3e3,ut.toneMapping=NoToneMapping,ut.setRenderTarget(ot),ut.autoClear===!1&&ut.clear(),ut.render(dt,it),ut.xr.enabled=St,ut.shadowMap.autoUpdate=Tt,ut.toneMapping=Mt,ut.setRenderTarget(Et),"outputColorSpace"in ut?ut.outputColorSpace=Bt?"srgb":"srgb-linear":ut.outputEncoding=Bt?3001:3e3;const Rt=gt.viewport;Rt!==void 0&&ut.state.viewport(Rt),o.visible=!0}this.onBeforeRender=function(ut,dt,gt){gt.userData.refractor!==!0&&ct(gt)&&(ft(),mt(gt),ht(gt),lt(ut,dt,gt))},this.getRenderTarget=function(){return ot},this.dispose=function(){ot.dispose(),o.material.dispose()}}};let Refractor=_Refractor;const _shadowMatrix=new Matrix4;class ShadowMesh extends Mesh{constructor(s){const o=new MeshBasicMaterial({color:0,transparent:!0,opacity:.6,depthWrite:!1,stencilWrite:!0,stencilFunc:EqualStencilFunc,stencilRef:0,stencilZPass:IncrementStencilOp});super(s.geometry,o),this.isShadowMesh=!0,this.meshMatrix=s.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1}update(s,o){const j=s.normal.x*o.x+s.normal.y*o.y+s.normal.z*o.z+-s.constant*o.w,$=_shadowMatrix.elements;$[0]=j-o.x*s.normal.x,$[4]=-o.x*s.normal.y,$[8]=-o.x*s.normal.z,$[12]=-o.x*-s.constant,$[1]=-o.y*s.normal.x,$[5]=j-o.y*s.normal.y,$[9]=-o.y*s.normal.z,$[13]=-o.y*-s.constant,$[2]=-o.z*s.normal.x,$[6]=-o.z*s.normal.y,$[10]=j-o.z*s.normal.z,$[14]=-o.z*-s.constant,$[3]=-o.w*s.normal.x,$[7]=-o.w*s.normal.y,$[11]=-o.w*s.normal.z,$[15]=j-o.w*-s.constant,this.matrix.multiplyMatrices(_shadowMatrix,this.meshMatrix)}}const _Lensflare=class extends Mesh{constructor(){super(_Lensflare.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const a=new Vector3,s=new Vector3,o=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);o.minFilter=NearestFilter,o.magFilter=NearestFilter,o.wrapS=ClampToEdgeWrapping,o.wrapT=ClampToEdgeWrapping;const j=new DataTexture(new Uint8Array(16*16*3),16,16,RGBAFormat);j.minFilter=NearestFilter,j.magFilter=NearestFilter,j.wrapS=ClampToEdgeWrapping,j.wrapT=ClampToEdgeWrapping;const $=_Lensflare.Geometry,_e=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),tt=new RawShaderMaterial({uniforms:{map:{value:o},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),nt=new Mesh($,_e),rt=[],it=LensflareElement.Shader,st=new RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:j},color:{value:new Color(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:it.vertexShader,fragmentShader:it.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),at=new Mesh($,st);this.addElement=function(mt){rt.push(mt)};const ot=new Vector2,ct=new Vector2,ft=new Box2,ht=new Vector4;this.onBeforeRender=function(mt,lt,ut){mt.getCurrentViewport(ht);const dt=ht.w/ht.z,gt=ht.z/2,Et=ht.w/2;let St=16/ht.w;if(ot.set(St*dt,St),ft.min.set(ht.x,ht.y),ft.max.set(ht.x+(ht.z-16),ht.y+(ht.w-16)),s.setFromMatrixPosition(this.matrixWorld),s.applyMatrix4(ut.matrixWorldInverse),!(s.z>0)&&(a.copy(s).applyMatrix4(ut.projectionMatrix),ct.x=ht.x+a.x*gt+gt-8,ct.y=ht.y+a.y*Et+Et-8,ft.containsPoint(ct))){mt.copyFramebufferToTexture(ct,o);let Tt=_e.uniforms;Tt.scale.value=ot,Tt.screenPosition.value=a,mt.renderBufferDirect(ut,null,$,_e,nt,null),mt.copyFramebufferToTexture(ct,j),Tt=tt.uniforms,Tt.scale.value=ot,Tt.screenPosition.value=a,mt.renderBufferDirect(ut,null,$,tt,nt,null);const Mt=-a.x*2,Bt=-a.y*2;for(let Rt=0,Ut=rt.length;Rt<Ut;Rt++){const Ht=rt[Rt],Wt=st.uniforms;Wt.color.value.copy(Ht.color),Wt.map.value=Ht.texture,Wt.screenPosition.value.x=a.x+Mt*Ht.distance,Wt.screenPosition.value.y=a.y+Bt*Ht.distance,St=Ht.size/ht.w;const Jt=ht.w/ht.z;Wt.scale.value.set(St*Jt,St),st.uniformsNeedUpdate=!0,mt.renderBufferDirect(ut,null,$,st,at,null)}}},this.dispose=function(){_e.dispose(),tt.dispose(),st.dispose(),o.dispose(),j.dispose();for(let mt=0,lt=rt.length;mt<lt;mt++)rt[mt].texture.dispose()}}};class LensflareElement{constructor(s,o=1,j=0,$=new Color(16777215)){this.texture=s,this.size=o,this.distance=j,this.color=$}}class Water extends Mesh{constructor(s,o={}){super(s),this.isWater=!0;const j=this,$=o.textureWidth!==void 0?o.textureWidth:512,_e=o.textureHeight!==void 0?o.textureHeight:512,tt=o.clipBias!==void 0?o.clipBias:0,nt=o.alpha!==void 0?o.alpha:1,rt=o.time!==void 0?o.time:0,it=o.waterNormals!==void 0?o.waterNormals:null,st=o.sunDirection!==void 0?o.sunDirection:new Vector3(.70707,.70707,0),at=new Color(o.sunColor!==void 0?o.sunColor:16777215),ot=new Color(o.waterColor!==void 0?o.waterColor:8355711),ct=o.eye!==void 0?o.eye:new Vector3(0,0,0),ft=o.distortionScale!==void 0?o.distortionScale:20,ht=o.side!==void 0?o.side:FrontSide,mt=o.fog!==void 0?o.fog:!1,lt=new Plane,ut=new Vector3,dt=new Vector3,gt=new Vector3,Et=new Matrix4,St=new Vector3(0,0,-1),Tt=new Vector4,Mt=new Vector3,Bt=new Vector3,Rt=new Vector4,Ut=new Matrix4,Ht=new PerspectiveCamera,Wt=new WebGLRenderTarget($,_e),Jt={uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new Matrix4},sunColor:{value:new Color(8355711)},sunDirection:{value:new Vector3(.70707,.70707,0)},eye:{value:new Vector3},waterColor:{value:new Color(5592405)}}]),vertexShader:`
				uniform mat4 textureMatrix;
				uniform float time;

				varying vec4 mirrorCoord;
				varying vec4 worldPosition;

				#include <common>
				#include <fog_pars_vertex>
				#include <shadowmap_pars_vertex>
				#include <logdepthbuf_pars_vertex>

				void main() {
					mirrorCoord = modelMatrix * vec4( position, 1.0 );
					worldPosition = mirrorCoord.xyzw;
					mirrorCoord = textureMatrix * mirrorCoord;
					vec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );
					gl_Position = projectionMatrix * mvPosition;

				#include <beginnormal_vertex>
				#include <defaultnormal_vertex>
				#include <logdepthbuf_vertex>
				#include <fog_vertex>
				#include <shadowmap_vertex>
			}`,fragmentShader:`
				uniform sampler2D mirrorSampler;
				uniform float alpha;
				uniform float time;
				uniform float size;
				uniform float distortionScale;
				uniform sampler2D normalSampler;
				uniform vec3 sunColor;
				uniform vec3 sunDirection;
				uniform vec3 eye;
				uniform vec3 waterColor;

				varying vec4 mirrorCoord;
				varying vec4 worldPosition;

				vec4 getNoise( vec2 uv ) {
					vec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);
					vec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );
					vec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );
					vec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );
					vec4 noise = texture2D( normalSampler, uv0 ) +
						texture2D( normalSampler, uv1 ) +
						texture2D( normalSampler, uv2 ) +
						texture2D( normalSampler, uv3 );
					return noise * 0.5 - 1.0;
				}

				void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {
					vec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );
					float direction = max( 0.0, dot( eyeDirection, reflection ) );
					specularColor += pow( direction, shiny ) * sunColor * spec;
					diffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;
				}

				#include <common>
				#include <packing>
				#include <bsdfs>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <lights_pars_begin>
				#include <shadowmap_pars_fragment>
				#include <shadowmask_pars_fragment>

				void main() {

					#include <logdepthbuf_fragment>
					vec4 noise = getNoise( worldPosition.xz * size );
					vec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );

					vec3 diffuseLight = vec3(0.0);
					vec3 specularLight = vec3(0.0);

					vec3 worldToEye = eye-worldPosition.xyz;
					vec3 eyeDirection = normalize( worldToEye );
					sunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );

					float distance = length(worldToEye);

					vec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;
					vec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );

					float theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );
					float rf0 = 0.3;
					float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );
					vec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;
					vec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);
					vec3 outgoingLight = albedo;
					gl_FragColor = vec4( outgoingLight, alpha );

					#include <tonemapping_fragment>
					#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>	
				}`},sn=new ShaderMaterial({fragmentShader:Jt.fragmentShader,vertexShader:Jt.vertexShader,uniforms:UniformsUtils.clone(Jt.uniforms),lights:!0,side:ht,fog:mt});sn.uniforms.mirrorSampler.value=Wt.texture,sn.uniforms.textureMatrix.value=Ut,sn.uniforms.alpha.value=nt,sn.uniforms.time.value=rt,sn.uniforms.normalSampler.value=it,sn.uniforms.sunColor.value=at,sn.uniforms.waterColor.value=ot,sn.uniforms.sunDirection.value=st,sn.uniforms.distortionScale.value=ft,sn.uniforms.eye.value=ct,j.material=sn,j.onBeforeRender=function(jt,Vt,Lt){if(dt.setFromMatrixPosition(j.matrixWorld),gt.setFromMatrixPosition(Lt.matrixWorld),Et.extractRotation(j.matrixWorld),ut.set(0,0,1),ut.applyMatrix4(Et),Mt.subVectors(dt,gt),Mt.dot(ut)>0)return;Mt.reflect(ut).negate(),Mt.add(dt),Et.extractRotation(Lt.matrixWorld),St.set(0,0,-1),St.applyMatrix4(Et),St.add(gt),Bt.subVectors(dt,St),Bt.reflect(ut).negate(),Bt.add(dt),Ht.position.copy(Mt),Ht.up.set(0,1,0),Ht.up.applyMatrix4(Et),Ht.up.reflect(ut),Ht.lookAt(Bt),Ht.far=Lt.far,Ht.updateMatrixWorld(),Ht.projectionMatrix.copy(Lt.projectionMatrix),Ut.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Ut.multiply(Ht.projectionMatrix),Ut.multiply(Ht.matrixWorldInverse),lt.setFromNormalAndCoplanarPoint(ut,dt),lt.applyMatrix4(Ht.matrixWorldInverse),Tt.set(lt.normal.x,lt.normal.y,lt.normal.z,lt.constant);const Qt=Ht.projectionMatrix;Rt.x=(Math.sign(Tt.x)+Qt.elements[8])/Qt.elements[0],Rt.y=(Math.sign(Tt.y)+Qt.elements[9])/Qt.elements[5],Rt.z=-1,Rt.w=(1+Qt.elements[10])/Qt.elements[14],Tt.multiplyScalar(2/Tt.dot(Rt)),Qt.elements[2]=Tt.x,Qt.elements[6]=Tt.y,Qt.elements[10]=Tt.z+1-tt,Qt.elements[14]=Tt.w,ct.setFromMatrixPosition(Lt.matrixWorld);const nn=jt.getRenderTarget(),mn=jt.xr.enabled,Zt=jt.shadowMap.autoUpdate;j.visible=!1,jt.xr.enabled=!1,jt.shadowMap.autoUpdate=!1,jt.setRenderTarget(Wt),jt.state.buffers.depth.setMask(!0),jt.autoClear===!1&&jt.clear(),jt.render(Vt,Ht),j.visible=!0,jt.xr.enabled=mn,jt.shadowMap.autoUpdate=Zt,jt.setRenderTarget(nn);const cn=Lt.viewport;cn!==void 0&&jt.state.viewport(cn)}}}class MarchingCubes extends Mesh{constructor(s,o,j=!1,$=!1,_e=1e4){const tt=new BufferGeometry;super(tt,o),this.isMarchingCubes=!0;const nt=this,rt=new Float32Array(12*3),it=new Float32Array(12*3),st=new Float32Array(12*3);this.enableUvs=j,this.enableColors=$,this.init=function(ut){this.resolution=ut,this.isolation=80,this.size=ut,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(this.size3*3),this.palette=new Float32Array(this.size3*3),this.count=0;const dt=_e*3;this.positionArray=new Float32Array(dt*3);const gt=new BufferAttribute(this.positionArray,3);gt.setUsage(DynamicDrawUsage),tt.setAttribute("position",gt),this.normalArray=new Float32Array(dt*3);const Et=new BufferAttribute(this.normalArray,3);if(Et.setUsage(DynamicDrawUsage),tt.setAttribute("normal",Et),this.enableUvs){this.uvArray=new Float32Array(dt*2);const St=new BufferAttribute(this.uvArray,2);St.setUsage(DynamicDrawUsage),tt.setAttribute("uv",St)}if(this.enableColors){this.colorArray=new Float32Array(dt*3);const St=new BufferAttribute(this.colorArray,3);St.setUsage(DynamicDrawUsage),tt.setAttribute("color",St)}tt.boundingSphere=new Sphere(new Vector3,1)};function at(ut,dt,gt){return ut+(dt-ut)*gt}function ot(ut,dt,gt,Et,St,Tt,Mt,Bt,Rt,Ut){const Ht=(gt-Mt)/(Bt-Mt),Wt=nt.normal_cache;rt[dt+0]=Et+Ht*nt.delta,rt[dt+1]=St,rt[dt+2]=Tt,it[dt+0]=at(Wt[ut+0],Wt[ut+3],Ht),it[dt+1]=at(Wt[ut+1],Wt[ut+4],Ht),it[dt+2]=at(Wt[ut+2],Wt[ut+5],Ht),st[dt+0]=at(nt.palette[Rt*3+0],nt.palette[Ut*3+0],Ht),st[dt+1]=at(nt.palette[Rt*3+1],nt.palette[Ut*3+1],Ht),st[dt+2]=at(nt.palette[Rt*3+2],nt.palette[Ut*3+2],Ht)}function ct(ut,dt,gt,Et,St,Tt,Mt,Bt,Rt,Ut){const Ht=(gt-Mt)/(Bt-Mt),Wt=nt.normal_cache;rt[dt+0]=Et,rt[dt+1]=St+Ht*nt.delta,rt[dt+2]=Tt;const Jt=ut+nt.yd*3;it[dt+0]=at(Wt[ut+0],Wt[Jt+0],Ht),it[dt+1]=at(Wt[ut+1],Wt[Jt+1],Ht),it[dt+2]=at(Wt[ut+2],Wt[Jt+2],Ht),st[dt+0]=at(nt.palette[Rt*3+0],nt.palette[Ut*3+0],Ht),st[dt+1]=at(nt.palette[Rt*3+1],nt.palette[Ut*3+1],Ht),st[dt+2]=at(nt.palette[Rt*3+2],nt.palette[Ut*3+2],Ht)}function ft(ut,dt,gt,Et,St,Tt,Mt,Bt,Rt,Ut){const Ht=(gt-Mt)/(Bt-Mt),Wt=nt.normal_cache;rt[dt+0]=Et,rt[dt+1]=St,rt[dt+2]=Tt+Ht*nt.delta;const Jt=ut+nt.zd*3;it[dt+0]=at(Wt[ut+0],Wt[Jt+0],Ht),it[dt+1]=at(Wt[ut+1],Wt[Jt+1],Ht),it[dt+2]=at(Wt[ut+2],Wt[Jt+2],Ht),st[dt+0]=at(nt.palette[Rt*3+0],nt.palette[Ut*3+0],Ht),st[dt+1]=at(nt.palette[Rt*3+1],nt.palette[Ut*3+1],Ht),st[dt+2]=at(nt.palette[Rt*3+2],nt.palette[Ut*3+2],Ht)}function ht(ut){const dt=ut*3;nt.normal_cache[dt]===0&&(nt.normal_cache[dt+0]=nt.field[ut-1]-nt.field[ut+1],nt.normal_cache[dt+1]=nt.field[ut-nt.yd]-nt.field[ut+nt.yd],nt.normal_cache[dt+2]=nt.field[ut-nt.zd]-nt.field[ut+nt.zd])}function mt(ut,dt,gt,Et,St){const Tt=Et+1,Mt=Et+nt.yd,Bt=Et+nt.zd,Rt=Tt+nt.yd,Ut=Tt+nt.zd,Ht=Et+nt.yd+nt.zd,Wt=Tt+nt.yd+nt.zd;let Jt=0;const sn=nt.field[Et],jt=nt.field[Tt],Vt=nt.field[Mt],Lt=nt.field[Rt],Qt=nt.field[Bt],nn=nt.field[Ut],mn=nt.field[Ht],Zt=nt.field[Wt];sn<St&&(Jt|=1),jt<St&&(Jt|=2),Vt<St&&(Jt|=8),Lt<St&&(Jt|=4),Qt<St&&(Jt|=16),nn<St&&(Jt|=32),mn<St&&(Jt|=128),Zt<St&&(Jt|=64);const cn=edgeTable[Jt];if(cn===0)return 0;const Ot=nt.delta,rn=ut+Ot,fn=dt+Ot,hn=gt+Ot;cn&1&&(ht(Et),ht(Tt),ot(Et*3,0,St,ut,dt,gt,sn,jt,Et,Tt)),cn&2&&(ht(Tt),ht(Rt),ct(Tt*3,3,St,rn,dt,gt,jt,Lt,Tt,Rt)),cn&4&&(ht(Mt),ht(Rt),ot(Mt*3,6,St,ut,fn,gt,Vt,Lt,Mt,Rt)),cn&8&&(ht(Et),ht(Mt),ct(Et*3,9,St,ut,dt,gt,sn,Vt,Et,Mt)),cn&16&&(ht(Bt),ht(Ut),ot(Bt*3,12,St,ut,dt,hn,Qt,nn,Bt,Ut)),cn&32&&(ht(Ut),ht(Wt),ct(Ut*3,15,St,rn,dt,hn,nn,Zt,Ut,Wt)),cn&64&&(ht(Ht),ht(Wt),ot(Ht*3,18,St,ut,fn,hn,mn,Zt,Ht,Wt)),cn&128&&(ht(Bt),ht(Ht),ct(Bt*3,21,St,ut,dt,hn,Qt,mn,Bt,Ht)),cn&256&&(ht(Et),ht(Bt),ft(Et*3,24,St,ut,dt,gt,sn,Qt,Et,Bt)),cn&512&&(ht(Tt),ht(Ut),ft(Tt*3,27,St,rn,dt,gt,jt,nn,Tt,Ut)),cn&1024&&(ht(Rt),ht(Wt),ft(Rt*3,30,St,rn,fn,gt,Lt,Zt,Rt,Wt)),cn&2048&&(ht(Mt),ht(Ht),ft(Mt*3,33,St,ut,fn,gt,Vt,mn,Mt,Ht)),Jt<<=4;let Tn,Nn,Pn,Dn=0,ln=0;for(;triTable[Jt+ln]!=-1;)Tn=Jt+ln,Nn=Tn+1,Pn=Tn+2,lt(rt,it,st,3*triTable[Tn],3*triTable[Nn],3*triTable[Pn]),ln+=3,Dn++;return Dn}function lt(ut,dt,gt,Et,St,Tt){const Mt=nt.count*3;if(nt.positionArray[Mt+0]=ut[Et],nt.positionArray[Mt+1]=ut[Et+1],nt.positionArray[Mt+2]=ut[Et+2],nt.positionArray[Mt+3]=ut[St],nt.positionArray[Mt+4]=ut[St+1],nt.positionArray[Mt+5]=ut[St+2],nt.positionArray[Mt+6]=ut[Tt],nt.positionArray[Mt+7]=ut[Tt+1],nt.positionArray[Mt+8]=ut[Tt+2],nt.material.flatShading===!0){const Bt=(dt[Et+0]+dt[St+0]+dt[Tt+0])/3,Rt=(dt[Et+1]+dt[St+1]+dt[Tt+1])/3,Ut=(dt[Et+2]+dt[St+2]+dt[Tt+2])/3;nt.normalArray[Mt+0]=Bt,nt.normalArray[Mt+1]=Rt,nt.normalArray[Mt+2]=Ut,nt.normalArray[Mt+3]=Bt,nt.normalArray[Mt+4]=Rt,nt.normalArray[Mt+5]=Ut,nt.normalArray[Mt+6]=Bt,nt.normalArray[Mt+7]=Rt,nt.normalArray[Mt+8]=Ut}else nt.normalArray[Mt+0]=dt[Et+0],nt.normalArray[Mt+1]=dt[Et+1],nt.normalArray[Mt+2]=dt[Et+2],nt.normalArray[Mt+3]=dt[St+0],nt.normalArray[Mt+4]=dt[St+1],nt.normalArray[Mt+5]=dt[St+2],nt.normalArray[Mt+6]=dt[Tt+0],nt.normalArray[Mt+7]=dt[Tt+1],nt.normalArray[Mt+8]=dt[Tt+2];if(nt.enableUvs){const Bt=nt.count*2;nt.uvArray[Bt+0]=ut[Et+0],nt.uvArray[Bt+1]=ut[Et+2],nt.uvArray[Bt+2]=ut[St+0],nt.uvArray[Bt+3]=ut[St+2],nt.uvArray[Bt+4]=ut[Tt+0],nt.uvArray[Bt+5]=ut[Tt+2]}nt.enableColors&&(nt.colorArray[Mt+0]=gt[Et+0],nt.colorArray[Mt+1]=gt[Et+1],nt.colorArray[Mt+2]=gt[Et+2],nt.colorArray[Mt+3]=gt[St+0],nt.colorArray[Mt+4]=gt[St+1],nt.colorArray[Mt+5]=gt[St+2],nt.colorArray[Mt+6]=gt[Tt+0],nt.colorArray[Mt+7]=gt[Tt+1],nt.colorArray[Mt+8]=gt[Tt+2]),nt.count+=3}this.addBall=function(ut,dt,gt,Et,St,Tt){const Mt=Math.sign(Et);Et=Math.abs(Et);const Bt=Tt!=null;let Rt=new Color(ut,dt,gt);if(Bt)try{Rt=Tt instanceof Color?Tt:Array.isArray(Tt)?new Color(Math.min(Math.abs(Tt[0]),1),Math.min(Math.abs(Tt[1]),1),Math.min(Math.abs(Tt[2]),1)):new Color(Tt)}catch{Rt=new Color(ut,dt,gt)}const Ut=this.size*Math.sqrt(Et/St),Ht=gt*this.size,Wt=dt*this.size,Jt=ut*this.size;let sn=Math.floor(Ht-Ut);sn<1&&(sn=1);let jt=Math.floor(Ht+Ut);jt>this.size-1&&(jt=this.size-1);let Vt=Math.floor(Wt-Ut);Vt<1&&(Vt=1);let Lt=Math.floor(Wt+Ut);Lt>this.size-1&&(Lt=this.size-1);let Qt=Math.floor(Jt-Ut);Qt<1&&(Qt=1);let nn=Math.floor(Jt+Ut);nn>this.size-1&&(nn=this.size-1);let mn,Zt,cn,Ot,rn,fn,hn,Tn,Nn,Pn,Dn;for(cn=sn;cn<jt;cn++)for(rn=this.size2*cn,Tn=cn/this.size-gt,Nn=Tn*Tn,Zt=Vt;Zt<Lt;Zt++)for(Ot=rn+this.size*Zt,hn=Zt/this.size-dt,Pn=hn*hn,mn=Qt;mn<nn;mn++)if(fn=mn/this.size-ut,Dn=Et/(1e-6+fn*fn+Pn+Nn)-St,Dn>0){this.field[Ot+mn]+=Dn*Mt;const ln=Math.sqrt((mn-Jt)*(mn-Jt)+(Zt-Wt)*(Zt-Wt)+(cn-Ht)*(cn-Ht))/Ut,Cn=1-ln*ln*ln*(ln*(ln*6-15)+10);this.palette[(Ot+mn)*3+0]+=Rt.r*Cn,this.palette[(Ot+mn)*3+1]+=Rt.g*Cn,this.palette[(Ot+mn)*3+2]+=Rt.b*Cn}},this.addPlaneX=function(ut,dt){const gt=this.size,Et=this.yd,St=this.zd,Tt=this.field;let Mt,Bt,Rt,Ut,Ht,Wt,Jt,sn=gt*Math.sqrt(ut/dt);for(sn>gt&&(sn=gt),Mt=0;Mt<sn;Mt++)if(Wt=Mt/gt,Ut=Wt*Wt,Ht=ut/(1e-4+Ut)-dt,Ht>0)for(Bt=0;Bt<gt;Bt++)for(Jt=Mt+Bt*Et,Rt=0;Rt<gt;Rt++)Tt[St*Rt+Jt]+=Ht},this.addPlaneY=function(ut,dt){const gt=this.size,Et=this.yd,St=this.zd,Tt=this.field;let Mt,Bt,Rt,Ut,Ht,Wt,Jt,sn,jt=gt*Math.sqrt(ut/dt);for(jt>gt&&(jt=gt),Bt=0;Bt<jt;Bt++)if(Wt=Bt/gt,Ut=Wt*Wt,Ht=ut/(1e-4+Ut)-dt,Ht>0)for(Jt=Bt*Et,Mt=0;Mt<gt;Mt++)for(sn=Jt+Mt,Rt=0;Rt<gt;Rt++)Tt[St*Rt+sn]+=Ht},this.addPlaneZ=function(ut,dt){const gt=this.size,Et=this.yd,St=this.zd,Tt=this.field;let Mt,Bt,Rt,Ut,Ht,Wt,Jt,sn,jt=gt*Math.sqrt(ut/dt);for(jt>gt&&(jt=gt),Rt=0;Rt<jt;Rt++)if(Wt=Rt/gt,Ut=Wt*Wt,Ht=ut/(1e-4+Ut)-dt,Ht>0)for(Jt=St*Rt,Bt=0;Bt<gt;Bt++)for(sn=Jt+Bt*Et,Mt=0;Mt<gt;Mt++)Tt[sn+Mt]+=Ht},this.setCell=function(ut,dt,gt,Et){const St=this.size2*gt+this.size*dt+ut;this.field[St]=Et},this.getCell=function(ut,dt,gt){const Et=this.size2*gt+this.size*dt+ut;return this.field[Et]},this.blur=function(ut=1){const dt=this.field,gt=dt.slice(),Et=this.size,St=this.size2;for(let Tt=0;Tt<Et;Tt++)for(let Mt=0;Mt<Et;Mt++)for(let Bt=0;Bt<Et;Bt++){const Rt=St*Bt+Et*Mt+Tt;let Ut=gt[Rt],Ht=1;for(let Wt=-1;Wt<=1;Wt+=2){const Jt=Wt+Tt;if(!(Jt<0||Jt>=Et))for(let sn=-1;sn<=1;sn+=2){const jt=sn+Mt;if(!(jt<0||jt>=Et))for(let Vt=-1;Vt<=1;Vt+=2){const Lt=Vt+Bt;if(Lt<0||Lt>=Et)continue;const Qt=St*Lt+Et*jt+Jt,nn=gt[Qt];Ht++,Ut+=ut*(nn-Ut)/Ht}}}dt[Rt]=Ut}},this.reset=function(){for(let ut=0;ut<this.size3;ut++)this.normal_cache[ut*3]=0,this.field[ut]=0,this.palette[ut*3]=this.palette[ut*3+1]=this.palette[ut*3+2]=0},this.update=function(){this.count=0;const ut=this.size-2;for(let dt=1;dt<ut;dt++){const gt=this.size2*dt,Et=(dt-this.halfsize)/this.halfsize;for(let St=1;St<ut;St++){const Tt=gt+this.size*St,Mt=(St-this.halfsize)/this.halfsize;for(let Bt=1;Bt<ut;Bt++){const Rt=(Bt-this.halfsize)/this.halfsize,Ut=Tt+Bt;mt(Rt,Mt,Et,Ut,this.isolation)}}}this.geometry.setDrawRange(0,this.count),tt.getAttribute("position").needsUpdate=!0,tt.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(tt.getAttribute("uv").needsUpdate=!0),this.enableColors&&(tt.getAttribute("color").needsUpdate=!0),this.count/3>_e&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(s)}}const edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);class SimplexNoise{constructor(s=Math){__publicField(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),__publicField(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),__publicField(this,"p",[]),__publicField(this,"perm",[]),__publicField(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),__publicField(this,"dot",(o,j,$)=>o[0]*j+o[1]*$),__publicField(this,"dot3",(o,j,$,_e)=>o[0]*j+o[1]*$+o[2]*_e),__publicField(this,"dot4",(o,j,$,_e,tt)=>o[0]*j+o[1]*$+o[2]*_e+o[3]*tt),__publicField(this,"noise",(o,j)=>{let $,_e,tt;const nt=.5*(Math.sqrt(3)-1),rt=(o+j)*nt,it=Math.floor(o+rt),st=Math.floor(j+rt),at=(3-Math.sqrt(3))/6,ot=(it+st)*at,ct=it-ot,ft=st-ot,ht=o-ct,mt=j-ft;let lt=0,ut=1;ht>mt&&(lt=1,ut=0);const dt=ht-lt+at,gt=mt-ut+at,Et=ht-1+2*at,St=mt-1+2*at,Tt=it&255,Mt=st&255,Bt=this.perm[Tt+this.perm[Mt]]%12,Rt=this.perm[Tt+lt+this.perm[Mt+ut]]%12,Ut=this.perm[Tt+1+this.perm[Mt+1]]%12;let Ht=.5-ht*ht-mt*mt;Ht<0?$=0:(Ht*=Ht,$=Ht*Ht*this.dot(this.grad3[Bt],ht,mt));let Wt=.5-dt*dt-gt*gt;Wt<0?_e=0:(Wt*=Wt,_e=Wt*Wt*this.dot(this.grad3[Rt],dt,gt));let Jt=.5-Et*Et-St*St;return Jt<0?tt=0:(Jt*=Jt,tt=Jt*Jt*this.dot(this.grad3[Ut],Et,St)),70*($+_e+tt)}),__publicField(this,"noise3d",(o,j,$)=>{let _e,tt,nt,rt;const it=.3333333333333333,st=(o+j+$)*it,at=Math.floor(o+st),ot=Math.floor(j+st),ct=Math.floor($+st),ft=1/6,ht=(at+ot+ct)*ft,mt=at-ht,lt=ot-ht,ut=ct-ht,dt=o-mt,gt=j-lt,Et=$-ut;let St,Tt,Mt,Bt,Rt,Ut;dt>=gt?gt>=Et?(St=1,Tt=0,Mt=0,Bt=1,Rt=1,Ut=0):dt>=Et?(St=1,Tt=0,Mt=0,Bt=1,Rt=0,Ut=1):(St=0,Tt=0,Mt=1,Bt=1,Rt=0,Ut=1):gt<Et?(St=0,Tt=0,Mt=1,Bt=0,Rt=1,Ut=1):dt<Et?(St=0,Tt=1,Mt=0,Bt=0,Rt=1,Ut=1):(St=0,Tt=1,Mt=0,Bt=1,Rt=1,Ut=0);const Ht=dt-St+ft,Wt=gt-Tt+ft,Jt=Et-Mt+ft,sn=dt-Bt+2*ft,jt=gt-Rt+2*ft,Vt=Et-Ut+2*ft,Lt=dt-1+3*ft,Qt=gt-1+3*ft,nn=Et-1+3*ft,mn=at&255,Zt=ot&255,cn=ct&255,Ot=this.perm[mn+this.perm[Zt+this.perm[cn]]]%12,rn=this.perm[mn+St+this.perm[Zt+Tt+this.perm[cn+Mt]]]%12,fn=this.perm[mn+Bt+this.perm[Zt+Rt+this.perm[cn+Ut]]]%12,hn=this.perm[mn+1+this.perm[Zt+1+this.perm[cn+1]]]%12;let Tn=.6-dt*dt-gt*gt-Et*Et;Tn<0?_e=0:(Tn*=Tn,_e=Tn*Tn*this.dot3(this.grad3[Ot],dt,gt,Et));let Nn=.6-Ht*Ht-Wt*Wt-Jt*Jt;Nn<0?tt=0:(Nn*=Nn,tt=Nn*Nn*this.dot3(this.grad3[rn],Ht,Wt,Jt));let Pn=.6-sn*sn-jt*jt-Vt*Vt;Pn<0?nt=0:(Pn*=Pn,nt=Pn*Pn*this.dot3(this.grad3[fn],sn,jt,Vt));let Dn=.6-Lt*Lt-Qt*Qt-nn*nn;return Dn<0?rt=0:(Dn*=Dn,rt=Dn*Dn*this.dot3(this.grad3[hn],Lt,Qt,nn)),32*(_e+tt+nt+rt)}),__publicField(this,"noise4d",(o,j,$,_e)=>{const tt=this.grad4,nt=this.simplex,rt=this.perm,it=(Math.sqrt(5)-1)/4,st=(5-Math.sqrt(5))/20;let at,ot,ct,ft,ht;const mt=(o+j+$+_e)*it,lt=Math.floor(o+mt),ut=Math.floor(j+mt),dt=Math.floor($+mt),gt=Math.floor(_e+mt),Et=(lt+ut+dt+gt)*st,St=lt-Et,Tt=ut-Et,Mt=dt-Et,Bt=gt-Et,Rt=o-St,Ut=j-Tt,Ht=$-Mt,Wt=_e-Bt,Jt=Rt>Ut?32:0,sn=Rt>Ht?16:0,jt=Ut>Ht?8:0,Vt=Rt>Wt?4:0,Lt=Ut>Wt?2:0,Qt=Ht>Wt?1:0,nn=Jt+sn+jt+Vt+Lt+Qt;let mn,Zt,cn,Ot,rn,fn,hn,Tn,Nn,Pn,Dn,ln;mn=nt[nn][0]>=3?1:0,Zt=nt[nn][1]>=3?1:0,cn=nt[nn][2]>=3?1:0,Ot=nt[nn][3]>=3?1:0,rn=nt[nn][0]>=2?1:0,fn=nt[nn][1]>=2?1:0,hn=nt[nn][2]>=2?1:0,Tn=nt[nn][3]>=2?1:0,Nn=nt[nn][0]>=1?1:0,Pn=nt[nn][1]>=1?1:0,Dn=nt[nn][2]>=1?1:0,ln=nt[nn][3]>=1?1:0;const Cn=Rt-mn+st,bn=Ut-Zt+st,kn=Ht-cn+st,Sn=Wt-Ot+st,xn=Rt-rn+2*st,Qn=Ut-fn+2*st,nr=Ht-hn+2*st,or=Wt-Tn+2*st,mr=Rt-Nn+3*st,$n=Ut-Pn+3*st,tn=Ht-Dn+3*st,$t=Wt-ln+3*st,An=Rt-1+4*st,En=Ut-1+4*st,In=Ht-1+4*st,Hn=Wt-1+4*st,yn=lt&255,On=ut&255,Mn=dt&255,tr=gt&255,gr=rt[yn+rt[On+rt[Mn+rt[tr]]]]%32,Cr=rt[yn+mn+rt[On+Zt+rt[Mn+cn+rt[tr+Ot]]]]%32,Sr=rt[yn+rn+rt[On+fn+rt[Mn+hn+rt[tr+Tn]]]]%32,Un=rt[yn+Nn+rt[On+Pn+rt[Mn+Dn+rt[tr+ln]]]]%32,Jn=rt[yn+1+rt[On+1+rt[Mn+1+rt[tr+1]]]]%32;let pr=.6-Rt*Rt-Ut*Ut-Ht*Ht-Wt*Wt;pr<0?at=0:(pr*=pr,at=pr*pr*this.dot4(tt[gr],Rt,Ut,Ht,Wt));let Gn=.6-Cn*Cn-bn*bn-kn*kn-Sn*Sn;Gn<0?ot=0:(Gn*=Gn,ot=Gn*Gn*this.dot4(tt[Cr],Cn,bn,kn,Sn));let Zn=.6-xn*xn-Qn*Qn-nr*nr-or*or;Zn<0?ct=0:(Zn*=Zn,ct=Zn*Zn*this.dot4(tt[Sr],xn,Qn,nr,or));let qn=.6-mr*mr-$n*$n-tn*tn-$t*$t;qn<0?ft=0:(qn*=qn,ft=qn*qn*this.dot4(tt[Un],mr,$n,tn,$t));let vr=.6-An*An-En*En-In*In-Hn*Hn;return vr<0?ht=0:(vr*=vr,ht=vr*vr*this.dot4(tt[Jn],An,En,In,Hn)),27*(at+ot+ct+ft+ht)});for(let o=0;o<256;o++)this.p[o]=Math.floor(s.random()*256);for(let o=0;o<512;o++)this.perm[o]=this.p[o&255]}}const _LightningStrike=class extends BufferGeometry{constructor(a={}){super(),this.isLightningStrike=!0,this.type="LightningStrike",this.init(_LightningStrike.copyParameters(a,a)),this.createMesh()}static createRandomGenerator(){const s=[];for(let j=0;j<2053;j++)s.push(Math.random());const o={currentSeed:0,random:function(){const j=s[o.currentSeed];return o.currentSeed=(o.currentSeed+1)%2053,j},getSeed:function(){return o.currentSeed/2053},setSeed:function(j){o.currentSeed=Math.floor(j*2053)%2053}};return o}static copyParameters(a={},s={}){const o=function(j){return s===a?j:j.clone()};return a.sourceOffset=s.sourceOffset!==void 0?o(s.sourceOffset):new Vector3(0,100,0),a.destOffset=s.destOffset!==void 0?o(s.destOffset):new Vector3(0,0,0),a.timeScale=s.timeScale!==void 0?s.timeScale:1,a.roughness=s.roughness!==void 0?s.roughness:.9,a.straightness=s.straightness!==void 0?s.straightness:.7,a.up0=s.up0!==void 0?o(s.up0):new Vector3(0,0,1),a.up1=s.up1!==void 0?o(s.up1):new Vector3(0,0,1),a.radius0=s.radius0!==void 0?s.radius0:1,a.radius1=s.radius1!==void 0?s.radius1:1,a.radius0Factor=s.radius0Factor!==void 0?s.radius0Factor:.5,a.radius1Factor=s.radius1Factor!==void 0?s.radius1Factor:.2,a.minRadius=s.minRadius!==void 0?s.minRadius:.2,a.isEternal=s.isEternal!==void 0?s.isEternal:s.birthTime===void 0||s.deathTime===void 0,a.birthTime=s.birthTime,a.deathTime=s.deathTime,a.propagationTimeFactor=s.propagationTimeFactor!==void 0?s.propagationTimeFactor:.1,a.vanishingTimeFactor=s.vanishingTimeFactor!==void 0?s.vanishingTimeFactor:.9,a.subrayPeriod=s.subrayPeriod!==void 0?s.subrayPeriod:4,a.subrayDutyCycle=s.subrayDutyCycle!==void 0?s.subrayDutyCycle:.6,a.maxIterations=s.maxIterations!==void 0?s.maxIterations:9,a.isStatic=s.isStatic!==void 0?s.isStatic:!1,a.ramification=s.ramification!==void 0?s.ramification:5,a.maxSubrayRecursion=s.maxSubrayRecursion!==void 0?s.maxSubrayRecursion:3,a.recursionProbability=s.recursionProbability!==void 0?s.recursionProbability:.6,a.generateUVs=s.generateUVs!==void 0?s.generateUVs:!1,a.randomGenerator=s.randomGenerator,a.noiseSeed=s.noiseSeed,a.onDecideSubrayCreation=s.onDecideSubrayCreation,a.onSubrayCreation=s.onSubrayCreation,a}update(a){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=a&&a<=this.rayParameters.deathTime?(this.updateMesh(a),a<this.subrays[0].endPropagationTime?this.state=_LightningStrike.RAY_PROPAGATING:a>this.subrays[0].beginVanishingTime?this.state=_LightningStrike.RAY_VANISHING:this.state=_LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,a<this.rayParameters.birthTime?this.state=_LightningStrike.RAY_UNBORN:this.state=_LightningStrike.RAY_EXTINGUISHED))}init(a){this.rayParameters=a,this.maxIterations=a.maxIterations!==void 0?Math.floor(a.maxIterations):9,a.maxIterations=this.maxIterations,this.isStatic=a.isStatic!==void 0?a.isStatic:!1,a.isStatic=this.isStatic,this.ramification=a.ramification!==void 0?Math.floor(a.ramification):5,a.ramification=this.ramification,this.maxSubrayRecursion=a.maxSubrayRecursion!==void 0?Math.floor(a.maxSubrayRecursion):3,a.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=a.recursionProbability!==void 0?a.recursionProbability:.6,a.recursionProbability=this.recursionProbability,this.generateUVs=a.generateUVs!==void 0?a.generateUVs:!1,a.generateUVs=this.generateUVs,a.randomGenerator!==void 0?(this.randomGenerator=a.randomGenerator,this.seedGenerator=a.randomGenerator,a.noiseSeed!==void 0&&this.seedGenerator.setSeed(a.noiseSeed)):(this.randomGenerator=_LightningStrike.createRandomGenerator(),this.seedGenerator=Math),a.onDecideSubrayCreation!==void 0?this.onDecideSubrayCreation=a.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),a.onSubrayCreation!==void 0&&(this.onSubrayCreation=a.onSubrayCreation)),this.state=_LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),a.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(let s=0;s<this.maxSubrays;s++)this.subrays.push(this.createSubray());this.raySegments=[];for(let s=0;s<this.maxRaySegments;s++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3}createMesh(){const a=1<<this.maxIterations,s=3*(a+1)*this.maxSubrays,o=18*a*this.maxSubrays;this.vertices=new Float32Array(s*3),this.indices=new Uint32Array(o),this.generateUVs&&(this.uvs=new Float32Array(s*2)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=DynamicDrawUsage,this.positionAttribute.usage=DynamicDrawUsage,this.generateUVs&&(this.uvsAttribute.usage=DynamicDrawUsage)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)}updateMesh(a){this.fillMesh(a),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)}fillMesh(a){const s=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(a,function(j){const $=s.currentSubray;a<$.birthTime||(this.rayParameters.isEternal&&s.currentSubray.recursion==0?(s.createPrism(j),s.onDecideSubrayCreation(j,s)):a<$.endPropagationTime?s.timeFraction>=j.fraction0*$.propagationTimeFactor&&(s.createPrism(j),s.onDecideSubrayCreation(j,s)):a<$.beginVanishingTime?(s.createPrism(j),s.onDecideSubrayCreation(j,s)):(s.timeFraction<=$.vanishingTimeFactor+j.fraction1*(1-$.vanishingTimeFactor)&&s.createPrism(j),s.onDecideSubrayCreation(j,s)))})}addNewSubray(){return this.subrays[this.numSubrays++]}initSubray(a,s){a.pos0.copy(s.sourceOffset),a.pos1.copy(s.destOffset),a.up0.copy(s.up0),a.up1.copy(s.up1),a.radius0=s.radius0,a.radius1=s.radius1,a.birthTime=s.birthTime,a.deathTime=s.deathTime,a.timeScale=s.timeScale,a.roughness=s.roughness,a.straightness=s.straightness,a.propagationTimeFactor=s.propagationTimeFactor,a.vanishingTimeFactor=s.vanishingTimeFactor,a.maxIterations=this.maxIterations,a.seed=s.noiseSeed!==void 0?s.noiseSeed:0,a.recursion=0}fractalRay(a,s){this.time=a,this.currentSegmentCallback=s,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(let o=0;o<this.numSubrays;o++){const j=this.subrays[o];this.currentSubray=j,this.randomGenerator.setSeed(j.seed),j.endPropagationTime=MathUtils.lerp(j.birthTime,j.deathTime,j.propagationTimeFactor),j.beginVanishingTime=MathUtils.lerp(j.deathTime,j.birthTime,1-j.vanishingTimeFactor);const $=this.randomGenerator.random;j.linPos0.set($(),$(),$()).multiplyScalar(1e3),j.linPos1.set($(),$(),$()).multiplyScalar(1e3),this.timeFraction=(a-j.birthTime)/(j.deathTime-j.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;const _e=this.getNewSegment();_e.iteration=0,_e.pos0.copy(j.pos0),_e.pos1.copy(j.pos1),_e.linPos0.copy(j.linPos0),_e.linPos1.copy(j.linPos1),_e.up0.copy(j.up0),_e.up1.copy(j.up1),_e.radius0=j.radius0,_e.radius1=j.radius1,_e.fraction0=0,_e.fraction1=1,_e.positionVariationFactor=1-j.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,j.recursion)/(1<<j.maxIterations),this.fractalRayRecursive(_e)}this.currentSegmentCallback=null,this.currentSubray=null}fractalRayRecursive(a){if(a.iteration>=this.currentSubray.maxIterations){this.currentSegmentCallback(a);return}this.forwards.subVectors(a.pos1,a.pos0);let s=this.forwards.length();s<1e-6&&(this.forwards.set(0,0,.01),s=this.forwards.length());const o=(a.radius0+a.radius1)*.5,j=(a.fraction0+a.fraction1)*.5,$=this.time*this.currentSubray.timeScale*Math.pow(2,a.iteration);this.middlePos.lerpVectors(a.pos0,a.pos1,.5),this.middleLinPos.lerpVectors(a.linPos0,a.linPos1,.5);const _e=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(_e.x,_e.y,_e.z,$),this.simplexY.noise4d(_e.x,_e.y,_e.z,$),this.simplexZ.noise4d(_e.x,_e.y,_e.z,$)),this.newPos.multiplyScalar(a.positionVariationFactor*s),this.newPos.add(this.middlePos);const tt=this.getNewSegment();tt.pos0.copy(a.pos0),tt.pos1.copy(this.newPos),tt.linPos0.copy(a.linPos0),tt.linPos1.copy(this.middleLinPos),tt.up0.copy(a.up0),tt.up1.copy(a.up1),tt.radius0=a.radius0,tt.radius1=o,tt.fraction0=a.fraction0,tt.fraction1=j,tt.positionVariationFactor=a.positionVariationFactor*this.currentSubray.roughness,tt.iteration=a.iteration+1;const nt=this.getNewSegment();nt.pos0.copy(this.newPos),nt.pos1.copy(a.pos1),nt.linPos0.copy(this.middleLinPos),nt.linPos1.copy(a.linPos1),this.cross1.crossVectors(a.up0,this.forwards.normalize()),nt.up0.crossVectors(this.forwards,this.cross1).normalize(),nt.up1.copy(a.up1),nt.radius0=o,nt.radius1=a.radius1,nt.fraction0=j,nt.fraction1=a.fraction1,nt.positionVariationFactor=a.positionVariationFactor*this.currentSubray.roughness,nt.iteration=a.iteration+1,this.fractalRayRecursive(tt),this.fractalRayRecursive(nt)}createPrism(a){this.forwardsFill.subVectors(a.pos1,a.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(a.pos0,a.up0,this.forwardsFill,a.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(a.pos1,a.up0,this.forwardsFill,a.radius1,a.fraction1),this.createPrismFaces()}createTriangleVerticesWithoutUVs(a,s,o,j){this.side.crossVectors(s,o).multiplyScalar(j*_LightningStrike.COS30DEG),this.down.copy(s).multiplyScalar(-j*_LightningStrike.SIN30DEG);const $=this.vPos,_e=this.vertices;$.copy(a).sub(this.side).add(this.down),_e[this.currentCoordinate++]=$.x,_e[this.currentCoordinate++]=$.y,_e[this.currentCoordinate++]=$.z,$.copy(a).add(this.side).add(this.down),_e[this.currentCoordinate++]=$.x,_e[this.currentCoordinate++]=$.y,_e[this.currentCoordinate++]=$.z,$.copy(s).multiplyScalar(j).add(a),_e[this.currentCoordinate++]=$.x,_e[this.currentCoordinate++]=$.y,_e[this.currentCoordinate++]=$.z,this.currentVertex+=3}createTriangleVerticesWithUVs(a,s,o,j,$){this.side.crossVectors(s,o).multiplyScalar(j*_LightningStrike.COS30DEG),this.down.copy(s).multiplyScalar(-j*_LightningStrike.SIN30DEG);const _e=this.vPos,tt=this.vertices,nt=this.uvs;_e.copy(a).sub(this.side).add(this.down),tt[this.currentCoordinate++]=_e.x,tt[this.currentCoordinate++]=_e.y,tt[this.currentCoordinate++]=_e.z,nt[this.currentUVCoordinate++]=$,nt[this.currentUVCoordinate++]=0,_e.copy(a).add(this.side).add(this.down),tt[this.currentCoordinate++]=_e.x,tt[this.currentCoordinate++]=_e.y,tt[this.currentCoordinate++]=_e.z,nt[this.currentUVCoordinate++]=$,nt[this.currentUVCoordinate++]=.5,_e.copy(s).multiplyScalar(j).add(a),tt[this.currentCoordinate++]=_e.x,tt[this.currentCoordinate++]=_e.y,tt[this.currentCoordinate++]=_e.z,nt[this.currentUVCoordinate++]=$,nt[this.currentUVCoordinate++]=1,this.currentVertex+=3}createPrismFaces(a){const s=this.indices;a=this.currentVertex-6,s[this.currentIndex++]=a+1,s[this.currentIndex++]=a+2,s[this.currentIndex++]=a+5,s[this.currentIndex++]=a+1,s[this.currentIndex++]=a+5,s[this.currentIndex++]=a+4,s[this.currentIndex++]=a+0,s[this.currentIndex++]=a+1,s[this.currentIndex++]=a+4,s[this.currentIndex++]=a+0,s[this.currentIndex++]=a+4,s[this.currentIndex++]=a+3,s[this.currentIndex++]=a+2,s[this.currentIndex++]=a+0,s[this.currentIndex++]=a+3,s[this.currentIndex++]=a+2,s[this.currentIndex++]=a+3,s[this.currentIndex++]=a+5}createDefaultSubrayCreationCallbacks(){const a=this.randomGenerator.random;this.onDecideSubrayCreation=function(_e,tt){const nt=tt.currentSubray,rt=tt.rayParameters.subrayPeriod,it=tt.rayParameters.subrayDutyCycle,st=tt.rayParameters.isEternal&&nt.recursion==0?-a()*rt:MathUtils.lerp(nt.birthTime,nt.endPropagationTime,_e.fraction0)-a()*rt,at=tt.time-st,ot=Math.floor(at/rt),ct=a()*(ot+1),ft=at%rt<=it*rt;let ht=0;if(ft&&(ht=tt.subrayProbability),nt.recursion<tt.maxSubrayRecursion&&tt.numSubrays<tt.maxSubrays&&a()<ht){const mt=tt.addNewSubray(),lt=tt.randomGenerator.getSeed();mt.seed=ct,tt.randomGenerator.setSeed(ct),mt.recursion=nt.recursion+1,mt.maxIterations=Math.max(1,nt.maxIterations-1),mt.linPos0.set(a(),a(),a()).multiplyScalar(1e3),mt.linPos1.set(a(),a(),a()).multiplyScalar(1e3),mt.up0.copy(nt.up0),mt.up1.copy(nt.up1),mt.radius0=_e.radius0*tt.rayParameters.radius0Factor,mt.radius1=Math.min(tt.rayParameters.minRadius,_e.radius1*tt.rayParameters.radius1Factor),mt.birthTime=st+ot*rt,mt.deathTime=mt.birthTime+rt*it,!tt.rayParameters.isEternal&&nt.recursion==0&&(mt.birthTime=Math.max(mt.birthTime,nt.birthTime),mt.deathTime=Math.min(mt.deathTime,nt.deathTime)),mt.timeScale=nt.timeScale*2,mt.roughness=nt.roughness,mt.straightness=nt.straightness,mt.propagationTimeFactor=nt.propagationTimeFactor,mt.vanishingTimeFactor=nt.vanishingTimeFactor,tt.onSubrayCreation(_e,nt,mt,tt),tt.randomGenerator.setSeed(lt)}};const s=new Vector3,o=new Vector3,j=new Vector3,$=new Vector3;this.onSubrayCreation=function(_e,tt,nt,rt){rt.subrayCylinderPosition(_e,tt,nt,.5,.6,.2)},this.subrayConePosition=function(_e,tt,nt,rt,it,st){nt.pos0.copy(_e.pos0),s.subVectors(tt.pos1,tt.pos0),o.copy(s).normalize(),s.multiplyScalar(_e.fraction0+(1-_e.fraction0)*(a()*rt));const at=s.length();j.crossVectors(tt.up0,o);const ot=2*Math.PI*a();j.multiplyScalar(Math.cos(ot)),$.copy(tt.up0).multiplyScalar(Math.sin(ot)),nt.pos1.copy(j).add($).multiplyScalar(at*it*(st+a()*(1-st))).add(s).add(tt.pos0)},this.subrayCylinderPosition=function(_e,tt,nt,rt,it,st){nt.pos0.copy(_e.pos0),s.subVectors(tt.pos1,tt.pos0),o.copy(s).normalize(),s.multiplyScalar(_e.fraction0+(1-_e.fraction0)*((2*a()-1)*rt));const at=s.length();j.crossVectors(tt.up0,o);const ot=2*Math.PI*a();j.multiplyScalar(Math.cos(ot)),$.copy(tt.up0).multiplyScalar(Math.sin(ot)),nt.pos1.copy(j).add($).multiplyScalar(at*it*(st+a()*(1-st))).add(s).add(tt.pos0)}}createSubray(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}createSegment(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}getNewSegment(){return this.raySegments[this.currentSegmentIndex++]}copy(a){return super.copy(a),this.init(_LightningStrike.copyParameters({},a.rayParameters)),this}clone(){return new this.constructor(_LightningStrike.copyParameters({},this.rayParameters))}};let LightningStrike=_LightningStrike;class LightningStorm extends Object3D{constructor(s={}){super(),this.isLightningStorm=!0,this.stormParams=s,s.size=s.size!==void 0?s.size:1e3,s.minHeight=s.minHeight!==void 0?s.minHeight:80,s.maxHeight=s.maxHeight!==void 0?s.maxHeight:100,s.maxSlope=s.maxSlope!==void 0?s.maxSlope:1.1,s.maxLightnings=s.maxLightnings!==void 0?s.maxLightnings:3,s.lightningMinPeriod=s.lightningMinPeriod!==void 0?s.lightningMinPeriod:3,s.lightningMaxPeriod=s.lightningMaxPeriod!==void 0?s.lightningMaxPeriod:7,s.lightningMinDuration=s.lightningMinDuration!==void 0?s.lightningMinDuration:1,s.lightningMaxDuration=s.lightningMaxDuration!==void 0?s.lightningMaxDuration:2.5,this.lightningParameters=LightningStrike.copyParameters(s.lightningParameters,s.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=s.lightningMaterial!==void 0?s.lightningMaterial:new MeshBasicMaterial({color:11599871}),s.onRayPosition!==void 0?this.onRayPosition=s.onRayPosition:this.onRayPosition=function(o,j){j.set((Math.random()-.5)*s.size,0,(Math.random()-.5)*s.size);const $=MathUtils.lerp(s.minHeight,s.maxHeight,Math.random());o.set(s.maxSlope*(2*Math.random()-1),1,s.maxSlope*(2*Math.random()-1)).multiplyScalar($).add(j)},this.onLightningDown=s.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(let o=0;o<this.stormParams.maxLightnings;o++){const j=new LightningStrike(LightningStrike.copyParameters({},this.lightningParameters)),$=new Mesh(j,this.lightningMaterial);this.deadLightningsMeshes.push($)}}update(s){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(s)*Math.random(),this.inited=!0),s>=this.nextLightningTime){const $=this.deadLightningsMeshes.pop();if($){const _e=LightningStrike.copyParameters($.geometry.rayParameters,this.lightningParameters);_e.birthTime=s,_e.deathTime=s+MathUtils.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(_e.sourceOffset,_e.destOffset),_e.noiseSeed=Math.random(),this.add($),this.lightningsMeshes.push($)}this.nextLightningTime=this.getNextLightningTime(s)}let o=0,j=this.lightningsMeshes.length;for(;o<j;){const $=this.lightningsMeshes[o],_e=$.geometry,tt=_e.state;_e.update(s),tt===LightningStrike.RAY_PROPAGATING&&_e.state>tt&&this.onLightningDown&&this.onLightningDown(_e),_e.state===LightningStrike.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf($),1),this.deadLightningsMeshes.push($),this.remove($),j--):o++}}getNextLightningTime(s){return s+MathUtils.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)}copy(s,o){return super.copy(s,o),this.stormParams.size=s.stormParams.size,this.stormParams.minHeight=s.stormParams.minHeight,this.stormParams.maxHeight=s.stormParams.maxHeight,this.stormParams.maxSlope=s.stormParams.maxSlope,this.stormParams.maxLightnings=s.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=s.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=s.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=s.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=s.stormParams.lightningMaxDuration,this.lightningParameters=LightningStrike.copyParameters({},s.lightningParameters),this.lightningMaterial=s.stormParams.lightningMaterial,this.onLightningDown=s.onLightningDown,this}clone(){return new this.constructor(this.stormParams).copy(this)}}const _ReflectorForSSRPass=class extends Mesh{constructor(a,s={}){super(a),this.isReflectorForSSRPass=!0,this.type="ReflectorForSSRPass";const o=this,j=s.color!==void 0?new Color(s.color):new Color(8355711),$=s.textureWidth||512,_e=s.textureHeight||512,tt=s.clipBias||0,nt=s.shader||_ReflectorForSSRPass.ReflectorShader,rt=s.useDepthTexture===!0,it=new Vector3(0,1,0),st=new Vector3,at=new Vector3;o.needsUpdate=!1,o.maxDistance=_ReflectorForSSRPass.ReflectorShader.uniforms.maxDistance.value,o.opacity=_ReflectorForSSRPass.ReflectorShader.uniforms.opacity.value,o.color=j,o.resolution=s.resolution||new Vector2(window.innerWidth,window.innerHeight),o._distanceAttenuation=_ReflectorForSSRPass.ReflectorShader.defines.DISTANCE_ATTENUATION,Object.defineProperty(o,"distanceAttenuation",{get(){return o._distanceAttenuation},set(Ut){o._distanceAttenuation!==Ut&&(o._distanceAttenuation=Ut,o.material.defines.DISTANCE_ATTENUATION=Ut,o.material.needsUpdate=!0)}}),o._fresnel=_ReflectorForSSRPass.ReflectorShader.defines.FRESNEL,Object.defineProperty(o,"fresnel",{get(){return o._fresnel},set(Ut){o._fresnel!==Ut&&(o._fresnel=Ut,o.material.defines.FRESNEL=Ut,o.material.needsUpdate=!0)}});const ot=new Vector3,ct=new Vector3,ft=new Vector3,ht=new Matrix4,mt=new Vector3(0,0,-1),lt=new Vector3,ut=new Vector3,dt=new Matrix4,gt=new PerspectiveCamera;let Et;rt&&(Et=new DepthTexture,Et.type=UnsignedShortType,Et.minFilter=NearestFilter,Et.magFilter=NearestFilter);const St={depthTexture:rt?Et:null,type:HalfFloatType},Tt=new WebGLRenderTarget($,_e,St),Mt=new ShaderMaterial({transparent:rt,defines:Object.assign({},_ReflectorForSSRPass.ReflectorShader.defines,{useDepthTexture:rt}),uniforms:UniformsUtils.clone(nt.uniforms),fragmentShader:nt.fragmentShader,vertexShader:nt.vertexShader});Mt.uniforms.tDiffuse.value=Tt.texture,Mt.uniforms.color.value=o.color,Mt.uniforms.textureMatrix.value=dt,rt&&(Mt.uniforms.tDepth.value=Tt.depthTexture),this.material=Mt;const Rt=[new Plane(new Vector3(0,1,0),tt)];this.doRender=function(Ut,Ht,Wt){if(Mt.uniforms.maxDistance.value=o.maxDistance,Mt.uniforms.color.value=o.color,Mt.uniforms.opacity.value=o.opacity,st.copy(Wt.position).normalize(),at.copy(st).reflect(it),Mt.uniforms.fresnelCoe.value=(st.dot(at)+1)/2,ct.setFromMatrixPosition(o.matrixWorld),ft.setFromMatrixPosition(Wt.matrixWorld),ht.extractRotation(o.matrixWorld),ot.set(0,0,1),ot.applyMatrix4(ht),lt.subVectors(ct,ft),lt.dot(ot)>0)return;lt.reflect(ot).negate(),lt.add(ct),ht.extractRotation(Wt.matrixWorld),mt.set(0,0,-1),mt.applyMatrix4(ht),mt.add(ft),ut.subVectors(ct,mt),ut.reflect(ot).negate(),ut.add(ct),gt.position.copy(lt),gt.up.set(0,1,0),gt.up.applyMatrix4(ht),gt.up.reflect(ot),gt.lookAt(ut),gt.far=Wt.far,gt.updateMatrixWorld(),gt.projectionMatrix.copy(Wt.projectionMatrix),Mt.uniforms.virtualCameraNear.value=Wt.near,Mt.uniforms.virtualCameraFar.value=Wt.far,Mt.uniforms.virtualCameraMatrixWorld.value=gt.matrixWorld,Mt.uniforms.virtualCameraProjectionMatrix.value=Wt.projectionMatrix,Mt.uniforms.virtualCameraProjectionMatrixInverse.value=Wt.projectionMatrixInverse,Mt.uniforms.resolution.value=o.resolution,dt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),dt.multiply(gt.projectionMatrix),dt.multiply(gt.matrixWorldInverse),dt.multiply(o.matrixWorld);const Jt=Ut.getRenderTarget(),sn=Ut.xr.enabled,jt=Ut.shadowMap.autoUpdate,Vt=Ut.clippingPlanes;Ut.xr.enabled=!1,Ut.shadowMap.autoUpdate=!1,Ut.clippingPlanes=Rt,Ut.setRenderTarget(Tt),Ut.state.buffers.depth.setMask(!0),Ut.autoClear===!1&&Ut.clear(),Ut.render(Ht,gt),Ut.xr.enabled=sn,Ut.shadowMap.autoUpdate=jt,Ut.clippingPlanes=Vt,Ut.setRenderTarget(Jt);const Lt=Wt.viewport;Lt!==void 0&&Ut.state.viewport(Lt)},this.getRenderTarget=function(){return Tt}}},SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${version>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},material=new ShaderMaterial({name:"SkyShader",fragmentShader:SkyShader.fragmentShader,vertexShader:SkyShader.vertexShader,uniforms:UniformsUtils.clone(SkyShader.uniforms),side:BackSide,depthWrite:!1});class Sky extends Mesh{constructor(){super(new BoxGeometry(1,1,1),material)}}const _Water2=class extends Mesh{constructor(a,s={}){super(a),this.isWater=!0,this.type="Water";const o=this,j=s.color!==void 0?new Color(s.color):new Color(16777215),$=s.textureWidth||512,_e=s.textureHeight||512,tt=s.clipBias||0,nt=s.flowDirection||new Vector2(1,0),rt=s.flowSpeed||.03,it=s.reflectivity||.02,st=s.scale||1,at=s.shader||_Water2.WaterShader,ot=s.encoding!==void 0?s.encoding:3e3,ct=s.flowMap||void 0,ft=s.normalMap0,ht=s.normalMap1,mt=.15,lt=mt*.5,ut=new Matrix4,dt=new Clock;if(Reflector===void 0){console.error("THREE.Water: Required component Reflector not found.");return}if(Refractor===void 0){console.error("THREE.Water: Required component Refractor not found.");return}const gt=new Reflector(a,{textureWidth:$,textureHeight:_e,clipBias:tt,encoding:ot}),Et=new Refractor(a,{textureWidth:$,textureHeight:_e,clipBias:tt,encoding:ot});gt.matrixAutoUpdate=!1,Et.matrixAutoUpdate=!1,this.material=new ShaderMaterial({uniforms:UniformsUtils.merge([UniformsLib.fog,at.uniforms]),vertexShader:at.vertexShader,fragmentShader:at.fragmentShader,transparent:!0,fog:!0}),ct!==void 0?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:ct}):this.material.uniforms.flowDirection={type:"v2",value:nt},ft.wrapS=ft.wrapT=RepeatWrapping,ht.wrapS=ht.wrapT=RepeatWrapping,this.material.uniforms.tReflectionMap.value=gt.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=Et.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=ft,this.material.uniforms.tNormalMap1.value=ht,this.material.uniforms.color.value=j,this.material.uniforms.reflectivity.value=it,this.material.uniforms.textureMatrix.value=ut,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=lt,this.material.uniforms.config.value.z=lt,this.material.uniforms.config.value.w=st;function St(Mt){ut.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ut.multiply(Mt.projectionMatrix),ut.multiply(Mt.matrixWorldInverse),ut.multiply(o.matrixWorld)}function Tt(){const Mt=dt.getDelta(),Bt=o.material.uniforms.config;Bt.value.x+=rt*Mt,Bt.value.y=Bt.value.x+lt,Bt.value.x>=mt?(Bt.value.x=0,Bt.value.y=lt):Bt.value.y>=mt&&(Bt.value.y=Bt.value.y-mt)}this.onBeforeRender=function(Mt,Bt,Rt){St(Rt),Tt(),o.visible=!1,gt.matrixWorld.copy(o.matrixWorld),Et.matrixWorld.copy(o.matrixWorld),gt.onBeforeRender(Mt,Bt,Rt),Et.onBeforeRender(Mt,Bt,Rt),o.visible=!0}}},isCubeTexture=a=>a&&a.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(s,o){var j,$;const _e=isCubeTexture(s),nt=(($=_e?(j=s.image[0])==null?void 0:j.width:s.image.width)!=null?$:1024)/4,rt=Math.floor(Math.log2(nt)),it=Math.pow(2,rt),st=3*Math.max(it,16*7),at=4*it,ot=[_e?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/st}`,`#define CUBEUV_TEXEL_HEIGHT ${1/at}`,`#define CUBEUV_MAX_MIP ${rt}.0`],ct=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,ft=ot.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,ht={map:{value:s},height:{value:(o==null?void 0:o.height)||15},radius:{value:(o==null?void 0:o.radius)||100}},mt=new IcosahedronGeometry(1,16),lt=new ShaderMaterial({uniforms:ht,fragmentShader:ft,vertexShader:ct,side:DoubleSide});super(mt,lt)}set radius(s){this.material.uniforms.radius.value=s}get radius(){return this.material.uniforms.radius.value}set height(s){this.material.uniforms.height.value=s}get height(){return this.material.uniforms.height.value}}class PackedPhongMaterial extends MeshPhongMaterial{constructor(s){super(),this.defines={},this.type="PackedPhongMaterial",this.uniforms=UniformsUtils.merge([ShaderLib.phong.uniforms,{quantizeMatPos:{value:null},quantizeMatUV:{value:null}}]),this.vertexShader=["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","varying vec3 vNormal;","#endif",ShaderChunk.common,ShaderChunk.uv_pars_vertex,ShaderChunk.uv2_pars_vertex,ShaderChunk.displacementmap_pars_vertex,ShaderChunk.envmap_pars_vertex,ShaderChunk.color_pars_vertex,ShaderChunk.fog_pars_vertex,ShaderChunk.morphtarget_pars_vertex,ShaderChunk.skinning_pars_vertex,ShaderChunk.shadowmap_pars_vertex,ShaderChunk.logdepthbuf_pars_vertex,ShaderChunk.clipping_planes_pars_vertex,`#ifdef USE_PACKED_NORMAL
					#if USE_PACKED_NORMAL == 0
						vec3 decodeNormal(vec3 packedNormal)
						{
							float x = packedNormal.x * 2.0 - 1.0;
							float y = packedNormal.y * 2.0 - 1.0;
							vec2 scth = vec2(sin(x * PI), cos(x * PI));
							vec2 scphi = vec2(sqrt(1.0 - y * y), y);
							return normalize( vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y) );
						}
					#endif

					#if USE_PACKED_NORMAL == 1
						vec3 decodeNormal(vec3 packedNormal)
						{
							vec3 v = vec3(packedNormal.xy, 1.0 - abs(packedNormal.x) - abs(packedNormal.y));
							if (v.z < 0.0)
							{
								v.xy = (1.0 - abs(v.yx)) * vec2((v.x >= 0.0) ? +1.0 : -1.0, (v.y >= 0.0) ? +1.0 : -1.0);
							}
							return normalize(v);
						}
					#endif

					#if USE_PACKED_NORMAL == 2
						vec3 decodeNormal(vec3 packedNormal)
						{
							vec3 v = (packedNormal * 2.0) - 1.0;
							return normalize(v);
						}
					#endif
				#endif`,`#ifdef USE_PACKED_POSITION
					#if USE_PACKED_POSITION == 0
						uniform mat4 quantizeMatPos;
					#endif
				#endif`,`#ifdef USE_PACKED_UV
					#if USE_PACKED_UV == 1
						uniform mat3 quantizeMatUV;
					#endif
				#endif`,`#ifdef USE_PACKED_UV
					#if USE_PACKED_UV == 0
						vec2 decodeUV(vec2 packedUV)
						{
							vec2 uv = (packedUV * 2.0) - 1.0;
							return uv;
						}
					#endif

					#if USE_PACKED_UV == 1
						vec2 decodeUV(vec2 packedUV)
						{
							vec2 uv = ( vec3(packedUV, 1.0) * quantizeMatUV ).xy;
							return uv;
						}
					#endif
				#endif`,"void main() {",ShaderChunk.uv_vertex,`#ifdef USE_UV
					#ifdef USE_PACKED_UV
						vUv = decodeUV(vUv);
					#endif
				#endif`,ShaderChunk.uv2_vertex,ShaderChunk.color_vertex,ShaderChunk.beginnormal_vertex,`#ifdef USE_PACKED_NORMAL
					objectNormal = decodeNormal(objectNormal);
				#endif

				#ifdef USE_TANGENT
					vec3 objectTangent = vec3( tangent.xyz );
				#endif
				`,ShaderChunk.morphnormal_vertex,ShaderChunk.skinbase_vertex,ShaderChunk.skinnormal_vertex,ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","	vNormal = normalize( transformedNormal );","#endif",ShaderChunk.begin_vertex,`#ifdef USE_PACKED_POSITION
					#if USE_PACKED_POSITION == 0
						transformed = ( vec4(transformed, 1.0) * quantizeMatPos ).xyz;
					#endif
				#endif`,ShaderChunk.morphtarget_vertex,ShaderChunk.skinning_vertex,ShaderChunk.displacementmap_vertex,ShaderChunk.project_vertex,ShaderChunk.logdepthbuf_vertex,ShaderChunk.clipping_planes_vertex,"vViewPosition = - mvPosition.xyz;",ShaderChunk.worldpos_vertex,ShaderChunk.envmap_vertex,ShaderChunk.shadowmap_vertex,ShaderChunk.fog_vertex,"}"].join(`
`),this.fragmentShader=["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",ShaderChunk.common,ShaderChunk.packing,ShaderChunk.dithering_pars_fragment,ShaderChunk.color_pars_fragment,ShaderChunk.uv_pars_fragment,ShaderChunk.uv2_pars_fragment,ShaderChunk.map_pars_fragment,ShaderChunk.alphamap_pars_fragment,ShaderChunk.aomap_pars_fragment,ShaderChunk.lightmap_pars_fragment,ShaderChunk.emissivemap_pars_fragment,ShaderChunk.envmap_common_pars_fragment,ShaderChunk.envmap_pars_fragment,ShaderChunk.cube_uv_reflection_fragment,ShaderChunk.fog_pars_fragment,ShaderChunk.bsdfs,ShaderChunk.lights_pars_begin,ShaderChunk.lights_phong_pars_fragment,ShaderChunk.shadowmap_pars_fragment,ShaderChunk.bumpmap_pars_fragment,ShaderChunk.normalmap_pars_fragment,ShaderChunk.specularmap_pars_fragment,ShaderChunk.logdepthbuf_pars_fragment,ShaderChunk.clipping_planes_pars_fragment,"void main() {",ShaderChunk.clipping_planes_fragment,"vec4 diffuseColor = vec4( diffuse, opacity );","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","vec3 totalEmissiveRadiance = emissive;",ShaderChunk.logdepthbuf_fragment,ShaderChunk.map_fragment,ShaderChunk.color_fragment,ShaderChunk.alphamap_fragment,ShaderChunk.alphatest_fragment,ShaderChunk.specularmap_fragment,ShaderChunk.normal_fragment_begin,ShaderChunk.normal_fragment_maps,ShaderChunk.emissivemap_fragment,ShaderChunk.lights_phong_fragment,ShaderChunk.lights_fragment_begin,ShaderChunk.lights_fragment_maps,ShaderChunk.lights_fragment_end,ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;",ShaderChunk.envmap_fragment,"gl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.tonemapping_fragment,parseInt(REVISION.replace(/\D+/g,""))>=154?ShaderChunk.colorspace_fragment:ShaderChunk.encodings_fragment,ShaderChunk.fog_fragment,ShaderChunk.premultiplied_alpha_fragment,ShaderChunk.dithering_fragment,"}"].join(`
`),this.setValues(s)}}const BokehShader2={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","	vUv = uv;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","/*","make sure that these two values are the same for your camera, otherwise distances will be wrong.","*/","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","/*","next part is experimental","not looking good with small sample and ring count","looks okay starting from samples = 4, rings = 4","*/","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","	//pentagonal shape","	float scale = float(rings) - 1.3;","	vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","	vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","	vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","	vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","	vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","	vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","	vec4  one = vec4( 1.0 );","	vec4 P = vec4((coords),vec2(scale, scale));","	vec4 dist = vec4(0.0);","	float inorout = -4.0;","	dist.x = dot( P, HS0 );","	dist.y = dot( P, HS1 );","	dist.z = dot( P, HS2 );","	dist.w = dot( P, HS3 );","	dist = smoothstep( -feather, feather, dist );","	inorout += dot( dist, one );","	dist.x = dot( P, HS4 );","	dist.y = HS5.w - abs( P.z );","	dist = smoothstep( -feather, feather, dist );","	inorout += dist.x;","	return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","	// Depth buffer blur","	float d = 0.0;","	float kernel[9];","	vec2 offset[9];","	vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","	offset[0] = vec2(-wh.x,-wh.y);","	offset[1] = vec2( 0.0, -wh.y);","	offset[2] = vec2( wh.x -wh.y);","	offset[3] = vec2(-wh.x,  0.0);","	offset[4] = vec2( 0.0,   0.0);","	offset[5] = vec2( wh.x,  0.0);","	offset[6] = vec2(-wh.x, wh.y);","	offset[7] = vec2( 0.0,  wh.y);","	offset[8] = vec2( wh.x, wh.y);","	kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","	kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","	kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","	for( int i=0; i<9; i++ ) {","		float tmp = texture2D(tDepth, coords + offset[i]).r;","		d += tmp * kernel[i];","	}","	return d;","}","vec3 color(vec2 coords,float blur) {","	//processing the sample","	vec3 col = vec3(0.0);","	vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","	col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","	col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","	col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","	vec3 lumcoeff = vec3(0.299,0.587,0.114);","	float lum = dot(col.rgb, lumcoeff);","	float thresh = max((lum-threshold)*gain, 0.0);","	return col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","	float edge = 0.002*depth; //distance based edge smoothing","	float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","	float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","	col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","	col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","	return col;","}","float linearize(float depth) {","	return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","	float dist = distance(vUv.xy, vec2(0.5,0.5));","	dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","	return clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","	float rings2 = float(rings);","	float step = PI*2.0 / float(ringsamples);","	float pw = cos(j*step)*i;","	float ph = sin(j*step)*i;","	float p = 1.0;","	if (pentagon) {","		p = penta(vec2(pw,ph));","	}","	col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","	return 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","	//scene depth calculation","	float depth = linearize(texture2D(tDepth,vUv.xy).x);","	// Blur depth?","	if ( depthblur ) {","		depth = linearize(bdepth(vUv.xy));","	}","	//focal plane calculation","	float fDepth = focalDepth;","	if (shaderFocus) {","		fDepth = linearize(texture2D(tDepth,focusCoords).x);","	}","	// dof blur factor calculation","	float blur = 0.0;","	if (manualdof) {","		float a = depth-fDepth; // Focal plane","		float b = (a-fdofstart)/fdofdist; // Far DoF","		float c = (-a-ndofstart)/ndofdist; // Near Dof","		blur = (a>0.0) ? b : c;","	} else {","		float f = focalLength; // focal length in mm","		float d = fDepth*1000.0; // focal plane in mm","		float o = depth*1000.0; // depth in mm","		float a = (o*f)/(o-f);","		float b = (d*f)/(d-f);","		float c = (d-f)/(d*fstop*CoC);","		blur = abs(a-b)*c;","	}","	blur = clamp(blur,0.0,1.0);","	// calculation of pattern for dithering","	vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","	// getting blur x and y step factor","	float w = (1.0/textureWidth)*blur*maxblur+noise.x;","	float h = (1.0/textureHeight)*blur*maxblur+noise.y;","	// calculation of final color","	vec3 col = vec3(0.0);","	if(blur < 0.05) {","		//some optimization thingy","		col = texture2D(tColor, vUv.xy).rgb;","	} else {","		col = texture2D(tColor, vUv.xy).rgb;","		float s = 1.0;","		int ringsamples;","		for (int i = 1; i <= rings; i++) {","			/*unboxstart*/","			ringsamples = i * samples;","			for (int j = 0 ; j < maxringsamples ; j++) {","				if (j >= ringsamples) break;","				s += gather(float(i), float(j), ringsamples, col, w, h, blur);","			}","			/*unboxend*/","		}","		col /= s; //divide by sample count","	}","	if (showFocus) {","		col = debugFocus(col, blur, depth);","	}","	if (vignetting) {","		col *= vignette();","	}","	gl_FragColor.rgb = col;","	gl_FragColor.a = 1.0;","} "].join(`
`)},BokehDepthShader={uniforms:{mNear:{value:1},mFar:{value:1e3}},vertexShader:["varying float vViewZDepth;","void main() {","	#include <begin_vertex>","	#include <project_vertex>","	vViewZDepth = - mvPosition.z;","}"].join(`
`),fragmentShader:["uniform float mNear;","uniform float mFar;","varying float vViewZDepth;","void main() {","	float color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );","	gl_FragColor = vec4( vec3( color ), 1.0 );","} "].join(`
`)};class CinematicCamera extends PerspectiveCamera{constructor(s,o,j,$){super(s,o,j,$),this.type="CinematicCamera",this.postprocessing={enabled:!0},this.shaderSettings={rings:3,samples:4};const _e=BokehDepthShader;this.materialDepth=new ShaderMaterial({uniforms:_e.uniforms,vertexShader:_e.vertexShader,fragmentShader:_e.fragmentShader}),this.materialDepth.uniforms.mNear.value=j,this.materialDepth.uniforms.mFar.value=$,this.setLens(),this.initPostProcessing()}setLens(s,o,j,$){s===void 0&&(s=35),o!==void 0&&(this.filmGauge=o),this.setFocalLength(s),j===void 0&&(j=8),$===void 0&&($=.019),this.fNumber=j,this.coc=$,this.aperture=s/this.fNumber,this.hyperFocal=s*s/(this.aperture*this.coc)}linearize(s){const o=this.far,j=this.near;return-o*j/(s*(o-j)-o)}smoothstep(s,o,j){const $=this.saturate((j-s)/(o-s));return $*$*(3-2*$)}saturate(s){return Math.max(0,Math.min(1,s))}focusAt(s){s===void 0&&(s=20);const o=this.getFocalLength();this.focus=s,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-o)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-o)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance}initPostProcessing(){if(this.postprocessing.enabled){this.postprocessing.scene=new Scene,this.postprocessing.camera=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera),this.postprocessing.rtTextureDepth=new WebGLRenderTarget(window.innerWidth,window.innerHeight),this.postprocessing.rtTextureColor=new WebGLRenderTarget(window.innerWidth,window.innerHeight);const s=BokehShader2;this.postprocessing.bokeh_uniforms=UniformsUtils.clone(s.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=window.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=window.innerHeight,this.postprocessing.materialBokeh=new ShaderMaterial({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples,DEPTH_PACKING:1}}),this.postprocessing.quad=new Mesh(new PlaneGeometry(window.innerWidth,window.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}}renderCinematic(s,o){if(this.postprocessing.enabled){const j=o.getRenderTarget();o.clear(),s.overrideMaterial=null,o.setRenderTarget(this.postprocessing.rtTextureColor),o.clear(),o.render(s,this),s.overrideMaterial=this.materialDepth,o.setRenderTarget(this.postprocessing.rtTextureDepth),o.clear(),o.render(s,this),o.setRenderTarget(null),o.render(this.postprocessing.scene,this.postprocessing.camera),o.setRenderTarget(j)}}}const STATE$1={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};class CameraControls extends EventDispatcher{constructor(s,o){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"trackball",!1),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!1),__publicField(this,"keyPanSpeed",7),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"enableKeys",!0),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons"),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"quaternion0"),__publicField(this,"zoom0"),__publicField(this,"spherical",new Spherical),__publicField(this,"sphericalDelta",new Spherical),__publicField(this,"changeEvent",{type:"change"}),__publicField(this,"startEvent",{type:"start"}),__publicField(this,"endEvent",{type:"end"}),__publicField(this,"state",STATE$1.NONE),__publicField(this,"EPS",1e-6),__publicField(this,"scale",1),__publicField(this,"panOffset",new Vector3),__publicField(this,"zoomChanged",!1),__publicField(this,"rotateStart",new Vector2),__publicField(this,"rotateEnd",new Vector2),__publicField(this,"rotateDelta",new Vector2),__publicField(this,"panStart",new Vector2),__publicField(this,"panEnd",new Vector2),__publicField(this,"panDelta",new Vector2),__publicField(this,"dollyStart",new Vector2),__publicField(this,"dollyEnd",new Vector2),__publicField(this,"dollyDelta",new Vector2),__publicField(this,"offset",new Vector3),__publicField(this,"lastPosition",new Vector3),__publicField(this,"lastQuaternion",new Quaternion),__publicField(this,"q",new Quaternion),__publicField(this,"v",new Vector3),__publicField(this,"vec",new Vector3),__publicField(this,"quat"),__publicField(this,"quatInverse"),__publicField(this,"getPolarAngle",()=>this.spherical.phi),__publicField(this,"getAzimuthalAngle",()=>this.spherical.theta),__publicField(this,"saveState",()=>{this.target0.copy(this.target),this.position0.copy(this.object.position),this.quaternion0.copy(this.object.quaternion),this.zoom0=this.object.zoom}),__publicField(this,"reset",()=>{this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.quaternion.copy(this.quaternion0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(this.changeEvent),this.update(),this.state=STATE$1.NONE}),__publicField(this,"dispose",()=>{this.domElement.removeEventListener("contextmenu",this.onContextMenu,!1),this.domElement.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.removeEventListener("wheel",this.onMouseWheel,!1),this.domElement.removeEventListener("touchstart",this.onTouchStart,!1),this.domElement.removeEventListener("touchend",this.onTouchEnd,!1),this.domElement.removeEventListener("touchmove",this.onTouchMove,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.domElement.removeEventListener("keydown",this.onKeyDown,!1)}),__publicField(this,"update",()=>{const j=this.object.position;if(this.offset.copy(j).sub(this.target),this.trackball){if(this.sphericalDelta.theta){this.vec.set(0,1,0).applyQuaternion(this.object.quaternion);const $=this.enableDamping?this.dampingFactor:1;this.q.setFromAxisAngle(this.vec,this.sphericalDelta.theta*$),this.object.quaternion.premultiply(this.q),this.offset.applyQuaternion(this.q)}if(this.sphericalDelta.phi){this.vec.set(1,0,0).applyQuaternion(this.object.quaternion);const $=this.enableDamping?this.dampingFactor:1;this.q.setFromAxisAngle(this.vec,this.sphericalDelta.phi*$),this.object.quaternion.premultiply(this.q),this.offset.applyQuaternion(this.q)}this.offset.multiplyScalar(this.scale),this.offset.clampLength(this.minDistance,this.maxDistance)}else this.offset.applyQuaternion(this.quat),this.autoRotate&&this.state===STATE$1.NONE&&this.rotateLeft(this.getAutoRotationAngle()),this.spherical.setFromVector3(this.offset),this.enableDamping?(this.spherical.theta+=this.sphericalDelta.theta*this.dampingFactor,this.spherical.phi+=this.sphericalDelta.phi*this.dampingFactor):(this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi),this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),this.offset.setFromSpherical(this.spherical),this.offset.applyQuaternion(this.quatInverse);return this.enableDamping===!0?this.target.addScaledVector(this.panOffset,this.dampingFactor):this.target.add(this.panOffset),j.copy(this.target).add(this.offset),this.trackball===!1&&this.object.lookAt(this.target),this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor,this.panOffset.multiplyScalar(1-this.dampingFactor)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0)),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>this.EPS||8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS?(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):!1}),__publicField(this,"getAutoRotationAngle",()=>2*Math.PI/60/60*this.autoRotateSpeed),__publicField(this,"getZoomScale",()=>Math.pow(.95,this.zoomSpeed)),__publicField(this,"rotateLeft",j=>{this.sphericalDelta.theta-=j}),__publicField(this,"rotateUp",j=>{this.sphericalDelta.phi-=j}),__publicField(this,"panLeft",(j,$)=>{this.v.setFromMatrixColumn($,0),this.v.multiplyScalar(-j),this.panOffset.add(this.v)}),__publicField(this,"panUp",(j,$)=>{this.screenSpacePanning===!0?this.v.setFromMatrixColumn($,1):(this.v.setFromMatrixColumn($,0),this.v.crossVectors(this.object.up,this.v)),this.v.multiplyScalar(j),this.panOffset.add(this.v)}),__publicField(this,"pan",(j,$)=>{const _e=this.domElement;if(this.object instanceof PerspectiveCamera){const tt=this.object.position;this.offset.copy(tt).sub(this.target);let nt=this.offset.length();nt*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*j*nt/_e.clientHeight,this.object.matrix),this.panUp(2*$*nt/_e.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this.panLeft(j*(this.object.right-this.object.left)/this.object.zoom/_e.clientWidth,this.object.matrix),this.panUp($*(this.object.top-this.object.bottom)/this.object.zoom/_e.clientHeight,this.object.matrix)):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}),__publicField(this,"dollyIn",j=>{this.object instanceof PerspectiveCamera?this.scale/=j:this.object instanceof OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*j)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}),__publicField(this,"dollyOut",j=>{this.object instanceof PerspectiveCamera?this.scale*=j:this.object instanceof OrthographicCamera?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/j)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: CameraControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}),__publicField(this,"handleMouseDownRotate",j=>{this.rotateStart.set(j.clientX,j.clientY)}),__publicField(this,"handleMouseDownDolly",j=>{this.dollyStart.set(j.clientX,j.clientY)}),__publicField(this,"handleMouseDownPan",j=>{this.panStart.set(j.clientX,j.clientY)}),__publicField(this,"handleMouseMoveRotate",j=>{this.rotateEnd.set(j.clientX,j.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const $=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/$.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/$.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}),__publicField(this,"handleMouseMoveDolly",j=>{this.dollyEnd.set(j.clientX,j.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyIn(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyOut(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}),__publicField(this,"handleMouseMovePan",j=>{this.panEnd.set(j.clientX,j.clientY),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd),this.update()}),__publicField(this,"handleMouseWheel",j=>{j.deltaY<0?this.dollyOut(this.getZoomScale()):j.deltaY>0&&this.dollyIn(this.getZoomScale()),this.update()}),__publicField(this,"handleKeyDown",j=>{let $=!1;switch(j.code){case this.keys.UP:this.pan(0,this.keyPanSpeed),$=!0;break;case this.keys.BOTTOM:this.pan(0,-this.keyPanSpeed),$=!0;break;case this.keys.LEFT:this.pan(this.keyPanSpeed,0),$=!0;break;case this.keys.RIGHT:this.pan(-this.keyPanSpeed,0),$=!0;break}$&&(j.preventDefault(),this.update())}),__publicField(this,"handleTouchStartRotate",j=>{if(j.touches.length==1)this.rotateStart.set(j.touches[0].pageX,j.touches[0].pageY);else{const $=.5*(j.touches[0].pageX+j.touches[1].pageX),_e=.5*(j.touches[0].pageY+j.touches[1].pageY);this.rotateStart.set($,_e)}}),__publicField(this,"handleTouchStartPan",j=>{if(j.touches.length==1)this.panStart.set(j.touches[0].pageX,j.touches[0].pageY);else{const $=.5*(j.touches[0].pageX+j.touches[1].pageX),_e=.5*(j.touches[0].pageY+j.touches[1].pageY);this.panStart.set($,_e)}}),__publicField(this,"handleTouchStartDolly",j=>{const $=j.touches[0].pageX-j.touches[1].pageX,_e=j.touches[0].pageY-j.touches[1].pageY,tt=Math.sqrt($*$+_e*_e);this.dollyStart.set(0,tt)}),__publicField(this,"handleTouchStartDollyPan",j=>{this.enableZoom&&this.handleTouchStartDolly(j),this.enablePan&&this.handleTouchStartPan(j)}),__publicField(this,"handleTouchStartDollyRotate",j=>{this.enableZoom&&this.handleTouchStartDolly(j),this.enableRotate&&this.handleTouchStartRotate(j)}),__publicField(this,"handleTouchMoveRotate",j=>{if(j.touches.length==1)this.rotateEnd.set(j.touches[0].pageX,j.touches[0].pageY);else{const _e=.5*(j.touches[0].pageX+j.touches[1].pageX),tt=.5*(j.touches[0].pageY+j.touches[1].pageY);this.rotateEnd.set(_e,tt)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const $=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/$.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/$.clientHeight),this.rotateStart.copy(this.rotateEnd)}),__publicField(this,"handleTouchMovePan",j=>{if(j.touches.length==1)this.panEnd.set(j.touches[0].pageX,j.touches[0].pageY);else{const $=.5*(j.touches[0].pageX+j.touches[1].pageX),_e=.5*(j.touches[0].pageY+j.touches[1].pageY);this.panEnd.set($,_e)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}),__publicField(this,"handleTouchMoveDolly",j=>{const $=j.touches[0].pageX-j.touches[1].pageX,_e=j.touches[0].pageY-j.touches[1].pageY,tt=Math.sqrt($*$+_e*_e);this.dollyEnd.set(0,tt),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyIn(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}),__publicField(this,"handleTouchMoveDollyPan",j=>{this.enableZoom&&this.handleTouchMoveDolly(j),this.enablePan&&this.handleTouchMovePan(j)}),__publicField(this,"handleTouchMoveDollyRotate",j=>{this.enableZoom&&this.handleTouchMoveDolly(j),this.enableRotate&&this.handleTouchMoveRotate(j)}),__publicField(this,"onMouseDown",j=>{if(this.enabled===!1)return;j.preventDefault(),this.domElement.focus?this.domElement.focus():window.focus();let $;switch(j.button){case 0:$=this.mouseButtons.LEFT;break;case 1:$=this.mouseButtons.MIDDLE;break;case 2:$=this.mouseButtons.RIGHT;break;default:$=-1}switch($){case MOUSE.DOLLY:if(this.enableZoom===!1)return;this.handleMouseDownDolly(j),this.state=STATE$1.DOLLY;break;case MOUSE.ROTATE:if(j.ctrlKey||j.metaKey||j.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(j),this.state=STATE$1.PAN}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(j),this.state=STATE$1.ROTATE}break;case MOUSE.PAN:if(j.ctrlKey||j.metaKey||j.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(j),this.state=STATE$1.ROTATE}else{if(this.enablePan===!1)return;this.handleMouseDownPan(j),this.state=STATE$1.PAN}break;default:this.state=STATE$1.NONE}this.state!==STATE$1.NONE&&(document.addEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent(this.startEvent))}),__publicField(this,"onMouseMove",j=>{if(this.enabled!==!1)switch(j.preventDefault(),this.state){case STATE$1.ROTATE:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(j);break;case STATE$1.DOLLY:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(j);break;case STATE$1.PAN:if(this.enablePan===!1)return;this.handleMouseMovePan(j);break}}),__publicField(this,"onMouseUp",()=>{this.enabled!==!1&&(document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent(this.endEvent),this.state=STATE$1.NONE)}),__publicField(this,"onMouseWheel",j=>{this.enabled===!1||this.enableZoom===!1||this.state!==STATE$1.NONE&&this.state!==STATE$1.ROTATE||(j.preventDefault(),this.dispatchEvent(this.startEvent),this.handleMouseWheel(j),this.dispatchEvent(this.endEvent))}),__publicField(this,"onKeyDown",j=>{this.enabled===!1||this.enableKeys===!1||this.enablePan===!1||this.handleKeyDown(j)}),__publicField(this,"onTouchStart",j=>{if(this.enabled!==!1){switch(j.preventDefault(),j.touches.length){case 1:switch(this.touches.ONE){case TOUCH.ROTATE:if(this.enableRotate===!1)return;this.handleTouchStartRotate(j),this.state=STATE$1.TOUCH_ROTATE;break;case TOUCH.PAN:if(this.enablePan===!1)return;this.handleTouchStartPan(j),this.state=STATE$1.TOUCH_PAN;break;default:this.state=STATE$1.NONE}break;case 2:switch(this.touches.TWO){case TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(j),this.state=STATE$1.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(j),this.state=STATE$1.TOUCH_DOLLY_ROTATE;break;default:this.state=STATE$1.NONE}break;default:this.state=STATE$1.NONE}this.state!==STATE$1.NONE&&this.dispatchEvent(this.startEvent)}}),__publicField(this,"onTouchMove",j=>{if(this.enabled!==!1)switch(j.preventDefault(),this.state){case STATE$1.TOUCH_ROTATE:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(j),this.update();break;case STATE$1.TOUCH_PAN:if(this.enablePan===!1)return;this.handleTouchMovePan(j),this.update();break;case STATE$1.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(j),this.update();break;case STATE$1.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(j),this.update();break;default:this.state=STATE$1.NONE}}),__publicField(this,"onTouchEnd",()=>{this.enabled!==!1&&(this.dispatchEvent(this.endEvent),this.state=STATE$1.NONE)}),__publicField(this,"onContextMenu",j=>{this.enabled!==!1&&j.preventDefault()}),o===void 0&&console.warn('THREE.CameraControls: The second parameter "domElement" is now mandatory.'),o instanceof Document&&console.error('THREE.CameraControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=s,this.domElement=o,this.mouseButtons={LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.quaternion0=this.object.quaternion.clone(),this.zoom0=this.object.zoom,this.quat=new Quaternion().setFromUnitVectors(this.object.up,new Vector3(0,1,0)),this.quatInverse=this.quat.clone().invert(),this.lastPosition=new Vector3,this.lastQuaternion=new Quaternion,this.domElement.addEventListener("contextmenu",this.onContextMenu,!1),this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("wheel",this.onMouseWheel,!1),this.domElement.addEventListener("touchstart",this.onTouchStart,!1),this.domElement.addEventListener("touchend",this.onTouchEnd,!1),this.domElement.addEventListener("touchmove",this.onTouchMove,!1),this.domElement.addEventListener("keydown",this.onKeyDown,!1),this.domElement.tabIndex===-1&&(this.domElement.tabIndex=0),this.object.lookAt(this.target),this.update(),this.saveState()}handleMouseUp(){}handleTouchEnd(){}}const targetPosition=new Vector3;class FirstPersonControls extends EventDispatcher{constructor(s,o){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"movementSpeed",1),__publicField(this,"lookSpeed",.005),__publicField(this,"lookVertical",!0),__publicField(this,"autoForward",!1),__publicField(this,"activeLook",!0),__publicField(this,"heightSpeed",!1),__publicField(this,"heightCoef",1),__publicField(this,"heightMin",0),__publicField(this,"heightMax",1),__publicField(this,"constrainVertical",!1),__publicField(this,"verticalMin",0),__publicField(this,"verticalMax",Math.PI),__publicField(this,"mouseDragOn",!1),__publicField(this,"autoSpeedFactor",0),__publicField(this,"mouseX",0),__publicField(this,"mouseY",0),__publicField(this,"moveForward",!1),__publicField(this,"moveBackward",!1),__publicField(this,"moveLeft",!1),__publicField(this,"moveRight",!1),__publicField(this,"moveUp",!1),__publicField(this,"moveDown",!1),__publicField(this,"viewHalfX",0),__publicField(this,"viewHalfY",0),__publicField(this,"lat",0),__publicField(this,"lon",0),__publicField(this,"lookDirection",new Vector3),__publicField(this,"spherical",new Spherical),__publicField(this,"target",new Vector3),__publicField(this,"connect",j=>{j.setAttribute("tabindex","-1"),j.style.touchAction="none",j.addEventListener("contextmenu",this.contextmenu),j.addEventListener("mousemove",this.onMouseMove),j.addEventListener("mousedown",this.onMouseDown),j.addEventListener("mouseup",this.onMouseUp),this.domElement=j,window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.handleResize()}),__publicField(this,"dispose",()=>{var j,$,_e,tt;(j=this.domElement)==null||j.removeEventListener("contextmenu",this.contextmenu),($=this.domElement)==null||$.removeEventListener("mousedown",this.onMouseDown),(_e=this.domElement)==null||_e.removeEventListener("mousemove",this.onMouseMove),(tt=this.domElement)==null||tt.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}),__publicField(this,"handleResize",()=>{this.domElement&&(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)}),__publicField(this,"onMouseDown",j=>{var $;if(($=this.domElement)==null||$.focus(),this.activeLook)switch(j.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0}),__publicField(this,"onMouseUp",j=>{if(this.activeLook)switch(j.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1}),__publicField(this,"onMouseMove",j=>{this.domElement&&(this.mouseX=j.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=j.pageY-this.domElement.offsetTop-this.viewHalfY)}),__publicField(this,"onKeyDown",j=>{switch(j.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}}),__publicField(this,"onKeyUp",j=>{switch(j.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}}),__publicField(this,"lookAt",(j,$,_e)=>(j instanceof Vector3?this.target.copy(j):$&&_e&&this.target.set(j,$,_e),this.object.lookAt(this.target),this.setOrientation(),this)),__publicField(this,"update",j=>{if(!this.enabled)return;if(this.heightSpeed){const at=MathUtils.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=j*(at*this.heightCoef)}else this.autoSpeedFactor=0;const $=j*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-($+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ($),this.moveLeft&&this.object.translateX(-$),this.moveRight&&this.object.translateX($),this.moveUp&&this.object.translateY($),this.moveDown&&this.object.translateY(-$);let _e=j*this.lookSpeed;this.activeLook||(_e=0);let tt=1;this.constrainVertical&&(tt=Math.PI/(this.verticalMax-this.verticalMin)),this.lon-=this.mouseX*_e,this.lookVertical&&(this.lat-=this.mouseY*_e*tt),this.lat=Math.max(-85,Math.min(85,this.lat));let nt=MathUtils.degToRad(90-this.lat);const rt=MathUtils.degToRad(this.lon);this.constrainVertical&&(nt=MathUtils.mapLinear(nt,0,Math.PI,this.verticalMin,this.verticalMax));const it=this.object.position;targetPosition.setFromSphericalCoords(1,nt,rt).add(it),this.object.lookAt(targetPosition)}),__publicField(this,"contextmenu",j=>j.preventDefault()),__publicField(this,"setOrientation",()=>{this.lookDirection.set(0,0,-1).applyQuaternion(this.object.quaternion),this.spherical.setFromVector3(this.lookDirection),this.lat=90-MathUtils.radToDeg(this.spherical.phi),this.lon=MathUtils.radToDeg(this.spherical.theta)}),this.object=s,this.domElement=o,this.setOrientation(),o&&this.connect(o)}}class TransformControls extends Object3D{constructor(s,o){super(),__publicField(this,"isTransformControls",!0),__publicField(this,"visible",!1),__publicField(this,"domElement"),__publicField(this,"raycaster",new Raycaster),__publicField(this,"gizmo"),__publicField(this,"plane"),__publicField(this,"tempVector",new Vector3),__publicField(this,"tempVector2",new Vector3),__publicField(this,"tempQuaternion",new Quaternion),__publicField(this,"unit",{X:new Vector3(1,0,0),Y:new Vector3(0,1,0),Z:new Vector3(0,0,1)}),__publicField(this,"pointStart",new Vector3),__publicField(this,"pointEnd",new Vector3),__publicField(this,"offset",new Vector3),__publicField(this,"rotationAxis",new Vector3),__publicField(this,"startNorm",new Vector3),__publicField(this,"endNorm",new Vector3),__publicField(this,"rotationAngle",0),__publicField(this,"cameraPosition",new Vector3),__publicField(this,"cameraQuaternion",new Quaternion),__publicField(this,"cameraScale",new Vector3),__publicField(this,"parentPosition",new Vector3),__publicField(this,"parentQuaternion",new Quaternion),__publicField(this,"parentQuaternionInv",new Quaternion),__publicField(this,"parentScale",new Vector3),__publicField(this,"worldPositionStart",new Vector3),__publicField(this,"worldQuaternionStart",new Quaternion),__publicField(this,"worldScaleStart",new Vector3),__publicField(this,"worldPosition",new Vector3),__publicField(this,"worldQuaternion",new Quaternion),__publicField(this,"worldQuaternionInv",new Quaternion),__publicField(this,"worldScale",new Vector3),__publicField(this,"eye",new Vector3),__publicField(this,"positionStart",new Vector3),__publicField(this,"quaternionStart",new Quaternion),__publicField(this,"scaleStart",new Vector3),__publicField(this,"camera"),__publicField(this,"object"),__publicField(this,"enabled",!0),__publicField(this,"axis",null),__publicField(this,"mode","translate"),__publicField(this,"translationSnap",null),__publicField(this,"rotationSnap",null),__publicField(this,"scaleSnap",null),__publicField(this,"space","world"),__publicField(this,"size",1),__publicField(this,"dragging",!1),__publicField(this,"showX",!0),__publicField(this,"showY",!0),__publicField(this,"showZ",!0),__publicField(this,"changeEvent",{type:"change"}),__publicField(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),__publicField(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),__publicField(this,"objectChangeEvent",{type:"objectChange"}),__publicField(this,"intersectObjectWithRay",($,_e,tt)=>{const nt=_e.intersectObject($,!0);for(let rt=0;rt<nt.length;rt++)if(nt[rt].object.visible||tt)return nt[rt];return!1}),__publicField(this,"attach",$=>(this.object=$,this.visible=!0,this)),__publicField(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),__publicField(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),__publicField(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),__publicField(this,"pointerHover",$=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera($,this.camera);const _e=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);_e?this.axis=_e.object.name:this.axis=null}),__publicField(this,"pointerDown",$=>{if(!(this.object===void 0||this.dragging===!0||$.button!==0)&&this.axis!==null){this.raycaster.setFromCamera($,this.camera);const _e=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(_e){let tt=this.space;if(this.mode==="scale"?tt="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(tt="world"),tt==="local"&&this.mode==="rotate"){const nt=this.rotationSnap;this.axis==="X"&&nt&&(this.object.rotation.x=Math.round(this.object.rotation.x/nt)*nt),this.axis==="Y"&&nt&&(this.object.rotation.y=Math.round(this.object.rotation.y/nt)*nt),this.axis==="Z"&&nt&&(this.object.rotation.z=Math.round(this.object.rotation.z/nt)*nt)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(_e.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),__publicField(this,"pointerMove",$=>{const _e=this.axis,tt=this.mode,nt=this.object;let rt=this.space;if(tt==="scale"?rt="local":(_e==="E"||_e==="XYZE"||_e==="XYZ")&&(rt="world"),nt===void 0||_e===null||this.dragging===!1||$.button!==-1)return;this.raycaster.setFromCamera($,this.camera);const it=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(it){if(this.pointEnd.copy(it.point).sub(this.worldPositionStart),tt==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),rt==="local"&&_e!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),_e.indexOf("X")===-1&&(this.offset.x=0),_e.indexOf("Y")===-1&&(this.offset.y=0),_e.indexOf("Z")===-1&&(this.offset.z=0),rt==="local"&&_e!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),nt.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(rt==="local"&&(nt.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),_e.search("X")!==-1&&(nt.position.x=Math.round(nt.position.x/this.translationSnap)*this.translationSnap),_e.search("Y")!==-1&&(nt.position.y=Math.round(nt.position.y/this.translationSnap)*this.translationSnap),_e.search("Z")!==-1&&(nt.position.z=Math.round(nt.position.z/this.translationSnap)*this.translationSnap),nt.position.applyQuaternion(this.quaternionStart)),rt==="world"&&(nt.parent&&nt.position.add(this.tempVector.setFromMatrixPosition(nt.parent.matrixWorld)),_e.search("X")!==-1&&(nt.position.x=Math.round(nt.position.x/this.translationSnap)*this.translationSnap),_e.search("Y")!==-1&&(nt.position.y=Math.round(nt.position.y/this.translationSnap)*this.translationSnap),_e.search("Z")!==-1&&(nt.position.z=Math.round(nt.position.z/this.translationSnap)*this.translationSnap),nt.parent&&nt.position.sub(this.tempVector.setFromMatrixPosition(nt.parent.matrixWorld))));else if(tt==="scale"){if(_e.search("XYZ")!==-1){let st=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(st*=-1),this.tempVector2.set(st,st,st)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),_e.search("X")===-1&&(this.tempVector2.x=1),_e.search("Y")===-1&&(this.tempVector2.y=1),_e.search("Z")===-1&&(this.tempVector2.z=1);nt.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(_e.search("X")!==-1&&(this.object.scale.x=Math.round(nt.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),_e.search("Y")!==-1&&(nt.scale.y=Math.round(nt.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),_e.search("Z")!==-1&&(nt.scale.z=Math.round(nt.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(tt==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const st=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));_e==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):_e==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*st):(_e==="X"||_e==="Y"||_e==="Z")&&(this.rotationAxis.copy(this.unit[_e]),this.tempVector.copy(this.unit[_e]),rt==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*st),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),rt==="local"&&_e!=="E"&&_e!=="XYZE"?(nt.quaternion.copy(this.quaternionStart),nt.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),nt.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),nt.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),__publicField(this,"pointerUp",$=>{$.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),__publicField(this,"getPointer",$=>{var _e,tt;if(this.domElement&&((_e=this.domElement.ownerDocument)!=null&&_e.pointerLockElement))return{x:0,y:0,button:$.button};{const nt=$.changedTouches?$.changedTouches[0]:$,rt=(tt=this.domElement)==null?void 0:tt.getBoundingClientRect();return{x:(nt.clientX-rt.left)/rt.width*2-1,y:-(nt.clientY-rt.top)/rt.height*2+1,button:$.button}}}),__publicField(this,"onPointerHover",$=>{if(this.enabled)switch($.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer($));break}}),__publicField(this,"onPointerDown",$=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer($)),this.pointerDown(this.getPointer($)))}),__publicField(this,"onPointerMove",$=>{this.enabled&&this.pointerMove(this.getPointer($))}),__publicField(this,"onPointerUp",$=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer($)))}),__publicField(this,"getMode",()=>this.mode),__publicField(this,"setMode",$=>{this.mode=$}),__publicField(this,"setTranslationSnap",$=>{this.translationSnap=$}),__publicField(this,"setRotationSnap",$=>{this.rotationSnap=$}),__publicField(this,"setScaleSnap",$=>{this.scaleSnap=$}),__publicField(this,"setSize",$=>{this.size=$}),__publicField(this,"setSpace",$=>{this.space=$}),__publicField(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),__publicField(this,"connect",$=>{$===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=$,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),__publicField(this,"dispose",()=>{var $,_e,tt,nt,rt,it;($=this.domElement)==null||$.removeEventListener("pointerdown",this.onPointerDown),(_e=this.domElement)==null||_e.removeEventListener("pointermove",this.onPointerHover),(nt=(tt=this.domElement)==null?void 0:tt.ownerDocument)==null||nt.removeEventListener("pointermove",this.onPointerMove),(it=(rt=this.domElement)==null?void 0:rt.ownerDocument)==null||it.removeEventListener("pointerup",this.onPointerUp),this.traverse(st=>{const at=st;at.geometry&&at.geometry.dispose(),at.material&&at.material.dispose()})}),this.domElement=o,this.camera=s,this.gizmo=new TransformControlsGizmo,this.add(this.gizmo),this.plane=new TransformControlsPlane,this.add(this.plane);const j=($,_e)=>{let tt=_e;Object.defineProperty(this,$,{get:function(){return tt!==void 0?tt:_e},set:function(nt){tt!==nt&&(tt=nt,this.plane[$]=nt,this.gizmo[$]=nt,this.dispatchEvent({type:$+"-changed",value:nt}),this.dispatchEvent(this.changeEvent))}}),this[$]=_e,this.plane[$]=_e,this.gizmo[$]=_e};j("camera",this.camera),j("object",this.object),j("enabled",this.enabled),j("axis",this.axis),j("mode",this.mode),j("translationSnap",this.translationSnap),j("rotationSnap",this.rotationSnap),j("scaleSnap",this.scaleSnap),j("space",this.space),j("size",this.size),j("dragging",this.dragging),j("showX",this.showX),j("showY",this.showY),j("showZ",this.showZ),j("worldPosition",this.worldPosition),j("worldPositionStart",this.worldPositionStart),j("worldQuaternion",this.worldQuaternion),j("worldQuaternionStart",this.worldQuaternionStart),j("cameraPosition",this.cameraPosition),j("cameraQuaternion",this.cameraQuaternion),j("pointStart",this.pointStart),j("pointEnd",this.pointEnd),j("rotationAxis",this.rotationAxis),j("rotationAngle",this.rotationAngle),j("eye",this.eye),o!==void 0&&this.connect(o)}}class TransformControlsGizmo extends Object3D{constructor(){super(),__publicField(this,"isTransformControlsGizmo",!0),__publicField(this,"type","TransformControlsGizmo"),__publicField(this,"tempVector",new Vector3(0,0,0)),__publicField(this,"tempEuler",new Euler),__publicField(this,"alignVector",new Vector3(0,1,0)),__publicField(this,"zeroVector",new Vector3(0,0,0)),__publicField(this,"lookAtMatrix",new Matrix4),__publicField(this,"tempQuaternion",new Quaternion),__publicField(this,"tempQuaternion2",new Quaternion),__publicField(this,"identityQuaternion",new Quaternion),__publicField(this,"unitX",new Vector3(1,0,0)),__publicField(this,"unitY",new Vector3(0,1,0)),__publicField(this,"unitZ",new Vector3(0,0,1)),__publicField(this,"gizmo"),__publicField(this,"picker"),__publicField(this,"helper"),__publicField(this,"rotationAxis",new Vector3),__publicField(this,"cameraPosition",new Vector3),__publicField(this,"worldPositionStart",new Vector3),__publicField(this,"worldQuaternionStart",new Quaternion),__publicField(this,"worldPosition",new Vector3),__publicField(this,"worldQuaternion",new Quaternion),__publicField(this,"eye",new Vector3),__publicField(this,"camera",null),__publicField(this,"enabled",!0),__publicField(this,"axis",null),__publicField(this,"mode","translate"),__publicField(this,"space","world"),__publicField(this,"size",1),__publicField(this,"dragging",!1),__publicField(this,"showX",!0),__publicField(this,"showY",!0),__publicField(this,"showZ",!0),__publicField(this,"updateMatrixWorld",()=>{let nn=this.space;this.mode==="scale"&&(nn="local");const mn=nn==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let Zt=[];Zt=Zt.concat(this.picker[this.mode].children),Zt=Zt.concat(this.gizmo[this.mode].children),Zt=Zt.concat(this.helper[this.mode].children);for(let cn=0;cn<Zt.length;cn++){const Ot=Zt[cn];Ot.visible=!0,Ot.rotation.set(0,0,0),Ot.position.copy(this.worldPosition);let rn;if(this.camera.isOrthographicCamera?rn=(this.camera.top-this.camera.bottom)/this.camera.zoom:rn=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),Ot.scale.set(1,1,1).multiplyScalar(rn*this.size/7),Ot.tag==="helper"){Ot.visible=!1,Ot.name==="AXIS"?(Ot.position.copy(this.worldPositionStart),Ot.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),Ot.quaternion.copy(mn).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(mn).dot(this.eye))>.9&&(Ot.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),Ot.quaternion.copy(mn).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(mn).dot(this.eye))>.9&&(Ot.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),Ot.quaternion.copy(mn).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(mn).dot(this.eye))>.9&&(Ot.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),Ot.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),Ot.quaternion.multiply(this.tempQuaternion),Ot.visible=this.dragging),this.axis==="E"&&(Ot.visible=!1)):Ot.name==="START"?(Ot.position.copy(this.worldPositionStart),Ot.visible=this.dragging):Ot.name==="END"?(Ot.position.copy(this.worldPosition),Ot.visible=this.dragging):Ot.name==="DELTA"?(Ot.position.copy(this.worldPositionStart),Ot.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),Ot.scale.copy(this.tempVector),Ot.visible=this.dragging):(Ot.quaternion.copy(mn),this.dragging?Ot.position.copy(this.worldPositionStart):Ot.position.copy(this.worldPosition),this.axis&&(Ot.visible=this.axis.search(Ot.name)!==-1));continue}Ot.quaternion.copy(mn),this.mode==="translate"||this.mode==="scale"?((Ot.name==="X"||Ot.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(mn).dot(this.eye))>.99&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),(Ot.name==="Y"||Ot.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(mn).dot(this.eye))>.99&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),(Ot.name==="Z"||Ot.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(mn).dot(this.eye))>.99&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),Ot.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(mn).dot(this.eye))<.2&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),Ot.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(mn).dot(this.eye))<.2&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),Ot.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(mn).dot(this.eye))<.2&&(Ot.scale.set(1e-10,1e-10,1e-10),Ot.visible=!1),Ot.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(mn).dot(this.eye)<0?Ot.tag==="fwd"?Ot.visible=!1:Ot.scale.x*=-1:Ot.tag==="bwd"&&(Ot.visible=!1)),Ot.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(mn).dot(this.eye)<0?Ot.tag==="fwd"?Ot.visible=!1:Ot.scale.y*=-1:Ot.tag==="bwd"&&(Ot.visible=!1)),Ot.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(mn).dot(this.eye)<0?Ot.tag==="fwd"?Ot.visible=!1:Ot.scale.z*=-1:Ot.tag==="bwd"&&(Ot.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(mn),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(mn).invert()),Ot.name.search("E")!==-1&&Ot.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),Ot.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Ot.quaternion.copy(this.tempQuaternion)),Ot.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Ot.quaternion.copy(this.tempQuaternion)),Ot.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Ot.quaternion.copy(this.tempQuaternion))),Ot.visible=Ot.visible&&(Ot.name.indexOf("X")===-1||this.showX),Ot.visible=Ot.visible&&(Ot.name.indexOf("Y")===-1||this.showY),Ot.visible=Ot.visible&&(Ot.name.indexOf("Z")===-1||this.showZ),Ot.visible=Ot.visible&&(Ot.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),Ot.material.tempOpacity=Ot.material.tempOpacity||Ot.material.opacity,Ot.material.tempColor=Ot.material.tempColor||Ot.material.color.clone(),Ot.material.color.copy(Ot.material.tempColor),Ot.material.opacity=Ot.material.tempOpacity,this.enabled?this.axis&&(Ot.name===this.axis?(Ot.material.opacity=1,Ot.material.color.lerp(new Color(1,1,1),.5)):this.axis.split("").some(function(fn){return Ot.name===fn})?(Ot.material.opacity=1,Ot.material.color.lerp(new Color(1,1,1),.5)):(Ot.material.opacity*=.25,Ot.material.color.lerp(new Color(1,1,1),.5))):(Ot.material.opacity*=.5,Ot.material.color.lerp(new Color(1,1,1),.5))}super.updateMatrixWorld()});const s=new MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide,fog:!1,toneMapped:!1}),o=new LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),j=s.clone();j.opacity=.15;const $=s.clone();$.opacity=.33;const _e=s.clone();_e.color.set(16711680);const tt=s.clone();tt.color.set(65280);const nt=s.clone();nt.color.set(255);const rt=s.clone();rt.opacity=.25;const it=rt.clone();it.color.set(16776960);const st=rt.clone();st.color.set(65535);const at=rt.clone();at.color.set(16711935),s.clone().color.set(16776960);const ct=o.clone();ct.color.set(16711680);const ft=o.clone();ft.color.set(65280);const ht=o.clone();ht.color.set(255);const mt=o.clone();mt.color.set(65535);const lt=o.clone();lt.color.set(16711935);const ut=o.clone();ut.color.set(16776960);const dt=o.clone();dt.color.set(7895160);const gt=ut.clone();gt.opacity=.25;const Et=new CylinderGeometry(0,.05,.2,12,1,!1),St=new BoxGeometry(.125,.125,.125),Tt=new BufferGeometry;Tt.setAttribute("position",new Float32BufferAttribute([0,0,0,1,0,0],3));const Mt=(nn,mn)=>{const Zt=new BufferGeometry,cn=[];for(let Ot=0;Ot<=64*mn;++Ot)cn.push(0,Math.cos(Ot/32*Math.PI)*nn,Math.sin(Ot/32*Math.PI)*nn);return Zt.setAttribute("position",new Float32BufferAttribute(cn,3)),Zt},Bt=()=>{const nn=new BufferGeometry;return nn.setAttribute("position",new Float32BufferAttribute([0,0,0,1,1,1],3)),nn},Rt={X:[[new Mesh(Et,_e),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Mesh(Et,_e),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Line(Tt,ct)]],Y:[[new Mesh(Et,tt),[0,1,0],null,null,"fwd"],[new Mesh(Et,tt),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Line(Tt,ft),null,[0,0,Math.PI/2]]],Z:[[new Mesh(Et,nt),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Mesh(Et,nt),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Line(Tt,ht),null,[0,-Math.PI/2,0]]],XYZ:[[new Mesh(new OctahedronGeometry(.1,0),rt.clone()),[0,0,0],[0,0,0]]],XY:[[new Mesh(new PlaneGeometry(.295,.295),it.clone()),[.15,.15,0]],[new Line(Tt,ut),[.18,.3,0],null,[.125,1,1]],[new Line(Tt,ut),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(new PlaneGeometry(.295,.295),st.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Line(Tt,mt),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Line(Tt,mt),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(new PlaneGeometry(.295,.295),at.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Line(Tt,lt),[.18,0,.3],null,[.125,1,1]],[new Line(Tt,lt),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},Ut={X:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),j),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),j),[0,.6,0]]],Z:[[new Mesh(new CylinderGeometry(.2,0,1,4,1,!1),j),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Mesh(new OctahedronGeometry(.2,0),j)]],XY:[[new Mesh(new PlaneGeometry(.4,.4),j),[.2,.2,0]]],YZ:[[new Mesh(new PlaneGeometry(.4,.4),j),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Mesh(new PlaneGeometry(.4,.4),j),[.2,0,.2],[-Math.PI/2,0,0]]]},Ht={START:[[new Mesh(new OctahedronGeometry(.01,2),$),null,null,null,"helper"]],END:[[new Mesh(new OctahedronGeometry(.01,2),$),null,null,null,"helper"]],DELTA:[[new Line(Bt(),$),null,null,null,"helper"]],X:[[new Line(Tt,$.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(Tt,$.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(Tt,$.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Wt={X:[[new Line(Mt(1,.5),ct)],[new Mesh(new OctahedronGeometry(.04,0),_e),[0,0,.99],null,[1,3,1]]],Y:[[new Line(Mt(1,.5),ft),null,[0,0,-Math.PI/2]],[new Mesh(new OctahedronGeometry(.04,0),tt),[0,0,.99],null,[3,1,1]]],Z:[[new Line(Mt(1,.5),ht),null,[0,Math.PI/2,0]],[new Mesh(new OctahedronGeometry(.04,0),nt),[.99,0,0],null,[1,3,1]]],E:[[new Line(Mt(1.25,1),gt),null,[0,Math.PI/2,0]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),gt),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),gt),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),gt),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Mesh(new CylinderGeometry(.03,0,.15,4,1,!1),gt),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Line(Mt(1,1),dt),null,[0,Math.PI/2,0]]]},Jt={AXIS:[[new Line(Tt,$.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},sn={X:[[new Mesh(new TorusGeometry(1,.1,4,24),j),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mesh(new TorusGeometry(1,.1,4,24),j),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mesh(new TorusGeometry(1,.1,4,24),j),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mesh(new TorusGeometry(1.25,.1,2,24),j)]],XYZE:[[new Mesh(new SphereGeometry(.7,10,8),j)]]},jt={X:[[new Mesh(St,_e),[.8,0,0],[0,0,-Math.PI/2]],[new Line(Tt,ct),null,null,[.8,1,1]]],Y:[[new Mesh(St,tt),[0,.8,0]],[new Line(Tt,ft),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Mesh(St,nt),[0,0,.8],[Math.PI/2,0,0]],[new Line(Tt,ht),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Mesh(St,it),[.85,.85,0],null,[2,2,.2]],[new Line(Tt,ut),[.855,.98,0],null,[.125,1,1]],[new Line(Tt,ut),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(St,st),[0,.85,.85],null,[.2,2,2]],[new Line(Tt,mt),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Line(Tt,mt),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(St,at),[.85,0,.85],null,[2,.2,2]],[new Line(Tt,lt),[.855,0,.98],null,[.125,1,1]],[new Line(Tt,lt),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Mesh(new BoxGeometry(.125,.125,.125),rt.clone()),[1.1,0,0]]],XYZY:[[new Mesh(new BoxGeometry(.125,.125,.125),rt.clone()),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxGeometry(.125,.125,.125),rt.clone()),[0,0,1.1]]]},Vt={X:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),j),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),j),[0,.5,0]]],Z:[[new Mesh(new CylinderGeometry(.2,0,.8,4,1,!1),j),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Mesh(St,j),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Mesh(St,j),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Mesh(St,j),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Mesh(new BoxGeometry(.2,.2,.2),j),[1.1,0,0]]],XYZY:[[new Mesh(new BoxGeometry(.2,.2,.2),j),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxGeometry(.2,.2,.2),j),[0,0,1.1]]]},Lt={X:[[new Line(Tt,$.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(Tt,$.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(Tt,$.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Qt=nn=>{const mn=new Object3D;for(let Zt in nn)for(let cn=nn[Zt].length;cn--;){const Ot=nn[Zt][cn][0].clone(),rn=nn[Zt][cn][1],fn=nn[Zt][cn][2],hn=nn[Zt][cn][3],Tn=nn[Zt][cn][4];Ot.name=Zt,Ot.tag=Tn,rn&&Ot.position.set(rn[0],rn[1],rn[2]),fn&&Ot.rotation.set(fn[0],fn[1],fn[2]),hn&&Ot.scale.set(hn[0],hn[1],hn[2]),Ot.updateMatrix();const Nn=Ot.geometry.clone();Nn.applyMatrix4(Ot.matrix),Ot.geometry=Nn,Ot.renderOrder=1/0,Ot.position.set(0,0,0),Ot.rotation.set(0,0,0),Ot.scale.set(1,1,1),mn.add(Ot)}return mn};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Qt(Rt)),this.add(this.gizmo.rotate=Qt(Wt)),this.add(this.gizmo.scale=Qt(jt)),this.add(this.picker.translate=Qt(Ut)),this.add(this.picker.rotate=Qt(sn)),this.add(this.picker.scale=Qt(Vt)),this.add(this.helper.translate=Qt(Ht)),this.add(this.helper.rotate=Qt(Jt)),this.add(this.helper.scale=Qt(Lt)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class TransformControlsPlane extends Mesh{constructor(){super(new PlaneGeometry(1e5,1e5,2,2),new MeshBasicMaterial({visible:!1,wireframe:!0,side:DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),__publicField(this,"isTransformControlsPlane",!0),__publicField(this,"type","TransformControlsPlane"),__publicField(this,"unitX",new Vector3(1,0,0)),__publicField(this,"unitY",new Vector3(0,1,0)),__publicField(this,"unitZ",new Vector3(0,0,1)),__publicField(this,"tempVector",new Vector3),__publicField(this,"dirVector",new Vector3),__publicField(this,"alignVector",new Vector3),__publicField(this,"tempMatrix",new Matrix4),__publicField(this,"identityQuaternion",new Quaternion),__publicField(this,"cameraQuaternion",new Quaternion),__publicField(this,"worldPosition",new Vector3),__publicField(this,"worldQuaternion",new Quaternion),__publicField(this,"eye",new Vector3),__publicField(this,"axis",null),__publicField(this,"mode","translate"),__publicField(this,"space","world"),__publicField(this,"updateMatrixWorld",()=>{let s=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(s="local"),this.unitX.set(1,0,0).applyQuaternion(s==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(s==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(s==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}class DragControls extends EventDispatcher{constructor(s,o,j){super(),__publicField(this,"enabled",!0),__publicField(this,"transformGroup",!1),__publicField(this,"_objects"),__publicField(this,"_camera"),__publicField(this,"_domElement"),__publicField(this,"_plane",new Plane),__publicField(this,"_raycaster",new Raycaster),__publicField(this,"_mouse",new Vector2),__publicField(this,"_offset",new Vector3),__publicField(this,"_intersection",new Vector3),__publicField(this,"_worldPosition",new Vector3),__publicField(this,"_inverseMatrix",new Matrix4),__publicField(this,"_intersections",[]),__publicField(this,"_selected",null),__publicField(this,"_hovered",null),__publicField(this,"activate",()=>{this._domElement.addEventListener("pointermove",this.onPointerMove),this._domElement.addEventListener("pointerdown",this.onPointerDown),this._domElement.addEventListener("pointerup",this.onPointerCancel),this._domElement.addEventListener("pointerleave",this.onPointerCancel),this._domElement.addEventListener("touchmove",this.onTouchMove),this._domElement.addEventListener("touchstart",this.onTouchStart),this._domElement.addEventListener("touchend",this.onTouchEnd)}),__publicField(this,"deactivate",()=>{this._domElement.removeEventListener("pointermove",this.onPointerMove),this._domElement.removeEventListener("pointerdown",this.onPointerDown),this._domElement.removeEventListener("pointerup",this.onPointerCancel),this._domElement.removeEventListener("pointerleave",this.onPointerCancel),this._domElement.removeEventListener("touchmove",this.onTouchMove),this._domElement.removeEventListener("touchstart",this.onTouchStart),this._domElement.removeEventListener("touchend",this.onTouchEnd),this._domElement.style.cursor=""}),__publicField(this,"dispose",()=>this.deactivate()),__publicField(this,"getObjects",()=>this._objects),__publicField(this,"getRaycaster",()=>this._raycaster),__publicField(this,"onMouseMove",$=>{const _e=this._domElement.getBoundingClientRect();if(this._mouse.x=($.clientX-_e.left)/_e.width*2-1,this._mouse.y=-(($.clientY-_e.top)/_e.height)*2+1,this._raycaster.setFromCamera(this._mouse,this._camera),this._selected&&this.enabled){this._raycaster.ray.intersectPlane(this._plane,this._intersection)&&this._selected.position.copy(this._intersection.sub(this._offset).applyMatrix4(this._inverseMatrix)),this.dispatchEvent({type:"drag",object:this._selected});return}if(this._intersections.length=0,this._raycaster.setFromCamera(this._mouse,this._camera),this._raycaster.intersectObjects(this._objects,!0,this._intersections),this._intersections.length>0){const tt=this._intersections[0].object;this._plane.setFromNormalAndCoplanarPoint(this._camera.getWorldDirection(this._plane.normal),this._worldPosition.setFromMatrixPosition(tt.matrixWorld)),this._hovered!==tt&&(this.dispatchEvent({type:"hoveron",object:tt}),this._domElement.style.cursor="pointer",this._hovered=tt)}else this._hovered!==null&&(this.dispatchEvent({type:"hoveroff",object:this._hovered}),this._domElement.style.cursor="auto",this._hovered=null)}),__publicField(this,"onMouseDown",()=>{this._intersections.length=0,this._raycaster.setFromCamera(this._mouse,this._camera),this._raycaster.intersectObjects(this._objects,!0,this._intersections),this._intersections.length>0&&(this._selected=this.transformGroup===!0?this._objects[0]:this._intersections[0].object,this._raycaster.ray.intersectPlane(this._plane,this._intersection)&&this._selected.parent&&(this._inverseMatrix.copy(this._selected.parent.matrixWorld).invert(),this._offset.copy(this._intersection).sub(this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld))),this._domElement.style.cursor="move",this.dispatchEvent({type:"dragstart",object:this._selected}))}),__publicField(this,"onMouseCancel",()=>{this._selected&&(this.dispatchEvent({type:"dragend",object:this._selected}),this._selected=null),this._domElement.style.cursor=this._hovered?"pointer":"auto"}),__publicField(this,"onPointerMove",$=>{switch($.pointerType){case"mouse":case"pen":this.onMouseMove($);break}}),__publicField(this,"onPointerDown",$=>{switch($.pointerType){case"mouse":case"pen":this.onMouseDown();break}}),__publicField(this,"onPointerCancel",$=>{switch($.pointerType){case"mouse":case"pen":this.onMouseCancel();break}}),__publicField(this,"onTouchMove",$=>{$.preventDefault();const _e=$.changedTouches[0],tt=this._domElement.getBoundingClientRect();if(this._mouse.x=(_e.clientX-tt.left)/tt.width*2-1,this._mouse.y=-((_e.clientY-tt.top)/tt.height)*2+1,this._raycaster.setFromCamera(this._mouse,this._camera),this._selected&&this.enabled){this._raycaster.ray.intersectPlane(this._plane,this._intersection)&&this._selected.position.copy(this._intersection.sub(this._offset).applyMatrix4(this._inverseMatrix)),this.dispatchEvent({type:"drag",object:this._selected});return}}),__publicField(this,"onTouchStart",$=>{$.preventDefault();const _e=$.changedTouches[0],tt=this._domElement.getBoundingClientRect();this._mouse.x=(_e.clientX-tt.left)/tt.width*2-1,this._mouse.y=-((_e.clientY-tt.top)/tt.height)*2+1,this._intersections.length=0,this._raycaster.setFromCamera(this._mouse,this._camera),this._raycaster.intersectObjects(this._objects,!0,this._intersections),this._intersections.length>0&&(this._selected=this.transformGroup===!0?this._objects[0]:this._intersections[0].object,this._plane.setFromNormalAndCoplanarPoint(this._camera.getWorldDirection(this._plane.normal),this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld)),this._raycaster.ray.intersectPlane(this._plane,this._intersection)&&this._selected.parent&&(this._inverseMatrix.copy(this._selected.parent.matrixWorld).invert(),this._offset.copy(this._intersection).sub(this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld))),this._domElement.style.cursor="move",this.dispatchEvent({type:"dragstart",object:this._selected}))}),__publicField(this,"onTouchEnd",$=>{$.preventDefault(),this._selected&&(this.dispatchEvent({type:"dragend",object:this._selected}),this._selected=null),this._domElement.style.cursor="auto"}),this._objects=s,this._camera=o,this._domElement=j,this.activate()}}const _euler=new Euler(0,0,0,"YXZ"),_vector$2=new Vector3,_changeEvent$1={type:"change"},_lockEvent={type:"lock"},_unlockEvent={type:"unlock"},_PI_2=Math.PI/2;class PointerLockControls extends EventDispatcher{constructor(s,o){super(),__publicField(this,"camera"),__publicField(this,"domElement"),__publicField(this,"isLocked"),__publicField(this,"minPolarAngle"),__publicField(this,"maxPolarAngle"),__publicField(this,"pointerSpeed"),__publicField(this,"onMouseMove",j=>{if(!this.domElement||this.isLocked===!1)return;const $=j.movementX||j.mozMovementX||j.webkitMovementX||0,_e=j.movementY||j.mozMovementY||j.webkitMovementY||0;_euler.setFromQuaternion(this.camera.quaternion),_euler.y-=$*.002*this.pointerSpeed,_euler.x-=_e*.002*this.pointerSpeed,_euler.x=Math.max(_PI_2-this.maxPolarAngle,Math.min(_PI_2-this.minPolarAngle,_euler.x)),this.camera.quaternion.setFromEuler(_euler),this.dispatchEvent(_changeEvent$1)}),__publicField(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(_lockEvent),this.isLocked=!0):(this.dispatchEvent(_unlockEvent),this.isLocked=!1))}),__publicField(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),__publicField(this,"connect",j=>{this.domElement=j||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),__publicField(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),__publicField(this,"dispose",()=>{this.disconnect()}),__publicField(this,"getObject",()=>this.camera),__publicField(this,"direction",new Vector3(0,0,-1)),__publicField(this,"getDirection",j=>j.copy(this.direction).applyQuaternion(this.camera.quaternion)),__publicField(this,"moveForward",j=>{_vector$2.setFromMatrixColumn(this.camera.matrix,0),_vector$2.crossVectors(this.camera.up,_vector$2),this.camera.position.addScaledVector(_vector$2,j)}),__publicField(this,"moveRight",j=>{_vector$2.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(_vector$2,j)}),__publicField(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),__publicField(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=s,this.domElement=o,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,o&&this.connect(o)}}class DeviceOrientationControls extends EventDispatcher{constructor(s){super(),__publicField(this,"object"),__publicField(this,"changeEvent",{type:"change"}),__publicField(this,"EPS",1e-6),__publicField(this,"enabled",!0),__publicField(this,"deviceOrientation",{alpha:0,beta:0,gamma:0}),__publicField(this,"screenOrientation",0),__publicField(this,"alphaOffset",0),__publicField(this,"onDeviceOrientationChangeEvent",o=>{this.deviceOrientation=o}),__publicField(this,"onScreenOrientationChangeEvent",()=>{this.screenOrientation=window.orientation||0}),__publicField(this,"zee",new Vector3(0,0,1)),__publicField(this,"euler",new Euler),__publicField(this,"q0",new Quaternion),__publicField(this,"q1",new Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),__publicField(this,"setObjectQuaternion",(o,j,$,_e,tt)=>{this.euler.set($,j,-_e,"YXZ"),o.setFromEuler(this.euler),o.multiply(this.q1),o.multiply(this.q0.setFromAxisAngle(this.zee,-tt))}),__publicField(this,"connect",()=>{this.onScreenOrientationChangeEvent(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(o=>{o=="granted"&&(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent))}).catch(o=>{console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",o)}):(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent)),this.enabled=!0}),__publicField(this,"disconnect",()=>{window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent),this.enabled=!1}),__publicField(this,"lastQuaternion",new Quaternion),__publicField(this,"update",()=>{if(this.enabled===!1)return;const o=this.deviceOrientation;if(o){const j=o.alpha?MathUtils.degToRad(o.alpha)+this.alphaOffset:0,$=o.beta?MathUtils.degToRad(o.beta):0,_e=o.gamma?MathUtils.degToRad(o.gamma):0,tt=this.screenOrientation?MathUtils.degToRad(this.screenOrientation):0;this.setObjectQuaternion(this.object.quaternion,j,$,_e,tt),8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS&&(this.lastQuaternion.copy(this.object.quaternion),this.dispatchEvent(this.changeEvent))}}),__publicField(this,"dispose",()=>this.disconnect()),this.object=s,this.object.rotation.reorder("YXZ"),this.connect()}}class TrackballControls extends EventDispatcher{constructor(s,o){super(),__publicField(this,"enabled",!0),__publicField(this,"screen",{left:0,top:0,width:0,height:0}),__publicField(this,"rotateSpeed",1),__publicField(this,"zoomSpeed",1.2),__publicField(this,"panSpeed",.3),__publicField(this,"noRotate",!1),__publicField(this,"noZoom",!1),__publicField(this,"noPan",!1),__publicField(this,"staticMoving",!1),__publicField(this,"dynamicDampingFactor",.2),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"keys",["KeyA","KeyS","KeyD"]),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"cursorZoom",!1),__publicField(this,"target",new Vector3),__publicField(this,"mousePosition",new Vector2),__publicField(this,"STATE",{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4}),__publicField(this,"EPS",1e-6),__publicField(this,"lastZoom",1),__publicField(this,"lastPosition",new Vector3),__publicField(this,"cursorVector",new Vector3),__publicField(this,"targetVector",new Vector3),__publicField(this,"_state",this.STATE.NONE),__publicField(this,"_keyState",this.STATE.NONE),__publicField(this,"_eye",new Vector3),__publicField(this,"_movePrev",new Vector2),__publicField(this,"_moveCurr",new Vector2),__publicField(this,"_lastAxis",new Vector3),__publicField(this,"_lastAngle",0),__publicField(this,"_zoomStart",new Vector2),__publicField(this,"_zoomEnd",new Vector2),__publicField(this,"_touchZoomDistanceStart",0),__publicField(this,"_touchZoomDistanceEnd",0),__publicField(this,"_panStart",new Vector2),__publicField(this,"_panEnd",new Vector2),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"up0"),__publicField(this,"zoom0"),__publicField(this,"changeEvent",{type:"change"}),__publicField(this,"startEvent",{type:"start"}),__publicField(this,"endEvent",{type:"end"}),__publicField(this,"onScreenVector",new Vector2),__publicField(this,"getMouseOnScreen",(j,$)=>(this.onScreenVector.set((j-this.screen.left)/this.screen.width,($-this.screen.top)/this.screen.height),this.onScreenVector)),__publicField(this,"onCircleVector",new Vector2),__publicField(this,"getMouseOnCircle",(j,$)=>(this.onCircleVector.set((j-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-$))/this.screen.width),this.onCircleVector)),__publicField(this,"axis",new Vector3),__publicField(this,"quaternion",new Quaternion),__publicField(this,"eyeDirection",new Vector3),__publicField(this,"objectUpDirection",new Vector3),__publicField(this,"objectSidewaysDirection",new Vector3),__publicField(this,"moveDirection",new Vector3),__publicField(this,"angle",0),__publicField(this,"rotateCamera",()=>{this.moveDirection.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0),this.angle=this.moveDirection.length(),this.angle?(this._eye.copy(this.object.position).sub(this.target),this.eyeDirection.copy(this._eye).normalize(),this.objectUpDirection.copy(this.object.up).normalize(),this.objectSidewaysDirection.crossVectors(this.objectUpDirection,this.eyeDirection).normalize(),this.objectUpDirection.setLength(this._moveCurr.y-this._movePrev.y),this.objectSidewaysDirection.setLength(this._moveCurr.x-this._movePrev.x),this.moveDirection.copy(this.objectUpDirection.add(this.objectSidewaysDirection)),this.axis.crossVectors(this.moveDirection,this._eye).normalize(),this.angle*=this.rotateSpeed,this.quaternion.setFromAxisAngle(this.axis,this.angle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion),this._lastAxis.copy(this.axis),this._lastAngle=this.angle):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),this.quaternion.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion)),this._movePrev.copy(this._moveCurr)}),__publicField(this,"zoomCamera",()=>{let j;if(this._state===this.STATE.TOUCH_ZOOM_PAN)j=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(j):this.object.isOrthographicCamera?(this.object.zoom/=j,this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type");else{if(j=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,Math.abs(j-1)>this.EPS&&j>0&&(this.object.isPerspectiveCamera?(j>1&&this._eye.length()>=this.maxDistance-this.EPS&&(j=1),this._eye.multiplyScalar(j)):this.object.isOrthographicCamera?(j>1&&this.object.zoom<this.maxDistance*this.maxDistance&&(j=1),this.object.zoom/=j):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor,this.cursorZoom){this.targetVector.copy(this.target).project(this.object);let $=this.cursorVector.set(this.mousePosition.x,this.mousePosition.y,this.targetVector.z).unproject(this.object);this.target.lerpVectors($,this.target,j)}this.object.isOrthographicCamera&&this.object.updateProjectionMatrix()}}),__publicField(this,"mouseChange",new Vector2),__publicField(this,"objectUp",new Vector3),__publicField(this,"pan",new Vector3),__publicField(this,"panCamera",()=>{if(this.domElement&&(this.mouseChange.copy(this._panEnd).sub(this._panStart),this.mouseChange.lengthSq()>this.EPS)){if(this.object.isOrthographicCamera){const j=this.object,$=(j.right-j.left)/this.object.zoom,_e=(j.top-j.bottom)/this.object.zoom;this.mouseChange.x*=$,this.mouseChange.y*=_e}else this.mouseChange.multiplyScalar(this._eye.length()*this.panSpeed);this.pan.copy(this._eye).cross(this.object.up).setLength(this.mouseChange.x),this.pan.add(this.objectUp.copy(this.object.up).setLength(this.mouseChange.y)),this.object.position.add(this.pan),this.target.add(this.pan),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(this.mouseChange.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}),__publicField(this,"checkDistances",()=>{(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}),__publicField(this,"handleResize",()=>{if(!this.domElement)return;const j=this.domElement.getBoundingClientRect(),$=this.domElement.ownerDocument.documentElement;this.screen.left=j.left+window.pageXOffset-$.clientLeft,this.screen.top=j.top+window.pageYOffset-$.clientTop,this.screen.width=j.width,this.screen.height=j.height}),__publicField(this,"update",()=>{this._eye.subVectors(this.object.position,this.target),this.noRotate||this.rotateCamera(),this.noZoom||this.zoomCamera(),this.noPan||this.panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this.checkDistances(),this.object.lookAt(this.target),this.lastPosition.distanceToSquared(this.object.position)>this.EPS&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||this.lastZoom!==this.object.zoom)&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")}),__publicField(this,"reset",()=>{this._state=this.STATE.NONE,this._keyState=this.STATE.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.up.copy(this.up0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom}),__publicField(this,"keydown",j=>{this.enabled!==!1&&(window.removeEventListener("keydown",this.keydown),this._keyState===this.STATE.NONE&&(j.code===this.keys[this.STATE.ROTATE]&&!this.noRotate?this._keyState=this.STATE.ROTATE:j.code===this.keys[this.STATE.ZOOM]&&!this.noZoom?this._keyState=this.STATE.ZOOM:j.code===this.keys[this.STATE.PAN]&&!this.noPan&&(this._keyState=this.STATE.PAN)))}),__publicField(this,"onPointerDown",j=>{if(this.enabled!==!1)switch(j.pointerType){case"mouse":case"pen":this.onMouseDown(j);break}}),__publicField(this,"onPointerMove",j=>{if(this.enabled!==!1)switch(j.pointerType){case"mouse":case"pen":this.onMouseMove(j);break}}),__publicField(this,"onPointerUp",j=>{if(this.enabled!==!1)switch(j.pointerType){case"mouse":case"pen":this.onMouseUp();break}}),__publicField(this,"keyup",()=>{this.enabled!==!1&&(this._keyState=this.STATE.NONE,window.addEventListener("keydown",this.keydown))}),__publicField(this,"onMouseDown",j=>{if(!this.domElement)return;if(this._state===this.STATE.NONE)switch(j.button){case this.mouseButtons.LEFT:this._state=this.STATE.ROTATE;break;case this.mouseButtons.MIDDLE:this._state=this.STATE.ZOOM;break;case this.mouseButtons.RIGHT:this._state=this.STATE.PAN;break;default:this._state=this.STATE.NONE}const $=this._keyState!==this.STATE.NONE?this._keyState:this._state;$===this.STATE.ROTATE&&!this.noRotate?(this._moveCurr.copy(this.getMouseOnCircle(j.pageX,j.pageY)),this._movePrev.copy(this._moveCurr)):$===this.STATE.ZOOM&&!this.noZoom?(this._zoomStart.copy(this.getMouseOnScreen(j.pageX,j.pageY)),this._zoomEnd.copy(this._zoomStart)):$===this.STATE.PAN&&!this.noPan&&(this._panStart.copy(this.getMouseOnScreen(j.pageX,j.pageY)),this._panEnd.copy(this._panStart)),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.startEvent)}),__publicField(this,"onMouseMove",j=>{if(this.enabled===!1)return;const $=this._keyState!==this.STATE.NONE?this._keyState:this._state;$===this.STATE.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(j.pageX,j.pageY))):$===this.STATE.ZOOM&&!this.noZoom?this._zoomEnd.copy(this.getMouseOnScreen(j.pageX,j.pageY)):$===this.STATE.PAN&&!this.noPan&&this._panEnd.copy(this.getMouseOnScreen(j.pageX,j.pageY))}),__publicField(this,"onMouseUp",()=>{this.domElement&&this.enabled!==!1&&(this._state=this.STATE.NONE,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.endEvent))}),__publicField(this,"mousewheel",j=>{if(this.enabled!==!1&&this.noZoom!==!0){switch(j.preventDefault(),j.deltaMode){case 2:this._zoomStart.y-=j.deltaY*.025;break;case 1:this._zoomStart.y-=j.deltaY*.01;break;default:this._zoomStart.y-=j.deltaY*25e-5;break}this.mousePosition.x=j.offsetX/this.screen.width*2-1,this.mousePosition.y=-(j.offsetY/this.screen.height)*2+1,this.dispatchEvent(this.startEvent),this.dispatchEvent(this.endEvent)}}),__publicField(this,"touchstart",j=>{if(this.enabled!==!1){switch(j.preventDefault(),j.touches.length){case 1:this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(j.touches[0].pageX,j.touches[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this._state=this.STATE.TOUCH_ZOOM_PAN;const $=j.touches[0].pageX-j.touches[1].pageX,_e=j.touches[0].pageY-j.touches[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt($*$+_e*_e);const tt=(j.touches[0].pageX+j.touches[1].pageX)/2,nt=(j.touches[0].pageY+j.touches[1].pageY)/2;this._panStart.copy(this.getMouseOnScreen(tt,nt)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(this.startEvent)}}),__publicField(this,"touchmove",j=>{if(this.enabled!==!1)switch(j.preventDefault(),j.touches.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(j.touches[0].pageX,j.touches[0].pageY));break;default:const $=j.touches[0].pageX-j.touches[1].pageX,_e=j.touches[0].pageY-j.touches[1].pageY;this._touchZoomDistanceEnd=Math.sqrt($*$+_e*_e);const tt=(j.touches[0].pageX+j.touches[1].pageX)/2,nt=(j.touches[0].pageY+j.touches[1].pageY)/2;this._panEnd.copy(this.getMouseOnScreen(tt,nt));break}}),__publicField(this,"touchend",j=>{if(this.enabled!==!1){switch(j.touches.length){case 0:this._state=this.STATE.NONE;break;case 1:this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(j.touches[0].pageX,j.touches[0].pageY)),this._movePrev.copy(this._moveCurr);break}this.dispatchEvent(this.endEvent)}}),__publicField(this,"contextmenu",j=>{this.enabled!==!1&&j.preventDefault()}),__publicField(this,"connect",j=>{j===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=j,this.domElement.addEventListener("contextmenu",this.contextmenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.mousewheel),this.domElement.addEventListener("touchstart",this.touchstart),this.domElement.addEventListener("touchend",this.touchend),this.domElement.addEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.handleResize()}),__publicField(this,"dispose",()=>{this.domElement&&(this.domElement.removeEventListener("contextmenu",this.contextmenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.mousewheel),this.domElement.removeEventListener("touchstart",this.touchstart),this.domElement.removeEventListener("touchend",this.touchend),this.domElement.removeEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup))}),this.object=s,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,o!==void 0&&this.connect(o),this.update()}}const _ray$2=new Ray,_plane=new Plane,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(a,s)=>(a%s+s)%s;let OrbitControls$1=class extends EventDispatcher{constructor(s,o){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"zoomToCursor",!1),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=s,this.domElement=o,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>st.phi,this.getAzimuthalAngle=()=>st.theta,this.setPolarAngle=Un=>{let Jn=moduloWrapAround(Un,2*Math.PI),pr=st.phi;pr<0&&(pr+=2*Math.PI),Jn<0&&(Jn+=2*Math.PI);let Gn=Math.abs(Jn-pr);2*Math.PI-Gn<Gn&&(Jn<pr?Jn+=2*Math.PI:pr+=2*Math.PI),at.phi=Jn-pr,j.update()},this.setAzimuthalAngle=Un=>{let Jn=moduloWrapAround(Un,2*Math.PI),pr=st.theta;pr<0&&(pr+=2*Math.PI),Jn<0&&(Jn+=2*Math.PI);let Gn=Math.abs(Jn-pr);2*Math.PI-Gn<Gn&&(Jn<pr?Jn+=2*Math.PI:pr+=2*Math.PI),at.theta=Jn-pr,j.update()},this.getDistance=()=>j.object.position.distanceTo(j.target),this.listenToKeyEvents=Un=>{Un.addEventListener("keydown",Hn),this._domElementKeyEvents=Un},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Hn),this._domElementKeyEvents=null},this.saveState=()=>{j.target0.copy(j.target),j.position0.copy(j.object.position),j.zoom0=j.object.zoom},this.reset=()=>{j.target.copy(j.target0),j.object.position.copy(j.position0),j.object.zoom=j.zoom0,j.object.updateProjectionMatrix(),j.dispatchEvent($),j.update(),rt=nt.NONE},this.update=(()=>{const Un=new Vector3,Jn=new Vector3(0,1,0),pr=new Quaternion().setFromUnitVectors(s.up,Jn),Gn=pr.clone().invert(),Zn=new Vector3,qn=new Quaternion,vr=2*Math.PI;return function(){const $r=j.object.position;pr.setFromUnitVectors(s.up,Jn),Gn.copy(pr).invert(),Un.copy($r).sub(j.target),Un.applyQuaternion(pr),st.setFromVector3(Un),j.autoRotate&&rt===nt.NONE&&Jt(Ht()),j.enableDamping?(st.theta+=at.theta*j.dampingFactor,st.phi+=at.phi*j.dampingFactor):(st.theta+=at.theta,st.phi+=at.phi);let es=j.minAzimuthAngle,Hr=j.maxAzimuthAngle;isFinite(es)&&isFinite(Hr)&&(es<-Math.PI?es+=vr:es>Math.PI&&(es-=vr),Hr<-Math.PI?Hr+=vr:Hr>Math.PI&&(Hr-=vr),es<=Hr?st.theta=Math.max(es,Math.min(Hr,st.theta)):st.theta=st.theta>(es+Hr)/2?Math.max(es,st.theta):Math.min(Hr,st.theta)),st.phi=Math.max(j.minPolarAngle,Math.min(j.maxPolarAngle,st.phi)),st.makeSafe(),j.enableDamping===!0?j.target.addScaledVector(ct,j.dampingFactor):j.target.add(ct),j.zoomToCursor&&Bt||j.object.isOrthographicCamera?st.radius=Zt(st.radius):st.radius=Zt(st.radius*ot),Un.setFromSpherical(st),Un.applyQuaternion(Gn),$r.copy(j.target).add(Un),j.object.lookAt(j.target),j.enableDamping===!0?(at.theta*=1-j.dampingFactor,at.phi*=1-j.dampingFactor,ct.multiplyScalar(1-j.dampingFactor)):(at.set(0,0,0),ct.set(0,0,0));let Ur=!1;if(j.zoomToCursor&&Bt){let Ir=null;if(j.object instanceof PerspectiveCamera&&j.object.isPerspectiveCamera){const Fr=Un.length();Ir=Zt(Fr*ot);const Pr=Fr-Ir;j.object.position.addScaledVector(Tt,Pr),j.object.updateMatrixWorld()}else if(j.object.isOrthographicCamera){const Fr=new Vector3(Mt.x,Mt.y,0);Fr.unproject(j.object),j.object.zoom=Math.max(j.minZoom,Math.min(j.maxZoom,j.object.zoom/ot)),j.object.updateProjectionMatrix(),Ur=!0;const Pr=new Vector3(Mt.x,Mt.y,0);Pr.unproject(j.object),j.object.position.sub(Pr).add(Fr),j.object.updateMatrixWorld(),Ir=Un.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),j.zoomToCursor=!1;Ir!==null&&(j.screenSpacePanning?j.target.set(0,0,-1).transformDirection(j.object.matrix).multiplyScalar(Ir).add(j.object.position):(_ray$2.origin.copy(j.object.position),_ray$2.direction.set(0,0,-1).transformDirection(j.object.matrix),Math.abs(j.object.up.dot(_ray$2.direction))<TILT_LIMIT?s.lookAt(j.target):(_plane.setFromNormalAndCoplanarPoint(j.object.up,j.target),_ray$2.intersectPlane(_plane,j.target))))}else j.object instanceof OrthographicCamera&&j.object.isOrthographicCamera&&(j.object.zoom=Math.max(j.minZoom,Math.min(j.maxZoom,j.object.zoom/ot)),j.object.updateProjectionMatrix(),Ur=!0);return ot=1,Bt=!1,Ur||Zn.distanceToSquared(j.object.position)>it||8*(1-qn.dot(j.object.quaternion))>it?(j.dispatchEvent($),Zn.copy(j.object.position),qn.copy(j.object.quaternion),Ur=!1,!0):!1}})(),this.connect=Un=>{Un===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),j.domElement=Un,j.domElement.style.touchAction="none",j.domElement.addEventListener("contextmenu",Mn),j.domElement.addEventListener("pointerdown",mr),j.domElement.addEventListener("pointercancel",$t),j.domElement.addEventListener("wheel",In)},this.dispose=()=>{var Un,Jn,pr,Gn,Zn,qn;(Un=j.domElement)==null||Un.removeEventListener("contextmenu",Mn),(Jn=j.domElement)==null||Jn.removeEventListener("pointerdown",mr),(pr=j.domElement)==null||pr.removeEventListener("pointercancel",$t),(Gn=j.domElement)==null||Gn.removeEventListener("wheel",In),(Zn=j.domElement)==null||Zn.removeEventListener("pointermove",$n),(qn=j.domElement)==null||qn.removeEventListener("pointerup",tn),j._domElementKeyEvents!==null&&j._domElementKeyEvents.removeEventListener("keydown",Hn)};const j=this,$={type:"change"},_e={type:"start"},tt={type:"end"},nt={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let rt=nt.NONE;const it=1e-6,st=new Spherical,at=new Spherical;let ot=1;const ct=new Vector3,ft=new Vector2,ht=new Vector2,mt=new Vector2,lt=new Vector2,ut=new Vector2,dt=new Vector2,gt=new Vector2,Et=new Vector2,St=new Vector2,Tt=new Vector3,Mt=new Vector2;let Bt=!1;const Rt=[],Ut={};function Ht(){return 2*Math.PI/60/60*j.autoRotateSpeed}function Wt(){return Math.pow(.95,j.zoomSpeed)}function Jt(Un){j.reverseOrbit||j.reverseHorizontalOrbit?at.theta+=Un:at.theta-=Un}function sn(Un){j.reverseOrbit||j.reverseVerticalOrbit?at.phi+=Un:at.phi-=Un}const jt=(()=>{const Un=new Vector3;return function(pr,Gn){Un.setFromMatrixColumn(Gn,0),Un.multiplyScalar(-pr),ct.add(Un)}})(),Vt=(()=>{const Un=new Vector3;return function(pr,Gn){j.screenSpacePanning===!0?Un.setFromMatrixColumn(Gn,1):(Un.setFromMatrixColumn(Gn,0),Un.crossVectors(j.object.up,Un)),Un.multiplyScalar(pr),ct.add(Un)}})(),Lt=(()=>{const Un=new Vector3;return function(pr,Gn){const Zn=j.domElement;if(Zn&&j.object instanceof PerspectiveCamera&&j.object.isPerspectiveCamera){const qn=j.object.position;Un.copy(qn).sub(j.target);let vr=Un.length();vr*=Math.tan(j.object.fov/2*Math.PI/180),jt(2*pr*vr/Zn.clientHeight,j.object.matrix),Vt(2*Gn*vr/Zn.clientHeight,j.object.matrix)}else Zn&&j.object instanceof OrthographicCamera&&j.object.isOrthographicCamera?(jt(pr*(j.object.right-j.object.left)/j.object.zoom/Zn.clientWidth,j.object.matrix),Vt(Gn*(j.object.top-j.object.bottom)/j.object.zoom/Zn.clientHeight,j.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),j.enablePan=!1)}})();function Qt(Un){j.object instanceof PerspectiveCamera&&j.object.isPerspectiveCamera||j.object instanceof OrthographicCamera&&j.object.isOrthographicCamera?ot/=Un:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),j.enableZoom=!1)}function nn(Un){j.object instanceof PerspectiveCamera&&j.object.isPerspectiveCamera||j.object instanceof OrthographicCamera&&j.object.isOrthographicCamera?ot*=Un:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),j.enableZoom=!1)}function mn(Un){if(!j.zoomToCursor||!j.domElement)return;Bt=!0;const Jn=j.domElement.getBoundingClientRect(),pr=Un.clientX-Jn.left,Gn=Un.clientY-Jn.top,Zn=Jn.width,qn=Jn.height;Mt.x=pr/Zn*2-1,Mt.y=-(Gn/qn)*2+1,Tt.set(Mt.x,Mt.y,1).unproject(j.object).sub(j.object.position).normalize()}function Zt(Un){return Math.max(j.minDistance,Math.min(j.maxDistance,Un))}function cn(Un){ft.set(Un.clientX,Un.clientY)}function Ot(Un){mn(Un),gt.set(Un.clientX,Un.clientY)}function rn(Un){lt.set(Un.clientX,Un.clientY)}function fn(Un){ht.set(Un.clientX,Un.clientY),mt.subVectors(ht,ft).multiplyScalar(j.rotateSpeed);const Jn=j.domElement;Jn&&(Jt(2*Math.PI*mt.x/Jn.clientHeight),sn(2*Math.PI*mt.y/Jn.clientHeight)),ft.copy(ht),j.update()}function hn(Un){Et.set(Un.clientX,Un.clientY),St.subVectors(Et,gt),St.y>0?Qt(Wt()):St.y<0&&nn(Wt()),gt.copy(Et),j.update()}function Tn(Un){ut.set(Un.clientX,Un.clientY),dt.subVectors(ut,lt).multiplyScalar(j.panSpeed),Lt(dt.x,dt.y),lt.copy(ut),j.update()}function Nn(Un){mn(Un),Un.deltaY<0?nn(Wt()):Un.deltaY>0&&Qt(Wt()),j.update()}function Pn(Un){let Jn=!1;switch(Un.code){case j.keys.UP:Lt(0,j.keyPanSpeed),Jn=!0;break;case j.keys.BOTTOM:Lt(0,-j.keyPanSpeed),Jn=!0;break;case j.keys.LEFT:Lt(j.keyPanSpeed,0),Jn=!0;break;case j.keys.RIGHT:Lt(-j.keyPanSpeed,0),Jn=!0;break}Jn&&(Un.preventDefault(),j.update())}function Dn(){if(Rt.length==1)ft.set(Rt[0].pageX,Rt[0].pageY);else{const Un=.5*(Rt[0].pageX+Rt[1].pageX),Jn=.5*(Rt[0].pageY+Rt[1].pageY);ft.set(Un,Jn)}}function ln(){if(Rt.length==1)lt.set(Rt[0].pageX,Rt[0].pageY);else{const Un=.5*(Rt[0].pageX+Rt[1].pageX),Jn=.5*(Rt[0].pageY+Rt[1].pageY);lt.set(Un,Jn)}}function Cn(){const Un=Rt[0].pageX-Rt[1].pageX,Jn=Rt[0].pageY-Rt[1].pageY,pr=Math.sqrt(Un*Un+Jn*Jn);gt.set(0,pr)}function bn(){j.enableZoom&&Cn(),j.enablePan&&ln()}function kn(){j.enableZoom&&Cn(),j.enableRotate&&Dn()}function Sn(Un){if(Rt.length==1)ht.set(Un.pageX,Un.pageY);else{const pr=Sr(Un),Gn=.5*(Un.pageX+pr.x),Zn=.5*(Un.pageY+pr.y);ht.set(Gn,Zn)}mt.subVectors(ht,ft).multiplyScalar(j.rotateSpeed);const Jn=j.domElement;Jn&&(Jt(2*Math.PI*mt.x/Jn.clientHeight),sn(2*Math.PI*mt.y/Jn.clientHeight)),ft.copy(ht)}function xn(Un){if(Rt.length==1)ut.set(Un.pageX,Un.pageY);else{const Jn=Sr(Un),pr=.5*(Un.pageX+Jn.x),Gn=.5*(Un.pageY+Jn.y);ut.set(pr,Gn)}dt.subVectors(ut,lt).multiplyScalar(j.panSpeed),Lt(dt.x,dt.y),lt.copy(ut)}function Qn(Un){const Jn=Sr(Un),pr=Un.pageX-Jn.x,Gn=Un.pageY-Jn.y,Zn=Math.sqrt(pr*pr+Gn*Gn);Et.set(0,Zn),St.set(0,Math.pow(Et.y/gt.y,j.zoomSpeed)),Qt(St.y),gt.copy(Et)}function nr(Un){j.enableZoom&&Qn(Un),j.enablePan&&xn(Un)}function or(Un){j.enableZoom&&Qn(Un),j.enableRotate&&Sn(Un)}function mr(Un){var Jn,pr,Gn;j.enabled!==!1&&(Rt.length===0&&((Jn=j.domElement)==null||Jn.setPointerCapture(Un.pointerId),(pr=j.domElement)==null||pr.addEventListener("pointermove",$n),(Gn=j.domElement)==null||Gn.addEventListener("pointerup",tn)),tr(Un),Un.pointerType==="touch"?yn(Un):An(Un))}function $n(Un){j.enabled!==!1&&(Un.pointerType==="touch"?On(Un):En(Un))}function tn(Un){var Jn,pr,Gn;gr(Un),Rt.length===0&&((Jn=j.domElement)==null||Jn.releasePointerCapture(Un.pointerId),(pr=j.domElement)==null||pr.removeEventListener("pointermove",$n),(Gn=j.domElement)==null||Gn.removeEventListener("pointerup",tn)),j.dispatchEvent(tt),rt=nt.NONE}function $t(Un){gr(Un)}function An(Un){let Jn;switch(Un.button){case 0:Jn=j.mouseButtons.LEFT;break;case 1:Jn=j.mouseButtons.MIDDLE;break;case 2:Jn=j.mouseButtons.RIGHT;break;default:Jn=-1}switch(Jn){case MOUSE.DOLLY:if(j.enableZoom===!1)return;Ot(Un),rt=nt.DOLLY;break;case MOUSE.ROTATE:if(Un.ctrlKey||Un.metaKey||Un.shiftKey){if(j.enablePan===!1)return;rn(Un),rt=nt.PAN}else{if(j.enableRotate===!1)return;cn(Un),rt=nt.ROTATE}break;case MOUSE.PAN:if(Un.ctrlKey||Un.metaKey||Un.shiftKey){if(j.enableRotate===!1)return;cn(Un),rt=nt.ROTATE}else{if(j.enablePan===!1)return;rn(Un),rt=nt.PAN}break;default:rt=nt.NONE}rt!==nt.NONE&&j.dispatchEvent(_e)}function En(Un){if(j.enabled!==!1)switch(rt){case nt.ROTATE:if(j.enableRotate===!1)return;fn(Un);break;case nt.DOLLY:if(j.enableZoom===!1)return;hn(Un);break;case nt.PAN:if(j.enablePan===!1)return;Tn(Un);break}}function In(Un){j.enabled===!1||j.enableZoom===!1||rt!==nt.NONE&&rt!==nt.ROTATE||(Un.preventDefault(),j.dispatchEvent(_e),Nn(Un),j.dispatchEvent(tt))}function Hn(Un){j.enabled===!1||j.enablePan===!1||Pn(Un)}function yn(Un){switch(Cr(Un),Rt.length){case 1:switch(j.touches.ONE){case TOUCH.ROTATE:if(j.enableRotate===!1)return;Dn(),rt=nt.TOUCH_ROTATE;break;case TOUCH.PAN:if(j.enablePan===!1)return;ln(),rt=nt.TOUCH_PAN;break;default:rt=nt.NONE}break;case 2:switch(j.touches.TWO){case TOUCH.DOLLY_PAN:if(j.enableZoom===!1&&j.enablePan===!1)return;bn(),rt=nt.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(j.enableZoom===!1&&j.enableRotate===!1)return;kn(),rt=nt.TOUCH_DOLLY_ROTATE;break;default:rt=nt.NONE}break;default:rt=nt.NONE}rt!==nt.NONE&&j.dispatchEvent(_e)}function On(Un){switch(Cr(Un),rt){case nt.TOUCH_ROTATE:if(j.enableRotate===!1)return;Sn(Un),j.update();break;case nt.TOUCH_PAN:if(j.enablePan===!1)return;xn(Un),j.update();break;case nt.TOUCH_DOLLY_PAN:if(j.enableZoom===!1&&j.enablePan===!1)return;nr(Un),j.update();break;case nt.TOUCH_DOLLY_ROTATE:if(j.enableZoom===!1&&j.enableRotate===!1)return;or(Un),j.update();break;default:rt=nt.NONE}}function Mn(Un){j.enabled!==!1&&Un.preventDefault()}function tr(Un){Rt.push(Un)}function gr(Un){delete Ut[Un.pointerId];for(let Jn=0;Jn<Rt.length;Jn++)if(Rt[Jn].pointerId==Un.pointerId){Rt.splice(Jn,1);return}}function Cr(Un){let Jn=Ut[Un.pointerId];Jn===void 0&&(Jn=new Vector2,Ut[Un.pointerId]=Jn),Jn.set(Un.pageX,Un.pageY)}function Sr(Un){const Jn=Un.pointerId===Rt[0].pointerId?Rt[1]:Rt[0];return Ut[Jn.pointerId]}o!==void 0&&this.connect(o),this.update()}};const STATE={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},INPUT={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},_center$1={x:0,y:0},_transformation={camera:new Matrix4,gizmos:new Matrix4},_changeEvent={type:"change"},_startEvent={type:"start"},_endEvent={type:"end"};class ArcballControls extends EventDispatcher{constructor(s,o=null,j=null){super(),__publicField(this,"camera"),__publicField(this,"domElement"),__publicField(this,"scene"),__publicField(this,"mouseActions"),__publicField(this,"_mouseOp"),__publicField(this,"_v2_1"),__publicField(this,"_v3_1"),__publicField(this,"_v3_2"),__publicField(this,"_m4_1"),__publicField(this,"_m4_2"),__publicField(this,"_quat"),__publicField(this,"_translationMatrix"),__publicField(this,"_rotationMatrix"),__publicField(this,"_scaleMatrix"),__publicField(this,"_rotationAxis"),__publicField(this,"_cameraMatrixState"),__publicField(this,"_cameraProjectionState"),__publicField(this,"_fovState"),__publicField(this,"_upState"),__publicField(this,"_zoomState"),__publicField(this,"_nearPos"),__publicField(this,"_farPos"),__publicField(this,"_gizmoMatrixState"),__publicField(this,"_up0"),__publicField(this,"_zoom0"),__publicField(this,"_fov0"),__publicField(this,"_initialNear"),__publicField(this,"_nearPos0"),__publicField(this,"_initialFar"),__publicField(this,"_farPos0"),__publicField(this,"_cameraMatrixState0"),__publicField(this,"_gizmoMatrixState0"),__publicField(this,"_button"),__publicField(this,"_touchStart"),__publicField(this,"_touchCurrent"),__publicField(this,"_input"),__publicField(this,"_switchSensibility"),__publicField(this,"_startFingerDistance"),__publicField(this,"_currentFingerDistance"),__publicField(this,"_startFingerRotation"),__publicField(this,"_currentFingerRotation"),__publicField(this,"_devPxRatio"),__publicField(this,"_downValid"),__publicField(this,"_nclicks"),__publicField(this,"_downEvents"),__publicField(this,"_clickStart"),__publicField(this,"_maxDownTime"),__publicField(this,"_maxInterval"),__publicField(this,"_posThreshold"),__publicField(this,"_movementThreshold"),__publicField(this,"_currentCursorPosition"),__publicField(this,"_startCursorPosition"),__publicField(this,"_grid"),__publicField(this,"_gridPosition"),__publicField(this,"_gizmos"),__publicField(this,"_curvePts"),__publicField(this,"_timeStart"),__publicField(this,"_animationId"),__publicField(this,"focusAnimationTime"),__publicField(this,"_timePrev"),__publicField(this,"_timeCurrent"),__publicField(this,"_anglePrev"),__publicField(this,"_angleCurrent"),__publicField(this,"_cursorPosPrev"),__publicField(this,"_cursorPosCurr"),__publicField(this,"_wPrev"),__publicField(this,"_wCurr"),__publicField(this,"adjustNearFar"),__publicField(this,"scaleFactor"),__publicField(this,"dampingFactor"),__publicField(this,"wMax"),__publicField(this,"enableAnimations"),__publicField(this,"enableGrid"),__publicField(this,"cursorZoom"),__publicField(this,"minFov"),__publicField(this,"maxFov"),__publicField(this,"enabled"),__publicField(this,"enablePan"),__publicField(this,"enableRotate"),__publicField(this,"enableZoom"),__publicField(this,"minDistance"),__publicField(this,"maxDistance"),__publicField(this,"minZoom"),__publicField(this,"maxZoom"),__publicField(this,"target"),__publicField(this,"_currentTarget"),__publicField(this,"_tbRadius"),__publicField(this,"_state"),__publicField(this,"onWindowResize",()=>{const $=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;if(this.camera){const it=this.calculateTbRadius(this.camera);it!==void 0&&(this._tbRadius=it)}const _e=this._tbRadius/$,nt=new EllipseCurve(0,0,_e,_e).getPoints(this._curvePts),rt=new BufferGeometry().setFromPoints(nt);for(const it in this._gizmos.children){const st=this._gizmos.children[it];st.geometry=rt}this.dispatchEvent(_changeEvent)}),__publicField(this,"onContextMenu",$=>{if(this.enabled){for(let _e=0;_e<this.mouseActions.length;_e++)if(this.mouseActions[_e].mouse==2){$.preventDefault();break}}}),__publicField(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=INPUT.NONE}),__publicField(this,"onPointerDown",$=>{if($.button==0&&$.isPrimary?(this._downValid=!0,this._downEvents.push($)):this._downValid=!1,$.pointerType=="touch"&&this._input!=INPUT.CURSOR)switch(this._touchStart.push($),this._touchCurrent.push($),this._input){case INPUT.NONE:this._input=INPUT.ONE_FINGER,this.onSinglePanStart($,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case INPUT.ONE_FINGER:case INPUT.ONE_FINGER_SWITCHED:this._input=INPUT.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case INPUT.TWO_FINGER:this._input=INPUT.MULT_FINGER,this.onTriplePanStart();break}else if($.pointerType!="touch"&&this._input==INPUT.NONE){let _e=null;$.ctrlKey||$.metaKey?_e="CTRL":$.shiftKey&&(_e="SHIFT"),this._mouseOp=this.getOpFromAction($.button,_e),this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=INPUT.CURSOR,this._button=$.button,this.onSinglePanStart($,this._mouseOp))}}),__publicField(this,"onPointerMove",$=>{if($.pointerType=="touch"&&this._input!=INPUT.CURSOR)switch(this._input){case INPUT.ONE_FINGER:this.updateTouchEvent($),this.onSinglePanMove($,STATE.ROTATE);break;case INPUT.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],$)*this._devPxRatio>=this._switchSensibility){this._input=INPUT.ONE_FINGER,this.updateTouchEvent($),this.onSinglePanStart($,"ROTATE");break}break;case INPUT.TWO_FINGER:this.updateTouchEvent($),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case INPUT.MULT_FINGER:this.updateTouchEvent($),this.onTriplePanMove();break}else if($.pointerType!="touch"&&this._input==INPUT.CURSOR){let _e=null;$.ctrlKey||$.metaKey?_e="CTRL":$.shiftKey&&(_e="SHIFT");const tt=this.getOpStateFromAction(this._button,_e);tt&&this.onSinglePanMove($,tt)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],$)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),__publicField(this,"onPointerUp",$=>{if($.pointerType=="touch"&&this._input!=INPUT.CURSOR){const _e=this._touchCurrent.length;for(let tt=0;tt<_e;tt++)if(this._touchCurrent[tt].pointerId==$.pointerId){this._touchCurrent.splice(tt,1),this._touchStart.splice(tt,1);break}switch(this._input){case INPUT.ONE_FINGER:case INPUT.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=INPUT.NONE,this.onSinglePanEnd();break;case INPUT.TWO_FINGER:this.onDoublePanEnd(),this.onPinchEnd(),this.onRotateEnd(),this._input=INPUT.ONE_FINGER_SWITCHED;break;case INPUT.MULT_FINGER:this._touchCurrent.length==0&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=INPUT.NONE,this.onTriplePanEnd());break}}else $.pointerType!="touch"&&this._input==INPUT.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=INPUT.NONE,this.onSinglePanEnd(),this._button=-1);if($.isPrimary)if(this._downValid)if($.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(this._nclicks==0)this._nclicks=1,this._clickStart=performance.now();else{const tt=$.timeStamp-this._clickStart,nt=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;tt<=this._maxInterval&&nt<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap($)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}),__publicField(this,"onWheel",$=>{var _e,tt;if(this.enabled&&this.enableZoom&&this.domElement){let nt=null;$.ctrlKey||$.metaKey?nt="CTRL":$.shiftKey&&(nt="SHIFT");const rt=this.getOpFromAction("WHEEL",nt);if(rt){$.preventDefault(),this.dispatchEvent(_startEvent);const it=125;let st=$.deltaY/it,at=1;switch(st>0?at=1/this.scaleFactor:st<0&&(at=this.scaleFactor),rt){case"ZOOM":if(this.updateTbState(STATE.SCALE,!0),st>0?at=1/Math.pow(this.scaleFactor,st):st<0&&(at=Math.pow(this.scaleFactor,-st)),this.cursorZoom&&this.enablePan){let ot;this.camera instanceof OrthographicCamera&&(ot=(_e=this.unprojectOnTbPlane(this.camera,$.clientX,$.clientY,this.domElement))==null?void 0:_e.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position)),this.camera instanceof PerspectiveCamera&&(ot=(tt=this.unprojectOnTbPlane(this.camera,$.clientX,$.clientY,this.domElement))==null?void 0:tt.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),ot!==void 0&&this.applyTransformMatrix(this.applyScale(at,ot))}else this.applyTransformMatrix(this.applyScale(at,this._gizmos.position));this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_changeEvent),this.dispatchEvent(_endEvent);break;case"FOV":if(this.camera instanceof PerspectiveCamera){this.updateTbState(STATE.FOV,!0),$.deltaX!=0&&(st=$.deltaX/it,at=1,st>0?at=1/Math.pow(this.scaleFactor,st):st<0&&(at=Math.pow(this.scaleFactor,-st))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const ot=this._v3_1.distanceTo(this._gizmos.position);let ct=ot/at;ct=MathUtils.clamp(ct,this.minDistance,this.maxDistance);const ft=ot*Math.tan(MathUtils.DEG2RAD*this.camera.fov*.5);let ht=MathUtils.RAD2DEG*(Math.atan(ft/ct)*2);ht>this.maxFov?ht=this.maxFov:ht<this.minFov&&(ht=this.minFov);const mt=ft/Math.tan(MathUtils.DEG2RAD*(ht/2));at=ot/mt,this.setFov(ht),this.applyTransformMatrix(this.applyScale(at,this._gizmos.position,!1))}this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_changeEvent),this.dispatchEvent(_endEvent);break}}}}),__publicField(this,"onSinglePanStart",($,_e)=>{if(this.enabled&&this.domElement)switch(this.dispatchEvent(_startEvent),this.setCenter($.clientX,$.clientY),_e){case"PAN":if(!this.enablePan)return;if(this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(_changeEvent)),this.camera){this.updateTbState(STATE.PAN,!0);const tt=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement);tt!==void 0&&this._startCursorPosition.copy(tt),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(_changeEvent))}break;case"ROTATE":if(!this.enableRotate)return;if(this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.camera){this.updateTbState(STATE.ROTATE,!0);const tt=this.unprojectOnTbSurface(this.camera,_center$1.x,_center$1.y,this.domElement,this._tbRadius);tt!==void 0&&this._startCursorPosition.copy(tt),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr)}this.dispatchEvent(_changeEvent);break;case"FOV":if(!this.enableZoom)return;this.camera instanceof PerspectiveCamera&&(this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(_changeEvent)),this.updateTbState(STATE.FOV,!0),this._startCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition));break;case"ZOOM":if(!this.enableZoom)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(_changeEvent)),this.updateTbState(STATE.SCALE,!0),this._startCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition);break}}),__publicField(this,"onSinglePanMove",($,_e)=>{if(this.enabled&&this.domElement){const tt=_e!=this._state;switch(this.setCenter($.clientX,$.clientY),_e){case STATE.PAN:if(this.enablePan&&this.camera)if(tt){this.dispatchEvent(_endEvent),this.dispatchEvent(_startEvent),this.updateTbState(_e,!0);const nt=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement);nt!==void 0&&this._startCursorPosition.copy(nt),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)}else{const nt=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement);nt!==void 0&&this._currentCursorPosition.copy(nt),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))}break;case STATE.ROTATE:if(this.enableRotate&&this.camera)if(tt){this.dispatchEvent(_endEvent),this.dispatchEvent(_startEvent),this.updateTbState(_e,!0);const nt=this.unprojectOnTbSurface(this.camera,_center$1.x,_center$1.y,this.domElement,this._tbRadius);nt!==void 0&&this._startCursorPosition.copy(nt),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0)}else{const nt=this.unprojectOnTbSurface(this.camera,_center$1.x,_center$1.y,this.domElement,this._tbRadius);nt!==void 0&&this._currentCursorPosition.copy(nt);const rt=this._startCursorPosition.distanceTo(this._currentCursorPosition),it=this._startCursorPosition.angleTo(this._currentCursorPosition),st=Math.max(rt/this._tbRadius,it);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),st)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=st,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case STATE.SCALE:if(this.enableZoom)if(tt)this.dispatchEvent(_endEvent),this.dispatchEvent(_startEvent),this.updateTbState(_e,!0),this._startCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5);const rt=this._currentCursorPosition.y-this._startCursorPosition.y;let it=1;rt<0?it=1/Math.pow(this.scaleFactor,-rt*8):rt>0&&(it=Math.pow(this.scaleFactor,rt*8)),this.applyTransformMatrix(this.applyScale(it,this._gizmos.position))}break;case STATE.FOV:if(this.enableZoom&&this.camera instanceof PerspectiveCamera)if(tt)this.dispatchEvent(_endEvent),this.dispatchEvent(_startEvent),this.updateTbState(_e,!0),this._startCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5);const rt=this._currentCursorPosition.y-this._startCursorPosition.y;let it=1;rt<0?it=1/Math.pow(this.scaleFactor,-rt*8):rt>0&&(it=Math.pow(this.scaleFactor,rt*8)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const st=this._v3_1.distanceTo(this._gizmos.position);let at=st/it;at=MathUtils.clamp(at,this.minDistance,this.maxDistance);const ot=st*Math.tan(MathUtils.DEG2RAD*this._fovState*.5);let ct=MathUtils.RAD2DEG*(Math.atan(ot/at)*2);ct=MathUtils.clamp(ct,this.minFov,this.maxFov);const ft=ot/Math.tan(MathUtils.DEG2RAD*(ct/2));it=st/ft,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(ct),this.applyTransformMatrix(this.applyScale(it,this._v3_2,!1));const ht=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(ft/st);this._m4_1.makeTranslation(ht.x,ht.y,ht.z)}break}this.dispatchEvent(_changeEvent)}}),__publicField(this,"onSinglePanEnd",()=>{if(this._state==STATE.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){const _e=Math.abs((this._wPrev+this._wCurr)/2),tt=this;this._animationId=window.requestAnimationFrame(function(nt){tt.updateTbState(STATE.ANIMATION_ROTATE,!0);const rt=tt.calculateRotationAxis(tt._cursorPosPrev,tt._cursorPosCurr);tt.onRotationAnim(nt,rt,Math.min(_e,tt.wMax))})}else this.updateTbState(STATE.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(_changeEvent);else this.updateTbState(STATE.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(_changeEvent)}else(this._state==STATE.PAN||this._state==STATE.IDLE)&&(this.updateTbState(STATE.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(_changeEvent));this.dispatchEvent(_endEvent)}),__publicField(this,"onDoubleTap",$=>{if(this.enabled&&this.enablePan&&this.scene&&this.camera&&this.domElement){this.dispatchEvent(_startEvent),this.setCenter($.clientX,$.clientY);const _e=this.unprojectOnObj(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement),this.camera);if(_e&&this.enableAnimations){const tt=this;this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(nt){tt.updateTbState(STATE.ANIMATION_FOCUS,!0),tt.onFocusAnim(nt,_e,tt._cameraMatrixState,tt._gizmoMatrixState)})}else _e&&!this.enableAnimations&&(this.updateTbState(STATE.FOCUS,!0),this.focus(_e,this.scaleFactor),this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_changeEvent))}this.dispatchEvent(_endEvent)}),__publicField(this,"onDoublePanStart",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.dispatchEvent(_startEvent),this.updateTbState(STATE.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const $=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement,!0);$!==void 0&&this._startCursorPosition.copy($),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1)}}),__publicField(this,"onDoublePanMove",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=STATE.PAN&&(this.updateTbState(STATE.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition));const $=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement,!0);$!==void 0&&this._currentCursorPosition.copy($),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(_changeEvent)}}),__publicField(this,"onDoublePanEnd",()=>{this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_endEvent)}),__publicField(this,"onRotateStart",()=>{var $;this.enabled&&this.enableRotate&&(this.dispatchEvent(_startEvent),this.updateTbState(STATE.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,($=this.camera)==null||$.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}),__publicField(this,"onRotateMove",()=>{var $;if(this.enabled&&this.enableRotate&&this.camera&&this.domElement){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let _e;this._state!=STATE.ZROTATE&&(this.updateTbState(STATE.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?this.camera&&(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),_e=($=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement))==null?void 0:$.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):_e=new Vector3().setFromMatrixPosition(this._gizmoMatrixState);const tt=MathUtils.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation);_e!==void 0&&this.applyTransformMatrix(this.zRotate(_e,tt)),this.dispatchEvent(_changeEvent)}}),__publicField(this,"onRotateEnd",()=>{this.updateTbState(STATE.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(_endEvent)}),__publicField(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(_startEvent),this.updateTbState(STATE.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),__publicField(this,"onPinchMove",()=>{var $,_e;if(this.enabled&&this.enableZoom&&this.domElement){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);const tt=12;this._state!=STATE.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(STATE.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),tt*this._devPxRatio);const nt=this._currentFingerDistance/this._startFingerDistance;let rt;this.enablePan?this.camera instanceof OrthographicCamera?rt=($=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement))==null?void 0:$.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera instanceof PerspectiveCamera&&(rt=(_e=this.unprojectOnTbPlane(this.camera,_center$1.x,_center$1.y,this.domElement))==null?void 0:_e.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):rt=this._gizmos.position,rt!==void 0&&this.applyTransformMatrix(this.applyScale(nt,rt)),this.dispatchEvent(_changeEvent)}}),__publicField(this,"onPinchEnd",()=>{this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_endEvent)}),__publicField(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom&&this.domElement){this.dispatchEvent(_startEvent),this.updateTbState(STATE.SCALE,!0);let $=0,_e=0;const tt=this._touchCurrent.length;for(let nt=0;nt<tt;nt++)$+=this._touchCurrent[nt].clientX,_e+=this._touchCurrent[nt].clientY;this.setCenter($/tt,_e/tt),this._startCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition)}}),__publicField(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom&&this.camera&&this.domElement){let $=0,_e=0;const tt=this._touchCurrent.length;for(let mt=0;mt<tt;mt++)$+=this._touchCurrent[mt].clientX,_e+=this._touchCurrent[mt].clientY;this.setCenter($/tt,_e/tt);const nt=8;this._currentCursorPosition.setY(this.getCursorNDC(_center$1.x,_center$1.y,this.domElement).y*.5);const rt=this._currentCursorPosition.y-this._startCursorPosition.y;let it=1;rt<0?it=1/Math.pow(this.scaleFactor,-rt*nt):rt>0&&(it=Math.pow(this.scaleFactor,rt*nt)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);const st=this._v3_1.distanceTo(this._gizmos.position);let at=st/it;at=MathUtils.clamp(at,this.minDistance,this.maxDistance);const ot=st*Math.tan(MathUtils.DEG2RAD*this._fovState*.5);let ct=MathUtils.RAD2DEG*(Math.atan(ot/at)*2);ct=MathUtils.clamp(ct,this.minFov,this.maxFov);const ft=ot/Math.tan(MathUtils.DEG2RAD*(ct/2));it=st/ft,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(ct),this.applyTransformMatrix(this.applyScale(it,this._v3_2,!1));const ht=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(ft/st);this._m4_1.makeTranslation(ht.x,ht.y,ht.z),this.dispatchEvent(_changeEvent)}}),__publicField(this,"onTriplePanEnd",()=>{this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_endEvent)}),__publicField(this,"setCenter",($,_e)=>{_center$1.x=$,_center$1.y=_e}),__publicField(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),__publicField(this,"setMouseAction",($,_e,tt=null)=>{const nt=["PAN","ROTATE","ZOOM","FOV"],rt=[0,1,2,"WHEEL"],it=["CTRL","SHIFT",null];let st;if(!nt.includes($)||!rt.includes(_e)||!it.includes(tt)||_e=="WHEEL"&&$!="ZOOM"&&$!="FOV")return!1;switch($){case"PAN":st=STATE.PAN;break;case"ROTATE":st=STATE.ROTATE;break;case"ZOOM":st=STATE.SCALE;break;case"FOV":st=STATE.FOV;break}const at={operation:$,mouse:_e,key:tt,state:st};for(let ot=0;ot<this.mouseActions.length;ot++)if(this.mouseActions[ot].mouse==at.mouse&&this.mouseActions[ot].key==at.key)return this.mouseActions.splice(ot,1,at),!0;return this.mouseActions.push(at),!0}),__publicField(this,"getOpFromAction",($,_e)=>{let tt;for(let nt=0;nt<this.mouseActions.length;nt++)if(tt=this.mouseActions[nt],tt.mouse==$&&tt.key==_e)return tt.operation;if(_e){for(let nt=0;nt<this.mouseActions.length;nt++)if(tt=this.mouseActions[nt],tt.mouse==$&&tt.key==null)return tt.operation}return null}),__publicField(this,"getOpStateFromAction",($,_e)=>{let tt;for(let nt=0;nt<this.mouseActions.length;nt++)if(tt=this.mouseActions[nt],tt.mouse==$&&tt.key==_e)return tt.state;if(_e){for(let nt=0;nt<this.mouseActions.length;nt++)if(tt=this.mouseActions[nt],tt.mouse==$&&tt.key==null)return tt.state}return null}),__publicField(this,"getAngle",($,_e)=>Math.atan2(_e.clientY-$.clientY,_e.clientX-$.clientX)*180/Math.PI),__publicField(this,"updateTouchEvent",$=>{for(let _e=0;_e<this._touchCurrent.length;_e++)if(this._touchCurrent[_e].pointerId==$.pointerId){this._touchCurrent.splice(_e,1,$);break}}),__publicField(this,"calculateAngularSpeed",($,_e,tt,nt)=>{const rt=_e-$,it=(nt-tt)/1e3;return it==0?0:rt/it}),__publicField(this,"calculatePointersDistance",($,_e)=>Math.sqrt(Math.pow(_e.clientX-$.clientX,2)+Math.pow(_e.clientY-$.clientY,2))),__publicField(this,"calculateRotationAxis",($,_e)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors($,_e).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),__publicField(this,"calculateTbRadius",$=>{const tt=$.position.distanceTo(this._gizmos.position);if($ instanceof PerspectiveCamera){const nt=MathUtils.DEG2RAD*$.fov*.5,rt=Math.atan($.aspect*Math.tan(nt));return Math.tan(Math.min(nt,rt))*tt*.67}else if($ instanceof OrthographicCamera)return Math.min($.top,$.right)*.67}),__publicField(this,"focus",($,_e,tt=1)=>{if(this.camera){const nt=$.clone();nt.sub(this._gizmos.position).multiplyScalar(tt),this._translationMatrix.makeTranslation(nt.x,nt.y,nt.z);const rt=this._gizmoMatrixState.clone();this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale);const it=this._cameraMatrixState.clone();this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.applyScale(_e,this._gizmos.position)),this._gizmoMatrixState.copy(rt),this._cameraMatrixState.copy(it)}}),__publicField(this,"drawGrid",()=>{if(this.scene){let tt,nt,rt,it;if(this.camera instanceof OrthographicCamera){const st=this.camera.right-this.camera.left,at=this.camera.bottom-this.camera.top;rt=Math.max(st,at),it=rt/20,tt=rt/this.camera.zoom*3,nt=tt/it*this.camera.zoom}else if(this.camera instanceof PerspectiveCamera){const st=this.camera.position.distanceTo(this._gizmos.position),at=MathUtils.DEG2RAD*this.camera.fov*.5,ot=Math.atan(this.camera.aspect*Math.tan(at));rt=Math.tan(Math.max(at,ot))*st*2,it=rt/20,tt=rt*3,nt=tt/it}this._grid==null&&this.camera&&(this._grid=new GridHelper(tt,nt,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(Math.PI*.5),this.scene.add(this._grid))}}),__publicField(this,"connect",$=>{$===document&&console.error('THREE.ArcballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=$,this.domElement.style.touchAction="none",this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onWheel)}),__publicField(this,"dispose",()=>{var $,_e,tt,nt,rt;this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),($=this.domElement)==null||$.removeEventListener("pointerdown",this.onPointerDown),(_e=this.domElement)==null||_e.removeEventListener("pointercancel",this.onPointerCancel),(tt=this.domElement)==null||tt.removeEventListener("wheel",this.onWheel),(nt=this.domElement)==null||nt.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),(rt=this.scene)==null||rt.remove(this._gizmos),this.disposeGrid()}),__publicField(this,"disposeGrid",()=>{this._grid&&this.scene&&(this.scene.remove(this._grid),this._grid=null)}),__publicField(this,"easeOutCubic",$=>1-Math.pow(1-$,3)),__publicField(this,"activateGizmos",$=>{for(const _e of this._gizmos.children)_e.material.setValues({opacity:$?1:.6})}),__publicField(this,"getCursorNDC",($,_e,tt)=>{const nt=tt.getBoundingClientRect();return this._v2_1.setX(($-nt.left)/nt.width*2-1),this._v2_1.setY((nt.bottom-_e)/nt.height*2-1),this._v2_1.clone()}),__publicField(this,"getCursorPosition",($,_e,tt)=>(this._v2_1.copy(this.getCursorNDC($,_e,tt)),this.camera instanceof OrthographicCamera&&(this._v2_1.x*=(this.camera.right-this.camera.left)*.5,this._v2_1.y*=(this.camera.top-this.camera.bottom)*.5),this._v2_1.clone())),__publicField(this,"setCamera",$=>{if($){$.lookAt(this.target),$.updateMatrix(),$ instanceof PerspectiveCamera&&(this._fov0=$.fov,this._fovState=$.fov),this._cameraMatrixState0.copy($.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy($.projectionMatrix),this._zoom0=$.zoom,this._zoomState=this._zoom0,this._initialNear=$.near,this._nearPos0=$.position.distanceTo(this.target)-$.near,this._nearPos=this._initialNear,this._initialFar=$.far,this._farPos0=$.position.distanceTo(this.target)-$.far,this._farPos=this._initialFar,this._up0.copy($.up),this._upState.copy($.up),this.camera=$,this.camera.updateProjectionMatrix();const _e=this.calculateTbRadius($);_e!==void 0&&(this._tbRadius=_e),this.makeGizmos(this.target,this._tbRadius)}}),__publicField(this,"makeGizmos",($,_e)=>{const nt=new EllipseCurve(0,0,_e,_e).getPoints(this._curvePts),rt=new BufferGeometry().setFromPoints(nt),it=new LineBasicMaterial({color:16744576,fog:!1,transparent:!0,opacity:.6}),st=new LineBasicMaterial({color:8454016,fog:!1,transparent:!0,opacity:.6}),at=new LineBasicMaterial({color:8421631,fog:!1,transparent:!0,opacity:.6}),ot=new Line(rt,it),ct=new Line(rt,st),ft=new Line(rt,at),ht=Math.PI*.5;if(ot.rotation.x=ht,ct.rotation.y=ht,this._gizmoMatrixState0.identity().setPosition($),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this.camera&&this.camera.zoom!=1){const mt=1/this.camera.zoom;this._scaleMatrix.makeScale(mt,mt,mt),this._translationMatrix.makeTranslation(-$.x,-$.y,-$.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation($.x,$.y,$.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.clear(),this._gizmos.add(ot),this._gizmos.add(ct),this._gizmos.add(ft)}),__publicField(this,"onFocusAnim",($,_e,tt,nt)=>{if(this._timeStart==-1&&(this._timeStart=$),this._state==STATE.ANIMATION_FOCUS){const it=($-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(nt),it>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(_e,this.scaleFactor),this._timeStart=-1,this.updateTbState(STATE.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(_changeEvent);else{const st=this.easeOutCubic(it),at=1-st+this.scaleFactor*st;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(_e,at,st),this.dispatchEvent(_changeEvent);const ot=this;this._animationId=window.requestAnimationFrame(function(ct){ot.onFocusAnim(ct,_e,tt,nt.clone())})}}else this._animationId=-1,this._timeStart=-1}),__publicField(this,"onRotationAnim",($,_e,tt)=>{if(this._timeStart==-1&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=$),this._state==STATE.ANIMATION_ROTATE){const nt=($-this._timeStart)/1e3;if(tt+-this.dampingFactor*nt>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(nt,2)+tt*nt+0,this.applyTransformMatrix(this.rotate(_e,this._angleCurrent)),this.dispatchEvent(_changeEvent);const it=this;this._animationId=window.requestAnimationFrame(function(st){it.onRotationAnim(st,_e,tt)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(STATE.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(_changeEvent)}else this._animationId=-1,this._timeStart=-1,this._state!=STATE.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(_changeEvent))}),__publicField(this,"pan",($,_e,tt=!1)=>{if(this.camera){const nt=$.clone().sub(_e);if(this.camera instanceof OrthographicCamera&&nt.multiplyScalar(1/this.camera.zoom),this.camera instanceof PerspectiveCamera&&tt){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);const rt=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);nt.multiplyScalar(1/rt)}this._v3_1.set(nt.x,nt.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1)}return _transformation}),__publicField(this,"reset",()=>{if(this.camera){this.camera.zoom=this._zoom0,this.camera instanceof PerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix();const $=this.calculateTbRadius(this.camera);$!==void 0&&(this._tbRadius=$),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_changeEvent)}}),__publicField(this,"rotate",($,_e)=>{const tt=this._gizmos.position;return this._translationMatrix.makeTranslation(-tt.x,-tt.y,-tt.z),this._rotationMatrix.makeRotationAxis($,-_e),this._m4_1.makeTranslation(tt.x,tt.y,tt.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),_transformation}),__publicField(this,"copyState",()=>{if(this.camera){const $=JSON.stringify(this.camera instanceof OrthographicCamera?{arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}:{arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}});navigator.clipboard.writeText($)}}),__publicField(this,"pasteState",()=>{const $=this;navigator.clipboard.readText().then(function(tt){$.setStateFromJSON(tt)})}),__publicField(this,"saveState",()=>{this.camera&&(this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera instanceof PerspectiveCamera&&(this._fov0=this.camera.fov))}),__publicField(this,"applyScale",($,_e,tt=!0)=>{if(!this.camera)return;const nt=_e.clone();let rt=1/$;if(this.camera instanceof OrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=$,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,rt=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,rt=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(rt,rt,rt),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),nt.sub(this._v3_1);const it=nt.clone().multiplyScalar(rt);return nt.sub(it),this._m4_1.makeTranslation(nt.x,nt.y,nt.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),_transformation}if(this.camera instanceof PerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let it=this._v3_1.distanceTo(nt),st=it-it*rt;const at=it-st;at<this.minDistance?(rt=this.minDistance/it,st=it-it*rt):at>this.maxDistance&&(rt=this.maxDistance/it,st=it-it*rt);let ot=nt.clone().sub(this._v3_1).normalize().multiplyScalar(st);if(this._m4_1.makeTranslation(ot.x,ot.y,ot.z),tt){const ct=this._v3_2;it=ct.distanceTo(nt),st=it-it*rt,ot=nt.clone().sub(this._v3_2).normalize().multiplyScalar(st),this._translationMatrix.makeTranslation(ct.x,ct.y,ct.z),this._scaleMatrix.makeScale(rt,rt,rt),this._m4_2.makeTranslation(ot.x,ot.y,ot.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-ct.x,-ct.y,-ct.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return _transformation}}),__publicField(this,"setFov",$=>{this.camera instanceof PerspectiveCamera&&(this.camera.fov=MathUtils.clamp($,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),__publicField(this,"setTarget",($,_e,tt)=>{if(this.camera){this.target.set($,_e,tt),this._gizmos.position.set($,_e,tt);const nt=this.calculateTbRadius(this.camera);nt!==void 0&&(this._tbRadius=nt),this.makeGizmos(this.target,this._tbRadius),this.camera.lookAt(this.target)}}),__publicField(this,"zRotate",($,_e)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,_e),this._translationMatrix.makeTranslation(-$.x,-$.y,-$.z),this._m4_1.makeTranslation($.x,$.y,$.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub($),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,_e),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),_transformation)),__publicField(this,"unprojectOnObj",($,_e)=>{if(!this.scene)return null;const tt=new Raycaster;tt.near=_e.near,tt.far=_e.far,tt.setFromCamera($,_e);const nt=tt.intersectObjects(this.scene.children,!0);for(let rt=0;rt<nt.length;rt++)if(nt[rt].object.uuid!=this._gizmos.uuid&&nt[rt].face)return nt[rt].point.clone();return null}),__publicField(this,"unprojectOnTbSurface",($,_e,tt,nt,rt)=>{if($ instanceof OrthographicCamera){this._v2_1.copy(this.getCursorPosition(_e,tt,nt)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);const it=Math.pow(this._v2_1.x,2),st=Math.pow(this._v2_1.y,2),at=Math.pow(this._tbRadius,2);return it+st<=at*.5?this._v3_1.setZ(Math.sqrt(at-(it+st))):this._v3_1.setZ(at*.5/Math.sqrt(it+st)),this._v3_1}if($ instanceof PerspectiveCamera){this._v2_1.copy(this.getCursorNDC(_e,tt,nt)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4($.projectionMatrixInverse);const it=this._v3_1.clone().normalize(),st=$.position.distanceTo(this._gizmos.position),at=Math.pow(rt,2),ot=this._v3_1.z,ct=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(ct==0)return it.set(this._v3_1.x,this._v3_1.y,rt),it;const ft=ot/ct,ht=st;let mt=Math.pow(ft,2)+1,lt=2*ft*ht,ut=Math.pow(ht,2)-at,dt=Math.pow(lt,2)-4*mt*ut;if(dt>=0&&(this._v2_1.setX((-lt-Math.sqrt(dt))/(2*mt)),this._v2_1.setY(ft*this._v2_1.x+ht),MathUtils.RAD2DEG*this._v2_1.angle()>=45)){const St=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(st-this._v2_1.y,2));return it.multiplyScalar(St),it.z+=st,it}mt=ft,lt=ht,ut=-at*.5,dt=Math.pow(lt,2)-4*mt*ut,this._v2_1.setX((-lt-Math.sqrt(dt))/(2*mt)),this._v2_1.setY(ft*this._v2_1.x+ht);const gt=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(st-this._v2_1.y,2));return it.multiplyScalar(gt),it.z+=st,it}}),__publicField(this,"unprojectOnTbPlane",($,_e,tt,nt,rt=!1)=>{if($ instanceof OrthographicCamera)return this._v2_1.copy(this.getCursorPosition(_e,tt,nt)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if($ instanceof PerspectiveCamera){this._v2_1.copy(this.getCursorNDC(_e,tt,nt)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4($.projectionMatrixInverse);const it=this._v3_1.clone().normalize(),st=this._v3_1.z,at=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));let ot;if(rt?ot=this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):ot=$.position.distanceTo(this._gizmos.position),at==0)return it.set(0,0,0),it;const ct=st/at,ft=ot,ht=-ft/ct,mt=Math.sqrt(Math.pow(ft,2)+Math.pow(ht,2));return it.multiplyScalar(mt),it.z=0,it}}),__publicField(this,"updateMatrixState",()=>{this.camera&&(this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera instanceof OrthographicCamera&&(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom),this.camera instanceof PerspectiveCamera&&(this._fovState=this.camera.fov))}),__publicField(this,"updateTbState",($,_e)=>{this._state=$,_e&&this.updateMatrixState()}),__publicField(this,"update",()=>{if(!this.target.equals(this._currentTarget)&&this.camera){this._gizmos.position.set(this.target.x,this.target.y,this.target.z);const _e=this.calculateTbRadius(this.camera);_e!==void 0&&(this._tbRadius=_e),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)}if(this.camera){if(this.camera instanceof OrthographicCamera&&(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom)){const _e=MathUtils.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.applyScale(_e/this.camera.zoom,this._gizmos.position,!0))}if(this.camera instanceof PerspectiveCamera){const _e=this.camera.position.distanceTo(this._gizmos.position);if(_e>this.maxDistance+1e-6||_e<this.minDistance-1e-6){const rt=MathUtils.clamp(_e,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.applyScale(rt/_e,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=MathUtils.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());const tt=this._tbRadius,nt=this.calculateTbRadius(this.camera);if(nt!==void 0&&(this._tbRadius=nt),tt<this._tbRadius-1e-6||tt>this._tbRadius+1e-6){const rt=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3,it=this._tbRadius/rt,at=new EllipseCurve(0,0,it,it).getPoints(this._curvePts),ot=new BufferGeometry().setFromPoints(at);for(const ct in this._gizmos.children){const ft=this._gizmos.children[ct];ft.geometry=ot}}}this.camera.lookAt(this._gizmos.position)}}),__publicField(this,"setStateFromJSON",$=>{const _e=JSON.parse($);if(_e.arcballState&&this.camera){this._cameraMatrixState.fromArray(_e.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(_e.arcballState.cameraUp),this.camera.near=_e.arcballState.cameraNear,this.camera.far=_e.arcballState.cameraFar,this.camera.zoom=_e.arcballState.cameraZoom,this.camera instanceof PerspectiveCamera&&(this.camera.fov=_e.arcballState.cameraFov),this._gizmoMatrixState.fromArray(_e.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix();const tt=this.calculateTbRadius(this.camera);tt!==void 0&&(this._tbRadius=tt);const nt=new Matrix4().copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(nt),this.camera.lookAt(this._gizmos.position),this.updateTbState(STATE.IDLE,!1),this.dispatchEvent(_changeEvent)}}),this.camera=null,this.domElement=o,this.scene=j,this.mouseActions=[],this._mouseOp=null,this._v2_1=new Vector2,this._v3_1=new Vector3,this._v3_2=new Vector3,this._m4_1=new Matrix4,this._m4_2=new Matrix4,this._quat=new Quaternion,this._translationMatrix=new Matrix4,this._rotationMatrix=new Matrix4,this._scaleMatrix=new Matrix4,this._rotationAxis=new Vector3,this._cameraMatrixState=new Matrix4,this._cameraProjectionState=new Matrix4,this._fovState=1,this._upState=new Vector3,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new Matrix4,this._up0=new Vector3,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new Matrix4,this._gizmoMatrixState0=new Matrix4,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=INPUT.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new Vector3,this._startCursorPosition=new Vector3,this._grid=null,this._gridPosition=new Vector3,this._gizmos=new Group,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new Vector3,this._cursorPosCurr=new Vector3,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.target=new Vector3(0,0,0),this._currentTarget=new Vector3(0,0,0),this._tbRadius=1,this._state=STATE.IDLE,this.setCamera(s),this.scene&&this.scene.add(this._gizmos),this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement&&this.connect(this.domElement),window.addEventListener("resize",this.onWindowResize)}applyTransformMatrix(s){if(s!=null&&s.camera&&this.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(s.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==STATE.ROTATE||this._state==STATE.ZROTATE||this._state==STATE.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),s!=null&&s.gizmos&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(s.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),(this._state==STATE.SCALE||this._state==STATE.FOCUS||this._state==STATE.ANIMATION_FOCUS)&&this.camera){const o=this.calculateTbRadius(this.camera);if(o!==void 0&&(this._tbRadius=o),this.adjustNearFar){const j=this.camera.position.distanceTo(this._gizmos.position),$=new Box3;$.setFromObject(this._gizmos);const _e=new Sphere;$.getBoundingSphere(_e);const tt=Math.max(this._nearPos0,_e.radius+_e.center.length()),nt=j-this._initialNear,rt=Math.min(tt,nt);this.camera.near=j-rt;const it=Math.min(this._farPos0,-_e.radius+_e.center.length()),st=j-this._initialFar,at=Math.min(it,st);this.camera.far=j-at,this.camera.updateProjectionMatrix()}else{let j=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,j=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,j=!0),j&&this.camera.updateProjectionMatrix()}}}setGizmosVisible(s){this._gizmos.visible=s,this.dispatchEvent(_changeEvent)}setTransformationMatrices(s=null,o=null){s?_transformation.camera?_transformation.camera.copy(s):_transformation.camera=s.clone():_transformation.camera=null,o?_transformation.gizmos?_transformation.gizmos.copy(o):_transformation.gizmos=o.clone():_transformation.gizmos=null}}function contextmenu(a){a.preventDefault()}class FlyControls extends EventDispatcher{constructor(s,o){super(),__publicField(this,"object"),__publicField(this,"domElement",null),__publicField(this,"movementSpeed",1),__publicField(this,"rollSpeed",.005),__publicField(this,"dragToLook",!1),__publicField(this,"autoForward",!1),__publicField(this,"changeEvent",{type:"change"}),__publicField(this,"EPS",1e-6),__publicField(this,"tmpQuaternion",new Quaternion),__publicField(this,"mouseStatus",0),__publicField(this,"movementSpeedMultiplier",1),__publicField(this,"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),__publicField(this,"moveVector",new Vector3(0,0,0)),__publicField(this,"rotationVector",new Vector3(0,0,0)),__publicField(this,"keydown",j=>{if(!j.altKey){switch(j.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1;break}this.updateMovementVector(),this.updateRotationVector()}}),__publicField(this,"keyup",j=>{switch(j.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0;break}this.updateMovementVector(),this.updateRotationVector()}),__publicField(this,"pointerdown",j=>{if(this.dragToLook)this.mouseStatus++;else{switch(j.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1;break}this.updateMovementVector()}}),__publicField(this,"pointermove",j=>{if(!this.dragToLook||this.mouseStatus>0){const $=this.getContainerDimensions(),_e=$.size[0]/2,tt=$.size[1]/2;this.moveState.yawLeft=-(j.pageX-$.offset[0]-_e)/_e,this.moveState.pitchDown=(j.pageY-$.offset[1]-tt)/tt,this.updateRotationVector()}}),__publicField(this,"pointerup",j=>{if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(j.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0;break}this.updateMovementVector()}this.updateRotationVector()}),__publicField(this,"lastQuaternion",new Quaternion),__publicField(this,"lastPosition",new Vector3),__publicField(this,"update",j=>{const $=j*this.movementSpeed,_e=j*this.rollSpeed;this.object.translateX(this.moveVector.x*$),this.object.translateY(this.moveVector.y*$),this.object.translateZ(this.moveVector.z*$),this.tmpQuaternion.set(this.rotationVector.x*_e,this.rotationVector.y*_e,this.rotationVector.z*_e,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS)&&(this.dispatchEvent(this.changeEvent),this.lastQuaternion.copy(this.object.quaternion),this.lastPosition.copy(this.object.position))}),__publicField(this,"updateMovementVector",()=>{const j=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-j+this.moveState.back}),__publicField(this,"updateRotationVector",()=>{this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft}),__publicField(this,"getContainerDimensions",()=>this.domElement!=document&&!(this.domElement instanceof Document)?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}),__publicField(this,"connect",j=>{this.domElement=j,j&&!(j instanceof Document)&&j.setAttribute("tabindex",-1),this.domElement.addEventListener("contextmenu",contextmenu),this.domElement.addEventListener("pointermove",this.pointermove),this.domElement.addEventListener("pointerdown",this.pointerdown),this.domElement.addEventListener("pointerup",this.pointerup),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}),__publicField(this,"dispose",()=>{this.domElement.removeEventListener("contextmenu",contextmenu),this.domElement.removeEventListener("pointermove",this.pointermove),this.domElement.removeEventListener("pointerdown",this.pointerdown),this.domElement.removeEventListener("pointerup",this.pointerup),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}),this.object=s,o!==void 0&&this.connect(o),this.updateMovementVector(),this.updateRotationVector()}}class GLTFLoader extends Loader{constructor(s){super(s),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(o){return new GLTFMaterialsClearcoatExtension(o)}),this.register(function(o){return new GLTFTextureBasisUExtension(o)}),this.register(function(o){return new GLTFTextureWebPExtension(o)}),this.register(function(o){return new GLTFTextureAVIFExtension(o)}),this.register(function(o){return new GLTFMaterialsSheenExtension(o)}),this.register(function(o){return new GLTFMaterialsTransmissionExtension(o)}),this.register(function(o){return new GLTFMaterialsVolumeExtension(o)}),this.register(function(o){return new GLTFMaterialsIorExtension(o)}),this.register(function(o){return new GLTFMaterialsEmissiveStrengthExtension(o)}),this.register(function(o){return new GLTFMaterialsSpecularExtension(o)}),this.register(function(o){return new GLTFMaterialsIridescenceExtension(o)}),this.register(function(o){return new GLTFMaterialsAnisotropyExtension(o)}),this.register(function(o){return new GLTFLightsExtension(o)}),this.register(function(o){return new GLTFMeshoptCompression(o)}),this.register(function(o){return new GLTFMeshGpuInstancing(o)})}load(s,o,j,$){const _e=this;let tt;this.resourcePath!==""?tt=this.resourcePath:this.path!==""?tt=this.path:tt=LoaderUtils.extractUrlBase(s),this.manager.itemStart(s);const nt=function(it){$?$(it):console.error(it),_e.manager.itemError(s),_e.manager.itemEnd(s)},rt=new FileLoader(this.manager);rt.setPath(this.path),rt.setResponseType("arraybuffer"),rt.setRequestHeader(this.requestHeader),rt.setWithCredentials(this.withCredentials),rt.load(s,function(it){try{_e.parse(it,tt,function(st){o(st),_e.manager.itemEnd(s)},nt)}catch(st){nt(st)}},j,nt)}setDRACOLoader(s){return this.dracoLoader=s,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(s){return this.ktx2Loader=s,this}setMeshoptDecoder(s){return this.meshoptDecoder=s,this}register(s){return this.pluginCallbacks.indexOf(s)===-1&&this.pluginCallbacks.push(s),this}unregister(s){return this.pluginCallbacks.indexOf(s)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(s),1),this}parse(s,o,j,$){let _e;const tt={},nt={};if(typeof s=="string")_e=JSON.parse(s);else if(s instanceof ArrayBuffer)if(LoaderUtils.decodeText(new Uint8Array(s.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC){try{tt[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(s)}catch(st){$&&$(st);return}_e=JSON.parse(tt[EXTENSIONS.KHR_BINARY_GLTF].content)}else _e=JSON.parse(LoaderUtils.decodeText(new Uint8Array(s)));else _e=s;if(_e.asset===void 0||_e.asset.version[0]<2){$&&$(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const rt=new GLTFParser(_e,{path:o||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});rt.fileLoader.setRequestHeader(this.requestHeader);for(let it=0;it<this.pluginCallbacks.length;it++){const st=this.pluginCallbacks[it](rt);nt[st.name]=st,tt[st.name]=!0}if(_e.extensionsUsed)for(let it=0;it<_e.extensionsUsed.length;++it){const st=_e.extensionsUsed[it],at=_e.extensionsRequired||[];switch(st){case EXTENSIONS.KHR_MATERIALS_UNLIT:tt[st]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:tt[st]=new GLTFDracoMeshCompressionExtension(_e,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:tt[st]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:tt[st]=new GLTFMeshQuantizationExtension;break;default:at.indexOf(st)>=0&&nt[st]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+st+'".')}}rt.setExtensions(tt),rt.setPlugins(nt),rt.parse(j,$)}parseAsync(s,o){const j=this;return new Promise(function($,_e){j.parse(s,o,$,_e)})}}function GLTFRegistry(){let a={};return{get:function(s){return a[s]},add:function(s,o){a[s]=o},remove:function(s){delete a[s]},removeAll:function(){a={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const s=this.parser,o=this.parser.json.nodes||[];for(let j=0,$=o.length;j<$;j++){const _e=o[j];_e.extensions&&_e.extensions[this.name]&&_e.extensions[this.name].light!==void 0&&s._addNodeRef(this.cache,_e.extensions[this.name].light)}}_loadLight(s){const o=this.parser,j="light:"+s;let $=o.cache.get(j);if($)return $;const _e=o.json,rt=((_e.extensions&&_e.extensions[this.name]||{}).lights||[])[s];let it;const st=new Color(16777215);rt.color!==void 0&&st.fromArray(rt.color);const at=rt.range!==void 0?rt.range:0;switch(rt.type){case"directional":it=new DirectionalLight(st),it.target.position.set(0,0,-1),it.add(it.target);break;case"point":it=new PointLight(st),it.distance=at;break;case"spot":it=new SpotLight(st),it.distance=at,rt.spot=rt.spot||{},rt.spot.innerConeAngle=rt.spot.innerConeAngle!==void 0?rt.spot.innerConeAngle:0,rt.spot.outerConeAngle=rt.spot.outerConeAngle!==void 0?rt.spot.outerConeAngle:Math.PI/4,it.angle=rt.spot.outerConeAngle,it.penumbra=1-rt.spot.innerConeAngle/rt.spot.outerConeAngle,it.target.position.set(0,0,-1),it.add(it.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+rt.type)}return it.position.set(0,0,0),it.decay=2,assignExtrasToUserData(it,rt),rt.intensity!==void 0&&(it.intensity=rt.intensity),it.name=o.createUniqueName(rt.name||"light_"+s),$=Promise.resolve(it),o.cache.add(j,$),$}getDependency(s,o){if(s==="light")return this._loadLight(o)}createNodeAttachment(s){const o=this,j=this.parser,_e=j.json.nodes[s],nt=(_e.extensions&&_e.extensions[this.name]||{}).light;return nt===void 0?null:this._loadLight(nt).then(function(rt){return j._getNodeRef(o.cache,nt,rt)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(s,o,j){const $=[];s.color=new Color(1,1,1),s.opacity=1;const _e=o.pbrMetallicRoughness;if(_e){if(Array.isArray(_e.baseColorFactor)){const tt=_e.baseColorFactor;s.color.fromArray(tt),s.opacity=tt[3]}_e.baseColorTexture!==void 0&&$.push(j.assignTexture(s,"map",_e.baseColorTexture,3001))}return Promise.all($)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(s,o){const $=this.parser.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=$.extensions[this.name].emissiveStrength;return _e!==void 0&&(o.emissiveIntensity=_e),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];if(tt.clearcoatFactor!==void 0&&(o.clearcoat=tt.clearcoatFactor),tt.clearcoatTexture!==void 0&&_e.push(j.assignTexture(o,"clearcoatMap",tt.clearcoatTexture)),tt.clearcoatRoughnessFactor!==void 0&&(o.clearcoatRoughness=tt.clearcoatRoughnessFactor),tt.clearcoatRoughnessTexture!==void 0&&_e.push(j.assignTexture(o,"clearcoatRoughnessMap",tt.clearcoatRoughnessTexture)),tt.clearcoatNormalTexture!==void 0&&(_e.push(j.assignTexture(o,"clearcoatNormalMap",tt.clearcoatNormalTexture)),tt.clearcoatNormalTexture.scale!==void 0)){const nt=tt.clearcoatNormalTexture.scale;o.clearcoatNormalScale=new Vector2(nt,nt)}return Promise.all(_e)}}class GLTFMaterialsIridescenceExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];return tt.iridescenceFactor!==void 0&&(o.iridescence=tt.iridescenceFactor),tt.iridescenceTexture!==void 0&&_e.push(j.assignTexture(o,"iridescenceMap",tt.iridescenceTexture)),tt.iridescenceIor!==void 0&&(o.iridescenceIOR=tt.iridescenceIor),o.iridescenceThicknessRange===void 0&&(o.iridescenceThicknessRange=[100,400]),tt.iridescenceThicknessMinimum!==void 0&&(o.iridescenceThicknessRange[0]=tt.iridescenceThicknessMinimum),tt.iridescenceThicknessMaximum!==void 0&&(o.iridescenceThicknessRange[1]=tt.iridescenceThicknessMaximum),tt.iridescenceThicknessTexture!==void 0&&_e.push(j.assignTexture(o,"iridescenceThicknessMap",tt.iridescenceThicknessTexture)),Promise.all(_e)}}class GLTFMaterialsSheenExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[];o.sheenColor=new Color(0,0,0),o.sheenRoughness=0,o.sheen=1;const tt=$.extensions[this.name];return tt.sheenColorFactor!==void 0&&o.sheenColor.fromArray(tt.sheenColorFactor),tt.sheenRoughnessFactor!==void 0&&(o.sheenRoughness=tt.sheenRoughnessFactor),tt.sheenColorTexture!==void 0&&_e.push(j.assignTexture(o,"sheenColorMap",tt.sheenColorTexture,3001)),tt.sheenRoughnessTexture!==void 0&&_e.push(j.assignTexture(o,"sheenRoughnessMap",tt.sheenRoughnessTexture)),Promise.all(_e)}}class GLTFMaterialsTransmissionExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];return tt.transmissionFactor!==void 0&&(o.transmission=tt.transmissionFactor),tt.transmissionTexture!==void 0&&_e.push(j.assignTexture(o,"transmissionMap",tt.transmissionTexture)),Promise.all(_e)}}class GLTFMaterialsVolumeExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];o.thickness=tt.thicknessFactor!==void 0?tt.thicknessFactor:0,tt.thicknessTexture!==void 0&&_e.push(j.assignTexture(o,"thicknessMap",tt.thicknessTexture)),o.attenuationDistance=tt.attenuationDistance||1/0;const nt=tt.attenuationColor||[1,1,1];return o.attenuationColor=new Color(nt[0],nt[1],nt[2]),Promise.all(_e)}}class GLTFMaterialsIorExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const $=this.parser.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=$.extensions[this.name];return o.ior=_e.ior!==void 0?_e.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];o.specularIntensity=tt.specularFactor!==void 0?tt.specularFactor:1,tt.specularTexture!==void 0&&_e.push(j.assignTexture(o,"specularIntensityMap",tt.specularTexture));const nt=tt.specularColorFactor||[1,1,1];return o.specularColor=new Color(nt[0],nt[1],nt[2]),tt.specularColorTexture!==void 0&&_e.push(j.assignTexture(o,"specularColorMap",tt.specularColorTexture,3001)),Promise.all(_e)}}class GLTFMaterialsAnisotropyExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(s){const j=this.parser.json.materials[s];return!j.extensions||!j.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(s,o){const j=this.parser,$=j.json.materials[s];if(!$.extensions||!$.extensions[this.name])return Promise.resolve();const _e=[],tt=$.extensions[this.name];return tt.anisotropyStrength!==void 0&&(o.anisotropy=tt.anisotropyStrength),tt.anisotropyRotation!==void 0&&(o.anisotropyRotation=tt.anisotropyRotation),tt.anisotropyTexture!==void 0&&_e.push(j.assignTexture(o,"anisotropyMap",tt.anisotropyTexture)),Promise.all(_e)}}class GLTFTextureBasisUExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(s){const o=this.parser,j=o.json,$=j.textures[s];if(!$.extensions||!$.extensions[this.name])return null;const _e=$.extensions[this.name],tt=o.options.ktx2Loader;if(!tt){if(j.extensionsRequired&&j.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return o.loadTextureImage(s,_e.source,tt)}}class GLTFTextureWebPExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(s){const o=this.name,j=this.parser,$=j.json,_e=$.textures[s];if(!_e.extensions||!_e.extensions[o])return null;const tt=_e.extensions[o],nt=$.images[tt.source];let rt=j.textureLoader;if(nt.uri){const it=j.options.manager.getHandler(nt.uri);it!==null&&(rt=it)}return this.detectSupport().then(function(it){if(it)return j.loadTextureImage(s,tt.source,rt);if($.extensionsRequired&&$.extensionsRequired.indexOf(o)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return j.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const o=new Image;o.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",o.onload=o.onerror=function(){s(o.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(s){this.parser=s,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(s){const o=this.name,j=this.parser,$=j.json,_e=$.textures[s];if(!_e.extensions||!_e.extensions[o])return null;const tt=_e.extensions[o],nt=$.images[tt.source];let rt=j.textureLoader;if(nt.uri){const it=j.options.manager.getHandler(nt.uri);it!==null&&(rt=it)}return this.detectSupport().then(function(it){if(it)return j.loadTextureImage(s,tt.source,rt);if($.extensionsRequired&&$.extensionsRequired.indexOf(o)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return j.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const o=new Image;o.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",o.onload=o.onerror=function(){s(o.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(s){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=s}loadBufferView(s){const o=this.parser.json,j=o.bufferViews[s];if(j.extensions&&j.extensions[this.name]){const $=j.extensions[this.name],_e=this.parser.getDependency("buffer",$.buffer),tt=this.parser.options.meshoptDecoder;if(!tt||!tt.supported){if(o.extensionsRequired&&o.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return _e.then(function(nt){const rt=$.byteOffset||0,it=$.byteLength||0,st=$.count,at=$.byteStride,ot=new Uint8Array(nt,rt,it);return tt.decodeGltfBufferAsync?tt.decodeGltfBufferAsync(st,at,ot,$.mode,$.filter).then(function(ct){return ct.buffer}):tt.ready.then(function(){const ct=new ArrayBuffer(st*at);return tt.decodeGltfBuffer(new Uint8Array(ct),st,at,ot,$.mode,$.filter),ct})})}else return null}}class GLTFMeshGpuInstancing{constructor(s){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=s}createNodeMesh(s){const o=this.parser.json,j=o.nodes[s];if(!j.extensions||!j.extensions[this.name]||j.mesh===void 0)return null;const $=o.meshes[j.mesh];for(const it of $.primitives)if(it.mode!==WEBGL_CONSTANTS.TRIANGLES&&it.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&it.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&it.mode!==void 0)return null;const tt=j.extensions[this.name].attributes,nt=[],rt={};for(const it in tt)nt.push(this.parser.getDependency("accessor",tt[it]).then(st=>(rt[it]=st,rt[it])));return nt.length<1?null:(nt.push(this.parser.createNodeMesh(s)),Promise.all(nt).then(it=>{const st=it.pop(),at=st.isGroup?st.children:[st],ot=it[0].count,ct=[];for(const ft of at){const ht=new Matrix4,mt=new Vector3,lt=new Quaternion,ut=new Vector3(1,1,1),dt=new InstancedMesh(ft.geometry,ft.material,ot);for(let gt=0;gt<ot;gt++)rt.TRANSLATION&&mt.fromBufferAttribute(rt.TRANSLATION,gt),rt.ROTATION&&lt.fromBufferAttribute(rt.ROTATION,gt),rt.SCALE&&ut.fromBufferAttribute(rt.SCALE,gt),dt.setMatrixAt(gt,ht.compose(mt,lt,ut));for(const gt in rt)gt!=="TRANSLATION"&&gt!=="ROTATION"&&gt!=="SCALE"&&ft.geometry.setAttribute(gt,rt[gt]);Object3D.prototype.copy.call(dt,ft),this.parser.assignFinalMaterial(dt),ct.push(dt)}return st.isGroup?(st.clear(),st.add(...ct),st):ct[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(s){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const o=new DataView(s,0,BINARY_EXTENSION_HEADER_LENGTH);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(s.slice(0,4))),version:o.getUint32(4,!0),length:o.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const j=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,$=new DataView(s,BINARY_EXTENSION_HEADER_LENGTH);let _e=0;for(;_e<j;){const tt=$.getUint32(_e,!0);_e+=4;const nt=$.getUint32(_e,!0);if(_e+=4,nt===BINARY_EXTENSION_CHUNK_TYPES.JSON){const rt=new Uint8Array(s,BINARY_EXTENSION_HEADER_LENGTH+_e,tt);this.content=LoaderUtils.decodeText(rt)}else if(nt===BINARY_EXTENSION_CHUNK_TYPES.BIN){const rt=BINARY_EXTENSION_HEADER_LENGTH+_e;this.body=s.slice(rt,rt+tt)}_e+=tt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(s,o){if(!o)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=s,this.dracoLoader=o,this.dracoLoader.preload()}decodePrimitive(s,o){const j=this.json,$=this.dracoLoader,_e=s.extensions[this.name].bufferView,tt=s.extensions[this.name].attributes,nt={},rt={},it={};for(const st in tt){const at=ATTRIBUTES[st]||st.toLowerCase();nt[at]=tt[st]}for(const st in s.attributes){const at=ATTRIBUTES[st]||st.toLowerCase();if(tt[st]!==void 0){const ot=j.accessors[s.attributes[st]],ct=WEBGL_COMPONENT_TYPES[ot.componentType];it[at]=ct.name,rt[at]=ot.normalized===!0}}return o.getDependency("bufferView",_e).then(function(st){return new Promise(function(at){$.decodeDracoFile(st,function(ot){for(const ct in ot.attributes){const ft=ot.attributes[ct],ht=rt[ct];ht!==void 0&&(ft.normalized=ht)}at(ot)},nt,it)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(s,o){return(o.texCoord===void 0||o.texCoord===s.channel)&&o.offset===void 0&&o.rotation===void 0&&o.scale===void 0||(s=s.clone(),o.texCoord!==void 0&&(s.channel=o.texCoord),o.offset!==void 0&&s.offset.fromArray(o.offset),o.rotation!==void 0&&(s.rotation=o.rotation),o.scale!==void 0&&s.repeat.fromArray(o.scale),s.needsUpdate=!0),s}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(s,o,j,$){super(s,o,j,$)}copySampleValue_(s){const o=this.resultBuffer,j=this.sampleValues,$=this.valueSize,_e=s*$*3+$;for(let tt=0;tt!==$;tt++)o[tt]=j[_e+tt];return o}interpolate_(s,o,j,$){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=nt*2,it=nt*3,st=$-o,at=(j-o)/st,ot=at*at,ct=ot*at,ft=s*it,ht=ft-it,mt=-2*ct+3*ot,lt=ct-ot,ut=1-mt,dt=lt-ot+at;for(let gt=0;gt!==nt;gt++){const Et=tt[ht+gt+nt],St=tt[ht+gt+rt]*st,Tt=tt[ft+gt+nt],Mt=tt[ft+gt]*st;_e[gt]=ut*Et+dt*St+mt*Tt+lt*Mt}return _e}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(s,o,j,$){const _e=super.interpolate_(s,o,j,$);return _q.fromArray(_e).normalize().toArray(_e),_e}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(a){return a.DefaultMaterial===void 0&&(a.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),a.DefaultMaterial}function addUnknownExtensionsToUserData(a,s,o){for(const j in o.extensions)a[j]===void 0&&(s.userData.gltfExtensions=s.userData.gltfExtensions||{},s.userData.gltfExtensions[j]=o.extensions[j])}function assignExtrasToUserData(a,s){s.extras!==void 0&&(typeof s.extras=="object"?Object.assign(a.userData,s.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+s.extras))}function addMorphTargets(a,s,o){let j=!1,$=!1,_e=!1;for(let it=0,st=s.length;it<st;it++){const at=s[it];if(at.POSITION!==void 0&&(j=!0),at.NORMAL!==void 0&&($=!0),at.COLOR_0!==void 0&&(_e=!0),j&&$&&_e)break}if(!j&&!$&&!_e)return Promise.resolve(a);const tt=[],nt=[],rt=[];for(let it=0,st=s.length;it<st;it++){const at=s[it];if(j){const ot=at.POSITION!==void 0?o.getDependency("accessor",at.POSITION):a.attributes.position;tt.push(ot)}if($){const ot=at.NORMAL!==void 0?o.getDependency("accessor",at.NORMAL):a.attributes.normal;nt.push(ot)}if(_e){const ot=at.COLOR_0!==void 0?o.getDependency("accessor",at.COLOR_0):a.attributes.color;rt.push(ot)}}return Promise.all([Promise.all(tt),Promise.all(nt),Promise.all(rt)]).then(function(it){const st=it[0],at=it[1],ot=it[2];return j&&(a.morphAttributes.position=st),$&&(a.morphAttributes.normal=at),_e&&(a.morphAttributes.color=ot),a.morphTargetsRelative=!0,a})}function updateMorphTargets(a,s){if(a.updateMorphTargets(),s.weights!==void 0)for(let o=0,j=s.weights.length;o<j;o++)a.morphTargetInfluences[o]=s.weights[o];if(s.extras&&Array.isArray(s.extras.targetNames)){const o=s.extras.targetNames;if(a.morphTargetInfluences.length===o.length){a.morphTargetDictionary={};for(let j=0,$=o.length;j<$;j++)a.morphTargetDictionary[o[j]]=j}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(a){let s;const o=a.extensions&&a.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(o?s="draco:"+o.bufferView+":"+o.indices+":"+createAttributesKey(o.attributes):s=a.indices+":"+createAttributesKey(a.attributes)+":"+a.mode,a.targets!==void 0)for(let j=0,$=a.targets.length;j<$;j++)s+=":"+createAttributesKey(a.targets[j]);return s}function createAttributesKey(a){let s="";const o=Object.keys(a).sort();for(let j=0,$=o.length;j<$;j++)s+=o[j]+":"+a[o[j]]+";";return s}function getNormalizedComponentScale(a){switch(a){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(a){return a.search(/\.jpe?g($|\?)/i)>0||a.search(/^data\:image\/jpeg/)===0?"image/jpeg":a.search(/\.webp($|\?)/i)>0||a.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(s={},o={}){this.json=s,this.extensions={},this.plugins={},this.options=o,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let j=!1,$=!1,_e=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(j=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,$=navigator.userAgent.indexOf("Firefox")>-1,_e=$?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||j||$&&_e<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(s){this.extensions=s}setPlugins(s){this.plugins=s}parse(s,o){const j=this,$=this.json,_e=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(tt){return tt._markDefs&&tt._markDefs()}),Promise.all(this._invokeAll(function(tt){return tt.beforeRoot&&tt.beforeRoot()})).then(function(){return Promise.all([j.getDependencies("scene"),j.getDependencies("animation"),j.getDependencies("camera")])}).then(function(tt){const nt={scene:tt[0][$.scene||0],scenes:tt[0],animations:tt[1],cameras:tt[2],asset:$.asset,parser:j,userData:{}};addUnknownExtensionsToUserData(_e,nt,$),assignExtrasToUserData(nt,$),Promise.all(j._invokeAll(function(rt){return rt.afterRoot&&rt.afterRoot(nt)})).then(function(){s(nt)})}).catch(o)}_markDefs(){const s=this.json.nodes||[],o=this.json.skins||[],j=this.json.meshes||[];for(let $=0,_e=o.length;$<_e;$++){const tt=o[$].joints;for(let nt=0,rt=tt.length;nt<rt;nt++)s[tt[nt]].isBone=!0}for(let $=0,_e=s.length;$<_e;$++){const tt=s[$];tt.mesh!==void 0&&(this._addNodeRef(this.meshCache,tt.mesh),tt.skin!==void 0&&(j[tt.mesh].isSkinnedMesh=!0)),tt.camera!==void 0&&this._addNodeRef(this.cameraCache,tt.camera)}}_addNodeRef(s,o){o!==void 0&&(s.refs[o]===void 0&&(s.refs[o]=s.uses[o]=0),s.refs[o]++)}_getNodeRef(s,o,j){if(s.refs[o]<=1)return j;const $=j.clone(),_e=(tt,nt)=>{const rt=this.associations.get(tt);rt!=null&&this.associations.set(nt,rt);for(const[it,st]of tt.children.entries())_e(st,nt.children[it])};return _e(j,$),$.name+="_instance_"+s.uses[o]++,$}_invokeOne(s){const o=Object.values(this.plugins);o.push(this);for(let j=0;j<o.length;j++){const $=s(o[j]);if($)return $}return null}_invokeAll(s){const o=Object.values(this.plugins);o.unshift(this);const j=[];for(let $=0;$<o.length;$++){const _e=s(o[$]);_e&&j.push(_e)}return j}getDependency(s,o){const j=s+":"+o;let $=this.cache.get(j);if(!$){switch(s){case"scene":$=this.loadScene(o);break;case"node":$=this._invokeOne(function(_e){return _e.loadNode&&_e.loadNode(o)});break;case"mesh":$=this._invokeOne(function(_e){return _e.loadMesh&&_e.loadMesh(o)});break;case"accessor":$=this.loadAccessor(o);break;case"bufferView":$=this._invokeOne(function(_e){return _e.loadBufferView&&_e.loadBufferView(o)});break;case"buffer":$=this.loadBuffer(o);break;case"material":$=this._invokeOne(function(_e){return _e.loadMaterial&&_e.loadMaterial(o)});break;case"texture":$=this._invokeOne(function(_e){return _e.loadTexture&&_e.loadTexture(o)});break;case"skin":$=this.loadSkin(o);break;case"animation":$=this._invokeOne(function(_e){return _e.loadAnimation&&_e.loadAnimation(o)});break;case"camera":$=this.loadCamera(o);break;default:if($=this._invokeOne(function(_e){return _e!=this&&_e.getDependency&&_e.getDependency(s,o)}),!$)throw new Error("Unknown type: "+s);break}this.cache.add(j,$)}return $}getDependencies(s){let o=this.cache.get(s);if(!o){const j=this,$=this.json[s+(s==="mesh"?"es":"s")]||[];o=Promise.all($.map(function(_e,tt){return j.getDependency(s,tt)})),this.cache.add(s,o)}return o}loadBuffer(s){const o=this.json.buffers[s],j=this.fileLoader;if(o.type&&o.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+o.type+" buffer type is not supported.");if(o.uri===void 0&&s===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const $=this.options;return new Promise(function(_e,tt){j.load(LoaderUtils.resolveURL(o.uri,$.path),_e,void 0,function(){tt(new Error('THREE.GLTFLoader: Failed to load buffer "'+o.uri+'".'))})})}loadBufferView(s){const o=this.json.bufferViews[s];return this.getDependency("buffer",o.buffer).then(function(j){const $=o.byteLength||0,_e=o.byteOffset||0;return j.slice(_e,_e+$)})}loadAccessor(s){const o=this,j=this.json,$=this.json.accessors[s];if($.bufferView===void 0&&$.sparse===void 0){const tt=WEBGL_TYPE_SIZES[$.type],nt=WEBGL_COMPONENT_TYPES[$.componentType],rt=$.normalized===!0,it=new nt($.count*tt);return Promise.resolve(new BufferAttribute(it,tt,rt))}const _e=[];return $.bufferView!==void 0?_e.push(this.getDependency("bufferView",$.bufferView)):_e.push(null),$.sparse!==void 0&&(_e.push(this.getDependency("bufferView",$.sparse.indices.bufferView)),_e.push(this.getDependency("bufferView",$.sparse.values.bufferView))),Promise.all(_e).then(function(tt){const nt=tt[0],rt=WEBGL_TYPE_SIZES[$.type],it=WEBGL_COMPONENT_TYPES[$.componentType],st=it.BYTES_PER_ELEMENT,at=st*rt,ot=$.byteOffset||0,ct=$.bufferView!==void 0?j.bufferViews[$.bufferView].byteStride:void 0,ft=$.normalized===!0;let ht,mt;if(ct&&ct!==at){const lt=Math.floor(ot/ct),ut="InterleavedBuffer:"+$.bufferView+":"+$.componentType+":"+lt+":"+$.count;let dt=o.cache.get(ut);dt||(ht=new it(nt,lt*ct,$.count*ct/st),dt=new InterleavedBuffer(ht,ct/st),o.cache.add(ut,dt)),mt=new InterleavedBufferAttribute(dt,rt,ot%ct/st,ft)}else nt===null?ht=new it($.count*rt):ht=new it(nt,ot,$.count*rt),mt=new BufferAttribute(ht,rt,ft);if($.sparse!==void 0){const lt=WEBGL_TYPE_SIZES.SCALAR,ut=WEBGL_COMPONENT_TYPES[$.sparse.indices.componentType],dt=$.sparse.indices.byteOffset||0,gt=$.sparse.values.byteOffset||0,Et=new ut(tt[1],dt,$.sparse.count*lt),St=new it(tt[2],gt,$.sparse.count*rt);nt!==null&&(mt=new BufferAttribute(mt.array.slice(),mt.itemSize,mt.normalized));for(let Tt=0,Mt=Et.length;Tt<Mt;Tt++){const Bt=Et[Tt];if(mt.setX(Bt,St[Tt*rt]),rt>=2&&mt.setY(Bt,St[Tt*rt+1]),rt>=3&&mt.setZ(Bt,St[Tt*rt+2]),rt>=4&&mt.setW(Bt,St[Tt*rt+3]),rt>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return mt})}loadTexture(s){const o=this.json,j=this.options,_e=o.textures[s].source,tt=o.images[_e];let nt=this.textureLoader;if(tt.uri){const rt=j.manager.getHandler(tt.uri);rt!==null&&(nt=rt)}return this.loadTextureImage(s,_e,nt)}loadTextureImage(s,o,j){const $=this,_e=this.json,tt=_e.textures[s],nt=_e.images[o],rt=(nt.uri||nt.bufferView)+":"+tt.sampler;if(this.textureCache[rt])return this.textureCache[rt];const it=this.loadImageSource(o,j).then(function(st){st.flipY=!1,st.name=tt.name||nt.name||"",st.name===""&&typeof nt.uri=="string"&&nt.uri.startsWith("data:image/")===!1&&(st.name=nt.uri);const ot=(_e.samplers||{})[tt.sampler]||{};return st.magFilter=WEBGL_FILTERS[ot.magFilter]||LinearFilter,st.minFilter=WEBGL_FILTERS[ot.minFilter]||LinearMipmapLinearFilter,st.wrapS=WEBGL_WRAPPINGS[ot.wrapS]||RepeatWrapping,st.wrapT=WEBGL_WRAPPINGS[ot.wrapT]||RepeatWrapping,$.associations.set(st,{textures:s}),st}).catch(function(){return null});return this.textureCache[rt]=it,it}loadImageSource(s,o){const j=this,$=this.json,_e=this.options;if(this.sourceCache[s]!==void 0)return this.sourceCache[s].then(at=>at.clone());const tt=$.images[s],nt=self.URL||self.webkitURL;let rt=tt.uri||"",it=!1;if(tt.bufferView!==void 0)rt=j.getDependency("bufferView",tt.bufferView).then(function(at){it=!0;const ot=new Blob([at],{type:tt.mimeType});return rt=nt.createObjectURL(ot),rt});else if(tt.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+s+" is missing URI and bufferView");const st=Promise.resolve(rt).then(function(at){return new Promise(function(ot,ct){let ft=ot;o.isImageBitmapLoader===!0&&(ft=function(ht){const mt=new Texture(ht);mt.needsUpdate=!0,ot(mt)}),o.load(LoaderUtils.resolveURL(at,_e.path),ft,void 0,ct)})}).then(function(at){return it===!0&&nt.revokeObjectURL(rt),at.userData.mimeType=tt.mimeType||getImageURIMimeType(tt.uri),at}).catch(function(at){throw console.error("THREE.GLTFLoader: Couldn't load texture",rt),at});return this.sourceCache[s]=st,st}assignTexture(s,o,j,$){const _e=this;return this.getDependency("texture",j.index).then(function(tt){if(!tt)return null;if(j.texCoord!==void 0&&j.texCoord>0&&(tt=tt.clone(),tt.channel=j.texCoord),_e.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const nt=j.extensions!==void 0?j.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(nt){const rt=_e.associations.get(tt);tt=_e.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(tt,nt),_e.associations.set(tt,rt)}}return $!==void 0&&("colorSpace"in tt?tt.colorSpace=$===3001?"srgb":"srgb-linear":tt.encoding=$),s[o]=tt,tt})}assignFinalMaterial(s){const o=s.geometry;let j=s.material;const $=o.attributes.tangent===void 0,_e=o.attributes.color!==void 0,tt=o.attributes.normal===void 0;if(s.isPoints){const nt="PointsMaterial:"+j.uuid;let rt=this.cache.get(nt);rt||(rt=new PointsMaterial,Material.prototype.copy.call(rt,j),rt.color.copy(j.color),rt.map=j.map,rt.sizeAttenuation=!1,this.cache.add(nt,rt)),j=rt}else if(s.isLine){const nt="LineBasicMaterial:"+j.uuid;let rt=this.cache.get(nt);rt||(rt=new LineBasicMaterial,Material.prototype.copy.call(rt,j),rt.color.copy(j.color),rt.map=j.map,this.cache.add(nt,rt)),j=rt}if($||_e||tt){let nt="ClonedMaterial:"+j.uuid+":";$&&(nt+="derivative-tangents:"),_e&&(nt+="vertex-colors:"),tt&&(nt+="flat-shading:");let rt=this.cache.get(nt);rt||(rt=j.clone(),_e&&(rt.vertexColors=!0),tt&&(rt.flatShading=!0),$&&(rt.normalScale&&(rt.normalScale.y*=-1),rt.clearcoatNormalScale&&(rt.clearcoatNormalScale.y*=-1)),this.cache.add(nt,rt),this.associations.set(rt,this.associations.get(j))),j=rt}s.material=j}getMaterialType(){return MeshStandardMaterial}loadMaterial(s){const o=this,j=this.json,$=this.extensions,_e=j.materials[s];let tt;const nt={},rt=_e.extensions||{},it=[];if(rt[EXTENSIONS.KHR_MATERIALS_UNLIT]){const at=$[EXTENSIONS.KHR_MATERIALS_UNLIT];tt=at.getMaterialType(),it.push(at.extendParams(nt,_e,o))}else{const at=_e.pbrMetallicRoughness||{};if(nt.color=new Color(1,1,1),nt.opacity=1,Array.isArray(at.baseColorFactor)){const ot=at.baseColorFactor;nt.color.fromArray(ot),nt.opacity=ot[3]}at.baseColorTexture!==void 0&&it.push(o.assignTexture(nt,"map",at.baseColorTexture,3001)),nt.metalness=at.metallicFactor!==void 0?at.metallicFactor:1,nt.roughness=at.roughnessFactor!==void 0?at.roughnessFactor:1,at.metallicRoughnessTexture!==void 0&&(it.push(o.assignTexture(nt,"metalnessMap",at.metallicRoughnessTexture)),it.push(o.assignTexture(nt,"roughnessMap",at.metallicRoughnessTexture))),tt=this._invokeOne(function(ot){return ot.getMaterialType&&ot.getMaterialType(s)}),it.push(Promise.all(this._invokeAll(function(ot){return ot.extendMaterialParams&&ot.extendMaterialParams(s,nt)})))}_e.doubleSided===!0&&(nt.side=DoubleSide);const st=_e.alphaMode||ALPHA_MODES.OPAQUE;if(st===ALPHA_MODES.BLEND?(nt.transparent=!0,nt.depthWrite=!1):(nt.transparent=!1,st===ALPHA_MODES.MASK&&(nt.alphaTest=_e.alphaCutoff!==void 0?_e.alphaCutoff:.5)),_e.normalTexture!==void 0&&tt!==MeshBasicMaterial&&(it.push(o.assignTexture(nt,"normalMap",_e.normalTexture)),nt.normalScale=new Vector2(1,1),_e.normalTexture.scale!==void 0)){const at=_e.normalTexture.scale;nt.normalScale.set(at,at)}return _e.occlusionTexture!==void 0&&tt!==MeshBasicMaterial&&(it.push(o.assignTexture(nt,"aoMap",_e.occlusionTexture)),_e.occlusionTexture.strength!==void 0&&(nt.aoMapIntensity=_e.occlusionTexture.strength)),_e.emissiveFactor!==void 0&&tt!==MeshBasicMaterial&&(nt.emissive=new Color().fromArray(_e.emissiveFactor)),_e.emissiveTexture!==void 0&&tt!==MeshBasicMaterial&&it.push(o.assignTexture(nt,"emissiveMap",_e.emissiveTexture,3001)),Promise.all(it).then(function(){const at=new tt(nt);return _e.name&&(at.name=_e.name),assignExtrasToUserData(at,_e),o.associations.set(at,{materials:s}),_e.extensions&&addUnknownExtensionsToUserData($,at,_e),at})}createUniqueName(s){const o=PropertyBinding.sanitizeNodeName(s||"");return o in this.nodeNamesUsed?o+"_"+ ++this.nodeNamesUsed[o]:(this.nodeNamesUsed[o]=0,o)}loadGeometries(s){const o=this,j=this.extensions,$=this.primitiveCache;function _e(nt){return j[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(nt,o).then(function(rt){return addPrimitiveAttributes(rt,nt,o)})}const tt=[];for(let nt=0,rt=s.length;nt<rt;nt++){const it=s[nt],st=createPrimitiveKey(it),at=$[st];if(at)tt.push(at.promise);else{let ot;it.extensions&&it.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?ot=_e(it):ot=addPrimitiveAttributes(new BufferGeometry,it,o),$[st]={primitive:it,promise:ot},tt.push(ot)}}return Promise.all(tt)}loadMesh(s){const o=this,j=this.json,$=this.extensions,_e=j.meshes[s],tt=_e.primitives,nt=[];for(let rt=0,it=tt.length;rt<it;rt++){const st=tt[rt].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",tt[rt].material);nt.push(st)}return nt.push(o.loadGeometries(tt)),Promise.all(nt).then(function(rt){const it=rt.slice(0,rt.length-1),st=rt[rt.length-1],at=[];for(let ct=0,ft=st.length;ct<ft;ct++){const ht=st[ct],mt=tt[ct];let lt;const ut=it[ct];if(mt.mode===WEBGL_CONSTANTS.TRIANGLES||mt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||mt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||mt.mode===void 0)lt=_e.isSkinnedMesh===!0?new SkinnedMesh(ht,ut):new Mesh(ht,ut),lt.isSkinnedMesh===!0&&lt.normalizeSkinWeights(),mt.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?lt.geometry=toTrianglesDrawMode(lt.geometry,TriangleStripDrawMode):mt.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(lt.geometry=toTrianglesDrawMode(lt.geometry,TriangleFanDrawMode));else if(mt.mode===WEBGL_CONSTANTS.LINES)lt=new LineSegments(ht,ut);else if(mt.mode===WEBGL_CONSTANTS.LINE_STRIP)lt=new Line(ht,ut);else if(mt.mode===WEBGL_CONSTANTS.LINE_LOOP)lt=new LineLoop(ht,ut);else if(mt.mode===WEBGL_CONSTANTS.POINTS)lt=new Points(ht,ut);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+mt.mode);Object.keys(lt.geometry.morphAttributes).length>0&&updateMorphTargets(lt,_e),lt.name=o.createUniqueName(_e.name||"mesh_"+s),assignExtrasToUserData(lt,_e),mt.extensions&&addUnknownExtensionsToUserData($,lt,mt),o.assignFinalMaterial(lt),at.push(lt)}for(let ct=0,ft=at.length;ct<ft;ct++)o.associations.set(at[ct],{meshes:s,primitives:ct});if(at.length===1)return _e.extensions&&addUnknownExtensionsToUserData($,at[0],_e),at[0];const ot=new Group;_e.extensions&&addUnknownExtensionsToUserData($,ot,_e),o.associations.set(ot,{meshes:s});for(let ct=0,ft=at.length;ct<ft;ct++)ot.add(at[ct]);return ot})}loadCamera(s){let o;const j=this.json.cameras[s],$=j[j.type];if(!$){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return j.type==="perspective"?o=new PerspectiveCamera(MathUtils.radToDeg($.yfov),$.aspectRatio||1,$.znear||1,$.zfar||2e6):j.type==="orthographic"&&(o=new OrthographicCamera(-$.xmag,$.xmag,$.ymag,-$.ymag,$.znear,$.zfar)),j.name&&(o.name=this.createUniqueName(j.name)),assignExtrasToUserData(o,j),Promise.resolve(o)}loadSkin(s){const o=this.json.skins[s],j=[];for(let $=0,_e=o.joints.length;$<_e;$++)j.push(this._loadNodeShallow(o.joints[$]));return o.inverseBindMatrices!==void 0?j.push(this.getDependency("accessor",o.inverseBindMatrices)):j.push(null),Promise.all(j).then(function($){const _e=$.pop(),tt=$,nt=[],rt=[];for(let it=0,st=tt.length;it<st;it++){const at=tt[it];if(at){nt.push(at);const ot=new Matrix4;_e!==null&&ot.fromArray(_e.array,it*16),rt.push(ot)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[it])}return new Skeleton(nt,rt)})}loadAnimation(s){const j=this.json.animations[s],$=j.name?j.name:"animation_"+s,_e=[],tt=[],nt=[],rt=[],it=[];for(let st=0,at=j.channels.length;st<at;st++){const ot=j.channels[st],ct=j.samplers[ot.sampler],ft=ot.target,ht=ft.node,mt=j.parameters!==void 0?j.parameters[ct.input]:ct.input,lt=j.parameters!==void 0?j.parameters[ct.output]:ct.output;ft.node!==void 0&&(_e.push(this.getDependency("node",ht)),tt.push(this.getDependency("accessor",mt)),nt.push(this.getDependency("accessor",lt)),rt.push(ct),it.push(ft))}return Promise.all([Promise.all(_e),Promise.all(tt),Promise.all(nt),Promise.all(rt),Promise.all(it)]).then(function(st){const at=st[0],ot=st[1],ct=st[2],ft=st[3],ht=st[4],mt=[];for(let lt=0,ut=at.length;lt<ut;lt++){const dt=at[lt],gt=ot[lt],Et=ct[lt],St=ft[lt],Tt=ht[lt];if(dt===void 0)continue;dt.updateMatrix();let Mt;switch(PATH_PROPERTIES[Tt.path]){case PATH_PROPERTIES.weights:Mt=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:Mt=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:Mt=VectorKeyframeTrack;break}const Bt=dt.name?dt.name:dt.uuid,Rt=St.interpolation!==void 0?INTERPOLATION[St.interpolation]:InterpolateLinear,Ut=[];PATH_PROPERTIES[Tt.path]===PATH_PROPERTIES.weights?dt.traverse(function(Wt){Wt.morphTargetInfluences&&Ut.push(Wt.name?Wt.name:Wt.uuid)}):Ut.push(Bt);let Ht=Et.array;if(Et.normalized){const Wt=getNormalizedComponentScale(Ht.constructor),Jt=new Float32Array(Ht.length);for(let sn=0,jt=Ht.length;sn<jt;sn++)Jt[sn]=Ht[sn]*Wt;Ht=Jt}for(let Wt=0,Jt=Ut.length;Wt<Jt;Wt++){const sn=new Mt(Ut[Wt]+"."+PATH_PROPERTIES[Tt.path],gt.array,Ht,Rt);St.interpolation==="CUBICSPLINE"&&(sn.createInterpolant=function(Vt){const Lt=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new Lt(this.times,this.values,this.getValueSize()/3,Vt)},sn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),mt.push(sn)}}return new AnimationClip($,void 0,mt)})}createNodeMesh(s){const o=this.json,j=this,$=o.nodes[s];return $.mesh===void 0?null:j.getDependency("mesh",$.mesh).then(function(_e){const tt=j._getNodeRef(j.meshCache,$.mesh,_e);return $.weights!==void 0&&tt.traverse(function(nt){if(nt.isMesh)for(let rt=0,it=$.weights.length;rt<it;rt++)nt.morphTargetInfluences[rt]=$.weights[rt]}),tt})}loadNode(s){const o=this.json,j=this,$=o.nodes[s],_e=j._loadNodeShallow(s),tt=[],nt=$.children||[];for(let it=0,st=nt.length;it<st;it++)tt.push(j.getDependency("node",nt[it]));const rt=$.skin===void 0?Promise.resolve(null):j.getDependency("skin",$.skin);return Promise.all([_e,Promise.all(tt),rt]).then(function(it){const st=it[0],at=it[1],ot=it[2];ot!==null&&st.traverse(function(ct){ct.isSkinnedMesh&&ct.bind(ot,_identityMatrix)});for(let ct=0,ft=at.length;ct<ft;ct++)st.add(at[ct]);return st})}_loadNodeShallow(s){const o=this.json,j=this.extensions,$=this;if(this.nodeCache[s]!==void 0)return this.nodeCache[s];const _e=o.nodes[s],tt=_e.name?$.createUniqueName(_e.name):"",nt=[],rt=$._invokeOne(function(it){return it.createNodeMesh&&it.createNodeMesh(s)});return rt&&nt.push(rt),_e.camera!==void 0&&nt.push($.getDependency("camera",_e.camera).then(function(it){return $._getNodeRef($.cameraCache,_e.camera,it)})),$._invokeAll(function(it){return it.createNodeAttachment&&it.createNodeAttachment(s)}).forEach(function(it){nt.push(it)}),this.nodeCache[s]=Promise.all(nt).then(function(it){let st;if(_e.isBone===!0?st=new Bone:it.length>1?st=new Group:it.length===1?st=it[0]:st=new Object3D,st!==it[0])for(let at=0,ot=it.length;at<ot;at++)st.add(it[at]);if(_e.name&&(st.userData.name=_e.name,st.name=tt),assignExtrasToUserData(st,_e),_e.extensions&&addUnknownExtensionsToUserData(j,st,_e),_e.matrix!==void 0){const at=new Matrix4;at.fromArray(_e.matrix),st.applyMatrix4(at)}else _e.translation!==void 0&&st.position.fromArray(_e.translation),_e.rotation!==void 0&&st.quaternion.fromArray(_e.rotation),_e.scale!==void 0&&st.scale.fromArray(_e.scale);return $.associations.has(st)||$.associations.set(st,{}),$.associations.get(st).nodes=s,st}),this.nodeCache[s]}loadScene(s){const o=this.extensions,j=this.json.scenes[s],$=this,_e=new Group;j.name&&(_e.name=$.createUniqueName(j.name)),assignExtrasToUserData(_e,j),j.extensions&&addUnknownExtensionsToUserData(o,_e,j);const tt=j.nodes||[],nt=[];for(let rt=0,it=tt.length;rt<it;rt++)nt.push($.getDependency("node",tt[rt]));return Promise.all(nt).then(function(rt){for(let st=0,at=rt.length;st<at;st++)_e.add(rt[st]);const it=st=>{const at=new Map;for(const[ot,ct]of $.associations)(ot instanceof Material||ot instanceof Texture)&&at.set(ot,ct);return st.traverse(ot=>{const ct=$.associations.get(ot);ct!=null&&at.set(ot,ct)}),at};return $.associations=it(_e),_e})}}function computeBounds(a,s,o){const j=s.attributes,$=new Box3;if(j.POSITION!==void 0){const nt=o.json.accessors[j.POSITION],rt=nt.min,it=nt.max;if(rt!==void 0&&it!==void 0){if($.set(new Vector3(rt[0],rt[1],rt[2]),new Vector3(it[0],it[1],it[2])),nt.normalized){const st=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[nt.componentType]);$.min.multiplyScalar(st),$.max.multiplyScalar(st)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const _e=s.targets;if(_e!==void 0){const nt=new Vector3,rt=new Vector3;for(let it=0,st=_e.length;it<st;it++){const at=_e[it];if(at.POSITION!==void 0){const ot=o.json.accessors[at.POSITION],ct=ot.min,ft=ot.max;if(ct!==void 0&&ft!==void 0){if(rt.setX(Math.max(Math.abs(ct[0]),Math.abs(ft[0]))),rt.setY(Math.max(Math.abs(ct[1]),Math.abs(ft[1]))),rt.setZ(Math.max(Math.abs(ct[2]),Math.abs(ft[2]))),ot.normalized){const ht=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[ot.componentType]);rt.multiplyScalar(ht)}nt.max(rt)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}$.expandByVector(nt)}a.boundingBox=$;const tt=new Sphere;$.getCenter(tt.center),tt.radius=$.min.distanceTo($.max)/2,a.boundingSphere=tt}function addPrimitiveAttributes(a,s,o){const j=s.attributes,$=[];function _e(tt,nt){return o.getDependency("accessor",tt).then(function(rt){a.setAttribute(nt,rt)})}for(const tt in j){const nt=ATTRIBUTES[tt]||tt.toLowerCase();nt in a.attributes||$.push(_e(j[tt],nt))}if(s.indices!==void 0&&!a.index){const tt=o.getDependency("accessor",s.indices).then(function(nt){a.setIndex(nt)});$.push(tt)}return assignExtrasToUserData(a,s),computeBounds(a,s,o),Promise.all($).then(function(){return s.targets!==void 0?addMorphTargets(a,s.targets,o):a})}const DEFAULT_HAND_PROFILE_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/";class XRHandMeshModel{constructor(s,o,j=DEFAULT_HAND_PROFILE_PATH,$,_e){__publicField(this,"controller"),__publicField(this,"handModel"),__publicField(this,"bones"),this.controller=o,this.handModel=s,this.bones=[];const tt=new GLTFLoader;_e||tt.setPath(j),tt.load(_e??`${$}.glb`,nt=>{const rt=nt.scene.children[0];this.handModel.add(rt);const it=rt.getObjectByProperty("type","SkinnedMesh");it.frustumCulled=!1,it.castShadow=!0,it.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach(at=>{const ot=rt.getObjectByName(at);ot!==void 0?ot.jointName=at:console.warn(`Couldn't find ${at} in ${$} hand mesh`),this.bones.push(ot)})})}updateMesh(){const s=this.controller.joints;for(let o=0;o<this.bones.length;o++){const j=this.bones[o];if(j){const $=s[j.jointName];if($.visible){const _e=$.position;j.position.copy(_e),j.quaternion.copy($.quaternion)}}}}}const TOUCH_RADIUS=.01,POINTING_JOINT="index-finger-tip";class OculusHandModel extends Object3D{constructor(s,o,j){super(),__publicField(this,"controller"),__publicField(this,"motionController"),__publicField(this,"envMap"),__publicField(this,"mesh"),__publicField(this,"xrInputSource"),this.controller=s,this.motionController=null,this.envMap=null,this.mesh=null,this.xrInputSource=null,s.addEventListener("connected",$=>{const _e=$.data;_e.hand&&!this.motionController&&(this.xrInputSource=_e,this.motionController=new XRHandMeshModel(this,s,void 0,_e.handedness,_e.handedness==="left"?o:j))}),s.addEventListener("disconnected",()=>{this.dispose()})}updateMatrixWorld(s){super.updateMatrixWorld(s),this.motionController&&this.motionController.updateMesh()}getPointerPosition(){const s=this.controller.joints[POINTING_JOINT];return s?s.position:null}intersectBoxObject(s){const o=this.getPointerPosition();if(o){const j=new Sphere(o,TOUCH_RADIUS),$=new Box3().setFromObject(s);return j.intersectsBox($)}else return!1}checkButton(s){this.intersectBoxObject(s)?s.onPress():s.onClear(),s.isPressed()&&s.whilePressed()}dispose(){this.clear(),this.motionController=null}}const MotionControllerConstants={Handedness:{NONE:"none",LEFT:"left",RIGHT:"right"},ComponentState:{DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"},ComponentProperty:{BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"},ComponentType:{TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"},ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:{TRANSFORM:"transform",VISIBILITY:"visibility"}},applyEnvironmentMap=(a,s)=>{s.traverse(o=>{o instanceof Mesh&&"envMap"in o.material&&(o.material.envMap=a,o.material.needsUpdate=!0)})};class XRControllerModel extends Object3D{constructor(){super(),__publicField(this,"envMap"),__publicField(this,"motionController"),this.motionController=null,this.envMap=null}setEnvironmentMap(s){return this.envMap==s?this:(this.envMap=s,applyEnvironmentMap(this.envMap,this),this)}updateMatrixWorld(s){super.updateMatrixWorld(s),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(o=>{Object.values(o.visualResponses).forEach(j=>{const{valueNode:$,minNode:_e,maxNode:tt,value:nt,valueNodeProperty:rt}=j;$&&(rt===MotionControllerConstants.VisualResponseProperty.VISIBILITY&&typeof nt=="boolean"?$.visible=nt:rt===MotionControllerConstants.VisualResponseProperty.TRANSFORM&&_e&&tt&&typeof nt=="number"&&($.quaternion.slerpQuaternions(_e.quaternion,tt.quaternion,nt),$.position.lerpVectors(_e.position,tt.position,nt)))})}))}}class SessionLightProbe{constructor(s,o,j,$,_e){this.xrLight=s,this.renderer=o,this.lightProbe=j,this.xrWebGLBinding=null,this.estimationStartCallback=_e,this.frameCallback=this.onXRFrame.bind(this);const tt=o.xr.getSession();if($&&"XRWebGLBinding"in window){const nt=new WebGLCubeRenderTarget(16);s.environment=nt.texture;const rt=o.getContext();switch(tt.preferredReflectionFormat){case"srgba8":rt.getExtension("EXT_sRGB");break;case"rgba16f":rt.getExtension("OES_texture_half_float");break}this.xrWebGLBinding=new XRWebGLBinding(tt,rt),this.lightProbe.addEventListener("reflectionchange",()=>{this.updateReflection()})}tt.requestAnimationFrame(this.frameCallback)}updateReflection(){const s=this.renderer.properties.get(this.xrLight.environment);if(s){const o=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);o&&(s.__webglTexture=o,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(s,o){if(!this.xrLight)return;o.session.requestAnimationFrame(this.frameCallback);const $=o.getLightEstimate(this.lightProbe);if($){this.xrLight.lightProbe.sh.fromArray($.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const _e=Math.max(1,Math.max($.primaryLightIntensity.x,Math.max($.primaryLightIntensity.y,$.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB($.primaryLightIntensity.x/_e,$.primaryLightIntensity.y/_e,$.primaryLightIntensity.z/_e),this.xrLight.directionalLight.intensity=_e,this.xrLight.directionalLight.position.copy($.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class XREstimatedLight extends Group{constructor(s,o=!0){super(),this.lightProbe=new LightProbe,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new DirectionalLight,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let j=null,$=!1;s.xr.addEventListener("sessionstart",()=>{const _e=s.xr.getSession();"requestLightProbe"in _e&&_e.requestLightProbe({reflectionFormat:_e.preferredReflectionFormat}).then(tt=>{j=new SessionLightProbe(this,s,tt,o,()=>{$=!0,this.dispatchEvent({type:"estimationstart"})})})}),s.xr.addEventListener("sessionend",()=>{j&&(j.dispose(),j=null),$&&this.dispatchEvent({type:"estimationend"})}),this.dispose=()=>{j&&(j.dispose(),j=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}class XRHandModel extends Object3D{constructor(s){super(),this.controller=s,this.motionController=null,this.envMap=null,this.mesh=null}updateMatrixWorld(s){super.updateMatrixWorld(s),this.motionController&&this.motionController.updateMesh()}}class ParametricGeometry extends BufferGeometry{constructor(s=($,_e,tt)=>tt.set($,_e,Math.cos($)*Math.sin(_e)),o=8,j=8){super(),this.type="ParametricGeometry",this.parameters={func:s,slices:o,stacks:j};const $=[],_e=[],tt=[],nt=[],rt=1e-5,it=new Vector3,st=new Vector3,at=new Vector3,ot=new Vector3,ct=new Vector3,ft=o+1;for(let ht=0;ht<=j;ht++){const mt=ht/j;for(let lt=0;lt<=o;lt++){const ut=lt/o;s(ut,mt,st),_e.push(st.x,st.y,st.z),ut-rt>=0?(s(ut-rt,mt,at),ot.subVectors(st,at)):(s(ut+rt,mt,at),ot.subVectors(at,st)),mt-rt>=0?(s(ut,mt-rt,at),ct.subVectors(st,at)):(s(ut,mt+rt,at),ct.subVectors(at,st)),it.crossVectors(ot,ct).normalize(),tt.push(it.x,it.y,it.z),nt.push(ut,mt)}}for(let ht=0;ht<j;ht++)for(let mt=0;mt<o;mt++){const lt=ht*ft+mt,ut=ht*ft+mt+1,dt=(ht+1)*ft+mt+1,gt=(ht+1)*ft+mt;$.push(lt,ut,gt),$.push(ut,dt,gt)}this.setIndex($),this.setAttribute("position",new Float32BufferAttribute(_e,3)),this.setAttribute("normal",new Float32BufferAttribute(tt,3)),this.setAttribute("uv",new Float32BufferAttribute(nt,2))}}const tempNormal=new Vector3;function getUv(a,s,o,j,$,_e){const tt=2*Math.PI*$/4,nt=Math.max(_e-2*$,0),rt=Math.PI/4;tempNormal.copy(s),tempNormal[j]=0,tempNormal.normalize();const it=.5*tt/(tt+nt),st=1-tempNormal.angleTo(a)/rt;return Math.sign(tempNormal[o])===1?st*it:nt/(tt+nt)+it+it*(1-st)}class RoundedBoxGeometry extends BoxGeometry{constructor(s=1,o=1,j=1,$=2,_e=.1){if($=$*2+1,_e=Math.min(s/2,o/2,j/2,_e),super(1,1,1,$,$,$),$===1)return;const tt=this.toNonIndexed();this.index=null,this.attributes.position=tt.attributes.position,this.attributes.normal=tt.attributes.normal,this.attributes.uv=tt.attributes.uv;const nt=new Vector3,rt=new Vector3,it=new Vector3(s,o,j).divideScalar(2).subScalar(_e),st=this.attributes.position.array,at=this.attributes.normal.array,ot=this.attributes.uv.array,ct=st.length/6,ft=new Vector3,ht=.5/$;for(let mt=0,lt=0;mt<st.length;mt+=3,lt+=2)switch(nt.fromArray(st,mt),rt.copy(nt),rt.x-=Math.sign(rt.x)*ht,rt.y-=Math.sign(rt.y)*ht,rt.z-=Math.sign(rt.z)*ht,rt.normalize(),st[mt+0]=it.x*Math.sign(nt.x)+rt.x*_e,st[mt+1]=it.y*Math.sign(nt.y)+rt.y*_e,st[mt+2]=it.z*Math.sign(nt.z)+rt.z*_e,at[mt+0]=rt.x,at[mt+1]=rt.y,at[mt+2]=rt.z,Math.floor(mt/ct)){case 0:ft.set(1,0,0),ot[lt+0]=getUv(ft,rt,"z","y",_e,j),ot[lt+1]=1-getUv(ft,rt,"y","z",_e,o);break;case 1:ft.set(-1,0,0),ot[lt+0]=1-getUv(ft,rt,"z","y",_e,j),ot[lt+1]=1-getUv(ft,rt,"y","z",_e,o);break;case 2:ft.set(0,1,0),ot[lt+0]=1-getUv(ft,rt,"x","z",_e,s),ot[lt+1]=getUv(ft,rt,"z","x",_e,j);break;case 3:ft.set(0,-1,0),ot[lt+0]=1-getUv(ft,rt,"x","z",_e,s),ot[lt+1]=1-getUv(ft,rt,"z","x",_e,j);break;case 4:ft.set(0,0,1),ot[lt+0]=1-getUv(ft,rt,"x","y",_e,s),ot[lt+1]=1-getUv(ft,rt,"y","x",_e,o);break;case 5:ft.set(0,0,-1),ot[lt+0]=getUv(ft,rt,"x","y",_e,s),ot[lt+1]=1-getUv(ft,rt,"y","x",_e,o);break}}}class BoxLineGeometry extends BufferGeometry{constructor(s,o,j,$,_e,tt){super(),s=s||1,o=o||1,j=j||1,$=Math.floor($)||1,_e=Math.floor(_e)||1,tt=Math.floor(tt)||1;const nt=s/2,rt=o/2,it=j/2,st=s/$,at=o/_e,ot=j/tt,ct=[];let ft=-nt,ht=-rt,mt=-it;for(let lt=0;lt<=$;lt++)ct.push(ft,-rt,-it,ft,rt,-it),ct.push(ft,rt,-it,ft,rt,it),ct.push(ft,rt,it,ft,-rt,it),ct.push(ft,-rt,it,ft,-rt,-it),ft+=st;for(let lt=0;lt<=_e;lt++)ct.push(-nt,ht,-it,nt,ht,-it),ct.push(nt,ht,-it,nt,ht,it),ct.push(nt,ht,it,-nt,ht,it),ct.push(-nt,ht,it,-nt,ht,-it),ht+=at;for(let lt=0;lt<=tt;lt++)ct.push(-nt,-rt,mt,-nt,rt,mt),ct.push(-nt,rt,mt,nt,rt,mt),ct.push(nt,rt,mt,nt,-rt,mt),ct.push(nt,-rt,mt,-nt,-rt,mt),mt+=ot;this.setAttribute("position",new Float32BufferAttribute(ct,3))}}class DecalGeometry extends BufferGeometry{constructor(s,o,j,$){super();const _e=[],tt=[],nt=[],rt=new Vector3,it=new Matrix4;it.makeRotationFromEuler(j),it.setPosition(o);const st=new Matrix4;st.copy(it).invert(),at(),this.setAttribute("position",new Float32BufferAttribute(_e,3)),this.setAttribute("normal",new Float32BufferAttribute(tt,3)),this.setAttribute("uv",new Float32BufferAttribute(nt,2));function at(){let ht,mt=[];const lt=new Vector3,ut=new Vector3;if(s.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const dt=s.geometry,gt=dt.attributes.position,Et=dt.attributes.normal;if(dt.index!==null){const St=dt.index;for(ht=0;ht<St.count;ht++)lt.fromBufferAttribute(gt,St.getX(ht)),ut.fromBufferAttribute(Et,St.getX(ht)),ot(mt,lt,ut)}else for(ht=0;ht<gt.count;ht++)lt.fromBufferAttribute(gt,ht),ut.fromBufferAttribute(Et,ht),ot(mt,lt,ut);for(mt=ct(mt,rt.set(1,0,0)),mt=ct(mt,rt.set(-1,0,0)),mt=ct(mt,rt.set(0,1,0)),mt=ct(mt,rt.set(0,-1,0)),mt=ct(mt,rt.set(0,0,1)),mt=ct(mt,rt.set(0,0,-1)),ht=0;ht<mt.length;ht++){const St=mt[ht];nt.push(.5+St.position.x/$.x,.5+St.position.y/$.y),St.position.applyMatrix4(it),_e.push(St.position.x,St.position.y,St.position.z),tt.push(St.normal.x,St.normal.y,St.normal.z)}}function ot(ht,mt,lt){mt.applyMatrix4(s.matrixWorld),mt.applyMatrix4(st),lt.transformDirection(s.matrixWorld),ht.push(new DecalVertex(mt.clone(),lt.clone()))}function ct(ht,mt){const lt=[],ut=.5*Math.abs($.dot(mt));for(let dt=0;dt<ht.length;dt+=3){let gt,Et,St,Tt=0,Mt,Bt,Rt,Ut;const Ht=ht[dt+0].position.dot(mt)-ut,Wt=ht[dt+1].position.dot(mt)-ut,Jt=ht[dt+2].position.dot(mt)-ut;switch(gt=Ht>0,Et=Wt>0,St=Jt>0,Tt=(gt?1:0)+(Et?1:0)+(St?1:0),Tt){case 0:{lt.push(ht[dt]),lt.push(ht[dt+1]),lt.push(ht[dt+2]);break}case 1:{if(gt&&(Mt=ht[dt+1],Bt=ht[dt+2],Rt=ft(ht[dt],Mt,mt,ut),Ut=ft(ht[dt],Bt,mt,ut)),Et){Mt=ht[dt],Bt=ht[dt+2],Rt=ft(ht[dt+1],Mt,mt,ut),Ut=ft(ht[dt+1],Bt,mt,ut),lt.push(Rt),lt.push(Bt.clone()),lt.push(Mt.clone()),lt.push(Bt.clone()),lt.push(Rt.clone()),lt.push(Ut);break}St&&(Mt=ht[dt],Bt=ht[dt+1],Rt=ft(ht[dt+2],Mt,mt,ut),Ut=ft(ht[dt+2],Bt,mt,ut)),lt.push(Mt.clone()),lt.push(Bt.clone()),lt.push(Rt),lt.push(Ut),lt.push(Rt.clone()),lt.push(Bt.clone());break}case 2:{gt||(Mt=ht[dt].clone(),Bt=ft(Mt,ht[dt+1],mt,ut),Rt=ft(Mt,ht[dt+2],mt,ut),lt.push(Mt),lt.push(Bt),lt.push(Rt)),Et||(Mt=ht[dt+1].clone(),Bt=ft(Mt,ht[dt+2],mt,ut),Rt=ft(Mt,ht[dt],mt,ut),lt.push(Mt),lt.push(Bt),lt.push(Rt)),St||(Mt=ht[dt+2].clone(),Bt=ft(Mt,ht[dt],mt,ut),Rt=ft(Mt,ht[dt+1],mt,ut),lt.push(Mt),lt.push(Bt),lt.push(Rt));break}}}return lt}function ft(ht,mt,lt,ut){const dt=ht.position.dot(lt)-ut,gt=mt.position.dot(lt)-ut,Et=dt/(dt-gt);return new DecalVertex(new Vector3(ht.position.x+Et*(mt.position.x-ht.position.x),ht.position.y+Et*(mt.position.y-ht.position.y),ht.position.z+Et*(mt.position.z-ht.position.z)),new Vector3(ht.normal.x+Et*(mt.normal.x-ht.normal.x),ht.normal.y+Et*(mt.normal.y-ht.normal.y),ht.normal.z+Et*(mt.normal.z-ht.normal.z)))}}}class DecalVertex{constructor(s,o){this.position=s,this.normal=o}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}class TeapotGeometry extends BufferGeometry{constructor(s,o,j,$,_e,tt,nt){const rt=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],it=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];super(),s=s||50,o=o!==void 0?Math.max(2,Math.floor(o)||10):10,j=j===void 0?!0:j,$=$===void 0?!0:$,_e=_e===void 0?!0:_e,tt=tt===void 0?!0:tt;const st=1.3;nt=nt===void 0?!0:nt;const ot=3.15*(nt?1:st)/2,ct=s/ot;let ft=j?(8*o-4)*o:0;ft+=$?(16*o-4)*o:0,ft+=_e?40*o*o:0;const ht=new Uint32Array(ft*3);let mt=j?4:0;mt+=$?8:0,mt+=_e?20:0,mt*=(o+1)*(o+1);const lt=new Float32Array(mt*3),ut=new Float32Array(mt*3),dt=new Float32Array(mt*2),gt=new Matrix4;gt.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);const Et=[];let St,Tt,Mt;const Bt=[],Rt=[],Ut=[],Ht=[],Wt=[],Jt=[],sn=[],jt=[],Vt=new Vector3;let Lt,Qt,nn,mn,Zt,cn,Ot,rn,fn,hn=0,Tn=0;const Nn=new Vector3;let Pn,Dn,ln,Cn;const bn=new Matrix4,kn=new Matrix4,Sn=new Vector4,xn=new Vector4,Qn=new Vector4,nr=new Vector4,or=new Vector3,mr=new Vector3,$n=gt.clone();$n.transpose();const tn=(Mn,tr,gr)=>!(lt[Mn*3]===lt[tr*3]&&lt[Mn*3+1]===lt[tr*3+1]&&lt[Mn*3+2]===lt[tr*3+2]||lt[Mn*3]===lt[gr*3]&&lt[Mn*3+1]===lt[gr*3+1]&&lt[Mn*3+2]===lt[gr*3+2]||lt[tr*3]===lt[gr*3]&&lt[tr*3+1]===lt[gr*3+1]&&lt[tr*3+2]===lt[gr*3+2]);for(St=0;St<3;St++)Wt[St]=new Matrix4;const $t=_e?0:20,An=j?32:28;mn=o+1;let En=0,In=0,Hn=0,yn=0,On=0;for(let Mn=$t;Mn<An;Mn++)if($||Mn<20||Mn>=28){for(St=0;St<3;St++){for(Tt=0;Tt<4;Tt++)for(Mt=0;Mt<4;Mt++)Et[Mt*4+Tt]=it[rt[Mn*16+Tt*4+Mt]*3+St],tt&&Mn>=20&&Mn<28&&St!==2&&(Et[Mt*4+Tt]*=1.077),!nt&&St===2&&(Et[Mt*4+Tt]*=st);bn.set(Et[0],Et[1],Et[2],Et[3],Et[4],Et[5],Et[6],Et[7],Et[8],Et[9],Et[10],Et[11],Et[12],Et[13],Et[14],Et[15]),kn.multiplyMatrices(bn,gt),Wt[St].multiplyMatrices($n,kn)}for(Qt=0;Qt<=o;Qt++)for(Zt=Qt/o,nn=0;nn<=o;nn++){for(cn=nn/o,fn=4,Ot=rn=1;fn--;)Bt[fn]=Ot,Rt[fn]=rn,Ot*=Zt,rn*=cn,fn===3?(Ut[fn]=Ht[fn]=0,hn=Tn=1):(Ut[fn]=hn*(3-fn),Ht[fn]=Tn*(3-fn),hn*=Zt,Tn*=cn);for(Sn.fromArray(Bt),xn.fromArray(Rt),Qn.fromArray(Ut),nr.fromArray(Ht),St=0;St<3;St++)Lt=Sn.clone(),Lt.applyMatrix4(Wt[St]),Jt[St]=Lt.dot(xn),Lt=Qn.clone(),Lt.applyMatrix4(Wt[St]),sn[St]=Lt.dot(xn),Lt=Sn.clone(),Lt.applyMatrix4(Wt[St]),jt[St]=Lt.dot(nr);or.fromArray(sn),mr.fromArray(jt),Vt.crossVectors(mr,or),Vt.normalize(),Jt[0]===0&&Jt[1]===0?Nn.set(0,Jt[2]>ot?1:-1,0):Nn.set(Vt.x,Vt.z,-Vt.y),lt[In++]=ct*Jt[0],lt[In++]=ct*(Jt[2]-ot),lt[In++]=-ct*Jt[1],ut[Hn++]=Nn.x,ut[Hn++]=Nn.y,ut[Hn++]=Nn.z,dt[yn++]=1-cn,dt[yn++]=1-Zt}for(Qt=0;Qt<o;Qt++)for(nn=0;nn<o;nn++)Pn=En*mn*mn+Qt*mn+nn,Dn=Pn+1,ln=Dn+mn,Cn=Pn+mn,tn(Pn,Dn,ln)&&(ht[On++]=Pn,ht[On++]=Dn,ht[On++]=ln),tn(Pn,ln,Cn)&&(ht[On++]=Pn,ht[On++]=ln,ht[On++]=Cn);En++}this.setIndex(new BufferAttribute(ht,1)),this.setAttribute("position",new BufferAttribute(lt,3)),this.setAttribute("normal",new BufferAttribute(ut,3)),this.setAttribute("uv",new BufferAttribute(dt,2)),this.computeBoundingSphere()}}class TextGeometry extends ExtrudeGeometry{constructor(s,o={}){const{bevelEnabled:j=!1,bevelSize:$=8,bevelThickness:_e=10,font:tt,height:nt=50,size:rt=100,lineHeight:it=1,letterSpacing:st=0,...at}=o;if(tt===void 0)super();else{const ot=tt.generateShapes(s,rt,{lineHeight:it,letterSpacing:st});super(ot,{...at,bevelEnabled:j,bevelSize:$,bevelThickness:_e,depth:nt})}this.type="TextGeometry"}}class CSMHelper extends Group{constructor(s){super(),this.csm=s,this.displayFrustum=!0,this.displayPlanes=!0,this.displayShadowBounds=!0;const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),j=new Float32Array(24),$=new BufferGeometry;$.setIndex(new BufferAttribute(o,1)),$.setAttribute("position",new BufferAttribute(j,3,!1));const _e=new LineSegments($,new LineBasicMaterial);this.add(_e),this.frustumLines=_e,this.cascadeLines=[],this.cascadePlanes=[],this.shadowLines=[]}updateVisibility(){const s=this.displayFrustum,o=this.displayPlanes,j=this.displayShadowBounds,$=this.frustumLines,_e=this.cascadeLines,tt=this.cascadePlanes,nt=this.shadowLines;for(let rt=0,it=_e.length;rt<it;rt++){const st=_e[rt],at=tt[rt],ot=nt[rt];st.visible=s,at.visible=s&&o,ot.visible=j}$.visible=s}update(){const s=this.csm,o=s.camera,j=s.cascades,$=s.mainFrustum,_e=s.frustums,tt=s.lights,rt=this.frustumLines.geometry.getAttribute("position"),it=this.cascadeLines,st=this.cascadePlanes,at=this.shadowLines;for(this.position.copy(o.position),this.quaternion.copy(o.quaternion),this.scale.copy(o.scale),this.updateMatrixWorld(!0);it.length>j;)this.remove(it.pop()),this.remove(st.pop()),this.remove(at.pop());for(;it.length<j;){const ft=new Box3Helper(new Box3,16777215),ht=new MeshBasicMaterial({transparent:!0,opacity:.1,depthWrite:!1,side:DoubleSide}),mt=new Mesh(new PlaneGeometry,ht),lt=new Group,ut=new Box3Helper(new Box3,16776960);lt.add(ut),this.add(ft),this.add(mt),this.add(lt),it.push(ft),st.push(mt),at.push(lt)}for(let ft=0;ft<j;ft++){const ht=_e[ft],lt=tt[ft].shadow.camera,ut=ht.vertices.far,dt=it[ft],gt=st[ft],Et=at[ft],St=Et.children[0];dt.box.min.copy(ut[2]),dt.box.max.copy(ut[0]),dt.box.max.z+=1e-4,gt.position.addVectors(ut[0],ut[2]),gt.position.multiplyScalar(.5),gt.scale.subVectors(ut[0],ut[2]),gt.scale.z=1e-4,this.remove(Et),Et.position.copy(lt.position),Et.quaternion.copy(lt.quaternion),Et.scale.copy(lt.scale),Et.updateMatrixWorld(!0),this.attach(Et),St.box.min.set(lt.bottom,lt.left,-lt.far),St.box.max.set(lt.top,lt.right,-lt.near)}const ot=$.vertices.near,ct=$.vertices.far;rt.setXYZ(0,ct[0].x,ct[0].y,ct[0].z),rt.setXYZ(1,ct[3].x,ct[3].y,ct[3].z),rt.setXYZ(2,ct[2].x,ct[2].y,ct[2].z),rt.setXYZ(3,ct[1].x,ct[1].y,ct[1].z),rt.setXYZ(4,ot[0].x,ot[0].y,ot[0].z),rt.setXYZ(5,ot[3].x,ot[3].y,ot[3].z),rt.setXYZ(6,ot[2].x,ot[2].y,ot[2].z),rt.setXYZ(7,ot[1].x,ot[1].y,ot[1].z),rt.needsUpdate=!0}}const HorizontalBlurShader={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},VerticalBlurShader={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class HTMLMesh extends Mesh{constructor(s){const o=new HTMLTexture(s),j=new PlaneGeometry(o.image.width*.001,o.image.height*.001),$=new MeshBasicMaterial({map:o,toneMapped:!1,transparent:!0});super(j,$);function _e(tt){$.map.dispatchDOMEvent(tt)}this.addEventListener("mousedown",_e),this.addEventListener("mousemove",_e),this.addEventListener("mouseup",_e),this.addEventListener("click",_e),this.dispose=function(){j.dispose(),$.dispose(),$.map.dispose(),canvases.delete(s),this.removeEventListener("mousedown",_e),this.removeEventListener("mousemove",_e),this.removeEventListener("mouseup",_e),this.removeEventListener("click",_e)}}}class HTMLTexture extends CanvasTexture{constructor(s){super(html2canvas(s)),this.dom=s,this.anisotropy=16,"colorSpace"in this?this.colorSpace="srgb":this.encoding=3001,this.minFilter=LinearFilter,this.magFilter=LinearFilter;const o=new MutationObserver(()=>{this.scheduleUpdate||(this.scheduleUpdate=setTimeout(()=>this.update(),16))}),j={attributes:!0,childList:!0,subtree:!0,characterData:!0};o.observe(s,j),this.observer=o}dispatchDOMEvent(s){s.data&&htmlevent(this.dom,s.type,s.data.x,s.data.y)}update(){this.image=html2canvas(this.dom),this.needsUpdate=!0,this.scheduleUpdate=null}dispose(){this.observer&&this.observer.disconnect(),this.scheduleUpdate=clearTimeout(this.scheduleUpdate),super.dispose()}}const canvases=new WeakMap;function html2canvas(a){const s=document.createRange(),o=new Color;function j(ot){const ct=[];let ft=!1;function ht(){if(ft&&(ft=!1,ot.restore()),ct.length===0)return;let mt=-1/0,lt=-1/0,ut=1/0,dt=1/0;for(let gt=0;gt<ct.length;gt++){const Et=ct[gt];mt=Math.max(mt,Et.x),lt=Math.max(lt,Et.y),ut=Math.min(ut,Et.x+Et.width),dt=Math.min(dt,Et.y+Et.height)}ot.save(),ot.beginPath(),ot.rect(mt,lt,ut-mt,dt-lt),ot.clip(),ft=!0}return{add:function(mt){ct.push(mt),ht()},remove:function(){ct.pop(),ht()}}}function $(ot,ct,ft,ht){ht!==""&&(ot.textTransform==="uppercase"&&(ht=ht.toUpperCase()),st.font=ot.fontWeight+" "+ot.fontSize+" "+ot.fontFamily,st.textBaseline="top",st.fillStyle=ot.color,st.fillText(ht,ct,ft+parseFloat(ot.fontSize)*.1))}function _e(ot,ct,ft,ht,mt){ft<2*mt&&(mt=ft/2),ht<2*mt&&(mt=ht/2),st.beginPath(),st.moveTo(ot+mt,ct),st.arcTo(ot+ft,ct,ot+ft,ct+ht,mt),st.arcTo(ot+ft,ct+ht,ot,ct+ht,mt),st.arcTo(ot,ct+ht,ot,ct,mt),st.arcTo(ot,ct,ot+ft,ct,mt),st.closePath()}function tt(ot,ct,ft,ht,mt,lt){const ut=ot[ct+"Width"],dt=ot[ct+"Style"],gt=ot[ct+"Color"];ut!=="0px"&&dt!=="none"&&gt!=="transparent"&&gt!=="rgba(0, 0, 0, 0)"&&(st.strokeStyle=gt,st.lineWidth=parseFloat(ut),st.beginPath(),st.moveTo(ft,ht),st.lineTo(ft+mt,ht+lt),st.stroke())}function nt(ot,ct){let ft=0,ht=0,mt=0,lt=0;if(ot.nodeType===Node.TEXT_NODE){s.selectNode(ot);const dt=s.getBoundingClientRect();ft=dt.left-rt.left-.5,ht=dt.top-rt.top-.5,mt=dt.width,lt=dt.height,$(ct,ft,ht,ot.nodeValue.trim())}else{if(ot.nodeType===Node.COMMENT_NODE)return;if(ot instanceof HTMLCanvasElement){if(ot.style.display==="none")return;st.save();const dt=window.devicePixelRatio;st.scale(1/dt,1/dt),st.drawImage(ot,0,0),st.restore()}else{if(ot.style.display==="none")return;const dt=ot.getBoundingClientRect();ft=dt.left-rt.left-.5,ht=dt.top-rt.top-.5,mt=dt.width,lt=dt.height,ct=window.getComputedStyle(ot),_e(ft,ht,mt,lt,parseFloat(ct.borderRadius));const gt=ct.backgroundColor;gt!=="transparent"&&gt!=="rgba(0, 0, 0, 0)"&&(st.fillStyle=gt,st.fill());const Et=["borderTop","borderLeft","borderBottom","borderRight"];let St=!0,Tt=null;for(const Mt of Et){if(Tt!==null&&(St=ct[Mt+"Width"]===ct[Tt+"Width"]&&ct[Mt+"Color"]===ct[Tt+"Color"]&&ct[Mt+"Style"]===ct[Tt+"Style"]),St===!1)break;Tt=Mt}if(St===!0){const Mt=parseFloat(ct.borderTopWidth);ct.borderTopWidth!=="0px"&&ct.borderTopStyle!=="none"&&ct.borderTopColor!=="transparent"&&ct.borderTopColor!=="rgba(0, 0, 0, 0)"&&(st.strokeStyle=ct.borderTopColor,st.lineWidth=Mt,st.stroke())}else tt(ct,"borderTop",ft,ht,mt,0),tt(ct,"borderLeft",ft,ht,0,lt),tt(ct,"borderBottom",ft,ht+lt,mt,0),tt(ct,"borderRight",ft+mt,ht,0,lt);if(ot instanceof HTMLInputElement){let Mt=ct.accentColor;(Mt===void 0||Mt==="auto")&&(Mt=ct.color),o.set(Mt);const Rt=Math.sqrt(.299*o.r**2+.587*o.g**2+.114*o.b**2)<.5?"white":"#111111";if(ot.type==="radio"&&(_e(ft,ht,mt,lt,lt),st.fillStyle="white",st.strokeStyle=Mt,st.lineWidth=1,st.fill(),st.stroke(),ot.checked&&(_e(ft+2,ht+2,mt-4,lt-4,lt),st.fillStyle=Mt,st.strokeStyle=Rt,st.lineWidth=2,st.fill(),st.stroke())),ot.type==="checkbox"&&(_e(ft,ht,mt,lt,2),st.fillStyle=ot.checked?Mt:"white",st.strokeStyle=ot.checked?Rt:Mt,st.lineWidth=1,st.stroke(),st.fill(),ot.checked)){const Ut=st.textAlign;st.textAlign="center";const Ht={color:Rt,fontFamily:ct.fontFamily,fontSize:lt+"px",fontWeight:"bold"};$(Ht,ft+mt/2,ht,"✔"),st.textAlign=Ut}if(ot.type==="range"){const[Ut,Ht,Wt]=["min","max","value"].map(sn=>parseFloat(ot[sn])),Jt=(Wt-Ut)/(Ht-Ut)*(mt-lt);_e(ft,ht+lt/4,mt,lt/2,lt/4),st.fillStyle=Rt,st.strokeStyle=Mt,st.lineWidth=1,st.fill(),st.stroke(),_e(ft,ht+lt/4,Jt+lt/2,lt/2,lt/4),st.fillStyle=Mt,st.fill(),_e(ft+Jt,ht,lt,lt,lt/2),st.fillStyle=Mt,st.fill()}(ot.type==="color"||ot.type==="text"||ot.type==="number")&&(at.add({x:ft,y:ht,width:mt,height:lt}),$(ct,ft+parseInt(ct.paddingLeft),ht+parseInt(ct.paddingTop),ot.value),at.remove())}}}const ut=ct.overflow==="auto"||ct.overflow==="hidden";ut&&at.add({x:ft,y:ht,width:mt,height:lt});for(let dt=0;dt<ot.childNodes.length;dt++)nt(ot.childNodes[dt],ct);ut&&at.remove()}const rt=a.getBoundingClientRect();let it=canvases.get(a);it===void 0&&(it=document.createElement("canvas"),it.width=rt.width,it.height=rt.height,canvases.set(a,it));const st=it.getContext("2d"),at=new j(st);return nt(a),it}function htmlevent(a,s,o,j){const $={clientX:o*a.offsetWidth+a.offsetLeft,clientY:j*a.offsetHeight+a.offsetTop,view:a.ownerDocument.defaultView};window.dispatchEvent(new MouseEvent(s,$));const _e=a.getBoundingClientRect();o=o*_e.width+_e.left,j=j*_e.height+_e.top;function tt(nt){if(nt.nodeType!==Node.TEXT_NODE&&nt.nodeType!==Node.COMMENT_NODE){const rt=nt.getBoundingClientRect();if(o>rt.left&&o<rt.right&&j>rt.top&&j<rt.bottom&&(nt.dispatchEvent(new MouseEvent(s,$)),nt instanceof HTMLInputElement&&nt.type==="range"&&(s==="mousedown"||s==="click"))){const[it,st]=["min","max"].map(ft=>parseFloat(nt[ft])),at=rt.width,ct=(o-rt.x)/at;nt.value=it+(st-it)*ct,nt.dispatchEvent(new InputEvent("input",{bubbles:!0}))}for(let it=0;it<nt.childNodes.length;it++)tt(nt.childNodes[it])}}tt(a)}const _pointer=new Vector2,_event={type:"",data:_pointer};class InteractiveGroup extends Group{constructor(s,o){super();const j=this,$=new Raycaster,_e=new Matrix4,tt=s.domElement;function nt(ot){ot.stopPropagation(),_pointer.x=ot.clientX/tt.clientWidth*2-1,_pointer.y=-(ot.clientY/tt.clientHeight)*2+1,$.setFromCamera(_pointer,o);const ct=$.intersectObjects(j.children,!1);if(ct.length>0){const ft=ct[0],ht=ft.object,mt=ft.uv;_event.type=ot.type,_event.data.set(mt.x,1-mt.y),ht.dispatchEvent(_event)}}tt.addEventListener("pointerdown",nt),tt.addEventListener("pointerup",nt),tt.addEventListener("pointermove",nt),tt.addEventListener("mousedown",nt),tt.addEventListener("mouseup",nt),tt.addEventListener("mousemove",nt),tt.addEventListener("click",nt);const rt={move:"mousemove",select:"click",selectstart:"mousedown",selectend:"mouseup"};function it(ot){const ct=ot.target;_e.identity().extractRotation(ct.matrixWorld),$.ray.origin.setFromMatrixPosition(ct.matrixWorld),$.ray.direction.set(0,0,-1).applyMatrix4(_e);const ft=$.intersectObjects(j.children,!1);if(ft.length>0){const ht=ft[0],mt=ht.object,lt=ht.uv;_event.type=rt[ot.type],_event.data.set(lt.x,1-lt.y),mt.dispatchEvent(_event)}}const st=s.xr.getController(0);st.addEventListener("move",it),st.addEventListener("select",it),st.addEventListener("selectstart",it),st.addEventListener("selectend",it);const at=s.xr.getController(1);at.addEventListener("move",it),at.addEventListener("select",it),at.addEventListener("selectstart",it),at.addEventListener("selectend",it)}}function findSpan(a,s,o){const j=o.length-a-1;if(s>=o[j])return j-1;if(s<=o[a])return a;let $=a,_e=j,tt=Math.floor(($+_e)/2);for(;s<o[tt]||s>=o[tt+1];)s<o[tt]?_e=tt:$=tt,tt=Math.floor(($+_e)/2);return tt}function calcBasisFunctions(a,s,o,j){const $=[],_e=[],tt=[];$[0]=1;for(let nt=1;nt<=o;++nt){_e[nt]=s-j[a+1-nt],tt[nt]=j[a+nt]-s;let rt=0;for(let it=0;it<nt;++it){const st=tt[it+1],at=_e[nt-it],ot=$[it]/(st+at);$[it]=rt+st*ot,rt=at*ot}$[nt]=rt}return $}function calcBSplinePoint(a,s,o,j){const $=findSpan(a,j,s),_e=calcBasisFunctions($,j,a,s),tt=new Vector4(0,0,0,0);for(let nt=0;nt<=a;++nt){const rt=o[$-a+nt],it=_e[nt],st=rt.w*it;tt.x+=rt.x*st,tt.y+=rt.y*st,tt.z+=rt.z*st,tt.w+=rt.w*it}return tt}function calcBasisFunctionDerivatives(a,s,o,j,$){const _e=[];for(let at=0;at<=o;++at)_e[at]=0;const tt=[];for(let at=0;at<=j;++at)tt[at]=_e.slice(0);const nt=[];for(let at=0;at<=o;++at)nt[at]=_e.slice(0);nt[0][0]=1;const rt=_e.slice(0),it=_e.slice(0);for(let at=1;at<=o;++at){rt[at]=s-$[a+1-at],it[at]=$[a+at]-s;let ot=0;for(let ct=0;ct<at;++ct){const ft=it[ct+1],ht=rt[at-ct];nt[at][ct]=ft+ht;const mt=nt[ct][at-1]/nt[at][ct];nt[ct][at]=ot+ft*mt,ot=ht*mt}nt[at][at]=ot}for(let at=0;at<=o;++at)tt[0][at]=nt[at][o];for(let at=0;at<=o;++at){let ot=0,ct=1;const ft=[];for(let ht=0;ht<=o;++ht)ft[ht]=_e.slice(0);ft[0][0]=1;for(let ht=1;ht<=j;++ht){let mt=0;const lt=at-ht,ut=o-ht;at>=ht&&(ft[ct][0]=ft[ot][0]/nt[ut+1][lt],mt=ft[ct][0]*nt[lt][ut]);const dt=lt>=-1?1:-lt,gt=at-1<=ut?ht-1:o-at;for(let St=dt;St<=gt;++St)ft[ct][St]=(ft[ot][St]-ft[ot][St-1])/nt[ut+1][lt+St],mt+=ft[ct][St]*nt[lt+St][ut];at<=ut&&(ft[ct][ht]=-ft[ot][ht-1]/nt[ut+1][at],mt+=ft[ct][ht]*nt[at][ut]),tt[ht][at]=mt;const Et=ot;ot=ct,ct=Et}}let st=o;for(let at=1;at<=j;++at){for(let ot=0;ot<=o;++ot)tt[at][ot]*=st;st*=o-at}return tt}function calcBSplineDerivatives(a,s,o,j,$){const _e=$<a?$:a,tt=[],nt=findSpan(a,j,s),rt=calcBasisFunctionDerivatives(nt,j,a,_e,s),it=[];for(let st=0;st<o.length;++st){const at=o[st].clone(),ot=at.w;at.x*=ot,at.y*=ot,at.z*=ot,it[st]=at}for(let st=0;st<=_e;++st){const at=it[nt-a].clone().multiplyScalar(rt[st][0]);for(let ot=1;ot<=a;++ot)at.add(it[nt-a+ot].clone().multiplyScalar(rt[st][ot]));tt[st]=at}for(let st=_e+1;st<=$+1;++st)tt[st]=new Vector4(0,0,0);return tt}function calcKoverI(a,s){let o=1;for(let $=2;$<=a;++$)o*=$;let j=1;for(let $=2;$<=s;++$)j*=$;for(let $=2;$<=a-s;++$)j*=$;return o/j}function calcRationalCurveDerivatives(a){const s=a.length,o=[],j=[];for(let _e=0;_e<s;++_e){const tt=a[_e];o[_e]=new Vector3(tt.x,tt.y,tt.z),j[_e]=tt.w}const $=[];for(let _e=0;_e<s;++_e){const tt=o[_e].clone();for(let nt=1;nt<=_e;++nt)tt.sub($[_e-nt].clone().multiplyScalar(calcKoverI(_e,nt)*j[nt]));$[_e]=tt.divideScalar(j[0])}return $}function calcNURBSDerivatives(a,s,o,j,$){const _e=calcBSplineDerivatives(a,s,o,j,$);return calcRationalCurveDerivatives(_e)}class NURBSCurve extends Curve{constructor(s,o,j,$,_e){super(),this.degree=s,this.knots=o,this.controlPoints=[],this.startKnot=$||0,this.endKnot=_e||this.knots.length-1;for(let tt=0;tt<j.length;++tt){const nt=j[tt];this.controlPoints[tt]=new Vector4(nt.x,nt.y,nt.z,nt.w)}}getPoint(s,o){const j=o||new Vector3,$=this.knots[this.startKnot]+s*(this.knots[this.endKnot]-this.knots[this.startKnot]),_e=calcBSplinePoint(this.degree,this.knots,this.controlPoints,$);return _e.w!=1&&_e.divideScalar(_e.w),j.set(_e.x,_e.y,_e.z)}getTangent(s,o){const j=o||new Vector3,$=this.knots[0]+s*(this.knots[this.knots.length-1]-this.knots[0]),_e=calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,$,1);return j.copy(_e[1]).normalize(),j}}let fbxTree,connections,sceneGraph;class FBXLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=_e.path===""?LoaderUtils.extractUrlBase(s):_e.path,nt=new FileLoader(this.manager);nt.setPath(_e.path),nt.setResponseType("arraybuffer"),nt.setRequestHeader(_e.requestHeader),nt.setWithCredentials(_e.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}parse(s,o){if(isFbxFormatBinary(s))fbxTree=new BinaryParser().parse(s);else{const $=convertArrayBufferToString(s);if(!isFbxFormatASCII($))throw new Error("THREE.FBXLoader: Unknown format.");if(getFbxVersion($)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+getFbxVersion($));fbxTree=new TextParser().parse($)}const j=new TextureLoader(this.manager).setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);return new FBXTreeParser(j,this.manager).parse(fbxTree)}}class FBXTreeParser{constructor(s,o){this.textureLoader=s,this.manager=o}parse(){connections=this.parseConnections();const s=this.parseImages(),o=this.parseTextures(s),j=this.parseMaterials(o),$=this.parseDeformers(),_e=new GeometryParser$1().parse($);return this.parseScene($,_e,j),sceneGraph}parseConnections(){const s=new Map;return"Connections"in fbxTree&&fbxTree.Connections.connections.forEach(function(j){const $=j[0],_e=j[1],tt=j[2];s.has($)||s.set($,{parents:[],children:[]});const nt={ID:_e,relationship:tt};s.get($).parents.push(nt),s.has(_e)||s.set(_e,{parents:[],children:[]});const rt={ID:$,relationship:tt};s.get(_e).children.push(rt)}),s}parseImages(){const s={},o={};if("Video"in fbxTree.Objects){const j=fbxTree.Objects.Video;for(const $ in j){const _e=j[$],tt=parseInt($);if(s[tt]=_e.RelativeFilename||_e.Filename,"Content"in _e){const nt=_e.Content instanceof ArrayBuffer&&_e.Content.byteLength>0,rt=typeof _e.Content=="string"&&_e.Content!=="";if(nt||rt){const it=this.parseImage(j[$]);o[_e.RelativeFilename||_e.Filename]=it}}}}for(const j in s){const $=s[j];o[$]!==void 0?s[j]=o[$]:s[j]=s[j].split("\\").pop()}return s}parseImage(s){const o=s.Content,j=s.RelativeFilename||s.Filename,$=j.slice(j.lastIndexOf(".")+1).toLowerCase();let _e;switch($){case"bmp":_e="image/bmp";break;case"jpg":case"jpeg":_e="image/jpeg";break;case"png":_e="image/png";break;case"tif":_e="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",j),_e="image/tga";break;default:console.warn('FBXLoader: Image type "'+$+'" is not supported.');return}if(typeof o=="string")return"data:"+_e+";base64,"+o;{const tt=new Uint8Array(o);return window.URL.createObjectURL(new Blob([tt],{type:_e}))}}parseTextures(s){const o=new Map;if("Texture"in fbxTree.Objects){const j=fbxTree.Objects.Texture;for(const $ in j){const _e=this.parseTexture(j[$],s);o.set(parseInt($),_e)}}return o}parseTexture(s,o){const j=this.loadTexture(s,o);j.ID=s.id,j.name=s.attrName;const $=s.WrapModeU,_e=s.WrapModeV,tt=$!==void 0?$.value:0,nt=_e!==void 0?_e.value:0;if(j.wrapS=tt===0?RepeatWrapping:ClampToEdgeWrapping,j.wrapT=nt===0?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in s){const rt=s.Scaling.value;j.repeat.x=rt[0],j.repeat.y=rt[1]}return j}loadTexture(s,o){let j;const $=this.textureLoader.path,_e=connections.get(s.id).children;_e!==void 0&&_e.length>0&&o[_e[0].ID]!==void 0&&(j=o[_e[0].ID],(j.indexOf("blob:")===0||j.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let tt;const nt=s.FileName.slice(-3).toLowerCase();if(nt==="tga"){const rt=this.manager.getHandler(".tga");rt===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",s.RelativeFilename),tt=new Texture):(rt.setPath(this.textureLoader.path),tt=rt.load(j))}else nt==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",s.RelativeFilename),tt=new Texture):tt=this.textureLoader.load(j);return this.textureLoader.setPath($),tt}parseMaterials(s){const o=new Map;if("Material"in fbxTree.Objects){const j=fbxTree.Objects.Material;for(const $ in j){const _e=this.parseMaterial(j[$],s);_e!==null&&o.set(parseInt($),_e)}}return o}parseMaterial(s,o){const j=s.id,$=s.attrName;let _e=s.ShadingModel;if(typeof _e=="object"&&(_e=_e.value),!connections.has(j))return null;const tt=this.parseParameters(s,o,j);let nt;switch(_e.toLowerCase()){case"phong":nt=new MeshPhongMaterial;break;case"lambert":nt=new MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',_e),nt=new MeshPhongMaterial;break}return nt.setValues(tt),nt.name=$,nt}parseParameters(s,o,j){const $={};s.BumpFactor&&($.bumpScale=s.BumpFactor.value),s.Diffuse?$.color=new Color().fromArray(s.Diffuse.value):s.DiffuseColor&&(s.DiffuseColor.type==="Color"||s.DiffuseColor.type==="ColorRGB")&&($.color=new Color().fromArray(s.DiffuseColor.value)),s.DisplacementFactor&&($.displacementScale=s.DisplacementFactor.value),s.Emissive?$.emissive=new Color().fromArray(s.Emissive.value):s.EmissiveColor&&(s.EmissiveColor.type==="Color"||s.EmissiveColor.type==="ColorRGB")&&($.emissive=new Color().fromArray(s.EmissiveColor.value)),s.EmissiveFactor&&($.emissiveIntensity=parseFloat(s.EmissiveFactor.value)),s.Opacity&&($.opacity=parseFloat(s.Opacity.value)),$.opacity<1&&($.transparent=!0),s.ReflectionFactor&&($.reflectivity=s.ReflectionFactor.value),s.Shininess&&($.shininess=s.Shininess.value),s.Specular?$.specular=new Color().fromArray(s.Specular.value):s.SpecularColor&&s.SpecularColor.type==="Color"&&($.specular=new Color().fromArray(s.SpecularColor.value));const _e=this;return connections.get(j).children.forEach(function(tt){const nt=tt.relationship;switch(nt){case"Bump":$.bumpMap=_e.getTexture(o,tt.ID);break;case"Maya|TEX_ao_map":$.aoMap=_e.getTexture(o,tt.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":$.map=_e.getTexture(o,tt.ID),$.map!==void 0&&("colorSpace"in $.map?$.map.colorSpace="srgb":$.map.encoding=3001);break;case"DisplacementColor":$.displacementMap=_e.getTexture(o,tt.ID);break;case"EmissiveColor":$.emissiveMap=_e.getTexture(o,tt.ID),$.emissiveMap!==void 0&&("colorSpace"in $.emissiveMap?$.emissiveMap.colorSpace="srgb":$.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":$.normalMap=_e.getTexture(o,tt.ID);break;case"ReflectionColor":$.envMap=_e.getTexture(o,tt.ID),$.envMap!==void 0&&($.envMap.mapping=EquirectangularReflectionMapping,"colorSpace"in $.envMap?$.envMap.colorSpace="srgb":$.envMap.encoding=3001);break;case"SpecularColor":$.specularMap=_e.getTexture(o,tt.ID),$.specularMap!==void 0&&("colorSpace"in $.specularMap?$.specularMap.colorSpace="srgb":$.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":$.alphaMap=_e.getTexture(o,tt.ID),$.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",nt);break}}),$}getTexture(s,o){return"LayeredTexture"in fbxTree.Objects&&o in fbxTree.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),o=connections.get(o).children[0].ID),s.get(o)}parseDeformers(){const s={},o={};if("Deformer"in fbxTree.Objects){const j=fbxTree.Objects.Deformer;for(const $ in j){const _e=j[$],tt=connections.get(parseInt($));if(_e.attrType==="Skin"){const nt=this.parseSkeleton(tt,j);nt.ID=$,tt.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),nt.geometryID=tt.parents[0].ID,s[$]=nt}else if(_e.attrType==="BlendShape"){const nt={id:$};nt.rawTargets=this.parseMorphTargets(tt,j),nt.id=$,tt.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),o[$]=nt}}}return{skeletons:s,morphTargets:o}}parseSkeleton(s,o){const j=[];return s.children.forEach(function($){const _e=o[$.ID];if(_e.attrType!=="Cluster")return;const tt={ID:$.ID,indices:[],weights:[],transformLink:new Matrix4().fromArray(_e.TransformLink.a)};"Indexes"in _e&&(tt.indices=_e.Indexes.a,tt.weights=_e.Weights.a),j.push(tt)}),{rawBones:j,bones:[]}}parseMorphTargets(s,o){const j=[];for(let $=0;$<s.children.length;$++){const _e=s.children[$],tt=o[_e.ID],nt={name:tt.attrName,initialWeight:tt.DeformPercent,id:tt.id,fullWeights:tt.FullWeights.a};if(tt.attrType!=="BlendShapeChannel")return;nt.geoID=connections.get(parseInt(_e.ID)).children.filter(function(rt){return rt.relationship===void 0})[0].ID,j.push(nt)}return j}parseScene(s,o,j){sceneGraph=new Group;const $=this.parseModels(s.skeletons,o,j),_e=fbxTree.Objects.Model,tt=this;$.forEach(function(rt){const it=_e[rt.ID];tt.setLookAtProperties(rt,it),connections.get(rt.ID).parents.forEach(function(at){const ot=$.get(at.ID);ot!==void 0&&ot.add(rt)}),rt.parent===null&&sceneGraph.add(rt)}),this.bindSkeleton(s.skeletons,o,$),this.createAmbientLight(),sceneGraph.traverse(function(rt){if(rt.userData.transformData){rt.parent&&(rt.userData.transformData.parentMatrix=rt.parent.matrix,rt.userData.transformData.parentMatrixWorld=rt.parent.matrixWorld);const it=generateTransform(rt.userData.transformData);rt.applyMatrix4(it),rt.updateWorldMatrix()}});const nt=new AnimationParser().parse();sceneGraph.children.length===1&&sceneGraph.children[0].isGroup&&(sceneGraph.children[0].animations=nt,sceneGraph=sceneGraph.children[0]),sceneGraph.animations=nt}parseModels(s,o,j){const $=new Map,_e=fbxTree.Objects.Model;for(const tt in _e){const nt=parseInt(tt),rt=_e[tt],it=connections.get(nt);let st=this.buildSkeleton(it,s,nt,rt.attrName);if(!st){switch(rt.attrType){case"Camera":st=this.createCamera(it);break;case"Light":st=this.createLight(it);break;case"Mesh":st=this.createMesh(it,o,j);break;case"NurbsCurve":st=this.createCurve(it,o);break;case"LimbNode":case"Root":st=new Bone;break;case"Null":default:st=new Group;break}st.name=rt.attrName?PropertyBinding.sanitizeNodeName(rt.attrName):"",st.ID=nt}this.getTransformData(st,rt),$.set(nt,st)}return $}buildSkeleton(s,o,j,$){let _e=null;return s.parents.forEach(function(tt){for(const nt in o){const rt=o[nt];rt.rawBones.forEach(function(it,st){if(it.ID===tt.ID){const at=_e;_e=new Bone,_e.matrixWorld.copy(it.transformLink),_e.name=$?PropertyBinding.sanitizeNodeName($):"",_e.ID=j,rt.bones[st]=_e,at!==null&&_e.add(at)}})}}),_e}createCamera(s){let o,j;if(s.children.forEach(function($){const _e=fbxTree.Objects.NodeAttribute[$.ID];_e!==void 0&&(j=_e)}),j===void 0)o=new Object3D;else{let $=0;j.CameraProjectionType!==void 0&&j.CameraProjectionType.value===1&&($=1);let _e=1;j.NearPlane!==void 0&&(_e=j.NearPlane.value/1e3);let tt=1e3;j.FarPlane!==void 0&&(tt=j.FarPlane.value/1e3);let nt=window.innerWidth,rt=window.innerHeight;j.AspectWidth!==void 0&&j.AspectHeight!==void 0&&(nt=j.AspectWidth.value,rt=j.AspectHeight.value);const it=nt/rt;let st=45;j.FieldOfView!==void 0&&(st=j.FieldOfView.value);const at=j.FocalLength?j.FocalLength.value:null;switch($){case 0:o=new PerspectiveCamera(st,it,_e,tt),at!==null&&o.setFocalLength(at);break;case 1:o=new OrthographicCamera(-nt/2,nt/2,rt/2,-rt/2,_e,tt);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+$+"."),o=new Object3D;break}}return o}createLight(s){let o,j;if(s.children.forEach(function($){const _e=fbxTree.Objects.NodeAttribute[$.ID];_e!==void 0&&(j=_e)}),j===void 0)o=new Object3D;else{let $;j.LightType===void 0?$=0:$=j.LightType.value;let _e=16777215;j.Color!==void 0&&(_e=new Color().fromArray(j.Color.value));let tt=j.Intensity===void 0?1:j.Intensity.value/100;j.CastLightOnObject!==void 0&&j.CastLightOnObject.value===0&&(tt=0);let nt=0;j.FarAttenuationEnd!==void 0&&(j.EnableFarAttenuation!==void 0&&j.EnableFarAttenuation.value===0?nt=0:nt=j.FarAttenuationEnd.value);const rt=1;switch($){case 0:o=new PointLight(_e,tt,nt,rt);break;case 1:o=new DirectionalLight(_e,tt);break;case 2:let it=Math.PI/3;j.InnerAngle!==void 0&&(it=MathUtils.degToRad(j.InnerAngle.value));let st=0;j.OuterAngle!==void 0&&(st=MathUtils.degToRad(j.OuterAngle.value),st=Math.max(st,1)),o=new SpotLight(_e,tt,nt,it,st,rt);break;default:console.warn("THREE.FBXLoader: Unknown light type "+j.LightType.value+", defaulting to a PointLight."),o=new PointLight(_e,tt);break}j.CastShadows!==void 0&&j.CastShadows.value===1&&(o.castShadow=!0)}return o}createMesh(s,o,j){let $,_e=null,tt=null;const nt=[];return s.children.forEach(function(rt){o.has(rt.ID)&&(_e=o.get(rt.ID)),j.has(rt.ID)&&nt.push(j.get(rt.ID))}),nt.length>1?tt=nt:nt.length>0?tt=nt[0]:(tt=new MeshPhongMaterial({color:13421772}),nt.push(tt)),"color"in _e.attributes&&nt.forEach(function(rt){rt.vertexColors=!0}),_e.FBX_Deformer?($=new SkinnedMesh(_e,tt),$.normalizeSkinWeights()):$=new Mesh(_e,tt),$}createCurve(s,o){const j=s.children.reduce(function(_e,tt){return o.has(tt.ID)&&(_e=o.get(tt.ID)),_e},null),$=new LineBasicMaterial({color:3342591,linewidth:1});return new Line(j,$)}getTransformData(s,o){const j={};"InheritType"in o&&(j.inheritType=parseInt(o.InheritType.value)),"RotationOrder"in o?j.eulerOrder=getEulerOrder(o.RotationOrder.value):j.eulerOrder="ZYX","Lcl_Translation"in o&&(j.translation=o.Lcl_Translation.value),"PreRotation"in o&&(j.preRotation=o.PreRotation.value),"Lcl_Rotation"in o&&(j.rotation=o.Lcl_Rotation.value),"PostRotation"in o&&(j.postRotation=o.PostRotation.value),"Lcl_Scaling"in o&&(j.scale=o.Lcl_Scaling.value),"ScalingOffset"in o&&(j.scalingOffset=o.ScalingOffset.value),"ScalingPivot"in o&&(j.scalingPivot=o.ScalingPivot.value),"RotationOffset"in o&&(j.rotationOffset=o.RotationOffset.value),"RotationPivot"in o&&(j.rotationPivot=o.RotationPivot.value),s.userData.transformData=j}setLookAtProperties(s,o){"LookAtProperty"in o&&connections.get(s.ID).children.forEach(function($){if($.relationship==="LookAtProperty"){const _e=fbxTree.Objects.Model[$.ID];if("Lcl_Translation"in _e){const tt=_e.Lcl_Translation.value;s.target!==void 0?(s.target.position.fromArray(tt),sceneGraph.add(s.target)):s.lookAt(new Vector3().fromArray(tt))}}})}bindSkeleton(s,o,j){const $=this.parsePoseNodes();for(const _e in s){const tt=s[_e];connections.get(parseInt(tt.ID)).parents.forEach(function(rt){if(o.has(rt.ID)){const it=rt.ID;connections.get(it).parents.forEach(function(at){j.has(at.ID)&&j.get(at.ID).bind(new Skeleton(tt.bones),$[at.ID])})}})}}parsePoseNodes(){const s={};if("Pose"in fbxTree.Objects){const o=fbxTree.Objects.Pose;for(const j in o)if(o[j].attrType==="BindPose"&&o[j].NbPoseNodes>0){const $=o[j].PoseNode;Array.isArray($)?$.forEach(function(_e){s[_e.Node]=new Matrix4().fromArray(_e.Matrix.a)}):s[$.Node]=new Matrix4().fromArray($.Matrix.a)}}return s}createAmbientLight(){if("GlobalSettings"in fbxTree&&"AmbientColor"in fbxTree.GlobalSettings){const s=fbxTree.GlobalSettings.AmbientColor.value,o=s[0],j=s[1],$=s[2];if(o!==0||j!==0||$!==0){const _e=new Color(o,j,$);sceneGraph.add(new AmbientLight(_e,1))}}}}let GeometryParser$1=class{parse(s){const o=new Map;if("Geometry"in fbxTree.Objects){const j=fbxTree.Objects.Geometry;for(const $ in j){const _e=connections.get(parseInt($)),tt=this.parseGeometry(_e,j[$],s);o.set(parseInt($),tt)}}return o}parseGeometry(s,o,j){switch(o.attrType){case"Mesh":return this.parseMeshGeometry(s,o,j);case"NurbsCurve":return this.parseNurbsGeometry(o)}}parseMeshGeometry(s,o,j){const $=j.skeletons,_e=[],tt=s.parents.map(function(at){return fbxTree.Objects.Model[at.ID]});if(tt.length===0)return;const nt=s.children.reduce(function(at,ot){return $[ot.ID]!==void 0&&(at=$[ot.ID]),at},null);s.children.forEach(function(at){j.morphTargets[at.ID]!==void 0&&_e.push(j.morphTargets[at.ID])});const rt=tt[0],it={};"RotationOrder"in rt&&(it.eulerOrder=getEulerOrder(rt.RotationOrder.value)),"InheritType"in rt&&(it.inheritType=parseInt(rt.InheritType.value)),"GeometricTranslation"in rt&&(it.translation=rt.GeometricTranslation.value),"GeometricRotation"in rt&&(it.rotation=rt.GeometricRotation.value),"GeometricScaling"in rt&&(it.scale=rt.GeometricScaling.value);const st=generateTransform(it);return this.genGeometry(o,nt,_e,st)}genGeometry(s,o,j,$){const _e=new BufferGeometry;s.attrName&&(_e.name=s.attrName);const tt=this.parseGeoNode(s,o),nt=this.genBuffers(tt),rt=new Float32BufferAttribute(nt.vertex,3);if(rt.applyMatrix4($),_e.setAttribute("position",rt),nt.colors.length>0&&_e.setAttribute("color",new Float32BufferAttribute(nt.colors,3)),o&&(_e.setAttribute("skinIndex",new Uint16BufferAttribute(nt.weightsIndices,4)),_e.setAttribute("skinWeight",new Float32BufferAttribute(nt.vertexWeights,4)),_e.FBX_Deformer=o),nt.normal.length>0){const it=new Matrix3().getNormalMatrix($),st=new Float32BufferAttribute(nt.normal,3);st.applyNormalMatrix(it),_e.setAttribute("normal",st)}if(nt.uvs.forEach(function(it,st){let at="uv"+(st+1).toString();st===0&&(at="uv"),_e.setAttribute(at,new Float32BufferAttribute(nt.uvs[st],2))}),tt.material&&tt.material.mappingType!=="AllSame"){let it=nt.materialIndex[0],st=0;if(nt.materialIndex.forEach(function(at,ot){at!==it&&(_e.addGroup(st,ot-st,it),it=at,st=ot)}),_e.groups.length>0){const at=_e.groups[_e.groups.length-1],ot=at.start+at.count;ot!==nt.materialIndex.length&&_e.addGroup(ot,nt.materialIndex.length-ot,it)}_e.groups.length===0&&_e.addGroup(0,nt.materialIndex.length,nt.materialIndex[0])}return this.addMorphTargets(_e,s,j,$),_e}parseGeoNode(s,o){const j={};if(j.vertexPositions=s.Vertices!==void 0?s.Vertices.a:[],j.vertexIndices=s.PolygonVertexIndex!==void 0?s.PolygonVertexIndex.a:[],s.LayerElementColor&&(j.color=this.parseVertexColors(s.LayerElementColor[0])),s.LayerElementMaterial&&(j.material=this.parseMaterialIndices(s.LayerElementMaterial[0])),s.LayerElementNormal&&(j.normal=this.parseNormals(s.LayerElementNormal[0])),s.LayerElementUV){j.uv=[];let $=0;for(;s.LayerElementUV[$];)s.LayerElementUV[$].UV&&j.uv.push(this.parseUVs(s.LayerElementUV[$])),$++}return j.weightTable={},o!==null&&(j.skeleton=o,o.rawBones.forEach(function($,_e){$.indices.forEach(function(tt,nt){j.weightTable[tt]===void 0&&(j.weightTable[tt]=[]),j.weightTable[tt].push({id:_e,weight:$.weights[nt]})})})),j}genBuffers(s){const o={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let j=0,$=0,_e=!1,tt=[],nt=[],rt=[],it=[],st=[],at=[];const ot=this;return s.vertexIndices.forEach(function(ct,ft){let ht,mt=!1;ct<0&&(ct=ct^-1,mt=!0);let lt=[],ut=[];if(tt.push(ct*3,ct*3+1,ct*3+2),s.color){const dt=getData(ft,j,ct,s.color);rt.push(dt[0],dt[1],dt[2])}if(s.skeleton){if(s.weightTable[ct]!==void 0&&s.weightTable[ct].forEach(function(dt){ut.push(dt.weight),lt.push(dt.id)}),ut.length>4){_e||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),_e=!0);const dt=[0,0,0,0],gt=[0,0,0,0];ut.forEach(function(Et,St){let Tt=Et,Mt=lt[St];gt.forEach(function(Bt,Rt,Ut){if(Tt>Bt){Ut[Rt]=Tt,Tt=Bt;const Ht=dt[Rt];dt[Rt]=Mt,Mt=Ht}})}),lt=dt,ut=gt}for(;ut.length<4;)ut.push(0),lt.push(0);for(let dt=0;dt<4;++dt)st.push(ut[dt]),at.push(lt[dt])}if(s.normal){const dt=getData(ft,j,ct,s.normal);nt.push(dt[0],dt[1],dt[2])}s.material&&s.material.mappingType!=="AllSame"&&(ht=getData(ft,j,ct,s.material)[0]),s.uv&&s.uv.forEach(function(dt,gt){const Et=getData(ft,j,ct,dt);it[gt]===void 0&&(it[gt]=[]),it[gt].push(Et[0]),it[gt].push(Et[1])}),$++,mt&&(ot.genFace(o,s,tt,ht,nt,rt,it,st,at,$),j++,$=0,tt=[],nt=[],rt=[],it=[],st=[],at=[])}),o}genFace(s,o,j,$,_e,tt,nt,rt,it,st){for(let at=2;at<st;at++)s.vertex.push(o.vertexPositions[j[0]]),s.vertex.push(o.vertexPositions[j[1]]),s.vertex.push(o.vertexPositions[j[2]]),s.vertex.push(o.vertexPositions[j[(at-1)*3]]),s.vertex.push(o.vertexPositions[j[(at-1)*3+1]]),s.vertex.push(o.vertexPositions[j[(at-1)*3+2]]),s.vertex.push(o.vertexPositions[j[at*3]]),s.vertex.push(o.vertexPositions[j[at*3+1]]),s.vertex.push(o.vertexPositions[j[at*3+2]]),o.skeleton&&(s.vertexWeights.push(rt[0]),s.vertexWeights.push(rt[1]),s.vertexWeights.push(rt[2]),s.vertexWeights.push(rt[3]),s.vertexWeights.push(rt[(at-1)*4]),s.vertexWeights.push(rt[(at-1)*4+1]),s.vertexWeights.push(rt[(at-1)*4+2]),s.vertexWeights.push(rt[(at-1)*4+3]),s.vertexWeights.push(rt[at*4]),s.vertexWeights.push(rt[at*4+1]),s.vertexWeights.push(rt[at*4+2]),s.vertexWeights.push(rt[at*4+3]),s.weightsIndices.push(it[0]),s.weightsIndices.push(it[1]),s.weightsIndices.push(it[2]),s.weightsIndices.push(it[3]),s.weightsIndices.push(it[(at-1)*4]),s.weightsIndices.push(it[(at-1)*4+1]),s.weightsIndices.push(it[(at-1)*4+2]),s.weightsIndices.push(it[(at-1)*4+3]),s.weightsIndices.push(it[at*4]),s.weightsIndices.push(it[at*4+1]),s.weightsIndices.push(it[at*4+2]),s.weightsIndices.push(it[at*4+3])),o.color&&(s.colors.push(tt[0]),s.colors.push(tt[1]),s.colors.push(tt[2]),s.colors.push(tt[(at-1)*3]),s.colors.push(tt[(at-1)*3+1]),s.colors.push(tt[(at-1)*3+2]),s.colors.push(tt[at*3]),s.colors.push(tt[at*3+1]),s.colors.push(tt[at*3+2])),o.material&&o.material.mappingType!=="AllSame"&&(s.materialIndex.push($),s.materialIndex.push($),s.materialIndex.push($)),o.normal&&(s.normal.push(_e[0]),s.normal.push(_e[1]),s.normal.push(_e[2]),s.normal.push(_e[(at-1)*3]),s.normal.push(_e[(at-1)*3+1]),s.normal.push(_e[(at-1)*3+2]),s.normal.push(_e[at*3]),s.normal.push(_e[at*3+1]),s.normal.push(_e[at*3+2])),o.uv&&o.uv.forEach(function(ot,ct){s.uvs[ct]===void 0&&(s.uvs[ct]=[]),s.uvs[ct].push(nt[ct][0]),s.uvs[ct].push(nt[ct][1]),s.uvs[ct].push(nt[ct][(at-1)*2]),s.uvs[ct].push(nt[ct][(at-1)*2+1]),s.uvs[ct].push(nt[ct][at*2]),s.uvs[ct].push(nt[ct][at*2+1])})}addMorphTargets(s,o,j,$){if(j.length===0)return;s.morphTargetsRelative=!0,s.morphAttributes.position=[];const _e=this;j.forEach(function(tt){tt.rawTargets.forEach(function(nt){const rt=fbxTree.Objects.Geometry[nt.geoID];rt!==void 0&&_e.genMorphGeometry(s,o,rt,$,nt.name)})})}genMorphGeometry(s,o,j,$,_e){const tt=o.PolygonVertexIndex!==void 0?o.PolygonVertexIndex.a:[],nt=j.Vertices!==void 0?j.Vertices.a:[],rt=j.Indexes!==void 0?j.Indexes.a:[],it=s.attributes.position.count*3,st=new Float32Array(it);for(let ft=0;ft<rt.length;ft++){const ht=rt[ft]*3;st[ht]=nt[ft*3],st[ht+1]=nt[ft*3+1],st[ht+2]=nt[ft*3+2]}const at={vertexIndices:tt,vertexPositions:st},ot=this.genBuffers(at),ct=new Float32BufferAttribute(ot.vertex,3);ct.name=_e||j.attrName,ct.applyMatrix4($),s.morphAttributes.position.push(ct)}parseNormals(s){const o=s.MappingInformationType,j=s.ReferenceInformationType,$=s.Normals.a;let _e=[];return j==="IndexToDirect"&&("NormalIndex"in s?_e=s.NormalIndex.a:"NormalsIndex"in s&&(_e=s.NormalsIndex.a)),{dataSize:3,buffer:$,indices:_e,mappingType:o,referenceType:j}}parseUVs(s){const o=s.MappingInformationType,j=s.ReferenceInformationType,$=s.UV.a;let _e=[];return j==="IndexToDirect"&&(_e=s.UVIndex.a),{dataSize:2,buffer:$,indices:_e,mappingType:o,referenceType:j}}parseVertexColors(s){const o=s.MappingInformationType,j=s.ReferenceInformationType,$=s.Colors.a;let _e=[];return j==="IndexToDirect"&&(_e=s.ColorIndex.a),{dataSize:4,buffer:$,indices:_e,mappingType:o,referenceType:j}}parseMaterialIndices(s){const o=s.MappingInformationType,j=s.ReferenceInformationType;if(o==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:j};const $=s.Materials.a,_e=[];for(let tt=0;tt<$.length;++tt)_e.push(tt);return{dataSize:1,buffer:$,indices:_e,mappingType:o,referenceType:j}}parseNurbsGeometry(s){if(NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new BufferGeometry;const o=parseInt(s.Order);if(isNaN(o))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",s.Order,s.id),new BufferGeometry;const j=o-1,$=s.KnotVector.a,_e=[],tt=s.Points.a;for(let at=0,ot=tt.length;at<ot;at+=4)_e.push(new Vector4().fromArray(tt,at));let nt,rt;if(s.Form==="Closed")_e.push(_e[0]);else if(s.Form==="Periodic"){nt=j,rt=$.length-1-nt;for(let at=0;at<j;++at)_e.push(_e[at])}const st=new NURBSCurve(j,$,_e,nt,rt).getPoints(_e.length*12);return new BufferGeometry().setFromPoints(st)}};class AnimationParser{parse(){const s=[],o=this.parseClips();if(o!==void 0)for(const j in o){const $=o[j],_e=this.addClip($);s.push(_e)}return s}parseClips(){if(fbxTree.Objects.AnimationCurve===void 0)return;const s=this.parseAnimationCurveNodes();this.parseAnimationCurves(s);const o=this.parseAnimationLayers(s);return this.parseAnimStacks(o)}parseAnimationCurveNodes(){const s=fbxTree.Objects.AnimationCurveNode,o=new Map;for(const j in s){const $=s[j];if($.attrName.match(/S|R|T|DeformPercent/)!==null){const _e={id:$.id,attr:$.attrName,curves:{}};o.set(_e.id,_e)}}return o}parseAnimationCurves(s){const o=fbxTree.Objects.AnimationCurve;for(const j in o){const $={id:o[j].id,times:o[j].KeyTime.a.map(convertFBXTimeToSeconds),values:o[j].KeyValueFloat.a},_e=connections.get($.id);if(_e!==void 0){const tt=_e.parents[0].ID,nt=_e.parents[0].relationship;nt.match(/X/)?s.get(tt).curves.x=$:nt.match(/Y/)?s.get(tt).curves.y=$:nt.match(/Z/)?s.get(tt).curves.z=$:nt.match(/d|DeformPercent/)&&s.has(tt)&&(s.get(tt).curves.morph=$)}}}parseAnimationLayers(s){const o=fbxTree.Objects.AnimationLayer,j=new Map;for(const $ in o){const _e=[],tt=connections.get(parseInt($));tt!==void 0&&(tt.children.forEach(function(rt,it){if(s.has(rt.ID)){const st=s.get(rt.ID);if(st.curves.x!==void 0||st.curves.y!==void 0||st.curves.z!==void 0){if(_e[it]===void 0){const at=connections.get(rt.ID).parents.filter(function(ot){return ot.relationship!==void 0})[0].ID;if(at!==void 0){const ot=fbxTree.Objects.Model[at.toString()];if(ot===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",rt);return}const ct={modelName:ot.attrName?PropertyBinding.sanitizeNodeName(ot.attrName):"",ID:ot.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};sceneGraph.traverse(function(ft){ft.ID===ot.id&&(ct.transform=ft.matrix,ft.userData.transformData&&(ct.eulerOrder=ft.userData.transformData.eulerOrder))}),ct.transform||(ct.transform=new Matrix4),"PreRotation"in ot&&(ct.preRotation=ot.PreRotation.value),"PostRotation"in ot&&(ct.postRotation=ot.PostRotation.value),_e[it]=ct}}_e[it]&&(_e[it][st.attr]=st)}else if(st.curves.morph!==void 0){if(_e[it]===void 0){const at=connections.get(rt.ID).parents.filter(function(lt){return lt.relationship!==void 0})[0].ID,ot=connections.get(at).parents[0].ID,ct=connections.get(ot).parents[0].ID,ft=connections.get(ct).parents[0].ID,ht=fbxTree.Objects.Model[ft],mt={modelName:ht.attrName?PropertyBinding.sanitizeNodeName(ht.attrName):"",morphName:fbxTree.Objects.Deformer[at].attrName};_e[it]=mt}_e[it][st.attr]=st}}}),j.set(parseInt($),_e))}return j}parseAnimStacks(s){const o=fbxTree.Objects.AnimationStack,j={};for(const $ in o){const _e=connections.get(parseInt($)).children;_e.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const tt=s.get(_e[0].ID);j[$]={name:o[$].attrName,layer:tt}}return j}addClip(s){let o=[];const j=this;return s.layer.forEach(function($){o=o.concat(j.generateTracks($))}),new AnimationClip(s.name,-1,o)}generateTracks(s){const o=[];let j=new Vector3,$=new Quaternion,_e=new Vector3;if(s.transform&&s.transform.decompose(j,$,_e),j=j.toArray(),$=new Euler().setFromQuaternion($,s.eulerOrder).toArray(),_e=_e.toArray(),s.T!==void 0&&Object.keys(s.T.curves).length>0){const tt=this.generateVectorTrack(s.modelName,s.T.curves,j,"position");tt!==void 0&&o.push(tt)}if(s.R!==void 0&&Object.keys(s.R.curves).length>0){const tt=this.generateRotationTrack(s.modelName,s.R.curves,$,s.preRotation,s.postRotation,s.eulerOrder);tt!==void 0&&o.push(tt)}if(s.S!==void 0&&Object.keys(s.S.curves).length>0){const tt=this.generateVectorTrack(s.modelName,s.S.curves,_e,"scale");tt!==void 0&&o.push(tt)}if(s.DeformPercent!==void 0){const tt=this.generateMorphTrack(s);tt!==void 0&&o.push(tt)}return o}generateVectorTrack(s,o,j,$){const _e=this.getTimesForAllAxes(o),tt=this.getKeyframeTrackValues(_e,o,j);return new VectorKeyframeTrack(s+"."+$,_e,tt)}generateRotationTrack(s,o,j,$,_e,tt){o.x!==void 0&&(this.interpolateRotations(o.x),o.x.values=o.x.values.map(MathUtils.degToRad)),o.y!==void 0&&(this.interpolateRotations(o.y),o.y.values=o.y.values.map(MathUtils.degToRad)),o.z!==void 0&&(this.interpolateRotations(o.z),o.z.values=o.z.values.map(MathUtils.degToRad));const nt=this.getTimesForAllAxes(o),rt=this.getKeyframeTrackValues(nt,o,j);$!==void 0&&($=$.map(MathUtils.degToRad),$.push(tt),$=new Euler().fromArray($),$=new Quaternion().setFromEuler($)),_e!==void 0&&(_e=_e.map(MathUtils.degToRad),_e.push(tt),_e=new Euler().fromArray(_e),_e=new Quaternion().setFromEuler(_e).invert());const it=new Quaternion,st=new Euler,at=[];for(let ot=0;ot<rt.length;ot+=3)st.set(rt[ot],rt[ot+1],rt[ot+2],tt),it.setFromEuler(st),$!==void 0&&it.premultiply($),_e!==void 0&&it.multiply(_e),it.toArray(at,ot/3*4);return new QuaternionKeyframeTrack(s+".quaternion",nt,at)}generateMorphTrack(s){const o=s.DeformPercent.curves.morph,j=o.values.map(function(_e){return _e/100}),$=sceneGraph.getObjectByName(s.modelName).morphTargetDictionary[s.morphName];return new NumberKeyframeTrack(s.modelName+".morphTargetInfluences["+$+"]",o.times,j)}getTimesForAllAxes(s){let o=[];if(s.x!==void 0&&(o=o.concat(s.x.times)),s.y!==void 0&&(o=o.concat(s.y.times)),s.z!==void 0&&(o=o.concat(s.z.times)),o=o.sort(function(j,$){return j-$}),o.length>1){let j=1,$=o[0];for(let _e=1;_e<o.length;_e++){const tt=o[_e];tt!==$&&(o[j]=tt,$=tt,j++)}o=o.slice(0,j)}return o}getKeyframeTrackValues(s,o,j){const $=j,_e=[];let tt=-1,nt=-1,rt=-1;return s.forEach(function(it){if(o.x&&(tt=o.x.times.indexOf(it)),o.y&&(nt=o.y.times.indexOf(it)),o.z&&(rt=o.z.times.indexOf(it)),tt!==-1){const st=o.x.values[tt];_e.push(st),$[0]=st}else _e.push($[0]);if(nt!==-1){const st=o.y.values[nt];_e.push(st),$[1]=st}else _e.push($[1]);if(rt!==-1){const st=o.z.values[rt];_e.push(st),$[2]=st}else _e.push($[2])}),_e}interpolateRotations(s){for(let o=1;o<s.values.length;o++){const j=s.values[o-1],$=s.values[o]-j,_e=Math.abs($);if(_e>=180){const tt=_e/180,nt=$/tt;let rt=j+nt;const it=s.times[o-1],at=(s.times[o]-it)/tt;let ot=it+at;const ct=[],ft=[];for(;ot<s.times[o];)ct.push(ot),ot+=at,ft.push(rt),rt+=nt;s.times=inject(s.times,o,ct),s.values=inject(s.values,o,ft)}}}}class TextParser{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(s){this.nodeStack.push(s),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(s,o){this.currentProp=s,this.currentPropName=o}parse(s){this.currentIndent=0,this.allNodes=new FBXTree,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const o=this,j=s.split(/[\r\n]+/);return j.forEach(function($,_e){const tt=$.match(/^[\s\t]*;/),nt=$.match(/^[\s\t]*$/);if(tt||nt)return;const rt=$.match("^\\t{"+o.currentIndent+"}(\\w+):(.*){",""),it=$.match("^\\t{"+o.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),st=$.match("^\\t{"+(o.currentIndent-1)+"}}");rt?o.parseNodeBegin($,rt):it?o.parseNodeProperty($,it,j[++_e]):st?o.popStack():$.match(/^[^\s\t}]/)&&o.parseNodePropertyContinued($)}),this.allNodes}parseNodeBegin(s,o){const j=o[1].trim().replace(/^"/,"").replace(/"$/,""),$=o[2].split(",").map(function(rt){return rt.trim().replace(/^"/,"").replace(/"$/,"")}),_e={name:j},tt=this.parseNodeAttr($),nt=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(j,_e):j in nt?(j==="PoseNode"?nt.PoseNode.push(_e):nt[j].id!==void 0&&(nt[j]={},nt[j][nt[j].id]=nt[j]),tt.id!==""&&(nt[j][tt.id]=_e)):typeof tt.id=="number"?(nt[j]={},nt[j][tt.id]=_e):j!=="Properties70"&&(j==="PoseNode"?nt[j]=[_e]:nt[j]=_e),typeof tt.id=="number"&&(_e.id=tt.id),tt.name!==""&&(_e.attrName=tt.name),tt.type!==""&&(_e.attrType=tt.type),this.pushStack(_e)}parseNodeAttr(s){let o=s[0];s[0]!==""&&(o=parseInt(s[0]),isNaN(o)&&(o=s[0]));let j="",$="";return s.length>1&&(j=s[1].replace(/^(\w+)::/,""),$=s[2]),{id:o,name:j,type:$}}parseNodeProperty(s,o,j){let $=o[1].replace(/^"/,"").replace(/"$/,"").trim(),_e=o[2].replace(/^"/,"").replace(/"$/,"").trim();$==="Content"&&_e===","&&(_e=j.replace(/"/g,"").replace(/,$/,"").trim());const tt=this.getCurrentNode();if(tt.name==="Properties70"){this.parseNodeSpecialProperty(s,$,_e);return}if($==="C"){const rt=_e.split(",").slice(1),it=parseInt(rt[0]),st=parseInt(rt[1]);let at=_e.split(",").slice(3);at=at.map(function(ot){return ot.trim().replace(/^"/,"")}),$="connections",_e=[it,st],append$1(_e,at),tt[$]===void 0&&(tt[$]=[])}$==="Node"&&(tt.id=_e),$ in tt&&Array.isArray(tt[$])?tt[$].push(_e):$!=="a"?tt[$]=_e:tt.a=_e,this.setCurrentProp(tt,$),$==="a"&&_e.slice(-1)!==","&&(tt.a=parseNumberArray(_e))}parseNodePropertyContinued(s){const o=this.getCurrentNode();o.a+=s,s.slice(-1)!==","&&(o.a=parseNumberArray(o.a))}parseNodeSpecialProperty(s,o,j){const $=j.split('",').map(function(st){return st.trim().replace(/^\"/,"").replace(/\s/,"_")}),_e=$[0],tt=$[1],nt=$[2],rt=$[3];let it=$[4];switch(tt){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":it=parseFloat(it);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":it=parseNumberArray(it);break}this.getPrevNode()[_e]={type:tt,type2:nt,flag:rt,value:it},this.setCurrentProp(this.getPrevNode(),_e)}}class BinaryParser{parse(s){const o=new BinaryReader(s);o.skip(23);const j=o.getUint32();if(j<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+j);const $=new FBXTree;for(;!this.endOfContent(o);){const _e=this.parseNode(o,j);_e!==null&&$.add(_e.name,_e)}return $}endOfContent(s){return s.size()%16===0?(s.getOffset()+160+16&-16)>=s.size():s.getOffset()+160+16>=s.size()}parseNode(s,o){const j={},$=o>=7500?s.getUint64():s.getUint32(),_e=o>=7500?s.getUint64():s.getUint32();o>=7500?s.getUint64():s.getUint32();const tt=s.getUint8(),nt=s.getString(tt);if($===0)return null;const rt=[];for(let ot=0;ot<_e;ot++)rt.push(this.parseProperty(s));const it=rt.length>0?rt[0]:"",st=rt.length>1?rt[1]:"",at=rt.length>2?rt[2]:"";for(j.singleProperty=_e===1&&s.getOffset()===$;$>s.getOffset();){const ot=this.parseNode(s,o);ot!==null&&this.parseSubNode(nt,j,ot)}return j.propertyList=rt,typeof it=="number"&&(j.id=it),st!==""&&(j.attrName=st),at!==""&&(j.attrType=at),nt!==""&&(j.name=nt),j}parseSubNode(s,o,j){if(j.singleProperty===!0){const $=j.propertyList[0];Array.isArray($)?(o[j.name]=j,j.a=$):o[j.name]=$}else if(s==="Connections"&&j.name==="C"){const $=[];j.propertyList.forEach(function(_e,tt){tt!==0&&$.push(_e)}),o.connections===void 0&&(o.connections=[]),o.connections.push($)}else if(j.name==="Properties70")Object.keys(j).forEach(function(_e){o[_e]=j[_e]});else if(s==="Properties70"&&j.name==="P"){let $=j.propertyList[0],_e=j.propertyList[1];const tt=j.propertyList[2],nt=j.propertyList[3];let rt;$.indexOf("Lcl ")===0&&($=$.replace("Lcl ","Lcl_")),_e.indexOf("Lcl ")===0&&(_e=_e.replace("Lcl ","Lcl_")),_e==="Color"||_e==="ColorRGB"||_e==="Vector"||_e==="Vector3D"||_e.indexOf("Lcl_")===0?rt=[j.propertyList[4],j.propertyList[5],j.propertyList[6]]:rt=j.propertyList[4],o[$]={type:_e,type2:tt,flag:nt,value:rt}}else o[j.name]===void 0?typeof j.id=="number"?(o[j.name]={},o[j.name][j.id]=j):o[j.name]=j:j.name==="PoseNode"?(Array.isArray(o[j.name])||(o[j.name]=[o[j.name]]),o[j.name].push(j)):o[j.name][j.id]===void 0&&(o[j.name][j.id]=j)}parseProperty(s){const o=s.getString(1);let j;switch(o){case"C":return s.getBoolean();case"D":return s.getFloat64();case"F":return s.getFloat32();case"I":return s.getInt32();case"L":return s.getInt64();case"R":return j=s.getUint32(),s.getArrayBuffer(j);case"S":return j=s.getUint32(),s.getString(j);case"Y":return s.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const $=s.getUint32(),_e=s.getUint32(),tt=s.getUint32();if(_e===0)switch(o){case"b":case"c":return s.getBooleanArray($);case"d":return s.getFloat64Array($);case"f":return s.getFloat32Array($);case"i":return s.getInt32Array($);case"l":return s.getInt64Array($)}const nt=unzlibSync(new Uint8Array(s.getArrayBuffer(tt))),rt=new BinaryReader(nt.buffer);switch(o){case"b":case"c":return rt.getBooleanArray($);case"d":return rt.getFloat64Array($);case"f":return rt.getFloat32Array($);case"i":return rt.getInt32Array($);case"l":return rt.getInt64Array($)}default:throw new Error("THREE.FBXLoader: Unknown property type "+o)}}}class BinaryReader{constructor(s,o){this.dv=new DataView(s),this.offset=0,this.littleEndian=o!==void 0?o:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(s){this.offset+=s}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(s){const o=[];for(let j=0;j<s;j++)o.push(this.getBoolean());return o}getUint8(){const s=this.dv.getUint8(this.offset);return this.offset+=1,s}getInt16(){const s=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,s}getInt32(){const s=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,s}getInt32Array(s){const o=[];for(let j=0;j<s;j++)o.push(this.getInt32());return o}getUint32(){const s=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,s}getInt64(){let s,o;return this.littleEndian?(s=this.getUint32(),o=this.getUint32()):(o=this.getUint32(),s=this.getUint32()),o&2147483648?(o=~o&4294967295,s=~s&4294967295,s===4294967295&&(o=o+1&4294967295),s=s+1&4294967295,-(o*4294967296+s)):o*4294967296+s}getInt64Array(s){const o=[];for(let j=0;j<s;j++)o.push(this.getInt64());return o}getUint64(){let s,o;return this.littleEndian?(s=this.getUint32(),o=this.getUint32()):(o=this.getUint32(),s=this.getUint32()),o*4294967296+s}getFloat32(){const s=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,s}getFloat32Array(s){const o=[];for(let j=0;j<s;j++)o.push(this.getFloat32());return o}getFloat64(){const s=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,s}getFloat64Array(s){const o=[];for(let j=0;j<s;j++)o.push(this.getFloat64());return o}getArrayBuffer(s){const o=this.dv.buffer.slice(this.offset,this.offset+s);return this.offset+=s,o}getString(s){let o=[];for(let $=0;$<s;$++)o[$]=this.getUint8();const j=o.indexOf(0);return j>=0&&(o=o.slice(0,j)),LoaderUtils.decodeText(new Uint8Array(o))}}class FBXTree{add(s,o){this[s]=o}}function isFbxFormatBinary(a){const s="Kaydara FBX Binary  \0";return a.byteLength>=s.length&&s===convertArrayBufferToString(a,0,s.length)}function isFbxFormatASCII(a){const s=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let o=0;function j($){const _e=a[$-1];return a=a.slice(o+$),o++,_e}for(let $=0;$<s.length;++$)if(j(1)===s[$])return!1;return!0}function getFbxVersion(a){const s=/FBXVersion: (\d+)/,o=a.match(s);if(o)return parseInt(o[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function convertFBXTimeToSeconds(a){return a/46186158e3}const dataArray=[];function getData(a,s,o,j){let $;switch(j.mappingType){case"ByPolygonVertex":$=a;break;case"ByPolygon":$=s;break;case"ByVertice":$=o;break;case"AllSame":$=j.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+j.mappingType)}j.referenceType==="IndexToDirect"&&($=j.indices[$]);const _e=$*j.dataSize,tt=_e+j.dataSize;return slice$1(dataArray,j.buffer,_e,tt)}const tempEuler=new Euler,tempVec=new Vector3;function generateTransform(a){const s=new Matrix4,o=new Matrix4,j=new Matrix4,$=new Matrix4,_e=new Matrix4,tt=new Matrix4,nt=new Matrix4,rt=new Matrix4,it=new Matrix4,st=new Matrix4,at=new Matrix4,ot=new Matrix4,ct=a.inheritType?a.inheritType:0;if(a.translation&&s.setPosition(tempVec.fromArray(a.translation)),a.preRotation){const Rt=a.preRotation.map(MathUtils.degToRad);Rt.push(a.eulerOrder),o.makeRotationFromEuler(tempEuler.fromArray(Rt))}if(a.rotation){const Rt=a.rotation.map(MathUtils.degToRad);Rt.push(a.eulerOrder),j.makeRotationFromEuler(tempEuler.fromArray(Rt))}if(a.postRotation){const Rt=a.postRotation.map(MathUtils.degToRad);Rt.push(a.eulerOrder),$.makeRotationFromEuler(tempEuler.fromArray(Rt)),$.invert()}a.scale&&_e.scale(tempVec.fromArray(a.scale)),a.scalingOffset&&nt.setPosition(tempVec.fromArray(a.scalingOffset)),a.scalingPivot&&tt.setPosition(tempVec.fromArray(a.scalingPivot)),a.rotationOffset&&rt.setPosition(tempVec.fromArray(a.rotationOffset)),a.rotationPivot&&it.setPosition(tempVec.fromArray(a.rotationPivot)),a.parentMatrixWorld&&(at.copy(a.parentMatrix),st.copy(a.parentMatrixWorld));const ft=o.clone().multiply(j).multiply($),ht=new Matrix4;ht.extractRotation(st);const mt=new Matrix4;mt.copyPosition(st);const lt=mt.clone().invert().multiply(st),ut=ht.clone().invert().multiply(lt),dt=_e,gt=new Matrix4;if(ct===0)gt.copy(ht).multiply(ft).multiply(ut).multiply(dt);else if(ct===1)gt.copy(ht).multiply(ut).multiply(ft).multiply(dt);else{const Ut=new Matrix4().scale(new Vector3().setFromMatrixScale(at)).clone().invert(),Ht=ut.clone().multiply(Ut);gt.copy(ht).multiply(ft).multiply(Ht).multiply(dt)}const Et=it.clone().invert(),St=tt.clone().invert();let Tt=s.clone().multiply(rt).multiply(it).multiply(o).multiply(j).multiply($).multiply(Et).multiply(nt).multiply(tt).multiply(_e).multiply(St);const Mt=new Matrix4().copyPosition(Tt),Bt=st.clone().multiply(Mt);return ot.copyPosition(Bt),Tt=ot.clone().multiply(gt),Tt.premultiply(st.invert()),Tt}function getEulerOrder(a){a=a||0;const s=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return a===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),s[0]):s[a]}function parseNumberArray(a){return a.split(",").map(function(o){return parseFloat(o)})}function convertArrayBufferToString(a,s,o){return s===void 0&&(s=0),o===void 0&&(o=a.byteLength),LoaderUtils.decodeText(new Uint8Array(a,s,o))}function append$1(a,s){for(let o=0,j=a.length,$=s.length;o<$;o++,j++)a[j]=s[o]}function slice$1(a,s,o,j){for(let $=o,_e=0;$<j;$++,_e++)a[_e]=s[$];return a}function inject(a,s,o){return a.slice(0,s).concat(o).concat(a.slice(s))}class FontLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials),_e.load(s,tt=>{if(typeof tt!="string")throw new Error("unsupported data type");const nt=JSON.parse(tt),rt=this.parse(nt);o&&o(rt)},j,$)}loadAsync(s,o){return super.loadAsync(s,o)}parse(s){return new Font(s)}}class Font{constructor(s){__publicField(this,"data"),this.data=s}generateShapes(s,o=100,j){const $=[],_e={letterSpacing:0,lineHeight:1,...j},tt=createPaths(s,o,this.data,_e);for(let nt=0,rt=tt.length;nt<rt;nt++)Array.prototype.push.apply($,tt[nt].toShapes(!1));return $}}function createPaths(a,s,o,j){const $=Array.from(a),_e=s/o.resolution,tt=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*_e,nt=[];let rt=0,it=0;for(let st=0;st<$.length;st++){const at=$[st];if(at===`
`)rt=0,it-=tt*j.lineHeight;else{const ot=createPath(at,_e,rt,it,o);ot&&(rt+=ot.offsetX+j.letterSpacing,nt.push(ot.path))}}return nt}function createPath(a,s,o,j,$){const _e=$.glyphs[a]||$.glyphs["?"];if(!_e){console.error('THREE.Font: character "'+a+'" does not exists in font family '+$.familyName+".");return}const tt=new ShapePath;let nt,rt,it,st,at,ot,ct,ft;if(_e.o){const ht=_e._cachedOutline||(_e._cachedOutline=_e.o.split(" "));for(let mt=0,lt=ht.length;mt<lt;)switch(ht[mt++]){case"m":nt=parseInt(ht[mt++])*s+o,rt=parseInt(ht[mt++])*s+j,tt.moveTo(nt,rt);break;case"l":nt=parseInt(ht[mt++])*s+o,rt=parseInt(ht[mt++])*s+j,tt.lineTo(nt,rt);break;case"q":it=parseInt(ht[mt++])*s+o,st=parseInt(ht[mt++])*s+j,at=parseInt(ht[mt++])*s+o,ot=parseInt(ht[mt++])*s+j,tt.quadraticCurveTo(at,ot,it,st);break;case"b":it=parseInt(ht[mt++])*s+o,st=parseInt(ht[mt++])*s+j,at=parseInt(ht[mt++])*s+o,ot=parseInt(ht[mt++])*s+j,ct=parseInt(ht[mt++])*s+o,ft=parseInt(ht[mt++])*s+j,tt.bezierCurveTo(at,ot,ct,ft,it,st);break}}return{offsetX:_e.ha*s,path:tt}}class TGALoader extends DataTextureLoader{constructor(s){super(s)}parse(s){function o(jt){switch(jt.image_type){case ot:case ht:(jt.colormap_length>256||jt.colormap_size!==24||jt.colormap_type!==1)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case ct:case ft:case mt:case lt:jt.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case at:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',jt.image_type)}(jt.width<=0||jt.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),jt.pixel_size!==8&&jt.pixel_size!==16&&jt.pixel_size!==24&&jt.pixel_size!==32&&console.error('THREE.TGALoader: Invalid pixel size "%s".',jt.pixel_size)}function j(jt,Vt,Lt,Qt,nn){let mn,Zt;const cn=Lt.pixel_size>>3,Ot=Lt.width*Lt.height*cn;if(Vt&&(Zt=nn.subarray(Qt,Qt+=Lt.colormap_length*(Lt.colormap_size>>3))),jt){mn=new Uint8Array(Ot);let rn,fn,hn,Tn=0;const Nn=new Uint8Array(cn);for(;Tn<Ot;)if(rn=nn[Qt++],fn=(rn&127)+1,rn&128){for(hn=0;hn<cn;++hn)Nn[hn]=nn[Qt++];for(hn=0;hn<fn;++hn)mn.set(Nn,Tn+hn*cn);Tn+=cn*fn}else{for(fn*=cn,hn=0;hn<fn;++hn)mn[Tn+hn]=nn[Qt++];Tn+=fn}}else mn=nn.subarray(Qt,Qt+=Vt?Lt.width*Lt.height:Ot);return{pixel_data:mn,palettes:Zt}}function $(jt,Vt,Lt,Qt,nn,mn,Zt,cn,Ot){const rn=Ot;let fn,hn=0,Tn,Nn;const Pn=Rt.width;for(Nn=Vt;Nn!==Qt;Nn+=Lt)for(Tn=nn;Tn!==Zt;Tn+=mn,hn++)fn=cn[hn],jt[(Tn+Pn*Nn)*4+3]=255,jt[(Tn+Pn*Nn)*4+2]=rn[fn*3+0],jt[(Tn+Pn*Nn)*4+1]=rn[fn*3+1],jt[(Tn+Pn*Nn)*4+0]=rn[fn*3+2];return jt}function _e(jt,Vt,Lt,Qt,nn,mn,Zt,cn){let Ot,rn=0,fn,hn;const Tn=Rt.width;for(hn=Vt;hn!==Qt;hn+=Lt)for(fn=nn;fn!==Zt;fn+=mn,rn+=2)Ot=cn[rn+0]+(cn[rn+1]<<8),jt[(fn+Tn*hn)*4+0]=(Ot&31744)>>7,jt[(fn+Tn*hn)*4+1]=(Ot&992)>>2,jt[(fn+Tn*hn)*4+2]=(Ot&31)>>3,jt[(fn+Tn*hn)*4+3]=Ot&32768?0:255;return jt}function tt(jt,Vt,Lt,Qt,nn,mn,Zt,cn){let Ot=0,rn,fn;const hn=Rt.width;for(fn=Vt;fn!==Qt;fn+=Lt)for(rn=nn;rn!==Zt;rn+=mn,Ot+=3)jt[(rn+hn*fn)*4+3]=255,jt[(rn+hn*fn)*4+2]=cn[Ot+0],jt[(rn+hn*fn)*4+1]=cn[Ot+1],jt[(rn+hn*fn)*4+0]=cn[Ot+2];return jt}function nt(jt,Vt,Lt,Qt,nn,mn,Zt,cn){let Ot=0,rn,fn;const hn=Rt.width;for(fn=Vt;fn!==Qt;fn+=Lt)for(rn=nn;rn!==Zt;rn+=mn,Ot+=4)jt[(rn+hn*fn)*4+2]=cn[Ot+0],jt[(rn+hn*fn)*4+1]=cn[Ot+1],jt[(rn+hn*fn)*4+0]=cn[Ot+2],jt[(rn+hn*fn)*4+3]=cn[Ot+3];return jt}function rt(jt,Vt,Lt,Qt,nn,mn,Zt,cn){let Ot,rn=0,fn,hn;const Tn=Rt.width;for(hn=Vt;hn!==Qt;hn+=Lt)for(fn=nn;fn!==Zt;fn+=mn,rn++)Ot=cn[rn],jt[(fn+Tn*hn)*4+0]=Ot,jt[(fn+Tn*hn)*4+1]=Ot,jt[(fn+Tn*hn)*4+2]=Ot,jt[(fn+Tn*hn)*4+3]=255;return jt}function it(jt,Vt,Lt,Qt,nn,mn,Zt,cn){let Ot=0,rn,fn;const hn=Rt.width;for(fn=Vt;fn!==Qt;fn+=Lt)for(rn=nn;rn!==Zt;rn+=mn,Ot+=2)jt[(rn+hn*fn)*4+0]=cn[Ot+0],jt[(rn+hn*fn)*4+1]=cn[Ot+0],jt[(rn+hn*fn)*4+2]=cn[Ot+0],jt[(rn+hn*fn)*4+3]=cn[Ot+1];return jt}function st(jt,Vt,Lt,Qt,nn){let mn,Zt,cn,Ot,rn,fn;switch((Rt.flags&ut)>>dt){default:case St:mn=0,cn=1,rn=Vt,Zt=0,Ot=1,fn=Lt;break;case gt:mn=0,cn=1,rn=Vt,Zt=Lt-1,Ot=-1,fn=-1;break;case Tt:mn=Vt-1,cn=-1,rn=-1,Zt=0,Ot=1,fn=Lt;break;case Et:mn=Vt-1,cn=-1,rn=-1,Zt=Lt-1,Ot=-1,fn=-1;break}if(Wt)switch(Rt.pixel_size){case 8:rt(jt,Zt,Ot,fn,mn,cn,rn,Qt);break;case 16:it(jt,Zt,Ot,fn,mn,cn,rn,Qt);break;default:console.error("THREE.TGALoader: Format not supported.");break}else switch(Rt.pixel_size){case 8:$(jt,Zt,Ot,fn,mn,cn,rn,Qt,nn);break;case 16:_e(jt,Zt,Ot,fn,mn,cn,rn,Qt);break;case 24:tt(jt,Zt,Ot,fn,mn,cn,rn,Qt);break;case 32:nt(jt,Zt,Ot,fn,mn,cn,rn,Qt);break;default:console.error("THREE.TGALoader: Format not supported.");break}return jt}const at=0,ot=1,ct=2,ft=3,ht=9,mt=10,lt=11,ut=48,dt=4,gt=0,Et=1,St=2,Tt=3;s.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let Mt=0;const Bt=new Uint8Array(s),Rt={id_length:Bt[Mt++],colormap_type:Bt[Mt++],image_type:Bt[Mt++],colormap_index:Bt[Mt++]|Bt[Mt++]<<8,colormap_length:Bt[Mt++]|Bt[Mt++]<<8,colormap_size:Bt[Mt++],origin:[Bt[Mt++]|Bt[Mt++]<<8,Bt[Mt++]|Bt[Mt++]<<8],width:Bt[Mt++]|Bt[Mt++]<<8,height:Bt[Mt++]|Bt[Mt++]<<8,pixel_size:Bt[Mt++],flags:Bt[Mt++]};o(Rt),Rt.id_length+Mt>s.length&&console.error("THREE.TGALoader: No data."),Mt+=Rt.id_length;let Ut=!1,Ht=!1,Wt=!1;switch(Rt.image_type){case ht:Ut=!0,Ht=!0;break;case ot:Ht=!0;break;case mt:Ut=!0;break;case ct:break;case lt:Ut=!0,Wt=!0;break;case ft:Wt=!0;break}const Jt=new Uint8Array(Rt.width*Rt.height*4),sn=j(Ut,Ht,Rt,Mt,Bt);return st(Jt,Rt.width,Rt.height,sn.pixel_data,sn.palettes),{data:Jt,width:Rt.width,height:Rt.height,flipY:!0,generateMipmaps:!0,minFilter:LinearMipmapLinearFilter}}}class Data3DTexture extends Texture{constructor(s=null,o=1,j=1,$=1){super(null),this.isData3DTexture=!0,this.image={data:s,width:o,height:j,depth:$},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class LUTCubeLoader extends Loader{load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setResponseType("text"),_e.load(s,tt=>{try{o(this.parse(tt))}catch(nt){$?$(nt):console.error(nt),this.manager.itemError(s)}},j,$)}parse(s){s=s.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim();let o=null,j=null;const $=new Vector3(0,0,0),_e=new Vector3(1,1,1),tt=s.split(/[\n\r]+/g);let nt=null,rt=0;for(let at=0,ot=tt.length;at<ot;at++){const ct=tt[at].trim(),ft=ct.split(/\s/g);switch(ft[0]){case"TITLE":o=ct.substring(7,ct.length-1);break;case"LUT_3D_SIZE":const ht=ft[1];j=parseFloat(ht),nt=new Uint8Array(j*j*j*4);break;case"DOMAIN_MIN":$.x=parseFloat(ft[1]),$.y=parseFloat(ft[2]),$.z=parseFloat(ft[3]);break;case"DOMAIN_MAX":_e.x=parseFloat(ft[1]),_e.y=parseFloat(ft[2]),_e.z=parseFloat(ft[3]);break;default:const mt=parseFloat(ft[0]),lt=parseFloat(ft[1]),ut=parseFloat(ft[2]);if(mt>1||mt<0||lt>1||lt<0||ut>1||ut<0)throw new Error("LUTCubeLoader : Non normalized values not supported.");nt[rt+0]=mt*255,nt[rt+1]=lt*255,nt[rt+2]=ut*255,nt[rt+3]=255,rt+=4}}const it=new DataTexture;it.image.data=nt,it.image.width=j,it.image.height=j*j,it.type=UnsignedByteType,it.magFilter=LinearFilter,it.minFilter=LinearFilter,it.wrapS=ClampToEdgeWrapping,it.wrapT=ClampToEdgeWrapping,it.generateMipmaps=!1,it.needsUpdate=!0;const st=new Data3DTexture;return st.image.data=nt,st.image.width=j,st.image.height=j,st.image.depth=j,st.type=UnsignedByteType,st.magFilter=LinearFilter,st.minFilter=LinearFilter,st.wrapS=ClampToEdgeWrapping,st.wrapT=ClampToEdgeWrapping,st.wrapR=ClampToEdgeWrapping,st.generateMipmaps=!1,st.needsUpdate=!0,{title:o,size:j,domainMin:$,domainMax:_e,texture:it,texture3D:st}}}class NRRDLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){let o=s,j=0;const $=new Int8Array(new Int16Array([1]).buffer)[0]>0,_e=!0,tt={};function nt(Rt,Ut){Ut==null&&(Ut=1);let Ht=1,Wt=Uint8Array;switch(Rt){case"uchar":break;case"schar":Wt=Int8Array;break;case"ushort":Wt=Uint16Array,Ht=2;break;case"sshort":Wt=Int16Array,Ht=2;break;case"uint":Wt=Uint32Array,Ht=4;break;case"sint":Wt=Int32Array,Ht=4;break;case"float":Wt=Float32Array,Ht=4;break;case"complex":Wt=Float64Array,Ht=8;break;case"double":Wt=Float64Array,Ht=8;break}let Jt=new Wt(o.slice(j,j+=Ut*Ht));return $!=_e&&(Jt=rt(Jt,Ht)),Ut==1?Jt[0]:Jt}function rt(Rt,Ut){const Ht=new Uint8Array(Rt.buffer,Rt.byteOffset,Rt.byteLength);for(let Wt=0;Wt<Rt.byteLength;Wt+=Ut)for(let Jt=Wt+Ut-1,sn=Wt;Jt>sn;Jt--,sn++){const jt=Ht[sn];Ht[sn]=Ht[Jt],Ht[Jt]=jt}return Rt}function it(Rt){let Ut,Ht,Wt,Jt,sn,jt,Vt,Lt;const Qt=Rt.split(/\r?\n/);for(Vt=0,Lt=Qt.length;Vt<Lt;Vt++)sn=Qt[Vt],sn.match(/NRRD\d+/)?tt.isNrrd=!0:sn.match(/^#/)||(jt=sn.match(/(.*):(.*)/))&&(Ht=jt[1].trim(),Ut=jt[2].trim(),Wt=_fieldFunctions[Ht],Wt?Wt.call(tt,Ut):tt[Ht]=Ut);if(!tt.isNrrd)throw new Error("Not an NRRD file");if(tt.encoding==="bz2"||tt.encoding==="bzip2")throw new Error("Bzip is not supported");if(!tt.vectors&&(tt.vectors=[new Vector3(1,0,0),new Vector3(0,1,0),new Vector3(0,0,1)],tt.spacings))for(Jt=0;Jt<=2;Jt++)isNaN(tt.spacings[Jt])||tt.vectors[Jt].multiplyScalar(tt.spacings[Jt])}function st(Rt,Ut,Ht){let Wt="";Ut=Ut||0,Ht=Ht||Rt.length;let Jt;const sn=tt.sizes.reduce(function(nn,mn){return nn*mn},1);let jt=10;tt.encoding==="hex"&&(jt=16);const Vt=new tt.__array(sn);let Lt=0,Qt=parseInt;(tt.__array===Float32Array||tt.__array===Float64Array)&&(Qt=parseFloat);for(let nn=Ut;nn<Ht;nn++)Jt=Rt[nn],(Jt<9||Jt>13)&&Jt!==32?Wt+=String.fromCharCode(Jt):(Wt!==""&&(Vt[Lt]=Qt(Wt,jt),Lt++),Wt="");return Wt!==""&&(Vt[Lt]=Qt(Wt,jt),Lt++),Vt}const at=nt("uchar",s.byteLength),ot=at.length;let ct=null,ft=0,ht;for(ht=1;ht<ot;ht++)if(at[ht-1]==10&&at[ht]==10){ct=this.parseChars(at,0,ht-2),ft=ht+1;break}if(it(ct),o=at.subarray(ft),tt.encoding.substring(0,2)==="gz")o=gunzipSync(new Uint8Array(o));else if(tt.encoding==="ascii"||tt.encoding==="text"||tt.encoding==="txt"||tt.encoding==="hex")o=st(o);else if(tt.encoding==="raw"){const Rt=new Uint8Array(o.length);for(let Ut=0;Ut<o.length;Ut++)Rt[Ut]=o[Ut];o=Rt}o=o.buffer;const mt=new Volume;mt.header=tt,mt.data=new tt.__array(o);const lt=mt.computeMinMax(),ut=lt[0],dt=lt[1];mt.windowLow=ut,mt.windowHigh=dt,mt.dimensions=[tt.sizes[0],tt.sizes[1],tt.sizes[2]],mt.xLength=mt.dimensions[0],mt.yLength=mt.dimensions[1],mt.zLength=mt.dimensions[2];const gt=new Vector3(tt.vectors[0][0],tt.vectors[0][1],tt.vectors[0][2]).length(),Et=new Vector3(tt.vectors[1][0],tt.vectors[1][1],tt.vectors[1][2]).length(),St=new Vector3(tt.vectors[2][0],tt.vectors[2][1],tt.vectors[2][2]).length();mt.spacing=[gt,Et,St],mt.matrix=new Matrix4;let Tt=1,Mt=1;const Bt=1;if(tt.space=="left-posterior-superior"?(Tt=-1,Mt=-1):tt.space==="left-anterior-superior"&&(Tt=-1),!tt.vectors)mt.matrix.set(Tt,0,0,0,0,Mt,0,0,0,0,Bt,0,0,0,0,1);else{const Rt=tt.vectors;mt.matrix.set(Tt*Rt[0][0],Tt*Rt[1][0],Tt*Rt[2][0],0,Mt*Rt[0][1],Mt*Rt[1][1],Mt*Rt[2][1],0,Bt*Rt[0][2],Bt*Rt[1][2],Bt*Rt[2][2],0,0,0,0,1)}return mt.inverseMatrix=new Matrix4,mt.inverseMatrix.copy(mt.matrix).invert(),mt.RASDimensions=new Vector3(mt.xLength,mt.yLength,mt.zLength).applyMatrix4(mt.matrix).round().toArray().map(Math.abs),mt.lowerThreshold===-1/0&&(mt.lowerThreshold=ut),mt.upperThreshold===1/0&&(mt.upperThreshold=dt),mt}parseChars(s,o,j){o===void 0&&(o=0),j===void 0&&(j=s.length);let $="",_e=0;for(_e=o;_e<j;++_e)$+=String.fromCharCode(s[_e]);return $}}const _fieldFunctions={type:function(a){switch(a){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+a)}return this.type=a},endian:function(a){return this.endian=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.dim=parseInt(a,10)},sizes:function(a){let s;return this.sizes=function(){const o=a.split(/\s+/),j=[];for(let $=0,_e=o.length;$<_e;$++)s=o[$],j.push(parseInt(s,10));return j}()},space:function(a){return this.space=a},"space origin":function(a){return this.space_origin=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){let s,o;const j=a.match(/\(.*?\)/g);return this.vectors=function(){const $=[];for(let _e=0,tt=j.length;_e<tt;_e++)o=j[_e],$.push(function(){const nt=o.slice(1,-1).split(/,/),rt=[];for(let it=0,st=nt.length;it<st;it++)s=nt[it],rt.push(parseFloat(s));return rt}());return $}()},spacings:function(a){let s;const o=a.split(/\s+/);return this.spacings=function(){const j=[];for(let $=0,_e=o.length;$<_e;$++)s=o[$],j.push(parseFloat(s));return j}()}};class STLLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(it){const st=new DataView(it),at=32/8*3+32/8*3*3+16/8,ot=st.getUint32(80,!0);if(80+32/8+ot*at===st.byteLength)return!0;const ft=[115,111,108,105,100];for(let ht=0;ht<5;ht++)if(j(ft,st,ht))return!1;return!0}function j(it,st,at){for(let ot=0,ct=it.length;ot<ct;ot++)if(it[ot]!==st.getUint8(at+ot,!1))return!1;return!0}function $(it){const st=new DataView(it),at=st.getUint32(80,!0);let ot,ct,ft,ht=!1,mt,lt,ut,dt,gt;for(let Rt=0;Rt<80-10;Rt++)st.getUint32(Rt,!1)==1129270351&&st.getUint8(Rt+4)==82&&st.getUint8(Rt+5)==61&&(ht=!0,mt=new Float32Array(at*3*3),lt=st.getUint8(Rt+6)/255,ut=st.getUint8(Rt+7)/255,dt=st.getUint8(Rt+8)/255,gt=st.getUint8(Rt+9)/255);const Et=84,St=12*4+2,Tt=new BufferGeometry,Mt=new Float32Array(at*3*3),Bt=new Float32Array(at*3*3);for(let Rt=0;Rt<at;Rt++){const Ut=Et+Rt*St,Ht=st.getFloat32(Ut,!0),Wt=st.getFloat32(Ut+4,!0),Jt=st.getFloat32(Ut+8,!0);if(ht){const sn=st.getUint16(Ut+48,!0);sn&32768?(ot=lt,ct=ut,ft=dt):(ot=(sn&31)/31,ct=(sn>>5&31)/31,ft=(sn>>10&31)/31)}for(let sn=1;sn<=3;sn++){const jt=Ut+sn*12,Vt=Rt*3*3+(sn-1)*3;Mt[Vt]=st.getFloat32(jt,!0),Mt[Vt+1]=st.getFloat32(jt+4,!0),Mt[Vt+2]=st.getFloat32(jt+8,!0),Bt[Vt]=Ht,Bt[Vt+1]=Wt,Bt[Vt+2]=Jt,ht&&(mt[Vt]=ot,mt[Vt+1]=ct,mt[Vt+2]=ft)}}return Tt.setAttribute("position",new BufferAttribute(Mt,3)),Tt.setAttribute("normal",new BufferAttribute(Bt,3)),ht&&(Tt.setAttribute("color",new BufferAttribute(mt,3)),Tt.hasColors=!0,Tt.alpha=gt),Tt}function _e(it){const st=new BufferGeometry,at=/solid([\s\S]*?)endsolid/g,ot=/facet([\s\S]*?)endfacet/g;let ct=0;const ft=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,ht=new RegExp("vertex"+ft+ft+ft,"g"),mt=new RegExp("normal"+ft+ft+ft,"g"),lt=[],ut=[],dt=new Vector3;let gt,Et=0,St=0,Tt=0;for(;(gt=at.exec(it))!==null;){St=Tt;const Mt=gt[0];for(;(gt=ot.exec(Mt))!==null;){let Ut=0,Ht=0;const Wt=gt[0];for(;(gt=mt.exec(Wt))!==null;)dt.x=parseFloat(gt[1]),dt.y=parseFloat(gt[2]),dt.z=parseFloat(gt[3]),Ht++;for(;(gt=ht.exec(Wt))!==null;)lt.push(parseFloat(gt[1]),parseFloat(gt[2]),parseFloat(gt[3])),ut.push(dt.x,dt.y,dt.z),Ut++,Tt++;Ht!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+ct),Ut!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+ct),ct++}const Bt=St,Rt=Tt-St;st.addGroup(Bt,Rt,Et),Et++}return st.setAttribute("position",new Float32BufferAttribute(lt,3)),st.setAttribute("normal",new Float32BufferAttribute(ut,3)),st}function tt(it){return typeof it!="string"?LoaderUtils.decodeText(new Uint8Array(it)):it}function nt(it){if(typeof it=="string"){const st=new Uint8Array(it.length);for(let at=0;at<it.length;at++)st[at]=it.charCodeAt(at)&255;return st.buffer||st}else return it}const rt=nt(s);return o(rt)?$(rt):_e(tt(s))}}class MTLLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=this.path===""?LoaderUtils.extractUrlBase(s):this.path,nt=new FileLoader(this.manager);nt.setPath(this.path),nt.setRequestHeader(this.requestHeader),nt.setWithCredentials(this.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}setMaterialOptions(s){return this.materialOptions=s,this}parse(s,o){const j=s.split(`
`);let $={};const _e=/\s+/,tt={};for(let rt=0;rt<j.length;rt++){let it=j[rt];if(it=it.trim(),it.length===0||it.charAt(0)==="#")continue;const st=it.indexOf(" ");let at=st>=0?it.substring(0,st):it;at=at.toLowerCase();let ot=st>=0?it.substring(st+1):"";if(ot=ot.trim(),at==="newmtl")$={name:ot},tt[ot]=$;else if(at==="ka"||at==="kd"||at==="ks"||at==="ke"){const ct=ot.split(_e,3);$[at]=[parseFloat(ct[0]),parseFloat(ct[1]),parseFloat(ct[2])]}else $[at]=ot}const nt=new MaterialCreator(this.resourcePath||o,this.materialOptions);return nt.setCrossOrigin(this.crossOrigin),nt.setManager(this.manager),nt.setMaterials(tt),nt}}class MaterialCreator{constructor(s="",o={}){this.baseUrl=s,this.options=o,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:RepeatWrapping}setCrossOrigin(s){return this.crossOrigin=s,this}setManager(s){this.manager=s}setMaterials(s){this.materialsInfo=this.convert(s),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(s){if(!this.options)return s;const o={};for(const j in s){const $=s[j],_e={};o[j]=_e;for(const tt in $){let nt=!0,rt=$[tt];const it=tt.toLowerCase();switch(it){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(rt=[rt[0]/255,rt[1]/255,rt[2]/255]),this.options&&this.options.ignoreZeroRGBs&&rt[0]===0&&rt[1]===0&&rt[2]===0&&(nt=!1);break}nt&&(_e[it]=rt)}}return o}preload(){for(const s in this.materialsInfo)this.create(s)}getIndex(s){return this.nameLookup[s]}getAsArray(){let s=0;for(const o in this.materialsInfo)this.materialsArray[s]=this.create(o),this.nameLookup[o]=s,s++;return this.materialsArray}create(s){return this.materials[s]===void 0&&this.createMaterial_(s),this.materials[s]}createMaterial_(s){const o=this,j=this.materialsInfo[s],$={name:s,side:this.side};function _e(nt,rt){return typeof rt!="string"||rt===""?"":/^https?:\/\//i.test(rt)?rt:nt+rt}function tt(nt,rt){if($[nt])return;const it=o.getTextureParams(rt,$),st=o.loadTexture(_e(o.baseUrl,it.url));st.repeat.copy(it.scale),st.offset.copy(it.offset),st.wrapS=o.wrap,st.wrapT=o.wrap,$[nt]=st}for(const nt in j){const rt=j[nt];let it;if(rt!=="")switch(nt.toLowerCase()){case"kd":$.color=new Color().fromArray(rt);break;case"ks":$.specular=new Color().fromArray(rt);break;case"ke":$.emissive=new Color().fromArray(rt);break;case"map_kd":tt("map",rt);break;case"map_ks":tt("specularMap",rt);break;case"map_ke":tt("emissiveMap",rt);break;case"norm":tt("normalMap",rt);break;case"map_bump":case"bump":tt("bumpMap",rt);break;case"map_d":tt("alphaMap",rt),$.transparent=!0;break;case"ns":$.shininess=parseFloat(rt);break;case"d":it=parseFloat(rt),it<1&&($.opacity=it,$.transparent=!0);break;case"tr":it=parseFloat(rt),this.options&&this.options.invertTrProperty&&(it=1-it),it>0&&($.opacity=1-it,$.transparent=!0);break}}return this.materials[s]=new MeshPhongMaterial($),this.materials[s]}getTextureParams(s,o){const j={scale:new Vector2(1,1),offset:new Vector2(0,0)},$=s.split(/\s+/);let _e;return _e=$.indexOf("-bm"),_e>=0&&(o.bumpScale=parseFloat($[_e+1]),$.splice(_e,2)),_e=$.indexOf("-s"),_e>=0&&(j.scale.set(parseFloat($[_e+1]),parseFloat($[_e+2])),$.splice(_e,4)),_e=$.indexOf("-o"),_e>=0&&(j.offset.set(parseFloat($[_e+1]),parseFloat($[_e+2])),$.splice(_e,4)),j.url=$.join(" ").trim(),j}loadTexture(s,o,j,$,_e){const tt=this.manager!==void 0?this.manager:DefaultLoadingManager;let nt=tt.getHandler(s);nt===null&&(nt=new TextureLoader(tt)),nt.setCrossOrigin&&nt.setCrossOrigin(this.crossOrigin);const rt=nt.load(s,j,$,_e);return o!==void 0&&(rt.mapping=o),rt}}class BVHLoader extends Loader{constructor(s){super(s),this.animateBonePositions=!0,this.animateBoneRotations=!0}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(ct){nt(ct)!=="HIERARCHY"&&console.error("THREE.BVHLoader: HIERARCHY expected.");const ft=[],ht=$(ct,nt(ct),ft);nt(ct)!=="MOTION"&&console.error("THREE.BVHLoader: MOTION expected.");let mt=nt(ct).split(/[\s]+/);const lt=parseInt(mt[1]);isNaN(lt)&&console.error("THREE.BVHLoader: Failed to read number of frames."),mt=nt(ct).split(/[\s]+/);const ut=parseFloat(mt[2]);isNaN(ut)&&console.error("THREE.BVHLoader: Failed to read frame time.");for(let dt=0;dt<lt;dt++)mt=nt(ct).split(/[\s]+/),j(mt,dt*ut,ht);return ft}function j(ct,ft,ht){if(ht.type==="ENDSITE")return;const mt={time:ft,position:new Vector3,rotation:new Quaternion};ht.frames.push(mt);const lt=new Quaternion,ut=new Vector3(1,0,0),dt=new Vector3(0,1,0),gt=new Vector3(0,0,1);for(let Et=0;Et<ht.channels.length;Et++)switch(ht.channels[Et]){case"Xposition":mt.position.x=parseFloat(ct.shift().trim());break;case"Yposition":mt.position.y=parseFloat(ct.shift().trim());break;case"Zposition":mt.position.z=parseFloat(ct.shift().trim());break;case"Xrotation":lt.setFromAxisAngle(ut,parseFloat(ct.shift().trim())*Math.PI/180),mt.rotation.multiply(lt);break;case"Yrotation":lt.setFromAxisAngle(dt,parseFloat(ct.shift().trim())*Math.PI/180),mt.rotation.multiply(lt);break;case"Zrotation":lt.setFromAxisAngle(gt,parseFloat(ct.shift().trim())*Math.PI/180),mt.rotation.multiply(lt);break;default:console.warn("THREE.BVHLoader: Invalid channel type.")}for(let Et=0;Et<ht.children.length;Et++)j(ct,ft,ht.children[Et])}function $(ct,ft,ht){const mt={name:"",type:"",frames:[]};ht.push(mt);let lt=ft.split(/[\s]+/);lt[0].toUpperCase()==="END"&&lt[1].toUpperCase()==="SITE"?(mt.type="ENDSITE",mt.name="ENDSITE"):(mt.name=lt[1],mt.type=lt[0].toUpperCase()),nt(ct)!=="{"&&console.error("THREE.BVHLoader: Expected opening { after type & name"),lt=nt(ct).split(/[\s]+/),lt[0]!=="OFFSET"&&console.error("THREE.BVHLoader: Expected OFFSET but got: "+lt[0]),lt.length!==4&&console.error("THREE.BVHLoader: Invalid number of values for OFFSET.");const ut=new Vector3(parseFloat(lt[1]),parseFloat(lt[2]),parseFloat(lt[3]));if((isNaN(ut.x)||isNaN(ut.y)||isNaN(ut.z))&&console.error("THREE.BVHLoader: Invalid values of OFFSET."),mt.offset=ut,mt.type!=="ENDSITE"){lt=nt(ct).split(/[\s]+/),lt[0]!=="CHANNELS"&&console.error("THREE.BVHLoader: Expected CHANNELS definition.");const dt=parseInt(lt[1]);mt.channels=lt.splice(2,dt),mt.children=[]}for(;;){const dt=nt(ct);if(dt==="}")return mt;mt.children.push($(ct,dt,ht))}}function _e(ct,ft){const ht=new Bone;if(ft.push(ht),ht.position.add(ct.offset),ht.name=ct.name,ct.type!=="ENDSITE")for(let mt=0;mt<ct.children.length;mt++)ht.add(_e(ct.children[mt],ft));return ht}function tt(ct){const ft=[];for(let ht=0;ht<ct.length;ht++){const mt=ct[ht];if(mt.type==="ENDSITE")continue;const lt=[],ut=[],dt=[];for(let gt=0;gt<mt.frames.length;gt++){const Et=mt.frames[gt];lt.push(Et.time),ut.push(Et.position.x+mt.offset.x),ut.push(Et.position.y+mt.offset.y),ut.push(Et.position.z+mt.offset.z),dt.push(Et.rotation.x),dt.push(Et.rotation.y),dt.push(Et.rotation.z),dt.push(Et.rotation.w)}rt.animateBonePositions&&ft.push(new VectorKeyframeTrack(".bones["+mt.name+"].position",lt,ut)),rt.animateBoneRotations&&ft.push(new QuaternionKeyframeTrack(".bones["+mt.name+"].quaternion",lt,dt))}return new AnimationClip("animation",-1,ft)}function nt(ct){let ft;for(;(ft=ct.shift().trim()).length===0;);return ft}const rt=this,it=s.split(/[\r\n]+/g),st=o(it),at=[];_e(st[0],at);const ot=tt(st);return{skeleton:new Skeleton(at),clip:ot}}}class ColladaLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=_e.path===""?LoaderUtils.extractUrlBase(s):_e.path,nt=new FileLoader(_e.manager);nt.setPath(_e.path),nt.setRequestHeader(_e.requestHeader),nt.setWithCredentials(_e.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}parse(s,o){function j(_n,vn){const Bn=[],wn=_n.childNodes;for(let Fn=0,fr=wn.length;Fn<fr;Fn++){const Er=wn[Fn];Er.nodeName===vn&&Bn.push(Er)}return Bn}function $(_n){if(_n.length===0)return[];const vn=_n.trim().split(/\s+/),Bn=new Array(vn.length);for(let wn=0,Fn=vn.length;wn<Fn;wn++)Bn[wn]=vn[wn];return Bn}function _e(_n){if(_n.length===0)return[];const vn=_n.trim().split(/\s+/),Bn=new Array(vn.length);for(let wn=0,Fn=vn.length;wn<Fn;wn++)Bn[wn]=parseFloat(vn[wn]);return Bn}function tt(_n){if(_n.length===0)return[];const vn=_n.trim().split(/\s+/),Bn=new Array(vn.length);for(let wn=0,Fn=vn.length;wn<Fn;wn++)Bn[wn]=parseInt(vn[wn]);return Bn}function nt(_n){return _n.substring(1)}function rt(){return"three_default_"+_d++}function it(_n){return Object.keys(_n).length===0}function st(_n){return{unit:at(j(_n,"unit")[0]),upAxis:ot(j(_n,"up_axis")[0])}}function at(_n){return _n!==void 0&&_n.hasAttribute("meter")===!0?parseFloat(_n.getAttribute("meter")):1}function ot(_n){return _n!==void 0?_n.textContent:"Y_UP"}function ct(_n,vn,Bn,wn){const Fn=j(_n,vn)[0];if(Fn!==void 0){const fr=j(Fn,Bn);for(let Er=0;Er<fr.length;Er++)wn(fr[Er])}}function ft(_n,vn){for(const Bn in _n){const wn=_n[Bn];wn.build=vn(_n[Bn])}}function ht(_n,vn){return _n.build!==void 0||(_n.build=vn(_n)),_n.build}function mt(_n){const vn={sources:{},samplers:{},channels:{}};let Bn=!1;for(let wn=0,Fn=_n.childNodes.length;wn<Fn;wn++){const fr=_n.childNodes[wn];if(fr.nodeType!==1)continue;let Er;switch(fr.nodeName){case"source":Er=fr.getAttribute("id"),vn.sources[Er]=qn(fr);break;case"sampler":Er=fr.getAttribute("id"),vn.samplers[Er]=lt(fr);break;case"channel":Er=fr.getAttribute("target"),vn.channels[Er]=ut(fr);break;case"animation":mt(fr),Bn=!0;break;default:console.log(fr)}}Bn===!1&&(fs.animations[_n.getAttribute("id")||MathUtils.generateUUID()]=vn)}function lt(_n){const vn={inputs:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"input":const fr=nt(Fn.getAttribute("source")),Er=Fn.getAttribute("semantic");vn.inputs[Er]=fr;break}}return vn}function ut(_n){const vn={};let wn=_n.getAttribute("target").split("/");const Fn=wn.shift();let fr=wn.shift();const Er=fr.indexOf("(")!==-1,Tr=fr.indexOf(".")!==-1;if(Tr)wn=fr.split("."),fr=wn.shift(),vn.member=wn.shift();else if(Er){const _i=fr.split("(");fr=_i.shift();for(let Yr=0;Yr<_i.length;Yr++)_i[Yr]=parseInt(_i[Yr].replace(/\)/,""));vn.indices=_i}return vn.id=Fn,vn.sid=fr,vn.arraySyntax=Er,vn.memberSyntax=Tr,vn.sampler=nt(_n.getAttribute("source")),vn}function dt(_n){const vn=[],Bn=_n.channels,wn=_n.samplers,Fn=_n.sources;for(const fr in Bn)if(Bn.hasOwnProperty(fr)){const Er=Bn[fr],Tr=wn[Er.sampler],_i=Tr.inputs.INPUT,Yr=Tr.inputs.OUTPUT,Qr=Fn[_i],Dr=Fn[Yr],vs=Et(Er,Qr,Dr);Rt(vs,vn)}return vn}function gt(_n){return ht(fs.animations[_n],dt)}function Et(_n,vn,Bn){const wn=fs.nodes[_n.id],Fn=ts(wn.id),fr=wn.transforms[_n.sid],Er=wn.matrix.clone().transpose();let Tr,_i,Yr,Qr,Dr,vs;const Vr={};switch(fr){case"matrix":for(Yr=0,Qr=vn.array.length;Yr<Qr;Yr++)if(Tr=vn.array[Yr],_i=Yr*Bn.stride,Vr[Tr]===void 0&&(Vr[Tr]={}),_n.arraySyntax===!0){const io=Bn.array[_i],Xs=_n.indices[0]+4*_n.indices[1];Vr[Tr][Xs]=io}else for(Dr=0,vs=Bn.stride;Dr<vs;Dr++)Vr[Tr][Dr]=Bn.array[_i+Dr];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',fr);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',fr);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',fr);break}const ms=St(Vr,Er);return{name:Fn.uuid,keyframes:ms}}function St(_n,vn){const Bn=[];for(const Fn in _n)Bn.push({time:parseFloat(Fn),value:_n[Fn]});Bn.sort(wn);for(let Fn=0;Fn<16;Fn++)Ut(Bn,Fn,vn.elements[Fn]);return Bn;function wn(Fn,fr){return Fn.time-fr.time}}const Tt=new Vector3,Mt=new Vector3,Bt=new Quaternion;function Rt(_n,vn){const Bn=_n.keyframes,wn=_n.name,Fn=[],fr=[],Er=[],Tr=[];for(let _i=0,Yr=Bn.length;_i<Yr;_i++){const Qr=Bn[_i],Dr=Qr.time,vs=Qr.value;ar.fromArray(vs).transpose(),ar.decompose(Tt,Bt,Mt),Fn.push(Dr),fr.push(Tt.x,Tt.y,Tt.z),Er.push(Bt.x,Bt.y,Bt.z,Bt.w),Tr.push(Mt.x,Mt.y,Mt.z)}return fr.length>0&&vn.push(new VectorKeyframeTrack(wn+".position",Fn,fr)),Er.length>0&&vn.push(new QuaternionKeyframeTrack(wn+".quaternion",Fn,Er)),Tr.length>0&&vn.push(new VectorKeyframeTrack(wn+".scale",Fn,Tr)),vn}function Ut(_n,vn,Bn){let wn,Fn=!0,fr,Er;for(fr=0,Er=_n.length;fr<Er;fr++)wn=_n[fr],wn.value[vn]===void 0?wn.value[vn]=null:Fn=!1;if(Fn===!0)for(fr=0,Er=_n.length;fr<Er;fr++)wn=_n[fr],wn.value[vn]=Bn;else Ht(_n,vn)}function Ht(_n,vn){let Bn,wn;for(let Fn=0,fr=_n.length;Fn<fr;Fn++){const Er=_n[Fn];if(Er.value[vn]===null){if(Bn=Wt(_n,Fn,vn),wn=Jt(_n,Fn,vn),Bn===null){Er.value[vn]=wn.value[vn];continue}if(wn===null){Er.value[vn]=Bn.value[vn];continue}sn(Er,Bn,wn,vn)}}}function Wt(_n,vn,Bn){for(;vn>=0;){const wn=_n[vn];if(wn.value[Bn]!==null)return wn;vn--}return null}function Jt(_n,vn,Bn){for(;vn<_n.length;){const wn=_n[vn];if(wn.value[Bn]!==null)return wn;vn++}return null}function sn(_n,vn,Bn,wn){if(Bn.time-vn.time===0){_n.value[wn]=vn.value[wn];return}_n.value[wn]=(_n.time-vn.time)*(Bn.value[wn]-vn.value[wn])/(Bn.time-vn.time)+vn.value[wn]}function jt(_n){const vn={name:_n.getAttribute("id")||"default",start:parseFloat(_n.getAttribute("start")||0),end:parseFloat(_n.getAttribute("end")||0),animations:[]};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"instance_animation":vn.animations.push(nt(Fn.getAttribute("url")));break}}fs.clips[_n.getAttribute("id")]=vn}function Vt(_n){const vn=[],Bn=_n.name,wn=_n.end-_n.start||-1,Fn=_n.animations;for(let fr=0,Er=Fn.length;fr<Er;fr++){const Tr=gt(Fn[fr]);for(let _i=0,Yr=Tr.length;_i<Yr;_i++)vn.push(Tr[_i])}return new AnimationClip(Bn,wn,vn)}function Lt(_n){return ht(fs.clips[_n],Vt)}function Qt(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"skin":vn.id=nt(Fn.getAttribute("source")),vn.skin=nn(Fn);break;case"morph":vn.id=nt(Fn.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}fs.controllers[_n.getAttribute("id")]=vn}function nn(_n){const vn={sources:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"bind_shape_matrix":vn.bindShapeMatrix=_e(Fn.textContent);break;case"source":const fr=Fn.getAttribute("id");vn.sources[fr]=qn(Fn);break;case"joints":vn.joints=mn(Fn);break;case"vertex_weights":vn.vertexWeights=Zt(Fn);break}}return vn}function mn(_n){const vn={inputs:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"input":const fr=Fn.getAttribute("semantic"),Er=nt(Fn.getAttribute("source"));vn.inputs[fr]=Er;break}}return vn}function Zt(_n){const vn={inputs:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"input":const fr=Fn.getAttribute("semantic"),Er=nt(Fn.getAttribute("source")),Tr=parseInt(Fn.getAttribute("offset"));vn.inputs[fr]={id:Er,offset:Tr};break;case"vcount":vn.vcount=tt(Fn.textContent);break;case"v":vn.v=tt(Fn.textContent);break}}return vn}function cn(_n){const vn={id:_n.id},Bn=fs.geometries[vn.id];return _n.skin!==void 0&&(vn.skin=Ot(_n.skin),Bn.sources.skinIndices=vn.skin.indices,Bn.sources.skinWeights=vn.skin.weights),vn}function Ot(_n){const Bn={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},wn=_n.sources,Fn=_n.vertexWeights,fr=Fn.vcount,Er=Fn.v,Tr=Fn.inputs.JOINT.offset,_i=Fn.inputs.WEIGHT.offset,Yr=_n.sources[_n.joints.inputs.JOINT],Qr=_n.sources[_n.joints.inputs.INV_BIND_MATRIX],Dr=wn[Fn.inputs.WEIGHT.id].array;let vs=0,Vr,ms,Zr;for(Vr=0,Zr=fr.length;Vr<Zr;Vr++){const Xs=fr[Vr],Vs=[];for(ms=0;ms<Xs;ms++){const Ms=Er[vs+Tr],Yl=Er[vs+_i],Ro=Dr[Yl];Vs.push({index:Ms,weight:Ro}),vs+=2}for(Vs.sort(io),ms=0;ms<4;ms++){const Ms=Vs[ms];Ms!==void 0?(Bn.indices.array.push(Ms.index),Bn.weights.array.push(Ms.weight)):(Bn.indices.array.push(0),Bn.weights.array.push(0))}}for(_n.bindShapeMatrix?Bn.bindMatrix=new Matrix4().fromArray(_n.bindShapeMatrix).transpose():Bn.bindMatrix=new Matrix4().identity(),Vr=0,Zr=Yr.array.length;Vr<Zr;Vr++){const Xs=Yr.array[Vr],Vs=new Matrix4().fromArray(Qr.array,Vr*Qr.stride).transpose();Bn.joints.push({name:Xs,boneInverse:Vs})}return Bn;function io(Xs,Vs){return Vs.weight-Xs.weight}}function rn(_n){return ht(fs.controllers[_n],cn)}function fn(_n){const vn={init_from:j(_n,"init_from")[0].textContent};fs.images[_n.getAttribute("id")]=vn}function hn(_n){return _n.build!==void 0?_n.build:_n.init_from}function Tn(_n){const vn=fs.images[_n];return vn!==void 0?ht(vn,hn):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",_n),null)}function Nn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"profile_COMMON":vn.profile=Pn(Fn);break}}fs.effects[_n.getAttribute("id")]=vn}function Pn(_n){const vn={surfaces:{},samplers:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"newparam":Dn(Fn,vn);break;case"technique":vn.technique=bn(Fn);break;case"extra":vn.extra=or(Fn);break}}return vn}function Dn(_n,vn){const Bn=_n.getAttribute("sid");for(let wn=0,Fn=_n.childNodes.length;wn<Fn;wn++){const fr=_n.childNodes[wn];if(fr.nodeType===1)switch(fr.nodeName){case"surface":vn.surfaces[Bn]=ln(fr);break;case"sampler2D":vn.samplers[Bn]=Cn(fr);break}}}function ln(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"init_from":vn.init_from=Fn.textContent;break}}return vn}function Cn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"source":vn.source=Fn.textContent;break}}return vn}function bn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"constant":case"lambert":case"blinn":case"phong":vn.type=Fn.nodeName,vn.parameters=kn(Fn);break;case"extra":vn.extra=or(Fn);break}}return vn}function kn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":vn[Fn.nodeName]=Sn(Fn);break;case"transparent":vn[Fn.nodeName]={opaque:Fn.hasAttribute("opaque")?Fn.getAttribute("opaque"):"A_ONE",data:Sn(Fn)};break}}return vn}function Sn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"color":vn[Fn.nodeName]=_e(Fn.textContent);break;case"float":vn[Fn.nodeName]=parseFloat(Fn.textContent);break;case"texture":vn[Fn.nodeName]={id:Fn.getAttribute("texture"),extra:xn(Fn)};break}}return vn}function xn(_n){const vn={technique:{}};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"extra":Qn(Fn,vn);break}}return vn}function Qn(_n,vn){for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"technique":nr(Fn,vn);break}}}function nr(_n,vn){for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":vn.technique[Fn.nodeName]=parseFloat(Fn.textContent);break;case"wrapU":case"wrapV":Fn.textContent.toUpperCase()==="TRUE"?vn.technique[Fn.nodeName]=1:Fn.textContent.toUpperCase()==="FALSE"?vn.technique[Fn.nodeName]=0:vn.technique[Fn.nodeName]=parseInt(Fn.textContent);break;case"bump":vn[Fn.nodeName]=$n(Fn);break}}}function or(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"technique":vn.technique=mr(Fn);break}}return vn}function mr(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"double_sided":vn[Fn.nodeName]=parseInt(Fn.textContent);break;case"bump":vn[Fn.nodeName]=$n(Fn);break}}return vn}function $n(_n){for(var vn={},Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){var Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"texture":vn[Fn.nodeName]={id:Fn.getAttribute("texture"),texcoord:Fn.getAttribute("texcoord"),extra:xn(Fn)};break}}return vn}function tn(_n){return _n}function $t(_n){return ht(fs.effects[_n],tn)}function An(_n){const vn={name:_n.getAttribute("name")};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"instance_effect":vn.url=nt(Fn.getAttribute("url"));break}}fs.materials[_n.getAttribute("id")]=vn}function En(_n){let vn,Bn=_n.slice((_n.lastIndexOf(".")-1>>>0)+2);switch(Bn=Bn.toLowerCase(),Bn){case"tga":vn=Bo;break;default:vn=Gl}return vn}function In(_n){const vn=$t(_n.url),Bn=vn.profile.technique;let wn;switch(Bn.type){case"phong":case"blinn":wn=new MeshPhongMaterial;break;case"lambert":wn=new MeshLambertMaterial;break;default:wn=new MeshBasicMaterial;break}wn.name=_n.name||"";function Fn(_i){const Yr=vn.profile.samplers[_i.id];let Qr=null;if(Yr!==void 0){const Dr=vn.profile.surfaces[Yr.source];Qr=Tn(Dr.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Qr=Tn(_i.id);if(Qr!==null){const Dr=En(Qr);if(Dr!==void 0){const vs=Dr.load(Qr),Vr=_i.extra;if(Vr!==void 0&&Vr.technique!==void 0&&it(Vr.technique)===!1){const ms=Vr.technique;vs.wrapS=ms.wrapU?RepeatWrapping:ClampToEdgeWrapping,vs.wrapT=ms.wrapV?RepeatWrapping:ClampToEdgeWrapping,vs.offset.set(ms.offsetU||0,ms.offsetV||0),vs.repeat.set(ms.repeatU||1,ms.repeatV||1)}else vs.wrapS=RepeatWrapping,vs.wrapT=RepeatWrapping;return vs}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Qr),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",_i.id),null}const fr=Bn.parameters;for(const _i in fr){const Yr=fr[_i];switch(_i){case"diffuse":Yr.color&&wn.color.fromArray(Yr.color),Yr.texture&&(wn.map=Fn(Yr.texture));break;case"specular":Yr.color&&wn.specular&&wn.specular.fromArray(Yr.color),Yr.texture&&(wn.specularMap=Fn(Yr.texture));break;case"bump":Yr.texture&&(wn.normalMap=Fn(Yr.texture));break;case"ambient":Yr.texture&&(wn.lightMap=Fn(Yr.texture));break;case"shininess":Yr.float&&wn.shininess&&(wn.shininess=Yr.float);break;case"emission":Yr.color&&wn.emissive&&wn.emissive.fromArray(Yr.color),Yr.texture&&(wn.emissiveMap=Fn(Yr.texture));break}}let Er=fr.transparent,Tr=fr.transparency;if(Tr===void 0&&Er&&(Tr={float:1}),Er===void 0&&Tr&&(Er={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Er&&Tr)if(Er.data.texture)wn.transparent=!0;else{const _i=Er.data.color;switch(Er.opaque){case"A_ONE":wn.opacity=_i[3]*Tr.float;break;case"RGB_ZERO":wn.opacity=1-_i[0]*Tr.float;break;case"A_ZERO":wn.opacity=1-_i[3]*Tr.float;break;case"RGB_ONE":wn.opacity=_i[0]*Tr.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Er.opaque)}wn.opacity<1&&(wn.transparent=!0)}if(Bn.extra!==void 0&&Bn.extra.technique!==void 0){const _i=Bn.extra.technique;for(const Yr in _i){const Qr=_i[Yr];switch(Yr){case"double_sided":wn.side=Qr===1?DoubleSide:FrontSide;break;case"bump":wn.normalMap=Fn(Qr.texture),wn.normalScale=new Vector2(1,1);break}}}return wn}function Hn(_n){return ht(fs.materials[_n],In)}function yn(_n){const vn={name:_n.getAttribute("name")};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"optics":vn.optics=On(Fn);break}}fs.cameras[_n.getAttribute("id")]=vn}function On(_n){for(let vn=0;vn<_n.childNodes.length;vn++){const Bn=_n.childNodes[vn];switch(Bn.nodeName){case"technique_common":return Mn(Bn)}}return{}}function Mn(_n){const vn={};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];switch(wn.nodeName){case"perspective":case"orthographic":vn.technique=wn.nodeName,vn.parameters=tr(wn);break}}return vn}function tr(_n){const vn={};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];switch(wn.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":vn[wn.nodeName]=parseFloat(wn.textContent);break}}return vn}function gr(_n){let vn;switch(_n.optics.technique){case"perspective":vn=new PerspectiveCamera(_n.optics.parameters.yfov,_n.optics.parameters.aspect_ratio,_n.optics.parameters.znear,_n.optics.parameters.zfar);break;case"orthographic":let Bn=_n.optics.parameters.ymag,wn=_n.optics.parameters.xmag;const Fn=_n.optics.parameters.aspect_ratio;wn=wn===void 0?Bn*Fn:wn,Bn=Bn===void 0?wn/Fn:Bn,wn*=.5,Bn*=.5,vn=new OrthographicCamera(-wn,wn,Bn,-Bn,_n.optics.parameters.znear,_n.optics.parameters.zfar);break;default:vn=new PerspectiveCamera;break}return vn.name=_n.name||"",vn}function Cr(_n){const vn=fs.cameras[_n];return vn!==void 0?ht(vn,gr):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",_n),null)}function Sr(_n){let vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"technique_common":vn=Un(Fn);break}}fs.lights[_n.getAttribute("id")]=vn}function Un(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"directional":case"point":case"spot":case"ambient":vn.technique=Fn.nodeName,vn.parameters=Jn(Fn)}}return vn}function Jn(_n){const vn={};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"color":const fr=_e(Fn.textContent);vn.color=new Color().fromArray(fr);break;case"falloff_angle":vn.falloffAngle=parseFloat(Fn.textContent);break;case"quadratic_attenuation":const Er=parseFloat(Fn.textContent);vn.distance=Er?Math.sqrt(1/Er):0;break}}return vn}function pr(_n){let vn;switch(_n.technique){case"directional":vn=new DirectionalLight;break;case"point":vn=new PointLight;break;case"spot":vn=new SpotLight;break;case"ambient":vn=new AmbientLight;break}return _n.parameters.color&&vn.color.copy(_n.parameters.color),_n.parameters.distance&&(vn.distance=_n.parameters.distance),vn}function Gn(_n){const vn=fs.lights[_n];return vn!==void 0?ht(vn,pr):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",_n),null)}function Zn(_n){const vn={name:_n.getAttribute("name"),sources:{},vertices:{},primitives:[]},Bn=j(_n,"mesh")[0];if(Bn!==void 0){for(let wn=0;wn<Bn.childNodes.length;wn++){const Fn=Bn.childNodes[wn];if(Fn.nodeType!==1)continue;const fr=Fn.getAttribute("id");switch(Fn.nodeName){case"source":vn.sources[fr]=qn(Fn);break;case"vertices":vn.vertices=vr(Fn);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Fn.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":vn.primitives.push(_r(Fn));break;default:console.log(Fn)}}fs.geometries[_n.getAttribute("id")]=vn}}function qn(_n){const vn={array:[],stride:3};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"float_array":vn.array=_e(wn.textContent);break;case"Name_array":vn.array=$(wn.textContent);break;case"technique_common":const Fn=j(wn,"accessor")[0];Fn!==void 0&&(vn.stride=parseInt(Fn.getAttribute("stride")));break}}return vn}function vr(_n){const vn={};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];wn.nodeType===1&&(vn[wn.getAttribute("semantic")]=nt(wn.getAttribute("source")))}return vn}function _r(_n){const vn={type:_n.nodeName,material:_n.getAttribute("material"),count:parseInt(_n.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let Bn=0,wn=_n.childNodes.length;Bn<wn;Bn++){const Fn=_n.childNodes[Bn];if(Fn.nodeType===1)switch(Fn.nodeName){case"input":const fr=nt(Fn.getAttribute("source")),Er=Fn.getAttribute("semantic"),Tr=parseInt(Fn.getAttribute("offset")),_i=parseInt(Fn.getAttribute("set")),Yr=_i>0?Er+_i:Er;vn.inputs[Yr]={id:fr,offset:Tr},vn.stride=Math.max(vn.stride,Tr+1),Er==="TEXCOORD"&&(vn.hasUV=!0);break;case"vcount":vn.vcount=tt(Fn.textContent);break;case"p":vn.p=tt(Fn.textContent);break}}return vn}function $r(_n){const vn={};for(let Bn=0;Bn<_n.length;Bn++){const wn=_n[Bn];vn[wn.type]===void 0&&(vn[wn.type]=[]),vn[wn.type].push(wn)}return vn}function es(_n){let vn=0;for(let Bn=0,wn=_n.length;Bn<wn;Bn++)_n[Bn].hasUV===!0&&vn++;vn>0&&vn<_n.length&&(_n.uvsNeedsFix=!0)}function Hr(_n){const vn={},Bn=_n.sources,wn=_n.vertices,Fn=_n.primitives;if(Fn.length===0)return{};const fr=$r(Fn);for(const Er in fr){const Tr=fr[Er];es(Tr),vn[Er]=Ur(Tr,Bn,wn)}return vn}function Ur(_n,vn,Bn){const wn={},Fn={array:[],stride:0},fr={array:[],stride:0},Er={array:[],stride:0},Tr={array:[],stride:0},_i={array:[],stride:0},Yr={array:[],stride:4},Qr={array:[],stride:4},Dr=new BufferGeometry,vs=[];let Vr=0;for(let ms=0;ms<_n.length;ms++){const Zr=_n[ms],io=Zr.inputs;let Xs=0;switch(Zr.type){case"lines":case"linestrips":Xs=Zr.count*2;break;case"triangles":Xs=Zr.count*3;break;case"polylist":for(let Vs=0;Vs<Zr.count;Vs++){const Ms=Zr.vcount[Vs];switch(Ms){case 3:Xs+=3;break;case 4:Xs+=6;break;default:Xs+=(Ms-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",Zr.type)}Dr.addGroup(Vr,Xs,ms),Vr+=Xs,Zr.material&&vs.push(Zr.material);for(const Vs in io){const Ms=io[Vs];switch(Vs){case"VERTEX":for(const Yl in Bn){const Ro=Bn[Yl];switch(Yl){case"POSITION":const Wo=Fn.array.length;if(Ir(Zr,vn[Ro],Ms.offset,Fn.array),Fn.stride=vn[Ro].stride,vn.skinWeights&&vn.skinIndices&&(Ir(Zr,vn.skinIndices,Ms.offset,Yr.array),Ir(Zr,vn.skinWeights,Ms.offset,Qr.array)),Zr.hasUV===!1&&_n.uvsNeedsFix===!0){const To=(Fn.array.length-Wo)/Fn.stride;for(let Au=0;Au<To;Au++)Er.array.push(0,0)}break;case"NORMAL":Ir(Zr,vn[Ro],Ms.offset,fr.array),fr.stride=vn[Ro].stride;break;case"COLOR":Ir(Zr,vn[Ro],Ms.offset,_i.array),_i.stride=vn[Ro].stride;break;case"TEXCOORD":Ir(Zr,vn[Ro],Ms.offset,Er.array),Er.stride=vn[Ro].stride;break;case"TEXCOORD1":Ir(Zr,vn[Ro],Ms.offset,Tr.array),Er.stride=vn[Ro].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Yl)}}break;case"NORMAL":Ir(Zr,vn[Ms.id],Ms.offset,fr.array),fr.stride=vn[Ms.id].stride;break;case"COLOR":Ir(Zr,vn[Ms.id],Ms.offset,_i.array),_i.stride=vn[Ms.id].stride;break;case"TEXCOORD":Ir(Zr,vn[Ms.id],Ms.offset,Er.array),Er.stride=vn[Ms.id].stride;break;case"TEXCOORD1":Ir(Zr,vn[Ms.id],Ms.offset,Tr.array),Tr.stride=vn[Ms.id].stride;break}}}return Fn.array.length>0&&Dr.setAttribute("position",new Float32BufferAttribute(Fn.array,Fn.stride)),fr.array.length>0&&Dr.setAttribute("normal",new Float32BufferAttribute(fr.array,fr.stride)),_i.array.length>0&&Dr.setAttribute("color",new Float32BufferAttribute(_i.array,_i.stride)),Er.array.length>0&&Dr.setAttribute("uv",new Float32BufferAttribute(Er.array,Er.stride)),Tr.array.length>0&&Dr.setAttribute("uv2",new Float32BufferAttribute(Tr.array,Tr.stride)),Yr.array.length>0&&Dr.setAttribute("skinIndex",new Float32BufferAttribute(Yr.array,Yr.stride)),Qr.array.length>0&&Dr.setAttribute("skinWeight",new Float32BufferAttribute(Qr.array,Qr.stride)),wn.data=Dr,wn.type=_n[0].type,wn.materialKeys=vs,wn}function Ir(_n,vn,Bn,wn){const Fn=_n.p,fr=_n.stride,Er=_n.vcount;function Tr(Qr){let Dr=Fn[Qr+Bn]*Yr;const vs=Dr+Yr;for(;Dr<vs;Dr++)wn.push(_i[Dr])}const _i=vn.array,Yr=vn.stride;if(_n.vcount!==void 0){let Qr=0;for(let Dr=0,vs=Er.length;Dr<vs;Dr++){const Vr=Er[Dr];if(Vr===4){const ms=Qr+fr*0,Zr=Qr+fr*1,io=Qr+fr*2,Xs=Qr+fr*3;Tr(ms),Tr(Zr),Tr(Xs),Tr(Zr),Tr(io),Tr(Xs)}else if(Vr===3){const ms=Qr+fr*0,Zr=Qr+fr*1,io=Qr+fr*2;Tr(ms),Tr(Zr),Tr(io)}else if(Vr>4)for(let ms=1,Zr=Vr-2;ms<=Zr;ms++){const io=Qr+fr*0,Xs=Qr+fr*ms,Vs=Qr+fr*(ms+1);Tr(io),Tr(Xs),Tr(Vs)}Qr+=fr*Vr}}else for(let Qr=0,Dr=Fn.length;Qr<Dr;Qr+=fr)Tr(Qr)}function Fr(_n){return ht(fs.geometries[_n],Hr)}function Pr(_n){const vn={name:_n.getAttribute("name")||"",joints:{},links:[]};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"technique_common":Ws(wn,vn);break}}fs.kinematicsModels[_n.getAttribute("id")]=vn}function Jr(_n){return _n.build!==void 0?_n.build:_n}function zs(_n){return ht(fs.kinematicsModels[_n],Jr)}function Ws(_n,vn){for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"joint":vn.joints[wn.getAttribute("sid")]=Js(wn);break;case"link":vn.links.push(Ks(wn));break}}}function Js(_n){let vn;for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"prismatic":case"revolute":vn=ao(wn);break}}return vn}function ao(_n){const vn={sid:_n.getAttribute("sid"),name:_n.getAttribute("name")||"",axis:new Vector3,limits:{min:0,max:0},type:_n.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"axis":const Fn=_e(wn.textContent);vn.axis.fromArray(Fn);break;case"limits":const fr=wn.getElementsByTagName("max")[0],Er=wn.getElementsByTagName("min")[0];vn.limits.max=parseFloat(fr.textContent),vn.limits.min=parseFloat(Er.textContent);break}}return vn.limits.min>=vn.limits.max&&(vn.static=!0),vn.middlePosition=(vn.limits.min+vn.limits.max)/2,vn}function Ks(_n){const vn={sid:_n.getAttribute("sid"),name:_n.getAttribute("name")||"",attachments:[],transforms:[]};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"attachment_full":vn.attachments.push(Es(wn));break;case"matrix":case"translate":case"rotate":vn.transforms.push(Do(wn));break}}return vn}function Es(_n){const vn={joint:_n.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"link":vn.links.push(Ks(wn));break;case"matrix":case"translate":case"rotate":vn.transforms.push(Do(wn));break}}return vn}function Do(_n){const vn={type:_n.nodeName},Bn=_e(_n.textContent);switch(vn.type){case"matrix":vn.obj=new Matrix4,vn.obj.fromArray(Bn).transpose();break;case"translate":vn.obj=new Vector3,vn.obj.fromArray(Bn);break;case"rotate":vn.obj=new Vector3,vn.obj.fromArray(Bn),vn.angle=MathUtils.degToRad(Bn[3]);break}return vn}function js(_n){const vn={name:_n.getAttribute("name")||"",rigidBodies:{}};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"rigid_body":vn.rigidBodies[wn.getAttribute("name")]={},pn(wn,vn.rigidBodies[wn.getAttribute("name")]);break}}fs.physicsModels[_n.getAttribute("id")]=vn}function pn(_n,vn){for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"technique_common":Kt(wn,vn);break}}}function Kt(_n,vn){for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"inertia":vn.inertia=_e(wn.textContent);break;case"mass":vn.mass=_e(wn.textContent)[0];break}}}function Gt(_n){const vn={bindJointAxis:[]};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"bind_joint_axis":vn.bindJointAxis.push(zt(wn));break}}fs.kinematicsScenes[nt(_n.getAttribute("url"))]=vn}function zt(_n){const vn={target:_n.getAttribute("target").split("/").pop()};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType===1)switch(wn.nodeName){case"axis":const Fn=wn.getElementsByTagName("param")[0];vn.axis=Fn.textContent;const fr=vn.axis.split("inst_").pop().split("axis")[0];vn.jointIndex=fr.substr(0,fr.length-1);break}}return vn}function on(_n){return _n.build!==void 0?_n.build:_n}function dn(_n){return ht(fs.kinematicsScenes[_n],on)}function Vn(){const _n=Object.keys(fs.kinematicsModels)[0],vn=Object.keys(fs.kinematicsScenes)[0],Bn=Object.keys(fs.visualScenes)[0];if(_n===void 0||vn===void 0)return;const wn=zs(_n),Fn=dn(vn),fr=$s(Bn),Er=Fn.bindJointAxis,Tr={};for(let Qr=0,Dr=Er.length;Qr<Dr;Qr++){const vs=Er[Qr],Vr=Ps.querySelector('[sid="'+vs.target+'"]');if(Vr){const ms=Vr.parentElement;_i(vs.jointIndex,ms)}}function _i(Qr,Dr){const vs=Dr.getAttribute("name"),Vr=wn.joints[Qr];fr.traverse(function(ms){ms.name===vs&&(Tr[Qr]={object:ms,transforms:Kn(Dr),joint:Vr,position:Vr.zeroPosition})})}const Yr=new Matrix4;Lu={joints:wn&&wn.joints,getJointValue:function(Qr){const Dr=Tr[Qr];if(Dr)return Dr.position;console.warn("THREE.ColladaLoader: Joint "+Qr+" doesn't exist.")},setJointValue:function(Qr,Dr){const vs=Tr[Qr];if(vs){const Vr=vs.joint;if(Dr>Vr.limits.max||Dr<Vr.limits.min)console.warn("THREE.ColladaLoader: Joint "+Qr+" value "+Dr+" outside of limits (min: "+Vr.limits.min+", max: "+Vr.limits.max+").");else if(Vr.static)console.warn("THREE.ColladaLoader: Joint "+Qr+" is static.");else{const ms=vs.object,Zr=Vr.axis,io=vs.transforms;ar.identity();for(let Xs=0;Xs<io.length;Xs++){const Vs=io[Xs];if(Vs.sid&&Vs.sid.indexOf(Qr)!==-1)switch(Vr.type){case"revolute":ar.multiply(Yr.makeRotationAxis(Zr,MathUtils.degToRad(Dr)));break;case"prismatic":ar.multiply(Yr.makeTranslation(Zr.x*Dr,Zr.y*Dr,Zr.z*Dr));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Vr.type);break}else switch(Vs.type){case"matrix":ar.multiply(Vs.obj);break;case"translate":ar.multiply(Yr.makeTranslation(Vs.obj.x,Vs.obj.y,Vs.obj.z));break;case"scale":ar.scale(Vs.obj);break;case"rotate":ar.multiply(Yr.makeRotationAxis(Vs.obj,Vs.angle));break}}ms.matrix.copy(ar),ms.matrix.decompose(ms.position,ms.quaternion,ms.scale),Tr[Qr].position=Dr}}else console.log("THREE.ColladaLoader: "+Qr+" does not exist.")}}}function Kn(_n){const vn=[],Bn=Ps.querySelector('[id="'+_n.id+'"]');for(let wn=0;wn<Bn.childNodes.length;wn++){const Fn=Bn.childNodes[wn];if(Fn.nodeType!==1)continue;let fr,Er;switch(Fn.nodeName){case"matrix":fr=_e(Fn.textContent);const Tr=new Matrix4().fromArray(fr).transpose();vn.push({sid:Fn.getAttribute("sid"),type:Fn.nodeName,obj:Tr});break;case"translate":case"scale":fr=_e(Fn.textContent),Er=new Vector3().fromArray(fr),vn.push({sid:Fn.getAttribute("sid"),type:Fn.nodeName,obj:Er});break;case"rotate":fr=_e(Fn.textContent),Er=new Vector3().fromArray(fr);const _i=MathUtils.degToRad(fr[3]);vn.push({sid:Fn.getAttribute("sid"),type:Fn.nodeName,obj:Er,angle:_i});break}}return vn}function sr(_n){const vn=_n.getElementsByTagName("node");for(let Bn=0;Bn<vn.length;Bn++){const wn=vn[Bn];wn.hasAttribute("id")===!1&&wn.setAttribute("id",rt())}}const ar=new Matrix4,cr=new Vector3;function ur(_n){const vn={name:_n.getAttribute("name")||"",type:_n.getAttribute("type"),id:_n.getAttribute("id"),sid:_n.getAttribute("sid"),matrix:new Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];if(wn.nodeType!==1)continue;let Fn;switch(wn.nodeName){case"node":vn.nodes.push(wn.getAttribute("id")),ur(wn);break;case"instance_camera":vn.instanceCameras.push(nt(wn.getAttribute("url")));break;case"instance_controller":vn.instanceControllers.push(wr(wn));break;case"instance_light":vn.instanceLights.push(nt(wn.getAttribute("url")));break;case"instance_geometry":vn.instanceGeometries.push(wr(wn));break;case"instance_node":vn.instanceNodes.push(nt(wn.getAttribute("url")));break;case"matrix":Fn=_e(wn.textContent),vn.matrix.multiply(ar.fromArray(Fn).transpose()),vn.transforms[wn.getAttribute("sid")]=wn.nodeName;break;case"translate":Fn=_e(wn.textContent),cr.fromArray(Fn),vn.matrix.multiply(ar.makeTranslation(cr.x,cr.y,cr.z)),vn.transforms[wn.getAttribute("sid")]=wn.nodeName;break;case"rotate":Fn=_e(wn.textContent);const fr=MathUtils.degToRad(Fn[3]);vn.matrix.multiply(ar.makeRotationAxis(cr.fromArray(Fn),fr)),vn.transforms[wn.getAttribute("sid")]=wn.nodeName;break;case"scale":Fn=_e(wn.textContent),vn.matrix.scale(cr.fromArray(Fn)),vn.transforms[wn.getAttribute("sid")]=wn.nodeName;break;case"extra":break;default:console.log(wn)}}return As(vn.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",vn.id):fs.nodes[vn.id]=vn,vn}function wr(_n){const vn={id:nt(_n.getAttribute("url")),materials:{},skeletons:[]};for(let Bn=0;Bn<_n.childNodes.length;Bn++){const wn=_n.childNodes[Bn];switch(wn.nodeName){case"bind_material":const Fn=wn.getElementsByTagName("instance_material");for(let fr=0;fr<Fn.length;fr++){const Er=Fn[fr],Tr=Er.getAttribute("symbol"),_i=Er.getAttribute("target");vn.materials[Tr]=nt(_i)}break;case"skeleton":vn.skeletons.push(nt(wn.textContent));break}}return vn}function Mr(_n,vn){const Bn=[],wn=[];let Fn,fr,Er;for(Fn=0;Fn<_n.length;Fn++){const Yr=_n[Fn];let Qr;if(As(Yr))Qr=ts(Yr),Rr(Qr,vn,Bn);else if(Ss(Yr)){const vs=fs.visualScenes[Yr].children;for(let Vr=0;Vr<vs.length;Vr++){const ms=vs[Vr];if(ms.type==="JOINT"){const Zr=ts(ms.id);Rr(Zr,vn,Bn)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Yr)}for(Fn=0;Fn<vn.length;Fn++)for(fr=0;fr<Bn.length;fr++)if(Er=Bn[fr],Er.bone.name===vn[Fn].name){wn[Fn]=Er,Er.processed=!0;break}for(Fn=0;Fn<Bn.length;Fn++)Er=Bn[Fn],Er.processed===!1&&(wn.push(Er),Er.processed=!0);const Tr=[],_i=[];for(Fn=0;Fn<wn.length;Fn++)Er=wn[Fn],Tr.push(Er.bone),_i.push(Er.boneInverse);return new Skeleton(Tr,_i)}function Rr(_n,vn,Bn){_n.traverse(function(wn){if(wn.isBone===!0){let Fn;for(let fr=0;fr<vn.length;fr++){const Er=vn[fr];if(Er.name===wn.name){Fn=Er.boneInverse;break}}Fn===void 0&&(Fn=new Matrix4),Bn.push({bone:wn,boneInverse:Fn,processed:!1})}})}function cs(_n){const vn=[],Bn=_n.matrix,wn=_n.nodes,Fn=_n.type,fr=_n.instanceCameras,Er=_n.instanceControllers,Tr=_n.instanceLights,_i=_n.instanceGeometries,Yr=_n.instanceNodes;for(let Dr=0,vs=wn.length;Dr<vs;Dr++)vn.push(ts(wn[Dr]));for(let Dr=0,vs=fr.length;Dr<vs;Dr++){const Vr=Cr(fr[Dr]);Vr!==null&&vn.push(Vr.clone())}for(let Dr=0,vs=Er.length;Dr<vs;Dr++){const Vr=Er[Dr],ms=rn(Vr.id),Zr=Fr(ms.id),io=Kr(Zr,Vr.materials),Xs=Vr.skeletons,Vs=ms.skin.joints,Ms=Mr(Xs,Vs);for(let Yl=0,Ro=io.length;Yl<Ro;Yl++){const Wo=io[Yl];Wo.isSkinnedMesh&&(Wo.bind(Ms,ms.skin.bindMatrix),Wo.normalizeSkinWeights()),vn.push(Wo)}}for(let Dr=0,vs=Tr.length;Dr<vs;Dr++){const Vr=Gn(Tr[Dr]);Vr!==null&&vn.push(Vr.clone())}for(let Dr=0,vs=_i.length;Dr<vs;Dr++){const Vr=_i[Dr],ms=Fr(Vr.id),Zr=Kr(ms,Vr.materials);for(let io=0,Xs=Zr.length;io<Xs;io++)vn.push(Zr[io])}for(let Dr=0,vs=Yr.length;Dr<vs;Dr++)vn.push(ts(Yr[Dr]).clone());let Qr;if(wn.length===0&&vn.length===1)Qr=vn[0];else{Qr=Fn==="JOINT"?new Bone:new Group;for(let Dr=0;Dr<vn.length;Dr++)Qr.add(vn[Dr])}return Qr.name=Fn==="JOINT"?_n.sid:_n.name,Qr.matrix.copy(Bn),Qr.matrix.decompose(Qr.position,Qr.quaternion,Qr.scale),Qr}const ps=new MeshBasicMaterial({color:16711935});function us(_n,vn){const Bn=[];for(let wn=0,Fn=_n.length;wn<Fn;wn++){const fr=vn[_n[wn]];fr===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",_n[wn]),Bn.push(ps)):Bn.push(Hn(fr))}return Bn}function Kr(_n,vn){const Bn=[];for(const wn in _n){const Fn=_n[wn],fr=us(Fn.materialKeys,vn);fr.length===0&&(wn==="lines"||wn==="linestrips"?fr.push(new LineBasicMaterial):fr.push(new MeshPhongMaterial));const Er=Fn.data.attributes.skinIndex!==void 0,Tr=fr.length===1?fr[0]:fr;let _i;switch(wn){case"lines":_i=new LineSegments(Fn.data,Tr);break;case"linestrips":_i=new Line(Fn.data,Tr);break;case"triangles":case"polylist":Er?_i=new SkinnedMesh(Fn.data,Tr):_i=new Mesh(Fn.data,Tr);break}Bn.push(_i)}return Bn}function As(_n){return fs.nodes[_n]!==void 0}function ts(_n){return ht(fs.nodes[_n],cs)}function Ts(_n){const vn={name:_n.getAttribute("name"),children:[]};sr(_n);const Bn=j(_n,"node");for(let wn=0;wn<Bn.length;wn++)vn.children.push(ur(Bn[wn]));fs.visualScenes[_n.getAttribute("id")]=vn}function Us(_n){const vn=new Group;vn.name=_n.name;const Bn=_n.children;for(let wn=0;wn<Bn.length;wn++){const Fn=Bn[wn];vn.add(ts(Fn.id))}return vn}function Ss(_n){return fs.visualScenes[_n]!==void 0}function $s(_n){return ht(fs.visualScenes[_n],Us)}function Hs(_n){const vn=j(_n,"instance_visual_scene")[0];return $s(nt(vn.getAttribute("url")))}function Ys(){const _n=fs.clips;if(it(_n)===!0){if(it(fs.animations)===!1){const vn=[];for(const Bn in fs.animations){const wn=gt(Bn);for(let Fn=0,fr=wn.length;Fn<fr;Fn++)vn.push(wn[Fn])}$o.push(new AnimationClip("default",-1,vn))}}else for(const vn in _n)$o.push(Lt(vn))}function co(_n){let vn="";const Bn=[_n];for(;Bn.length;){const wn=Bn.shift();wn.nodeType===Node.TEXT_NODE?vn+=wn.textContent:(vn+=`
`,Bn.push.apply(Bn,wn.childNodes))}return vn.trim()}if(s.length===0)return{scene:new Scene};const Cs=new DOMParser().parseFromString(s,"application/xml"),Ps=j(Cs,"COLLADA")[0],Ns=Cs.getElementsByTagName("parsererror")[0];if(Ns!==void 0){const _n=j(Ns,"div")[0];let vn;return _n?vn=_n.textContent:vn=co(Ns),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,vn),null}const Gs=Ps.getAttribute("version");console.log("THREE.ColladaLoader: File version",Gs);const ro=st(j(Ps,"asset")[0]),Gl=new TextureLoader(this.manager);Gl.setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);let Bo;TGALoader&&(Bo=new TGALoader(this.manager),Bo.setPath(this.resourcePath||o));const $o=[];let Lu={},_d=0;const fs={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};ct(Ps,"library_animations","animation",mt),ct(Ps,"library_animation_clips","animation_clip",jt),ct(Ps,"library_controllers","controller",Qt),ct(Ps,"library_images","image",fn),ct(Ps,"library_effects","effect",Nn),ct(Ps,"library_materials","material",An),ct(Ps,"library_cameras","camera",yn),ct(Ps,"library_lights","light",Sr),ct(Ps,"library_geometries","geometry",Zn),ct(Ps,"library_nodes","node",ur),ct(Ps,"library_visual_scenes","visual_scene",Ts),ct(Ps,"library_kinematics_models","kinematics_model",Pr),ct(Ps,"library_physics_models","physics_model",js),ct(Ps,"scene","instance_kinematics_scene",Gt),ft(fs.animations,dt),ft(fs.clips,Vt),ft(fs.controllers,cn),ft(fs.images,hn),ft(fs.effects,tn),ft(fs.materials,In),ft(fs.cameras,gr),ft(fs.lights,pr),ft(fs.geometries,Hr),ft(fs.visualScenes,Us),Ys(),Vn();const gu=Hs(j(Ps,"scene")[0]);return gu.animations=$o,ro.upAxis==="Z_UP"&&gu.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),gu.scale.multiplyScalar(ro.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),$o},kinematics:Lu,library:fs,scene:gu}}}class KMZLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(_e){for(const tt in $)if(tt.substr(-_e.length)===_e)return $[tt]}const j=new LoadingManager;j.setURLModifier(function(_e){const tt=o(_e);if(tt){console.log("Loading",_e);const nt=new Blob([tt.buffer],{type:"application/octet-stream"});return URL.createObjectURL(nt)}return _e});const $=unzipSync(new Uint8Array(s));if($["doc.kml"]){const tt=new DOMParser().parseFromString(fflate.strFromU8($["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(tt)return new ColladaLoader(j).parse(fflate.strFromU8($[tt.textContent]))}else{console.warn("KMZLoader: Missing doc.kml file.");for(const _e in $)if(_e.split(".").pop().toLowerCase()==="dae")return new ColladaLoader(j).parse(fflate.strFromU8($[_e]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new Group}}}class VRMLoader extends Loader{constructor(s){super(s),this.gltfLoader=new GLTFLoader(s)}load(s,o,j,$){const _e=this;this.gltfLoader.load(s,function(tt){try{_e.parse(tt,o)}catch(nt){$?$(nt):console.error(nt),_e.manager.itemError(s)}},j,$)}setDRACOLoader(s){return this.gltfLoader.setDRACOLoader(s),this}parse(s,o){o(s)}}const{CstParser,Lexer,createToken}=(()=>{var a=typeof global=="object"&&global&&global.Object===Object&&global;const s=a;var o=typeof self=="object"&&self&&self.Object===Object&&self,j=s||o||Function("return this")();const $=j;var _e=$.Symbol;const tt=_e;var nt=Object.prototype,rt=nt.hasOwnProperty,it=nt.toString,st=tt?tt.toStringTag:void 0;function at(bt){var At=rt.call(bt,st),wt=bt[st];try{bt[st]=void 0;var Dt=!0}catch{}var qt=it.call(bt);return Dt&&(At?bt[st]=wt:delete bt[st]),qt}var ot=Object.prototype,ct=ot.toString;function ft(bt){return ct.call(bt)}var ht="[object Null]",mt="[object Undefined]",lt=tt?tt.toStringTag:void 0;function ut(bt){return bt==null?bt===void 0?mt:ht:lt&&lt in Object(bt)?at(bt):ft(bt)}function dt(bt){return bt!=null&&typeof bt=="object"}var gt="[object Symbol]";function Et(bt){return typeof bt=="symbol"||dt(bt)&&ut(bt)==gt}function St(bt,At){for(var wt=-1,Dt=bt==null?0:bt.length,qt=Array(Dt);++wt<Dt;)qt[wt]=At(bt[wt],wt,bt);return qt}var Tt=Array.isArray;const Mt=Tt;var Bt=1/0,Rt=tt?tt.prototype:void 0,Ut=Rt?Rt.toString:void 0;function Ht(bt){if(typeof bt=="string")return bt;if(Mt(bt))return St(bt,Ht)+"";if(Et(bt))return Ut?Ut.call(bt):"";var At=bt+"";return At=="0"&&1/bt==-Bt?"-0":At}var Wt=/\s/;function Jt(bt){for(var At=bt.length;At--&&Wt.test(bt.charAt(At)););return At}var sn=/^\s+/;function jt(bt){return bt&&bt.slice(0,Jt(bt)+1).replace(sn,"")}function Vt(bt){var At=typeof bt;return bt!=null&&(At=="object"||At=="function")}var Lt=0/0,Qt=/^[-+]0x[0-9a-f]+$/i,nn=/^0b[01]+$/i,mn=/^0o[0-7]+$/i,Zt=parseInt;function cn(bt){if(typeof bt=="number")return bt;if(Et(bt))return Lt;if(Vt(bt)){var At=typeof bt.valueOf=="function"?bt.valueOf():bt;bt=Vt(At)?At+"":At}if(typeof bt!="string")return bt===0?bt:+bt;bt=jt(bt);var wt=nn.test(bt);return wt||mn.test(bt)?Zt(bt.slice(2),wt?2:8):Qt.test(bt)?Lt:+bt}var Ot=1/0,rn=17976931348623157e292;function fn(bt){if(!bt)return bt===0?bt:0;if(bt=cn(bt),bt===Ot||bt===-Ot){var At=bt<0?-1:1;return At*rn}return bt===bt?bt:0}function hn(bt){var At=fn(bt),wt=At%1;return At===At?wt?At-wt:At:0}function Tn(bt){return bt}var Nn="[object AsyncFunction]",Pn="[object Function]",Dn="[object GeneratorFunction]",ln="[object Proxy]";function Cn(bt){if(!Vt(bt))return!1;var At=ut(bt);return At==Pn||At==Dn||At==Nn||At==ln}var bn=$["__core-js_shared__"];const kn=bn;var Sn=function(){var bt=/[^.]+$/.exec(kn&&kn.keys&&kn.keys.IE_PROTO||"");return bt?"Symbol(src)_1."+bt:""}();function xn(bt){return!!Sn&&Sn in bt}var Qn=Function.prototype,nr=Qn.toString;function or(bt){if(bt!=null){try{return nr.call(bt)}catch{}try{return bt+""}catch{}}return""}var mr=/[\\^$.*+?()[\]{}|]/g,$n=/^\[object .+?Constructor\]$/,tn=Function.prototype,$t=Object.prototype,An=tn.toString,En=$t.hasOwnProperty,In=RegExp("^"+An.call(En).replace(mr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Hn(bt){if(!Vt(bt)||xn(bt))return!1;var At=Cn(bt)?In:$n;return At.test(or(bt))}function yn(bt,At){return bt==null?void 0:bt[At]}function On(bt,At){var wt=yn(bt,At);return Hn(wt)?wt:void 0}var Mn=On($,"WeakMap");const tr=Mn;var gr=Object.create,Cr=function(){function bt(){}return function(At){if(!Vt(At))return{};if(gr)return gr(At);bt.prototype=At;var wt=new bt;return bt.prototype=void 0,wt}}();const Sr=Cr;function Un(bt,At,wt){switch(wt.length){case 0:return bt.call(At);case 1:return bt.call(At,wt[0]);case 2:return bt.call(At,wt[0],wt[1]);case 3:return bt.call(At,wt[0],wt[1],wt[2])}return bt.apply(At,wt)}function Jn(){}function pr(bt,At){var wt=-1,Dt=bt.length;for(At||(At=Array(Dt));++wt<Dt;)At[wt]=bt[wt];return At}var Gn=800,Zn=16,qn=Date.now;function vr(bt){var At=0,wt=0;return function(){var Dt=qn(),qt=Zn-(Dt-wt);if(wt=Dt,qt>0){if(++At>=Gn)return arguments[0]}else At=0;return bt.apply(void 0,arguments)}}function _r(bt){return function(){return bt}}var $r=function(){try{var bt=On(Object,"defineProperty");return bt({},"",{}),bt}catch{}}();const es=$r;var Hr=es?function(bt,At){return es(bt,"toString",{configurable:!0,enumerable:!1,value:_r(At),writable:!0})}:Tn,Ir=vr(Hr);const Fr=Ir;function Pr(bt,At){for(var wt=-1,Dt=bt==null?0:bt.length;++wt<Dt&&At(bt[wt],wt,bt)!==!1;);return bt}function Jr(bt,At,wt,Dt){for(var qt=bt.length,gn=wt+(Dt?1:-1);Dt?gn--:++gn<qt;)if(At(bt[gn],gn,bt))return gn;return-1}function zs(bt){return bt!==bt}function Ws(bt,At,wt){for(var Dt=wt-1,qt=bt.length;++Dt<qt;)if(bt[Dt]===At)return Dt;return-1}function Js(bt,At,wt){return At===At?Ws(bt,At,wt):Jr(bt,zs,wt)}function ao(bt,At){var wt=bt==null?0:bt.length;return!!wt&&Js(bt,At,0)>-1}var Ks=9007199254740991,Es=/^(?:0|[1-9]\d*)$/;function Do(bt,At){var wt=typeof bt;return At=At??Ks,!!At&&(wt=="number"||wt!="symbol"&&Es.test(bt))&&bt>-1&&bt%1==0&&bt<At}function js(bt,At,wt){At=="__proto__"&&es?es(bt,At,{configurable:!0,enumerable:!0,value:wt,writable:!0}):bt[At]=wt}function pn(bt,At){return bt===At||bt!==bt&&At!==At}var Kt=Object.prototype,Gt=Kt.hasOwnProperty;function zt(bt,At,wt){var Dt=bt[At];(!(Gt.call(bt,At)&&pn(Dt,wt))||wt===void 0&&!(At in bt))&&js(bt,At,wt)}function on(bt,At,wt,Dt){var qt=!wt;wt||(wt={});for(var gn=-1,Rn=At.length;++gn<Rn;){var Ln=At[gn],Xn=Dt?Dt(wt[Ln],bt[Ln],Ln,wt,bt):void 0;Xn===void 0&&(Xn=bt[Ln]),qt?js(wt,Ln,Xn):zt(wt,Ln,Xn)}return wt}var dn=Math.max;function Vn(bt,At,wt){return At=dn(At===void 0?bt.length-1:At,0),function(){for(var Dt=arguments,qt=-1,gn=dn(Dt.length-At,0),Rn=Array(gn);++qt<gn;)Rn[qt]=Dt[At+qt];qt=-1;for(var Ln=Array(At+1);++qt<At;)Ln[qt]=Dt[qt];return Ln[At]=wt(Rn),Un(bt,this,Ln)}}function Kn(bt,At){return Fr(Vn(bt,At,Tn),bt+"")}var sr=9007199254740991;function ar(bt){return typeof bt=="number"&&bt>-1&&bt%1==0&&bt<=sr}function cr(bt){return bt!=null&&ar(bt.length)&&!Cn(bt)}function ur(bt,At,wt){if(!Vt(wt))return!1;var Dt=typeof At;return(Dt=="number"?cr(wt)&&Do(At,wt.length):Dt=="string"&&At in wt)?pn(wt[At],bt):!1}function wr(bt){return Kn(function(At,wt){var Dt=-1,qt=wt.length,gn=qt>1?wt[qt-1]:void 0,Rn=qt>2?wt[2]:void 0;for(gn=bt.length>3&&typeof gn=="function"?(qt--,gn):void 0,Rn&&ur(wt[0],wt[1],Rn)&&(gn=qt<3?void 0:gn,qt=1),At=Object(At);++Dt<qt;){var Ln=wt[Dt];Ln&&bt(At,Ln,Dt,gn)}return At})}var Mr=Object.prototype;function Rr(bt){var At=bt&&bt.constructor,wt=typeof At=="function"&&At.prototype||Mr;return bt===wt}function cs(bt,At){for(var wt=-1,Dt=Array(bt);++wt<bt;)Dt[wt]=At(wt);return Dt}var ps="[object Arguments]";function us(bt){return dt(bt)&&ut(bt)==ps}var Kr=Object.prototype,As=Kr.hasOwnProperty,ts=Kr.propertyIsEnumerable,Ts=us(function(){return arguments}())?us:function(bt){return dt(bt)&&As.call(bt,"callee")&&!ts.call(bt,"callee")};const Us=Ts;function Ss(){return!1}var $s=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Hs=$s&&typeof module=="object"&&module&&!module.nodeType&&module,Ys=Hs&&Hs.exports===$s,co=Ys?$.Buffer:void 0,Cs=co?co.isBuffer:void 0,Ps=Cs||Ss;const Ns=Ps;var Gs="[object Arguments]",ro="[object Array]",Gl="[object Boolean]",Bo="[object Date]",$o="[object Error]",Lu="[object Function]",_d="[object Map]",fs="[object Number]",gu="[object Object]",_n="[object RegExp]",vn="[object Set]",Bn="[object String]",wn="[object WeakMap]",Fn="[object ArrayBuffer]",fr="[object DataView]",Er="[object Float32Array]",Tr="[object Float64Array]",_i="[object Int8Array]",Yr="[object Int16Array]",Qr="[object Int32Array]",Dr="[object Uint8Array]",vs="[object Uint8ClampedArray]",Vr="[object Uint16Array]",ms="[object Uint32Array]",Zr={};Zr[Er]=Zr[Tr]=Zr[_i]=Zr[Yr]=Zr[Qr]=Zr[Dr]=Zr[vs]=Zr[Vr]=Zr[ms]=!0,Zr[Gs]=Zr[ro]=Zr[Fn]=Zr[Gl]=Zr[fr]=Zr[Bo]=Zr[$o]=Zr[Lu]=Zr[_d]=Zr[fs]=Zr[gu]=Zr[_n]=Zr[vn]=Zr[Bn]=Zr[wn]=!1;function io(bt){return dt(bt)&&ar(bt.length)&&!!Zr[ut(bt)]}function Xs(bt){return function(At){return bt(At)}}var Vs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ms=Vs&&typeof module=="object"&&module&&!module.nodeType&&module,Yl=Ms&&Ms.exports===Vs,Ro=Yl&&s.process,Wo=function(){try{var bt=Ms&&Ms.require&&Ms.require("util").types;return bt||Ro&&Ro.binding&&Ro.binding("util")}catch{}}();const To=Wo;var Au=To&&To.isTypedArray,Gm=Au?Xs(Au):io;const xp=Gm;var u1=Object.prototype,Jl=u1.hasOwnProperty;function Jp(bt,At){var wt=Mt(bt),Dt=!wt&&Us(bt),qt=!wt&&!Dt&&Ns(bt),gn=!wt&&!Dt&&!qt&&xp(bt),Rn=wt||Dt||qt||gn,Ln=Rn?cs(bt.length,String):[],Xn=Ln.length;for(var rr in bt)(At||Jl.call(bt,rr))&&!(Rn&&(rr=="length"||qt&&(rr=="offset"||rr=="parent")||gn&&(rr=="buffer"||rr=="byteLength"||rr=="byteOffset")||Do(rr,Xn)))&&Ln.push(rr);return Ln}function Ep(bt,At){return function(wt){return bt(At(wt))}}var h1=Ep(Object.keys,Object);const Zl=h1;var ep=Object.prototype,Zp=ep.hasOwnProperty;function ku(bt){if(!Rr(bt))return Zl(bt);var At=[];for(var wt in Object(bt))Zp.call(bt,wt)&&wt!="constructor"&&At.push(wt);return At}function Xo(bt){return cr(bt)?Jp(bt):ku(bt)}var Rl=Object.prototype,Nu=Rl.hasOwnProperty,Vm=wr(function(bt,At){if(Rr(At)||cr(At)){on(At,Xo(At),bt);return}for(var wt in At)Nu.call(At,wt)&&zt(bt,wt,At[wt])});const Mo=Vm;function tp(bt){var At=[];if(bt!=null)for(var wt in Object(bt))At.push(wt);return At}var Fl=Object.prototype,su=Fl.hasOwnProperty;function Tu(bt){if(!Vt(bt))return tp(bt);var At=Rr(bt),wt=[];for(var Dt in bt)Dt=="constructor"&&(At||!su.call(bt,Dt))||wt.push(Dt);return wt}function Du(bt){return cr(bt)?Jp(bt,!0):Tu(bt)}var zm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_c=/^\w*$/;function eu(bt,At){if(Mt(bt))return!1;var wt=typeof bt;return wt=="number"||wt=="symbol"||wt=="boolean"||bt==null||Et(bt)?!0:_c.test(bt)||!zm.test(bt)||At!=null&&bt in Object(At)}var Sp=On(Object,"create");const Ou=Sp;function em(){this.__data__=Ou?Ou(null):{},this.size=0}function _0(bt){var At=this.has(bt)&&delete this.__data__[bt];return this.size-=At?1:0,At}var x0="__lodash_hash_undefined__",bp=Object.prototype,Cp=bp.hasOwnProperty;function Hm(bt){var At=this.__data__;if(Ou){var wt=At[bt];return wt===x0?void 0:wt}return Cp.call(At,bt)?At[bt]:void 0}var np=Object.prototype,rp=np.hasOwnProperty;function ga(bt){var At=this.__data__;return Ou?At[bt]!==void 0:rp.call(At,bt)}var ip="__lodash_hash_undefined__";function Mu(bt,At){var wt=this.__data__;return this.size+=this.has(bt)?0:1,wt[bt]=Ou&&At===void 0?ip:At,this}function _l(bt){var At=-1,wt=bt==null?0:bt.length;for(this.clear();++At<wt;){var Dt=bt[At];this.set(Dt[0],Dt[1])}}_l.prototype.clear=em,_l.prototype.delete=_0,_l.prototype.get=Hm,_l.prototype.has=ga,_l.prototype.set=Mu;function Tp(){this.__data__=[],this.size=0}function Ko(bt,At){for(var wt=bt.length;wt--;)if(pn(bt[wt][0],At))return wt;return-1}var xl=Array.prototype,Uu=xl.splice;function ou(bt){var At=this.__data__,wt=Ko(At,bt);if(wt<0)return!1;var Dt=At.length-1;return wt==Dt?At.pop():Uu.call(At,wt,1),--this.size,!0}function au(bt){var At=this.__data__,wt=Ko(At,bt);return wt<0?void 0:At[wt][1]}function Gu(bt){return Ko(this.__data__,bt)>-1}function E0(bt,At){var wt=this.__data__,Dt=Ko(wt,bt);return Dt<0?(++this.size,wt.push([bt,At])):wt[Dt][1]=At,this}function tu(bt){var At=-1,wt=bt==null?0:bt.length;for(this.clear();++At<wt;){var Dt=bt[At];this.set(Dt[0],Dt[1])}}tu.prototype.clear=Tp,tu.prototype.delete=ou,tu.prototype.get=au,tu.prototype.has=Gu,tu.prototype.set=E0;var tm=On($,"Map");const Oo=tm;function Fo(){this.size=0,this.__data__={hash:new _l,map:new(Oo||tu),string:new _l}}function uo(bt){var At=typeof bt;return At=="string"||At=="number"||At=="symbol"||At=="boolean"?bt!=="__proto__":bt===null}function lu(bt,At){var wt=bt.__data__;return uo(At)?wt[typeof At=="string"?"string":"hash"]:wt.map}function Vl(bt){var At=lu(this,bt).delete(bt);return this.size-=At?1:0,At}function S0(bt){return lu(this,bt).get(bt)}function Qm(bt){return lu(this,bt).has(bt)}function Wm(bt,At){var wt=lu(this,bt),Dt=wt.size;return wt.set(bt,At),this.size+=wt.size==Dt?0:1,this}function nu(bt){var At=-1,wt=bt==null?0:bt.length;for(this.clear();++At<wt;){var Dt=bt[At];this.set(Dt[0],Dt[1])}}nu.prototype.clear=Fo,nu.prototype.delete=Vl,nu.prototype.get=S0,nu.prototype.has=Qm,nu.prototype.set=Wm;var b0="Expected a function";function Vu(bt,At){if(typeof bt!="function"||At!=null&&typeof At!="function")throw new TypeError(b0);var wt=function(){var Dt=arguments,qt=At?At.apply(this,Dt):Dt[0],gn=wt.cache;if(gn.has(qt))return gn.get(qt);var Rn=bt.apply(this,Dt);return wt.cache=gn.set(qt,Rn)||gn,Rn};return wt.cache=new(Vu.Cache||nu),wt}Vu.Cache=nu;var zu=500;function zl(bt){var At=Vu(bt,function(Dt){return wt.size===zu&&wt.clear(),Dt}),wt=At.cache;return At}var Pl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wu=/\\(\\)?/g,sp=zl(function(bt){var At=[];return bt.charCodeAt(0)===46&&At.push(""),bt.replace(Pl,function(wt,Dt,qt,gn){At.push(qt?gn.replace(wu,"$1"):Dt||wt)}),At});const cu=sp;function uu(bt){return bt==null?"":Ht(bt)}function Mp(bt,At){return Mt(bt)?bt:eu(bt,At)?[bt]:cu(uu(bt))}var Hl=1/0;function Po(bt){if(typeof bt=="string"||Et(bt))return bt;var At=bt+"";return At=="0"&&1/bt==-Hl?"-0":At}function Iu(bt,At){At=Mp(At,bt);for(var wt=0,Dt=At.length;bt!=null&&wt<Dt;)bt=bt[Po(At[wt++])];return wt&&wt==Dt?bt:void 0}function Hu(bt,At,wt){var Dt=bt==null?void 0:Iu(bt,At);return Dt===void 0?wt:Dt}function Ll(bt,At){for(var wt=-1,Dt=At.length,qt=bt.length;++wt<Dt;)bt[qt+wt]=At[wt];return bt}var wp=tt?tt.isConcatSpreadable:void 0;function Qu(bt){return Mt(bt)||Us(bt)||!!(wp&&bt&&bt[wp])}function op(bt,At,wt,Dt,qt){var gn=-1,Rn=bt.length;for(wt||(wt=Qu),qt||(qt=[]);++gn<Rn;){var Ln=bt[gn];At>0&&wt(Ln)?At>1?op(Ln,At-1,wt,Dt,qt):Ll(qt,Ln):Dt||(qt[qt.length]=Ln)}return qt}function Nl(bt){var At=bt==null?0:bt.length;return At?op(bt,1):[]}var Ao=Ep(Object.getPrototypeOf,Object);const Ip=Ao;function nm(bt,At,wt){var Dt=-1,qt=bt.length;At<0&&(At=-At>qt?0:qt+At),wt=wt>qt?qt:wt,wt<0&&(wt+=qt),qt=At>wt?0:wt-At>>>0,At>>>=0;for(var gn=Array(qt);++Dt<qt;)gn[Dt]=bt[Dt+At];return gn}function jm(bt,At,wt,Dt){var qt=-1,gn=bt==null?0:bt.length;for(Dt&&gn&&(wt=bt[++qt]);++qt<gn;)wt=At(wt,bt[qt],qt,bt);return wt}function rm(){this.__data__=new tu,this.size=0}function Ql(bt){var At=this.__data__,wt=At.delete(bt);return this.size=At.size,wt}function ap(bt){return this.__data__.get(bt)}function So(bt){return this.__data__.has(bt)}var Yo=200;function Uo(bt,At){var wt=this.__data__;if(wt instanceof tu){var Dt=wt.__data__;if(!Oo||Dt.length<Yo-1)return Dt.push([bt,At]),this.size=++wt.size,this;wt=this.__data__=new nu(Dt)}return wt.set(bt,At),this.size=wt.size,this}function Dl(bt){var At=this.__data__=new tu(bt);this.size=At.size}Dl.prototype.clear=rm,Dl.prototype.delete=Ql,Dl.prototype.get=ap,Dl.prototype.has=So,Dl.prototype.set=Uo;function Bp(bt,At){return bt&&on(At,Xo(At),bt)}function Rp(bt,At){return bt&&on(At,Du(At),bt)}var C0=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jo=C0&&typeof module=="object"&&module&&!module.nodeType&&module,$m=jo&&jo.exports===C0,im=$m?$.Buffer:void 0,sm=im?im.allocUnsafe:void 0;function vu(bt,At){if(At)return bt.slice();var wt=bt.length,Dt=sm?sm(wt):new bt.constructor(wt);return bt.copy(Dt),Dt}function Wl(bt,At){for(var wt=-1,Dt=bt==null?0:bt.length,qt=0,gn=[];++wt<Dt;){var Rn=bt[wt];At(Rn,wt,bt)&&(gn[qt++]=Rn)}return gn}function hu(){return[]}var om=Object.prototype,am=om.propertyIsEnumerable,Xm=Object.getOwnPropertySymbols,T0=Xm?function(bt){return bt==null?[]:(bt=Object(bt),Wl(Xm(bt),function(At){return am.call(bt,At)}))}:hu;const lm=T0;function M0(bt,At){return on(bt,lm(bt),At)}var w0=Object.getOwnPropertySymbols,I0=w0?function(bt){for(var At=[];bt;)Ll(At,lm(bt)),bt=Ip(bt);return At}:hu;const Fp=I0;function lp(bt,At){return on(bt,Fp(bt),At)}function cm(bt,At,wt){var Dt=At(bt);return Mt(bt)?Dt:Ll(Dt,wt(bt))}function Wu(bt){return cm(bt,Xo,lm)}function cp(bt){return cm(bt,Du,Fp)}var Km=On($,"DataView");const ju=Km;var Ym=On($,"Promise");const um=Ym;var B0=On($,"Set");const Bu=B0;var hm="[object Map]",R0="[object Object]",qm="[object Promise]",F0="[object Set]",Jm="[object WeakMap]",P0="[object DataView]",L0=or(ju),Zm=or(Oo),k0=or(um),N0=or(Bu),D0=or(tr),fu=ut;(ju&&fu(new ju(new ArrayBuffer(1)))!=P0||Oo&&fu(new Oo)!=hm||um&&fu(um.resolve())!=qm||Bu&&fu(new Bu)!=F0||tr&&fu(new tr)!=Jm)&&(fu=function(bt){var At=ut(bt),wt=At==R0?bt.constructor:void 0,Dt=wt?or(wt):"";if(Dt)switch(Dt){case L0:return P0;case Zm:return hm;case k0:return qm;case N0:return F0;case D0:return Jm}return At});const up=fu;var f1=Object.prototype,d1=f1.hasOwnProperty;function e0(bt){var At=bt.length,wt=new bt.constructor(At);return At&&typeof bt[0]=="string"&&d1.call(bt,"index")&&(wt.index=bt.index,wt.input=bt.input),wt}var t0=$.Uint8Array;const fm=t0;function dm(bt){var At=new bt.constructor(bt.byteLength);return new fm(At).set(new fm(bt)),At}function O0(bt,At){var wt=At?dm(bt.buffer):bt.buffer;return new bt.constructor(wt,bt.byteOffset,bt.byteLength)}var U0=/\w*$/;function G0(bt){var At=new bt.constructor(bt.source,U0.exec(bt));return At.lastIndex=bt.lastIndex,At}var n0=tt?tt.prototype:void 0,Ol=n0?n0.valueOf:void 0;function V0(bt){return Ol?Object(Ol.call(bt)):{}}function Pp(bt,At){var wt=At?dm(bt.buffer):bt.buffer;return new bt.constructor(wt,bt.byteOffset,bt.length)}var Lp="[object Boolean]",pm="[object Date]",mm="[object Map]",z0="[object Number]",kp="[object RegExp]",qo="[object Set]",p1="[object String]",m1="[object Symbol]",Jo="[object ArrayBuffer]",xa="[object DataView]",gm="[object Float32Array]",H0="[object Float64Array]",Q0="[object Int8Array]",W0="[object Int16Array]",j0="[object Int32Array]",r0="[object Uint8Array]",$0="[object Uint8ClampedArray]",Am="[object Uint16Array]",X0="[object Uint32Array]";function K0(bt,At,wt){var Dt=bt.constructor;switch(At){case Jo:return dm(bt);case Lp:case pm:return new Dt(+bt);case xa:return O0(bt,wt);case gm:case H0:case Q0:case W0:case j0:case r0:case $0:case Am:case X0:return Pp(bt,wt);case mm:return new Dt;case z0:case p1:return new Dt(bt);case kp:return G0(bt);case qo:return new Dt;case m1:return V0(bt)}}function vm(bt){return typeof bt.constructor=="function"&&!Rr(bt)?Sr(Ip(bt)):{}}var ym="[object Map]";function Y0(bt){return dt(bt)&&up(bt)==ym}var _m=To&&To.isMap,yu=_m?Xs(_m):Y0;const _u=yu;var ns="[object Set]";function $u(bt){return dt(bt)&&up(bt)==ns}var hp=To&&To.isSet,q0=hp?Xs(hp):$u;const Lo=q0;var xm=1,g1=2,ho=4,ba="[object Arguments]",J0="[object Array]",zr="[object Boolean]",Xu="[object Date]",i0="[object Error]",$a="[object Function]",Ku="[object GeneratorFunction]",ru="[object Map]",Np="[object Number]",Em="[object Object]",Sm="[object RegExp]",Z0="[object Set]",_g="[object String]",e1="[object Symbol]",t1="[object WeakMap]",n1="[object ArrayBuffer]",s0="[object DataView]",o0="[object Float32Array]",r1="[object Float64Array]",a0="[object Int8Array]",bm="[object Int16Array]",A1="[object Int32Array]",v1="[object Uint8Array]",i1="[object Uint8ClampedArray]",l0="[object Uint16Array]",Cm="[object Uint32Array]",so={};so[ba]=so[J0]=so[n1]=so[s0]=so[zr]=so[Xu]=so[o0]=so[r1]=so[a0]=so[bm]=so[A1]=so[ru]=so[Np]=so[Em]=so[Sm]=so[Z0]=so[_g]=so[e1]=so[v1]=so[i1]=so[l0]=so[Cm]=!0,so[i0]=so[$a]=so[t1]=!1;function Yu(bt,At,wt,Dt,qt,gn){var Rn,Ln=At&xm,Xn=At&g1,rr=At&ho;if(wt&&(Rn=qt?wt(bt,Dt,qt,gn):wt(bt)),Rn!==void 0)return Rn;if(!Vt(bt))return bt;var xr=Mt(bt);if(xr){if(Rn=e0(bt),!Ln)return pr(bt,Rn)}else{var br=up(bt),Gr=br==$a||br==Ku;if(Ns(bt))return vu(bt,Ln);if(br==Em||br==ba||Gr&&!qt){if(Rn=Xn||Gr?{}:vm(bt),!Ln)return Xn?lp(bt,Rp(Rn,bt)):M0(bt,Bp(Rn,bt))}else{if(!so[br])return qt?bt:{};Rn=K0(bt,br,Ln)}}gn||(gn=new Dl);var ls=gn.get(bt);if(ls)return ls;gn.set(bt,Rn),Lo(bt)?bt.forEach(function(Bs){Rn.add(Yu(Bs,At,wt,Bs,bt,gn))}):_u(bt)&&bt.forEach(function(Bs,rs){Rn.set(rs,Yu(Bs,At,wt,rs,bt,gn))});var ys=rr?Xn?cp:Wu:Xn?Du:Xo,xs=xr?void 0:ys(bt);return Pr(xs||bt,function(Bs,rs){xs&&(rs=Bs,Bs=bt[rs]),zt(Rn,rs,Yu(Bs,At,wt,rs,bt,gn))}),Rn}var Tm=4;function Co(bt){return Yu(bt,Tm)}function Ru(bt){for(var At=-1,wt=bt==null?0:bt.length,Dt=0,qt=[];++At<wt;){var gn=bt[At];gn&&(qt[Dt++]=gn)}return qt}var Mm="__lodash_hash_undefined__";function Dp(bt){return this.__data__.set(bt,Mm),this}function c0(bt){return this.__data__.has(bt)}function xu(bt){var At=-1,wt=bt==null?0:bt.length;for(this.__data__=new nu;++At<wt;)this.add(bt[At])}xu.prototype.add=xu.prototype.push=Dp,xu.prototype.has=c0;function wm(bt,At){for(var wt=-1,Dt=bt==null?0:bt.length;++wt<Dt;)if(At(bt[wt],wt,bt))return!0;return!1}function El(bt,At){return bt.has(At)}var Op=1,y1=2;function Up(bt,At,wt,Dt,qt,gn){var Rn=wt&Op,Ln=bt.length,Xn=At.length;if(Ln!=Xn&&!(Rn&&Xn>Ln))return!1;var rr=gn.get(bt),xr=gn.get(At);if(rr&&xr)return rr==At&&xr==bt;var br=-1,Gr=!0,ls=wt&y1?new xu:void 0;for(gn.set(bt,At),gn.set(At,bt);++br<Ln;){var ys=bt[br],xs=At[br];if(Dt)var Bs=Rn?Dt(xs,ys,br,At,bt,gn):Dt(ys,xs,br,bt,At,gn);if(Bs!==void 0){if(Bs)continue;Gr=!1;break}if(ls){if(!wm(At,function(rs,as){if(!El(ls,as)&&(ys===rs||qt(ys,rs,wt,Dt,gn)))return ls.push(as)})){Gr=!1;break}}else if(!(ys===xs||qt(ys,xs,wt,Dt,gn))){Gr=!1;break}}return gn.delete(bt),gn.delete(At),Gr}function Gp(bt){var At=-1,wt=Array(bt.size);return bt.forEach(function(Dt,qt){wt[++At]=[qt,Dt]}),wt}function vo(bt){var At=-1,wt=Array(bt.size);return bt.forEach(function(Dt){wt[++At]=Dt}),wt}var Ds=1,wo=2,ws="[object Boolean]",Go="[object Date]",Ul="[object Error]",fp="[object Map]",ko="[object Number]",Vp="[object RegExp]",dp="[object Set]",Im="[object String]",u0="[object Symbol]",zp="[object ArrayBuffer]",Sl="[object DataView]",Bm=tt?tt.prototype:void 0,Hp=Bm?Bm.valueOf:void 0;function pp(bt,At,wt,Dt,qt,gn,Rn){switch(wt){case Sl:if(bt.byteLength!=At.byteLength||bt.byteOffset!=At.byteOffset)return!1;bt=bt.buffer,At=At.buffer;case zp:return!(bt.byteLength!=At.byteLength||!gn(new fm(bt),new fm(At)));case ws:case Go:case ko:return pn(+bt,+At);case Ul:return bt.name==At.name&&bt.message==At.message;case Vp:case Im:return bt==At+"";case fp:var Ln=Gp;case dp:var Xn=Dt&Ds;if(Ln||(Ln=vo),bt.size!=At.size&&!Xn)return!1;var rr=Rn.get(bt);if(rr)return rr==At;Dt|=wo,Rn.set(bt,At);var xr=Up(Ln(bt),Ln(At),Dt,qt,gn,Rn);return Rn.delete(bt),xr;case u0:if(Hp)return Hp.call(bt)==Hp.call(At)}return!1}var Rm=1,h0=Object.prototype,Vo=h0.hasOwnProperty;function Fm(bt,At,wt,Dt,qt,gn){var Rn=wt&Rm,Ln=Wu(bt),Xn=Ln.length,rr=Wu(At),xr=rr.length;if(Xn!=xr&&!Rn)return!1;for(var br=Xn;br--;){var Gr=Ln[br];if(!(Rn?Gr in At:Vo.call(At,Gr)))return!1}var ls=gn.get(bt),ys=gn.get(At);if(ls&&ys)return ls==At&&ys==bt;var xs=!0;gn.set(bt,At),gn.set(At,bt);for(var Bs=Rn;++br<Xn;){Gr=Ln[br];var rs=bt[Gr],as=At[Gr];if(Dt)var qr=Rn?Dt(as,rs,Gr,At,bt,gn):Dt(rs,as,Gr,bt,At,gn);if(!(qr===void 0?rs===as||qt(rs,as,wt,Dt,gn):qr)){xs=!1;break}Bs||(Bs=Gr=="constructor")}if(xs&&!Bs){var gs=bt.constructor,Eo=At.constructor;gs!=Eo&&"constructor"in bt&&"constructor"in At&&!(typeof gs=="function"&&gs instanceof gs&&typeof Eo=="function"&&Eo instanceof Eo)&&(xs=!1)}return gn.delete(bt),gn.delete(At),xs}var Fu=1,Qp="[object Arguments]",mp="[object Array]",gp="[object Object]",Pm=Object.prototype,Wp=Pm.hasOwnProperty;function Al(bt,At,wt,Dt,qt,gn){var Rn=Mt(bt),Ln=Mt(At),Xn=Rn?mp:up(bt),rr=Ln?mp:up(At);Xn=Xn==Qp?gp:Xn,rr=rr==Qp?gp:rr;var xr=Xn==gp,br=rr==gp,Gr=Xn==rr;if(Gr&&Ns(bt)){if(!Ns(At))return!1;Rn=!0,xr=!1}if(Gr&&!xr)return gn||(gn=new Dl),Rn||xp(bt)?Up(bt,At,wt,Dt,qt,gn):pp(bt,At,Xn,wt,Dt,qt,gn);if(!(wt&Fu)){var ls=xr&&Wp.call(bt,"__wrapped__"),ys=br&&Wp.call(At,"__wrapped__");if(ls||ys){var xs=ls?bt.value():bt,Bs=ys?At.value():At;return gn||(gn=new Dl),qt(xs,Bs,wt,Dt,gn)}}return Gr?(gn||(gn=new Dl),Fm(bt,At,wt,Dt,qt,gn)):!1}function du(bt,At,wt,Dt,qt){return bt===At?!0:bt==null||At==null||!dt(bt)&&!dt(At)?bt!==bt&&At!==At:Al(bt,At,wt,Dt,du,qt)}var $l=1,jp=2;function Cl(bt,At,wt,Dt){var qt=wt.length,gn=qt,Rn=!Dt;if(bt==null)return!gn;for(bt=Object(bt);qt--;){var Ln=wt[qt];if(Rn&&Ln[2]?Ln[1]!==bt[Ln[0]]:!(Ln[0]in bt))return!1}for(;++qt<gn;){Ln=wt[qt];var Xn=Ln[0],rr=bt[Xn],xr=Ln[1];if(Rn&&Ln[2]){if(rr===void 0&&!(Xn in bt))return!1}else{var br=new Dl;if(Dt)var Gr=Dt(rr,xr,Xn,bt,At,br);if(!(Gr===void 0?du(xr,rr,$l|jp,Dt,br):Gr))return!1}}return!0}function yo(bt){return bt===bt&&!Vt(bt)}function f0(bt){for(var At=Xo(bt),wt=At.length;wt--;){var Dt=At[wt],qt=bt[Dt];At[wt]=[Dt,qt,yo(qt)]}return At}function pt(bt,At){return function(wt){return wt==null?!1:wt[bt]===At&&(At!==void 0||bt in Object(wt))}}function xt(bt){var At=f0(bt);return At.length==1&&At[0][2]?pt(At[0][0],At[0][1]):function(wt){return wt===bt||Cl(wt,bt,At)}}function Ct(bt,At){return bt!=null&&At in Object(bt)}function It(bt,At,wt){At=Mp(At,bt);for(var Dt=-1,qt=At.length,gn=!1;++Dt<qt;){var Rn=Po(At[Dt]);if(!(gn=bt!=null&&wt(bt,Rn)))break;bt=bt[Rn]}return gn||++Dt!=qt?gn:(qt=bt==null?0:bt.length,!!qt&&ar(qt)&&Do(Rn,qt)&&(Mt(bt)||Us(bt)))}function Pt(bt,At){return bt!=null&&It(bt,At,Ct)}var kt=1,Yt=2;function un(bt,At){return eu(bt)&&yo(At)?pt(Po(bt),At):function(wt){var Dt=Hu(wt,bt);return Dt===void 0&&Dt===At?Pt(wt,bt):du(At,Dt,kt|Yt)}}function an(bt){return function(At){return At==null?void 0:At[bt]}}function jn(bt){return function(At){return Iu(At,bt)}}function Wn(bt){return eu(bt)?an(Po(bt)):jn(bt)}function lr(bt){return typeof bt=="function"?bt:bt==null?Tn:typeof bt=="object"?Mt(bt)?un(bt[0],bt[1]):xt(bt):Wn(bt)}function Yn(bt,At,wt,Dt){for(var qt=-1,gn=bt==null?0:bt.length;++qt<gn;){var Rn=bt[qt];At(Dt,Rn,wt(Rn),bt)}return Dt}function hr(bt){return function(At,wt,Dt){for(var qt=-1,gn=Object(At),Rn=Dt(At),Ln=Rn.length;Ln--;){var Xn=Rn[bt?Ln:++qt];if(wt(gn[Xn],Xn,gn)===!1)break}return At}}var Lr=hr();const jr=Lr;function Xr(bt,At){return bt&&jr(bt,At,Xo)}function Wr(bt,At){return function(wt,Dt){if(wt==null)return wt;if(!cr(wt))return bt(wt,Dt);for(var qt=wt.length,gn=At?qt:-1,Rn=Object(wt);(At?gn--:++gn<qt)&&Dt(Rn[gn],gn,Rn)!==!1;);return wt}}var bs=Wr(Xr);const kr=bs;function Zs(bt,At,wt,Dt){return kr(bt,function(qt,gn,Rn){At(Dt,qt,wt(qt),Rn)}),Dt}function Is(bt,At){return function(wt,Dt){var qt=Mt(wt)?Yn:Zs,gn=At?At():{};return qt(wt,bt,lr(Dt),gn)}}var fo=Object.prototype,Rs=fo.hasOwnProperty,hs=Kn(function(bt,At){bt=Object(bt);var wt=-1,Dt=At.length,qt=Dt>2?At[2]:void 0;for(qt&&ur(At[0],At[1],qt)&&(Dt=1);++wt<Dt;)for(var gn=At[wt],Rn=Du(gn),Ln=-1,Xn=Rn.length;++Ln<Xn;){var rr=Rn[Ln],xr=bt[rr];(xr===void 0||pn(xr,fo[rr])&&!Rs.call(bt,rr))&&(bt[rr]=gn[rr])}return bt});const bo=hs;function Zo(bt){return dt(bt)&&cr(bt)}function lo(bt,At,wt){for(var Dt=-1,qt=bt==null?0:bt.length;++Dt<qt;)if(wt(At,bt[Dt]))return!0;return!1}var Tl=200;function Xl(bt,At,wt,Dt){var qt=-1,gn=ao,Rn=!0,Ln=bt.length,Xn=[],rr=At.length;if(!Ln)return Xn;wt&&(At=St(At,Xs(wt))),Dt?(gn=lo,Rn=!1):At.length>=Tl&&(gn=El,Rn=!1,At=new xu(At));e:for(;++qt<Ln;){var xr=bt[qt],br=wt==null?xr:wt(xr);if(xr=Dt||xr!==0?xr:0,Rn&&br===br){for(var Gr=rr;Gr--;)if(At[Gr]===br)continue e;Xn.push(xr)}else gn(At,br,Dt)||Xn.push(xr)}return Xn}var oo=Kn(function(bt,At){return Zo(bt)?Xl(bt,op(At,1,Zo,!0)):[]});const go=oo;function no(bt){var At=bt==null?0:bt.length;return At?bt[At-1]:void 0}function Qs(bt,At,wt){var Dt=bt==null?0:bt.length;return Dt?(At=wt||At===void 0?1:hn(At),nm(bt,At<0?0:At,Dt)):[]}function _o(bt,At,wt){var Dt=bt==null?0:bt.length;return Dt?(At=wt||At===void 0?1:hn(At),At=Dt-At,nm(bt,0,At<0?0:At)):[]}function Io(bt){return typeof bt=="function"?bt:Tn}function ss(bt,At){var wt=Mt(bt)?Pr:kr;return wt(bt,Io(At))}function po(bt,At){for(var wt=-1,Dt=bt==null?0:bt.length;++wt<Dt;)if(!At(bt[wt],wt,bt))return!1;return!0}function zo(bt,At){var wt=!0;return kr(bt,function(Dt,qt,gn){return wt=!!At(Dt,qt,gn),wt}),wt}function Ml(bt,At,wt){var Dt=Mt(bt)?po:zo;return wt&&ur(bt,At,wt)&&(At=void 0),Dt(bt,lr(At))}function d0(bt,At){var wt=[];return kr(bt,function(Dt,qt,gn){At(Dt,qt,gn)&&wt.push(Dt)}),wt}function Il(bt,At){var wt=Mt(bt)?Wl:d0;return wt(bt,lr(At))}function p0(bt){return function(At,wt,Dt){var qt=Object(At);if(!cr(At)){var gn=lr(wt);At=Xo(At),wt=function(Ln){return gn(qt[Ln],Ln,qt)}}var Rn=bt(At,wt,Dt);return Rn>-1?qt[gn?At[Rn]:Rn]:void 0}}var s1=Math.max;function vt(bt,At,wt){var Dt=bt==null?0:bt.length;if(!Dt)return-1;var qt=wt==null?0:hn(wt);return qt<0&&(qt=s1(Dt+qt,0)),Jr(bt,lr(At),qt)}var yt=p0(vt);const Ft=yt;function Nt(bt){return bt&&bt.length?bt[0]:void 0}function Xt(bt,At){var wt=-1,Dt=cr(bt)?Array(bt.length):[];return kr(bt,function(qt,gn,Rn){Dt[++wt]=At(qt,gn,Rn)}),Dt}function en(bt,At){var wt=Mt(bt)?St:Xt;return wt(bt,lr(At))}function zn(bt,At){return op(en(bt,At),1)}var ir=Object.prototype,yr=ir.hasOwnProperty,Nr=Is(function(bt,At,wt){yr.call(bt,wt)?bt[wt].push(At):js(bt,wt,[At])});const os=Nr;var Ls=Object.prototype,_s=Ls.hasOwnProperty;function mo(bt,At){return bt!=null&&_s.call(bt,At)}function Br(bt,At){return bt!=null&&It(bt,At,mo)}var Bl="[object String]";function xo(bt){return typeof bt=="string"||!Mt(bt)&&dt(bt)&&ut(bt)==Bl}function dr(bt,At){return St(At,function(wt){return bt[wt]})}function er(bt){return bt==null?[]:dr(bt,Xo(bt))}var Ar=Math.max;function Or(bt,At,wt,Dt){bt=cr(bt)?bt:er(bt),wt=wt&&!Dt?hn(wt):0;var qt=bt.length;return wt<0&&(wt=Ar(qt+wt,0)),xo(bt)?wt<=qt&&bt.indexOf(At,wt)>-1:!!qt&&Js(bt,At,wt)>-1}var ds=Math.max;function Os(bt,At,wt){var Dt=bt==null?0:bt.length;if(!Dt)return-1;var qt=wt==null?0:hn(wt);return qt<0&&(qt=ds(Dt+qt,0)),Js(bt,At,qt)}var ks="[object Map]",eo="[object Set]",na=Object.prototype,to=na.hasOwnProperty;function qs(bt){if(bt==null)return!0;if(cr(bt)&&(Mt(bt)||typeof bt=="string"||typeof bt.splice=="function"||Ns(bt)||xp(bt)||Us(bt)))return!bt.length;var At=up(bt);if(At==ks||At==eo)return!bt.size;if(Rr(bt))return!ku(bt).length;for(var wt in bt)if(to.call(bt,wt))return!1;return!0}var o3="[object RegExp]";function QA(bt){return dt(bt)&&ut(bt)==o3}var R3=To&&To.isRegExp,WA=R3?Xs(R3):QA;const $p=WA;function Xp(bt){return bt===void 0}var jA="Expected a function";function $A(bt){if(typeof bt!="function")throw new TypeError(jA);return function(){var At=arguments;switch(At.length){case 0:return!bt.call(this);case 1:return!bt.call(this,At[0]);case 2:return!bt.call(this,At[0],At[1]);case 3:return!bt.call(this,At[0],At[1],At[2])}return!bt.apply(this,At)}}function XA(bt,At,wt,Dt){if(!Vt(bt))return bt;At=Mp(At,bt);for(var qt=-1,gn=At.length,Rn=gn-1,Ln=bt;Ln!=null&&++qt<gn;){var Xn=Po(At[qt]),rr=wt;if(Xn==="__proto__"||Xn==="constructor"||Xn==="prototype")return bt;if(qt!=Rn){var xr=Ln[Xn];rr=Dt?Dt(xr,Xn,Ln):void 0,rr===void 0&&(rr=Vt(xr)?xr:Do(At[qt+1])?[]:{})}zt(Ln,Xn,rr),Ln=Ln[Xn]}return bt}function KA(bt,At,wt){for(var Dt=-1,qt=At.length,gn={};++Dt<qt;){var Rn=At[Dt],Ln=Iu(bt,Rn);wt(Ln,Rn)&&XA(gn,Mp(Rn,bt),Ln)}return gn}function qu(bt,At){if(bt==null)return{};var wt=St(cp(bt),function(Dt){return[Dt]});return At=lr(At),KA(bt,wt,function(Dt,qt){return At(Dt,qt[0])})}function YA(bt,At,wt,Dt,qt){return qt(bt,function(gn,Rn,Ln){wt=Dt?(Dt=!1,gn):At(wt,gn,Rn,Ln)}),wt}function Eu(bt,At,wt){var Dt=Mt(bt)?jm:YA,qt=arguments.length<3;return Dt(bt,lr(At),wt,qt,kr)}function L1(bt,At){var wt=Mt(bt)?Wl:d0;return wt(bt,$A(lr(At)))}function qA(bt,At){var wt;return kr(bt,function(Dt,qt,gn){return wt=At(Dt,qt,gn),!wt}),!!wt}function F3(bt,At,wt){var Dt=Mt(bt)?wm:qA;return wt&&ur(bt,At,wt)&&(At=void 0),Dt(bt,lr(At))}var JA=1/0,ZA=Bu&&1/vo(new Bu([,-0]))[1]==JA?function(bt){return new Bu(bt)}:Jn;const ev=ZA;var tv=200;function nv(bt,At,wt){var Dt=-1,qt=ao,gn=bt.length,Rn=!0,Ln=[],Xn=Ln;if(wt)Rn=!1,qt=lo;else if(gn>=tv){var rr=At?null:ev(bt);if(rr)return vo(rr);Rn=!1,qt=El,Xn=new xu}else Xn=At?[]:Ln;e:for(;++Dt<gn;){var xr=bt[Dt],br=At?At(xr):xr;if(xr=wt||xr!==0?xr:0,Rn&&br===br){for(var Gr=Xn.length;Gr--;)if(Xn[Gr]===br)continue e;At&&Xn.push(br),Ln.push(xr)}else qt(Xn,br,wt)||(Xn!==Ln&&Xn.push(br),Ln.push(xr))}return Ln}function a3(bt){return bt&&bt.length?nv(bt):[]}function l3(bt){console&&console.error&&console.error(`Error: ${bt}`)}function P3(bt){console&&console.warn&&console.warn(`Warning: ${bt}`)}function L3(bt){const At=new Date().getTime(),wt=bt();return{time:new Date().getTime()-At,value:wt}}function k3(bt){function At(){}At.prototype=bt;const wt=new At;function Dt(){return typeof wt.bar}return Dt(),Dt(),bt}function rv(bt){return iv(bt)?bt.LABEL:bt.name}function iv(bt){return xo(bt.LABEL)&&bt.LABEL!==""}class Ap{get definition(){return this._definition}set definition(At){this._definition=At}constructor(At){this._definition=At}accept(At){At.visit(this),ss(this.definition,wt=>{wt.accept(At)})}}class Su extends Ap{constructor(At){super([]),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}set definition(At){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(At){At.visit(this)}}class o1 extends Ap{constructor(At){super(At.definition),this.orgText="",Mo(this,qu(At,wt=>wt!==void 0))}}class pu extends Ap{constructor(At){super(At.definition),this.ignoreAmbiguities=!1,Mo(this,qu(At,wt=>wt!==void 0))}}class mu extends Ap{constructor(At){super(At.definition),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}}class vp extends Ap{constructor(At){super(At.definition),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}}class yp extends Ap{constructor(At){super(At.definition),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}}class yl extends Ap{constructor(At){super(At.definition),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}}class Ju extends Ap{constructor(At){super(At.definition),this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}}class Zu extends Ap{get definition(){return this._definition}set definition(At){this._definition=At}constructor(At){super(At.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Mo(this,qu(At,wt=>wt!==void 0))}}class No{constructor(At){this.idx=1,Mo(this,qu(At,wt=>wt!==void 0))}accept(At){At.visit(this)}}function sv(bt){return en(bt,k1)}function k1(bt){function At(wt){return en(wt,k1)}if(bt instanceof Su){const wt={type:"NonTerminal",name:bt.nonTerminalName,idx:bt.idx};return xo(bt.label)&&(wt.label=bt.label),wt}else{if(bt instanceof pu)return{type:"Alternative",definition:At(bt.definition)};if(bt instanceof mu)return{type:"Option",idx:bt.idx,definition:At(bt.definition)};if(bt instanceof vp)return{type:"RepetitionMandatory",idx:bt.idx,definition:At(bt.definition)};if(bt instanceof yp)return{type:"RepetitionMandatoryWithSeparator",idx:bt.idx,separator:k1(new No({terminalType:bt.separator})),definition:At(bt.definition)};if(bt instanceof Ju)return{type:"RepetitionWithSeparator",idx:bt.idx,separator:k1(new No({terminalType:bt.separator})),definition:At(bt.definition)};if(bt instanceof yl)return{type:"Repetition",idx:bt.idx,definition:At(bt.definition)};if(bt instanceof Zu)return{type:"Alternation",idx:bt.idx,definition:At(bt.definition)};if(bt instanceof No){const wt={type:"Terminal",name:bt.terminalType.name,label:rv(bt.terminalType),idx:bt.idx};xo(bt.label)&&(wt.terminalLabel=bt.label);const Dt=bt.terminalType.PATTERN;return bt.terminalType.PATTERN&&(wt.pattern=$p(Dt)?Dt.source:Dt),wt}else{if(bt instanceof o1)return{type:"Rule",name:bt.name,orgText:bt.orgText,definition:At(bt.definition)};throw Error("non exhaustive match")}}}class a1{visit(At){const wt=At;switch(wt.constructor){case Su:return this.visitNonTerminal(wt);case pu:return this.visitAlternative(wt);case mu:return this.visitOption(wt);case vp:return this.visitRepetitionMandatory(wt);case yp:return this.visitRepetitionMandatoryWithSeparator(wt);case Ju:return this.visitRepetitionWithSeparator(wt);case yl:return this.visitRepetition(wt);case Zu:return this.visitAlternation(wt);case No:return this.visitTerminal(wt);case o1:return this.visitRule(wt);default:throw Error("non exhaustive match")}}visitNonTerminal(At){}visitAlternative(At){}visitOption(At){}visitRepetition(At){}visitRepetitionMandatory(At){}visitRepetitionMandatoryWithSeparator(At){}visitRepetitionWithSeparator(At){}visitAlternation(At){}visitTerminal(At){}visitRule(At){}}function ov(bt){return bt instanceof pu||bt instanceof mu||bt instanceof yl||bt instanceof vp||bt instanceof yp||bt instanceof Ju||bt instanceof No||bt instanceof o1}function N1(bt,At=[]){return bt instanceof mu||bt instanceof yl||bt instanceof Ju?!0:bt instanceof Zu?F3(bt.definition,Dt=>N1(Dt,At)):bt instanceof Su&&Or(At,bt)?!1:bt instanceof Ap?(bt instanceof Su&&At.push(bt),Ml(bt.definition,Dt=>N1(Dt,At))):!1}function av(bt){return bt instanceof Zu}function _p(bt){if(bt instanceof Su)return"SUBRULE";if(bt instanceof mu)return"OPTION";if(bt instanceof Zu)return"OR";if(bt instanceof vp)return"AT_LEAST_ONE";if(bt instanceof yp)return"AT_LEAST_ONE_SEP";if(bt instanceof Ju)return"MANY_SEP";if(bt instanceof yl)return"MANY";if(bt instanceof No)return"CONSUME";throw Error("non exhaustive match")}class D1{walk(At,wt=[]){ss(At.definition,(Dt,qt)=>{const gn=Qs(At.definition,qt+1);if(Dt instanceof Su)this.walkProdRef(Dt,gn,wt);else if(Dt instanceof No)this.walkTerminal(Dt,gn,wt);else if(Dt instanceof pu)this.walkFlat(Dt,gn,wt);else if(Dt instanceof mu)this.walkOption(Dt,gn,wt);else if(Dt instanceof vp)this.walkAtLeastOne(Dt,gn,wt);else if(Dt instanceof yp)this.walkAtLeastOneSep(Dt,gn,wt);else if(Dt instanceof Ju)this.walkManySep(Dt,gn,wt);else if(Dt instanceof yl)this.walkMany(Dt,gn,wt);else if(Dt instanceof Zu)this.walkOr(Dt,gn,wt);else throw Error("non exhaustive match")})}walkTerminal(At,wt,Dt){}walkProdRef(At,wt,Dt){}walkFlat(At,wt,Dt){const qt=wt.concat(Dt);this.walk(At,qt)}walkOption(At,wt,Dt){const qt=wt.concat(Dt);this.walk(At,qt)}walkAtLeastOne(At,wt,Dt){const qt=[new mu({definition:At.definition})].concat(wt,Dt);this.walk(At,qt)}walkAtLeastOneSep(At,wt,Dt){const qt=N3(At,wt,Dt);this.walk(At,qt)}walkMany(At,wt,Dt){const qt=[new mu({definition:At.definition})].concat(wt,Dt);this.walk(At,qt)}walkManySep(At,wt,Dt){const qt=N3(At,wt,Dt);this.walk(At,qt)}walkOr(At,wt,Dt){const qt=wt.concat(Dt);ss(At.definition,gn=>{const Rn=new pu({definition:[gn]});this.walk(Rn,qt)})}}function N3(bt,At,wt){return[new mu({definition:[new No({terminalType:bt.separator})].concat(bt.definition)})].concat(At,wt)}function _1(bt){if(bt instanceof Su)return _1(bt.referencedRule);if(bt instanceof No)return uv(bt);if(ov(bt))return lv(bt);if(av(bt))return cv(bt);throw Error("non exhaustive match")}function lv(bt){let At=[];const wt=bt.definition;let Dt=0,qt=wt.length>Dt,gn,Rn=!0;for(;qt&&Rn;)gn=wt[Dt],Rn=N1(gn),At=At.concat(_1(gn)),Dt=Dt+1,qt=wt.length>Dt;return a3(At)}function cv(bt){const At=en(bt.definition,wt=>_1(wt));return a3(Nl(At))}function uv(bt){return[bt.terminalType]}const D3="_~IN~_";class hv extends D1{constructor(At){super(),this.topProd=At,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(At,wt,Dt){}walkProdRef(At,wt,Dt){const qt=dv(At.referencedRule,At.idx)+this.topProd.name,gn=wt.concat(Dt),Rn=new pu({definition:gn}),Ln=_1(Rn);this.follows[qt]=Ln}}function fv(bt){const At={};return ss(bt,wt=>{const Dt=new hv(wt).startWalking();Mo(At,Dt)}),At}function dv(bt,At){return bt.name+At+D3}function Fs(bt){return bt.charCodeAt(0)}function c3(bt,At){Array.isArray(bt)?bt.forEach(function(wt){At.push(wt)}):At.push(bt)}function x1(bt,At){if(bt[At]===!0)throw"duplicate flag "+At;bt[At],bt[At]=!0}function l1(bt){if(bt===void 0)throw Error("Internal Error - Should never get here!");return!0}function pv(){throw Error("Internal Error - Should never get here!")}function O3(bt){return bt.type==="Character"}const O1=[];for(let bt=Fs("0");bt<=Fs("9");bt++)O1.push(bt);const U1=[Fs("_")].concat(O1);for(let bt=Fs("a");bt<=Fs("z");bt++)U1.push(bt);for(let bt=Fs("A");bt<=Fs("Z");bt++)U1.push(bt);const U3=[Fs(" "),Fs("\f"),Fs(`
`),Fs("\r"),Fs("	"),Fs("\v"),Fs("	"),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs(" "),Fs("\u2028"),Fs("\u2029"),Fs(" "),Fs(" "),Fs("　"),Fs("\uFEFF")],mv=/[0-9a-fA-F]/,G1=/[0-9]/,gv=/[1-9]/;class Av{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(At){this.idx=At.idx,this.input=At.input,this.groupIdx=At.groupIdx}pattern(At){this.idx=0,this.input=At,this.groupIdx=0,this.consumeChar("/");const wt=this.disjunction();this.consumeChar("/");const Dt={type:"Flags",loc:{begin:this.idx,end:At.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":x1(Dt,"global");break;case"i":x1(Dt,"ignoreCase");break;case"m":x1(Dt,"multiLine");break;case"u":x1(Dt,"unicode");break;case"y":x1(Dt,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:Dt,value:wt,loc:this.loc(0)}}disjunction(){const At=[],wt=this.idx;for(At.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),At.push(this.alternative());return{type:"Disjunction",value:At,loc:this.loc(wt)}}alternative(){const At=[],wt=this.idx;for(;this.isTerm();)At.push(this.term());return{type:"Alternative",value:At,loc:this.loc(wt)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const At=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(At)};case"$":return{type:"EndAnchor",loc:this.loc(At)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(At)};case"B":return{type:"NonWordBoundary",loc:this.loc(At)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let wt;switch(this.popChar()){case"=":wt="Lookahead";break;case"!":wt="NegativeLookahead";break}l1(wt);const Dt=this.disjunction();return this.consumeChar(")"),{type:wt,value:Dt,loc:this.loc(At)}}return pv()}quantifier(At=!1){let wt;const Dt=this.idx;switch(this.popChar()){case"*":wt={atLeast:0,atMost:1/0};break;case"+":wt={atLeast:1,atMost:1/0};break;case"?":wt={atLeast:0,atMost:1};break;case"{":const qt=this.integerIncludingZero();switch(this.popChar()){case"}":wt={atLeast:qt,atMost:qt};break;case",":let gn;this.isDigit()?(gn=this.integerIncludingZero(),wt={atLeast:qt,atMost:gn}):wt={atLeast:qt,atMost:1/0},this.consumeChar("}");break}if(At===!0&&wt===void 0)return;l1(wt);break}if(!(At===!0&&wt===void 0)&&l1(wt))return this.peekChar(0)==="?"?(this.consumeChar("?"),wt.greedy=!1):wt.greedy=!0,wt.type="Quantifier",wt.loc=this.loc(Dt),wt}atom(){let At;const wt=this.idx;switch(this.peekChar()){case".":At=this.dotAll();break;case"\\":At=this.atomEscape();break;case"[":At=this.characterClass();break;case"(":At=this.group();break}if(At===void 0&&this.isPatternCharacter()&&(At=this.patternCharacter()),l1(At))return At.loc=this.loc(wt),this.isQuantifier()&&(At.quantifier=this.quantifier()),At}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Fs(`
`),Fs("\r"),Fs("\u2028"),Fs("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let At,wt=!1;switch(this.popChar()){case"d":At=O1;break;case"D":At=O1,wt=!0;break;case"s":At=U3;break;case"S":At=U3,wt=!0;break;case"w":At=U1;break;case"W":At=U1,wt=!0;break}if(l1(At))return{type:"Set",value:At,complement:wt}}controlEscapeAtom(){let At;switch(this.popChar()){case"f":At=Fs("\f");break;case"n":At=Fs(`
`);break;case"r":At=Fs("\r");break;case"t":At=Fs("	");break;case"v":At=Fs("\v");break}if(l1(At))return{type:"Character",value:At}}controlLetterEscapeAtom(){this.consumeChar("c");const At=this.popChar();if(/[a-zA-Z]/.test(At)===!1)throw Error("Invalid ");return{type:"Character",value:At.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Fs("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const At=this.popChar();return{type:"Character",value:Fs(At)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const At=this.popChar();return{type:"Character",value:Fs(At)}}}characterClass(){const At=[];let wt=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),wt=!0);this.isClassAtom();){const Dt=this.classAtom();if(Dt.type,O3(Dt)&&this.isRangeDash()){this.consumeChar("-");const qt=this.classAtom();if(qt.type,O3(qt)){if(qt.value<Dt.value)throw Error("Range out of order in character class");At.push({from:Dt.value,to:qt.value})}else c3(Dt.value,At),At.push(Fs("-")),c3(qt.value,At)}else c3(Dt.value,At)}return this.consumeChar("]"),{type:"Set",complement:wt,value:At}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Fs("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let At=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),At=!1;break;default:this.groupIdx++;break}const wt=this.disjunction();this.consumeChar(")");const Dt={type:"Group",capturing:At,value:wt};return At&&(Dt.idx=this.groupIdx),Dt}positiveInteger(){let At=this.popChar();if(gv.test(At)===!1)throw Error("Expecting a positive integer");for(;G1.test(this.peekChar(0));)At+=this.popChar();return parseInt(At,10)}integerIncludingZero(){let At=this.popChar();if(G1.test(At)===!1)throw Error("Expecting an integer");for(;G1.test(this.peekChar(0));)At+=this.popChar();return parseInt(At,10)}patternCharacter(){const At=this.popChar();switch(At){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Fs(At)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return G1.test(this.peekChar(0))}isClassAtom(At=0){switch(this.peekChar(At)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const At=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(At)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(At){let wt="";for(let qt=0;qt<At;qt++){const gn=this.popChar();if(mv.test(gn)===!1)throw Error("Expecting a HexDecimal digits");wt+=gn}return{type:"Character",value:parseInt(wt,16)}}peekChar(At=0){return this.input[this.idx+At]}popChar(){const At=this.peekChar(0);return this.consumeChar(void 0),At}consumeChar(At){if(At!==void 0&&this.input[this.idx]!==At)throw Error("Expected: '"+At+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(At){return{begin:At,end:this.idx}}}class u3{visitChildren(At){for(const wt in At){const Dt=At[wt];At.hasOwnProperty(wt)&&(Dt.type!==void 0?this.visit(Dt):Array.isArray(Dt)&&Dt.forEach(qt=>{this.visit(qt)},this))}}visit(At){switch(At.type){case"Pattern":this.visitPattern(At);break;case"Flags":this.visitFlags(At);break;case"Disjunction":this.visitDisjunction(At);break;case"Alternative":this.visitAlternative(At);break;case"StartAnchor":this.visitStartAnchor(At);break;case"EndAnchor":this.visitEndAnchor(At);break;case"WordBoundary":this.visitWordBoundary(At);break;case"NonWordBoundary":this.visitNonWordBoundary(At);break;case"Lookahead":this.visitLookahead(At);break;case"NegativeLookahead":this.visitNegativeLookahead(At);break;case"Character":this.visitCharacter(At);break;case"Set":this.visitSet(At);break;case"Group":this.visitGroup(At);break;case"GroupBackReference":this.visitGroupBackReference(At);break;case"Quantifier":this.visitQuantifier(At);break}this.visitChildren(At)}visitPattern(At){}visitFlags(At){}visitDisjunction(At){}visitAlternative(At){}visitStartAnchor(At){}visitEndAnchor(At){}visitWordBoundary(At){}visitNonWordBoundary(At){}visitLookahead(At){}visitNegativeLookahead(At){}visitCharacter(At){}visitSet(At){}visitGroup(At){}visitGroupBackReference(At){}visitQuantifier(At){}}let V1={};const vv=new Av;function z1(bt){const At=bt.toString();if(V1.hasOwnProperty(At))return V1[At];{const wt=vv.pattern(At);return V1[At]=wt,wt}}function yv(){V1={}}const G3="Complement Sets are not supported for first char optimization",H1=`Unable to use "first char" lexer optimizations:
`;function _v(bt,At=!1){try{const wt=z1(bt);return h3(wt.value,{},wt.flags.ignoreCase)}catch(wt){if(wt.message===G3)At&&P3(`${H1}	Unable to optimize: < ${bt.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let Dt="";At&&(Dt=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),l3(`${H1}
	Failed parsing: < ${bt.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+Dt)}}return[]}function h3(bt,At,wt){switch(bt.type){case"Disjunction":for(let qt=0;qt<bt.value.length;qt++)h3(bt.value[qt],At,wt);break;case"Alternative":const Dt=bt.value;for(let qt=0;qt<Dt.length;qt++){const gn=Dt[qt];switch(gn.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const Rn=gn;switch(Rn.type){case"Character":Q1(Rn.value,At,wt);break;case"Set":if(Rn.complement===!0)throw Error(G3);ss(Rn.value,Xn=>{if(typeof Xn=="number")Q1(Xn,At,wt);else{const rr=Xn;if(wt===!0)for(let xr=rr.from;xr<=rr.to;xr++)Q1(xr,At,wt);else{for(let xr=rr.from;xr<=rr.to&&xr<S1;xr++)Q1(xr,At,wt);if(rr.to>=S1){const xr=rr.from>=S1?rr.from:S1,br=rr.to,Gr=Lm(xr),ls=Lm(br);for(let ys=Gr;ys<=ls;ys++)At[ys]=ys}}}});break;case"Group":h3(Rn.value,At,wt);break;default:throw Error("Non Exhaustive Match")}const Ln=Rn.quantifier!==void 0&&Rn.quantifier.atLeast===0;if(Rn.type==="Group"&&f3(Rn)===!1||Rn.type!=="Group"&&Ln===!1)break}break;default:throw Error("non exhaustive match!")}return er(At)}function Q1(bt,At,wt){const Dt=Lm(bt);At[Dt]=Dt,wt===!0&&xv(bt,At)}function xv(bt,At){const wt=String.fromCharCode(bt),Dt=wt.toUpperCase();if(Dt!==wt){const qt=Lm(Dt.charCodeAt(0));At[qt]=qt}else{const qt=wt.toLowerCase();if(qt!==wt){const gn=Lm(qt.charCodeAt(0));At[gn]=gn}}}function V3(bt,At){return Ft(bt.value,wt=>{if(typeof wt=="number")return Or(At,wt);{const Dt=wt;return Ft(At,qt=>Dt.from<=qt&&qt<=Dt.to)!==void 0}})}function f3(bt){const At=bt.quantifier;return At&&At.atLeast===0?!0:bt.value?Mt(bt.value)?Ml(bt.value,f3):f3(bt.value):!1}class Ev extends u3{constructor(At){super(),this.targetCharCodes=At,this.found=!1}visitChildren(At){if(this.found!==!0){switch(At.type){case"Lookahead":this.visitLookahead(At);return;case"NegativeLookahead":this.visitNegativeLookahead(At);return}super.visitChildren(At)}}visitCharacter(At){Or(this.targetCharCodes,At.value)&&(this.found=!0)}visitSet(At){At.complement?V3(At,this.targetCharCodes)===void 0&&(this.found=!0):V3(At,this.targetCharCodes)!==void 0&&(this.found=!0)}}function d3(bt,At){if(At instanceof RegExp){const wt=z1(At),Dt=new Ev(bt);return Dt.visit(wt),Dt.found}else return Ft(At,wt=>Or(bt,wt.charCodeAt(0)))!==void 0}const m0="PATTERN",E1="defaultMode",W1="modes";let z3=typeof new RegExp("(?:)").sticky=="boolean";function Sv(bt,At){At=bo(At,{useSticky:z3,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(as,qr)=>qr()});const wt=At.tracer;wt("initCharCodeToOptimizedIndexMap",()=>{jv()});let Dt;wt("Reject Lexer.NA",()=>{Dt=L1(bt,as=>as[m0]===bu.NA)});let qt=!1,gn;wt("Transform Patterns",()=>{qt=!1,gn=en(Dt,as=>{const qr=as[m0];if($p(qr)){const gs=qr.source;return gs.length===1&&gs!=="^"&&gs!=="$"&&gs!=="."&&!qr.ignoreCase?gs:gs.length===2&&gs[0]==="\\"&&!Or(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],gs[1])?gs[1]:At.useSticky?Q3(qr):H3(qr)}else{if(Cn(qr))return qt=!0,{exec:qr};if(typeof qr=="object")return qt=!0,qr;if(typeof qr=="string"){if(qr.length===1)return qr;{const gs=qr.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),Eo=new RegExp(gs);return At.useSticky?Q3(Eo):H3(Eo)}}else throw Error("non exhaustive match")}})});let Rn,Ln,Xn,rr,xr;wt("misc mapping",()=>{Rn=en(Dt,as=>as.tokenTypeIdx),Ln=en(Dt,as=>{const qr=as.GROUP;if(qr!==bu.SKIPPED){if(xo(qr))return qr;if(Xp(qr))return!1;throw Error("non exhaustive match")}}),Xn=en(Dt,as=>{const qr=as.LONGER_ALT;if(qr)return Mt(qr)?en(qr,Eo=>Os(Dt,Eo)):[Os(Dt,qr)]}),rr=en(Dt,as=>as.PUSH_MODE),xr=en(Dt,as=>Br(as,"POP_MODE"))});let br;wt("Line Terminator Handling",()=>{const as=$3(At.lineTerminatorCharacters);br=en(Dt,qr=>!1),At.positionTracking!=="onlyOffset"&&(br=en(Dt,qr=>Br(qr,"LINE_BREAKS")?!!qr.LINE_BREAKS:j3(qr,as)===!1&&d3(as,qr.PATTERN)))});let Gr,ls,ys,xs;wt("Misc Mapping #2",()=>{Gr=en(Dt,W3),ls=en(gn,Hv),ys=Eu(Dt,(as,qr)=>{const gs=qr.GROUP;return xo(gs)&&gs!==bu.SKIPPED&&(as[gs]=[]),as},{}),xs=en(gn,(as,qr)=>({pattern:gn[qr],longerAlt:Xn[qr],canLineTerminator:br[qr],isCustom:Gr[qr],short:ls[qr],group:Ln[qr],push:rr[qr],pop:xr[qr],tokenTypeIdx:Rn[qr],tokenType:Dt[qr]}))});let Bs=!0,rs=[];return At.safeMode||wt("First Char Optimization",()=>{rs=Eu(Dt,(as,qr,gs)=>{if(typeof qr.PATTERN=="string"){const Eo=qr.PATTERN.charCodeAt(0),_h=Lm(Eo);p3(as,_h,xs[gs])}else if(Mt(qr.START_CHARS_HINT)){let Eo;ss(qr.START_CHARS_HINT,_h=>{const Nm=typeof _h=="string"?_h.charCodeAt(0):_h,v0=Lm(Nm);Eo!==v0&&(Eo=v0,p3(as,v0,xs[gs]))})}else if($p(qr.PATTERN))if(qr.PATTERN.unicode)Bs=!1,At.ensureOptimizations&&l3(`${H1}	Unable to analyze < ${qr.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const Eo=_v(qr.PATTERN,At.ensureOptimizations);qs(Eo)&&(Bs=!1),ss(Eo,_h=>{p3(as,_h,xs[gs])})}else At.ensureOptimizations&&l3(`${H1}	TokenType: <${qr.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),Bs=!1;return as},[])}),{emptyGroups:ys,patternIdxToConfig:xs,charCodeToPatternIdxToConfig:rs,hasCustom:qt,canBeOptimized:Bs}}function bv(bt,At){let wt=[];const Dt=Tv(bt);wt=wt.concat(Dt.errors);const qt=Mv(Dt.valid),gn=qt.valid;return wt=wt.concat(qt.errors),wt=wt.concat(Cv(gn)),wt=wt.concat(kv(gn)),wt=wt.concat(Nv(gn,At)),wt=wt.concat(Dv(gn)),wt}function Cv(bt){let At=[];const wt=Il(bt,Dt=>$p(Dt[m0]));return At=At.concat(Iv(wt)),At=At.concat(Fv(wt)),At=At.concat(Pv(wt)),At=At.concat(Lv(wt)),At=At.concat(Bv(wt)),At}function Tv(bt){const At=Il(bt,qt=>!Br(qt,m0)),wt=en(At,qt=>({message:"Token Type: ->"+qt.name+"<- missing static 'PATTERN' property",type:Ho.MISSING_PATTERN,tokenTypes:[qt]})),Dt=go(bt,At);return{errors:wt,valid:Dt}}function Mv(bt){const At=Il(bt,qt=>{const gn=qt[m0];return!$p(gn)&&!Cn(gn)&&!Br(gn,"exec")&&!xo(gn)}),wt=en(At,qt=>({message:"Token Type: ->"+qt.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ho.INVALID_PATTERN,tokenTypes:[qt]})),Dt=go(bt,At);return{errors:wt,valid:Dt}}const wv=/[^\\][$]/;function Iv(bt){class At extends u3{constructor(){super(...arguments),this.found=!1}visitEndAnchor(gn){this.found=!0}}const wt=Il(bt,qt=>{const gn=qt.PATTERN;try{const Rn=z1(gn),Ln=new At;return Ln.visit(Rn),Ln.found}catch{return wv.test(gn.source)}});return en(wt,qt=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+qt.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ho.EOI_ANCHOR_FOUND,tokenTypes:[qt]}))}function Bv(bt){const At=Il(bt,Dt=>Dt.PATTERN.test(""));return en(At,Dt=>({message:"Token Type: ->"+Dt.name+"<- static 'PATTERN' must not match an empty string",type:Ho.EMPTY_MATCH_PATTERN,tokenTypes:[Dt]}))}const Rv=/[^\\[][\^]|^\^/;function Fv(bt){class At extends u3{constructor(){super(...arguments),this.found=!1}visitStartAnchor(gn){this.found=!0}}const wt=Il(bt,qt=>{const gn=qt.PATTERN;try{const Rn=z1(gn),Ln=new At;return Ln.visit(Rn),Ln.found}catch{return Rv.test(gn.source)}});return en(wt,qt=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+qt.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Ho.SOI_ANCHOR_FOUND,tokenTypes:[qt]}))}function Pv(bt){const At=Il(bt,Dt=>{const qt=Dt[m0];return qt instanceof RegExp&&(qt.multiline||qt.global)});return en(At,Dt=>({message:"Token Type: ->"+Dt.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ho.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[Dt]}))}function Lv(bt){const At=[];let wt=en(bt,gn=>Eu(bt,(Rn,Ln)=>(gn.PATTERN.source===Ln.PATTERN.source&&!Or(At,Ln)&&Ln.PATTERN!==bu.NA&&(At.push(Ln),Rn.push(Ln)),Rn),[]));wt=Ru(wt);const Dt=Il(wt,gn=>gn.length>1);return en(Dt,gn=>{const Rn=en(gn,Xn=>Xn.name);return{message:`The same RegExp pattern ->${Nt(gn).PATTERN}<-has been used in all of the following Token Types: ${Rn.join(", ")} <-`,type:Ho.DUPLICATE_PATTERNS_FOUND,tokenTypes:gn}})}function kv(bt){const At=Il(bt,Dt=>{if(!Br(Dt,"GROUP"))return!1;const qt=Dt.GROUP;return qt!==bu.SKIPPED&&qt!==bu.NA&&!xo(qt)});return en(At,Dt=>({message:"Token Type: ->"+Dt.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ho.INVALID_GROUP_TYPE_FOUND,tokenTypes:[Dt]}))}function Nv(bt,At){const wt=Il(bt,qt=>qt.PUSH_MODE!==void 0&&!Or(At,qt.PUSH_MODE));return en(wt,qt=>({message:`Token Type: ->${qt.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${qt.PUSH_MODE}<-which does not exist`,type:Ho.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[qt]}))}function Dv(bt){const At=[],wt=Eu(bt,(Dt,qt,gn)=>{const Rn=qt.PATTERN;return Rn===bu.NA||(xo(Rn)?Dt.push({str:Rn,idx:gn,tokenType:qt}):$p(Rn)&&Uv(Rn)&&Dt.push({str:Rn.source,idx:gn,tokenType:qt})),Dt},[]);return ss(bt,(Dt,qt)=>{ss(wt,({str:gn,idx:Rn,tokenType:Ln})=>{if(qt<Rn&&Ov(gn,Dt.PATTERN)){const Xn=`Token: ->${Ln.name}<- can never be matched.
Because it appears AFTER the Token Type ->${Dt.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;At.push({message:Xn,type:Ho.UNREACHABLE_PATTERN,tokenTypes:[Dt,Ln]})}})}),At}function Ov(bt,At){if($p(At)){const wt=At.exec(bt);return wt!==null&&wt.index===0}else{if(Cn(At))return At(bt,0,[],{});if(Br(At,"exec"))return At.exec(bt,0,[],{});if(typeof At=="string")return At===bt;throw Error("non exhaustive match")}}function Uv(bt){return Ft([".","\\","[","]","|","^","$","(",")","?","*","+","{"],wt=>bt.source.indexOf(wt)!==-1)===void 0}function H3(bt){const At=bt.ignoreCase?"i":"";return new RegExp(`^(?:${bt.source})`,At)}function Q3(bt){const At=bt.ignoreCase?"iy":"y";return new RegExp(`${bt.source}`,At)}function Gv(bt,At,wt){const Dt=[];return Br(bt,E1)||Dt.push({message:"A MultiMode Lexer cannot be initialized without a <"+E1+`> property in its definition
`,type:Ho.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Br(bt,W1)||Dt.push({message:"A MultiMode Lexer cannot be initialized without a <"+W1+`> property in its definition
`,type:Ho.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Br(bt,W1)&&Br(bt,E1)&&!Br(bt.modes,bt.defaultMode)&&Dt.push({message:`A MultiMode Lexer cannot be initialized with a ${E1}: <${bt.defaultMode}>which does not exist
`,type:Ho.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Br(bt,W1)&&ss(bt.modes,(qt,gn)=>{ss(qt,(Rn,Ln)=>{if(Xp(Rn))Dt.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${gn}> at index: <${Ln}>
`,type:Ho.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Br(Rn,"LONGER_ALT")){const Xn=Mt(Rn.LONGER_ALT)?Rn.LONGER_ALT:[Rn.LONGER_ALT];ss(Xn,rr=>{!Xp(rr)&&!Or(qt,rr)&&Dt.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${rr.name}> on token <${Rn.name}> outside of mode <${gn}>
`,type:Ho.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),Dt}function Vv(bt,At,wt){const Dt=[];let qt=!1;const gn=Ru(Nl(er(bt.modes))),Rn=L1(gn,Xn=>Xn[m0]===bu.NA),Ln=$3(wt);return At&&ss(Rn,Xn=>{const rr=j3(Xn,Ln);if(rr!==!1){const br={message:Wv(Xn,rr),type:rr.issue,tokenType:Xn};Dt.push(br)}else Br(Xn,"LINE_BREAKS")?Xn.LINE_BREAKS===!0&&(qt=!0):d3(Ln,Xn.PATTERN)&&(qt=!0)}),At&&!qt&&Dt.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Ho.NO_LINE_BREAKS_FLAGS}),Dt}function zv(bt){const At={},wt=Xo(bt);return ss(wt,Dt=>{const qt=bt[Dt];if(Mt(qt))At[Dt]=[];else throw Error("non exhaustive match")}),At}function W3(bt){const At=bt.PATTERN;if($p(At))return!1;if(Cn(At))return!0;if(Br(At,"exec"))return!0;if(xo(At))return!1;throw Error("non exhaustive match")}function Hv(bt){return xo(bt)&&bt.length===1?bt.charCodeAt(0):!1}const Qv={test:function(bt){const At=bt.length;for(let wt=this.lastIndex;wt<At;wt++){const Dt=bt.charCodeAt(wt);if(Dt===10)return this.lastIndex=wt+1,!0;if(Dt===13)return bt.charCodeAt(wt+1)===10?this.lastIndex=wt+2:this.lastIndex=wt+1,!0}return!1},lastIndex:0};function j3(bt,At){if(Br(bt,"LINE_BREAKS"))return!1;if($p(bt.PATTERN)){try{d3(At,bt.PATTERN)}catch(wt){return{issue:Ho.IDENTIFY_TERMINATOR,errMsg:wt.message}}return!1}else{if(xo(bt.PATTERN))return!1;if(W3(bt))return{issue:Ho.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Wv(bt,At){if(At.issue===Ho.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${bt.name}> Token Type
	 Root cause: ${At.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(At.issue===Ho.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${bt.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function $3(bt){return en(bt,wt=>xo(wt)?wt.charCodeAt(0):wt)}function p3(bt,At,wt){bt[At]===void 0?bt[At]=[wt]:bt[At].push(wt)}const S1=256;let j1=[];function Lm(bt){return bt<S1?bt:j1[bt]}function jv(){if(qs(j1)){j1=new Array(65536);for(let bt=0;bt<65536;bt++)j1[bt]=bt>255?255+~~(bt/255):bt}}function b1(bt,At){const wt=bt.tokenTypeIdx;return wt===At.tokenTypeIdx?!0:At.isParent===!0&&At.categoryMatchesMap[wt]===!0}function $1(bt,At){return bt.tokenTypeIdx===At.tokenTypeIdx}let X3=1;const K3={};function C1(bt){const At=$v(bt);Xv(At),Yv(At),Kv(At),ss(At,wt=>{wt.isParent=wt.categoryMatches.length>0})}function $v(bt){let At=Co(bt),wt=bt,Dt=!0;for(;Dt;){wt=Ru(Nl(en(wt,gn=>gn.CATEGORIES)));const qt=go(wt,At);At=At.concat(qt),qs(qt)?Dt=!1:wt=qt}return At}function Xv(bt){ss(bt,At=>{q3(At)||(K3[X3]=At,At.tokenTypeIdx=X3++),J3(At)&&!Mt(At.CATEGORIES)&&(At.CATEGORIES=[At.CATEGORIES]),J3(At)||(At.CATEGORIES=[]),qv(At)||(At.categoryMatches=[]),Jv(At)||(At.categoryMatchesMap={})})}function Kv(bt){ss(bt,At=>{At.categoryMatches=[],ss(At.categoryMatchesMap,(wt,Dt)=>{At.categoryMatches.push(K3[Dt].tokenTypeIdx)})})}function Yv(bt){ss(bt,At=>{Y3([],At)})}function Y3(bt,At){ss(bt,wt=>{At.categoryMatchesMap[wt.tokenTypeIdx]=!0}),ss(At.CATEGORIES,wt=>{const Dt=bt.concat(At);Or(Dt,wt)||Y3(Dt,wt)})}function q3(bt){return Br(bt,"tokenTypeIdx")}function J3(bt){return Br(bt,"CATEGORIES")}function qv(bt){return Br(bt,"categoryMatches")}function Jv(bt){return Br(bt,"categoryMatchesMap")}function Zv(bt){return Br(bt,"tokenTypeIdx")}const e2={buildUnableToPopLexerModeMessage(bt){return`Unable to pop Lexer Mode after encountering Token ->${bt.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(bt,At,wt,Dt,qt){return`unexpected character: ->${bt.charAt(At)}<- at offset: ${At}, skipped ${wt} characters.`}};var Ho;(function(bt){bt[bt.MISSING_PATTERN=0]="MISSING_PATTERN",bt[bt.INVALID_PATTERN=1]="INVALID_PATTERN",bt[bt.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",bt[bt.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",bt[bt.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",bt[bt.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",bt[bt.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",bt[bt.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",bt[bt.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",bt[bt.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",bt[bt.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",bt[bt.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",bt[bt.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",bt[bt.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",bt[bt.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",bt[bt.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",bt[bt.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",bt[bt.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Ho||(Ho={}));const T1={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:e2,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(T1);class bu{constructor(At,wt=T1){if(this.lexerDefinition=At,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(qt,gn)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const Rn=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${Rn}--> <${qt}>`);const{time:Ln,value:Xn}=L3(gn),rr=Ln>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&rr(`${Rn}<-- <${qt}> time: ${Ln}ms`),this.traceInitIndent--,Xn}else return gn()},typeof wt=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Mo({},T1,wt);const Dt=this.config.traceInitPerf;Dt===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof Dt=="number"&&(this.traceInitMaxIdent=Dt,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let qt,gn=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===T1.lineTerminatorsPattern)this.config.lineTerminatorsPattern=Qv;else if(this.config.lineTerminatorCharacters===T1.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(wt.safeMode&&wt.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),Mt(At)?qt={modes:{defaultMode:Co(At)},defaultMode:E1}:(gn=!1,qt=Co(At))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(Gv(qt,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(Vv(qt,this.trackStartLines,this.config.lineTerminatorCharacters))})),qt.modes=qt.modes?qt.modes:{},ss(qt.modes,(Ln,Xn)=>{qt.modes[Xn]=L1(Ln,rr=>Xp(rr))});const Rn=Xo(qt.modes);if(ss(qt.modes,(Ln,Xn)=>{this.TRACE_INIT(`Mode: <${Xn}> processing`,()=>{if(this.modes.push(Xn),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(bv(Ln,Rn))}),qs(this.lexerDefinitionErrors)){C1(Ln);let rr;this.TRACE_INIT("analyzeTokenTypes",()=>{rr=Sv(Ln,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:wt.positionTracking,ensureOptimizations:wt.ensureOptimizations,safeMode:wt.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[Xn]=rr.patternIdxToConfig,this.charCodeToPatternIdxToConfig[Xn]=rr.charCodeToPatternIdxToConfig,this.emptyGroups=Mo({},this.emptyGroups,rr.emptyGroups),this.hasCustom=rr.hasCustom||this.hasCustom,this.canModeBeOptimized[Xn]=rr.canBeOptimized}})}),this.defaultMode=qt.defaultMode,!qs(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const Xn=en(this.lexerDefinitionErrors,rr=>rr.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+Xn)}ss(this.lexerDefinitionWarning,Ln=>{P3(Ln.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(z3?(this.chopInput=Tn,this.match=this.matchWithTest):(this.updateLastIndex=Jn,this.match=this.matchWithExec),gn&&(this.handleModes=Jn),this.trackStartLines===!1&&(this.computeNewColumn=Tn),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Jn),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const Ln=Eu(this.canModeBeOptimized,(Xn,rr,xr)=>(rr===!1&&Xn.push(xr),Xn),[]);if(wt.ensureOptimizations&&!qs(Ln))throw Error(`Lexer Modes: < ${Ln.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{yv()}),this.TRACE_INIT("toFastProperties",()=>{k3(this)})})}tokenize(At,wt=this.defaultMode){if(!qs(this.lexerDefinitionErrors)){const qt=en(this.lexerDefinitionErrors,gn=>gn.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+qt)}return this.tokenizeInternal(At,wt)}tokenizeInternal(At,wt){let Dt,qt,gn,Rn,Ln,Xn,rr,xr,br,Gr,ls,ys,xs,Bs,rs;const as=At,qr=as.length;let gs=0,Eo=0;const _h=this.hasCustom?0:Math.floor(At.length/10),Nm=new Array(_h),v0=[];let B1=this.trackStartLines?1:void 0,Dm=this.trackStartLines?1:void 0;const R1=zv(this.emptyGroups),my=this.trackStartLines,I3=this.config.lineTerminatorsPattern;let i3=0,Om=[],F1=[];const s3=[],NA=[];Object.freeze(NA);let P1;function DA(){return Om}function OA(Kl){const Pu=Lm(Kl),c1=F1[Pu];return c1===void 0?NA:c1}const gy=Kl=>{if(s3.length===1&&Kl.tokenType.PUSH_MODE===void 0){const Pu=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Kl);v0.push({offset:Kl.startOffset,line:Kl.startLine,column:Kl.startColumn,length:Kl.image.length,message:Pu})}else{s3.pop();const Pu=no(s3);Om=this.patternIdxToConfig[Pu],F1=this.charCodeToPatternIdxToConfig[Pu],i3=Om.length;const c1=this.canModeBeOptimized[Pu]&&this.config.safeMode===!1;F1&&c1?P1=OA:P1=DA}};function UA(Kl){s3.push(Kl),F1=this.charCodeToPatternIdxToConfig[Kl],Om=this.patternIdxToConfig[Kl],i3=Om.length,i3=Om.length;const Pu=this.canModeBeOptimized[Kl]&&this.config.safeMode===!1;F1&&Pu?P1=OA:P1=DA}UA.call(this,wt);let _f;const GA=this.config.recoveryEnabled;for(;gs<qr;){Xn=null;const Kl=as.charCodeAt(gs),Pu=P1(Kl),c1=Pu.length;for(Dt=0;Dt<c1;Dt++){_f=Pu[Dt];const Cu=_f.pattern;rr=null;const Yp=_f.short;if(Yp!==!1?Kl===Yp&&(Xn=Cu):_f.isCustom===!0?(rs=Cu.exec(as,gs,Nm,R1),rs!==null?(Xn=rs[0],rs.payload!==void 0&&(rr=rs.payload)):Xn=null):(this.updateLastIndex(Cu,gs),Xn=this.match(Cu,At,gs)),Xn!==null){if(Ln=_f.longerAlt,Ln!==void 0){const Um=Ln.length;for(gn=0;gn<Um;gn++){const qp=Om[Ln[gn]],y0=qp.pattern;if(xr=null,qp.isCustom===!0?(rs=y0.exec(as,gs,Nm,R1),rs!==null?(Rn=rs[0],rs.payload!==void 0&&(xr=rs.payload)):Rn=null):(this.updateLastIndex(y0,gs),Rn=this.match(y0,At,gs)),Rn&&Rn.length>Xn.length){Xn=Rn,rr=xr,_f=qp;break}}}break}}if(Xn!==null){if(br=Xn.length,Gr=_f.group,Gr!==void 0&&(ls=_f.tokenTypeIdx,ys=this.createTokenInstance(Xn,gs,ls,_f.tokenType,B1,Dm,br),this.handlePayload(ys,rr),Gr===!1?Eo=this.addToken(Nm,Eo,ys):R1[Gr].push(ys)),At=this.chopInput(At,br),gs=gs+br,Dm=this.computeNewColumn(Dm,br),my===!0&&_f.canLineTerminator===!0){let Cu=0,Yp,Um;I3.lastIndex=0;do Yp=I3.test(Xn),Yp===!0&&(Um=I3.lastIndex-1,Cu++);while(Yp===!0);Cu!==0&&(B1=B1+Cu,Dm=br-Um,this.updateTokenEndLineColumnLocation(ys,Gr,Um,Cu,B1,Dm,br))}this.handleModes(_f,gy,UA,ys)}else{const Cu=gs,Yp=B1,Um=Dm;let qp=GA===!1;for(;qp===!1&&gs<qr;)for(At=this.chopInput(At,1),gs++,qt=0;qt<i3;qt++){const y0=Om[qt],B3=y0.pattern,VA=y0.short;if(VA!==!1?as.charCodeAt(gs)===VA&&(qp=!0):y0.isCustom===!0?qp=B3.exec(as,gs,Nm,R1)!==null:(this.updateLastIndex(B3,gs),qp=B3.exec(At)!==null),qp===!0)break}if(xs=gs-Cu,Dm=this.computeNewColumn(Dm,xs),Bs=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(as,Cu,xs,Yp,Um),v0.push({offset:Cu,line:Yp,column:Um,length:xs,message:Bs}),GA===!1)break}}return this.hasCustom||(Nm.length=Eo),{tokens:Nm,groups:R1,errors:v0}}handleModes(At,wt,Dt,qt){if(At.pop===!0){const gn=At.push;wt(qt),gn!==void 0&&Dt.call(this,gn)}else At.push!==void 0&&Dt.call(this,At.push)}chopInput(At,wt){return At.substring(wt)}updateLastIndex(At,wt){At.lastIndex=wt}updateTokenEndLineColumnLocation(At,wt,Dt,qt,gn,Rn,Ln){let Xn,rr;wt!==void 0&&(Xn=Dt===Ln-1,rr=Xn?-1:0,qt===1&&Xn===!0||(At.endLine=gn+rr,At.endColumn=Rn-1+-rr))}computeNewColumn(At,wt){return At+wt}createOffsetOnlyToken(At,wt,Dt,qt){return{image:At,startOffset:wt,tokenTypeIdx:Dt,tokenType:qt}}createStartOnlyToken(At,wt,Dt,qt,gn,Rn){return{image:At,startOffset:wt,startLine:gn,startColumn:Rn,tokenTypeIdx:Dt,tokenType:qt}}createFullToken(At,wt,Dt,qt,gn,Rn,Ln){return{image:At,startOffset:wt,endOffset:wt+Ln-1,startLine:gn,endLine:gn,startColumn:Rn,endColumn:Rn+Ln-1,tokenTypeIdx:Dt,tokenType:qt}}addTokenUsingPush(At,wt,Dt){return At.push(Dt),wt}addTokenUsingMemberAccess(At,wt,Dt){return At[wt]=Dt,wt++,wt}handlePayloadNoCustom(At,wt){}handlePayloadWithCustom(At,wt){wt!==null&&(At.payload=wt)}matchWithTest(At,wt,Dt){return At.test(wt)===!0?wt.substring(Dt,At.lastIndex):null}matchWithExec(At,wt){const Dt=At.exec(wt);return Dt!==null?Dt[0]:null}}bu.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",bu.NA=/NOT_APPLICABLE/;function M1(bt){return Z3(bt)?bt.LABEL:bt.name}function Z3(bt){return xo(bt.LABEL)&&bt.LABEL!==""}const t2="parent",eA="categories",tA="label",nA="group",rA="push_mode",iA="pop_mode",sA="longer_alt",oA="line_breaks",aA="start_chars_hint";function m3(bt){return n2(bt)}function n2(bt){const At=bt.pattern,wt={};if(wt.name=bt.name,Xp(At)||(wt.PATTERN=At),Br(bt,t2))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Br(bt,eA)&&(wt.CATEGORIES=bt[eA]),C1([wt]),Br(bt,tA)&&(wt.LABEL=bt[tA]),Br(bt,nA)&&(wt.GROUP=bt[nA]),Br(bt,iA)&&(wt.POP_MODE=bt[iA]),Br(bt,rA)&&(wt.PUSH_MODE=bt[rA]),Br(bt,sA)&&(wt.LONGER_ALT=bt[sA]),Br(bt,oA)&&(wt.LINE_BREAKS=bt[oA]),Br(bt,aA)&&(wt.START_CHARS_HINT=bt[aA]),wt}const g0=m3({name:"EOF",pattern:bu.NA});C1([g0]);function g3(bt,At,wt,Dt,qt,gn,Rn,Ln){return{image:At,startOffset:wt,endOffset:Dt,startLine:qt,endLine:gn,startColumn:Rn,endColumn:Ln,tokenTypeIdx:bt.tokenTypeIdx,tokenType:bt}}function r2(bt,At){return b1(bt,At)}const lA={buildMismatchTokenMessage({expected:bt,actual:At,previous:wt,ruleName:Dt}){return`Expecting ${Z3(bt)?`--> ${M1(bt)} <--`:`token of type --> ${bt.name} <--`} but found --> '${At.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:bt,ruleName:At}){return"Redundant input, expecting EOF but found: "+bt.image},buildNoViableAltMessage({expectedPathsPerAlt:bt,actual:At,previous:wt,customUserDescription:Dt,ruleName:qt}){const gn="Expecting: ",Ln=`
but found: '`+Nt(At).image+"'";if(Dt)return gn+Dt+Ln;{const Xn=Eu(bt,(Gr,ls)=>Gr.concat(ls),[]),rr=en(Xn,Gr=>`[${en(Gr,ls=>M1(ls)).join(", ")}]`),br=`one of these possible Token sequences:
${en(rr,(Gr,ls)=>`  ${ls+1}. ${Gr}`).join(`
`)}`;return gn+br+Ln}},buildEarlyExitMessage({expectedIterationPaths:bt,actual:At,customUserDescription:wt,ruleName:Dt}){const qt="Expecting: ",Rn=`
but found: '`+Nt(At).image+"'";if(wt)return qt+wt+Rn;{const Xn=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${en(bt,rr=>`[${en(rr,xr=>M1(xr)).join(",")}]`).join(" ,")}>`;return qt+Xn+Rn}}};Object.freeze(lA);const i2={buildRuleNotFoundError(bt,At){return"Invalid grammar, reference to a rule which is not defined: ->"+At.nonTerminalName+`<-
inside top level rule: ->`+bt.name+"<-"}},A0={buildDuplicateFoundError(bt,At){function wt(xr){return xr instanceof No?xr.terminalType.name:xr instanceof Su?xr.nonTerminalName:""}const Dt=bt.name,qt=Nt(At),gn=qt.idx,Rn=_p(qt),Ln=wt(qt),Xn=gn>0;let rr=`->${Rn}${Xn?gn:""}<- ${Ln?`with argument: ->${Ln}<-`:""}
                  appears more than once (${At.length} times) in the top level rule: ->${Dt}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return rr=rr.replace(/[ \t]+/g," "),rr=rr.replace(/\s\s+/g,`
`),rr},buildNamespaceConflictError(bt){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${bt.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(bt){const At=en(bt.prefixPath,qt=>M1(qt)).join(", "),wt=bt.alternation.idx===0?"":bt.alternation.idx;return`Ambiguous alternatives: <${bt.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${wt}> inside <${bt.topLevelRule.name}> Rule,
<${At}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(bt){const At=en(bt.prefixPath,qt=>M1(qt)).join(", "),wt=bt.alternation.idx===0?"":bt.alternation.idx;let Dt=`Ambiguous Alternatives Detected: <${bt.ambiguityIndices.join(" ,")}> in <OR${wt}> inside <${bt.topLevelRule.name}> Rule,
<${At}> may appears as a prefix path in all these alternatives.
`;return Dt=Dt+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,Dt},buildEmptyRepetitionError(bt){let At=_p(bt.repetition);return bt.repetition.idx!==0&&(At+=bt.repetition.idx),`The repetition <${At}> within Rule <${bt.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(bt){return"deprecated"},buildEmptyAlternationError(bt){return`Ambiguous empty alternative: <${bt.emptyChoiceIdx+1}> in <OR${bt.alternation.idx}> inside <${bt.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(bt){return`An Alternation cannot have more than 256 alternatives:
<OR${bt.alternation.idx}> inside <${bt.topLevelRule.name}> Rule.
 has ${bt.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(bt){const At=bt.topLevelRule.name,wt=en(bt.leftRecursionPath,gn=>gn.name),Dt=`${At} --> ${wt.concat([At]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${At}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${Dt}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(bt){return"deprecated"},buildDuplicateRuleNameError(bt){let At;return bt.topLevelRule instanceof o1?At=bt.topLevelRule.name:At=bt.topLevelRule,`Duplicate definition, rule: ->${At}<- is already defined in the grammar: ->${bt.grammarName}<-`}};function s2(bt,At){const wt=new o2(bt,At);return wt.resolveRefs(),wt.errors}class o2 extends a1{constructor(At,wt){super(),this.nameToTopRule=At,this.errMsgProvider=wt,this.errors=[]}resolveRefs(){ss(er(this.nameToTopRule),At=>{this.currTopLevel=At,At.accept(this)})}visitNonTerminal(At){const wt=this.nameToTopRule[At.nonTerminalName];if(wt)At.referencedRule=wt;else{const Dt=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,At);this.errors.push({message:Dt,type:iu.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:At.nonTerminalName})}}}class a2 extends D1{constructor(At,wt){super(),this.topProd=At,this.path=wt,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Co(this.path.ruleStack).reverse(),this.occurrenceStack=Co(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(At,wt=[]){this.found||super.walk(At,wt)}walkProdRef(At,wt,Dt){if(At.referencedRule.name===this.nextProductionName&&At.idx===this.nextProductionOccurrence){const qt=wt.concat(Dt);this.updateExpectedNext(),this.walk(At.referencedRule,qt)}}updateExpectedNext(){qs(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class l2 extends a2{constructor(At,wt){super(At,wt),this.path=wt,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(At,wt,Dt){if(this.isAtEndOfPath&&At.terminalType.name===this.nextTerminalName&&At.idx===this.nextTerminalOccurrence&&!this.found){const qt=wt.concat(Dt),gn=new pu({definition:qt});this.possibleTokTypes=_1(gn),this.found=!0}}}class X1 extends D1{constructor(At,wt){super(),this.topRule=At,this.occurrence=wt,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class c2 extends X1{walkMany(At,wt,Dt){if(At.idx===this.occurrence){const qt=Nt(wt.concat(Dt));this.result.isEndOfRule=qt===void 0,qt instanceof No&&(this.result.token=qt.terminalType,this.result.occurrence=qt.idx)}else super.walkMany(At,wt,Dt)}}class cA extends X1{walkManySep(At,wt,Dt){if(At.idx===this.occurrence){const qt=Nt(wt.concat(Dt));this.result.isEndOfRule=qt===void 0,qt instanceof No&&(this.result.token=qt.terminalType,this.result.occurrence=qt.idx)}else super.walkManySep(At,wt,Dt)}}class u2 extends X1{walkAtLeastOne(At,wt,Dt){if(At.idx===this.occurrence){const qt=Nt(wt.concat(Dt));this.result.isEndOfRule=qt===void 0,qt instanceof No&&(this.result.token=qt.terminalType,this.result.occurrence=qt.idx)}else super.walkAtLeastOne(At,wt,Dt)}}class uA extends X1{walkAtLeastOneSep(At,wt,Dt){if(At.idx===this.occurrence){const qt=Nt(wt.concat(Dt));this.result.isEndOfRule=qt===void 0,qt instanceof No&&(this.result.token=qt.terminalType,this.result.occurrence=qt.idx)}else super.walkAtLeastOneSep(At,wt,Dt)}}function A3(bt,At,wt=[]){wt=Co(wt);let Dt=[],qt=0;function gn(Ln){return Ln.concat(Qs(bt,qt+1))}function Rn(Ln){const Xn=A3(gn(Ln),At,wt);return Dt.concat(Xn)}for(;wt.length<At&&qt<bt.length;){const Ln=bt[qt];if(Ln instanceof pu)return Rn(Ln.definition);if(Ln instanceof Su)return Rn(Ln.definition);if(Ln instanceof mu)Dt=Rn(Ln.definition);else if(Ln instanceof vp){const Xn=Ln.definition.concat([new yl({definition:Ln.definition})]);return Rn(Xn)}else if(Ln instanceof yp){const Xn=[new pu({definition:Ln.definition}),new yl({definition:[new No({terminalType:Ln.separator})].concat(Ln.definition)})];return Rn(Xn)}else if(Ln instanceof Ju){const Xn=Ln.definition.concat([new yl({definition:[new No({terminalType:Ln.separator})].concat(Ln.definition)})]);Dt=Rn(Xn)}else if(Ln instanceof yl){const Xn=Ln.definition.concat([new yl({definition:Ln.definition})]);Dt=Rn(Xn)}else{if(Ln instanceof Zu)return ss(Ln.definition,Xn=>{qs(Xn.definition)===!1&&(Dt=Rn(Xn.definition))}),Dt;if(Ln instanceof No)wt.push(Ln.terminalType);else throw Error("non exhaustive match")}qt++}return Dt.push({partialPath:wt,suffixDef:Qs(bt,qt)}),Dt}function hA(bt,At,wt,Dt){const qt="EXIT_NONE_TERMINAL",gn=[qt],Rn="EXIT_ALTERNATIVE";let Ln=!1;const Xn=At.length,rr=Xn-Dt-1,xr=[],br=[];for(br.push({idx:-1,def:bt,ruleStack:[],occurrenceStack:[]});!qs(br);){const Gr=br.pop();if(Gr===Rn){Ln&&no(br).idx<=rr&&br.pop();continue}const ls=Gr.def,ys=Gr.idx,xs=Gr.ruleStack,Bs=Gr.occurrenceStack;if(qs(ls))continue;const rs=ls[0];if(rs===qt){const as={idx:ys,def:Qs(ls),ruleStack:_o(xs),occurrenceStack:_o(Bs)};br.push(as)}else if(rs instanceof No)if(ys<Xn-1){const as=ys+1,qr=At[as];if(wt(qr,rs.terminalType)){const gs={idx:as,def:Qs(ls),ruleStack:xs,occurrenceStack:Bs};br.push(gs)}}else if(ys===Xn-1)xr.push({nextTokenType:rs.terminalType,nextTokenOccurrence:rs.idx,ruleStack:xs,occurrenceStack:Bs}),Ln=!0;else throw Error("non exhaustive match");else if(rs instanceof Su){const as=Co(xs);as.push(rs.nonTerminalName);const qr=Co(Bs);qr.push(rs.idx);const gs={idx:ys,def:rs.definition.concat(gn,Qs(ls)),ruleStack:as,occurrenceStack:qr};br.push(gs)}else if(rs instanceof mu){const as={idx:ys,def:Qs(ls),ruleStack:xs,occurrenceStack:Bs};br.push(as),br.push(Rn);const qr={idx:ys,def:rs.definition.concat(Qs(ls)),ruleStack:xs,occurrenceStack:Bs};br.push(qr)}else if(rs instanceof vp){const as=new yl({definition:rs.definition,idx:rs.idx}),qr=rs.definition.concat([as],Qs(ls)),gs={idx:ys,def:qr,ruleStack:xs,occurrenceStack:Bs};br.push(gs)}else if(rs instanceof yp){const as=new No({terminalType:rs.separator}),qr=new yl({definition:[as].concat(rs.definition),idx:rs.idx}),gs=rs.definition.concat([qr],Qs(ls)),Eo={idx:ys,def:gs,ruleStack:xs,occurrenceStack:Bs};br.push(Eo)}else if(rs instanceof Ju){const as={idx:ys,def:Qs(ls),ruleStack:xs,occurrenceStack:Bs};br.push(as),br.push(Rn);const qr=new No({terminalType:rs.separator}),gs=new yl({definition:[qr].concat(rs.definition),idx:rs.idx}),Eo=rs.definition.concat([gs],Qs(ls)),_h={idx:ys,def:Eo,ruleStack:xs,occurrenceStack:Bs};br.push(_h)}else if(rs instanceof yl){const as={idx:ys,def:Qs(ls),ruleStack:xs,occurrenceStack:Bs};br.push(as),br.push(Rn);const qr=new yl({definition:rs.definition,idx:rs.idx}),gs=rs.definition.concat([qr],Qs(ls)),Eo={idx:ys,def:gs,ruleStack:xs,occurrenceStack:Bs};br.push(Eo)}else if(rs instanceof Zu)for(let as=rs.definition.length-1;as>=0;as--){const qr=rs.definition[as],gs={idx:ys,def:qr.definition.concat(Qs(ls)),ruleStack:xs,occurrenceStack:Bs};br.push(gs),br.push(Rn)}else if(rs instanceof pu)br.push({idx:ys,def:rs.definition.concat(Qs(ls)),ruleStack:xs,occurrenceStack:Bs});else if(rs instanceof o1)br.push(h2(rs,ys,xs,Bs));else throw Error("non exhaustive match")}return xr}function h2(bt,At,wt,Dt){const qt=Co(wt);qt.push(bt.name);const gn=Co(Dt);return gn.push(1),{idx:At,def:bt.definition,ruleStack:qt,occurrenceStack:gn}}var Qo;(function(bt){bt[bt.OPTION=0]="OPTION",bt[bt.REPETITION=1]="REPETITION",bt[bt.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",bt[bt.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",bt[bt.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",bt[bt.ALTERNATION=5]="ALTERNATION"})(Qo||(Qo={}));function fA(bt){if(bt instanceof mu||bt==="Option")return Qo.OPTION;if(bt instanceof yl||bt==="Repetition")return Qo.REPETITION;if(bt instanceof vp||bt==="RepetitionMandatory")return Qo.REPETITION_MANDATORY;if(bt instanceof yp||bt==="RepetitionMandatoryWithSeparator")return Qo.REPETITION_MANDATORY_WITH_SEPARATOR;if(bt instanceof Ju||bt==="RepetitionWithSeparator")return Qo.REPETITION_WITH_SEPARATOR;if(bt instanceof Zu||bt==="Alternation")return Qo.ALTERNATION;throw Error("non exhaustive match")}function f2(bt,At,wt,Dt,qt,gn){const Rn=y3(bt,At,wt),Ln=gA(Rn)?$1:b1;return gn(Rn,Dt,Ln,qt)}function d2(bt,At,wt,Dt,qt,gn){const Rn=_3(bt,At,qt,wt),Ln=gA(Rn)?$1:b1;return gn(Rn[0],Ln,Dt)}function p2(bt,At,wt,Dt){const qt=bt.length,gn=Ml(bt,Rn=>Ml(Rn,Ln=>Ln.length===1));if(At)return function(Rn){const Ln=en(Rn,Xn=>Xn.GATE);for(let Xn=0;Xn<qt;Xn++){const rr=bt[Xn],xr=rr.length,br=Ln[Xn];if(br!==void 0&&br.call(this)===!1)continue;e:for(let Gr=0;Gr<xr;Gr++){const ls=rr[Gr],ys=ls.length;for(let xs=0;xs<ys;xs++){const Bs=this.LA(xs+1);if(wt(Bs,ls[xs])===!1)continue e}return Xn}}};if(gn&&!Dt){const Rn=en(bt,Xn=>Nl(Xn)),Ln=Eu(Rn,(Xn,rr,xr)=>(ss(rr,br=>{Br(Xn,br.tokenTypeIdx)||(Xn[br.tokenTypeIdx]=xr),ss(br.categoryMatches,Gr=>{Br(Xn,Gr)||(Xn[Gr]=xr)})}),Xn),{});return function(){const Xn=this.LA(1);return Ln[Xn.tokenTypeIdx]}}else return function(){for(let Rn=0;Rn<qt;Rn++){const Ln=bt[Rn],Xn=Ln.length;e:for(let rr=0;rr<Xn;rr++){const xr=Ln[rr],br=xr.length;for(let Gr=0;Gr<br;Gr++){const ls=this.LA(Gr+1);if(wt(ls,xr[Gr])===!1)continue e}return Rn}}}}function m2(bt,At,wt){const Dt=Ml(bt,gn=>gn.length===1),qt=bt.length;if(Dt&&!wt){const gn=Nl(bt);if(gn.length===1&&qs(gn[0].categoryMatches)){const Ln=gn[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===Ln}}else{const Rn=Eu(gn,(Ln,Xn,rr)=>(Ln[Xn.tokenTypeIdx]=!0,ss(Xn.categoryMatches,xr=>{Ln[xr]=!0}),Ln),[]);return function(){const Ln=this.LA(1);return Rn[Ln.tokenTypeIdx]===!0}}}else return function(){e:for(let gn=0;gn<qt;gn++){const Rn=bt[gn],Ln=Rn.length;for(let Xn=0;Xn<Ln;Xn++){const rr=this.LA(Xn+1);if(At(rr,Rn[Xn])===!1)continue e}return!0}return!1}}class g2 extends D1{constructor(At,wt,Dt){super(),this.topProd=At,this.targetOccurrence=wt,this.targetProdType=Dt}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(At,wt,Dt,qt){return At.idx===this.targetOccurrence&&this.targetProdType===wt?(this.restDef=Dt.concat(qt),!0):!1}walkOption(At,wt,Dt){this.checkIsTarget(At,Qo.OPTION,wt,Dt)||super.walkOption(At,wt,Dt)}walkAtLeastOne(At,wt,Dt){this.checkIsTarget(At,Qo.REPETITION_MANDATORY,wt,Dt)||super.walkOption(At,wt,Dt)}walkAtLeastOneSep(At,wt,Dt){this.checkIsTarget(At,Qo.REPETITION_MANDATORY_WITH_SEPARATOR,wt,Dt)||super.walkOption(At,wt,Dt)}walkMany(At,wt,Dt){this.checkIsTarget(At,Qo.REPETITION,wt,Dt)||super.walkOption(At,wt,Dt)}walkManySep(At,wt,Dt){this.checkIsTarget(At,Qo.REPETITION_WITH_SEPARATOR,wt,Dt)||super.walkOption(At,wt,Dt)}}class dA extends a1{constructor(At,wt,Dt){super(),this.targetOccurrence=At,this.targetProdType=wt,this.targetRef=Dt,this.result=[]}checkIsTarget(At,wt){At.idx===this.targetOccurrence&&this.targetProdType===wt&&(this.targetRef===void 0||At===this.targetRef)&&(this.result=At.definition)}visitOption(At){this.checkIsTarget(At,Qo.OPTION)}visitRepetition(At){this.checkIsTarget(At,Qo.REPETITION)}visitRepetitionMandatory(At){this.checkIsTarget(At,Qo.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(At){this.checkIsTarget(At,Qo.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(At){this.checkIsTarget(At,Qo.REPETITION_WITH_SEPARATOR)}visitAlternation(At){this.checkIsTarget(At,Qo.ALTERNATION)}}function pA(bt){const At=new Array(bt);for(let wt=0;wt<bt;wt++)At[wt]=[];return At}function v3(bt){let At=[""];for(let wt=0;wt<bt.length;wt++){const Dt=bt[wt],qt=[];for(let gn=0;gn<At.length;gn++){const Rn=At[gn];qt.push(Rn+"_"+Dt.tokenTypeIdx);for(let Ln=0;Ln<Dt.categoryMatches.length;Ln++){const Xn="_"+Dt.categoryMatches[Ln];qt.push(Rn+Xn)}}At=qt}return At}function A2(bt,At,wt){for(let Dt=0;Dt<bt.length;Dt++){if(Dt===wt)continue;const qt=bt[Dt];for(let gn=0;gn<At.length;gn++){const Rn=At[gn];if(qt[Rn]===!0)return!1}}return!0}function mA(bt,At){const wt=en(bt,Rn=>A3([Rn],1)),Dt=pA(wt.length),qt=en(wt,Rn=>{const Ln={};return ss(Rn,Xn=>{const rr=v3(Xn.partialPath);ss(rr,xr=>{Ln[xr]=!0})}),Ln});let gn=wt;for(let Rn=1;Rn<=At;Rn++){const Ln=gn;gn=pA(Ln.length);for(let Xn=0;Xn<Ln.length;Xn++){const rr=Ln[Xn];for(let xr=0;xr<rr.length;xr++){const br=rr[xr].partialPath,Gr=rr[xr].suffixDef,ls=v3(br);if(A2(qt,ls,Xn)||qs(Gr)||br.length===At){const xs=Dt[Xn];if(x3(xs,br)===!1){xs.push(br);for(let Bs=0;Bs<ls.length;Bs++){const rs=ls[Bs];qt[Xn][rs]=!0}}}else{const xs=A3(Gr,Rn+1,br);gn[Xn]=gn[Xn].concat(xs),ss(xs,Bs=>{const rs=v3(Bs.partialPath);ss(rs,as=>{qt[Xn][as]=!0})})}}}}return Dt}function y3(bt,At,wt,Dt){const qt=new dA(bt,Qo.ALTERNATION,Dt);return At.accept(qt),mA(qt.result,wt)}function _3(bt,At,wt,Dt){const qt=new dA(bt,wt);At.accept(qt);const gn=qt.result,Ln=new g2(At,bt,wt).startWalking(),Xn=new pu({definition:gn}),rr=new pu({definition:Ln});return mA([Xn,rr],Dt)}function x3(bt,At){e:for(let wt=0;wt<bt.length;wt++){const Dt=bt[wt];if(Dt.length===At.length){for(let qt=0;qt<Dt.length;qt++){const gn=At[qt],Rn=Dt[qt];if((gn===Rn||Rn.categoryMatchesMap[gn.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function v2(bt,At){return bt.length<At.length&&Ml(bt,(wt,Dt)=>{const qt=At[Dt];return wt===qt||qt.categoryMatchesMap[wt.tokenTypeIdx]})}function gA(bt){return Ml(bt,At=>Ml(At,wt=>Ml(wt,Dt=>qs(Dt.categoryMatches))))}function y2(bt){const At=bt.lookaheadStrategy.validate({rules:bt.rules,tokenTypes:bt.tokenTypes,grammarName:bt.grammarName});return en(At,wt=>Object.assign({type:iu.CUSTOM_LOOKAHEAD_VALIDATION},wt))}function _2(bt,At,wt,Dt){const qt=zn(bt,Xn=>x2(Xn,wt)),gn=L2(bt,At,wt),Rn=zn(bt,Xn=>B2(Xn,wt)),Ln=zn(bt,Xn=>C2(Xn,bt,Dt,wt));return qt.concat(gn,Rn,Ln)}function x2(bt,At){const wt=new S2;bt.accept(wt);const Dt=wt.allProductions,qt=os(Dt,E2),gn=qu(qt,Ln=>Ln.length>1);return en(er(gn),Ln=>{const Xn=Nt(Ln),rr=At.buildDuplicateFoundError(bt,Ln),xr=_p(Xn),br={message:rr,type:iu.DUPLICATE_PRODUCTIONS,ruleName:bt.name,dslName:xr,occurrence:Xn.idx},Gr=AA(Xn);return Gr&&(br.parameter=Gr),br})}function E2(bt){return`${_p(bt)}_#_${bt.idx}_#_${AA(bt)}`}function AA(bt){return bt instanceof No?bt.terminalType.name:bt instanceof Su?bt.nonTerminalName:""}class S2 extends a1{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(At){this.allProductions.push(At)}visitOption(At){this.allProductions.push(At)}visitRepetitionWithSeparator(At){this.allProductions.push(At)}visitRepetitionMandatory(At){this.allProductions.push(At)}visitRepetitionMandatoryWithSeparator(At){this.allProductions.push(At)}visitRepetition(At){this.allProductions.push(At)}visitAlternation(At){this.allProductions.push(At)}visitTerminal(At){this.allProductions.push(At)}}function C2(bt,At,wt,Dt){const qt=[];if(Eu(At,(Rn,Ln)=>Ln.name===bt.name?Rn+1:Rn,0)>1){const Rn=Dt.buildDuplicateRuleNameError({topLevelRule:bt,grammarName:wt});qt.push({message:Rn,type:iu.DUPLICATE_RULE_NAME,ruleName:bt.name})}return qt}function T2(bt,At,wt){const Dt=[];let qt;return Or(At,bt)||(qt=`Invalid rule override, rule: ->${bt}<- cannot be overridden in the grammar: ->${wt}<-as it is not defined in any of the super grammars `,Dt.push({message:qt,type:iu.INVALID_RULE_OVERRIDE,ruleName:bt})),Dt}function vA(bt,At,wt,Dt=[]){const qt=[],gn=K1(At.definition);if(qs(gn))return[];{const Rn=bt.name;Or(gn,bt)&&qt.push({message:wt.buildLeftRecursionError({topLevelRule:bt,leftRecursionPath:Dt}),type:iu.LEFT_RECURSION,ruleName:Rn});const Xn=go(gn,Dt.concat([bt])),rr=zn(Xn,xr=>{const br=Co(Dt);return br.push(xr),vA(bt,xr,wt,br)});return qt.concat(rr)}}function K1(bt){let At=[];if(qs(bt))return At;const wt=Nt(bt);if(wt instanceof Su)At.push(wt.referencedRule);else if(wt instanceof pu||wt instanceof mu||wt instanceof vp||wt instanceof yp||wt instanceof Ju||wt instanceof yl)At=At.concat(K1(wt.definition));else if(wt instanceof Zu)At=Nl(en(wt.definition,gn=>K1(gn.definition)));else if(!(wt instanceof No))throw Error("non exhaustive match");const Dt=N1(wt),qt=bt.length>1;if(Dt&&qt){const gn=Qs(bt);return At.concat(K1(gn))}else return At}class E3 extends a1{constructor(){super(...arguments),this.alternations=[]}visitAlternation(At){this.alternations.push(At)}}function M2(bt,At){const wt=new E3;bt.accept(wt);const Dt=wt.alternations;return zn(Dt,gn=>{const Rn=_o(gn.definition);return zn(Rn,(Ln,Xn)=>{const rr=hA([Ln],[],b1,1);return qs(rr)?[{message:At.buildEmptyAlternationError({topLevelRule:bt,alternation:gn,emptyChoiceIdx:Xn}),type:iu.NONE_LAST_EMPTY_ALT,ruleName:bt.name,occurrence:gn.idx,alternative:Xn+1}]:[]})})}function w2(bt,At,wt){const Dt=new E3;bt.accept(Dt);let qt=Dt.alternations;return qt=L1(qt,Rn=>Rn.ignoreAmbiguities===!0),zn(qt,Rn=>{const Ln=Rn.idx,Xn=Rn.maxLookahead||At,rr=y3(Ln,bt,Xn,Rn),xr=F2(rr,Rn,bt,wt),br=P2(rr,Rn,bt,wt);return xr.concat(br)})}class I2 extends a1{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(At){this.allProductions.push(At)}visitRepetitionMandatory(At){this.allProductions.push(At)}visitRepetitionMandatoryWithSeparator(At){this.allProductions.push(At)}visitRepetition(At){this.allProductions.push(At)}}function B2(bt,At){const wt=new E3;bt.accept(wt);const Dt=wt.alternations;return zn(Dt,gn=>gn.definition.length>255?[{message:At.buildTooManyAlternativesError({topLevelRule:bt,alternation:gn}),type:iu.TOO_MANY_ALTS,ruleName:bt.name,occurrence:gn.idx}]:[])}function R2(bt,At,wt){const Dt=[];return ss(bt,qt=>{const gn=new I2;qt.accept(gn);const Rn=gn.allProductions;ss(Rn,Ln=>{const Xn=fA(Ln),rr=Ln.maxLookahead||At,xr=Ln.idx,Gr=_3(xr,qt,Xn,rr)[0];if(qs(Nl(Gr))){const ls=wt.buildEmptyRepetitionError({topLevelRule:qt,repetition:Ln});Dt.push({message:ls,type:iu.NO_NON_EMPTY_LOOKAHEAD,ruleName:qt.name})}})}),Dt}function F2(bt,At,wt,Dt){const qt=[],gn=Eu(bt,(Ln,Xn,rr)=>(At.definition[rr].ignoreAmbiguities===!0||ss(Xn,xr=>{const br=[rr];ss(bt,(Gr,ls)=>{rr!==ls&&x3(Gr,xr)&&At.definition[ls].ignoreAmbiguities!==!0&&br.push(ls)}),br.length>1&&!x3(qt,xr)&&(qt.push(xr),Ln.push({alts:br,path:xr}))}),Ln),[]);return en(gn,Ln=>{const Xn=en(Ln.alts,xr=>xr+1);return{message:Dt.buildAlternationAmbiguityError({topLevelRule:wt,alternation:At,ambiguityIndices:Xn,prefixPath:Ln.path}),type:iu.AMBIGUOUS_ALTS,ruleName:wt.name,occurrence:At.idx,alternatives:Ln.alts}})}function P2(bt,At,wt,Dt){const qt=Eu(bt,(Rn,Ln,Xn)=>{const rr=en(Ln,xr=>({idx:Xn,path:xr}));return Rn.concat(rr)},[]);return Ru(zn(qt,Rn=>{if(At.definition[Rn.idx].ignoreAmbiguities===!0)return[];const Xn=Rn.idx,rr=Rn.path,xr=Il(qt,Gr=>At.definition[Gr.idx].ignoreAmbiguities!==!0&&Gr.idx<Xn&&v2(Gr.path,rr));return en(xr,Gr=>{const ls=[Gr.idx+1,Xn+1],ys=At.idx===0?"":At.idx;return{message:Dt.buildAlternationPrefixAmbiguityError({topLevelRule:wt,alternation:At,ambiguityIndices:ls,prefixPath:Gr.path}),type:iu.AMBIGUOUS_PREFIX_ALTS,ruleName:wt.name,occurrence:ys,alternatives:ls}})}))}function L2(bt,At,wt){const Dt=[],qt=en(At,gn=>gn.name);return ss(bt,gn=>{const Rn=gn.name;if(Or(qt,Rn)){const Ln=wt.buildNamespaceConflictError(gn);Dt.push({message:Ln,type:iu.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:Rn})}}),Dt}function k2(bt){const At=bo(bt,{errMsgProvider:i2}),wt={};return ss(bt.rules,Dt=>{wt[Dt.name]=Dt}),s2(wt,At.errMsgProvider)}function N2(bt){return bt=bo(bt,{errMsgProvider:A0}),_2(bt.rules,bt.tokenTypes,bt.errMsgProvider,bt.grammarName)}const yA="MismatchedTokenException",_A="NoViableAltException",xA="EarlyExitException",EA="NotAllInputParsedException",SA=[yA,_A,xA,EA];Object.freeze(SA);function Y1(bt){return Or(SA,bt.name)}class q1 extends Error{constructor(At,wt){super(At),this.token=wt,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class bA extends q1{constructor(At,wt,Dt){super(At,wt),this.previousToken=Dt,this.name=yA}}class D2 extends q1{constructor(At,wt,Dt){super(At,wt),this.previousToken=Dt,this.name=_A}}class O2 extends q1{constructor(At,wt){super(At,wt),this.name=EA}}class U2 extends q1{constructor(At,wt,Dt){super(At,wt),this.previousToken=Dt,this.name=xA}}const S3={},CA="InRuleRecoveryException";class G2 extends Error{constructor(At){super(At),this.name=CA}}class V2{initRecoverable(At){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Br(At,"recoveryEnabled")?At.recoveryEnabled:Kp.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=z2)}getTokenToInsert(At){const wt=g3(At,"",NaN,NaN,NaN,NaN,NaN,NaN);return wt.isInsertedInRecovery=!0,wt}canTokenTypeBeInsertedInRecovery(At){return!0}canTokenTypeBeDeletedInRecovery(At){return!0}tryInRepetitionRecovery(At,wt,Dt,qt){const gn=this.findReSyncTokenType(),Rn=this.exportLexerState(),Ln=[];let Xn=!1;const rr=this.LA(1);let xr=this.LA(1);const br=()=>{const Gr=this.LA(0),ls=this.errorMessageProvider.buildMismatchTokenMessage({expected:qt,actual:rr,previous:Gr,ruleName:this.getCurrRuleFullName()}),ys=new bA(ls,rr,this.LA(0));ys.resyncedTokens=_o(Ln),this.SAVE_ERROR(ys)};for(;!Xn;)if(this.tokenMatcher(xr,qt)){br();return}else if(Dt.call(this)){br(),At.apply(this,wt);return}else this.tokenMatcher(xr,gn)?Xn=!0:(xr=this.SKIP_TOKEN(),this.addToResyncTokens(xr,Ln));this.importLexerState(Rn)}shouldInRepetitionRecoveryBeTried(At,wt,Dt){return!(Dt===!1||this.tokenMatcher(this.LA(1),At)||this.isBackTracking()||this.canPerformInRuleRecovery(At,this.getFollowsForInRuleRecovery(At,wt)))}getFollowsForInRuleRecovery(At,wt){const Dt=this.getCurrentGrammarPath(At,wt);return this.getNextPossibleTokenTypes(Dt)}tryInRuleRecovery(At,wt){if(this.canRecoverWithSingleTokenInsertion(At,wt))return this.getTokenToInsert(At);if(this.canRecoverWithSingleTokenDeletion(At)){const Dt=this.SKIP_TOKEN();return this.consumeToken(),Dt}throw new G2("sad sad panda")}canPerformInRuleRecovery(At,wt){return this.canRecoverWithSingleTokenInsertion(At,wt)||this.canRecoverWithSingleTokenDeletion(At)}canRecoverWithSingleTokenInsertion(At,wt){if(!this.canTokenTypeBeInsertedInRecovery(At)||qs(wt))return!1;const Dt=this.LA(1);return Ft(wt,gn=>this.tokenMatcher(Dt,gn))!==void 0}canRecoverWithSingleTokenDeletion(At){return this.canTokenTypeBeDeletedInRecovery(At)?this.tokenMatcher(this.LA(2),At):!1}isInCurrentRuleReSyncSet(At){const wt=this.getCurrFollowKey(),Dt=this.getFollowSetFromFollowKey(wt);return Or(Dt,At)}findReSyncTokenType(){const At=this.flattenFollowSet();let wt=this.LA(1),Dt=2;for(;;){const qt=Ft(At,gn=>r2(wt,gn));if(qt!==void 0)return qt;wt=this.LA(Dt),Dt++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return S3;const At=this.getLastExplicitRuleShortName(),wt=this.getLastExplicitRuleOccurrenceIndex(),Dt=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(At),idxInCallingRule:wt,inRule:this.shortRuleNameToFullName(Dt)}}buildFullFollowKeyStack(){const At=this.RULE_STACK,wt=this.RULE_OCCURRENCE_STACK;return en(At,(Dt,qt)=>qt===0?S3:{ruleName:this.shortRuleNameToFullName(Dt),idxInCallingRule:wt[qt],inRule:this.shortRuleNameToFullName(At[qt-1])})}flattenFollowSet(){const At=en(this.buildFullFollowKeyStack(),wt=>this.getFollowSetFromFollowKey(wt));return Nl(At)}getFollowSetFromFollowKey(At){if(At===S3)return[g0];const wt=At.ruleName+At.idxInCallingRule+D3+At.inRule;return this.resyncFollows[wt]}addToResyncTokens(At,wt){return this.tokenMatcher(At,g0)||wt.push(At),wt}reSyncTo(At){const wt=[];let Dt=this.LA(1);for(;this.tokenMatcher(Dt,At)===!1;)Dt=this.SKIP_TOKEN(),this.addToResyncTokens(Dt,wt);return _o(wt)}attemptInRepetitionRecovery(At,wt,Dt,qt,gn,Rn,Ln){}getCurrentGrammarPath(At,wt){const Dt=this.getHumanReadableRuleStack(),qt=Co(this.RULE_OCCURRENCE_STACK);return{ruleStack:Dt,occurrenceStack:qt,lastTok:At,lastTokOccurrence:wt}}getHumanReadableRuleStack(){return en(this.RULE_STACK,At=>this.shortRuleNameToFullName(At))}}function z2(bt,At,wt,Dt,qt,gn,Rn){const Ln=this.getKeyForAutomaticLookahead(Dt,qt);let Xn=this.firstAfterRepMap[Ln];if(Xn===void 0){const Gr=this.getCurrRuleFullName(),ls=this.getGAstProductions()[Gr];Xn=new gn(ls,qt).startWalking(),this.firstAfterRepMap[Ln]=Xn}let rr=Xn.token,xr=Xn.occurrence;const br=Xn.isEndOfRule;this.RULE_STACK.length===1&&br&&rr===void 0&&(rr=g0,xr=1),!(rr===void 0||xr===void 0)&&this.shouldInRepetitionRecoveryBeTried(rr,xr,Rn)&&this.tryInRepetitionRecovery(bt,At,wt,rr)}const H2=4,km=8,TA=1<<km,MA=2<<km,b3=3<<km,C3=4<<km,T3=5<<km,J1=6<<km;function M3(bt,At,wt){return wt|At|bt}class Q2{constructor(At){var wt;this.maxLookahead=(wt=At==null?void 0:At.maxLookahead)!==null&&wt!==void 0?wt:Kp.maxLookahead}validate(At){const wt=this.validateNoLeftRecursion(At.rules);if(qs(wt)){const Dt=this.validateEmptyOrAlternatives(At.rules),qt=this.validateAmbiguousAlternationAlternatives(At.rules,this.maxLookahead),gn=this.validateSomeNonEmptyLookaheadPath(At.rules,this.maxLookahead);return[...wt,...Dt,...qt,...gn]}return wt}validateNoLeftRecursion(At){return zn(At,wt=>vA(wt,wt,A0))}validateEmptyOrAlternatives(At){return zn(At,wt=>M2(wt,A0))}validateAmbiguousAlternationAlternatives(At,wt){return zn(At,Dt=>w2(Dt,wt,A0))}validateSomeNonEmptyLookaheadPath(At,wt){return R2(At,wt,A0)}buildLookaheadForAlternation(At){return f2(At.prodOccurrence,At.rule,At.maxLookahead,At.hasPredicates,At.dynamicTokensEnabled,p2)}buildLookaheadForOptional(At){return d2(At.prodOccurrence,At.rule,At.maxLookahead,At.dynamicTokensEnabled,fA(At.prodType),m2)}}class W2{initLooksAhead(At){this.dynamicTokensEnabled=Br(At,"dynamicTokensEnabled")?At.dynamicTokensEnabled:Kp.dynamicTokensEnabled,this.maxLookahead=Br(At,"maxLookahead")?At.maxLookahead:Kp.maxLookahead,this.lookaheadStrategy=Br(At,"lookaheadStrategy")?At.lookaheadStrategy:new Q2({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(At){ss(At,wt=>{this.TRACE_INIT(`${wt.name} Rule Lookahead`,()=>{const{alternation:Dt,repetition:qt,option:gn,repetitionMandatory:Rn,repetitionMandatoryWithSeparator:Ln,repetitionWithSeparator:Xn}=$2(wt);ss(Dt,rr=>{const xr=rr.idx===0?"":rr.idx;this.TRACE_INIT(`${_p(rr)}${xr}`,()=>{const br=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:rr.idx,rule:wt,maxLookahead:rr.maxLookahead||this.maxLookahead,hasPredicates:rr.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),Gr=M3(this.fullRuleNameToShort[wt.name],TA,rr.idx);this.setLaFuncCache(Gr,br)})}),ss(qt,rr=>{this.computeLookaheadFunc(wt,rr.idx,b3,"Repetition",rr.maxLookahead,_p(rr))}),ss(gn,rr=>{this.computeLookaheadFunc(wt,rr.idx,MA,"Option",rr.maxLookahead,_p(rr))}),ss(Rn,rr=>{this.computeLookaheadFunc(wt,rr.idx,C3,"RepetitionMandatory",rr.maxLookahead,_p(rr))}),ss(Ln,rr=>{this.computeLookaheadFunc(wt,rr.idx,J1,"RepetitionMandatoryWithSeparator",rr.maxLookahead,_p(rr))}),ss(Xn,rr=>{this.computeLookaheadFunc(wt,rr.idx,T3,"RepetitionWithSeparator",rr.maxLookahead,_p(rr))})})})}computeLookaheadFunc(At,wt,Dt,qt,gn,Rn){this.TRACE_INIT(`${Rn}${wt===0?"":wt}`,()=>{const Ln=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:wt,rule:At,maxLookahead:gn||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:qt}),Xn=M3(this.fullRuleNameToShort[At.name],Dt,wt);this.setLaFuncCache(Xn,Ln)})}getKeyForAutomaticLookahead(At,wt){const Dt=this.getLastExplicitRuleShortName();return M3(Dt,At,wt)}getLaFuncFromCache(At){return this.lookAheadFuncsCache.get(At)}setLaFuncCache(At,wt){this.lookAheadFuncsCache.set(At,wt)}}class j2 extends a1{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(At){this.dslMethods.option.push(At)}visitRepetitionWithSeparator(At){this.dslMethods.repetitionWithSeparator.push(At)}visitRepetitionMandatory(At){this.dslMethods.repetitionMandatory.push(At)}visitRepetitionMandatoryWithSeparator(At){this.dslMethods.repetitionMandatoryWithSeparator.push(At)}visitRepetition(At){this.dslMethods.repetition.push(At)}visitAlternation(At){this.dslMethods.alternation.push(At)}}const Z1=new j2;function $2(bt){Z1.reset(),bt.accept(Z1);const At=Z1.dslMethods;return Z1.reset(),At}function wA(bt,At){isNaN(bt.startOffset)===!0?(bt.startOffset=At.startOffset,bt.endOffset=At.endOffset):bt.endOffset<At.endOffset&&(bt.endOffset=At.endOffset)}function IA(bt,At){isNaN(bt.startOffset)===!0?(bt.startOffset=At.startOffset,bt.startColumn=At.startColumn,bt.startLine=At.startLine,bt.endOffset=At.endOffset,bt.endColumn=At.endColumn,bt.endLine=At.endLine):bt.endOffset<At.endOffset&&(bt.endOffset=At.endOffset,bt.endColumn=At.endColumn,bt.endLine=At.endLine)}function X2(bt,At,wt){bt.children[wt]===void 0?bt.children[wt]=[At]:bt.children[wt].push(At)}function K2(bt,At,wt){bt.children[At]===void 0?bt.children[At]=[wt]:bt.children[At].push(wt)}const Y2="name";function BA(bt,At){Object.defineProperty(bt,Y2,{enumerable:!1,configurable:!0,writable:!1,value:At})}function q2(bt,At){const wt=Xo(bt),Dt=wt.length;for(let qt=0;qt<Dt;qt++){const gn=wt[qt],Rn=bt[gn],Ln=Rn.length;for(let Xn=0;Xn<Ln;Xn++){const rr=Rn[Xn];rr.tokenTypeIdx===void 0&&this[rr.name](rr.children,At)}}}function J2(bt,At){const wt=function(){};BA(wt,bt+"BaseSemantics");const Dt={visit:function(qt,gn){if(Mt(qt)&&(qt=qt[0]),!Xp(qt))return this[qt.name](qt.children,gn)},validateVisitor:function(){const qt=ey(this,At);if(!qs(qt)){const gn=en(qt,Rn=>Rn.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${gn.join(`

`).replace(/\n/g,`
	`)}`)}}};return wt.prototype=Dt,wt.prototype.constructor=wt,wt._RULE_NAMES=At,wt}function Z2(bt,At,wt){const Dt=function(){};BA(Dt,bt+"BaseSemanticsWithDefaults");const qt=Object.create(wt.prototype);return ss(At,gn=>{qt[gn]=q2}),Dt.prototype=qt,Dt.prototype.constructor=Dt,Dt}var w3;(function(bt){bt[bt.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",bt[bt.MISSING_METHOD=1]="MISSING_METHOD"})(w3||(w3={}));function ey(bt,At){return ty(bt,At)}function ty(bt,At){const wt=Il(At,qt=>Cn(bt[qt])===!1),Dt=en(wt,qt=>({msg:`Missing visitor method: <${qt}> on ${bt.constructor.name} CST Visitor.`,type:w3.MISSING_METHOD,methodName:qt}));return Ru(Dt)}class ny{initTreeBuilder(At){if(this.CST_STACK=[],this.outputCst=At.outputCst,this.nodeLocationTracking=Br(At,"nodeLocationTracking")?At.nodeLocationTracking:Kp.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Jn,this.cstFinallyStateUpdate=Jn,this.cstPostTerminal=Jn,this.cstPostNonTerminal=Jn,this.cstPostRule=Jn;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=IA,this.setNodeLocationFromNode=IA,this.cstPostRule=Jn,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Jn,this.setNodeLocationFromNode=Jn,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=wA,this.setNodeLocationFromNode=wA,this.cstPostRule=Jn,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Jn,this.setNodeLocationFromNode=Jn,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Jn,this.setNodeLocationFromNode=Jn,this.cstPostRule=Jn,this.setInitialNodeLocation=Jn;else throw Error(`Invalid <nodeLocationTracking> config option: "${At.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(At){At.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(At){At.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(At){At.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(At){const wt=this.LA(1);At.location={startOffset:wt.startOffset,startLine:wt.startLine,startColumn:wt.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(At){const wt={name:At,children:Object.create(null)};this.setInitialNodeLocation(wt),this.CST_STACK.push(wt)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(At){const wt=this.LA(0),Dt=At.location;Dt.startOffset<=wt.startOffset?(Dt.endOffset=wt.endOffset,Dt.endLine=wt.endLine,Dt.endColumn=wt.endColumn):(Dt.startOffset=NaN,Dt.startLine=NaN,Dt.startColumn=NaN)}cstPostRuleOnlyOffset(At){const wt=this.LA(0),Dt=At.location;Dt.startOffset<=wt.startOffset?Dt.endOffset=wt.endOffset:Dt.startOffset=NaN}cstPostTerminal(At,wt){const Dt=this.CST_STACK[this.CST_STACK.length-1];X2(Dt,wt,At),this.setNodeLocationFromToken(Dt.location,wt)}cstPostNonTerminal(At,wt){const Dt=this.CST_STACK[this.CST_STACK.length-1];K2(Dt,wt,At),this.setNodeLocationFromNode(Dt.location,At.location)}getBaseCstVisitorConstructor(){if(Xp(this.baseCstVisitorConstructor)){const At=J2(this.className,Xo(this.gastProductionsCache));return this.baseCstVisitorConstructor=At,At}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Xp(this.baseCstVisitorWithDefaultsConstructor)){const At=Z2(this.className,Xo(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=At,At}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const At=this.RULE_STACK;return At[At.length-1]}getPreviousExplicitRuleShortName(){const At=this.RULE_STACK;return At[At.length-2]}getLastExplicitRuleOccurrenceIndex(){const At=this.RULE_OCCURRENCE_STACK;return At[At.length-1]}}class ry{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(At){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=At,this.tokVectorLength=At.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n3}LA(At){const wt=this.currIdx+At;return wt<0||this.tokVectorLength<=wt?n3:this.tokVector[wt]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(At){this.currIdx=At}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class iy{ACTION(At){return At.call(this)}consume(At,wt,Dt){return this.consumeInternal(wt,At,Dt)}subrule(At,wt,Dt){return this.subruleInternal(wt,At,Dt)}option(At,wt){return this.optionInternal(wt,At)}or(At,wt){return this.orInternal(wt,At)}many(At,wt){return this.manyInternal(At,wt)}atLeastOne(At,wt){return this.atLeastOneInternal(At,wt)}CONSUME(At,wt){return this.consumeInternal(At,0,wt)}CONSUME1(At,wt){return this.consumeInternal(At,1,wt)}CONSUME2(At,wt){return this.consumeInternal(At,2,wt)}CONSUME3(At,wt){return this.consumeInternal(At,3,wt)}CONSUME4(At,wt){return this.consumeInternal(At,4,wt)}CONSUME5(At,wt){return this.consumeInternal(At,5,wt)}CONSUME6(At,wt){return this.consumeInternal(At,6,wt)}CONSUME7(At,wt){return this.consumeInternal(At,7,wt)}CONSUME8(At,wt){return this.consumeInternal(At,8,wt)}CONSUME9(At,wt){return this.consumeInternal(At,9,wt)}SUBRULE(At,wt){return this.subruleInternal(At,0,wt)}SUBRULE1(At,wt){return this.subruleInternal(At,1,wt)}SUBRULE2(At,wt){return this.subruleInternal(At,2,wt)}SUBRULE3(At,wt){return this.subruleInternal(At,3,wt)}SUBRULE4(At,wt){return this.subruleInternal(At,4,wt)}SUBRULE5(At,wt){return this.subruleInternal(At,5,wt)}SUBRULE6(At,wt){return this.subruleInternal(At,6,wt)}SUBRULE7(At,wt){return this.subruleInternal(At,7,wt)}SUBRULE8(At,wt){return this.subruleInternal(At,8,wt)}SUBRULE9(At,wt){return this.subruleInternal(At,9,wt)}OPTION(At){return this.optionInternal(At,0)}OPTION1(At){return this.optionInternal(At,1)}OPTION2(At){return this.optionInternal(At,2)}OPTION3(At){return this.optionInternal(At,3)}OPTION4(At){return this.optionInternal(At,4)}OPTION5(At){return this.optionInternal(At,5)}OPTION6(At){return this.optionInternal(At,6)}OPTION7(At){return this.optionInternal(At,7)}OPTION8(At){return this.optionInternal(At,8)}OPTION9(At){return this.optionInternal(At,9)}OR(At){return this.orInternal(At,0)}OR1(At){return this.orInternal(At,1)}OR2(At){return this.orInternal(At,2)}OR3(At){return this.orInternal(At,3)}OR4(At){return this.orInternal(At,4)}OR5(At){return this.orInternal(At,5)}OR6(At){return this.orInternal(At,6)}OR7(At){return this.orInternal(At,7)}OR8(At){return this.orInternal(At,8)}OR9(At){return this.orInternal(At,9)}MANY(At){this.manyInternal(0,At)}MANY1(At){this.manyInternal(1,At)}MANY2(At){this.manyInternal(2,At)}MANY3(At){this.manyInternal(3,At)}MANY4(At){this.manyInternal(4,At)}MANY5(At){this.manyInternal(5,At)}MANY6(At){this.manyInternal(6,At)}MANY7(At){this.manyInternal(7,At)}MANY8(At){this.manyInternal(8,At)}MANY9(At){this.manyInternal(9,At)}MANY_SEP(At){this.manySepFirstInternal(0,At)}MANY_SEP1(At){this.manySepFirstInternal(1,At)}MANY_SEP2(At){this.manySepFirstInternal(2,At)}MANY_SEP3(At){this.manySepFirstInternal(3,At)}MANY_SEP4(At){this.manySepFirstInternal(4,At)}MANY_SEP5(At){this.manySepFirstInternal(5,At)}MANY_SEP6(At){this.manySepFirstInternal(6,At)}MANY_SEP7(At){this.manySepFirstInternal(7,At)}MANY_SEP8(At){this.manySepFirstInternal(8,At)}MANY_SEP9(At){this.manySepFirstInternal(9,At)}AT_LEAST_ONE(At){this.atLeastOneInternal(0,At)}AT_LEAST_ONE1(At){return this.atLeastOneInternal(1,At)}AT_LEAST_ONE2(At){this.atLeastOneInternal(2,At)}AT_LEAST_ONE3(At){this.atLeastOneInternal(3,At)}AT_LEAST_ONE4(At){this.atLeastOneInternal(4,At)}AT_LEAST_ONE5(At){this.atLeastOneInternal(5,At)}AT_LEAST_ONE6(At){this.atLeastOneInternal(6,At)}AT_LEAST_ONE7(At){this.atLeastOneInternal(7,At)}AT_LEAST_ONE8(At){this.atLeastOneInternal(8,At)}AT_LEAST_ONE9(At){this.atLeastOneInternal(9,At)}AT_LEAST_ONE_SEP(At){this.atLeastOneSepFirstInternal(0,At)}AT_LEAST_ONE_SEP1(At){this.atLeastOneSepFirstInternal(1,At)}AT_LEAST_ONE_SEP2(At){this.atLeastOneSepFirstInternal(2,At)}AT_LEAST_ONE_SEP3(At){this.atLeastOneSepFirstInternal(3,At)}AT_LEAST_ONE_SEP4(At){this.atLeastOneSepFirstInternal(4,At)}AT_LEAST_ONE_SEP5(At){this.atLeastOneSepFirstInternal(5,At)}AT_LEAST_ONE_SEP6(At){this.atLeastOneSepFirstInternal(6,At)}AT_LEAST_ONE_SEP7(At){this.atLeastOneSepFirstInternal(7,At)}AT_LEAST_ONE_SEP8(At){this.atLeastOneSepFirstInternal(8,At)}AT_LEAST_ONE_SEP9(At){this.atLeastOneSepFirstInternal(9,At)}RULE(At,wt,Dt=r3){if(Or(this.definedRulesNames,At)){const Rn={message:A0.buildDuplicateRuleNameError({topLevelRule:At,grammarName:this.className}),type:iu.DUPLICATE_RULE_NAME,ruleName:At};this.definitionErrors.push(Rn)}this.definedRulesNames.push(At);const qt=this.defineRule(At,wt,Dt);return this[At]=qt,qt}OVERRIDE_RULE(At,wt,Dt=r3){const qt=T2(At,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(qt);const gn=this.defineRule(At,wt,Dt);return this[At]=gn,gn}BACKTRACK(At,wt){return function(){this.isBackTrackingStack.push(1);const Dt=this.saveRecogState();try{return At.apply(this,wt),!0}catch(qt){if(Y1(qt))return!1;throw qt}finally{this.reloadRecogState(Dt),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return sv(er(this.gastProductionsCache))}}class sy{initRecognizerEngine(At,wt){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=$1,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Br(wt,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Mt(At)){if(qs(At))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof At[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Mt(At))this.tokensMap=Eu(At,(gn,Rn)=>(gn[Rn.name]=Rn,gn),{});else if(Br(At,"modes")&&Ml(Nl(er(At.modes)),Zv)){const gn=Nl(er(At.modes)),Rn=a3(gn);this.tokensMap=Eu(Rn,(Ln,Xn)=>(Ln[Xn.name]=Xn,Ln),{})}else if(Vt(At))this.tokensMap=Co(At);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=g0;const Dt=Br(At,"modes")?Nl(er(At.modes)):er(At),qt=Ml(Dt,gn=>qs(gn.categoryMatches));this.tokenMatcher=qt?$1:b1,C1(er(this.tokensMap))}defineRule(At,wt,Dt){if(this.selfAnalysisDone)throw Error(`Grammar rule <${At}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const qt=Br(Dt,"resyncEnabled")?Dt.resyncEnabled:r3.resyncEnabled,gn=Br(Dt,"recoveryValueFunc")?Dt.recoveryValueFunc:r3.recoveryValueFunc,Rn=this.ruleShortNameIdx<<H2+km;this.ruleShortNameIdx++,this.shortRuleNameToFull[Rn]=At,this.fullRuleNameToShort[At]=Rn;let Ln;return this.outputCst===!0?Ln=function(...xr){try{this.ruleInvocationStateUpdate(Rn,At,this.subruleIdx),wt.apply(this,xr);const br=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(br),br}catch(br){return this.invokeRuleCatch(br,qt,gn)}finally{this.ruleFinallyStateUpdate()}}:Ln=function(...xr){try{return this.ruleInvocationStateUpdate(Rn,At,this.subruleIdx),wt.apply(this,xr)}catch(br){return this.invokeRuleCatch(br,qt,gn)}finally{this.ruleFinallyStateUpdate()}},Object.assign(Ln,{ruleName:At,originalGrammarAction:wt})}invokeRuleCatch(At,wt,Dt){const qt=this.RULE_STACK.length===1,gn=wt&&!this.isBackTracking()&&this.recoveryEnabled;if(Y1(At)){const Rn=At;if(gn){const Ln=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(Ln))if(Rn.resyncedTokens=this.reSyncTo(Ln),this.outputCst){const Xn=this.CST_STACK[this.CST_STACK.length-1];return Xn.recoveredNode=!0,Xn}else return Dt(At);else{if(this.outputCst){const Xn=this.CST_STACK[this.CST_STACK.length-1];Xn.recoveredNode=!0,Rn.partialCstResult=Xn}throw Rn}}else{if(qt)return this.moveToTerminatedState(),Dt(At);throw Rn}}else throw At}optionInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(MA,wt);return this.optionInternalLogic(At,wt,Dt)}optionInternalLogic(At,wt,Dt){let qt=this.getLaFuncFromCache(Dt),gn;if(typeof At!="function"){gn=At.DEF;const Rn=At.GATE;if(Rn!==void 0){const Ln=qt;qt=()=>Rn.call(this)&&Ln.call(this)}}else gn=At;if(qt.call(this)===!0)return gn.call(this)}atLeastOneInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(C3,At);return this.atLeastOneInternalLogic(At,wt,Dt)}atLeastOneInternalLogic(At,wt,Dt){let qt=this.getLaFuncFromCache(Dt),gn;if(typeof wt!="function"){gn=wt.DEF;const Rn=wt.GATE;if(Rn!==void 0){const Ln=qt;qt=()=>Rn.call(this)&&Ln.call(this)}}else gn=wt;if(qt.call(this)===!0){let Rn=this.doSingleRepetition(gn);for(;qt.call(this)===!0&&Rn===!0;)Rn=this.doSingleRepetition(gn)}else throw this.raiseEarlyExitException(At,Qo.REPETITION_MANDATORY,wt.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[At,wt],qt,C3,At,u2)}atLeastOneSepFirstInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(J1,At);this.atLeastOneSepFirstInternalLogic(At,wt,Dt)}atLeastOneSepFirstInternalLogic(At,wt,Dt){const qt=wt.DEF,gn=wt.SEP;if(this.getLaFuncFromCache(Dt).call(this)===!0){qt.call(this);const Ln=()=>this.tokenMatcher(this.LA(1),gn);for(;this.tokenMatcher(this.LA(1),gn)===!0;)this.CONSUME(gn),qt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[At,gn,Ln,qt,uA],Ln,J1,At,uA)}else throw this.raiseEarlyExitException(At,Qo.REPETITION_MANDATORY_WITH_SEPARATOR,wt.ERR_MSG)}manyInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(b3,At);return this.manyInternalLogic(At,wt,Dt)}manyInternalLogic(At,wt,Dt){let qt=this.getLaFuncFromCache(Dt),gn;if(typeof wt!="function"){gn=wt.DEF;const Ln=wt.GATE;if(Ln!==void 0){const Xn=qt;qt=()=>Ln.call(this)&&Xn.call(this)}}else gn=wt;let Rn=!0;for(;qt.call(this)===!0&&Rn===!0;)Rn=this.doSingleRepetition(gn);this.attemptInRepetitionRecovery(this.manyInternal,[At,wt],qt,b3,At,c2,Rn)}manySepFirstInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(T3,At);this.manySepFirstInternalLogic(At,wt,Dt)}manySepFirstInternalLogic(At,wt,Dt){const qt=wt.DEF,gn=wt.SEP;if(this.getLaFuncFromCache(Dt).call(this)===!0){qt.call(this);const Ln=()=>this.tokenMatcher(this.LA(1),gn);for(;this.tokenMatcher(this.LA(1),gn)===!0;)this.CONSUME(gn),qt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[At,gn,Ln,qt,cA],Ln,T3,At,cA)}}repetitionSepSecondInternal(At,wt,Dt,qt,gn){for(;Dt();)this.CONSUME(wt),qt.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[At,wt,Dt,qt,gn],Dt,J1,At,gn)}doSingleRepetition(At){const wt=this.getLexerPosition();return At.call(this),this.getLexerPosition()>wt}orInternal(At,wt){const Dt=this.getKeyForAutomaticLookahead(TA,wt),qt=Mt(At)?At:At.DEF,Rn=this.getLaFuncFromCache(Dt).call(this,qt);if(Rn!==void 0)return qt[Rn].ALT.call(this);this.raiseNoAltException(wt,At.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const At=this.LA(1),wt=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:At,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new O2(wt,At))}}subruleInternal(At,wt,Dt){let qt;try{const gn=Dt!==void 0?Dt.ARGS:void 0;return this.subruleIdx=wt,qt=At.apply(this,gn),this.cstPostNonTerminal(qt,Dt!==void 0&&Dt.LABEL!==void 0?Dt.LABEL:At.ruleName),qt}catch(gn){throw this.subruleInternalError(gn,Dt,At.ruleName)}}subruleInternalError(At,wt,Dt){throw Y1(At)&&At.partialCstResult!==void 0&&(this.cstPostNonTerminal(At.partialCstResult,wt!==void 0&&wt.LABEL!==void 0?wt.LABEL:Dt),delete At.partialCstResult),At}consumeInternal(At,wt,Dt){let qt;try{const gn=this.LA(1);this.tokenMatcher(gn,At)===!0?(this.consumeToken(),qt=gn):this.consumeInternalError(At,gn,Dt)}catch(gn){qt=this.consumeInternalRecovery(At,wt,gn)}return this.cstPostTerminal(Dt!==void 0&&Dt.LABEL!==void 0?Dt.LABEL:At.name,qt),qt}consumeInternalError(At,wt,Dt){let qt;const gn=this.LA(0);throw Dt!==void 0&&Dt.ERR_MSG?qt=Dt.ERR_MSG:qt=this.errorMessageProvider.buildMismatchTokenMessage({expected:At,actual:wt,previous:gn,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new bA(qt,wt,gn))}consumeInternalRecovery(At,wt,Dt){if(this.recoveryEnabled&&Dt.name==="MismatchedTokenException"&&!this.isBackTracking()){const qt=this.getFollowsForInRuleRecovery(At,wt);try{return this.tryInRuleRecovery(At,qt)}catch(gn){throw gn.name===CA?Dt:gn}}else throw Dt}saveRecogState(){const At=this.errors,wt=Co(this.RULE_STACK);return{errors:At,lexerState:this.exportLexerState(),RULE_STACK:wt,CST_STACK:this.CST_STACK}}reloadRecogState(At){this.errors=At.errors,this.importLexerState(At.lexerState),this.RULE_STACK=At.RULE_STACK}ruleInvocationStateUpdate(At,wt,Dt){this.RULE_OCCURRENCE_STACK.push(Dt),this.RULE_STACK.push(At),this.cstInvocationStateUpdate(wt)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const At=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[At]}shortRuleNameToFullName(At){return this.shortRuleNameToFull[At]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),g0)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class oy{initErrorHandler(At){this._errors=[],this.errorMessageProvider=Br(At,"errorMessageProvider")?At.errorMessageProvider:Kp.errorMessageProvider}SAVE_ERROR(At){if(Y1(At))return At.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Co(this.RULE_OCCURRENCE_STACK)},this._errors.push(At),At;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Co(this._errors)}set errors(At){this._errors=At}raiseEarlyExitException(At,wt,Dt){const qt=this.getCurrRuleFullName(),gn=this.getGAstProductions()[qt],Ln=_3(At,gn,wt,this.maxLookahead)[0],Xn=[];for(let xr=1;xr<=this.maxLookahead;xr++)Xn.push(this.LA(xr));const rr=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:Ln,actual:Xn,previous:this.LA(0),customUserDescription:Dt,ruleName:qt});throw this.SAVE_ERROR(new U2(rr,this.LA(1),this.LA(0)))}raiseNoAltException(At,wt){const Dt=this.getCurrRuleFullName(),qt=this.getGAstProductions()[Dt],gn=y3(At,qt,this.maxLookahead),Rn=[];for(let rr=1;rr<=this.maxLookahead;rr++)Rn.push(this.LA(rr));const Ln=this.LA(0),Xn=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:gn,actual:Rn,previous:Ln,customUserDescription:wt,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new D2(Xn,this.LA(1),Ln))}}class ay{initContentAssist(){}computeContentAssist(At,wt){const Dt=this.gastProductionsCache[At];if(Xp(Dt))throw Error(`Rule ->${At}<- does not exist in this grammar.`);return hA([Dt],wt,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(At){const wt=Nt(At.ruleStack),qt=this.getGAstProductions()[wt];return new l2(qt,At).startWalking()}}const e3={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(e3);const RA=!0,FA=Math.pow(2,km)-1,PA=m3({name:"RECORDING_PHASE_TOKEN",pattern:bu.NA});C1([PA]);const LA=g3(PA,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(LA);const ly={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class cy{initGastRecorder(At){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let At=0;At<10;At++){const wt=At>0?At:"";this[`CONSUME${wt}`]=function(Dt,qt){return this.consumeInternalRecord(Dt,At,qt)},this[`SUBRULE${wt}`]=function(Dt,qt){return this.subruleInternalRecord(Dt,At,qt)},this[`OPTION${wt}`]=function(Dt){return this.optionInternalRecord(Dt,At)},this[`OR${wt}`]=function(Dt){return this.orInternalRecord(Dt,At)},this[`MANY${wt}`]=function(Dt){this.manyInternalRecord(At,Dt)},this[`MANY_SEP${wt}`]=function(Dt){this.manySepFirstInternalRecord(At,Dt)},this[`AT_LEAST_ONE${wt}`]=function(Dt){this.atLeastOneInternalRecord(At,Dt)},this[`AT_LEAST_ONE_SEP${wt}`]=function(Dt){this.atLeastOneSepFirstInternalRecord(At,Dt)}}this.consume=function(At,wt,Dt){return this.consumeInternalRecord(wt,At,Dt)},this.subrule=function(At,wt,Dt){return this.subruleInternalRecord(wt,At,Dt)},this.option=function(At,wt){return this.optionInternalRecord(wt,At)},this.or=function(At,wt){return this.orInternalRecord(wt,At)},this.many=function(At,wt){this.manyInternalRecord(At,wt)},this.atLeastOne=function(At,wt){this.atLeastOneInternalRecord(At,wt)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const At=this;for(let wt=0;wt<10;wt++){const Dt=wt>0?wt:"";delete At[`CONSUME${Dt}`],delete At[`SUBRULE${Dt}`],delete At[`OPTION${Dt}`],delete At[`OR${Dt}`],delete At[`MANY${Dt}`],delete At[`MANY_SEP${Dt}`],delete At[`AT_LEAST_ONE${Dt}`],delete At[`AT_LEAST_ONE_SEP${Dt}`]}delete At.consume,delete At.subrule,delete At.option,delete At.or,delete At.many,delete At.atLeastOne,delete At.ACTION,delete At.BACKTRACK,delete At.LA})}ACTION_RECORD(At){}BACKTRACK_RECORD(At,wt){return()=>!0}LA_RECORD(At){return n3}topLevelRuleRecord(At,wt){try{const Dt=new o1({definition:[],name:At});return Dt.name=At,this.recordingProdStack.push(Dt),wt.call(this),this.recordingProdStack.pop(),Dt}catch(Dt){if(Dt.KNOWN_RECORDER_ERROR!==!0)try{Dt.message=Dt.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw Dt}throw Dt}}optionInternalRecord(At,wt){return w1.call(this,mu,At,wt)}atLeastOneInternalRecord(At,wt){w1.call(this,vp,wt,At)}atLeastOneSepFirstInternalRecord(At,wt){w1.call(this,yp,wt,At,RA)}manyInternalRecord(At,wt){w1.call(this,yl,wt,At)}manySepFirstInternalRecord(At,wt){w1.call(this,Ju,wt,At,RA)}orInternalRecord(At,wt){return uy.call(this,At,wt)}subruleInternalRecord(At,wt,Dt){if(t3(wt),!At||Br(At,"ruleName")===!1){const Ln=new Error(`<SUBRULE${kA(wt)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(At)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw Ln.KNOWN_RECORDER_ERROR=!0,Ln}const qt=no(this.recordingProdStack),gn=At.ruleName,Rn=new Su({idx:wt,nonTerminalName:gn,label:Dt==null?void 0:Dt.LABEL,referencedRule:void 0});return qt.definition.push(Rn),this.outputCst?ly:e3}consumeInternalRecord(At,wt,Dt){if(t3(wt),!q3(At)){const Rn=new Error(`<CONSUME${kA(wt)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(At)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw Rn.KNOWN_RECORDER_ERROR=!0,Rn}const qt=no(this.recordingProdStack),gn=new No({idx:wt,terminalType:At,label:Dt==null?void 0:Dt.LABEL});return qt.definition.push(gn),LA}}function w1(bt,At,wt,Dt=!1){t3(wt);const qt=no(this.recordingProdStack),gn=Cn(At)?At:At.DEF,Rn=new bt({definition:[],idx:wt});return Dt&&(Rn.separator=At.SEP),Br(At,"MAX_LOOKAHEAD")&&(Rn.maxLookahead=At.MAX_LOOKAHEAD),this.recordingProdStack.push(Rn),gn.call(this),qt.definition.push(Rn),this.recordingProdStack.pop(),e3}function uy(bt,At){t3(At);const wt=no(this.recordingProdStack),Dt=Mt(bt)===!1,qt=Dt===!1?bt:bt.DEF,gn=new Zu({definition:[],idx:At,ignoreAmbiguities:Dt&&bt.IGNORE_AMBIGUITIES===!0});Br(bt,"MAX_LOOKAHEAD")&&(gn.maxLookahead=bt.MAX_LOOKAHEAD);const Rn=F3(qt,Ln=>Cn(Ln.GATE));return gn.hasPredicates=Rn,wt.definition.push(gn),ss(qt,Ln=>{const Xn=new pu({definition:[]});gn.definition.push(Xn),Br(Ln,"IGNORE_AMBIGUITIES")?Xn.ignoreAmbiguities=Ln.IGNORE_AMBIGUITIES:Br(Ln,"GATE")&&(Xn.ignoreAmbiguities=!0),this.recordingProdStack.push(Xn),Ln.ALT.call(this),this.recordingProdStack.pop()}),e3}function kA(bt){return bt===0?"":`${bt}`}function t3(bt){if(bt<0||bt>FA){const At=new Error(`Invalid DSL Method idx value: <${bt}>
	Idx value must be a none negative value smaller than ${FA+1}`);throw At.KNOWN_RECORDER_ERROR=!0,At}}class hy{initPerformanceTracer(At){if(Br(At,"traceInitPerf")){const wt=At.traceInitPerf,Dt=typeof wt=="number";this.traceInitMaxIdent=Dt?wt:1/0,this.traceInitPerf=Dt?wt>0:wt}else this.traceInitMaxIdent=0,this.traceInitPerf=Kp.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(At,wt){if(this.traceInitPerf===!0){this.traceInitIndent++;const Dt=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${Dt}--> <${At}>`);const{time:qt,value:gn}=L3(wt),Rn=qt>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&Rn(`${Dt}<-- <${At}> time: ${qt}ms`),this.traceInitIndent--,gn}else return wt()}}function fy(bt,At){At.forEach(wt=>{const Dt=wt.prototype;Object.getOwnPropertyNames(Dt).forEach(qt=>{if(qt==="constructor")return;const gn=Object.getOwnPropertyDescriptor(Dt,qt);gn&&(gn.get||gn.set)?Object.defineProperty(bt.prototype,qt,gn):bt.prototype[qt]=wt.prototype[qt]})})}const n3=g3(g0,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(n3);const Kp=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:lA,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),r3=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var iu;(function(bt){bt[bt.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",bt[bt.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",bt[bt.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",bt[bt.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",bt[bt.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",bt[bt.LEFT_RECURSION=5]="LEFT_RECURSION",bt[bt.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",bt[bt.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",bt[bt.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",bt[bt.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",bt[bt.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",bt[bt.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",bt[bt.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",bt[bt.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(iu||(iu={}));class I1{static performSelfAnalysis(At){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let At;this.selfAnalysisDone=!0;const wt=this.className;this.TRACE_INIT("toFastProps",()=>{k3(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),ss(this.definedRulesNames,qt=>{const Rn=this[qt].originalGrammarAction;let Ln;this.TRACE_INIT(`${qt} Rule`,()=>{Ln=this.topLevelRuleRecord(qt,Rn)}),this.gastProductionsCache[qt]=Ln})}finally{this.disableRecording()}});let Dt=[];if(this.TRACE_INIT("Grammar Resolving",()=>{Dt=k2({rules:er(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(Dt)}),this.TRACE_INIT("Grammar Validations",()=>{if(qs(Dt)&&this.skipValidations===!1){const qt=N2({rules:er(this.gastProductionsCache),tokenTypes:er(this.tokensMap),errMsgProvider:A0,grammarName:wt}),gn=y2({lookaheadStrategy:this.lookaheadStrategy,rules:er(this.gastProductionsCache),tokenTypes:er(this.tokensMap),grammarName:wt});this.definitionErrors=this.definitionErrors.concat(qt,gn)}}),qs(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const qt=fv(er(this.gastProductionsCache));this.resyncFollows=qt}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var qt,gn;(gn=(qt=this.lookaheadStrategy).initialize)===null||gn===void 0||gn.call(qt,{rules:er(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(er(this.gastProductionsCache))})),!I1.DEFER_DEFINITION_ERRORS_HANDLING&&!qs(this.definitionErrors))throw At=en(this.definitionErrors,qt=>qt.message),new Error(`Parser Definition Errors detected:
 ${At.join(`
-------------------------------
`)}`)})}constructor(At,wt){this.definitionErrors=[],this.selfAnalysisDone=!1;const Dt=this;if(Dt.initErrorHandler(wt),Dt.initLexerAdapter(),Dt.initLooksAhead(wt),Dt.initRecognizerEngine(At,wt),Dt.initRecoverable(wt),Dt.initTreeBuilder(wt),Dt.initContentAssist(),Dt.initGastRecorder(wt),Dt.initPerformanceTracer(wt),Br(wt,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Br(wt,"skipValidations")?wt.skipValidations:Kp.skipValidations}}I1.DEFER_DEFINITION_ERRORS_HANDLING=!1,fy(I1,[V2,W2,ny,ry,sy,iy,oy,ay,cy,hy]);class dy extends I1{constructor(At,wt=Kp){const Dt=Co(wt);Dt.outputCst=!0,super(At,Dt)}}return{CstParser:dy,Lexer:bu,createToken:m3}})();class VRMLLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=_e.path===""?LoaderUtils.extractUrlBase(s):_e.path,nt=new FileLoader(_e.manager);nt.setPath(_e.path),nt.setRequestHeader(_e.requestHeader),nt.setWithCredentials(_e.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}parse(s,o){const j={};function $($n){const tn=_e(),$t=new VRMLLexer(tn.tokens),An=new VRMLParser(tn.tokenVocabulary),En=tt(An.getBaseCstVisitorConstructor()),In=$t.lex($n);An.input=In.tokens;const Hn=An.vrml();if(An.errors.length>0)throw console.error(An.errors),Error("THREE.VRMLLoader: Parsing errors detected.");return En.visit(Hn)}function _e(){const $n=createToken({name:"RouteIdentifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*[\.][^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/}),tn=createToken({name:"Identifier",pattern:/[^\x30-\x39\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d][^\0-\x20\x22\x27\x23\x2b\x2c\x2d\x2e\x5b\x5d\x5c\x7b\x7d]*/,longer_alt:$n}),$t=["Anchor","Billboard","Collision","Group","Transform","Inline","LOD","Switch","AudioClip","DirectionalLight","PointLight","Script","Shape","Sound","SpotLight","WorldInfo","CylinderSensor","PlaneSensor","ProximitySensor","SphereSensor","TimeSensor","TouchSensor","VisibilitySensor","Box","Cone","Cylinder","ElevationGrid","Extrusion","IndexedFaceSet","IndexedLineSet","PointSet","Sphere","Color","Coordinate","Normal","TextureCoordinate","Appearance","FontStyle","ImageTexture","Material","MovieTexture","PixelTexture","TextureTransform","ColorInterpolator","CoordinateInterpolator","NormalInterpolator","OrientationInterpolator","PositionInterpolator","ScalarInterpolator","Background","Fog","NavigationInfo","Viewpoint","Text"],An=createToken({name:"Version",pattern:/#VRML.*/,longer_alt:tn}),En=createToken({name:"NodeName",pattern:new RegExp($t.join("|")),longer_alt:tn}),In=createToken({name:"DEF",pattern:/DEF/,longer_alt:tn}),Hn=createToken({name:"USE",pattern:/USE/,longer_alt:tn}),yn=createToken({name:"ROUTE",pattern:/ROUTE/,longer_alt:tn}),On=createToken({name:"TO",pattern:/TO/,longer_alt:tn}),Mn=createToken({name:"StringLiteral",pattern:/"(?:[^\\"\n\r]|\\[bfnrtv"\\/]|\\u[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F])*"/}),tr=createToken({name:"HexLiteral",pattern:/0[xX][0-9a-fA-F]+/}),gr=createToken({name:"NumberLiteral",pattern:/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/}),Cr=createToken({name:"TrueLiteral",pattern:/TRUE/}),Sr=createToken({name:"FalseLiteral",pattern:/FALSE/}),Un=createToken({name:"NullLiteral",pattern:/NULL/}),Jn=createToken({name:"LSquare",pattern:/\[/}),pr=createToken({name:"RSquare",pattern:/]/}),Gn=createToken({name:"LCurly",pattern:/{/}),Zn=createToken({name:"RCurly",pattern:/}/}),qn=createToken({name:"Comment",pattern:/#.*/,group:Lexer.SKIPPED}),_r=[createToken({name:"WhiteSpace",pattern:/[ ,\s]/,group:Lexer.SKIPPED}),En,In,Hn,yn,On,Cr,Sr,Un,An,tn,$n,Mn,tr,gr,Jn,pr,Gn,Zn,qn],$r={};for(let es=0,Hr=_r.length;es<Hr;es++){const Ur=_r[es];$r[Ur.name]=Ur}return{tokens:_r,tokenVocabulary:$r}}function tt($n){function tn(){$n.call(this),this.validateVisitor()}tn.prototype=Object.assign(Object.create($n.prototype),{constructor:tn,vrml:function(An){const En={version:this.visit(An.version),nodes:[],routes:[]};for(let In=0,Hn=An.node.length;In<Hn;In++){const yn=An.node[In];En.nodes.push(this.visit(yn))}if(An.route)for(let In=0,Hn=An.route.length;In<Hn;In++){const yn=An.route[In];En.routes.push(this.visit(yn))}return En},version:function(An){return An.Version[0].image},node:function(An){const En={name:An.NodeName[0].image,fields:[]};if(An.field)for(let In=0,Hn=An.field.length;In<Hn;In++){const yn=An.field[In];En.fields.push(this.visit(yn))}return An.def&&(En.DEF=this.visit(An.def[0])),En},field:function(An){const En={name:An.Identifier[0].image,type:null,values:null};let In;return An.singleFieldValue&&(In=this.visit(An.singleFieldValue[0])),An.multiFieldValue&&(In=this.visit(An.multiFieldValue[0])),En.type=In.type,En.values=In.values,En},def:function(An){return(An.Identifier||An.NodeName)[0].image},use:function(An){return{USE:(An.Identifier||An.NodeName)[0].image}},singleFieldValue:function(An){return $t(this,An)},multiFieldValue:function(An){return $t(this,An)},route:function(An){return{FROM:An.RouteIdentifier[0].image,TO:An.RouteIdentifier[1].image}}});function $t(An,En){const In={type:null,values:[]};if(En.node){In.type="node";for(let Hn=0,yn=En.node.length;Hn<yn;Hn++){const On=En.node[Hn];In.values.push(An.visit(On))}}if(En.use){In.type="use";for(let Hn=0,yn=En.use.length;Hn<yn;Hn++){const On=En.use[Hn];In.values.push(An.visit(On))}}if(En.StringLiteral){In.type="string";for(let Hn=0,yn=En.StringLiteral.length;Hn<yn;Hn++){const On=En.StringLiteral[Hn];In.values.push(On.image.replace(/'|"/g,""))}}if(En.NumberLiteral){In.type="number";for(let Hn=0,yn=En.NumberLiteral.length;Hn<yn;Hn++){const On=En.NumberLiteral[Hn];In.values.push(parseFloat(On.image))}}if(En.HexLiteral){In.type="hex";for(let Hn=0,yn=En.HexLiteral.length;Hn<yn;Hn++){const On=En.HexLiteral[Hn];In.values.push(On.image)}}if(En.TrueLiteral){In.type="boolean";for(let Hn=0,yn=En.TrueLiteral.length;Hn<yn;Hn++)En.TrueLiteral[Hn].image==="TRUE"&&In.values.push(!0)}if(En.FalseLiteral){In.type="boolean";for(let Hn=0,yn=En.FalseLiteral.length;Hn<yn;Hn++)En.FalseLiteral[Hn].image==="FALSE"&&In.values.push(!1)}return En.NullLiteral&&(In.type="null",En.NullLiteral.forEach(function(){In.values.push(null)})),In}return new tn}function nt($n){const tn=$n.nodes,$t=new Scene;for(let An=0,En=tn.length;An<En;An++){const In=tn[An];rt(In)}for(let An=0,En=tn.length;An<En;An++){const In=tn[An],Hn=it(In);Hn instanceof Object3D&&$t.add(Hn),In.name==="WorldInfo"&&($t.userData.worldInfo=Hn)}return $t}function rt($n){$n.DEF&&(j[$n.DEF]=$n);const tn=$n.fields;for(let $t=0,An=tn.length;$t<An;$t++){const En=tn[$t];if(En.type==="node"){const In=En.values;for(let Hn=0,yn=In.length;Hn<yn;Hn++)rt(In[Hn])}}}function it($n){return $n.USE?jt($n.USE):($n.build!==void 0||($n.build=st($n)),$n.build)}function st($n){const tn=$n.name;let $t;switch(tn){case"Group":case"Transform":case"Collision":$t=at($n);break;case"Background":$t=ot($n);break;case"Shape":$t=ct($n);break;case"Appearance":$t=ft($n);break;case"Material":$t=ht($n);break;case"ImageTexture":$t=dt($n);break;case"PixelTexture":$t=ut($n);break;case"TextureTransform":$t=gt($n);break;case"IndexedFaceSet":$t=Tt($n);break;case"IndexedLineSet":$t=Mt($n);break;case"PointSet":$t=Bt($n);break;case"Box":$t=Rt($n);break;case"Cone":$t=Ut($n);break;case"Cylinder":$t=Ht($n);break;case"Sphere":$t=Wt($n);break;case"ElevationGrid":$t=Jt($n);break;case"Extrusion":$t=sn($n);break;case"Color":case"Coordinate":case"Normal":case"TextureCoordinate":$t=Et($n);break;case"WorldInfo":$t=St($n);break;case"Anchor":case"Billboard":case"Inline":case"LOD":case"Switch":case"AudioClip":case"DirectionalLight":case"PointLight":case"Script":case"Sound":case"SpotLight":case"CylinderSensor":case"PlaneSensor":case"ProximitySensor":case"SphereSensor":case"TimeSensor":case"TouchSensor":case"VisibilitySensor":case"Text":case"FontStyle":case"MovieTexture":case"ColorInterpolator":case"CoordinateInterpolator":case"NormalInterpolator":case"OrientationInterpolator":case"PositionInterpolator":case"ScalarInterpolator":case"Fog":case"NavigationInfo":case"Viewpoint":break;default:console.warn("THREE.VRMLLoader: Unknown node:",tn);break}return $t!==void 0&&$n.DEF!==void 0&&$t.hasOwnProperty("name")===!0&&($t.name=$n.DEF),$t}function at($n){const tn=new Group,$t=$n.fields;for(let An=0,En=$t.length;An<En;An++){const In=$t[An],Hn=In.name,yn=In.values;switch(Hn){case"bboxCenter":break;case"bboxSize":break;case"center":break;case"children":Vt(yn,tn);break;case"collide":break;case"rotation":const On=new Vector3(yn[0],yn[1],yn[2]),Mn=yn[3];tn.quaternion.setFromAxisAngle(On,Mn);break;case"scale":tn.scale.set(yn[0],yn[1],yn[2]);break;case"scaleOrientation":break;case"translation":tn.position.set(yn[0],yn[1],yn[2]);break;case"proxy":break;default:console.warn("THREE.VRMLLoader: Unknown field:",Hn);break}}return tn}function ot($n){const tn=new Group;let $t,An,En,In;const Hn=$n.fields;for(let On=0,Mn=Hn.length;On<Mn;On++){const tr=Hn[On],gr=tr.name,Cr=tr.values;switch(gr){case"groundAngle":$t=Cr;break;case"groundColor":An=Cr;break;case"backUrl":break;case"bottomUrl":break;case"frontUrl":break;case"leftUrl":break;case"rightUrl":break;case"topUrl":break;case"skyAngle":En=Cr;break;case"skyColor":In=Cr;break;default:console.warn("THREE.VRMLLoader: Unknown field:",gr);break}}const yn=1e4;if(In){const On=new SphereGeometry(yn,32,16),Mn=new MeshBasicMaterial({fog:!1,side:BackSide,depthWrite:!1,depthTest:!1});In.length>3?(Qn(On,yn,En,xn(In),!0),Mn.vertexColors=!0):Mn.color.setRGB(In[0],In[1],In[2]);const tr=new Mesh(On,Mn);tn.add(tr)}if(An&&An.length>0){const On=new SphereGeometry(yn,32,16,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),Mn=new MeshBasicMaterial({fog:!1,side:BackSide,vertexColors:!0,depthWrite:!1,depthTest:!1});Qn(On,yn,$t,xn(An),!1);const tr=new Mesh(On,Mn);tn.add(tr)}return tn.renderOrder=-1/0,tn}function ct($n){const tn=$n.fields;let $t=new MeshBasicMaterial({color:0}),An;for(let In=0,Hn=tn.length;In<Hn;In++){const yn=tn[In],On=yn.name,Mn=yn.values;switch(On){case"appearance":Mn[0]!==null&&($t=it(Mn[0]));break;case"geometry":Mn[0]!==null&&(An=it(Mn[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",On);break}}let En;if(An&&An.attributes.position){const In=An._type;if(In==="points"){const Hn=new PointsMaterial({color:16777215});An.attributes.color!==void 0?Hn.vertexColors=!0:$t.isMeshPhongMaterial&&Hn.color.copy($t.emissive),En=new Points(An,Hn)}else if(In==="line"){const Hn=new LineBasicMaterial({color:16777215});An.attributes.color!==void 0?Hn.vertexColors=!0:$t.isMeshPhongMaterial&&Hn.color.copy($t.emissive),En=new LineSegments(An,Hn)}else An._solid!==void 0&&($t.side=An._solid?FrontSide:DoubleSide),An.attributes.color!==void 0&&($t.vertexColors=!0),En=new Mesh(An,$t)}else En=new Object3D,En.visible=!1;return En}function ft($n){let tn=new MeshPhongMaterial,$t;const An=$n.fields;for(let En=0,In=An.length;En<In;En++){const Hn=An[En],yn=Hn.name,On=Hn.values;switch(yn){case"material":if(On[0]!==null){const tr=it(On[0]);tr.diffuseColor&&tn.color.copy(tr.diffuseColor),tr.emissiveColor&&tn.emissive.copy(tr.emissiveColor),tr.shininess&&(tn.shininess=tr.shininess),tr.specularColor&&tn.specular.copy(tr.specularColor),tr.transparency&&(tn.opacity=1-tr.transparency),tr.transparency>0&&(tn.transparent=!0)}else tn=new MeshBasicMaterial({color:0});break;case"texture":const Mn=On[0];Mn!==null&&(Mn.name==="ImageTexture"||Mn.name==="PixelTexture")&&(tn.map=it(Mn));break;case"textureTransform":On[0]!==null&&($t=it(On[0]));break;default:console.warn("THREE.VRMLLoader: Unknown field:",yn);break}}if(tn.map){if(tn.map.__type){switch(tn.map.__type){case TEXTURE_TYPE.INTENSITY_ALPHA:tn.opacity=1;break;case TEXTURE_TYPE.RGB:tn.color.set(16777215);break;case TEXTURE_TYPE.RGBA:tn.color.set(16777215),tn.opacity=1;break}delete tn.map.__type}$t&&(tn.map.center.copy($t.center),tn.map.rotation=$t.rotation,tn.map.repeat.copy($t.scale),tn.map.offset.copy($t.translation))}return tn}function ht($n){const tn={},$t=$n.fields;for(let An=0,En=$t.length;An<En;An++){const In=$t[An],Hn=In.name,yn=In.values;switch(Hn){case"ambientIntensity":break;case"diffuseColor":tn.diffuseColor=new Color(yn[0],yn[1],yn[2]);break;case"emissiveColor":tn.emissiveColor=new Color(yn[0],yn[1],yn[2]);break;case"shininess":tn.shininess=yn[0];break;case"specularColor":tn.emissiveColor=new Color(yn[0],yn[1],yn[2]);break;case"transparency":tn.transparency=yn[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",Hn);break}}return tn}function mt($n,tn,$t){let An;switch(tn){case TEXTURE_TYPE.INTENSITY:An=parseInt($n),$t.r=An,$t.g=An,$t.b=An,$t.a=1;break;case TEXTURE_TYPE.INTENSITY_ALPHA:An=parseInt("0x"+$n.substring(2,4)),$t.r=An,$t.g=An,$t.b=An,$t.a=parseInt("0x"+$n.substring(4,6));break;case TEXTURE_TYPE.RGB:$t.r=parseInt("0x"+$n.substring(2,4)),$t.g=parseInt("0x"+$n.substring(4,6)),$t.b=parseInt("0x"+$n.substring(6,8)),$t.a=1;break;case TEXTURE_TYPE.RGBA:$t.r=parseInt("0x"+$n.substring(2,4)),$t.g=parseInt("0x"+$n.substring(4,6)),$t.b=parseInt("0x"+$n.substring(6,8)),$t.a=parseInt("0x"+$n.substring(8,10));break}}function lt($n){let tn;switch($n){case 1:tn=TEXTURE_TYPE.INTENSITY;break;case 2:tn=TEXTURE_TYPE.INTENSITY_ALPHA;break;case 3:tn=TEXTURE_TYPE.RGB;break;case 4:tn=TEXTURE_TYPE.RGBA;break}return tn}function ut($n){let tn,$t=RepeatWrapping,An=RepeatWrapping;const En=$n.fields;for(let In=0,Hn=En.length;In<Hn;In++){const yn=En[In],On=yn.name,Mn=yn.values;switch(On){case"image":const tr=Mn[0],gr=Mn[1],Cr=Mn[2],Sr=lt(Cr),Un=new Uint8Array(4*tr*gr),Jn={r:0,g:0,b:0,a:0};for(let pr=3,Gn=0,Zn=Mn.length;pr<Zn;pr++,Gn++){mt(Mn[pr],Sr,Jn);const qn=Gn*4;Un[qn+0]=Jn.r,Un[qn+1]=Jn.g,Un[qn+2]=Jn.b,Un[qn+3]=Jn.a}tn=new DataTexture(Un,tr,gr),tn.needsUpdate=!0,tn.__type=Sr;break;case"repeatS":Mn[0]===!1&&($t=ClampToEdgeWrapping);break;case"repeatT":Mn[0]===!1&&(An=ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",On);break}}return tn&&(tn.wrapS=$t,tn.wrapT=An),tn}function dt($n){let tn,$t=RepeatWrapping,An=RepeatWrapping;const En=$n.fields;for(let In=0,Hn=En.length;In<Hn;In++){const yn=En[In],On=yn.name,Mn=yn.values;switch(On){case"url":const tr=Mn[0];tr&&(tn=nr.load(tr));break;case"repeatS":Mn[0]===!1&&($t=ClampToEdgeWrapping);break;case"repeatT":Mn[0]===!1&&(An=ClampToEdgeWrapping);break;default:console.warn("THREE.VRMLLoader: Unknown field:",On);break}}return tn&&(tn.wrapS=$t,tn.wrapT=An),tn}function gt($n){const tn={center:new Vector2,rotation:new Vector2,scale:new Vector2,translation:new Vector2},$t=$n.fields;for(let An=0,En=$t.length;An<En;An++){const In=$t[An],Hn=In.name,yn=In.values;switch(Hn){case"center":tn.center.set(yn[0],yn[1]);break;case"rotation":tn.rotation=yn[0];break;case"scale":tn.scale.set(yn[0],yn[1]);break;case"translation":tn.translation.set(yn[0],yn[1]);break;default:console.warn("THREE.VRMLLoader: Unknown field:",Hn);break}}return tn}function Et($n){return $n.fields[0].values}function St($n){const tn={},$t=$n.fields;for(let An=0,En=$t.length;An<En;An++){const In=$t[An],Hn=In.name,yn=In.values;switch(Hn){case"title":tn.title=yn[0];break;case"info":tn.info=yn;break;default:console.warn("THREE.VRMLLoader: Unknown field:",Hn);break}}return tn}function Tt($n){let tn,$t,An,En,In=!0,Hn=!0,yn=0,On,Mn,tr,gr,Cr=!0,Sr=!0;const Un=$n.fields;for(let _r=0,$r=Un.length;_r<$r;_r++){const es=Un[_r],Hr=es.name,Ur=es.values;switch(Hr){case"color":const Ir=Ur[0];Ir!==null&&(tn=it(Ir));break;case"coord":const Fr=Ur[0];Fr!==null&&($t=it(Fr));break;case"normal":const Pr=Ur[0];Pr!==null&&(An=it(Pr));break;case"texCoord":const Jr=Ur[0];Jr!==null&&(En=it(Jr));break;case"ccw":In=Ur[0];break;case"colorIndex":On=Ur;break;case"colorPerVertex":Cr=Ur[0];break;case"convex":break;case"coordIndex":Mn=Ur;break;case"creaseAngle":yn=Ur[0];break;case"normalIndex":tr=Ur;break;case"normalPerVertex":Sr=Ur[0];break;case"solid":Hn=Ur[0];break;case"texCoordIndex":gr=Ur;break;default:console.warn("THREE.VRMLLoader: Unknown field:",Hr);break}}if(Mn===void 0)return console.warn("THREE.VRMLLoader: Missing coordIndex."),new BufferGeometry;const Jn=Lt(Mn,In);let pr,Gn,Zn;if(tn)if(Cr===!0)if(On&&On.length>0){const _r=Lt(On,In);pr=Nn(Jn,_r,tn,3)}else pr=ln(Jn,new Float32BufferAttribute(tn,3));else if(On&&On.length>0){const _r=nn(tn,On),$r=Qt(_r,Mn);pr=Pn(Jn,$r)}else{const _r=Qt(tn,Mn);pr=Pn(Jn,_r)}if(An)if(Sr===!0)if(tr&&tr.length>0){const _r=Lt(tr,In);Gn=Nn(Jn,_r,An,3)}else Gn=ln(Jn,new Float32BufferAttribute(An,3));else if(tr&&tr.length>0){const _r=nn(An,tr),$r=Qt(_r,Mn);Gn=Pn(Jn,$r)}else{const _r=Qt(An,Mn);Gn=Pn(Jn,_r)}else Gn=kn(Jn,$t,yn);if(En)if(gr&&gr.length>0){const _r=Lt(gr,In);Zn=Nn(Jn,_r,En,2)}else Zn=ln(Jn,new Float32BufferAttribute(En,2));const qn=new BufferGeometry,vr=ln(Jn,new Float32BufferAttribute($t,3));return qn.setAttribute("position",vr),qn.setAttribute("normal",Gn),pr&&qn.setAttribute("color",pr),Zn&&qn.setAttribute("uv",Zn),qn._solid=Hn,qn._type="mesh",qn}function Mt($n){let tn,$t,An,En,In=!0;const Hn=$n.fields;for(let gr=0,Cr=Hn.length;gr<Cr;gr++){const Sr=Hn[gr],Un=Sr.name,Jn=Sr.values;switch(Un){case"color":const pr=Jn[0];pr!==null&&(tn=it(pr));break;case"coord":const Gn=Jn[0];Gn!==null&&($t=it(Gn));break;case"colorIndex":An=Jn;break;case"colorPerVertex":In=Jn[0];break;case"coordIndex":En=Jn;break;default:console.warn("THREE.VRMLLoader: Unknown field:",Un);break}}let yn;const On=mn(En);if(tn)if(In===!0)if(An.length>0){const gr=mn(An);yn=Nn(On,gr,tn,3)}else yn=ln(On,new Float32BufferAttribute(tn,3));else if(An.length>0){const gr=nn(tn,An),Cr=Zt(gr,En);yn=Dn(On,Cr)}else{const gr=Zt(tn,En);yn=Dn(On,gr)}const Mn=new BufferGeometry,tr=ln(On,new Float32BufferAttribute($t,3));return Mn.setAttribute("position",tr),yn&&Mn.setAttribute("color",yn),Mn._type="line",Mn}function Bt($n){let tn,$t;const An=$n.fields;for(let In=0,Hn=An.length;In<Hn;In++){const yn=An[In],On=yn.name,Mn=yn.values;switch(On){case"color":const tr=Mn[0];tr!==null&&(tn=it(tr));break;case"coord":const gr=Mn[0];gr!==null&&($t=it(gr));break;default:console.warn("THREE.VRMLLoader: Unknown field:",On);break}}const En=new BufferGeometry;return En.setAttribute("position",new Float32BufferAttribute($t,3)),tn&&En.setAttribute("color",new Float32BufferAttribute(tn,3)),En._type="points",En}function Rt($n){const tn=new Vector3(2,2,2),$t=$n.fields;for(let En=0,In=$t.length;En<In;En++){const Hn=$t[En],yn=Hn.name,On=Hn.values;switch(yn){case"size":tn.x=On[0],tn.y=On[1],tn.z=On[2];break;default:console.warn("THREE.VRMLLoader: Unknown field:",yn);break}}return new BoxGeometry(tn.x,tn.y,tn.z)}function Ut($n){let tn=1,$t=2,An=!1;const En=$n.fields;for(let Hn=0,yn=En.length;Hn<yn;Hn++){const On=En[Hn],Mn=On.name,tr=On.values;switch(Mn){case"bottom":An=!tr[0];break;case"bottomRadius":tn=tr[0];break;case"height":$t=tr[0];break;case"side":break;default:console.warn("THREE.VRMLLoader: Unknown field:",Mn);break}}return new ConeGeometry(tn,$t,16,1,An)}function Ht($n){let tn=1,$t=2;const An=$n.fields;for(let In=0,Hn=An.length;In<Hn;In++){const yn=An[In],On=yn.name,Mn=yn.values;switch(On){case"bottom":break;case"radius":tn=Mn[0];break;case"height":$t=Mn[0];break;case"side":break;case"top":break;default:console.warn("THREE.VRMLLoader: Unknown field:",On);break}}return new CylinderGeometry(tn,tn,$t,16,1)}function Wt($n){let tn=1;const $t=$n.fields;for(let En=0,In=$t.length;En<In;En++){const Hn=$t[En],yn=Hn.name,On=Hn.values;switch(yn){case"radius":tn=On[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",yn);break}}return new SphereGeometry(tn,16,16)}function Jt($n){let tn,$t,An,En,In=!0,Hn=!0,yn=!0,On=!0,Mn=0,tr=2,gr=2,Cr=1,Sr=1;const Un=$n.fields;for(let Ur=0,Ir=Un.length;Ur<Ir;Ur++){const Fr=Un[Ur],Pr=Fr.name,Jr=Fr.values;switch(Pr){case"color":const zs=Jr[0];zs!==null&&(tn=it(zs));break;case"normal":const Ws=Jr[0];Ws!==null&&($t=it(Ws));break;case"texCoord":const Js=Jr[0];Js!==null&&(An=it(Js));break;case"height":En=Jr;break;case"ccw":On=Jr[0];break;case"colorPerVertex":In=Jr[0];break;case"creaseAngle":Mn=Jr[0];break;case"normalPerVertex":Hn=Jr[0];break;case"solid":yn=Jr[0];break;case"xDimension":tr=Jr[0];break;case"xSpacing":Cr=Jr[0];break;case"zDimension":gr=Jr[0];break;case"zSpacing":Sr=Jr[0];break;default:console.warn("THREE.VRMLLoader: Unknown field:",Pr);break}}const Jn=[],pr=[],Gn=[],Zn=[];for(let Ur=0;Ur<gr;Ur++)for(let Ir=0;Ir<tr;Ir++){const Fr=Ur*tr+Ir,Pr=Cr*Ur,Jr=En[Fr],zs=Sr*Ir;if(Jn.push(Pr,Jr,zs),tn&&In===!0){const Ws=tn[Fr*3+0],Js=tn[Fr*3+1],ao=tn[Fr*3+2];Gn.push(Ws,Js,ao)}if($t&&Hn===!0){const Ws=$t[Fr*3+0],Js=$t[Fr*3+1],ao=$t[Fr*3+2];pr.push(Ws,Js,ao)}if(An){const Ws=An[Fr*2+0],Js=An[Fr*2+1];Zn.push(Ws,Js)}else Zn.push(Ur/(tr-1),Ir/(gr-1))}const qn=[];for(let Ur=0;Ur<tr-1;Ur++)for(let Ir=0;Ir<gr-1;Ir++){const Fr=Ur+Ir*tr,Pr=Ur+(Ir+1)*tr,Jr=Ur+1+(Ir+1)*tr,zs=Ur+1+Ir*tr;On===!0?(qn.push(Fr,Jr,Pr),qn.push(Jr,Fr,zs)):(qn.push(Fr,Pr,Jr),qn.push(Jr,zs,Fr))}const vr=ln(qn,new Float32BufferAttribute(Jn,3)),_r=ln(qn,new Float32BufferAttribute(Zn,2));let $r,es;if(tn)if(In===!1){for(let Ur=0;Ur<tr-1;Ur++)for(let Ir=0;Ir<gr-1;Ir++){const Fr=Ur+Ir*(tr-1),Pr=tn[Fr*3+0],Jr=tn[Fr*3+1],zs=tn[Fr*3+2];Gn.push(Pr,Jr,zs),Gn.push(Pr,Jr,zs),Gn.push(Pr,Jr,zs),Gn.push(Pr,Jr,zs),Gn.push(Pr,Jr,zs),Gn.push(Pr,Jr,zs)}$r=new Float32BufferAttribute(Gn,3)}else $r=ln(qn,new Float32BufferAttribute(Gn,3));if($t)if(Hn===!1){for(let Ur=0;Ur<tr-1;Ur++)for(let Ir=0;Ir<gr-1;Ir++){const Fr=Ur+Ir*(tr-1),Pr=$t[Fr*3+0],Jr=$t[Fr*3+1],zs=$t[Fr*3+2];pr.push(Pr,Jr,zs),pr.push(Pr,Jr,zs),pr.push(Pr,Jr,zs),pr.push(Pr,Jr,zs),pr.push(Pr,Jr,zs),pr.push(Pr,Jr,zs)}es=new Float32BufferAttribute(pr,3)}else es=ln(qn,new Float32BufferAttribute(pr,3));else es=kn(qn,Jn,Mn);const Hr=new BufferGeometry;return Hr.setAttribute("position",vr),Hr.setAttribute("normal",es),Hr.setAttribute("uv",_r),$r&&Hr.setAttribute("color",$r),Hr._solid=yn,Hr._type="mesh",Hr}function sn($n){let tn=[1,1,1,-1,-1,-1,-1,1,1,1],$t=[0,0,0,0,1,0],An,En,In=!0,Hn=!0,yn=0,On=!0,Mn=!0;const tr=$n.fields;for(let Hr=0,Ur=tr.length;Hr<Ur;Hr++){const Ir=tr[Hr],Fr=Ir.name,Pr=Ir.values;switch(Fr){case"beginCap":In=Pr[0];break;case"ccw":Hn=Pr[0];break;case"convex":break;case"creaseAngle":yn=Pr[0];break;case"crossSection":tn=Pr;break;case"endCap":On=Pr[0];break;case"orientation":En=Pr;break;case"scale":An=Pr;break;case"solid":Mn=Pr[0];break;case"spine":$t=Pr;break;default:console.warn("THREE.VRMLLoader: Unknown field:",Fr);break}}const gr=tn[0]===tn[tn.length-2]&&tn[1]===tn[tn.length-1],Cr=[],Sr=new Vector3,Un=new Vector3,Jn=new Vector3,pr=new Vector3,Gn=new Quaternion;for(let Hr=0,Ur=0,Ir=0,Fr=$t.length;Hr<Fr;Hr+=3,Ur+=2,Ir+=4){Sr.fromArray($t,Hr),Un.x=An?An[Ur+0]:1,Un.y=1,Un.z=An?An[Ur+1]:1,Jn.x=En?En[Ir+0]:0,Jn.y=En?En[Ir+1]:0,Jn.z=En?En[Ir+2]:1;const Pr=En?En[Ir+3]:0;for(let Jr=0,zs=tn.length;Jr<zs;Jr+=2)pr.x=tn[Jr+0],pr.y=0,pr.z=tn[Jr+1],pr.multiply(Un),Gn.setFromAxisAngle(Jn,Pr),pr.applyQuaternion(Gn),pr.add(Sr),Cr.push(pr.x,pr.y,pr.z)}const Zn=[],qn=$t.length/3,vr=tn.length/2;for(let Hr=0;Hr<qn-1;Hr++)for(let Ur=0;Ur<vr-1;Ur++){const Ir=Ur+Hr*vr;let Fr=Ur+1+Hr*vr;const Pr=Ur+(Hr+1)*vr;let Jr=Ur+1+(Hr+1)*vr;Ur===vr-2&&gr===!0&&(Fr=Hr*vr,Jr=(Hr+1)*vr),Hn===!0?(Zn.push(Ir,Fr,Pr),Zn.push(Pr,Fr,Jr)):(Zn.push(Ir,Pr,Fr),Zn.push(Pr,Jr,Fr))}if(In===!0||On===!0){const Hr=[];for(let Fr=0,Pr=tn.length;Fr<Pr;Fr+=2)Hr.push(new Vector2(tn[Fr],tn[Fr+1]));const Ur=ShapeUtils.triangulateShape(Hr,[]),Ir=[];for(let Fr=0,Pr=Ur.length;Fr<Pr;Fr++){const Jr=Ur[Fr];Ir.push(Jr[0],Jr[1],Jr[2])}if(In===!0)for(let Fr=0,Pr=Ir.length;Fr<Pr;Fr+=3)Hn===!0?Zn.push(Ir[Fr+0],Ir[Fr+1],Ir[Fr+2]):Zn.push(Ir[Fr+0],Ir[Fr+2],Ir[Fr+1]);if(On===!0){const Fr=vr*(qn-1);for(let Pr=0,Jr=Ir.length;Pr<Jr;Pr+=3)Hn===!0?Zn.push(Fr+Ir[Pr+0],Fr+Ir[Pr+2],Fr+Ir[Pr+1]):Zn.push(Fr+Ir[Pr+0],Fr+Ir[Pr+1],Fr+Ir[Pr+2])}}const _r=ln(Zn,new Float32BufferAttribute(Cr,3)),$r=kn(Zn,Cr,yn),es=new BufferGeometry;return es.setAttribute("position",_r),es.setAttribute("normal",$r),es._solid=Mn,es._type="mesh",es}function jt($n){const tn=j[$n],$t=it(tn);return $t.isObject3D||$t.isMaterial?$t.clone():$t}function Vt($n,tn){for(let $t=0,An=$n.length;$t<An;$t++){const En=it($n[$t]);En instanceof Object3D&&tn.add(En)}}function Lt($n,tn){const $t=[];let An=0;for(let En=0,In=$n.length;En<In;En++){const Hn=$n[An],yn=$n[En+(tn?1:2)],On=$n[En+(tn?2:1)];$t.push(Hn,yn,On),($n[En+3]===-1||En+3>=In)&&(En+=3,An=En+1)}return $t}function Qt($n,tn){const $t=[];let An=0;for(let En=0,In=tn.length;En<In;En++){const Hn=An*3,yn=$n[Hn],On=$n[Hn+1],Mn=$n[Hn+2];$t.push(yn,On,Mn),(tn[En+3]===-1||En+3>=In)&&(En+=3,An++)}return $t}function nn($n,tn){const $t=[];for(let An=0,En=tn.length;An<En;An++){const Hn=tn[An]*3,yn=$n[Hn],On=$n[Hn+1],Mn=$n[Hn+2];$t.push(yn,On,Mn)}return $t}function mn($n){const tn=[];for(let $t=0,An=$n.length;$t<An;$t++){const En=$n[$t],In=$n[$t+1];tn.push(En,In),($n[$t+2]===-1||$t+2>=An)&&($t+=2)}return tn}function Zt($n,tn){const $t=[];let An=0;for(let En=0,In=tn.length;En<In;En++){const Hn=An*3,yn=$n[Hn],On=$n[Hn+1],Mn=$n[Hn+2];$t.push(yn,On,Mn),(tn[En+2]===-1||En+2>=In)&&(En+=2,An++)}return $t}const cn=new Vector3,Ot=new Vector3,rn=new Vector3,fn=new Vector2,hn=new Vector2,Tn=new Vector2;function Nn($n,tn,$t,An){const En=[];for(let In=0,Hn=$n.length;In<Hn;In+=3){const yn=tn[In],On=tn[In+1],Mn=tn[In+2];An===2?(fn.fromArray($t,yn*An),hn.fromArray($t,On*An),Tn.fromArray($t,Mn*An),En.push(fn.x,fn.y),En.push(hn.x,hn.y),En.push(Tn.x,Tn.y)):(cn.fromArray($t,yn*An),Ot.fromArray($t,On*An),rn.fromArray($t,Mn*An),En.push(cn.x,cn.y,cn.z),En.push(Ot.x,Ot.y,Ot.z),En.push(rn.x,rn.y,rn.z))}return new Float32BufferAttribute(En,An)}function Pn($n,tn){const $t=[];for(let An=0,En=0,In=$n.length;An<In;An+=3,En++)cn.fromArray(tn,En*3),$t.push(cn.x,cn.y,cn.z),$t.push(cn.x,cn.y,cn.z),$t.push(cn.x,cn.y,cn.z);return new Float32BufferAttribute($t,3)}function Dn($n,tn){const $t=[];for(let An=0,En=0,In=$n.length;An<In;An+=2,En++)cn.fromArray(tn,En*3),$t.push(cn.x,cn.y,cn.z),$t.push(cn.x,cn.y,cn.z);return new Float32BufferAttribute($t,3)}function ln($n,tn){const $t=tn.array,An=tn.itemSize,En=new $t.constructor($n.length*An);let In=0,Hn=0;for(let yn=0,On=$n.length;yn<On;yn++){In=$n[yn]*An;for(let Mn=0;Mn<An;Mn++)En[Hn++]=$t[In++]}return new Float32BufferAttribute(En,An)}const Cn=new Vector3,bn=new Vector3;function kn($n,tn,$t){const An=[],En={};for(let Hn=0,yn=$n.length;Hn<yn;Hn+=3){const On=$n[Hn],Mn=$n[Hn+1],tr=$n[Hn+2],gr=new Face(On,Mn,tr);cn.fromArray(tn,On*3),Ot.fromArray(tn,Mn*3),rn.fromArray(tn,tr*3),bn.subVectors(rn,Ot),Cn.subVectors(cn,Ot),bn.cross(Cn),bn.normalize(),gr.normal.copy(bn),En[On]===void 0&&(En[On]=[]),En[Mn]===void 0&&(En[Mn]=[]),En[tr]===void 0&&(En[tr]=[]),En[On].push(gr.normal),En[Mn].push(gr.normal),En[tr].push(gr.normal),An.push(gr)}const In=[];for(let Hn=0,yn=An.length;Hn<yn;Hn++){const On=An[Hn],Mn=Sn(En[On.a],On.normal,$t),tr=Sn(En[On.b],On.normal,$t),gr=Sn(En[On.c],On.normal,$t);cn.fromArray(tn,On.a*3),Ot.fromArray(tn,On.b*3),rn.fromArray(tn,On.c*3),In.push(Mn.x,Mn.y,Mn.z),In.push(tr.x,tr.y,tr.z),In.push(gr.x,gr.y,gr.z)}return new Float32BufferAttribute(In,3)}function Sn($n,tn,$t){const An=new Vector3;if($t===0)An.copy(tn);else for(let En=0,In=$n.length;En<In;En++)$n[En].angleTo(tn)<$t&&An.add($n[En]);return An.normalize()}function xn($n){const tn=[];for(let $t=0,An=$n.length;$t<An;$t+=3)tn.push(new Color($n[$t],$n[$t+1],$n[$t+2]));return tn}function Qn($n,tn,$t,An,En){const In=[],Hn=En===!0?0:Math.PI;for(let Cr=0,Sr=An.length;Cr<Sr;Cr++){let Un=Cr===0?0:$t[Cr-1];Un=En===!0?Un:Hn-Un;const Jn=new Vector3;Jn.setFromSphericalCoords(tn,Un,0),In.push(Jn)}const yn=$n.index,On=$n.attributes.position,Mn=new BufferAttribute(new Float32Array($n.attributes.position.count*3),3),tr=new Vector3,gr=new Color;for(let Cr=0;Cr<yn.count;Cr++){const Sr=yn.getX(Cr);tr.fromBufferAttribute(On,Sr);let Un,Jn,pr=1;for(let qn=1;qn<In.length;qn++){Un=qn-1,Jn=qn;const vr=In[Un],_r=In[Jn];if(En===!0){if(tr.y<=vr.y&&tr.y>_r.y){pr=Math.abs(vr.y-tr.y)/Math.abs(vr.y-_r.y);break}}else if(tr.y>=vr.y&&tr.y<_r.y){pr=Math.abs(vr.y-tr.y)/Math.abs(vr.y-_r.y);break}}const Gn=An[Un],Zn=An[Jn];gr.copy(Gn).lerp(Zn,pr),Mn.setXYZ(Sr,gr.r,gr.g,gr.b)}$n.setAttribute("color",Mn)}const nr=new TextureLoader(this.manager);if(nr.setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin),s.indexOf("#VRML V2.0")===-1)throw Error("THREE.VRMLLexer: Version of VRML asset not supported.");const or=$(s);return nt(or)}}class VRMLLexer{constructor(s){this.lexer=new Lexer(s)}lex(s){const o=this.lexer.tokenize(s);if(o.errors.length>0)throw console.error(o.errors),Error("THREE.VRMLLexer: Lexing errors detected.");return o}}class VRMLParser extends CstParser{constructor(s){super(s);const o=this,j=s.Version,$=s.LCurly,_e=s.RCurly,tt=s.LSquare,nt=s.RSquare,rt=s.Identifier,it=s.RouteIdentifier,st=s.StringLiteral,at=s.HexLiteral,ot=s.NumberLiteral,ct=s.TrueLiteral,ft=s.FalseLiteral,ht=s.NullLiteral,mt=s.DEF,lt=s.USE,ut=s.ROUTE,dt=s.TO,gt=s.NodeName;o.RULE("vrml",function(){o.SUBRULE(o.version),o.AT_LEAST_ONE(function(){o.SUBRULE(o.node)}),o.MANY(function(){o.SUBRULE(o.route)})}),o.RULE("version",function(){o.CONSUME(j)}),o.RULE("node",function(){o.OPTION(function(){o.SUBRULE(o.def)}),o.CONSUME(gt),o.CONSUME($),o.MANY(function(){o.SUBRULE(o.field)}),o.CONSUME(_e)}),o.RULE("field",function(){o.CONSUME(rt),o.OR2([{ALT:function(){o.SUBRULE(o.singleFieldValue)}},{ALT:function(){o.SUBRULE(o.multiFieldValue)}}])}),o.RULE("def",function(){o.CONSUME(mt),o.OR([{ALT:function(){o.CONSUME(rt)}},{ALT:function(){o.CONSUME(gt)}}])}),o.RULE("use",function(){o.CONSUME(lt),o.OR([{ALT:function(){o.CONSUME(rt)}},{ALT:function(){o.CONSUME(gt)}}])}),o.RULE("singleFieldValue",function(){o.AT_LEAST_ONE(function(){o.OR([{ALT:function(){o.SUBRULE(o.node)}},{ALT:function(){o.SUBRULE(o.use)}},{ALT:function(){o.CONSUME(st)}},{ALT:function(){o.CONSUME(at)}},{ALT:function(){o.CONSUME(ot)}},{ALT:function(){o.CONSUME(ct)}},{ALT:function(){o.CONSUME(ft)}},{ALT:function(){o.CONSUME(ht)}}])})}),o.RULE("multiFieldValue",function(){o.CONSUME(tt),o.MANY(function(){o.OR([{ALT:function(){o.SUBRULE(o.node)}},{ALT:function(){o.SUBRULE(o.use)}},{ALT:function(){o.CONSUME(st)}},{ALT:function(){o.CONSUME(at)}},{ALT:function(){o.CONSUME(ot)}},{ALT:function(){o.CONSUME(ht)}}])}),o.CONSUME(nt)}),o.RULE("route",function(){o.CONSUME(ut),o.CONSUME(it),o.CONSUME(dt),o.CONSUME2(it)}),this.performSelfAnalysis()}}class Face{constructor(s,o,j){this.a=s,this.b=o,this.c=j,this.normal=new Vector3}}const TEXTURE_TYPE={INTENSITY:1,INTENSITY_ALPHA:2,RGB:3,RGBA:4};class WorkerPool{constructor(s=4){this.pool=s,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(s){if(!this.workers[s]){const o=this.workerCreator();o.addEventListener("message",this._onMessage.bind(this,s)),this.workers[s]=o}}_getIdleWorker(){for(let s=0;s<this.pool;s++)if(!(this.workerStatus&1<<s))return s;return-1}_onMessage(s,o){const j=this.workersResolve[s];if(j&&j(o),this.queue.length){const{resolve:$,msg:_e,transfer:tt}=this.queue.shift();this.workersResolve[s]=$,this.workers[s].postMessage(_e,tt)}else this.workerStatus^=1<<s}setWorkerCreator(s){this.workerCreator=s}setWorkerLimit(s){this.pool=s}postMessage(s,o){return new Promise(j=>{const $=this._getIdleWorker();$!==-1?(this._initWorker($),this.workerStatus|=1<<$,this.workersResolve[$]=j,this.workers[$].postMessage(s,o)):this.queue.push({resolve:j,msg:s,transfer:o})})}dispose(){this.workers.forEach(s=>s.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const KHR_SUPERCOMPRESSION_NONE=0,KHR_SUPERCOMPRESSION_ZSTD=2,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT=0,KHR_DF_VENDORID_KHRONOS=0,KHR_DF_VERSION=2,KHR_DF_MODEL_UNSPECIFIED=0,KHR_DF_FLAG_ALPHA_STRAIGHT=0,KHR_DF_FLAG_ALPHA_PREMULTIPLIED=1,KHR_DF_TRANSFER_SRGB=2,KHR_DF_PRIMARIES_BT709=1,KHR_DF_SAMPLE_DATATYPE_SIGNED=64,VK_FORMAT_UNDEFINED=0,VK_FORMAT_R8_UNORM=9,VK_FORMAT_R8_SRGB=15,VK_FORMAT_R8G8_UNORM=16,VK_FORMAT_R8G8_SRGB=22,VK_FORMAT_R8G8B8A8_UNORM=37,VK_FORMAT_R8G8B8A8_SRGB=43,VK_FORMAT_R16_SFLOAT=76,VK_FORMAT_R16G16_SFLOAT=83,VK_FORMAT_R16G16B16A16_SFLOAT=97,VK_FORMAT_R32_SFLOAT=100,VK_FORMAT_R32G32_SFLOAT=103,VK_FORMAT_R32G32B32A32_SFLOAT=109;class KTX2Container{constructor(){this.vkFormat=VK_FORMAT_UNDEFINED,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=KHR_SUPERCOMPRESSION_NONE,this.levels=[],this.dataFormatDescriptor=[{vendorId:KHR_DF_VENDORID_KHRONOS,descriptorType:KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT,descriptorBlockSize:0,versionNumber:KHR_DF_VERSION,colorModel:KHR_DF_MODEL_UNSPECIFIED,colorPrimaries:KHR_DF_PRIMARIES_BT709,transferFunction:KHR_DF_TRANSFER_SRGB,flags:KHR_DF_FLAG_ALPHA_STRAIGHT,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class BufferReader{constructor(s,o,j,$){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(s.buffer,s.byteOffset+o,j),this._littleEndian=$,this._offset=0}_nextUint8(){const s=this._dataView.getUint8(this._offset);return this._offset+=1,s}_nextUint16(){const s=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,s}_nextUint32(){const s=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,s}_nextUint64(){const s=this._dataView.getUint32(this._offset,this._littleEndian),o=this._dataView.getUint32(this._offset+4,this._littleEndian),j=s+2**32*o;return this._offset+=8,j}_nextInt32(){const s=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,s}_nextUint8Array(s){const o=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,s);return this._offset+=s,o}_skip(s){return this._offset+=s,this}_scan(s,o){o===void 0&&(o=0);const j=this._offset;let $=0;for(;this._dataView.getUint8(this._offset)!==o&&$<s;)$++,this._offset++;return $<s&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+j,$)}}const KTX2_ID=[171,75,84,88,32,50,48,187,13,10,26,10];function decodeText(a){return typeof TextDecoder<"u"?new TextDecoder().decode(a):Buffer.from(a).toString("utf8")}function read(a){const s=new Uint8Array(a.buffer,a.byteOffset,KTX2_ID.length);if(s[0]!==KTX2_ID[0]||s[1]!==KTX2_ID[1]||s[2]!==KTX2_ID[2]||s[3]!==KTX2_ID[3]||s[4]!==KTX2_ID[4]||s[5]!==KTX2_ID[5]||s[6]!==KTX2_ID[6]||s[7]!==KTX2_ID[7]||s[8]!==KTX2_ID[8]||s[9]!==KTX2_ID[9]||s[10]!==KTX2_ID[10]||s[11]!==KTX2_ID[11])throw new Error("Missing KTX 2.0 identifier.");const o=new KTX2Container,j=17*Uint32Array.BYTES_PER_ELEMENT,$=new BufferReader(a,KTX2_ID.length,j,!0);o.vkFormat=$._nextUint32(),o.typeSize=$._nextUint32(),o.pixelWidth=$._nextUint32(),o.pixelHeight=$._nextUint32(),o.pixelDepth=$._nextUint32(),o.layerCount=$._nextUint32(),o.faceCount=$._nextUint32();const _e=$._nextUint32();o.supercompressionScheme=$._nextUint32();const tt=$._nextUint32(),nt=$._nextUint32(),rt=$._nextUint32(),it=$._nextUint32(),st=$._nextUint64(),at=$._nextUint64(),ot=_e*3*8,ct=new BufferReader(a,KTX2_ID.length+j,ot,!0);for(let nn=0;nn<_e;nn++)o.levels.push({levelData:new Uint8Array(a.buffer,a.byteOffset+ct._nextUint64(),ct._nextUint64()),uncompressedByteLength:ct._nextUint64()});const ft=new BufferReader(a,tt,nt,!0),ht={vendorId:ft._skip(4)._nextUint16(),descriptorType:ft._nextUint16(),versionNumber:ft._nextUint16(),descriptorBlockSize:ft._nextUint16(),colorModel:ft._nextUint8(),colorPrimaries:ft._nextUint8(),transferFunction:ft._nextUint8(),flags:ft._nextUint8(),texelBlockDimension:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],bytesPlane:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],samples:[]},mt=6,lt=4,ut=(ht.descriptorBlockSize/4-mt)/lt;for(let nn=0;nn<ut;nn++){const mn={bitOffset:ft._nextUint16(),bitLength:ft._nextUint8(),channelType:ft._nextUint8(),samplePosition:[ft._nextUint8(),ft._nextUint8(),ft._nextUint8(),ft._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};mn.channelType&KHR_DF_SAMPLE_DATATYPE_SIGNED?(mn.sampleLower=ft._nextInt32(),mn.sampleUpper=ft._nextInt32()):(mn.sampleLower=ft._nextUint32(),mn.sampleUpper=ft._nextUint32()),ht.samples[nn]=mn}o.dataFormatDescriptor.length=0,o.dataFormatDescriptor.push(ht);const dt=new BufferReader(a,rt,it,!0);for(;dt._offset<it;){const nn=dt._nextUint32(),mn=dt._scan(nn),Zt=decodeText(mn);if(o.keyValue[Zt]=dt._nextUint8Array(nn-mn.byteLength-1),Zt.match(/^ktx/i)){const Ot=decodeText(o.keyValue[Zt]);o.keyValue[Zt]=Ot.substring(0,Ot.lastIndexOf("\0"))}const cn=nn%4?4-nn%4:0;dt._skip(cn)}if(at<=0)return o;const gt=new BufferReader(a,st,at,!0),Et=gt._nextUint16(),St=gt._nextUint16(),Tt=gt._nextUint32(),Mt=gt._nextUint32(),Bt=gt._nextUint32(),Rt=gt._nextUint32(),Ut=[];for(let nn=0;nn<_e;nn++)Ut.push({imageFlags:gt._nextUint32(),rgbSliceByteOffset:gt._nextUint32(),rgbSliceByteLength:gt._nextUint32(),alphaSliceByteOffset:gt._nextUint32(),alphaSliceByteLength:gt._nextUint32()});const Ht=st+gt._offset,Wt=Ht+Tt,Jt=Wt+Mt,sn=Jt+Bt,jt=new Uint8Array(a.buffer,a.byteOffset+Ht,Tt),Vt=new Uint8Array(a.buffer,a.byteOffset+Wt,Mt),Lt=new Uint8Array(a.buffer,a.byteOffset+Jt,Bt),Qt=new Uint8Array(a.buffer,a.byteOffset+sn,Rt);return o.globalData={endpointCount:Et,selectorCount:St,imageDescs:Ut,endpointsData:jt,selectorsData:Vt,tablesData:Lt,extendedData:Qt},o}let init$1,instance,heap;const IMPORT_OBJECT={env:{emscripten_notify_memory_growth:function(a){heap=new Uint8Array(instance.exports.memory.buffer)}}};class ZSTDDecoder{init(){return init$1||(typeof fetch<"u"?init$1=fetch("data:application/wasm;base64,"+wasm).then(s=>s.arrayBuffer()).then(s=>WebAssembly.instantiate(s,IMPORT_OBJECT)).then(this._init):init$1=WebAssembly.instantiate(Buffer.from(wasm,"base64"),IMPORT_OBJECT).then(this._init),init$1)}_init(s){instance=s.instance,IMPORT_OBJECT.env.emscripten_notify_memory_growth(0)}decode(s,o=0){if(!instance)throw new Error("ZSTDDecoder: Await .init() before decoding.");const j=s.byteLength,$=instance.exports.malloc(j);heap.set(s,$),o=o||Number(instance.exports.ZSTD_findDecompressedSize($,j));const _e=instance.exports.malloc(o),tt=instance.exports.ZSTD_decompress(_e,o,$,j),nt=heap.slice(_e,_e+tt);return instance.exports.free($),instance.exports.free(_e),nt}}const wasm="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";class CompressedArrayTexture extends CompressedTexture{constructor(s,o,j,$,_e,tt){super(s,o,j,_e,tt),this.isCompressedArrayTexture=!0,this.image.depth=$,this.wrapR=ClampToEdgeWrapping}}const _taskCache$3=new WeakMap;let _activeLoaders=0,_zstd;const _KTX2Loader=class extends Loader{constructor(a){super(a),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(a){return this.transcoderPath=a,this}setWorkerLimit(a){return this.workerPool.setWorkerLimit(a),this}detectSupport(a){return this.workerConfig={astcSupported:a.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:a.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:a.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:a.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:a.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:a.extensions.has("WEBGL_compressed_texture_pvrtc")||a.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},a.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const a=new FileLoader(this.manager);a.setPath(this.transcoderPath),a.setWithCredentials(this.withCredentials);const s=a.loadAsync("basis_transcoder.js"),o=new FileLoader(this.manager);o.setPath(this.transcoderPath),o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials);const j=o.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([s,j]).then(([$,_e])=>{const tt=_KTX2Loader.BasisWorker.toString(),nt=["/* constants */","let _EngineFormat = "+JSON.stringify(_KTX2Loader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_KTX2Loader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_KTX2Loader.BasisFormat),"/* basis_transcoder.js */",$,"/* worker */",tt.substring(tt.indexOf("{")+1,tt.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([nt])),this.transcoderBinary=_e,this.workerPool.setWorkerCreator(()=>{const rt=new Worker(this.workerSourceURL),it=this.transcoderBinary.slice(0);return rt.postMessage({type:"init",config:this.workerConfig,transcoderBinary:it},[it]),rt})}),_activeLoaders>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),_activeLoaders++}return this.transcoderPending}load(a,s,o,j){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const $=new FileLoader(this.manager);$.setResponseType("arraybuffer"),$.setWithCredentials(this.withCredentials),$.load(a,_e=>{if(_taskCache$3.has(_e))return _taskCache$3.get(_e).promise.then(s).catch(j);this._createTexture(_e).then(tt=>s?s(tt):null).catch(j)},o,j)}_createTextureFrom(a,s){const{mipmaps:o,width:j,height:$,format:_e,type:tt,error:nt,dfdTransferFn:rt,dfdFlags:it}=a;if(tt==="error")return Promise.reject(nt);const st=s.layerCount>1?new CompressedArrayTexture(o,j,$,s.layerCount,_e,UnsignedByteType):new CompressedTexture(o,j,$,_e,UnsignedByteType);return st.minFilter=o.length===1?LinearFilter:LinearMipmapLinearFilter,st.magFilter=LinearFilter,st.generateMipmaps=!1,st.needsUpdate=!0,"colorSpace"in st?st.colorSpace=rt===KHR_DF_TRANSFER_SRGB?"srgb":"srgb-linear":st.encoding=rt===KHR_DF_TRANSFER_SRGB?3001:3e3,st.premultiplyAlpha=!!(it&KHR_DF_FLAG_ALPHA_PREMULTIPLIED),st}async _createTexture(a,s={}){const o=read(new Uint8Array(a));if(o.vkFormat!==VK_FORMAT_UNDEFINED)return createDataTexture(o);const j=s,$=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:a,taskConfig:j},[a])).then(_e=>this._createTextureFrom(_e.data,o));return _taskCache$3.set(a,{promise:$}),$}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),_activeLoaders--,this}};let KTX2Loader=_KTX2Loader;const FORMAT_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:RGBAFormat,[VK_FORMAT_R16G16B16A16_SFLOAT]:RGBAFormat,[VK_FORMAT_R8G8B8A8_UNORM]:RGBAFormat,[VK_FORMAT_R8G8B8A8_SRGB]:RGBAFormat,[VK_FORMAT_R32G32_SFLOAT]:RGFormat,[VK_FORMAT_R16G16_SFLOAT]:RGFormat,[VK_FORMAT_R8G8_UNORM]:RGFormat,[VK_FORMAT_R8G8_SRGB]:RGFormat,[VK_FORMAT_R32_SFLOAT]:RedFormat,[VK_FORMAT_R16_SFLOAT]:RedFormat,[VK_FORMAT_R8_SRGB]:RedFormat,[VK_FORMAT_R8_UNORM]:RedFormat},TYPE_MAP={[VK_FORMAT_R32G32B32A32_SFLOAT]:FloatType,[VK_FORMAT_R16G16B16A16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8B8A8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8B8A8_SRGB]:UnsignedByteType,[VK_FORMAT_R32G32_SFLOAT]:FloatType,[VK_FORMAT_R16G16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8G8_UNORM]:UnsignedByteType,[VK_FORMAT_R8G8_SRGB]:UnsignedByteType,[VK_FORMAT_R32_SFLOAT]:FloatType,[VK_FORMAT_R16_SFLOAT]:HalfFloatType,[VK_FORMAT_R8_SRGB]:UnsignedByteType,[VK_FORMAT_R8_UNORM]:UnsignedByteType},ENCODING_MAP={[VK_FORMAT_R8G8B8A8_SRGB]:3001,[VK_FORMAT_R8G8_SRGB]:3001,[VK_FORMAT_R8_SRGB]:3001};async function createDataTexture(a){const{vkFormat:s,pixelWidth:o,pixelHeight:j,pixelDepth:$}=a;if(FORMAT_MAP[s]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const _e=a.levels[0];let tt,nt;if(a.supercompressionScheme===KHR_SUPERCOMPRESSION_NONE)tt=_e.levelData;else if(a.supercompressionScheme===KHR_SUPERCOMPRESSION_ZSTD)_zstd||(_zstd=new Promise(async it=>{const st=new ZSTDDecoder;await st.init(),it(st)})),tt=(await _zstd).decode(_e.levelData,_e.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");TYPE_MAP[s]===FloatType?nt=new Float32Array(tt.buffer,tt.byteOffset,tt.byteLength/Float32Array.BYTES_PER_ELEMENT):TYPE_MAP[s]===HalfFloatType?nt=new Uint16Array(tt.buffer,tt.byteOffset,tt.byteLength/Uint16Array.BYTES_PER_ELEMENT):nt=tt;const rt=$===0?new DataTexture(nt,o,j):new Data3DTexture(nt,o,j,$);return rt.type=TYPE_MAP[s],rt.format=FORMAT_MAP[s],rt.encoding=ENCODING_MAP[s]||3e3,rt.needsUpdate=!0,Promise.resolve(rt)}const lottie=(()=>{if(typeof navigator>"u"||typeof document>"u")return{};const svgNS="http://www.w3.org/2000/svg";let locationHref="",_useWebWorker=!1;const initialDefaultFrame=-999999,setWebWorker=a=>{_useWebWorker=!!a},getWebWorker=()=>_useWebWorker,setLocationHref=a=>{locationHref=a},getLocationHref=()=>locationHref;function createTag(a){return document.createElement(a)}function extendPrototype(a,s){var o,j=a.length,$;for(o=0;o<j;o+=1){$=a[o].prototype;for(var _e in $)Object.prototype.hasOwnProperty.call($,_e)&&(s.prototype[_e]=$[_e])}}function getDescriptor(a,s){return Object.getOwnPropertyDescriptor(a,s)}function createProxyFunction(a){function s(){}return s.prototype=a,s}const audioControllerFactory=function(){function a(s){this.audios=[],this.audioFactory=s,this._volume=1,this._isMuted=!1}return a.prototype={addAudio:function(s){this.audios.push(s)},pause:function(){var s,o=this.audios.length;for(s=0;s<o;s+=1)this.audios[s].pause()},resume:function(){var s,o=this.audios.length;for(s=0;s<o;s+=1)this.audios[s].resume()},setRate:function(s){var o,j=this.audios.length;for(o=0;o<j;o+=1)this.audios[o].setRate(s)},createAudio:function(s){return this.audioFactory?this.audioFactory(s):window.Howl?new window.Howl({src:[s]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(s){this.audioFactory=s},setVolume:function(s){this._volume=s,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var s,o=this.audios.length;for(s=0;s<o;s+=1)this.audios[s].volume(this._volume*(this._isMuted?0:1))}},function(){return new a}}(),createTypedArray=function(){function a(o,j){var $=0,_e=[],tt;switch(o){case"int16":case"uint8c":tt=1;break;default:tt=1.1;break}for($=0;$<j;$+=1)_e.push(tt);return _e}function s(o,j){return o==="float32"?new Float32Array(j):o==="int16"?new Int16Array(j):o==="uint8c"?new Uint8ClampedArray(j):a(o,j)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?s:a}();function createSizedArray(a){return Array.apply(null,{length:a})}let subframeEnabled=!0,expressionsPlugin=null,idPrefix$1="";const isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMin=Math.min,BMMath={};(function(){var a=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],s,o=a.length;for(s=0;s<o;s+=1)BMMath[a[s]]=Math[a[s]]})(),BMMath.random=Math.random,BMMath.abs=function(a){var s=typeof a;if(s==="object"&&a.length){var o=createSizedArray(a.length),j,$=a.length;for(j=0;j<$;j+=1)o[j]=Math.abs(a[j]);return o}return Math.abs(a)};let defaultCurveSegments=150;const degToRads=Math.PI/180,roundCorner=.5519;function BMEnterFrameEvent(a,s,o,j){this.type=a,this.currentTime=s,this.totalTime=o,this.direction=j<0?-1:1}function BMCompleteEvent(a,s){this.type=a,this.direction=s<0?-1:1}function BMCompleteLoopEvent(a,s,o,j){this.type=a,this.currentLoop=o,this.totalLoops=s,this.direction=j<0?-1:1}function BMSegmentStartEvent(a,s,o){this.type=a,this.firstFrame=s,this.totalFrames=o}function BMDestroyEvent(a,s){this.type=a,this.target=s}function BMRenderFrameErrorEvent(a,s){this.type="renderFrameError",this.nativeError=a,this.currentTime=s}function BMConfigErrorEvent(a){this.type="configError",this.nativeError=a}const createElementID=function(){var a=0;return function(){return a+=1,idPrefix$1+"__lottie_element_"+a}}();function HSVtoRGB(a,s,o){var j,$,_e,tt,nt,rt,it,st;switch(tt=Math.floor(a*6),nt=a*6-tt,rt=o*(1-s),it=o*(1-nt*s),st=o*(1-(1-nt)*s),tt%6){case 0:j=o,$=st,_e=rt;break;case 1:j=it,$=o,_e=rt;break;case 2:j=rt,$=o,_e=st;break;case 3:j=rt,$=it,_e=o;break;case 4:j=st,$=rt,_e=o;break;case 5:j=o,$=rt,_e=it;break}return[j,$,_e]}function RGBtoHSV(a,s,o){var j=Math.max(a,s,o),$=Math.min(a,s,o),_e=j-$,tt,nt=j===0?0:_e/j,rt=j/255;switch(j){case $:tt=0;break;case a:tt=s-o+_e*(s<o?6:0),tt/=6*_e;break;case s:tt=o-a+_e*2,tt/=6*_e;break;case o:tt=a-s+_e*4,tt/=6*_e;break}return[tt,nt,rt]}function addSaturationToRGB(a,s){var o=RGBtoHSV(a[0]*255,a[1]*255,a[2]*255);return o[1]+=s,o[1]>1?o[1]=1:o[1]<=0&&(o[1]=0),HSVtoRGB(o[0],o[1],o[2])}function addBrightnessToRGB(a,s){var o=RGBtoHSV(a[0]*255,a[1]*255,a[2]*255);return o[2]+=s,o[2]>1?o[2]=1:o[2]<0&&(o[2]=0),HSVtoRGB(o[0],o[1],o[2])}function addHueToRGB(a,s){var o=RGBtoHSV(a[0]*255,a[1]*255,a[2]*255);return o[0]+=s/360,o[0]>1?o[0]-=1:o[0]<0&&(o[0]+=1),HSVtoRGB(o[0],o[1],o[2])}(function(){var a=[],s,o;for(s=0;s<256;s+=1)o=s.toString(16),a[s]=o.length===1?"0"+o:o;return function(j,$,_e){return j<0&&(j=0),$<0&&($=0),_e<0&&(_e=0),"#"+a[j]+a[$]+a[_e]}})();const setSubframeEnabled=a=>{subframeEnabled=!!a},getSubframeEnabled=()=>subframeEnabled,setExpressionsPlugin=a=>{expressionsPlugin=a},getExpressionsPlugin=()=>expressionsPlugin,setDefaultCurveSegments=a=>{defaultCurveSegments=a},getDefaultCurveSegments=()=>defaultCurveSegments,setIdPrefix=a=>{idPrefix$1=a};function createNS(a){return document.createElementNS(svgNS,a)}const dataManager=function(){var a=1,s=[],o,j,$={onmessage:function(){},postMessage:function(ot){o({data:ot})}},_e={postMessage:function(ot){$.onmessage({data:ot})}};function tt(ot){if(window.Worker&&window.Blob&&getWebWorker()){var ct=new Blob(["var _workerSelf = self; self.onmessage = ",ot.toString()],{type:"text/javascript"}),ft=URL.createObjectURL(ct);return new Worker(ft)}return o=ot,$}function nt(){j||(j=tt(function(ct){function ft(){function mt(sn,jt){var Vt,Lt,Qt=sn.length,nn,mn,Zt,cn;for(Lt=0;Lt<Qt;Lt+=1)if(Vt=sn[Lt],"ks"in Vt&&!Vt.completed){if(Vt.completed=!0,Vt.tt&&(sn[Lt-1].td=Vt.tt),Vt.hasMask){var Ot=Vt.masksProperties;for(mn=Ot.length,nn=0;nn<mn;nn+=1)if(Ot[nn].pt.k.i)Et(Ot[nn].pt.k);else for(cn=Ot[nn].pt.k.length,Zt=0;Zt<cn;Zt+=1)Ot[nn].pt.k[Zt].s&&Et(Ot[nn].pt.k[Zt].s[0]),Ot[nn].pt.k[Zt].e&&Et(Ot[nn].pt.k[Zt].e[0])}Vt.ty===0?(Vt.layers=dt(Vt.refId,jt),mt(Vt.layers,jt)):Vt.ty===4?gt(Vt.shapes):Vt.ty===5&&Wt(Vt)}}function lt(sn,jt){if(sn){var Vt=0,Lt=sn.length;for(Vt=0;Vt<Lt;Vt+=1)sn[Vt].t===1&&(sn[Vt].data.layers=dt(sn[Vt].data.refId,jt),mt(sn[Vt].data.layers,jt))}}function ut(sn,jt){for(var Vt=0,Lt=jt.length;Vt<Lt;){if(jt[Vt].id===sn)return jt[Vt];Vt+=1}return null}function dt(sn,jt){var Vt=ut(sn,jt);return Vt?Vt.layers.__used?JSON.parse(JSON.stringify(Vt.layers)):(Vt.layers.__used=!0,Vt.layers):null}function gt(sn){var jt,Vt=sn.length,Lt,Qt;for(jt=Vt-1;jt>=0;jt-=1)if(sn[jt].ty==="sh")if(sn[jt].ks.k.i)Et(sn[jt].ks.k);else for(Qt=sn[jt].ks.k.length,Lt=0;Lt<Qt;Lt+=1)sn[jt].ks.k[Lt].s&&Et(sn[jt].ks.k[Lt].s[0]),sn[jt].ks.k[Lt].e&&Et(sn[jt].ks.k[Lt].e[0]);else sn[jt].ty==="gr"&&gt(sn[jt].it)}function Et(sn){var jt,Vt=sn.i.length;for(jt=0;jt<Vt;jt+=1)sn.i[jt][0]+=sn.v[jt][0],sn.i[jt][1]+=sn.v[jt][1],sn.o[jt][0]+=sn.v[jt][0],sn.o[jt][1]+=sn.v[jt][1]}function St(sn,jt){var Vt=jt?jt.split("."):[100,100,100];return sn[0]>Vt[0]?!0:Vt[0]>sn[0]?!1:sn[1]>Vt[1]?!0:Vt[1]>sn[1]?!1:sn[2]>Vt[2]?!0:Vt[2]>sn[2]?!1:null}var Tt=function(){var sn=[4,4,14];function jt(Lt){var Qt=Lt.t.d;Lt.t.d={k:[{s:Qt,t:0}]}}function Vt(Lt){var Qt,nn=Lt.length;for(Qt=0;Qt<nn;Qt+=1)Lt[Qt].ty===5&&jt(Lt[Qt])}return function(Lt){if(St(sn,Lt.v)&&(Vt(Lt.layers),Lt.assets)){var Qt,nn=Lt.assets.length;for(Qt=0;Qt<nn;Qt+=1)Lt.assets[Qt].layers&&Vt(Lt.assets[Qt].layers)}}}(),Mt=function(){var sn=[4,7,99];return function(jt){if(jt.chars&&!St(sn,jt.v)){var Vt,Lt=jt.chars.length;for(Vt=0;Vt<Lt;Vt+=1){var Qt=jt.chars[Vt];Qt.data&&Qt.data.shapes&&(gt(Qt.data.shapes),Qt.data.ip=0,Qt.data.op=99999,Qt.data.st=0,Qt.data.sr=1,Qt.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},jt.chars[Vt].t||(Qt.data.shapes.push({ty:"no"}),Qt.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),Bt=function(){var sn=[5,7,15];function jt(Lt){var Qt=Lt.t.p;typeof Qt.a=="number"&&(Qt.a={a:0,k:Qt.a}),typeof Qt.p=="number"&&(Qt.p={a:0,k:Qt.p}),typeof Qt.r=="number"&&(Qt.r={a:0,k:Qt.r})}function Vt(Lt){var Qt,nn=Lt.length;for(Qt=0;Qt<nn;Qt+=1)Lt[Qt].ty===5&&jt(Lt[Qt])}return function(Lt){if(St(sn,Lt.v)&&(Vt(Lt.layers),Lt.assets)){var Qt,nn=Lt.assets.length;for(Qt=0;Qt<nn;Qt+=1)Lt.assets[Qt].layers&&Vt(Lt.assets[Qt].layers)}}}(),Rt=function(){var sn=[4,1,9];function jt(Lt){var Qt,nn=Lt.length,mn,Zt;for(Qt=0;Qt<nn;Qt+=1)if(Lt[Qt].ty==="gr")jt(Lt[Qt].it);else if(Lt[Qt].ty==="fl"||Lt[Qt].ty==="st")if(Lt[Qt].c.k&&Lt[Qt].c.k[0].i)for(Zt=Lt[Qt].c.k.length,mn=0;mn<Zt;mn+=1)Lt[Qt].c.k[mn].s&&(Lt[Qt].c.k[mn].s[0]/=255,Lt[Qt].c.k[mn].s[1]/=255,Lt[Qt].c.k[mn].s[2]/=255,Lt[Qt].c.k[mn].s[3]/=255),Lt[Qt].c.k[mn].e&&(Lt[Qt].c.k[mn].e[0]/=255,Lt[Qt].c.k[mn].e[1]/=255,Lt[Qt].c.k[mn].e[2]/=255,Lt[Qt].c.k[mn].e[3]/=255);else Lt[Qt].c.k[0]/=255,Lt[Qt].c.k[1]/=255,Lt[Qt].c.k[2]/=255,Lt[Qt].c.k[3]/=255}function Vt(Lt){var Qt,nn=Lt.length;for(Qt=0;Qt<nn;Qt+=1)Lt[Qt].ty===4&&jt(Lt[Qt].shapes)}return function(Lt){if(St(sn,Lt.v)&&(Vt(Lt.layers),Lt.assets)){var Qt,nn=Lt.assets.length;for(Qt=0;Qt<nn;Qt+=1)Lt.assets[Qt].layers&&Vt(Lt.assets[Qt].layers)}}}(),Ut=function(){var sn=[4,4,18];function jt(Lt){var Qt,nn=Lt.length,mn,Zt;for(Qt=nn-1;Qt>=0;Qt-=1)if(Lt[Qt].ty==="sh")if(Lt[Qt].ks.k.i)Lt[Qt].ks.k.c=Lt[Qt].closed;else for(Zt=Lt[Qt].ks.k.length,mn=0;mn<Zt;mn+=1)Lt[Qt].ks.k[mn].s&&(Lt[Qt].ks.k[mn].s[0].c=Lt[Qt].closed),Lt[Qt].ks.k[mn].e&&(Lt[Qt].ks.k[mn].e[0].c=Lt[Qt].closed);else Lt[Qt].ty==="gr"&&jt(Lt[Qt].it)}function Vt(Lt){var Qt,nn,mn=Lt.length,Zt,cn,Ot,rn;for(nn=0;nn<mn;nn+=1){if(Qt=Lt[nn],Qt.hasMask){var fn=Qt.masksProperties;for(cn=fn.length,Zt=0;Zt<cn;Zt+=1)if(fn[Zt].pt.k.i)fn[Zt].pt.k.c=fn[Zt].cl;else for(rn=fn[Zt].pt.k.length,Ot=0;Ot<rn;Ot+=1)fn[Zt].pt.k[Ot].s&&(fn[Zt].pt.k[Ot].s[0].c=fn[Zt].cl),fn[Zt].pt.k[Ot].e&&(fn[Zt].pt.k[Ot].e[0].c=fn[Zt].cl)}Qt.ty===4&&jt(Qt.shapes)}}return function(Lt){if(St(sn,Lt.v)&&(Vt(Lt.layers),Lt.assets)){var Qt,nn=Lt.assets.length;for(Qt=0;Qt<nn;Qt+=1)Lt.assets[Qt].layers&&Vt(Lt.assets[Qt].layers)}}}();function Ht(sn){sn.__complete||(Rt(sn),Tt(sn),Mt(sn),Bt(sn),Ut(sn),mt(sn.layers,sn.assets),lt(sn.chars,sn.assets),sn.__complete=!0)}function Wt(sn){sn.t.a.length===0&&"m"in sn.t.p}var Jt={};return Jt.completeData=Ht,Jt.checkColors=Rt,Jt.checkChars=Mt,Jt.checkPathProperties=Bt,Jt.checkShapes=Ut,Jt.completeLayers=mt,Jt}if(_e.dataManager||(_e.dataManager=ft()),_e.assetLoader||(_e.assetLoader=function(){function mt(ut){var dt=ut.getResponseHeader("content-type");return dt&&ut.responseType==="json"&&dt.indexOf("json")!==-1||ut.response&&typeof ut.response=="object"?ut.response:ut.response&&typeof ut.response=="string"?JSON.parse(ut.response):ut.responseText?JSON.parse(ut.responseText):null}function lt(ut,dt,gt,Et){var St,Tt=new XMLHttpRequest;try{Tt.responseType="json"}catch{}Tt.onreadystatechange=function(){if(Tt.readyState===4)if(Tt.status===200)St=mt(Tt),gt(St);else try{St=mt(Tt),gt(St)}catch(Mt){Et&&Et(Mt)}};try{Tt.open("GET",ut,!0)}catch{Tt.open("GET",dt+"/"+ut,!0)}Tt.send()}return{load:lt}}()),ct.data.type==="loadAnimation")_e.assetLoader.load(ct.data.path,ct.data.fullPath,function(mt){_e.dataManager.completeData(mt),_e.postMessage({id:ct.data.id,payload:mt,status:"success"})},function(){_e.postMessage({id:ct.data.id,status:"error"})});else if(ct.data.type==="complete"){var ht=ct.data.animation;_e.dataManager.completeData(ht),_e.postMessage({id:ct.data.id,payload:ht,status:"success"})}else ct.data.type==="loadData"&&_e.assetLoader.load(ct.data.path,ct.data.fullPath,function(mt){_e.postMessage({id:ct.data.id,payload:mt,status:"success"})},function(){_e.postMessage({id:ct.data.id,status:"error"})})}),j.onmessage=function(ot){var ct=ot.data,ft=ct.id,ht=s[ft];s[ft]=null,ct.status==="success"?ht.onComplete(ct.payload):ht.onError&&ht.onError()})}function rt(ot,ct){a+=1;var ft="processId_"+a;return s[ft]={onComplete:ot,onError:ct},ft}function it(ot,ct,ft){nt();var ht=rt(ct,ft);j.postMessage({type:"loadAnimation",path:ot,fullPath:window.location.origin+window.location.pathname,id:ht})}function st(ot,ct,ft){nt();var ht=rt(ct,ft);j.postMessage({type:"loadData",path:ot,fullPath:window.location.origin+window.location.pathname,id:ht})}function at(ot,ct,ft){nt();var ht=rt(ct,ft);j.postMessage({type:"complete",animation:ot,id:ht})}return{loadAnimation:it,loadData:st,completeAnimation:at}}(),ImagePreloader=function(){var a=function(){var lt=createTag("canvas");lt.width=1,lt.height=1;var ut=lt.getContext("2d");return ut.fillStyle="rgba(0,0,0,0)",ut.fillRect(0,0,1,1),lt}();function s(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function o(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function j(lt,ut,dt){var gt="";if(lt.e)gt=lt.p;else if(ut){var Et=lt.p;Et.indexOf("images/")!==-1&&(Et=Et.split("/")[1]),gt=ut+Et}else gt=dt,gt+=lt.u?lt.u:"",gt+=lt.p;return gt}function $(lt){var ut=0,dt=setInterval(function(){var gt=lt.getBBox();(gt.width||ut>500)&&(this._imageLoaded(),clearInterval(dt)),ut+=1}.bind(this),50)}function _e(lt){var ut=j(lt,this.assetsPath,this.path),dt=createNS("image");isSafari?this.testImageLoaded(dt):dt.addEventListener("load",this._imageLoaded,!1),dt.addEventListener("error",function(){gt.img=a,this._imageLoaded()}.bind(this),!1),dt.setAttributeNS("http://www.w3.org/1999/xlink","href",ut),this._elementHelper.append?this._elementHelper.append(dt):this._elementHelper.appendChild(dt);var gt={img:dt,assetData:lt};return gt}function tt(lt){var ut=j(lt,this.assetsPath,this.path),dt=createTag("img");dt.crossOrigin="anonymous",dt.addEventListener("load",this._imageLoaded,!1),dt.addEventListener("error",function(){gt.img=a,this._imageLoaded()}.bind(this),!1),dt.src=ut;var gt={img:dt,assetData:lt};return gt}function nt(lt){var ut={assetData:lt},dt=j(lt,this.assetsPath,this.path);return dataManager.loadData(dt,function(gt){ut.img=gt,this._footageLoaded()}.bind(this),function(){ut.img={},this._footageLoaded()}.bind(this)),ut}function rt(lt,ut){this.imagesLoadedCb=ut;var dt,gt=lt.length;for(dt=0;dt<gt;dt+=1)lt[dt].layers||(!lt[dt].t||lt[dt].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(lt[dt]))):lt[dt].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(lt[dt]))))}function it(lt){this.path=lt||""}function st(lt){this.assetsPath=lt||""}function at(lt){for(var ut=0,dt=this.images.length;ut<dt;){if(this.images[ut].assetData===lt)return this.images[ut].img;ut+=1}return null}function ot(){this.imagesLoadedCb=null,this.images.length=0}function ct(){return this.totalImages===this.loadedAssets}function ft(){return this.totalFootages===this.loadedFootagesCount}function ht(lt,ut){lt==="svg"?(this._elementHelper=ut,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function mt(){this._imageLoaded=s.bind(this),this._footageLoaded=o.bind(this),this.testImageLoaded=$.bind(this),this.createFootageData=nt.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return mt.prototype={loadAssets:rt,setAssetsPath:st,setPath:it,loadedImages:ct,loadedFootages:ft,destroy:ot,getAsset:at,createImgData:tt,createImageData:_e,imageLoaded:s,footageLoaded:o,setCacheType:ht},mt}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(a,s){if(this._cbs[a])for(var o=this._cbs[a],j=0;j<o.length;j+=1)o[j](s)},addEventListener:function(a,s){return this._cbs[a]||(this._cbs[a]=[]),this._cbs[a].push(s),function(){this.removeEventListener(a,s)}.bind(this)},removeEventListener:function(a,s){if(!s)this._cbs[a]=null;else if(this._cbs[a]){for(var o=0,j=this._cbs[a].length;o<j;)this._cbs[a][o]===s&&(this._cbs[a].splice(o,1),o-=1,j-=1),o+=1;this._cbs[a].length||(this._cbs[a]=null)}}};const markerParser=function(){function a(s){for(var o=s.split(`\r
`),j={},$,_e=0,tt=0;tt<o.length;tt+=1)$=o[tt].split(":"),$.length===2&&(j[$[0]]=$[1].trim(),_e+=1);if(_e===0)throw new Error;return j}return function(s){for(var o=[],j=0;j<s.length;j+=1){var $=s[j],_e={time:$.tm,duration:$.dr};try{_e.payload=JSON.parse(s[j].cm)}catch{try{_e.payload=a(s[j].cm)}catch{_e.payload={name:s[j].cm}}}o.push(_e)}return o}}(),ProjectInterface=function(){function a(s){this.compositions.push(s)}return function(){function s(o){for(var j=0,$=this.compositions.length;j<$;){if(this.compositions[j].data&&this.compositions[j].data.nm===o)return this.compositions[j].prepareFrame&&this.compositions[j].data.xt&&this.compositions[j].prepareFrame(this.currentFrame),this.compositions[j].compInterface;j+=1}return null}return s.compositions=[],s.currentFrame=0,s.registerComposition=a,s}}(),renderers={},registerRenderer=(a,s)=>{renderers[a]=s};function getRenderer(a){return renderers[a]}const AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(a){(a.wrapper||a.container)&&(this.wrapper=a.wrapper||a.container);var s="svg";a.animType?s=a.animType:a.renderer&&(s=a.renderer);const o=getRenderer(s);this.renderer=new o(this,a.rendererSettings),this.imagePreloader.setCacheType(s,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=s,a.loop===""||a.loop===null||a.loop===void 0||a.loop===!0?this.loop=!0:a.loop===!1?this.loop=!1:this.loop=parseInt(a.loop,10),this.autoplay="autoplay"in a?a.autoplay:!0,this.name=a.name?a.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(a,"autoloadSegments")?a.autoloadSegments:!0,this.assetsPath=a.assetsPath,this.initialSegment=a.initialSegment,a.audioFactory&&this.audioController.setAudioFactory(a.audioFactory),a.animationData?this.setupAnimation(a.animationData):a.path&&(a.path.lastIndexOf("\\")!==-1?this.path=a.path.substr(0,a.path.lastIndexOf("\\")+1):this.path=a.path.substr(0,a.path.lastIndexOf("/")+1),this.fileName=a.path.substr(a.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(a.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(a){dataManager.completeAnimation(a,this.configAnimation)},AnimationItem.prototype.setData=function(a,s){s&&typeof s!="object"&&(s=JSON.parse(s));var o={wrapper:a,animationData:s},j=a.attributes;o.path=j.getNamedItem("data-animation-path")?j.getNamedItem("data-animation-path").value:j.getNamedItem("data-bm-path")?j.getNamedItem("data-bm-path").value:j.getNamedItem("bm-path")?j.getNamedItem("bm-path").value:"",o.animType=j.getNamedItem("data-anim-type")?j.getNamedItem("data-anim-type").value:j.getNamedItem("data-bm-type")?j.getNamedItem("data-bm-type").value:j.getNamedItem("bm-type")?j.getNamedItem("bm-type").value:j.getNamedItem("data-bm-renderer")?j.getNamedItem("data-bm-renderer").value:j.getNamedItem("bm-renderer")?j.getNamedItem("bm-renderer").value:"canvas";var $=j.getNamedItem("data-anim-loop")?j.getNamedItem("data-anim-loop").value:j.getNamedItem("data-bm-loop")?j.getNamedItem("data-bm-loop").value:j.getNamedItem("bm-loop")?j.getNamedItem("bm-loop").value:"";$==="false"?o.loop=!1:$==="true"?o.loop=!0:$!==""&&(o.loop=parseInt($,10));var _e=j.getNamedItem("data-anim-autoplay")?j.getNamedItem("data-anim-autoplay").value:j.getNamedItem("data-bm-autoplay")?j.getNamedItem("data-bm-autoplay").value:j.getNamedItem("bm-autoplay")?j.getNamedItem("bm-autoplay").value:!0;o.autoplay=_e!=="false",o.name=j.getNamedItem("data-name")?j.getNamedItem("data-name").value:j.getNamedItem("data-bm-name")?j.getNamedItem("data-bm-name").value:j.getNamedItem("bm-name")?j.getNamedItem("bm-name").value:"";var tt=j.getNamedItem("data-anim-prerender")?j.getNamedItem("data-anim-prerender").value:j.getNamedItem("data-bm-prerender")?j.getNamedItem("data-bm-prerender").value:j.getNamedItem("bm-prerender")?j.getNamedItem("bm-prerender").value:"";tt==="false"&&(o.prerender=!1),this.setParams(o)},AnimationItem.prototype.includeLayers=function(a){a.op>this.animationData.op&&(this.animationData.op=a.op,this.totalFrames=Math.floor(a.op-this.animationData.ip));var s=this.animationData.layers,o,j=s.length,$=a.layers,_e,tt=$.length;for(_e=0;_e<tt;_e+=1)for(o=0;o<j;){if(s[o].id===$[_e].id){s[o]=$[_e];break}o+=1}if((a.chars||a.fonts)&&(this.renderer.globalData.fontManager.addChars(a.chars),this.renderer.globalData.fontManager.addFonts(a.fonts,this.renderer.globalData.defs)),a.assets)for(j=a.assets.length,o=0;o<j;o+=1)this.animationData.assets.push(a.assets[o]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(a){this.animationData=a;var s=getExpressionsPlugin();s&&s.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var a=this.animationData.segments;if(!a||a.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var s=a.shift();this.timeCompleted=s.time*this.frameRate;var o=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(o,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){var a=this.animationData.segments;a||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(a){if(this.renderer)try{this.animationData=a,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(a),a.assets||(a.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(a.assets),this.markers=markerParser(a.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(s){this.triggerConfigError(s)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var a=getExpressionsPlugin();a&&a.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(){this.renderer.updateContainerSize()},AnimationItem.prototype.setSubframe=function(a){this.isSubframeEnabled=!!a},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(a){this.triggerRenderFrameError(a)}},AnimationItem.prototype.play=function(a){a&&this.name!==a||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_pause"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(a){a&&this.name!==a||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_play"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(a){a&&this.name!==a||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(a){a&&this.name!==a||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(a){for(var s,o=0;o<this.markers.length;o+=1)if(s=this.markers[o],s.payload&&s.payload.name===a)return s;return null},AnimationItem.prototype.goToAndStop=function(a,s,o){if(!(o&&this.name!==o)){var j=Number(a);if(isNaN(j)){var $=this.getMarkerData(a);$&&this.goToAndStop($.time,!0)}else s?this.setCurrentRawFrameValue(a):this.setCurrentRawFrameValue(a*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(a,s,o){if(!(o&&this.name!==o)){var j=Number(a);if(isNaN(j)){var $=this.getMarkerData(a);$&&($.duration?this.playSegments([$.time,$.time+$.duration],!0):this.goToAndStop($.time,!0))}else this.goToAndStop(j,s,o);this.play()}},AnimationItem.prototype.advanceTime=function(a){if(!(this.isPaused===!0||this.isLoaded===!1)){var s=this.currentRawFrame+a*this.frameModifier,o=!1;s>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(s>this.totalFrames?s%this.totalFrames:0)||(o=!0,s=this.totalFrames-1):s>=this.totalFrames?(this.playCount+=1,this.checkSegments(s%this.totalFrames)||(this.setCurrentRawFrameValue(s%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(s):s<0?this.checkSegments(s%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+s%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(o=!0,s=0)):this.setCurrentRawFrameValue(s),o&&(this.setCurrentRawFrameValue(s),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(a,s){this.playCount=0,a[1]<a[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=a[0]-a[1],this.timeCompleted=this.totalFrames,this.firstFrame=a[1],this.setCurrentRawFrameValue(this.totalFrames-.001-s)):a[1]>a[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=a[1]-a[0],this.timeCompleted=this.totalFrames,this.firstFrame=a[0],this.setCurrentRawFrameValue(.001+s)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(a,s){var o=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<a?o=a:this.currentRawFrame+this.firstFrame>s&&(o=s-a)),this.firstFrame=a,this.totalFrames=s-a,this.timeCompleted=this.totalFrames,o!==-1&&this.goToAndStop(o,!0)},AnimationItem.prototype.playSegments=function(a,s){if(s&&(this.segments.length=0),typeof a[0]=="object"){var o,j=a.length;for(o=0;o<j;o+=1)this.segments.push(a[o])}else this.segments.push(a);this.segments.length&&s&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(a){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),a&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(a){return this.segments.length?(this.adjustSegment(this.segments.shift(),a),!0):!1},AnimationItem.prototype.destroy=function(a){a&&this.name!==a||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(a){this.currentRawFrame=a,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(a){this.playSpeed=a,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(a){this.playDirection=a<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(a,s){s&&this.name!==s||this.audioController.setVolume(a)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(a){a&&this.name!==a||this.audioController.mute()},AnimationItem.prototype.unmute=function(a){a&&this.name!==a||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(a){var s="";if(a.e)s=a.p;else if(this.assetsPath){var o=a.p;o.indexOf("images/")!==-1&&(o=o.split("/")[1]),s=this.assetsPath+o}else s=this.path,s+=a.u?a.u:"",s+=a.p;return s},AnimationItem.prototype.getAssetData=function(a){for(var s=0,o=this.assets.length;s<o;){if(a===this.assets[s].id)return this.assets[s];s+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(a){return a?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(a,s,o){try{var j=this.renderer.getElementByPath(a);j.updateDocumentData(s,o)}catch{}},AnimationItem.prototype.trigger=function(a){if(this._cbs&&this._cbs[a])switch(a){case"enterFrame":this.triggerEvent(a,new BMEnterFrameEvent(a,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(a,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(a,new BMCompleteLoopEvent(a,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(a,new BMCompleteEvent(a,this.frameMult));break;case"segmentStart":this.triggerEvent(a,new BMSegmentStartEvent(a,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(a,new BMDestroyEvent(a,this));break;default:this.triggerEvent(a)}a==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(a,this.currentFrame,this.totalFrames,this.frameMult)),a==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(a,this.loop,this.playCount,this.frameMult)),a==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(a,this.frameMult)),a==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(a,this.firstFrame,this.totalFrames)),a==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(a,this))},AnimationItem.prototype.triggerRenderFrameError=function(a){var s=new BMRenderFrameErrorEvent(a,this.currentFrame);this.triggerEvent("error",s),this.onError&&this.onError.call(this,s)},AnimationItem.prototype.triggerConfigError=function(a){var s=new BMConfigErrorEvent(a,this.currentFrame);this.triggerEvent("error",s),this.onError&&this.onError.call(this,s)};const animationManager=function(){var a={},s=[],o=0,j=0,$=0,_e=!0,tt=!1;function nt(jt){for(var Vt=0,Lt=jt.target;Vt<j;)s[Vt].animation===Lt&&(s.splice(Vt,1),Vt-=1,j-=1,Lt.isPaused||at()),Vt+=1}function rt(jt,Vt){if(!jt)return null;for(var Lt=0;Lt<j;){if(s[Lt].elem===jt&&s[Lt].elem!==null)return s[Lt].animation;Lt+=1}var Qt=new AnimationItem;return ot(Qt,jt),Qt.setData(jt,Vt),Qt}function it(){var jt,Vt=s.length,Lt=[];for(jt=0;jt<Vt;jt+=1)Lt.push(s[jt].animation);return Lt}function st(){$+=1,Rt()}function at(){$-=1}function ot(jt,Vt){jt.addEventListener("destroy",nt),jt.addEventListener("_active",st),jt.addEventListener("_idle",at),s.push({elem:Vt,animation:jt}),j+=1}function ct(jt){var Vt=new AnimationItem;return ot(Vt,null),Vt.setParams(jt),Vt}function ft(jt,Vt){var Lt;for(Lt=0;Lt<j;Lt+=1)s[Lt].animation.setSpeed(jt,Vt)}function ht(jt,Vt){var Lt;for(Lt=0;Lt<j;Lt+=1)s[Lt].animation.setDirection(jt,Vt)}function mt(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.play(jt)}function lt(jt){var Vt=jt-o,Lt;for(Lt=0;Lt<j;Lt+=1)s[Lt].animation.advanceTime(Vt);o=jt,$&&!tt?window.requestAnimationFrame(lt):_e=!0}function ut(jt){o=jt,window.requestAnimationFrame(lt)}function dt(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.pause(jt)}function gt(jt,Vt,Lt){var Qt;for(Qt=0;Qt<j;Qt+=1)s[Qt].animation.goToAndStop(jt,Vt,Lt)}function Et(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.stop(jt)}function St(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.togglePause(jt)}function Tt(jt){var Vt;for(Vt=j-1;Vt>=0;Vt-=1)s[Vt].animation.destroy(jt)}function Mt(jt,Vt,Lt){var Qt=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),nn,mn=Qt.length;for(nn=0;nn<mn;nn+=1)Lt&&Qt[nn].setAttribute("data-bm-type",Lt),rt(Qt[nn],jt);if(Vt&&mn===0){Lt||(Lt="svg");var Zt=document.getElementsByTagName("body")[0];Zt.innerText="";var cn=createTag("div");cn.style.width="100%",cn.style.height="100%",cn.setAttribute("data-bm-type",Lt),Zt.appendChild(cn),rt(cn,jt)}}function Bt(){var jt;for(jt=0;jt<j;jt+=1)s[jt].animation.resize()}function Rt(){!tt&&$&&_e&&(window.requestAnimationFrame(ut),_e=!1)}function Ut(){tt=!0}function Ht(){tt=!1,Rt()}function Wt(jt,Vt){var Lt;for(Lt=0;Lt<j;Lt+=1)s[Lt].animation.setVolume(jt,Vt)}function Jt(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.mute(jt)}function sn(jt){var Vt;for(Vt=0;Vt<j;Vt+=1)s[Vt].animation.unmute(jt)}return a.registerAnimation=rt,a.loadAnimation=ct,a.setSpeed=ft,a.setDirection=ht,a.play=mt,a.pause=dt,a.stop=Et,a.togglePause=St,a.searchAnimations=Mt,a.resize=Bt,a.goToAndStop=gt,a.destroy=Tt,a.freeze=Ut,a.unfreeze=Ht,a.setVolume=Wt,a.mute=Jt,a.unmute=sn,a.getRegisteredAnimations=it,a}(),BezierFactory=function(){var a={};a.getBezierEasing=o;var s={};function o(ut,dt,gt,Et,St){var Tt=St||("bez_"+ut+"_"+dt+"_"+gt+"_"+Et).replace(/\./g,"p");if(s[Tt])return s[Tt];var Mt=new lt([ut,dt,gt,Et]);return s[Tt]=Mt,Mt}var j=4,$=.001,_e=1e-7,tt=10,nt=11,rt=1/(nt-1),it=typeof Float32Array=="function";function st(ut,dt){return 1-3*dt+3*ut}function at(ut,dt){return 3*dt-6*ut}function ot(ut){return 3*ut}function ct(ut,dt,gt){return((st(dt,gt)*ut+at(dt,gt))*ut+ot(dt))*ut}function ft(ut,dt,gt){return 3*st(dt,gt)*ut*ut+2*at(dt,gt)*ut+ot(dt)}function ht(ut,dt,gt,Et,St){var Tt,Mt,Bt=0;do Mt=dt+(gt-dt)/2,Tt=ct(Mt,Et,St)-ut,Tt>0?gt=Mt:dt=Mt;while(Math.abs(Tt)>_e&&++Bt<tt);return Mt}function mt(ut,dt,gt,Et){for(var St=0;St<j;++St){var Tt=ft(dt,gt,Et);if(Tt===0)return dt;var Mt=ct(dt,gt,Et)-ut;dt-=Mt/Tt}return dt}function lt(ut){this._p=ut,this._mSampleValues=it?new Float32Array(nt):new Array(nt),this._precomputed=!1,this.get=this.get.bind(this)}return lt.prototype={get:function(ut){var dt=this._p[0],gt=this._p[1],Et=this._p[2],St=this._p[3];return this._precomputed||this._precompute(),dt===gt&&Et===St?ut:ut===0?0:ut===1?1:ct(this._getTForX(ut),gt,St)},_precompute:function(){var ut=this._p[0],dt=this._p[1],gt=this._p[2],Et=this._p[3];this._precomputed=!0,(ut!==dt||gt!==Et)&&this._calcSampleValues()},_calcSampleValues:function(){for(var ut=this._p[0],dt=this._p[2],gt=0;gt<nt;++gt)this._mSampleValues[gt]=ct(gt*rt,ut,dt)},_getTForX:function(ut){for(var dt=this._p[0],gt=this._p[2],Et=this._mSampleValues,St=0,Tt=1,Mt=nt-1;Tt!==Mt&&Et[Tt]<=ut;++Tt)St+=rt;--Tt;var Bt=(ut-Et[Tt])/(Et[Tt+1]-Et[Tt]),Rt=St+Bt*rt,Ut=ft(Rt,dt,gt);return Ut>=$?mt(ut,Rt,dt,gt):Ut===0?Rt:ht(ut,St,St+rt,dt,gt)}},a}(),pooling=function(){function a(s){return s.concat(createSizedArray(s.length))}return{double:a}}(),poolFactory=function(){return function(a,s,o){var j=0,$=a,_e=createSizedArray($),tt={newElement:nt,release:rt};function nt(){var it;return j?(j-=1,it=_e[j]):it=s(),it}function rt(it){j===$&&(_e=pooling.double(_e),$*=2),o&&o(it),_e[j]=it,j+=1}return tt}}(),bezierLengthPool=function(){function a(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,a)}(),segmentsLengthPool=function(){function a(){return{lengths:[],totalLength:0}}function s(o){var j,$=o.lengths.length;for(j=0;j<$;j+=1)bezierLengthPool.release(o.lengths[j]);o.lengths.length=0}return poolFactory(8,a,s)}();function bezFunction(){var a=Math;function s(ot,ct,ft,ht,mt,lt){var ut=ot*ht+ct*mt+ft*lt-mt*ht-lt*ot-ft*ct;return ut>-.001&&ut<.001}function o(ot,ct,ft,ht,mt,lt,ut,dt,gt){if(ft===0&&lt===0&&gt===0)return s(ot,ct,ht,mt,ut,dt);var Et=a.sqrt(a.pow(ht-ot,2)+a.pow(mt-ct,2)+a.pow(lt-ft,2)),St=a.sqrt(a.pow(ut-ot,2)+a.pow(dt-ct,2)+a.pow(gt-ft,2)),Tt=a.sqrt(a.pow(ut-ht,2)+a.pow(dt-mt,2)+a.pow(gt-lt,2)),Mt;return Et>St?Et>Tt?Mt=Et-St-Tt:Mt=Tt-St-Et:Tt>St?Mt=Tt-St-Et:Mt=St-Et-Tt,Mt>-1e-4&&Mt<1e-4}var j=function(){return function(ot,ct,ft,ht){var mt=getDefaultCurveSegments(),lt,ut,dt,gt,Et,St=0,Tt,Mt=[],Bt=[],Rt=bezierLengthPool.newElement();for(dt=ft.length,lt=0;lt<mt;lt+=1){for(Et=lt/(mt-1),Tt=0,ut=0;ut<dt;ut+=1)gt=bmPow(1-Et,3)*ot[ut]+3*bmPow(1-Et,2)*Et*ft[ut]+3*(1-Et)*bmPow(Et,2)*ht[ut]+bmPow(Et,3)*ct[ut],Mt[ut]=gt,Bt[ut]!==null&&(Tt+=bmPow(Mt[ut]-Bt[ut],2)),Bt[ut]=Mt[ut];Tt&&(Tt=bmSqrt(Tt),St+=Tt),Rt.percents[lt]=Et,Rt.lengths[lt]=St}return Rt.addedLength=St,Rt}}();function $(ot){var ct=segmentsLengthPool.newElement(),ft=ot.c,ht=ot.v,mt=ot.o,lt=ot.i,ut,dt=ot._length,gt=ct.lengths,Et=0;for(ut=0;ut<dt-1;ut+=1)gt[ut]=j(ht[ut],ht[ut+1],mt[ut],lt[ut+1]),Et+=gt[ut].addedLength;return ft&&dt&&(gt[ut]=j(ht[ut],ht[0],mt[ut],lt[0]),Et+=gt[ut].addedLength),ct.totalLength=Et,ct}function _e(ot){this.segmentLength=0,this.points=new Array(ot)}function tt(ot,ct){this.partialLength=ot,this.point=ct}var nt=function(){var ot={};return function(ct,ft,ht,mt){var lt=(ct[0]+"_"+ct[1]+"_"+ft[0]+"_"+ft[1]+"_"+ht[0]+"_"+ht[1]+"_"+mt[0]+"_"+mt[1]).replace(/\./g,"p");if(!ot[lt]){var ut=getDefaultCurveSegments(),dt,gt,Et,St,Tt,Mt=0,Bt,Rt,Ut=null;ct.length===2&&(ct[0]!==ft[0]||ct[1]!==ft[1])&&s(ct[0],ct[1],ft[0],ft[1],ct[0]+ht[0],ct[1]+ht[1])&&s(ct[0],ct[1],ft[0],ft[1],ft[0]+mt[0],ft[1]+mt[1])&&(ut=2);var Ht=new _e(ut);for(Et=ht.length,dt=0;dt<ut;dt+=1){for(Rt=createSizedArray(Et),Tt=dt/(ut-1),Bt=0,gt=0;gt<Et;gt+=1)St=bmPow(1-Tt,3)*ct[gt]+3*bmPow(1-Tt,2)*Tt*(ct[gt]+ht[gt])+3*(1-Tt)*bmPow(Tt,2)*(ft[gt]+mt[gt])+bmPow(Tt,3)*ft[gt],Rt[gt]=St,Ut!==null&&(Bt+=bmPow(Rt[gt]-Ut[gt],2));Bt=bmSqrt(Bt),Mt+=Bt,Ht.points[dt]=new tt(Bt,Rt),Ut=Rt}Ht.segmentLength=Mt,ot[lt]=Ht}return ot[lt]}}();function rt(ot,ct){var ft=ct.percents,ht=ct.lengths,mt=ft.length,lt=bmFloor((mt-1)*ot),ut=ot*ct.addedLength,dt=0;if(lt===mt-1||lt===0||ut===ht[lt])return ft[lt];for(var gt=ht[lt]>ut?-1:1,Et=!0;Et;)if(ht[lt]<=ut&&ht[lt+1]>ut?(dt=(ut-ht[lt])/(ht[lt+1]-ht[lt]),Et=!1):lt+=gt,lt<0||lt>=mt-1){if(lt===mt-1)return ft[lt];Et=!1}return ft[lt]+(ft[lt+1]-ft[lt])*dt}function it(ot,ct,ft,ht,mt,lt){var ut=rt(mt,lt),dt=1-ut,gt=a.round((dt*dt*dt*ot[0]+(ut*dt*dt+dt*ut*dt+dt*dt*ut)*ft[0]+(ut*ut*dt+dt*ut*ut+ut*dt*ut)*ht[0]+ut*ut*ut*ct[0])*1e3)/1e3,Et=a.round((dt*dt*dt*ot[1]+(ut*dt*dt+dt*ut*dt+dt*dt*ut)*ft[1]+(ut*ut*dt+dt*ut*ut+ut*dt*ut)*ht[1]+ut*ut*ut*ct[1])*1e3)/1e3;return[gt,Et]}var st=createTypedArray("float32",8);function at(ot,ct,ft,ht,mt,lt,ut){mt<0?mt=0:mt>1&&(mt=1);var dt=rt(mt,ut);lt=lt>1?1:lt;var gt=rt(lt,ut),Et,St=ot.length,Tt=1-dt,Mt=1-gt,Bt=Tt*Tt*Tt,Rt=dt*Tt*Tt*3,Ut=dt*dt*Tt*3,Ht=dt*dt*dt,Wt=Tt*Tt*Mt,Jt=dt*Tt*Mt+Tt*dt*Mt+Tt*Tt*gt,sn=dt*dt*Mt+Tt*dt*gt+dt*Tt*gt,jt=dt*dt*gt,Vt=Tt*Mt*Mt,Lt=dt*Mt*Mt+Tt*gt*Mt+Tt*Mt*gt,Qt=dt*gt*Mt+Tt*gt*gt+dt*Mt*gt,nn=dt*gt*gt,mn=Mt*Mt*Mt,Zt=gt*Mt*Mt+Mt*gt*Mt+Mt*Mt*gt,cn=gt*gt*Mt+Mt*gt*gt+gt*Mt*gt,Ot=gt*gt*gt;for(Et=0;Et<St;Et+=1)st[Et*4]=a.round((Bt*ot[Et]+Rt*ft[Et]+Ut*ht[Et]+Ht*ct[Et])*1e3)/1e3,st[Et*4+1]=a.round((Wt*ot[Et]+Jt*ft[Et]+sn*ht[Et]+jt*ct[Et])*1e3)/1e3,st[Et*4+2]=a.round((Vt*ot[Et]+Lt*ft[Et]+Qt*ht[Et]+nn*ct[Et])*1e3)/1e3,st[Et*4+3]=a.round((mn*ot[Et]+Zt*ft[Et]+cn*ht[Et]+Ot*ct[Et])*1e3)/1e3;return st}return{getSegmentsLength:$,getNewSegment:at,getPointInSegment:it,buildBezierData:nt,pointOnLine2D:s,pointOnLine3D:o}}const bez=bezFunction(),PropertyFactory=function(){var a=initialDefaultFrame,s=Math.abs;function o(mt,lt){var ut=this.offsetTime,dt;this.propType==="multidimensional"&&(dt=createTypedArray("float32",this.pv.length));for(var gt=lt.lastIndex,Et=gt,St=this.keyframes.length-1,Tt=!0,Mt,Bt,Rt;Tt;){if(Mt=this.keyframes[Et],Bt=this.keyframes[Et+1],Et===St-1&&mt>=Bt.t-ut){Mt.h&&(Mt=Bt),gt=0;break}if(Bt.t-ut>mt){gt=Et;break}Et<St-1?Et+=1:(gt=0,Tt=!1)}Rt=this.keyframesMetadata[Et]||{};var Ut,Ht,Wt,Jt,sn,jt,Vt=Bt.t-ut,Lt=Mt.t-ut,Qt;if(Mt.to){Rt.bezierData||(Rt.bezierData=bez.buildBezierData(Mt.s,Bt.s||Mt.e,Mt.to,Mt.ti));var nn=Rt.bezierData;if(mt>=Vt||mt<Lt){var mn=mt>=Vt?nn.points.length-1:0;for(Ht=nn.points[mn].point.length,Ut=0;Ut<Ht;Ut+=1)dt[Ut]=nn.points[mn].point[Ut]}else{Rt.__fnct?jt=Rt.__fnct:(jt=BezierFactory.getBezierEasing(Mt.o.x,Mt.o.y,Mt.i.x,Mt.i.y,Mt.n).get,Rt.__fnct=jt),Wt=jt((mt-Lt)/(Vt-Lt));var Zt=nn.segmentLength*Wt,cn,Ot=lt.lastFrame<mt&&lt._lastKeyframeIndex===Et?lt._lastAddedLength:0;for(sn=lt.lastFrame<mt&&lt._lastKeyframeIndex===Et?lt._lastPoint:0,Tt=!0,Jt=nn.points.length;Tt;){if(Ot+=nn.points[sn].partialLength,Zt===0||Wt===0||sn===nn.points.length-1){for(Ht=nn.points[sn].point.length,Ut=0;Ut<Ht;Ut+=1)dt[Ut]=nn.points[sn].point[Ut];break}else if(Zt>=Ot&&Zt<Ot+nn.points[sn+1].partialLength){for(cn=(Zt-Ot)/nn.points[sn+1].partialLength,Ht=nn.points[sn].point.length,Ut=0;Ut<Ht;Ut+=1)dt[Ut]=nn.points[sn].point[Ut]+(nn.points[sn+1].point[Ut]-nn.points[sn].point[Ut])*cn;break}sn<Jt-1?sn+=1:Tt=!1}lt._lastPoint=sn,lt._lastAddedLength=Ot-nn.points[sn].partialLength,lt._lastKeyframeIndex=Et}}else{var rn,fn,hn,Tn,Nn;if(St=Mt.s.length,Qt=Bt.s||Mt.e,this.sh&&Mt.h!==1)if(mt>=Vt)dt[0]=Qt[0],dt[1]=Qt[1],dt[2]=Qt[2];else if(mt<=Lt)dt[0]=Mt.s[0],dt[1]=Mt.s[1],dt[2]=Mt.s[2];else{var Pn=_e(Mt.s),Dn=_e(Qt),ln=(mt-Lt)/(Vt-Lt);$(dt,j(Pn,Dn,ln))}else for(Et=0;Et<St;Et+=1)Mt.h!==1&&(mt>=Vt?Wt=1:mt<Lt?Wt=0:(Mt.o.x.constructor===Array?(Rt.__fnct||(Rt.__fnct=[]),Rt.__fnct[Et]?jt=Rt.__fnct[Et]:(rn=Mt.o.x[Et]===void 0?Mt.o.x[0]:Mt.o.x[Et],fn=Mt.o.y[Et]===void 0?Mt.o.y[0]:Mt.o.y[Et],hn=Mt.i.x[Et]===void 0?Mt.i.x[0]:Mt.i.x[Et],Tn=Mt.i.y[Et]===void 0?Mt.i.y[0]:Mt.i.y[Et],jt=BezierFactory.getBezierEasing(rn,fn,hn,Tn).get,Rt.__fnct[Et]=jt)):Rt.__fnct?jt=Rt.__fnct:(rn=Mt.o.x,fn=Mt.o.y,hn=Mt.i.x,Tn=Mt.i.y,jt=BezierFactory.getBezierEasing(rn,fn,hn,Tn).get,Mt.keyframeMetadata=jt),Wt=jt((mt-Lt)/(Vt-Lt)))),Qt=Bt.s||Mt.e,Nn=Mt.h===1?Mt.s[Et]:Mt.s[Et]+(Qt[Et]-Mt.s[Et])*Wt,this.propType==="multidimensional"?dt[Et]=Nn:dt=Nn}return lt.lastIndex=gt,dt}function j(mt,lt,ut){var dt=[],gt=mt[0],Et=mt[1],St=mt[2],Tt=mt[3],Mt=lt[0],Bt=lt[1],Rt=lt[2],Ut=lt[3],Ht,Wt,Jt,sn,jt;return Wt=gt*Mt+Et*Bt+St*Rt+Tt*Ut,Wt<0&&(Wt=-Wt,Mt=-Mt,Bt=-Bt,Rt=-Rt,Ut=-Ut),1-Wt>1e-6?(Ht=Math.acos(Wt),Jt=Math.sin(Ht),sn=Math.sin((1-ut)*Ht)/Jt,jt=Math.sin(ut*Ht)/Jt):(sn=1-ut,jt=ut),dt[0]=sn*gt+jt*Mt,dt[1]=sn*Et+jt*Bt,dt[2]=sn*St+jt*Rt,dt[3]=sn*Tt+jt*Ut,dt}function $(mt,lt){var ut=lt[0],dt=lt[1],gt=lt[2],Et=lt[3],St=Math.atan2(2*dt*Et-2*ut*gt,1-2*dt*dt-2*gt*gt),Tt=Math.asin(2*ut*dt+2*gt*Et),Mt=Math.atan2(2*ut*Et-2*dt*gt,1-2*ut*ut-2*gt*gt);mt[0]=St/degToRads,mt[1]=Tt/degToRads,mt[2]=Mt/degToRads}function _e(mt){var lt=mt[0]*degToRads,ut=mt[1]*degToRads,dt=mt[2]*degToRads,gt=Math.cos(lt/2),Et=Math.cos(ut/2),St=Math.cos(dt/2),Tt=Math.sin(lt/2),Mt=Math.sin(ut/2),Bt=Math.sin(dt/2),Rt=gt*Et*St-Tt*Mt*Bt,Ut=Tt*Mt*St+gt*Et*Bt,Ht=Tt*Et*St+gt*Mt*Bt,Wt=gt*Mt*St-Tt*Et*Bt;return[Ut,Ht,Wt,Rt]}function tt(){var mt=this.comp.renderedFrame-this.offsetTime,lt=this.keyframes[0].t-this.offsetTime,ut=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(mt===this._caching.lastFrame||this._caching.lastFrame!==a&&(this._caching.lastFrame>=ut&&mt>=ut||this._caching.lastFrame<lt&&mt<lt))){this._caching.lastFrame>=mt&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var dt=this.interpolateValue(mt,this._caching);this.pv=dt}return this._caching.lastFrame=mt,this.pv}function nt(mt){var lt;if(this.propType==="unidimensional")lt=mt*this.mult,s(this.v-lt)>1e-5&&(this.v=lt,this._mdf=!0);else for(var ut=0,dt=this.v.length;ut<dt;)lt=mt[ut]*this.mult,s(this.v[ut]-lt)>1e-5&&(this.v[ut]=lt,this._mdf=!0),ut+=1}function rt(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var mt,lt=this.effectsSequence.length,ut=this.kf?this.pv:this.data.k;for(mt=0;mt<lt;mt+=1)ut=this.effectsSequence[mt](ut);this.setVValue(ut),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function it(mt){this.effectsSequence.push(mt),this.container.addDynamicProperty(this)}function st(mt,lt,ut,dt){this.propType="unidimensional",this.mult=ut||1,this.data=lt,this.v=ut?lt.k*ut:lt.k,this.pv=lt.k,this._mdf=!1,this.elem=mt,this.container=dt,this.comp=mt.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=rt,this.setVValue=nt,this.addEffect=it}function at(mt,lt,ut,dt){this.propType="multidimensional",this.mult=ut||1,this.data=lt,this._mdf=!1,this.elem=mt,this.container=dt,this.comp=mt.comp,this.k=!1,this.kf=!1,this.frameId=-1;var gt,Et=lt.k.length;for(this.v=createTypedArray("float32",Et),this.pv=createTypedArray("float32",Et),this.vel=createTypedArray("float32",Et),gt=0;gt<Et;gt+=1)this.v[gt]=lt.k[gt]*this.mult,this.pv[gt]=lt.k[gt];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=rt,this.setVValue=nt,this.addEffect=it}function ot(mt,lt,ut,dt){this.propType="unidimensional",this.keyframes=lt.k,this.keyframesMetadata=[],this.offsetTime=mt.data.st,this.frameId=-1,this._caching={lastFrame:a,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=lt,this.mult=ut||1,this.elem=mt,this.container=dt,this.comp=mt.comp,this.v=a,this.pv=a,this._isFirstFrame=!0,this.getValue=rt,this.setVValue=nt,this.interpolateValue=o,this.effectsSequence=[tt.bind(this)],this.addEffect=it}function ct(mt,lt,ut,dt){this.propType="multidimensional";var gt,Et=lt.k.length,St,Tt,Mt,Bt;for(gt=0;gt<Et-1;gt+=1)lt.k[gt].to&&lt.k[gt].s&&lt.k[gt+1]&&lt.k[gt+1].s&&(St=lt.k[gt].s,Tt=lt.k[gt+1].s,Mt=lt.k[gt].to,Bt=lt.k[gt].ti,(St.length===2&&!(St[0]===Tt[0]&&St[1]===Tt[1])&&bez.pointOnLine2D(St[0],St[1],Tt[0],Tt[1],St[0]+Mt[0],St[1]+Mt[1])&&bez.pointOnLine2D(St[0],St[1],Tt[0],Tt[1],Tt[0]+Bt[0],Tt[1]+Bt[1])||St.length===3&&!(St[0]===Tt[0]&&St[1]===Tt[1]&&St[2]===Tt[2])&&bez.pointOnLine3D(St[0],St[1],St[2],Tt[0],Tt[1],Tt[2],St[0]+Mt[0],St[1]+Mt[1],St[2]+Mt[2])&&bez.pointOnLine3D(St[0],St[1],St[2],Tt[0],Tt[1],Tt[2],Tt[0]+Bt[0],Tt[1]+Bt[1],Tt[2]+Bt[2]))&&(lt.k[gt].to=null,lt.k[gt].ti=null),St[0]===Tt[0]&&St[1]===Tt[1]&&Mt[0]===0&&Mt[1]===0&&Bt[0]===0&&Bt[1]===0&&(St.length===2||St[2]===Tt[2]&&Mt[2]===0&&Bt[2]===0)&&(lt.k[gt].to=null,lt.k[gt].ti=null));this.effectsSequence=[tt.bind(this)],this.data=lt,this.keyframes=lt.k,this.keyframesMetadata=[],this.offsetTime=mt.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=ut||1,this.elem=mt,this.container=dt,this.comp=mt.comp,this.getValue=rt,this.setVValue=nt,this.interpolateValue=o,this.frameId=-1;var Rt=lt.k[0].s.length;for(this.v=createTypedArray("float32",Rt),this.pv=createTypedArray("float32",Rt),gt=0;gt<Rt;gt+=1)this.v[gt]=a,this.pv[gt]=a;this._caching={lastFrame:a,lastIndex:0,value:createTypedArray("float32",Rt)},this.addEffect=it}function ft(mt,lt,ut,dt,gt){var Et;if(!lt.k.length)Et=new st(mt,lt,dt,gt);else if(typeof lt.k[0]=="number")Et=new at(mt,lt,dt,gt);else switch(ut){case 0:Et=new ot(mt,lt,dt,gt);break;case 1:Et=new ct(mt,lt,dt,gt);break}return Et.effectsSequence.length&&gt.addDynamicProperty(Et),Et}var ht={getProp:ft};return ht}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(a){this.dynamicProperties.indexOf(a)===-1&&(this.dynamicProperties.push(a),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var a,s=this.dynamicProperties.length;for(a=0;a<s;a+=1)this.dynamicProperties[a].getValue(),this.dynamicProperties[a]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(a){this.container=a,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};const pointPool=function(){function a(){return createTypedArray("float32",2)}return poolFactory(8,a)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(a,s){this.c=a,this.setLength(s);for(var o=0;o<s;)this.v[o]=pointPool.newElement(),this.o[o]=pointPool.newElement(),this.i[o]=pointPool.newElement(),o+=1},ShapePath.prototype.setLength=function(a){for(;this._maxLength<a;)this.doubleArrayLength();this._length=a},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(a,s,o,j,$){var _e;switch(this._length=Math.max(this._length,j+1),this._length>=this._maxLength&&this.doubleArrayLength(),o){case"v":_e=this.v;break;case"i":_e=this.i;break;case"o":_e=this.o;break;default:_e=[];break}(!_e[j]||_e[j]&&!$)&&(_e[j]=pointPool.newElement()),_e[j][0]=a,_e[j][1]=s},ShapePath.prototype.setTripleAt=function(a,s,o,j,$,_e,tt,nt){this.setXYAt(a,s,"v",tt,nt),this.setXYAt(o,j,"o",tt,nt),this.setXYAt($,_e,"i",tt,nt)},ShapePath.prototype.reverse=function(){var a=new ShapePath;a.setPathData(this.c,this._length);var s=this.v,o=this.o,j=this.i,$=0;this.c&&(a.setTripleAt(s[0][0],s[0][1],j[0][0],j[0][1],o[0][0],o[0][1],0,!1),$=1);var _e=this._length-1,tt=this._length,nt;for(nt=$;nt<tt;nt+=1)a.setTripleAt(s[_e][0],s[_e][1],j[_e][0],j[_e][1],o[_e][0],o[_e][1],nt,!1),_e-=1;return a};const shapePool=function(){function a(){return new ShapePath}function s($){var _e=$._length,tt;for(tt=0;tt<_e;tt+=1)pointPool.release($.v[tt]),pointPool.release($.i[tt]),pointPool.release($.o[tt]),$.v[tt]=null,$.i[tt]=null,$.o[tt]=null;$._length=0,$.c=!1}function o($){var _e=j.newElement(),tt,nt=$._length===void 0?$.v.length:$._length;for(_e.setLength(nt),_e.c=$.c,tt=0;tt<nt;tt+=1)_e.setTripleAt($.v[tt][0],$.v[tt][1],$.o[tt][0],$.o[tt][1],$.i[tt][0],$.i[tt][1],tt);return _e}var j=poolFactory(4,a,s);return j.clone=o,j}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(a){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=a,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var a;for(a=0;a<this._length;a+=1)shapePool.release(this.shapes[a]);this._length=0};const shapeCollectionPool=function(){var a={newShapeCollection:$,release:_e},s=0,o=4,j=createSizedArray(o);function $(){var tt;return s?(s-=1,tt=j[s]):tt=new ShapeCollection,tt}function _e(tt){var nt,rt=tt._length;for(nt=0;nt<rt;nt+=1)shapePool.release(tt.shapes[nt]);tt._length=0,s===o&&(j=pooling.double(j),o*=2),j[s]=tt,s+=1}return a}(),ShapePropertyFactory=function(){var a=-999999;function s(lt,ut,dt){var gt=dt.lastIndex,Et,St,Tt,Mt,Bt,Rt,Ut,Ht,Wt,Jt=this.keyframes;if(lt<Jt[0].t-this.offsetTime)Et=Jt[0].s[0],Tt=!0,gt=0;else if(lt>=Jt[Jt.length-1].t-this.offsetTime)Et=Jt[Jt.length-1].s?Jt[Jt.length-1].s[0]:Jt[Jt.length-2].e[0],Tt=!0;else{for(var sn=gt,jt=Jt.length-1,Vt=!0,Lt,Qt,nn;Vt&&(Lt=Jt[sn],Qt=Jt[sn+1],!(Qt.t-this.offsetTime>lt));)sn<jt-1?sn+=1:Vt=!1;if(nn=this.keyframesMetadata[sn]||{},Tt=Lt.h===1,gt=sn,!Tt){if(lt>=Qt.t-this.offsetTime)Ht=1;else if(lt<Lt.t-this.offsetTime)Ht=0;else{var mn;nn.__fnct?mn=nn.__fnct:(mn=BezierFactory.getBezierEasing(Lt.o.x,Lt.o.y,Lt.i.x,Lt.i.y).get,nn.__fnct=mn),Ht=mn((lt-(Lt.t-this.offsetTime))/(Qt.t-this.offsetTime-(Lt.t-this.offsetTime)))}St=Qt.s?Qt.s[0]:Lt.e[0]}Et=Lt.s[0]}for(Rt=ut._length,Ut=Et.i[0].length,dt.lastIndex=gt,Mt=0;Mt<Rt;Mt+=1)for(Bt=0;Bt<Ut;Bt+=1)Wt=Tt?Et.i[Mt][Bt]:Et.i[Mt][Bt]+(St.i[Mt][Bt]-Et.i[Mt][Bt])*Ht,ut.i[Mt][Bt]=Wt,Wt=Tt?Et.o[Mt][Bt]:Et.o[Mt][Bt]+(St.o[Mt][Bt]-Et.o[Mt][Bt])*Ht,ut.o[Mt][Bt]=Wt,Wt=Tt?Et.v[Mt][Bt]:Et.v[Mt][Bt]+(St.v[Mt][Bt]-Et.v[Mt][Bt])*Ht,ut.v[Mt][Bt]=Wt}function o(){var lt=this.comp.renderedFrame-this.offsetTime,ut=this.keyframes[0].t-this.offsetTime,dt=this.keyframes[this.keyframes.length-1].t-this.offsetTime,gt=this._caching.lastFrame;return gt!==a&&(gt<ut&&lt<ut||gt>dt&&lt>dt)||(this._caching.lastIndex=gt<lt?this._caching.lastIndex:0,this.interpolateShape(lt,this.pv,this._caching)),this._caching.lastFrame=lt,this.pv}function j(){this.paths=this.localShapeCollection}function $(lt,ut){if(lt._length!==ut._length||lt.c!==ut.c)return!1;var dt,gt=lt._length;for(dt=0;dt<gt;dt+=1)if(lt.v[dt][0]!==ut.v[dt][0]||lt.v[dt][1]!==ut.v[dt][1]||lt.o[dt][0]!==ut.o[dt][0]||lt.o[dt][1]!==ut.o[dt][1]||lt.i[dt][0]!==ut.i[dt][0]||lt.i[dt][1]!==ut.i[dt][1])return!1;return!0}function _e(lt){$(this.v,lt)||(this.v=shapePool.clone(lt),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function tt(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var lt;this.kf?lt=this.pv:this.data.ks?lt=this.data.ks.k:lt=this.data.pt.k;var ut,dt=this.effectsSequence.length;for(ut=0;ut<dt;ut+=1)lt=this.effectsSequence[ut](lt);this.setVValue(lt),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function nt(lt,ut,dt){this.propType="shape",this.comp=lt.comp,this.container=lt,this.elem=lt,this.data=ut,this.k=!1,this.kf=!1,this._mdf=!1;var gt=dt===3?ut.pt.k:ut.ks.k;this.v=shapePool.clone(gt),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=j,this.effectsSequence=[]}function rt(lt){this.effectsSequence.push(lt),this.container.addDynamicProperty(this)}nt.prototype.interpolateShape=s,nt.prototype.getValue=tt,nt.prototype.setVValue=_e,nt.prototype.addEffect=rt;function it(lt,ut,dt){this.propType="shape",this.comp=lt.comp,this.elem=lt,this.container=lt,this.offsetTime=lt.data.st,this.keyframes=dt===3?ut.pt.k:ut.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var gt=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,gt),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=a,this.reset=j,this._caching={lastFrame:a,lastIndex:0},this.effectsSequence=[o.bind(this)]}it.prototype.getValue=tt,it.prototype.interpolateShape=s,it.prototype.setVValue=_e,it.prototype.addEffect=rt;var st=function(){var lt=roundCorner;function ut(dt,gt){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=gt.d,this.elem=dt,this.comp=dt.comp,this.frameId=-1,this.initDynamicPropertyContainer(dt),this.p=PropertyFactory.getProp(dt,gt.p,1,0,this),this.s=PropertyFactory.getProp(dt,gt.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return ut.prototype={reset:j,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var dt=this.p.v[0],gt=this.p.v[1],Et=this.s.v[0]/2,St=this.s.v[1]/2,Tt=this.d!==3,Mt=this.v;Mt.v[0][0]=dt,Mt.v[0][1]=gt-St,Mt.v[1][0]=Tt?dt+Et:dt-Et,Mt.v[1][1]=gt,Mt.v[2][0]=dt,Mt.v[2][1]=gt+St,Mt.v[3][0]=Tt?dt-Et:dt+Et,Mt.v[3][1]=gt,Mt.i[0][0]=Tt?dt-Et*lt:dt+Et*lt,Mt.i[0][1]=gt-St,Mt.i[1][0]=Tt?dt+Et:dt-Et,Mt.i[1][1]=gt-St*lt,Mt.i[2][0]=Tt?dt+Et*lt:dt-Et*lt,Mt.i[2][1]=gt+St,Mt.i[3][0]=Tt?dt-Et:dt+Et,Mt.i[3][1]=gt+St*lt,Mt.o[0][0]=Tt?dt+Et*lt:dt-Et*lt,Mt.o[0][1]=gt-St,Mt.o[1][0]=Tt?dt+Et:dt-Et,Mt.o[1][1]=gt+St*lt,Mt.o[2][0]=Tt?dt-Et*lt:dt+Et*lt,Mt.o[2][1]=gt+St,Mt.o[3][0]=Tt?dt-Et:dt+Et,Mt.o[3][1]=gt-St*lt}},extendPrototype([DynamicPropertyContainer],ut),ut}(),at=function(){function lt(ut,dt){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=ut,this.comp=ut.comp,this.data=dt,this.frameId=-1,this.d=dt.d,this.initDynamicPropertyContainer(ut),dt.sy===1?(this.ir=PropertyFactory.getProp(ut,dt.ir,0,0,this),this.is=PropertyFactory.getProp(ut,dt.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(ut,dt.pt,0,0,this),this.p=PropertyFactory.getProp(ut,dt.p,1,0,this),this.r=PropertyFactory.getProp(ut,dt.r,0,degToRads,this),this.or=PropertyFactory.getProp(ut,dt.or,0,0,this),this.os=PropertyFactory.getProp(ut,dt.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return lt.prototype={reset:j,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var ut=Math.floor(this.pt.v)*2,dt=Math.PI*2/ut,gt=!0,Et=this.or.v,St=this.ir.v,Tt=this.os.v,Mt=this.is.v,Bt=2*Math.PI*Et/(ut*2),Rt=2*Math.PI*St/(ut*2),Ut,Ht,Wt,Jt,sn=-Math.PI/2;sn+=this.r.v;var jt=this.data.d===3?-1:1;for(this.v._length=0,Ut=0;Ut<ut;Ut+=1){Ht=gt?Et:St,Wt=gt?Tt:Mt,Jt=gt?Bt:Rt;var Vt=Ht*Math.cos(sn),Lt=Ht*Math.sin(sn),Qt=Vt===0&&Lt===0?0:Lt/Math.sqrt(Vt*Vt+Lt*Lt),nn=Vt===0&&Lt===0?0:-Vt/Math.sqrt(Vt*Vt+Lt*Lt);Vt+=+this.p.v[0],Lt+=+this.p.v[1],this.v.setTripleAt(Vt,Lt,Vt-Qt*Jt*Wt*jt,Lt-nn*Jt*Wt*jt,Vt+Qt*Jt*Wt*jt,Lt+nn*Jt*Wt*jt,Ut,!0),gt=!gt,sn+=dt*jt}},convertPolygonToPath:function(){var ut=Math.floor(this.pt.v),dt=Math.PI*2/ut,gt=this.or.v,Et=this.os.v,St=2*Math.PI*gt/(ut*4),Tt,Mt=-Math.PI*.5,Bt=this.data.d===3?-1:1;for(Mt+=this.r.v,this.v._length=0,Tt=0;Tt<ut;Tt+=1){var Rt=gt*Math.cos(Mt),Ut=gt*Math.sin(Mt),Ht=Rt===0&&Ut===0?0:Ut/Math.sqrt(Rt*Rt+Ut*Ut),Wt=Rt===0&&Ut===0?0:-Rt/Math.sqrt(Rt*Rt+Ut*Ut);Rt+=+this.p.v[0],Ut+=+this.p.v[1],this.v.setTripleAt(Rt,Ut,Rt-Ht*St*Et*Bt,Ut-Wt*St*Et*Bt,Rt+Ht*St*Et*Bt,Ut+Wt*St*Et*Bt,Tt,!0),Mt+=dt*Bt}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],lt),lt}(),ot=function(){function lt(ut,dt){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=ut,this.comp=ut.comp,this.frameId=-1,this.d=dt.d,this.initDynamicPropertyContainer(ut),this.p=PropertyFactory.getProp(ut,dt.p,1,0,this),this.s=PropertyFactory.getProp(ut,dt.s,1,0,this),this.r=PropertyFactory.getProp(ut,dt.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return lt.prototype={convertRectToPath:function(){var ut=this.p.v[0],dt=this.p.v[1],gt=this.s.v[0]/2,Et=this.s.v[1]/2,St=bmMin(gt,Et,this.r.v),Tt=St*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(ut+gt,dt-Et+St,ut+gt,dt-Et+St,ut+gt,dt-Et+Tt,0,!0),this.v.setTripleAt(ut+gt,dt+Et-St,ut+gt,dt+Et-Tt,ut+gt,dt+Et-St,1,!0),St!==0?(this.v.setTripleAt(ut+gt-St,dt+Et,ut+gt-St,dt+Et,ut+gt-Tt,dt+Et,2,!0),this.v.setTripleAt(ut-gt+St,dt+Et,ut-gt+Tt,dt+Et,ut-gt+St,dt+Et,3,!0),this.v.setTripleAt(ut-gt,dt+Et-St,ut-gt,dt+Et-St,ut-gt,dt+Et-Tt,4,!0),this.v.setTripleAt(ut-gt,dt-Et+St,ut-gt,dt-Et+Tt,ut-gt,dt-Et+St,5,!0),this.v.setTripleAt(ut-gt+St,dt-Et,ut-gt+St,dt-Et,ut-gt+Tt,dt-Et,6,!0),this.v.setTripleAt(ut+gt-St,dt-Et,ut+gt-Tt,dt-Et,ut+gt-St,dt-Et,7,!0)):(this.v.setTripleAt(ut-gt,dt+Et,ut-gt+Tt,dt+Et,ut-gt,dt+Et,2),this.v.setTripleAt(ut-gt,dt-Et,ut-gt,dt-Et+Tt,ut-gt,dt-Et,3))):(this.v.setTripleAt(ut+gt,dt-Et+St,ut+gt,dt-Et+Tt,ut+gt,dt-Et+St,0,!0),St!==0?(this.v.setTripleAt(ut+gt-St,dt-Et,ut+gt-St,dt-Et,ut+gt-Tt,dt-Et,1,!0),this.v.setTripleAt(ut-gt+St,dt-Et,ut-gt+Tt,dt-Et,ut-gt+St,dt-Et,2,!0),this.v.setTripleAt(ut-gt,dt-Et+St,ut-gt,dt-Et+St,ut-gt,dt-Et+Tt,3,!0),this.v.setTripleAt(ut-gt,dt+Et-St,ut-gt,dt+Et-Tt,ut-gt,dt+Et-St,4,!0),this.v.setTripleAt(ut-gt+St,dt+Et,ut-gt+St,dt+Et,ut-gt+Tt,dt+Et,5,!0),this.v.setTripleAt(ut+gt-St,dt+Et,ut+gt-Tt,dt+Et,ut+gt-St,dt+Et,6,!0),this.v.setTripleAt(ut+gt,dt+Et-St,ut+gt,dt+Et-St,ut+gt,dt+Et-Tt,7,!0)):(this.v.setTripleAt(ut-gt,dt-Et,ut-gt+Tt,dt-Et,ut-gt,dt-Et,1,!0),this.v.setTripleAt(ut-gt,dt+Et,ut-gt,dt+Et-Tt,ut-gt,dt+Et,2,!0),this.v.setTripleAt(ut+gt,dt+Et,ut+gt-Tt,dt+Et,ut+gt,dt+Et,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:j},extendPrototype([DynamicPropertyContainer],lt),lt}();function ct(lt,ut,dt){var gt;if(dt===3||dt===4){var Et=dt===3?ut.pt:ut.ks,St=Et.k;St.length?gt=new it(lt,ut,dt):gt=new nt(lt,ut,dt)}else dt===5?gt=new ot(lt,ut):dt===6?gt=new st(lt,ut):dt===7&&(gt=new at(lt,ut));return gt.k&&lt.addDynamicProperty(gt),gt}function ft(){return nt}function ht(){return it}var mt={};return mt.getShapeProp=ct,mt.getConstructorFunction=ft,mt.getKeyframedConstructorFunction=ht,mt}();/*!
Transformation Matrix v2.0
(c) Epistemex 2014-2015
www.epistemex.com
By Ken Fyrstenberg
Contributions by leeoniya.
License: MIT, header required.
*/const Matrix=function(){var a=Math.cos,s=Math.sin,o=Math.tan,j=Math.round;function $(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function _e(Vt){if(Vt===0)return this;var Lt=a(Vt),Qt=s(Vt);return this._t(Lt,-Qt,0,0,Qt,Lt,0,0,0,0,1,0,0,0,0,1)}function tt(Vt){if(Vt===0)return this;var Lt=a(Vt),Qt=s(Vt);return this._t(1,0,0,0,0,Lt,-Qt,0,0,Qt,Lt,0,0,0,0,1)}function nt(Vt){if(Vt===0)return this;var Lt=a(Vt),Qt=s(Vt);return this._t(Lt,0,Qt,0,0,1,0,0,-Qt,0,Lt,0,0,0,0,1)}function rt(Vt){if(Vt===0)return this;var Lt=a(Vt),Qt=s(Vt);return this._t(Lt,-Qt,0,0,Qt,Lt,0,0,0,0,1,0,0,0,0,1)}function it(Vt,Lt){return this._t(1,Lt,Vt,1,0,0)}function st(Vt,Lt){return this.shear(o(Vt),o(Lt))}function at(Vt,Lt){var Qt=a(Lt),nn=s(Lt);return this._t(Qt,nn,0,0,-nn,Qt,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,o(Vt),1,0,0,0,0,1,0,0,0,0,1)._t(Qt,-nn,0,0,nn,Qt,0,0,0,0,1,0,0,0,0,1)}function ot(Vt,Lt,Qt){return!Qt&&Qt!==0&&(Qt=1),Vt===1&&Lt===1&&Qt===1?this:this._t(Vt,0,0,0,0,Lt,0,0,0,0,Qt,0,0,0,0,1)}function ct(Vt,Lt,Qt,nn,mn,Zt,cn,Ot,rn,fn,hn,Tn,Nn,Pn,Dn,ln){return this.props[0]=Vt,this.props[1]=Lt,this.props[2]=Qt,this.props[3]=nn,this.props[4]=mn,this.props[5]=Zt,this.props[6]=cn,this.props[7]=Ot,this.props[8]=rn,this.props[9]=fn,this.props[10]=hn,this.props[11]=Tn,this.props[12]=Nn,this.props[13]=Pn,this.props[14]=Dn,this.props[15]=ln,this}function ft(Vt,Lt,Qt){return Qt=Qt||0,Vt!==0||Lt!==0||Qt!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,Vt,Lt,Qt,1):this}function ht(Vt,Lt,Qt,nn,mn,Zt,cn,Ot,rn,fn,hn,Tn,Nn,Pn,Dn,ln){var Cn=this.props;if(Vt===1&&Lt===0&&Qt===0&&nn===0&&mn===0&&Zt===1&&cn===0&&Ot===0&&rn===0&&fn===0&&hn===1&&Tn===0)return Cn[12]=Cn[12]*Vt+Cn[15]*Nn,Cn[13]=Cn[13]*Zt+Cn[15]*Pn,Cn[14]=Cn[14]*hn+Cn[15]*Dn,Cn[15]*=ln,this._identityCalculated=!1,this;var bn=Cn[0],kn=Cn[1],Sn=Cn[2],xn=Cn[3],Qn=Cn[4],nr=Cn[5],or=Cn[6],mr=Cn[7],$n=Cn[8],tn=Cn[9],$t=Cn[10],An=Cn[11],En=Cn[12],In=Cn[13],Hn=Cn[14],yn=Cn[15];return Cn[0]=bn*Vt+kn*mn+Sn*rn+xn*Nn,Cn[1]=bn*Lt+kn*Zt+Sn*fn+xn*Pn,Cn[2]=bn*Qt+kn*cn+Sn*hn+xn*Dn,Cn[3]=bn*nn+kn*Ot+Sn*Tn+xn*ln,Cn[4]=Qn*Vt+nr*mn+or*rn+mr*Nn,Cn[5]=Qn*Lt+nr*Zt+or*fn+mr*Pn,Cn[6]=Qn*Qt+nr*cn+or*hn+mr*Dn,Cn[7]=Qn*nn+nr*Ot+or*Tn+mr*ln,Cn[8]=$n*Vt+tn*mn+$t*rn+An*Nn,Cn[9]=$n*Lt+tn*Zt+$t*fn+An*Pn,Cn[10]=$n*Qt+tn*cn+$t*hn+An*Dn,Cn[11]=$n*nn+tn*Ot+$t*Tn+An*ln,Cn[12]=En*Vt+In*mn+Hn*rn+yn*Nn,Cn[13]=En*Lt+In*Zt+Hn*fn+yn*Pn,Cn[14]=En*Qt+In*cn+Hn*hn+yn*Dn,Cn[15]=En*nn+In*Ot+Hn*Tn+yn*ln,this._identityCalculated=!1,this}function mt(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function lt(Vt){for(var Lt=0;Lt<16;){if(Vt.props[Lt]!==this.props[Lt])return!1;Lt+=1}return!0}function ut(Vt){var Lt;for(Lt=0;Lt<16;Lt+=1)Vt.props[Lt]=this.props[Lt];return Vt}function dt(Vt){var Lt;for(Lt=0;Lt<16;Lt+=1)this.props[Lt]=Vt[Lt]}function gt(Vt,Lt,Qt){return{x:Vt*this.props[0]+Lt*this.props[4]+Qt*this.props[8]+this.props[12],y:Vt*this.props[1]+Lt*this.props[5]+Qt*this.props[9]+this.props[13],z:Vt*this.props[2]+Lt*this.props[6]+Qt*this.props[10]+this.props[14]}}function Et(Vt,Lt,Qt){return Vt*this.props[0]+Lt*this.props[4]+Qt*this.props[8]+this.props[12]}function St(Vt,Lt,Qt){return Vt*this.props[1]+Lt*this.props[5]+Qt*this.props[9]+this.props[13]}function Tt(Vt,Lt,Qt){return Vt*this.props[2]+Lt*this.props[6]+Qt*this.props[10]+this.props[14]}function Mt(){var Vt=this.props[0]*this.props[5]-this.props[1]*this.props[4],Lt=this.props[5]/Vt,Qt=-this.props[1]/Vt,nn=-this.props[4]/Vt,mn=this.props[0]/Vt,Zt=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/Vt,cn=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/Vt,Ot=new Matrix;return Ot.props[0]=Lt,Ot.props[1]=Qt,Ot.props[4]=nn,Ot.props[5]=mn,Ot.props[12]=Zt,Ot.props[13]=cn,Ot}function Bt(Vt){var Lt=this.getInverseMatrix();return Lt.applyToPointArray(Vt[0],Vt[1],Vt[2]||0)}function Rt(Vt){var Lt,Qt=Vt.length,nn=[];for(Lt=0;Lt<Qt;Lt+=1)nn[Lt]=Bt(Vt[Lt]);return nn}function Ut(Vt,Lt,Qt){var nn=createTypedArray("float32",6);if(this.isIdentity())nn[0]=Vt[0],nn[1]=Vt[1],nn[2]=Lt[0],nn[3]=Lt[1],nn[4]=Qt[0],nn[5]=Qt[1];else{var mn=this.props[0],Zt=this.props[1],cn=this.props[4],Ot=this.props[5],rn=this.props[12],fn=this.props[13];nn[0]=Vt[0]*mn+Vt[1]*cn+rn,nn[1]=Vt[0]*Zt+Vt[1]*Ot+fn,nn[2]=Lt[0]*mn+Lt[1]*cn+rn,nn[3]=Lt[0]*Zt+Lt[1]*Ot+fn,nn[4]=Qt[0]*mn+Qt[1]*cn+rn,nn[5]=Qt[0]*Zt+Qt[1]*Ot+fn}return nn}function Ht(Vt,Lt,Qt){var nn;return this.isIdentity()?nn=[Vt,Lt,Qt]:nn=[Vt*this.props[0]+Lt*this.props[4]+Qt*this.props[8]+this.props[12],Vt*this.props[1]+Lt*this.props[5]+Qt*this.props[9]+this.props[13],Vt*this.props[2]+Lt*this.props[6]+Qt*this.props[10]+this.props[14]],nn}function Wt(Vt,Lt){if(this.isIdentity())return Vt+","+Lt;var Qt=this.props;return Math.round((Vt*Qt[0]+Lt*Qt[4]+Qt[12])*100)/100+","+Math.round((Vt*Qt[1]+Lt*Qt[5]+Qt[13])*100)/100}function Jt(){for(var Vt=0,Lt=this.props,Qt="matrix3d(",nn=1e4;Vt<16;)Qt+=j(Lt[Vt]*nn)/nn,Qt+=Vt===15?")":",",Vt+=1;return Qt}function sn(Vt){var Lt=1e4;return Vt<1e-6&&Vt>0||Vt>-1e-6&&Vt<0?j(Vt*Lt)/Lt:Vt}function jt(){var Vt=this.props,Lt=sn(Vt[0]),Qt=sn(Vt[1]),nn=sn(Vt[4]),mn=sn(Vt[5]),Zt=sn(Vt[12]),cn=sn(Vt[13]);return"matrix("+Lt+","+Qt+","+nn+","+mn+","+Zt+","+cn+")"}return function(){this.reset=$,this.rotate=_e,this.rotateX=tt,this.rotateY=nt,this.rotateZ=rt,this.skew=st,this.skewFromAxis=at,this.shear=it,this.scale=ot,this.setTransform=ct,this.translate=ft,this.transform=ht,this.applyToPoint=gt,this.applyToX=Et,this.applyToY=St,this.applyToZ=Tt,this.applyToPointArray=Ht,this.applyToTriplePoints=Ut,this.applyToPointStringified=Wt,this.toCSS=Jt,this.to2dCSS=jt,this.clone=ut,this.cloneFromProps=dt,this.equals=lt,this.inversePoints=Rt,this.inversePoint=Bt,this.getInverseMatrix=Mt,this._t=this.transform,this.isIdentity=mt,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}(),lottie={};function setLocation(a){setLocationHref(a)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(a){setSubframeEnabled(a)}function setPrefix(a){setIdPrefix(a)}function loadAnimation(a){return animationManager.loadAnimation(a)}function setQuality(a){if(typeof a=="string")switch(a){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(a)&&a>1&&setDefaultCurveSegments(a)}function inBrowser(){return typeof navigator<"u"}function installPlugin(a,s){a==="expressions"&&setExpressionsPlugin(s)}function getFactory(a){switch(a){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="[[BM_VERSION]]";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(a){for(var s=queryString.split("&"),o=0;o<s.length;o+=1){var j=s[o].split("=");if(decodeURIComponent(j[0])==a)return decodeURIComponent(j[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{!(typeof exports=="object"&&typeof module<"u")&&!(typeof define=="function"&&define.amd)&&(window.bodymovin=lottie)}catch(a){}const ShapeModifiers=function(){var a={},s={};a.registerModifier=o,a.getModifier=j;function o($,_e){s[$]||(s[$]=_e)}function j($,_e,tt){return new s[$](_e,tt)}return a}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(a){if(!this.closed){a.sh.container.addDynamicProperty(a.sh);var s={shape:a.sh,data:a,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(s),this.addShapeToModifier(s),this._isAnimated&&a.setAsAnimated()}},ShapeModifier.prototype.init=function(a,s){this.shapes=[],this.elem=a,this.initDynamicPropertyContainer(a),this.initModifierProperties(a,s),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(a,s){this.s=PropertyFactory.getProp(a,s.s,0,.01,this),this.e=PropertyFactory.getProp(a,s.e,0,.01,this),this.o=PropertyFactory.getProp(a,s.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=s.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(a){a.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(a,s,o,j,$){var _e=[];s<=1?_e.push({s:a,e:s}):a>=1?_e.push({s:a-1,e:s-1}):(_e.push({s:a,e:1}),_e.push({s:0,e:s-1}));var tt=[],nt,rt=_e.length,it;for(nt=0;nt<rt;nt+=1)if(it=_e[nt],!(it.e*$<j||it.s*$>j+o)){var st,at;it.s*$<=j?st=0:st=(it.s*$-j)/o,it.e*$>=j+o?at=1:at=(it.e*$-j)/o,tt.push([st,at])}return tt.length||tt.push([0,0]),tt},TrimModifier.prototype.releasePathsData=function(a){var s,o=a.length;for(s=0;s<o;s+=1)segmentsLengthPool.release(a[s]);return a.length=0,a},TrimModifier.prototype.processShapes=function(a){var s,o;if(this._mdf||a){var j=this.o.v%360/360;if(j<0&&(j+=1),this.s.v>1?s=1+j:this.s.v<0?s=0+j:s=this.s.v+j,this.e.v>1?o=1+j:this.e.v<0?o=0+j:o=this.e.v+j,s>o){var $=s;s=o,o=$}s=Math.round(s*1e4)*1e-4,o=Math.round(o*1e4)*1e-4,this.sValue=s,this.eValue=o}else s=this.sValue,o=this.eValue;var _e,tt,nt=this.shapes.length,rt,it,st,at,ot,ct=0;if(o===s)for(tt=0;tt<nt;tt+=1)this.shapes[tt].localShapeCollection.releaseShapes(),this.shapes[tt].shape._mdf=!0,this.shapes[tt].shape.paths=this.shapes[tt].localShapeCollection,this._mdf&&(this.shapes[tt].pathsData.length=0);else if(o===1&&s===0||o===0&&s===1){if(this._mdf)for(tt=0;tt<nt;tt+=1)this.shapes[tt].pathsData.length=0,this.shapes[tt].shape._mdf=!0}else{var ft=[],ht,mt;for(tt=0;tt<nt;tt+=1)if(ht=this.shapes[tt],!ht.shape._mdf&&!this._mdf&&!a&&this.m!==2)ht.shape.paths=ht.localShapeCollection;else{if(_e=ht.shape.paths,it=_e._length,ot=0,!ht.shape._mdf&&ht.pathsData.length)ot=ht.totalShapeLength;else{for(st=this.releasePathsData(ht.pathsData),rt=0;rt<it;rt+=1)at=bez.getSegmentsLength(_e.shapes[rt]),st.push(at),ot+=at.totalLength;ht.totalShapeLength=ot,ht.pathsData=st}ct+=ot,ht.shape._mdf=!0}var lt=s,ut=o,dt=0,gt;for(tt=nt-1;tt>=0;tt-=1)if(ht=this.shapes[tt],ht.shape._mdf){for(mt=ht.localShapeCollection,mt.releaseShapes(),this.m===2&&nt>1?(gt=this.calculateShapeEdges(s,o,ht.totalShapeLength,dt,ct),dt+=ht.totalShapeLength):gt=[[lt,ut]],it=gt.length,rt=0;rt<it;rt+=1){lt=gt[rt][0],ut=gt[rt][1],ft.length=0,ut<=1?ft.push({s:ht.totalShapeLength*lt,e:ht.totalShapeLength*ut}):lt>=1?ft.push({s:ht.totalShapeLength*(lt-1),e:ht.totalShapeLength*(ut-1)}):(ft.push({s:ht.totalShapeLength*lt,e:ht.totalShapeLength}),ft.push({s:0,e:ht.totalShapeLength*(ut-1)}));var Et=this.addShapes(ht,ft[0]);if(ft[0].s!==ft[0].e){if(ft.length>1){var St=ht.shape.paths.shapes[ht.shape.paths._length-1];if(St.c){var Tt=Et.pop();this.addPaths(Et,mt),Et=this.addShapes(ht,ft[1],Tt)}else this.addPaths(Et,mt),Et=this.addShapes(ht,ft[1])}this.addPaths(Et,mt)}}ht.shape.paths=mt}}},TrimModifier.prototype.addPaths=function(a,s){var o,j=a.length;for(o=0;o<j;o+=1)s.addShape(a[o])},TrimModifier.prototype.addSegment=function(a,s,o,j,$,_e,tt){$.setXYAt(s[0],s[1],"o",_e),$.setXYAt(o[0],o[1],"i",_e+1),tt&&$.setXYAt(a[0],a[1],"v",_e),$.setXYAt(j[0],j[1],"v",_e+1)},TrimModifier.prototype.addSegmentFromArray=function(a,s,o,j){s.setXYAt(a[1],a[5],"o",o),s.setXYAt(a[2],a[6],"i",o+1),j&&s.setXYAt(a[0],a[4],"v",o),s.setXYAt(a[3],a[7],"v",o+1)},TrimModifier.prototype.addShapes=function(a,s,o){var j=a.pathsData,$=a.shape.paths.shapes,_e,tt=a.shape.paths._length,nt,rt,it=0,st,at,ot,ct,ft=[],ht,mt=!0;for(o?(at=o._length,ht=o._length):(o=shapePool.newElement(),at=0,ht=0),ft.push(o),_e=0;_e<tt;_e+=1){for(ot=j[_e].lengths,o.c=$[_e].c,rt=$[_e].c?ot.length:ot.length+1,nt=1;nt<rt;nt+=1)if(st=ot[nt-1],it+st.addedLength<s.s)it+=st.addedLength,o.c=!1;else if(it>s.e){o.c=!1;break}else s.s<=it&&s.e>=it+st.addedLength?(this.addSegment($[_e].v[nt-1],$[_e].o[nt-1],$[_e].i[nt],$[_e].v[nt],o,at,mt),mt=!1):(ct=bez.getNewSegment($[_e].v[nt-1],$[_e].v[nt],$[_e].o[nt-1],$[_e].i[nt],(s.s-it)/st.addedLength,(s.e-it)/st.addedLength,ot[nt-1]),this.addSegmentFromArray(ct,o,at,mt),mt=!1,o.c=!1),it+=st.addedLength,at+=1;if($[_e].c&&ot.length){if(st=ot[nt-1],it<=s.e){var lt=ot[nt-1].addedLength;s.s<=it&&s.e>=it+lt?(this.addSegment($[_e].v[nt-1],$[_e].o[nt-1],$[_e].i[0],$[_e].v[0],o,at,mt),mt=!1):(ct=bez.getNewSegment($[_e].v[nt-1],$[_e].v[0],$[_e].o[nt-1],$[_e].i[0],(s.s-it)/lt,(s.e-it)/lt,ot[nt-1]),this.addSegmentFromArray(ct,o,at,mt),mt=!1,o.c=!1)}else o.c=!1;it+=st.addedLength,at+=1}if(o._length&&(o.setXYAt(o.v[ht][0],o.v[ht][1],"i",ht),o.setXYAt(o.v[o._length-1][0],o.v[o._length-1][1],"o",o._length-1)),it>s.e)break;_e<tt-1&&(o=shapePool.newElement(),mt=!0,ft.push(o),at=0)}return ft};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(a,s){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(a,s.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(a,s){var o=s/100,j=[0,0],$=a._length,_e=0;for(_e=0;_e<$;_e+=1)j[0]+=a.v[_e][0],j[1]+=a.v[_e][1];j[0]/=$,j[1]/=$;var tt=shapePool.newElement();tt.c=a.c;var nt,rt,it,st,at,ot;for(_e=0;_e<$;_e+=1)nt=a.v[_e][0]+(j[0]-a.v[_e][0])*o,rt=a.v[_e][1]+(j[1]-a.v[_e][1])*o,it=a.o[_e][0]+(j[0]-a.o[_e][0])*-o,st=a.o[_e][1]+(j[1]-a.o[_e][1])*-o,at=a.i[_e][0]+(j[0]-a.i[_e][0])*-o,ot=a.i[_e][1]+(j[1]-a.i[_e][1])*-o,tt.setTripleAt(nt,rt,it,st,at,ot,_e);return tt},PuckerAndBloatModifier.prototype.processShapes=function(a){var s,o,j=this.shapes.length,$,_e,tt=this.amount.v;if(tt!==0){var nt,rt;for(o=0;o<j;o+=1){if(nt=this.shapes[o],rt=nt.localShapeCollection,!(!nt.shape._mdf&&!this._mdf&&!a))for(rt.releaseShapes(),nt.shape._mdf=!0,s=nt.shape.paths.shapes,_e=nt.shape.paths._length,$=0;$<_e;$+=1)rt.addShape(this.processPath(s[$],tt));nt.shape.paths=nt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};const TransformPropertyFactory=function(){var a=[0,0];function s(rt){var it=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||it,this.a&&rt.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&rt.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&rt.skewFromAxis(-this.sk.v,this.sa.v),this.r?rt.rotate(-this.r.v):rt.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?rt.translate(this.px.v,this.py.v,-this.pz.v):rt.translate(this.px.v,this.py.v,0):rt.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function o(rt){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||rt){var it;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var st,at;if(it=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(st=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/it,0),at=this.p.getValueAtTime(this.p.keyframes[0].t/it,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(st=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/it,0),at=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/it,0)):(st=this.p.pv,at=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/it,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){st=[],at=[];var ot=this.px,ct=this.py;ot._caching.lastFrame+ot.offsetTime<=ot.keyframes[0].t?(st[0]=ot.getValueAtTime((ot.keyframes[0].t+.01)/it,0),st[1]=ct.getValueAtTime((ct.keyframes[0].t+.01)/it,0),at[0]=ot.getValueAtTime(ot.keyframes[0].t/it,0),at[1]=ct.getValueAtTime(ct.keyframes[0].t/it,0)):ot._caching.lastFrame+ot.offsetTime>=ot.keyframes[ot.keyframes.length-1].t?(st[0]=ot.getValueAtTime(ot.keyframes[ot.keyframes.length-1].t/it,0),st[1]=ct.getValueAtTime(ct.keyframes[ct.keyframes.length-1].t/it,0),at[0]=ot.getValueAtTime((ot.keyframes[ot.keyframes.length-1].t-.01)/it,0),at[1]=ct.getValueAtTime((ct.keyframes[ct.keyframes.length-1].t-.01)/it,0)):(st=[ot.pv,ct.pv],at[0]=ot.getValueAtTime((ot._caching.lastFrame+ot.offsetTime-.01)/it,ot.offsetTime),at[1]=ct.getValueAtTime((ct._caching.lastFrame+ct.offsetTime-.01)/it,ct.offsetTime))}else at=a,st=at;this.v.rotate(-Math.atan2(st[1]-at[1],st[0]-at[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function j(){if(!this.a.k)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function $(){}function _e(rt){this._addDynamicProperty(rt),this.elem.addDynamicProperty(rt),this._isDirty=!0}function tt(rt,it,st){if(this.elem=rt,this.frameId=-1,this.propType="transform",this.data=it,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(st||rt),it.p&&it.p.s?(this.px=PropertyFactory.getProp(rt,it.p.x,0,0,this),this.py=PropertyFactory.getProp(rt,it.p.y,0,0,this),it.p.z&&(this.pz=PropertyFactory.getProp(rt,it.p.z,0,0,this))):this.p=PropertyFactory.getProp(rt,it.p||{k:[0,0,0]},1,0,this),it.rx){if(this.rx=PropertyFactory.getProp(rt,it.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(rt,it.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(rt,it.rz,0,degToRads,this),it.or.k[0].ti){var at,ot=it.or.k.length;for(at=0;at<ot;at+=1)it.or.k[at].to=null,it.or.k[at].ti=null}this.or=PropertyFactory.getProp(rt,it.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(rt,it.r||{k:0},0,degToRads,this);it.sk&&(this.sk=PropertyFactory.getProp(rt,it.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(rt,it.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(rt,it.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(rt,it.s||{k:[100,100,100]},1,.01,this),it.o?this.o=PropertyFactory.getProp(rt,it.o,0,.01,rt):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}tt.prototype={applyToMatrix:s,getValue:o,precalculateMatrix:j,autoOrient:$},extendPrototype([DynamicPropertyContainer],tt),tt.prototype.addDynamicProperty=_e,tt.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function nt(rt,it,st){return new tt(rt,it,st)}return{getTransformProperty:nt}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(a,s){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(a,s.c,0,null,this),this.o=PropertyFactory.getProp(a,s.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(a,s.tr,this),this.so=PropertyFactory.getProp(a,s.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(a,s.tr.eo,0,.01,this),this.data=s,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(a,s,o,j,$,_e){var tt=_e?-1:1,nt=j.s.v[0]+(1-j.s.v[0])*(1-$),rt=j.s.v[1]+(1-j.s.v[1])*(1-$);a.translate(j.p.v[0]*tt*$,j.p.v[1]*tt*$,j.p.v[2]),s.translate(-j.a.v[0],-j.a.v[1],j.a.v[2]),s.rotate(-j.r.v*tt*$),s.translate(j.a.v[0],j.a.v[1],j.a.v[2]),o.translate(-j.a.v[0],-j.a.v[1],j.a.v[2]),o.scale(_e?1/nt:nt,_e?1/rt:rt),o.translate(j.a.v[0],j.a.v[1],j.a.v[2])},RepeaterModifier.prototype.init=function(a,s,o,j){for(this.elem=a,this.arr=s,this.pos=o,this.elemsData=j,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(a),this.initModifierProperties(a,s[o]);o>0;)o-=1,this._elements.unshift(s[o]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(a){var s,o=a.length;for(s=0;s<o;s+=1)a[s]._processed=!1,a[s].ty==="gr"&&this.resetElements(a[s].it)},RepeaterModifier.prototype.cloneElements=function(a){var s=JSON.parse(JSON.stringify(a));return this.resetElements(s),s},RepeaterModifier.prototype.changeGroupRender=function(a,s){var o,j=a.length;for(o=0;o<j;o+=1)a[o]._render=s,a[o].ty==="gr"&&this.changeGroupRender(a[o].it,s)},RepeaterModifier.prototype.processShapes=function(a){var s,o,j,$,_e,tt=!1;if(this._mdf||a){var nt=Math.ceil(this.c.v);if(this._groups.length<nt){for(;this._groups.length<nt;){var rt={it:this.cloneElements(this._elements),ty:"gr"};rt.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,rt),this._groups.splice(0,0,rt),this._currentCopies+=1}this.elem.reloadShapes(),tt=!0}_e=0;var it;for(j=0;j<=this._groups.length-1;j+=1){if(it=_e<nt,this._groups[j]._render=it,this.changeGroupRender(this._groups[j].it,it),!it){var st=this.elemsData[j].it,at=st[st.length-1];at.transform.op.v!==0?(at.transform.op._mdf=!0,at.transform.op.v=0):at.transform.op._mdf=!1}_e+=1}this._currentCopies=nt;var ot=this.o.v,ct=ot%1,ft=ot>0?Math.floor(ot):Math.ceil(ot),ht=this.pMatrix.props,mt=this.rMatrix.props,lt=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var ut=0;if(ot>0){for(;ut<ft;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),ut+=1;ct&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,ct,!1),ut+=ct)}else if(ot<0){for(;ut>ft;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),ut-=1;ct&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-ct,!0),ut-=ct)}j=this.data.m===1?0:this._currentCopies-1,$=this.data.m===1?1:-1,_e=this._currentCopies;for(var dt,gt;_e;){if(s=this.elemsData[j].it,o=s[s.length-1].transform.mProps.v.props,gt=o.length,s[s.length-1].transform.mProps._mdf=!0,s[s.length-1].transform.op._mdf=!0,s[s.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(j/(this._currentCopies-1)),ut!==0){for((j!==0&&$===1||j!==this._currentCopies-1&&$===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(mt[0],mt[1],mt[2],mt[3],mt[4],mt[5],mt[6],mt[7],mt[8],mt[9],mt[10],mt[11],mt[12],mt[13],mt[14],mt[15]),this.matrix.transform(lt[0],lt[1],lt[2],lt[3],lt[4],lt[5],lt[6],lt[7],lt[8],lt[9],lt[10],lt[11],lt[12],lt[13],lt[14],lt[15]),this.matrix.transform(ht[0],ht[1],ht[2],ht[3],ht[4],ht[5],ht[6],ht[7],ht[8],ht[9],ht[10],ht[11],ht[12],ht[13],ht[14],ht[15]),dt=0;dt<gt;dt+=1)o[dt]=this.matrix.props[dt];this.matrix.reset()}else for(this.matrix.reset(),dt=0;dt<gt;dt+=1)o[dt]=this.matrix.props[dt];ut+=1,_e-=1,j+=$}}else for(_e=this._currentCopies,j=0,$=1;_e;)s=this.elemsData[j].it,o=s[s.length-1].transform.mProps.v.props,s[s.length-1].transform.mProps._mdf=!1,s[s.length-1].transform.op._mdf=!1,_e-=1,j+=$;return tt},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(a,s){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(a,s.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(a,s){var o=shapePool.newElement();o.c=a.c;var j,$=a._length,_e,tt,nt,rt,it,st,at=0,ot,ct,ft,ht,mt,lt;for(j=0;j<$;j+=1)_e=a.v[j],nt=a.o[j],tt=a.i[j],_e[0]===nt[0]&&_e[1]===nt[1]&&_e[0]===tt[0]&&_e[1]===tt[1]?(j===0||j===$-1)&&!a.c?(o.setTripleAt(_e[0],_e[1],nt[0],nt[1],tt[0],tt[1],at),at+=1):(j===0?rt=a.v[$-1]:rt=a.v[j-1],it=Math.sqrt(Math.pow(_e[0]-rt[0],2)+Math.pow(_e[1]-rt[1],2)),st=it?Math.min(it/2,s)/it:0,mt=_e[0]+(rt[0]-_e[0])*st,ot=mt,lt=_e[1]-(_e[1]-rt[1])*st,ct=lt,ft=ot-(ot-_e[0])*roundCorner,ht=ct-(ct-_e[1])*roundCorner,o.setTripleAt(ot,ct,ft,ht,mt,lt,at),at+=1,j===$-1?rt=a.v[0]:rt=a.v[j+1],it=Math.sqrt(Math.pow(_e[0]-rt[0],2)+Math.pow(_e[1]-rt[1],2)),st=it?Math.min(it/2,s)/it:0,ft=_e[0]+(rt[0]-_e[0])*st,ot=ft,ht=_e[1]+(rt[1]-_e[1])*st,ct=ht,mt=ot-(ot-_e[0])*roundCorner,lt=ct-(ct-_e[1])*roundCorner,o.setTripleAt(ot,ct,ft,ht,mt,lt,at),at+=1):(o.setTripleAt(a.v[j][0],a.v[j][1],a.o[j][0],a.o[j][1],a.i[j][0],a.i[j][1],at),at+=1);return o},RoundCornersModifier.prototype.processShapes=function(a){var s,o,j=this.shapes.length,$,_e,tt=this.rd.v;if(tt!==0){var nt,rt;for(o=0;o<j;o+=1){if(nt=this.shapes[o],rt=nt.localShapeCollection,!(!nt.shape._mdf&&!this._mdf&&!a))for(rt.releaseShapes(),nt.shape._mdf=!0,s=nt.shape.paths.shapes,_e=nt.shape.paths._length,$=0;$<_e;$+=1)rt.addShape(this.processPath(s[$],tt));nt.shape.paths=nt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(a){for(var s=a.fStyle?a.fStyle.split(" "):[],o="normal",j="normal",$=s.length,_e,tt=0;tt<$;tt+=1)switch(_e=s[tt].toLowerCase(),_e){case"italic":j="italic";break;case"bold":o="700";break;case"black":o="900";break;case"medium":o="500";break;case"regular":case"normal":o="400";break;case"light":case"thin":o="200";break}return{style:j,weight:a.fWeight||o}}const FontManager=function(){var a=5e3,s={w:0,size:0,shapes:[],data:{shapes:[]}},o=[];o=o.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var j=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],$=[65039,8205];function _e(gt){var Et=gt.split(","),St,Tt=Et.length,Mt=[];for(St=0;St<Tt;St+=1)Et[St]!=="sans-serif"&&Et[St]!=="monospace"&&Mt.push(Et[St]);return Mt.join(",")}function tt(gt,Et){var St=createTag("span");St.setAttribute("aria-hidden",!0),St.style.fontFamily=Et;var Tt=createTag("span");Tt.innerText="giItT1WQy@!-/#",St.style.position="absolute",St.style.left="-10000px",St.style.top="-10000px",St.style.fontSize="300px",St.style.fontVariant="normal",St.style.fontStyle="normal",St.style.fontWeight="normal",St.style.letterSpacing="0",St.appendChild(Tt),document.body.appendChild(St);var Mt=Tt.offsetWidth;return Tt.style.fontFamily=_e(gt)+", "+Et,{node:Tt,w:Mt,parent:St}}function nt(){var gt,Et=this.fonts.length,St,Tt,Mt=Et;for(gt=0;gt<Et;gt+=1)this.fonts[gt].loaded?Mt-=1:this.fonts[gt].fOrigin==="n"||this.fonts[gt].origin===0?this.fonts[gt].loaded=!0:(St=this.fonts[gt].monoCase.node,Tt=this.fonts[gt].monoCase.w,St.offsetWidth!==Tt?(Mt-=1,this.fonts[gt].loaded=!0):(St=this.fonts[gt].sansCase.node,Tt=this.fonts[gt].sansCase.w,St.offsetWidth!==Tt&&(Mt-=1,this.fonts[gt].loaded=!0)),this.fonts[gt].loaded&&(this.fonts[gt].sansCase.parent.parentNode.removeChild(this.fonts[gt].sansCase.parent),this.fonts[gt].monoCase.parent.parentNode.removeChild(this.fonts[gt].monoCase.parent)));Mt!==0&&Date.now()-this.initTime<a?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function rt(gt,Et){var St=document.body&&Et?"svg":"canvas",Tt,Mt=getFontProperties(gt);if(St==="svg"){var Bt=createNS("text");Bt.style.fontSize="100px",Bt.setAttribute("font-family",gt.fFamily),Bt.setAttribute("font-style",Mt.style),Bt.setAttribute("font-weight",Mt.weight),Bt.textContent="1",gt.fClass?(Bt.style.fontFamily="inherit",Bt.setAttribute("class",gt.fClass)):Bt.style.fontFamily=gt.fFamily,Et.appendChild(Bt),Tt=Bt}else{var Rt=new OffscreenCanvas(500,500).getContext("2d");Rt.font=Mt.style+" "+Mt.weight+" 100px "+gt.fFamily,Tt=Rt}function Ut(Ht){return St==="svg"?(Tt.textContent=Ht,Tt.getComputedTextLength()):Tt.measureText(Ht).width}return{measureText:Ut}}function it(gt,Et){if(!gt){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=gt.list;return}if(!document.body){this.isLoaded=!0,gt.list.forEach(jt=>{jt.helper=rt(jt),jt.cache={}}),this.fonts=gt.list;return}var St=gt.list,Tt,Mt=St.length,Bt=Mt;for(Tt=0;Tt<Mt;Tt+=1){var Rt=!0,Ut,Ht;if(St[Tt].loaded=!1,St[Tt].monoCase=tt(St[Tt].fFamily,"monospace"),St[Tt].sansCase=tt(St[Tt].fFamily,"sans-serif"),!St[Tt].fPath)St[Tt].loaded=!0,Bt-=1;else if(St[Tt].fOrigin==="p"||St[Tt].origin===3){if(Ut=document.querySelectorAll('style[f-forigin="p"][f-family="'+St[Tt].fFamily+'"], style[f-origin="3"][f-family="'+St[Tt].fFamily+'"]'),Ut.length>0&&(Rt=!1),Rt){var Wt=createTag("style");Wt.setAttribute("f-forigin",St[Tt].fOrigin),Wt.setAttribute("f-origin",St[Tt].origin),Wt.setAttribute("f-family",St[Tt].fFamily),Wt.type="text/css",Wt.innerText="@font-face {font-family: "+St[Tt].fFamily+"; font-style: normal; src: url('"+St[Tt].fPath+"');}",Et.appendChild(Wt)}}else if(St[Tt].fOrigin==="g"||St[Tt].origin===1){for(Ut=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),Ht=0;Ht<Ut.length;Ht+=1)Ut[Ht].href.indexOf(St[Tt].fPath)!==-1&&(Rt=!1);if(Rt){var Jt=createTag("link");Jt.setAttribute("f-forigin",St[Tt].fOrigin),Jt.setAttribute("f-origin",St[Tt].origin),Jt.type="text/css",Jt.rel="stylesheet",Jt.href=St[Tt].fPath,document.body.appendChild(Jt)}}else if(St[Tt].fOrigin==="t"||St[Tt].origin===2){for(Ut=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),Ht=0;Ht<Ut.length;Ht+=1)St[Tt].fPath===Ut[Ht].src&&(Rt=!1);if(Rt){var sn=createTag("link");sn.setAttribute("f-forigin",St[Tt].fOrigin),sn.setAttribute("f-origin",St[Tt].origin),sn.setAttribute("rel","stylesheet"),sn.setAttribute("href",St[Tt].fPath),Et.appendChild(sn)}}St[Tt].helper=rt(St[Tt],Et),St[Tt].cache={},this.fonts.push(St[Tt])}Bt===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function st(gt){if(gt){this.chars||(this.chars=[]);var Et,St=gt.length,Tt,Mt=this.chars.length,Bt;for(Et=0;Et<St;Et+=1){for(Tt=0,Bt=!1;Tt<Mt;)this.chars[Tt].style===gt[Et].style&&this.chars[Tt].fFamily===gt[Et].fFamily&&this.chars[Tt].ch===gt[Et].ch&&(Bt=!0),Tt+=1;Bt||(this.chars.push(gt[Et]),Mt+=1)}}}function at(gt,Et,St){for(var Tt=0,Mt=this.chars.length;Tt<Mt;){if(this.chars[Tt].ch===gt&&this.chars[Tt].style===Et&&this.chars[Tt].fFamily===St)return this.chars[Tt];Tt+=1}return(typeof gt=="string"&&gt.charCodeAt(0)!==13||!gt)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",gt,Et,St)),s}function ot(gt,Et,St){var Tt=this.getFontByName(Et),Mt=gt.charCodeAt(0);if(!Tt.cache[Mt+1]){var Bt=Tt.helper;if(gt===" "){var Rt=Bt.measureText("|"+gt+"|"),Ut=Bt.measureText("||");Tt.cache[Mt+1]=(Rt-Ut)/100}else Tt.cache[Mt+1]=Bt.measureText(gt)/100}return Tt.cache[Mt+1]*St}function ct(gt){for(var Et=0,St=this.fonts.length;Et<St;){if(this.fonts[Et].fName===gt)return this.fonts[Et];Et+=1}return this.fonts[0]}function ft(gt,Et){var St=gt.toString(16)+Et.toString(16);return j.indexOf(St)!==-1}function ht(gt,Et){return Et?gt===$[0]&&Et===$[1]:gt===$[1]}function mt(gt){return o.indexOf(gt)!==-1}function lt(){this.isLoaded=!0}var ut=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};ut.isModifier=ft,ut.isZeroWidthJoiner=ht,ut.isCombinedCharacter=mt;var dt={addChars:st,addFonts:it,getCharData:at,getFontByName:ct,measureText:ot,checkLoadedFonts:nt,setIsLoaded:lt};return ut.prototype=dt,ut}();function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(a){this.renderableComponents.indexOf(a)===-1&&this.renderableComponents.push(a)},removeRenderableComponent:function(a){this.renderableComponents.indexOf(a)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(a),1)},prepareRenderableFrame:function(a){this.checkLayerLimits(a)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(a){this.data.ip-this.data.st<=a&&this.data.op-this.data.st>a?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var a,s=this.renderableComponents.length;for(a=0;a<s;a+=1)this.renderableComponents[a].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};const MaskManagerInterface=function(){function a(o,j){this._mask=o,this._data=j}Object.defineProperty(a.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(a.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var s=function(o){var j=createSizedArray(o.viewData.length),$,_e=o.viewData.length;for($=0;$<_e;$+=1)j[$]=new a(o.viewData[$],o.masksProperties[$]);var tt=function(nt){for($=0;$<_e;){if(o.masksProperties[$].nm===nt)return j[$];$+=1}return null};return tt};return s}(),ExpressionPropertyInterface=function(){var a={pv:0,v:0,mult:1},s={pv:[0,0,0],v:[0,0,0],mult:1};function o(tt,nt,rt){Object.defineProperty(tt,"velocity",{get:function(){return nt.getVelocityAtTime(nt.comp.currentFrame)}}),tt.numKeys=nt.keyframes?nt.keyframes.length:0,tt.key=function(it){if(!tt.numKeys)return 0;var st="";"s"in nt.keyframes[it-1]?st=nt.keyframes[it-1].s:"e"in nt.keyframes[it-2]?st=nt.keyframes[it-2].e:st=nt.keyframes[it-2].s;var at=rt==="unidimensional"?new Number(st):Object.assign({},st);return at.time=nt.keyframes[it-1].t/nt.elem.comp.globalData.frameRate,at.value=rt==="unidimensional"?st[0]:st,at},tt.valueAtTime=nt.getValueAtTime,tt.speedAtTime=nt.getSpeedAtTime,tt.velocityAtTime=nt.getVelocityAtTime,tt.propertyGroup=nt.propertyGroup}function j(tt){(!tt||!("pv"in tt))&&(tt=a);var nt=1/tt.mult,rt=tt.pv*nt,it=new Number(rt);return it.value=rt,o(it,tt,"unidimensional"),function(){return tt.k&&tt.getValue(),rt=tt.v*nt,it.value!==rt&&(it=new Number(rt),it.value=rt,o(it,tt,"unidimensional")),it}}function $(tt){(!tt||!("pv"in tt))&&(tt=s);var nt=1/tt.mult,rt=tt.data&&tt.data.l||tt.pv.length,it=createTypedArray("float32",rt),st=createTypedArray("float32",rt);return it.value=st,o(it,tt,"multidimensional"),function(){tt.k&&tt.getValue();for(var at=0;at<rt;at+=1)st[at]=tt.v[at]*nt,it[at]=st[at];return it}}function _e(){return a}return function(tt){return tt?tt.propType==="unidimensional"?j(tt):$(tt):_e}}(),TransformExpressionInterface=function(){return function(a){function s(tt){switch(tt){case"scale":case"Scale":case"ADBE Scale":case 6:return s.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return s.rotation;case"ADBE Rotate X":return s.xRotation;case"ADBE Rotate Y":return s.yRotation;case"position":case"Position":case"ADBE Position":case 2:return s.position;case"ADBE Position_0":return s.xPosition;case"ADBE Position_1":return s.yPosition;case"ADBE Position_2":return s.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return s.anchorPoint;case"opacity":case"Opacity":case 11:return s.opacity;default:return null}}Object.defineProperty(s,"rotation",{get:ExpressionPropertyInterface(a.r||a.rz)}),Object.defineProperty(s,"zRotation",{get:ExpressionPropertyInterface(a.rz||a.r)}),Object.defineProperty(s,"xRotation",{get:ExpressionPropertyInterface(a.rx)}),Object.defineProperty(s,"yRotation",{get:ExpressionPropertyInterface(a.ry)}),Object.defineProperty(s,"scale",{get:ExpressionPropertyInterface(a.s)});var o,j,$,_e;return a.p?_e=ExpressionPropertyInterface(a.p):(o=ExpressionPropertyInterface(a.px),j=ExpressionPropertyInterface(a.py),a.pz&&($=ExpressionPropertyInterface(a.pz))),Object.defineProperty(s,"position",{get:function(){return a.p?_e():[o(),j(),$?$():0]}}),Object.defineProperty(s,"xPosition",{get:ExpressionPropertyInterface(a.px)}),Object.defineProperty(s,"yPosition",{get:ExpressionPropertyInterface(a.py)}),Object.defineProperty(s,"zPosition",{get:ExpressionPropertyInterface(a.pz)}),Object.defineProperty(s,"anchorPoint",{get:ExpressionPropertyInterface(a.a)}),Object.defineProperty(s,"opacity",{get:ExpressionPropertyInterface(a.o)}),Object.defineProperty(s,"skew",{get:ExpressionPropertyInterface(a.sk)}),Object.defineProperty(s,"skewAxis",{get:ExpressionPropertyInterface(a.sa)}),Object.defineProperty(s,"orientation",{get:ExpressionPropertyInterface(a.or)}),s}}(),LayerExpressionInterface=function(){function a(it){var st=new Matrix;if(it!==void 0){var at=this._elem.finalTransform.mProp.getValueAtTime(it);at.clone(st)}else{var ot=this._elem.finalTransform.mProp;ot.applyToMatrix(st)}return st}function s(it,st){var at=this.getMatrix(st);return at.props[12]=0,at.props[13]=0,at.props[14]=0,this.applyPoint(at,it)}function o(it,st){var at=this.getMatrix(st);return this.applyPoint(at,it)}function j(it,st){var at=this.getMatrix(st);return at.props[12]=0,at.props[13]=0,at.props[14]=0,this.invertPoint(at,it)}function $(it,st){var at=this.getMatrix(st);return this.invertPoint(at,it)}function _e(it,st){if(this._elem.hierarchy&&this._elem.hierarchy.length){var at,ot=this._elem.hierarchy.length;for(at=0;at<ot;at+=1)this._elem.hierarchy[at].finalTransform.mProp.applyToMatrix(it)}return it.applyToPointArray(st[0],st[1],st[2]||0)}function tt(it,st){if(this._elem.hierarchy&&this._elem.hierarchy.length){var at,ot=this._elem.hierarchy.length;for(at=0;at<ot;at+=1)this._elem.hierarchy[at].finalTransform.mProp.applyToMatrix(it)}return it.inversePoint(st)}function nt(it){var st=new Matrix;if(st.reset(),this._elem.finalTransform.mProp.applyToMatrix(st),this._elem.hierarchy&&this._elem.hierarchy.length){var at,ot=this._elem.hierarchy.length;for(at=0;at<ot;at+=1)this._elem.hierarchy[at].finalTransform.mProp.applyToMatrix(st);return st.inversePoint(it)}return st.inversePoint(it)}function rt(){return[1,1,1,1]}return function(it){var st;function at(ht){ct.mask=new MaskManagerInterface(ht,it)}function ot(ht){ct.effect=ht}function ct(ht){switch(ht){case"ADBE Root Vectors Group":case"Contents":case 2:return ct.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return st;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return ct.effect;case"ADBE Text Properties":return ct.textInterface;default:return null}}ct.getMatrix=a,ct.invertPoint=tt,ct.applyPoint=_e,ct.toWorld=o,ct.toWorldVec=s,ct.fromWorld=$,ct.fromWorldVec=j,ct.toComp=o,ct.fromComp=nt,ct.sampleImage=rt,ct.sourceRectAtTime=it.sourceRectAtTime.bind(it),ct._elem=it,st=TransformExpressionInterface(it.finalTransform.mProp);var ft=getDescriptor(st,"anchorPoint");return Object.defineProperties(ct,{hasParent:{get:function(){return it.hierarchy.length}},parent:{get:function(){return it.hierarchy[0].layerInterface}},rotation:getDescriptor(st,"rotation"),scale:getDescriptor(st,"scale"),position:getDescriptor(st,"position"),opacity:getDescriptor(st,"opacity"),anchorPoint:ft,anchor_point:ft,transform:{get:function(){return st}},active:{get:function(){return it.isInRange}}}),ct.startTime=it.data.st,ct.index=it.data.ind,ct.source=it.data.refId,ct.height=it.data.ty===0?it.data.h:100,ct.width=it.data.ty===0?it.data.w:100,ct.inPoint=it.data.ip/it.comp.globalData.frameRate,ct.outPoint=it.data.op/it.comp.globalData.frameRate,ct._name=it.data.nm,ct.registerMaskInterface=at,ct.registerEffectsInterface=ot,ct}}(),propertyGroupFactory=function(){return function(a,s){return function(o){return o=o===void 0?1:o,o<=0?a:s(o-1)}}}(),PropertyInterface=function(){return function(a,s){var o={_name:a};function j($){return $=$===void 0?1:$,$<=0?o:s($-1)}return j}}(),EffectsExpressionInterface=function(){var a={createEffectsInterface:s};function s($,_e){if($.effectsManager){var tt=[],nt=$.data.ef,rt,it=$.effectsManager.effectElements.length;for(rt=0;rt<it;rt+=1)tt.push(o(nt[rt],$.effectsManager.effectElements[rt],_e,$));var st=$.data.ef||[],at=function(ot){for(rt=0,it=st.length;rt<it;){if(ot===st[rt].nm||ot===st[rt].mn||ot===st[rt].ix)return tt[rt];rt+=1}return null};return Object.defineProperty(at,"numProperties",{get:function(){return st.length}}),at}return null}function o($,_e,tt,nt){function rt(ct){for(var ft=$.ef,ht=0,mt=ft.length;ht<mt;){if(ct===ft[ht].nm||ct===ft[ht].mn||ct===ft[ht].ix)return ft[ht].ty===5?st[ht]:st[ht]();ht+=1}throw new Error}var it=propertyGroupFactory(rt,tt),st=[],at,ot=$.ef.length;for(at=0;at<ot;at+=1)$.ef[at].ty===5?st.push(o($.ef[at],_e.effectElements[at],_e.effectElements[at].propertyGroup,nt)):st.push(j(_e.effectElements[at],$.ef[at].ty,nt,it));return $.mn==="ADBE Color Control"&&Object.defineProperty(rt,"color",{get:function(){return st[0]()}}),Object.defineProperties(rt,{numProperties:{get:function(){return $.np}},_name:{value:$.nm},propertyGroup:{value:it}}),rt.enabled=$.en!==0,rt.active=rt.enabled,rt}function j($,_e,tt,nt){var rt=ExpressionPropertyInterface($.p);function it(){return _e===10?tt.comp.compInterface($.p.v):rt()}return $.p.setGroupProperty&&$.p.setGroupProperty(PropertyInterface("",nt)),it}return a}(),CompExpressionInterface=function(){return function(a){function s(o){for(var j=0,$=a.layers.length;j<$;){if(a.layers[j].nm===o||a.layers[j].ind===o)return a.elements[j].layerInterface;j+=1}return null}return Object.defineProperty(s,"_name",{value:a.data.nm}),s.layer=s,s.pixelAspect=1,s.height=a.data.h||a.globalData.compSize.h,s.width=a.data.w||a.globalData.compSize.w,s.pixelAspect=1,s.frameDuration=1/a.globalData.frameRate,s.displayStartTime=0,s.numLayers=a.layers.length,s}}(),ShapePathInterface=function(){return function(s,o,j){var $=o.sh;function _e(nt){return nt==="Shape"||nt==="shape"||nt==="Path"||nt==="path"||nt==="ADBE Vector Shape"||nt===2?_e.path:null}var tt=propertyGroupFactory(_e,j);return $.setGroupProperty(PropertyInterface("Path",tt)),Object.defineProperties(_e,{path:{get:function(){return $.k&&$.getValue(),$}},shape:{get:function(){return $.k&&$.getValue(),$}},_name:{value:s.nm},ix:{value:s.ix},propertyIndex:{value:s.ix},mn:{value:s.mn},propertyGroup:{value:j}}),_e}}(),ShapeExpressionInterface=function(){function a(ft,ht,mt){var lt=[],ut,dt=ft?ft.length:0;for(ut=0;ut<dt;ut+=1)ft[ut].ty==="gr"?lt.push(o(ft[ut],ht[ut],mt)):ft[ut].ty==="fl"?lt.push(j(ft[ut],ht[ut],mt)):ft[ut].ty==="st"?lt.push(tt(ft[ut],ht[ut],mt)):ft[ut].ty==="tm"?lt.push(nt(ft[ut],ht[ut],mt)):ft[ut].ty==="tr"||(ft[ut].ty==="el"?lt.push(it(ft[ut],ht[ut],mt)):ft[ut].ty==="sr"?lt.push(st(ft[ut],ht[ut],mt)):ft[ut].ty==="sh"?lt.push(ShapePathInterface(ft[ut],ht[ut],mt)):ft[ut].ty==="rc"?lt.push(at(ft[ut],ht[ut],mt)):ft[ut].ty==="rd"?lt.push(ot(ft[ut],ht[ut],mt)):ft[ut].ty==="rp"?lt.push(ct(ft[ut],ht[ut],mt)):ft[ut].ty==="gf"?lt.push($(ft[ut],ht[ut],mt)):lt.push(_e(ft[ut],ht[ut])));return lt}function s(ft,ht,mt){var lt,ut=function(Et){for(var St=0,Tt=lt.length;St<Tt;){if(lt[St]._name===Et||lt[St].mn===Et||lt[St].propertyIndex===Et||lt[St].ix===Et||lt[St].ind===Et)return lt[St];St+=1}return typeof Et=="number"?lt[Et-1]:null};ut.propertyGroup=propertyGroupFactory(ut,mt),lt=a(ft.it,ht.it,ut.propertyGroup),ut.numProperties=lt.length;var dt=rt(ft.it[ft.it.length-1],ht.it[ht.it.length-1],ut.propertyGroup);return ut.transform=dt,ut.propertyIndex=ft.cix,ut._name=ft.nm,ut}function o(ft,ht,mt){var lt=function(Et){switch(Et){case"ADBE Vectors Group":case"Contents":case 2:return lt.content;default:return lt.transform}};lt.propertyGroup=propertyGroupFactory(lt,mt);var ut=s(ft,ht,lt.propertyGroup),dt=rt(ft.it[ft.it.length-1],ht.it[ht.it.length-1],lt.propertyGroup);return lt.content=ut,lt.transform=dt,Object.defineProperty(lt,"_name",{get:function(){return ft.nm}}),lt.numProperties=ft.np,lt.propertyIndex=ft.ix,lt.nm=ft.nm,lt.mn=ft.mn,lt}function j(ft,ht,mt){function lt(ut){return ut==="Color"||ut==="color"?lt.color:ut==="Opacity"||ut==="opacity"?lt.opacity:null}return Object.defineProperties(lt,{color:{get:ExpressionPropertyInterface(ht.c)},opacity:{get:ExpressionPropertyInterface(ht.o)},_name:{value:ft.nm},mn:{value:ft.mn}}),ht.c.setGroupProperty(PropertyInterface("Color",mt)),ht.o.setGroupProperty(PropertyInterface("Opacity",mt)),lt}function $(ft,ht,mt){function lt(ut){return ut==="Start Point"||ut==="start point"?lt.startPoint:ut==="End Point"||ut==="end point"?lt.endPoint:ut==="Opacity"||ut==="opacity"?lt.opacity:null}return Object.defineProperties(lt,{startPoint:{get:ExpressionPropertyInterface(ht.s)},endPoint:{get:ExpressionPropertyInterface(ht.e)},opacity:{get:ExpressionPropertyInterface(ht.o)},type:{get:function(){return"a"}},_name:{value:ft.nm},mn:{value:ft.mn}}),ht.s.setGroupProperty(PropertyInterface("Start Point",mt)),ht.e.setGroupProperty(PropertyInterface("End Point",mt)),ht.o.setGroupProperty(PropertyInterface("Opacity",mt)),lt}function _e(){function ft(){return null}return ft}function tt(ft,ht,mt){var lt=propertyGroupFactory(Tt,mt),ut=propertyGroupFactory(St,lt);function dt(Mt){Object.defineProperty(St,ft.d[Mt].nm,{get:ExpressionPropertyInterface(ht.d.dataProps[Mt].p)})}var gt,Et=ft.d?ft.d.length:0,St={};for(gt=0;gt<Et;gt+=1)dt(gt),ht.d.dataProps[gt].p.setGroupProperty(ut);function Tt(Mt){return Mt==="Color"||Mt==="color"?Tt.color:Mt==="Opacity"||Mt==="opacity"?Tt.opacity:Mt==="Stroke Width"||Mt==="stroke width"?Tt.strokeWidth:null}return Object.defineProperties(Tt,{color:{get:ExpressionPropertyInterface(ht.c)},opacity:{get:ExpressionPropertyInterface(ht.o)},strokeWidth:{get:ExpressionPropertyInterface(ht.w)},dash:{get:function(){return St}},_name:{value:ft.nm},mn:{value:ft.mn}}),ht.c.setGroupProperty(PropertyInterface("Color",lt)),ht.o.setGroupProperty(PropertyInterface("Opacity",lt)),ht.w.setGroupProperty(PropertyInterface("Stroke Width",lt)),Tt}function nt(ft,ht,mt){function lt(dt){return dt===ft.e.ix||dt==="End"||dt==="end"?lt.end:dt===ft.s.ix?lt.start:dt===ft.o.ix?lt.offset:null}var ut=propertyGroupFactory(lt,mt);return lt.propertyIndex=ft.ix,ht.s.setGroupProperty(PropertyInterface("Start",ut)),ht.e.setGroupProperty(PropertyInterface("End",ut)),ht.o.setGroupProperty(PropertyInterface("Offset",ut)),lt.propertyIndex=ft.ix,lt.propertyGroup=mt,Object.defineProperties(lt,{start:{get:ExpressionPropertyInterface(ht.s)},end:{get:ExpressionPropertyInterface(ht.e)},offset:{get:ExpressionPropertyInterface(ht.o)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}function rt(ft,ht,mt){function lt(dt){return ft.a.ix===dt||dt==="Anchor Point"?lt.anchorPoint:ft.o.ix===dt||dt==="Opacity"?lt.opacity:ft.p.ix===dt||dt==="Position"?lt.position:ft.r.ix===dt||dt==="Rotation"||dt==="ADBE Vector Rotation"?lt.rotation:ft.s.ix===dt||dt==="Scale"?lt.scale:ft.sk&&ft.sk.ix===dt||dt==="Skew"?lt.skew:ft.sa&&ft.sa.ix===dt||dt==="Skew Axis"?lt.skewAxis:null}var ut=propertyGroupFactory(lt,mt);return ht.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",ut)),ht.transform.mProps.p.setGroupProperty(PropertyInterface("Position",ut)),ht.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",ut)),ht.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",ut)),ht.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",ut)),ht.transform.mProps.sk&&(ht.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",ut)),ht.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",ut))),ht.transform.op.setGroupProperty(PropertyInterface("Opacity",ut)),Object.defineProperties(lt,{opacity:{get:ExpressionPropertyInterface(ht.transform.mProps.o)},position:{get:ExpressionPropertyInterface(ht.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(ht.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(ht.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(ht.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(ht.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(ht.transform.mProps.sa)},_name:{value:ft.nm}}),lt.ty="tr",lt.mn=ft.mn,lt.propertyGroup=mt,lt}function it(ft,ht,mt){function lt(gt){return ft.p.ix===gt?lt.position:ft.s.ix===gt?lt.size:null}var ut=propertyGroupFactory(lt,mt);lt.propertyIndex=ft.ix;var dt=ht.sh.ty==="tm"?ht.sh.prop:ht.sh;return dt.s.setGroupProperty(PropertyInterface("Size",ut)),dt.p.setGroupProperty(PropertyInterface("Position",ut)),Object.defineProperties(lt,{size:{get:ExpressionPropertyInterface(dt.s)},position:{get:ExpressionPropertyInterface(dt.p)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}function st(ft,ht,mt){function lt(gt){return ft.p.ix===gt?lt.position:ft.r.ix===gt?lt.rotation:ft.pt.ix===gt?lt.points:ft.or.ix===gt||gt==="ADBE Vector Star Outer Radius"?lt.outerRadius:ft.os.ix===gt?lt.outerRoundness:ft.ir&&(ft.ir.ix===gt||gt==="ADBE Vector Star Inner Radius")?lt.innerRadius:ft.is&&ft.is.ix===gt?lt.innerRoundness:null}var ut=propertyGroupFactory(lt,mt),dt=ht.sh.ty==="tm"?ht.sh.prop:ht.sh;return lt.propertyIndex=ft.ix,dt.or.setGroupProperty(PropertyInterface("Outer Radius",ut)),dt.os.setGroupProperty(PropertyInterface("Outer Roundness",ut)),dt.pt.setGroupProperty(PropertyInterface("Points",ut)),dt.p.setGroupProperty(PropertyInterface("Position",ut)),dt.r.setGroupProperty(PropertyInterface("Rotation",ut)),ft.ir&&(dt.ir.setGroupProperty(PropertyInterface("Inner Radius",ut)),dt.is.setGroupProperty(PropertyInterface("Inner Roundness",ut))),Object.defineProperties(lt,{position:{get:ExpressionPropertyInterface(dt.p)},rotation:{get:ExpressionPropertyInterface(dt.r)},points:{get:ExpressionPropertyInterface(dt.pt)},outerRadius:{get:ExpressionPropertyInterface(dt.or)},outerRoundness:{get:ExpressionPropertyInterface(dt.os)},innerRadius:{get:ExpressionPropertyInterface(dt.ir)},innerRoundness:{get:ExpressionPropertyInterface(dt.is)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}function at(ft,ht,mt){function lt(gt){return ft.p.ix===gt?lt.position:ft.r.ix===gt?lt.roundness:ft.s.ix===gt||gt==="Size"||gt==="ADBE Vector Rect Size"?lt.size:null}var ut=propertyGroupFactory(lt,mt),dt=ht.sh.ty==="tm"?ht.sh.prop:ht.sh;return lt.propertyIndex=ft.ix,dt.p.setGroupProperty(PropertyInterface("Position",ut)),dt.s.setGroupProperty(PropertyInterface("Size",ut)),dt.r.setGroupProperty(PropertyInterface("Rotation",ut)),Object.defineProperties(lt,{position:{get:ExpressionPropertyInterface(dt.p)},roundness:{get:ExpressionPropertyInterface(dt.r)},size:{get:ExpressionPropertyInterface(dt.s)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}function ot(ft,ht,mt){function lt(gt){return ft.r.ix===gt||gt==="Round Corners 1"?lt.radius:null}var ut=propertyGroupFactory(lt,mt),dt=ht;return lt.propertyIndex=ft.ix,dt.rd.setGroupProperty(PropertyInterface("Radius",ut)),Object.defineProperties(lt,{radius:{get:ExpressionPropertyInterface(dt.rd)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}function ct(ft,ht,mt){function lt(gt){return ft.c.ix===gt||gt==="Copies"?lt.copies:ft.o.ix===gt||gt==="Offset"?lt.offset:null}var ut=propertyGroupFactory(lt,mt),dt=ht;return lt.propertyIndex=ft.ix,dt.c.setGroupProperty(PropertyInterface("Copies",ut)),dt.o.setGroupProperty(PropertyInterface("Offset",ut)),Object.defineProperties(lt,{copies:{get:ExpressionPropertyInterface(dt.c)},offset:{get:ExpressionPropertyInterface(dt.o)},_name:{value:ft.nm}}),lt.mn=ft.mn,lt}return function(ft,ht,mt){var lt;function ut(gt){if(typeof gt=="number")return gt=gt===void 0?1:gt,gt===0?mt:lt[gt-1];for(var Et=0,St=lt.length;Et<St;){if(lt[Et]._name===gt)return lt[Et];Et+=1}return null}function dt(){return mt}return ut.propertyGroup=propertyGroupFactory(ut,dt),lt=a(ft,ht,ut.propertyGroup),ut.numProperties=lt.length,ut._name="Contents",ut}}(),TextExpressionInterface=function(){return function(a){var s,o;function j($){switch($){case"ADBE Text Document":return j.sourceText;default:return null}}return Object.defineProperty(j,"sourceText",{get:function(){a.textProperty.getValue();var $=a.textProperty.currentData.t;return $!==s&&(a.textProperty.currentData.t=s,o=new String($),o.value=$||new String($)),o}}),j}}(),getBlendMode=function(){var a={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(s){return a[s]||""}}();function SliderEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,0,0,o)}function AngleEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,0,0,o)}function ColorEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,1,0,o)}function PointEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,1,0,o)}function LayerIndexEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,0,0,o)}function MaskIndexEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,0,0,o)}function CheckboxEffect(a,s,o){this.p=PropertyFactory.getProp(s,a.v,0,0,o)}function NoValueEffect(){this.p={}}function EffectsManager(a,s){var o=a.ef||[];this.effectElements=[];var j,$=o.length,_e;for(j=0;j<$;j+=1)_e=new GroupEffect(o[j],s),this.effectElements.push(_e)}function GroupEffect(a,s){this.init(a,s)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(a,s){this.data=a,this.effectElements=[],this.initDynamicPropertyContainer(s);var o,j=this.data.ef.length,$,_e=this.data.ef;for(o=0;o<j;o+=1){switch($=null,_e[o].ty){case 0:$=new SliderEffect(_e[o],s,this);break;case 1:$=new AngleEffect(_e[o],s,this);break;case 2:$=new ColorEffect(_e[o],s,this);break;case 3:$=new PointEffect(_e[o],s,this);break;case 4:case 7:$=new CheckboxEffect(_e[o],s,this);break;case 10:$=new LayerIndexEffect(_e[o],s,this);break;case 11:$=new MaskIndexEffect(_e[o],s,this);break;case 5:$=new EffectsManager(_e[o],s);break;default:$=new NoValueEffect(_e[o]);break}$&&this.effectElements.push($)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var a=0,s=this.data.masksProperties.length;a<s;){if(this.data.masksProperties[a].mode!=="n"&&this.data.masksProperties[a].cl!==!1)return!0;a+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var a=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(a),this.data.ty===0||this.data.xt?this.compInterface=CompExpressionInterface(this):this.data.ty===4?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},setBlendMode:function(){var a=getBlendMode(this.data.bm),s=this.baseElement||this.layerElement;s.style["mix-blend-mode"]=a},initBaseData:function(a,s,o){this.globalData=s,this.comp=o,this.data=a,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(a,s){var o,j=this.dynamicProperties.length;for(o=0;o<j;o+=1)(s||this._isParent&&this.dynamicProperties[o].propType==="transform")&&(this.dynamicProperties[o].getValue(),this.dynamicProperties[o]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(a){this.dynamicProperties.indexOf(a)===-1&&this.dynamicProperties.push(a)}};const FootageInterface=function(){var a=function(o){var j="",$=o.getFootageData();function _e(){return j="",$=o.getFootageData(),tt}function tt(nt){if($[nt])return j=nt,$=$[nt],typeof $=="object"?tt:$;var rt=nt.indexOf(j);if(rt!==-1){var it=parseInt(nt.substr(rt+j.length),10);return $=$[it],typeof $=="object"?tt:$}return""}return _e},s=function(o){function j($){return $==="Outline"?j.outlineInterface():null}return j._name="Outline",j.outlineInterface=a(o),j};return function(o){function j($){return $==="Data"?j.dataInterface:null}return j._name="Data",j.dataInterface=s(o),j}}();function FootageElement(a,s,o){this.initFrame(),this.initRenderable(),this.assetData=s.getAssetData(a.refId),this.footageData=s.imageLoader.getAsset(this.assetData),this.initBaseData(a,s,o)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){this.layerInterface=FootageInterface(this)},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(a,s,o){this.initFrame(),this.initRenderable(),this.assetData=s.getAssetData(a.refId),this.initBaseData(a,s,o),this._isPlaying=!1,this._canPlay=!1;var j=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(j),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=a.tm?PropertyFactory.getProp(this,a.tm,0,s.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,a.au&&a.au.lv?a.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(a){if(this.prepareRenderableFrame(a,!0),this.prepareProperties(a,!0),this.tm._placeholder)this._currentTime=a/this.data.sr;else{var s=this.tm.v;this._currentTime=s}this._volume=this.lv.v[0];var o=this._volume*this._volumeMultiplier;this._previousVolume!==o&&(this._previousVolume=o,this.audio.volume(o))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(a){this.audio.rate(a)},AudioElement.prototype.volume=function(a){this._volumeMultiplier=a,this._previousVolume=a*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(a){var s,o=this.layers.length,j;for(this.completeLayers=!0,s=o-1;s>=0;s-=1)this.elements[s]||(j=this.layers[s],j.ip-j.st<=a-this.layers[s].st&&j.op-j.st>a-this.layers[s].st&&this.buildItem(s)),this.completeLayers=this.elements[s]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(a){switch(a.ty){case 2:return this.createImage(a);case 0:return this.createComp(a);case 1:return this.createSolid(a);case 3:return this.createNull(a);case 4:return this.createShape(a);case 5:return this.createText(a);case 6:return this.createAudio(a);case 13:return this.createCamera(a);case 15:return this.createFootage(a);default:return this.createNull(a)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(a){return new AudioElement(a,this.globalData,this)},BaseRenderer.prototype.createFootage=function(a){return new FootageElement(a,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var a,s=this.layers.length;for(a=0;a<s;a+=1)this.buildItem(a);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(a){this.completeLayers=!1;var s,o=a.length,j,$=this.layers.length;for(s=0;s<o;s+=1)for(j=0;j<$;){if(this.layers[j].id===a[s].id){this.layers[j]=a[s];break}j+=1}},BaseRenderer.prototype.setProjectInterface=function(a){this.globalData.projectInterface=a},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(a,s,o){for(var j=this.elements,$=this.layers,_e=0,tt=$.length;_e<tt;)$[_e].ind==s&&(!j[_e]||j[_e]===!0?(this.buildItem(_e),this.addPendingElement(a)):(o.push(j[_e]),j[_e].setAsParent(),$[_e].parent!==void 0?this.buildElementParenting(a,$[_e].parent,o):a.setHierarchy(o))),_e+=1},BaseRenderer.prototype.addPendingElement=function(a){this.pendingElements.push(a)},BaseRenderer.prototype.searchExtraCompositions=function(a){var s,o=a.length;for(s=0;s<o;s+=1)if(a[s].xt){var j=this.createComp(a[s]);j.initExpressions(),this.globalData.projectInterface.registerComposition(j)}},BaseRenderer.prototype.getElementByPath=function(a){var s=a.shift(),o;if(typeof s=="number")o=this.elements[s];else{var j,$=this.elements.length;for(j=0;j<$;j+=1)if(this.elements[j].data.nm===s){o=this.elements[j];break}}return a.length===0?o:o.getElementByPath(a)},BaseRenderer.prototype.setupGlobalData=function(a,s){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(a.chars),this.globalData.fontManager.addFonts(a.fonts,s),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=a.fr,this.globalData.nm=a.nm,this.globalData.compSize={w:a.w,h:a.h}};function TransformElement(){}TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var a,s=this.finalTransform.mat,o=0,j=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;o<j;){if(this.hierarchy[o].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}o+=1}if(this.finalTransform._matMdf)for(a=this.finalTransform.mProp.v.props,s.cloneFromProps(a),o=0;o<j;o+=1)a=this.hierarchy[o].finalTransform.mProp.v.props,s.transform(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}},globalToLocal:function(a){var s=[];s.push(this.finalTransform);for(var o=!0,j=this.comp;o;)j.finalTransform?(j.data.hasMask&&s.splice(0,0,j.finalTransform),j=j.comp):o=!1;var $,_e=s.length,tt;for($=0;$<_e;$+=1)tt=s[$].mat.applyToPointArray(0,0,0),a=[a[0]-tt[0],a[1]-tt[1],0];return a},mHelper:new Matrix};function MaskElement(a,s,o){this.data=a,this.element=s,this.globalData=o,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var j=this.globalData.defs,$,_e=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(_e),this.solidPath="";var tt,nt=this.masksProperties,rt=0,it=[],st,at,ot=createElementID(),ct,ft,ht,mt,lt="clipPath",ut="clip-path";for($=0;$<_e;$+=1)if((nt[$].mode!=="a"&&nt[$].mode!=="n"||nt[$].inv||nt[$].o.k!==100||nt[$].o.x)&&(lt="mask",ut="mask"),(nt[$].mode==="s"||nt[$].mode==="i")&&rt===0?(ct=createNS("rect"),ct.setAttribute("fill","#ffffff"),ct.setAttribute("width",this.element.comp.data.w||0),ct.setAttribute("height",this.element.comp.data.h||0),it.push(ct)):ct=null,tt=createNS("path"),nt[$].mode==="n")this.viewData[$]={op:PropertyFactory.getProp(this.element,nt[$].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,nt[$],3),elem:tt,lastPath:""},j.appendChild(tt);else{rt+=1,tt.setAttribute("fill",nt[$].mode==="s"?"#000000":"#ffffff"),tt.setAttribute("clip-rule","nonzero");var dt;if(nt[$].x.k!==0?(lt="mask",ut="mask",mt=PropertyFactory.getProp(this.element,nt[$].x,0,null,this.element),dt=createElementID(),ft=createNS("filter"),ft.setAttribute("id",dt),ht=createNS("feMorphology"),ht.setAttribute("operator","erode"),ht.setAttribute("in","SourceGraphic"),ht.setAttribute("radius","0"),ft.appendChild(ht),j.appendChild(ft),tt.setAttribute("stroke",nt[$].mode==="s"?"#000000":"#ffffff")):(ht=null,mt=null),this.storedData[$]={elem:tt,x:mt,expan:ht,lastPath:"",lastOperator:"",filterId:dt,lastRadius:0},nt[$].mode==="i"){at=it.length;var gt=createNS("g");for(st=0;st<at;st+=1)gt.appendChild(it[st]);var Et=createNS("mask");Et.setAttribute("mask-type","alpha"),Et.setAttribute("id",ot+"_"+rt),Et.appendChild(tt),j.appendChild(Et),gt.setAttribute("mask","url("+getLocationHref()+"#"+ot+"_"+rt+")"),it.length=0,it.push(gt)}else it.push(tt);nt[$].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[$]={elem:tt,lastPath:"",op:PropertyFactory.getProp(this.element,nt[$].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,nt[$],3),invRect:ct},this.viewData[$].prop.k||this.drawPath(nt[$],this.viewData[$].prop.v,this.viewData[$])}for(this.maskElement=createNS(lt),_e=it.length,$=0;$<_e;$+=1)this.maskElement.appendChild(it[$]);rt>0&&(this.maskElement.setAttribute("id",ot),this.element.maskedElement.setAttribute(ut,"url("+getLocationHref()+"#"+ot+")"),j.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(a){return this.viewData[a].prop},MaskElement.prototype.renderFrame=function(a){var s=this.element.finalTransform.mat,o,j=this.masksProperties.length;for(o=0;o<j;o+=1)if((this.viewData[o].prop._mdf||a)&&this.drawPath(this.masksProperties[o],this.viewData[o].prop.v,this.viewData[o]),(this.viewData[o].op._mdf||a)&&this.viewData[o].elem.setAttribute("fill-opacity",this.viewData[o].op.v),this.masksProperties[o].mode!=="n"&&(this.viewData[o].invRect&&(this.element.finalTransform.mProp._mdf||a)&&this.viewData[o].invRect.setAttribute("transform",s.getInverseMatrix().to2dCSS()),this.storedData[o].x&&(this.storedData[o].x._mdf||a))){var $=this.storedData[o].expan;this.storedData[o].x.v<0?(this.storedData[o].lastOperator!=="erode"&&(this.storedData[o].lastOperator="erode",this.storedData[o].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[o].filterId+")")),$.setAttribute("radius",-this.storedData[o].x.v)):(this.storedData[o].lastOperator!=="dilate"&&(this.storedData[o].lastOperator="dilate",this.storedData[o].elem.setAttribute("filter",null)),this.storedData[o].elem.setAttribute("stroke-width",this.storedData[o].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var a="M0,0 ";return a+=" h"+this.globalData.compSize.w,a+=" v"+this.globalData.compSize.h,a+=" h-"+this.globalData.compSize.w,a+=" v-"+this.globalData.compSize.h+" ",a},MaskElement.prototype.drawPath=function(a,s,o){var j=" M"+s.v[0][0]+","+s.v[0][1],$,_e;for(_e=s._length,$=1;$<_e;$+=1)j+=" C"+s.o[$-1][0]+","+s.o[$-1][1]+" "+s.i[$][0]+","+s.i[$][1]+" "+s.v[$][0]+","+s.v[$][1];if(s.c&&_e>1&&(j+=" C"+s.o[$-1][0]+","+s.o[$-1][1]+" "+s.i[0][0]+","+s.i[0][1]+" "+s.v[0][0]+","+s.v[0][1]),o.lastPath!==j){var tt="";o.elem&&(s.c&&(tt=a.inv?this.solidPath+j:j),o.elem.setAttribute("d",tt)),o.lastPath=j}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};const filtersFactory=function(){var a={};a.createFilter=s,a.createAlphaToLuminanceFilter=o;function s(j,$){var _e=createNS("filter");return _e.setAttribute("id",j),$!==!0&&(_e.setAttribute("filterUnits","objectBoundingBox"),_e.setAttribute("x","0%"),_e.setAttribute("y","0%"),_e.setAttribute("width","100%"),_e.setAttribute("height","100%")),_e}function o(){var j=createNS("feColorMatrix");return j.setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),j}return a}(),featureSupport=function(){var a={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(a.maskType=!1),a}();var registeredEffects={},idPrefix="filter_result_";function SVGEffects(a){var s,o="SourceGraphic",j=a.data.ef?a.data.ef.length:0,$=createElementID(),_e=filtersFactory.createFilter($,!0),tt=0;this.filters=[];var nt;for(s=0;s<j;s+=1){nt=null;var rt=a.data.ef[s].ty;if(registeredEffects[rt]){var it=registeredEffects[rt].effect;nt=new it(_e,a.effectsManager.effectElements[s],a,idPrefix+tt,o),o=idPrefix+tt,registeredEffects[rt].countsAsEffect&&(tt+=1)}nt&&this.filters.push(nt)}tt&&(a.globalData.defs.appendChild(_e),a.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+$+")")),this.filters.length&&a.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(a){var s,o=this.filters.length;for(s=0;s<o;s+=1)this.filters[s].renderFrame(a)};function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var a=null,s,o,j;if(this.data.td){if(this.data.td==3||this.data.td==1){var $=createNS("mask");$.setAttribute("id",this.layerId),$.setAttribute("mask-type",this.data.td==3?"luminance":"alpha"),$.appendChild(this.layerElement),a=$,this.globalData.defs.appendChild($),!featureSupport.maskType&&this.data.td==1&&($.setAttribute("mask-type","luminance"),s=createElementID(),o=filtersFactory.createFilter(s),this.globalData.defs.appendChild(o),o.appendChild(filtersFactory.createAlphaToLuminanceFilter()),j=createNS("g"),j.appendChild(this.layerElement),a=j,$.appendChild(j),j.setAttribute("filter","url("+getLocationHref()+"#"+s+")"))}else if(this.data.td==2){var _e=createNS("mask");_e.setAttribute("id",this.layerId),_e.setAttribute("mask-type","alpha");var tt=createNS("g");_e.appendChild(tt),s=createElementID(),o=filtersFactory.createFilter(s);var nt=createNS("feComponentTransfer");nt.setAttribute("in","SourceGraphic"),o.appendChild(nt);var rt=createNS("feFuncA");rt.setAttribute("type","table"),rt.setAttribute("tableValues","1.0 0.0"),nt.appendChild(rt),this.globalData.defs.appendChild(o);var it=createNS("rect");it.setAttribute("width",this.comp.data.w),it.setAttribute("height",this.comp.data.h),it.setAttribute("x","0"),it.setAttribute("y","0"),it.setAttribute("fill","#ffffff"),it.setAttribute("opacity","0"),tt.setAttribute("filter","url("+getLocationHref()+"#"+s+")"),tt.appendChild(it),tt.appendChild(this.layerElement),a=tt,featureSupport.maskType||(_e.setAttribute("mask-type","luminance"),o.appendChild(filtersFactory.createAlphaToLuminanceFilter()),j=createNS("g"),tt.appendChild(it),j.appendChild(this.layerElement),a=j,tt.appendChild(j)),this.globalData.defs.appendChild(_e)}}else this.data.tt?(this.matteElement.appendChild(this.layerElement),a=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var st=createNS("clipPath"),at=createNS("path");at.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var ot=createElementID();if(st.setAttribute("id",ot),st.appendChild(at),this.globalData.defs.appendChild(st),this.checkMasks()){var ct=createNS("g");ct.setAttribute("clip-path","url("+getLocationHref()+"#"+ot+")"),ct.appendChild(this.layerElement),this.transformedElement=ct,a?a.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+ot+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},setMatte:function(a){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+a+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(a){this.hierarchy=a},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var a={initElement:function(s,o,j){this.initFrame(),this.initBaseData(s,o,j),this.initTransform(s,o,j),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var s=this.baseElement||this.layerElement;s.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var s=this.baseElement||this.layerElement;s.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(s){this._mdf=!1,this.prepareRenderableFrame(s),this.prepareProperties(s,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(a)],RenderableDOMElement)})();function IImageElement(a,s,o){this.assetData=s.getAssetData(a.refId),this.initElement(a,s,o),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var a=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",a),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(a,s){this.elem=a,this.pos=s}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(a){var s,o=this.shapeModifiers.length;for(s=0;s<o;s+=1)this.shapeModifiers[s].addShape(a)},isShapeInAnimatedModifiers:function(a){for(var s=0,o=this.shapeModifiers.length;s<o;)if(this.shapeModifiers[s].isAnimatedWithShape(a))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var a,s=this.shapes.length;for(a=0;a<s;a+=1)this.shapes[a].sh.reset();s=this.shapeModifiers.length;var o;for(a=s-1;a>=0&&(o=this.shapeModifiers[a].processShapes(this._isFirstFrame),!o);a-=1);}},searchProcessedElement:function(a){for(var s=this.processedElements,o=0,j=s.length;o<j;){if(s[o].elem===a)return s[o].pos;o+=1}return 0},addProcessedElement:function(a,s){for(var o=this.processedElements,j=o.length;j;)if(j-=1,o[j].elem===a){o[j].pos=s;return}o.push(new ProcessedElement(a,s))},prepareFrame:function(a){this.prepareRenderableFrame(a),this.prepareProperties(a,this.isInRange)}};const lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(a,s,o){this.caches=[],this.styles=[],this.transformers=a,this.lStr="",this.sh=o,this.lvl=s,this._isAnimated=!!o.k;for(var j=0,$=a.length;j<$;){if(a[j].mProps.dynamicProperties.length){this._isAnimated=!0;break}j+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(a,s){this.data=a,this.type=a.ty,this.d="",this.lvl=s,this._mdf=!1,this.closed=a.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(a,s,o,j){this.elem=a,this.frameId=-1,this.dataProps=createSizedArray(s.length),this.renderer=o,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",s.length?s.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(j);var $,_e=s.length||0,tt;for($=0;$<_e;$+=1)tt=PropertyFactory.getProp(a,s[$].v,0,0,this),this.k=tt.k||this.k,this.dataProps[$]={n:s[$].n,p:tt};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(a){if(!(this.elem.globalData.frameId===this.frameId&&!a)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||a,this._mdf)){var s=0,o=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),s=0;s<o;s+=1)this.dataProps[s].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[s].p.v:this.dashArray[s]=this.dataProps[s].p.v:this.dashoffset[0]=this.dataProps[s].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(a,s,o){this.initDynamicPropertyContainer(a),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(a,s.o,0,.01,this),this.w=PropertyFactory.getProp(a,s.w,0,null,this),this.d=new DashProperty(a,s.d||{},"svg",this),this.c=PropertyFactory.getProp(a,s.c,1,255,this),this.style=o,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(a,s,o){this.initDynamicPropertyContainer(a),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(a,s.o,0,.01,this),this.c=PropertyFactory.getProp(a,s.c,1,255,this),this.style=o}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(a,s,o){this.initDynamicPropertyContainer(a),this.getValue=this.iterateDynamicProperties,this.style=o}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(a,s,o){this.data=s,this.c=createTypedArray("uint8c",s.p*4);var j=s.k.k[0].s?s.k.k[0].s.length-s.p*4:s.k.k.length-s.p*4;this.o=createTypedArray("float32",j),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=j,this.initDynamicPropertyContainer(o),this.prop=PropertyFactory.getProp(a,s.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(a,s){for(var o=0,j=this.o.length/2,$;o<j;){if($=Math.abs(a[o*4]-a[s*4+o*2]),$>.01)return!1;o+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var a=0,s=this.data.k.k.length;a<s;){if(!this.comparePoints(this.data.k.k[a].s,this.data.p))return!1;a+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(a){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||a){var s,o=this.data.p*4,j,$;for(s=0;s<o;s+=1)j=s%4===0?100:255,$=Math.round(this.prop.v[s]*j),this.c[s]!==$&&(this.c[s]=$,this._cmdf=!a);if(this.o.length)for(o=this.prop.v.length,s=this.data.p*4;s<o;s+=1)j=s%2===0?100:1,$=s%2===0?Math.round(this.prop.v[s]*100):this.prop.v[s],this.o[s-this.data.p*4]!==$&&(this.o[s-this.data.p*4]=$,this._omdf=!a);this._mdf=!a}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(a,s,o){this.initDynamicPropertyContainer(a),this.getValue=this.iterateDynamicProperties,this.initGradientData(a,s,o)}SVGGradientFillStyleData.prototype.initGradientData=function(a,s,o){this.o=PropertyFactory.getProp(a,s.o,0,.01,this),this.s=PropertyFactory.getProp(a,s.s,1,null,this),this.e=PropertyFactory.getProp(a,s.e,1,null,this),this.h=PropertyFactory.getProp(a,s.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(a,s.a||{k:0},0,degToRads,this),this.g=new GradientProperty(a,s.g,this),this.style=o,this.stops=[],this.setGradientData(o.pElem,s),this.setGradientOpacity(s,o),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(a,s){var o=createElementID(),j=createNS(s.t===1?"linearGradient":"radialGradient");j.setAttribute("id",o),j.setAttribute("spreadMethod","pad"),j.setAttribute("gradientUnits","userSpaceOnUse");var $=[],_e,tt,nt;for(nt=s.g.p*4,tt=0;tt<nt;tt+=4)_e=createNS("stop"),j.appendChild(_e),$.push(_e);a.setAttribute(s.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+o+")"),this.gf=j,this.cst=$},SVGGradientFillStyleData.prototype.setGradientOpacity=function(a,s){if(this.g._hasOpacity&&!this.g._collapsable){var o,j,$,_e=createNS("mask"),tt=createNS("path");_e.appendChild(tt);var nt=createElementID(),rt=createElementID();_e.setAttribute("id",rt);var it=createNS(a.t===1?"linearGradient":"radialGradient");it.setAttribute("id",nt),it.setAttribute("spreadMethod","pad"),it.setAttribute("gradientUnits","userSpaceOnUse"),$=a.g.k.k[0].s?a.g.k.k[0].s.length:a.g.k.k.length;var st=this.stops;for(j=a.g.p*4;j<$;j+=2)o=createNS("stop"),o.setAttribute("stop-color","rgb(255,255,255)"),it.appendChild(o),st.push(o);tt.setAttribute(a.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+nt+")"),a.ty==="gs"&&(tt.setAttribute("stroke-linecap",lineCapEnum[a.lc||2]),tt.setAttribute("stroke-linejoin",lineJoinEnum[a.lj||2]),a.lj===1&&tt.setAttribute("stroke-miterlimit",a.ml)),this.of=it,this.ms=_e,this.ost=st,this.maskId=rt,s.msElem=tt}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(a,s,o){this.initDynamicPropertyContainer(a),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(a,s.w,0,null,this),this.d=new DashProperty(a,s.d||{},"svg",this),this.initGradientData(a,s,o),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(a,s,o){this.transform={mProps:a,op:s,container:o},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}const buildShapeString=function(a,s,o,j){if(s===0)return"";var $=a.o,_e=a.i,tt=a.v,nt,rt=" M"+j.applyToPointStringified(tt[0][0],tt[0][1]);for(nt=1;nt<s;nt+=1)rt+=" C"+j.applyToPointStringified($[nt-1][0],$[nt-1][1])+" "+j.applyToPointStringified(_e[nt][0],_e[nt][1])+" "+j.applyToPointStringified(tt[nt][0],tt[nt][1]);return o&&s&&(rt+=" C"+j.applyToPointStringified($[nt-1][0],$[nt-1][1])+" "+j.applyToPointStringified(_e[0][0],_e[0][1])+" "+j.applyToPointStringified(tt[0][0],tt[0][1]),rt+="z"),rt},SVGElementsRenderer=function(){var a=new Matrix,s=new Matrix,o={createRenderFunction:j};function j(at){switch(at.ty){case"fl":return nt;case"gf":return it;case"gs":return rt;case"st":return st;case"sh":case"el":case"rc":case"sr":return tt;case"tr":return $;case"no":return _e;default:return null}}function $(at,ot,ct){(ct||ot.transform.op._mdf)&&ot.transform.container.setAttribute("opacity",ot.transform.op.v),(ct||ot.transform.mProps._mdf)&&ot.transform.container.setAttribute("transform",ot.transform.mProps.v.to2dCSS())}function _e(){}function tt(at,ot,ct){var ft,ht,mt,lt,ut,dt,gt=ot.styles.length,Et=ot.lvl,St,Tt,Mt,Bt,Rt;for(dt=0;dt<gt;dt+=1){if(lt=ot.sh._mdf||ct,ot.styles[dt].lvl<Et){for(Tt=s.reset(),Bt=Et-ot.styles[dt].lvl,Rt=ot.transformers.length-1;!lt&&Bt>0;)lt=ot.transformers[Rt].mProps._mdf||lt,Bt-=1,Rt-=1;if(lt)for(Bt=Et-ot.styles[dt].lvl,Rt=ot.transformers.length-1;Bt>0;)Mt=ot.transformers[Rt].mProps.v.props,Tt.transform(Mt[0],Mt[1],Mt[2],Mt[3],Mt[4],Mt[5],Mt[6],Mt[7],Mt[8],Mt[9],Mt[10],Mt[11],Mt[12],Mt[13],Mt[14],Mt[15]),Bt-=1,Rt-=1}else Tt=a;if(St=ot.sh.paths,ht=St._length,lt){for(mt="",ft=0;ft<ht;ft+=1)ut=St.shapes[ft],ut&&ut._length&&(mt+=buildShapeString(ut,ut._length,ut.c,Tt));ot.caches[dt]=mt}else mt=ot.caches[dt];ot.styles[dt].d+=at.hd===!0?"":mt,ot.styles[dt]._mdf=lt||ot.styles[dt]._mdf}}function nt(at,ot,ct){var ft=ot.style;(ot.c._mdf||ct)&&ft.pElem.setAttribute("fill","rgb("+bmFloor(ot.c.v[0])+","+bmFloor(ot.c.v[1])+","+bmFloor(ot.c.v[2])+")"),(ot.o._mdf||ct)&&ft.pElem.setAttribute("fill-opacity",ot.o.v)}function rt(at,ot,ct){it(at,ot,ct),st(at,ot,ct)}function it(at,ot,ct){var ft=ot.gf,ht=ot.g._hasOpacity,mt=ot.s.v,lt=ot.e.v;if(ot.o._mdf||ct){var ut=at.ty==="gf"?"fill-opacity":"stroke-opacity";ot.style.pElem.setAttribute(ut,ot.o.v)}if(ot.s._mdf||ct){var dt=at.t===1?"x1":"cx",gt=dt==="x1"?"y1":"cy";ft.setAttribute(dt,mt[0]),ft.setAttribute(gt,mt[1]),ht&&!ot.g._collapsable&&(ot.of.setAttribute(dt,mt[0]),ot.of.setAttribute(gt,mt[1]))}var Et,St,Tt,Mt;if(ot.g._cmdf||ct){Et=ot.cst;var Bt=ot.g.c;for(Tt=Et.length,St=0;St<Tt;St+=1)Mt=Et[St],Mt.setAttribute("offset",Bt[St*4]+"%"),Mt.setAttribute("stop-color","rgb("+Bt[St*4+1]+","+Bt[St*4+2]+","+Bt[St*4+3]+")")}if(ht&&(ot.g._omdf||ct)){var Rt=ot.g.o;for(ot.g._collapsable?Et=ot.cst:Et=ot.ost,Tt=Et.length,St=0;St<Tt;St+=1)Mt=Et[St],ot.g._collapsable||Mt.setAttribute("offset",Rt[St*2]+"%"),Mt.setAttribute("stop-opacity",Rt[St*2+1])}if(at.t===1)(ot.e._mdf||ct)&&(ft.setAttribute("x2",lt[0]),ft.setAttribute("y2",lt[1]),ht&&!ot.g._collapsable&&(ot.of.setAttribute("x2",lt[0]),ot.of.setAttribute("y2",lt[1])));else{var Ut;if((ot.s._mdf||ot.e._mdf||ct)&&(Ut=Math.sqrt(Math.pow(mt[0]-lt[0],2)+Math.pow(mt[1]-lt[1],2)),ft.setAttribute("r",Ut),ht&&!ot.g._collapsable&&ot.of.setAttribute("r",Ut)),ot.e._mdf||ot.h._mdf||ot.a._mdf||ct){Ut||(Ut=Math.sqrt(Math.pow(mt[0]-lt[0],2)+Math.pow(mt[1]-lt[1],2)));var Ht=Math.atan2(lt[1]-mt[1],lt[0]-mt[0]),Wt=ot.h.v;Wt>=1?Wt=.99:Wt<=-1&&(Wt=-.99);var Jt=Ut*Wt,sn=Math.cos(Ht+ot.a.v)*Jt+mt[0],jt=Math.sin(Ht+ot.a.v)*Jt+mt[1];ft.setAttribute("fx",sn),ft.setAttribute("fy",jt),ht&&!ot.g._collapsable&&(ot.of.setAttribute("fx",sn),ot.of.setAttribute("fy",jt))}}}function st(at,ot,ct){var ft=ot.style,ht=ot.d;ht&&(ht._mdf||ct)&&ht.dashStr&&(ft.pElem.setAttribute("stroke-dasharray",ht.dashStr),ft.pElem.setAttribute("stroke-dashoffset",ht.dashoffset[0])),ot.c&&(ot.c._mdf||ct)&&ft.pElem.setAttribute("stroke","rgb("+bmFloor(ot.c.v[0])+","+bmFloor(ot.c.v[1])+","+bmFloor(ot.c.v[2])+")"),(ot.o._mdf||ct)&&ft.pElem.setAttribute("stroke-opacity",ot.o.v),(ot.w._mdf||ct)&&(ft.pElem.setAttribute("stroke-width",ot.w.v),ft.msElem&&ft.msElem.setAttribute("stroke-width",ot.w.v))}return o}();function SVGShapeElement(a,s,o){this.shapes=[],this.shapesData=a.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(a,s,o),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var a,s=this.shapes.length,o,j,$=this.stylesList.length,_e,tt=[],nt=!1;for(j=0;j<$;j+=1){for(_e=this.stylesList[j],nt=!1,tt.length=0,a=0;a<s;a+=1)o=this.shapes[a],o.styles.indexOf(_e)!==-1&&(tt.push(o),nt=o._isAnimated||nt);tt.length>1&&nt&&this.setShapesAsAnimated(tt)}},SVGShapeElement.prototype.setShapesAsAnimated=function(a){var s,o=a.length;for(s=0;s<o;s+=1)a[s].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(a,s){var o,j=new SVGStyleData(a,s),$=j.pElem;if(a.ty==="st")o=new SVGStrokeStyleData(this,a,j);else if(a.ty==="fl")o=new SVGFillStyleData(this,a,j);else if(a.ty==="gf"||a.ty==="gs"){var _e=a.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;o=new _e(this,a,j),this.globalData.defs.appendChild(o.gf),o.maskId&&(this.globalData.defs.appendChild(o.ms),this.globalData.defs.appendChild(o.of),$.setAttribute("mask","url("+getLocationHref()+"#"+o.maskId+")"))}else a.ty==="no"&&(o=new SVGNoStyleData(this,a,j));return(a.ty==="st"||a.ty==="gs")&&($.setAttribute("stroke-linecap",lineCapEnum[a.lc||2]),$.setAttribute("stroke-linejoin",lineJoinEnum[a.lj||2]),$.setAttribute("fill-opacity","0"),a.lj===1&&$.setAttribute("stroke-miterlimit",a.ml)),a.r===2&&$.setAttribute("fill-rule","evenodd"),a.ln&&$.setAttribute("id",a.ln),a.cl&&$.setAttribute("class",a.cl),a.bm&&($.style["mix-blend-mode"]=getBlendMode(a.bm)),this.stylesList.push(j),this.addToAnimatedContents(a,o),o},SVGShapeElement.prototype.createGroupElement=function(a){var s=new ShapeGroupData;return a.ln&&s.gr.setAttribute("id",a.ln),a.cl&&s.gr.setAttribute("class",a.cl),a.bm&&(s.gr.style["mix-blend-mode"]=getBlendMode(a.bm)),s},SVGShapeElement.prototype.createTransformElement=function(a,s){var o=TransformPropertyFactory.getTransformProperty(this,a,this),j=new SVGTransformData(o,o.o,s);return this.addToAnimatedContents(a,j),j},SVGShapeElement.prototype.createShapeElement=function(a,s,o){var j=4;a.ty==="rc"?j=5:a.ty==="el"?j=6:a.ty==="sr"&&(j=7);var $=ShapePropertyFactory.getShapeProp(this,a,j,this),_e=new SVGShapeData(s,o,$);return this.shapes.push(_e),this.addShapeToModifiers(_e),this.addToAnimatedContents(a,_e),_e},SVGShapeElement.prototype.addToAnimatedContents=function(a,s){for(var o=0,j=this.animatedContents.length;o<j;){if(this.animatedContents[o].element===s)return;o+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(a),element:s,data:a})},SVGShapeElement.prototype.setElementStyles=function(a){var s=a.styles,o,j=this.stylesList.length;for(o=0;o<j;o+=1)this.stylesList[o].closed||s.push(this.stylesList[o])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var a,s=this.itemsData.length;for(a=0;a<s;a+=1)this.prevViewData[a]=this.itemsData[a];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),s=this.dynamicProperties.length,a=0;a<s;a+=1)this.dynamicProperties[a].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(a,s,o,j,$,_e,tt){var nt=[].concat(_e),rt,it=a.length-1,st,at,ot=[],ct=[],ft,ht,mt;for(rt=it;rt>=0;rt-=1){if(mt=this.searchProcessedElement(a[rt]),mt?s[rt]=o[mt-1]:a[rt]._render=tt,a[rt].ty==="fl"||a[rt].ty==="st"||a[rt].ty==="gf"||a[rt].ty==="gs"||a[rt].ty==="no")mt?s[rt].style.closed=!1:s[rt]=this.createStyleElement(a[rt],$),a[rt]._render&&s[rt].style.pElem.parentNode!==j&&j.appendChild(s[rt].style.pElem),ot.push(s[rt].style);else if(a[rt].ty==="gr"){if(!mt)s[rt]=this.createGroupElement(a[rt]);else for(at=s[rt].it.length,st=0;st<at;st+=1)s[rt].prevViewData[st]=s[rt].it[st];this.searchShapes(a[rt].it,s[rt].it,s[rt].prevViewData,s[rt].gr,$+1,nt,tt),a[rt]._render&&s[rt].gr.parentNode!==j&&j.appendChild(s[rt].gr)}else a[rt].ty==="tr"?(mt||(s[rt]=this.createTransformElement(a[rt],j)),ft=s[rt].transform,nt.push(ft)):a[rt].ty==="sh"||a[rt].ty==="rc"||a[rt].ty==="el"||a[rt].ty==="sr"?(mt||(s[rt]=this.createShapeElement(a[rt],nt,$)),this.setElementStyles(s[rt])):a[rt].ty==="tm"||a[rt].ty==="rd"||a[rt].ty==="ms"||a[rt].ty==="pb"?(mt?(ht=s[rt],ht.closed=!1):(ht=ShapeModifiers.getModifier(a[rt].ty),ht.init(this,a[rt]),s[rt]=ht,this.shapeModifiers.push(ht)),ct.push(ht)):a[rt].ty==="rp"&&(mt?(ht=s[rt],ht.closed=!0):(ht=ShapeModifiers.getModifier(a[rt].ty),s[rt]=ht,ht.init(this,a,rt,s),this.shapeModifiers.push(ht),tt=!1),ct.push(ht));this.addProcessedElement(a[rt],rt+1)}for(it=ot.length,rt=0;rt<it;rt+=1)ot[rt].closed=!0;for(it=ct.length,rt=0;rt<it;rt+=1)ct[rt].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var a,s=this.stylesList.length;for(a=0;a<s;a+=1)this.stylesList[a].reset();for(this.renderShape(),a=0;a<s;a+=1)(this.stylesList[a]._mdf||this._isFirstFrame)&&(this.stylesList[a].msElem&&(this.stylesList[a].msElem.setAttribute("d",this.stylesList[a].d),this.stylesList[a].d="M0 0"+this.stylesList[a].d),this.stylesList[a].pElem.setAttribute("d",this.stylesList[a].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var a,s=this.animatedContents.length,o;for(a=0;a<s;a+=1)o=this.animatedContents[a],(this._isFirstFrame||o.element._isAnimated)&&o.data!==!0&&o.fn(o.data,o.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(a,s,o,j,$,_e){this.o=a,this.sw=s,this.sc=o,this.fc=j,this.m=$,this.p=_e,this._mdf={o:!0,sw:!!s,sc:!!o,fc:!!j,m:!0,p:!0}}LetterProps.prototype.update=function(a,s,o,j,$,_e){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var tt=!1;return this.o!==a&&(this.o=a,this._mdf.o=!0,tt=!0),this.sw!==s&&(this.sw=s,this._mdf.sw=!0,tt=!0),this.sc!==o&&(this.sc=o,this._mdf.sc=!0,tt=!0),this.fc!==j&&(this.fc=j,this._mdf.fc=!0,tt=!0),this.m!==$&&(this.m=$,this._mdf.m=!0,tt=!0),_e.length&&(this.p[0]!==_e[0]||this.p[1]!==_e[1]||this.p[4]!==_e[4]||this.p[5]!==_e[5]||this.p[12]!==_e[12]||this.p[13]!==_e[13])&&(this.p=_e,this._mdf.p=!0,tt=!0),tt};function TextProperty(a,s){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=s,this.elem=a,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o]);return a},TextProperty.prototype.setCurrentData=function(a){a.__complete||this.completeTextData(a),this.currentData=a,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(a){this.effectsSequence.push(a),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(a){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!a)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var s=this.currentData,o=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var j,$=this.effectsSequence.length,_e=a||this.data.d.k[this.keysIndex].s;for(j=0;j<$;j+=1)o!==this.keysIndex?_e=this.effectsSequence[j](_e,_e.t):_e=this.effectsSequence[j](this.currentData,_e.t);s!==_e&&this.setCurrentData(_e),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var a=this.data.d.k,s=this.elem.comp.renderedFrame,o=0,j=a.length;o<=j-1&&!(o===j-1||a[o+1].t>s);)o+=1;return this.keysIndex!==o&&(this.keysIndex=o),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(a){for(var s=[],o=0,j=a.length,$,_e,tt=!1;o<j;)$=a.charCodeAt(o),FontManager.isCombinedCharacter($)?s[s.length-1]+=a.charAt(o):$>=55296&&$<=56319?(_e=a.charCodeAt(o+1),_e>=56320&&_e<=57343?(tt||FontManager.isModifier($,_e)?(s[s.length-1]+=a.substr(o,2),tt=!1):s.push(a.substr(o,2)),o+=1):s.push(a.charAt(o))):$>56319?(_e=a.charCodeAt(o+1),FontManager.isZeroWidthJoiner($,_e)?(tt=!0,s[s.length-1]+=a.substr(o,2),o+=1):s.push(a.charAt(o))):FontManager.isZeroWidthJoiner($)?(s[s.length-1]+=a.charAt(o),tt=!0):s.push(a.charAt(o)),o+=1;return s},TextProperty.prototype.completeTextData=function(a){a.__complete=!0;var s=this.elem.globalData.fontManager,o=this.data,j=[],$,_e,tt,nt=0,rt,it=o.m.g,st=0,at=0,ot=0,ct=[],ft=0,ht=0,mt,lt,ut=s.getFontByName(a.f),dt,gt=0,Et=getFontProperties(ut);a.fWeight=Et.weight,a.fStyle=Et.style,a.finalSize=a.s,a.finalText=this.buildFinalText(a.t),_e=a.finalText.length,a.finalLineHeight=a.lh;var St=a.tr/1e3*a.finalSize,Tt;if(a.sz)for(var Mt=!0,Bt=a.sz[0],Rt=a.sz[1],Ut,Ht;Mt;){Ht=this.buildFinalText(a.t),Ut=0,ft=0,_e=Ht.length,St=a.tr/1e3*a.finalSize;var Wt=-1;for($=0;$<_e;$+=1)Tt=Ht[$].charCodeAt(0),tt=!1,Ht[$]===" "?Wt=$:(Tt===13||Tt===3)&&(ft=0,tt=!0,Ut+=a.finalLineHeight||a.finalSize*1.2),s.chars?(dt=s.getCharData(Ht[$],ut.fStyle,ut.fFamily),gt=tt?0:dt.w*a.finalSize/100):gt=s.measureText(Ht[$],a.f,a.finalSize),ft+gt>Bt&&Ht[$]!==" "?(Wt===-1?_e+=1:$=Wt,Ut+=a.finalLineHeight||a.finalSize*1.2,Ht.splice($,Wt===$?1:0,"\r"),Wt=-1,ft=0):(ft+=gt,ft+=St);Ut+=ut.ascent*a.finalSize/100,this.canResize&&a.finalSize>this.minimumFontSize&&Rt<Ut?(a.finalSize-=1,a.finalLineHeight=a.finalSize*a.lh/a.s):(a.finalText=Ht,_e=a.finalText.length,Mt=!1)}ft=-St,gt=0;var Jt=0,sn;for($=0;$<_e;$+=1)if(tt=!1,sn=a.finalText[$],Tt=sn.charCodeAt(0),Tt===13||Tt===3?(Jt=0,ct.push(ft),ht=ft>ht?ft:ht,ft=-2*St,rt="",tt=!0,ot+=1):rt=sn,s.chars?(dt=s.getCharData(sn,ut.fStyle,s.getFontByName(a.f).fFamily),gt=tt?0:dt.w*a.finalSize/100):gt=s.measureText(rt,a.f,a.finalSize),sn===" "?Jt+=gt+St:(ft+=gt+St+Jt,Jt=0),j.push({l:gt,an:gt,add:st,n:tt,anIndexes:[],val:rt,line:ot,animatorJustifyOffset:0}),it==2){if(st+=gt,rt===""||rt===" "||$===_e-1){for((rt===""||rt===" ")&&(st-=gt);at<=$;)j[at].an=st,j[at].ind=nt,j[at].extra=gt,at+=1;nt+=1,st=0}}else if(it==3){if(st+=gt,rt===""||$===_e-1){for(rt===""&&(st-=gt);at<=$;)j[at].an=st,j[at].ind=nt,j[at].extra=gt,at+=1;st=0,nt+=1}}else j[nt].ind=nt,j[nt].extra=0,nt+=1;if(a.l=j,ht=ft>ht?ft:ht,ct.push(ft),a.sz)a.boxWidth=a.sz[0],a.justifyOffset=0;else switch(a.boxWidth=ht,a.j){case 1:a.justifyOffset=-a.boxWidth;break;case 2:a.justifyOffset=-a.boxWidth/2;break;default:a.justifyOffset=0}a.lineWidths=ct;var jt=o.a,Vt,Lt;lt=jt.length;var Qt,nn,mn=[];for(mt=0;mt<lt;mt+=1){for(Vt=jt[mt],Vt.a.sc&&(a.strokeColorAnim=!0),Vt.a.sw&&(a.strokeWidthAnim=!0),(Vt.a.fc||Vt.a.fh||Vt.a.fs||Vt.a.fb)&&(a.fillColorAnim=!0),nn=0,Qt=Vt.s.b,$=0;$<_e;$+=1)Lt=j[$],Lt.anIndexes[mt]=nn,(Qt==1&&Lt.val!==""||Qt==2&&Lt.val!==""&&Lt.val!==" "||Qt==3&&(Lt.n||Lt.val==" "||$==_e-1)||Qt==4&&(Lt.n||$==_e-1))&&(Vt.s.rn===1&&mn.push(nn),nn+=1);o.a[mt].s.totalChars=nn;var Zt=-1,cn;if(Vt.s.rn===1)for($=0;$<_e;$+=1)Lt=j[$],Zt!=Lt.anIndexes[mt]&&(Zt=Lt.anIndexes[mt],cn=mn.splice(Math.floor(Math.random()*mn.length),1)[0]),Lt.anIndexes[mt]=cn}a.yOffset=a.finalLineHeight||a.finalSize*1.2,a.ls=a.ls||0,a.ascent=ut.ascent*a.finalSize/100},TextProperty.prototype.updateDocumentData=function(a,s){s=s===void 0?this.keysIndex:s;var o=this.copyData({},this.data.d.k[s].s);o=this.copyData(o,a),this.data.d.k[s].s=o,this.recalculate(s),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(a){var s=this.data.d.k[a].s;s.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(s)},TextProperty.prototype.canResizeFont=function(a){this.canResize=a,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(a){this.minimumFontSize=Math.floor(a)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};const TextSelectorProp=function(){var a=Math.max,s=Math.min,o=Math.floor;function j(_e,tt){this._currentTextLength=-1,this.k=!1,this.data=tt,this.elem=_e,this.comp=_e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(_e),this.s=PropertyFactory.getProp(_e,tt.s||{k:0},0,0,this),"e"in tt?this.e=PropertyFactory.getProp(_e,tt.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(_e,tt.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(_e,tt.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(_e,tt.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(_e,tt.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(_e,tt.a,0,.01,this),this.dynamicProperties.length||this.getValue()}j.prototype={getMult:function(_e){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var tt=0,nt=0,rt=1,it=1;this.ne.v>0?tt=this.ne.v/100:nt=-this.ne.v/100,this.xe.v>0?rt=1-this.xe.v/100:it=1+this.xe.v/100;var st=BezierFactory.getBezierEasing(tt,nt,rt,it).get,at=0,ot=this.finalS,ct=this.finalE,ft=this.data.sh;if(ft===2)ct===ot?at=_e>=ct?1:0:at=a(0,s(.5/(ct-ot)+(_e-ot)/(ct-ot),1)),at=st(at);else if(ft===3)ct===ot?at=_e>=ct?0:1:at=1-a(0,s(.5/(ct-ot)+(_e-ot)/(ct-ot),1)),at=st(at);else if(ft===4)ct===ot?at=0:(at=a(0,s(.5/(ct-ot)+(_e-ot)/(ct-ot),1)),at<.5?at*=2:at=1-2*(at-.5)),at=st(at);else if(ft===5){if(ct===ot)at=0;else{var ht=ct-ot;_e=s(a(0,_e+.5-ot),ct-ot);var mt=-ht/2+_e,lt=ht/2;at=Math.sqrt(1-mt*mt/(lt*lt))}at=st(at)}else ft===6?(ct===ot?at=0:(_e=s(a(0,_e+.5-ot),ct-ot),at=(1+Math.cos(Math.PI+Math.PI*2*_e/(ct-ot)))/2),at=st(at)):(_e>=o(ot)&&(_e-ot<0?at=a(0,s(s(ct,1)-(ot-_e),1)):at=a(0,s(ct-_e,1))),at=st(at));if(this.sm.v!==100){var ut=this.sm.v*.01;ut===0&&(ut=1e-8);var dt=.5-ut*.5;at<dt?at=0:(at=(at-dt)/ut,at>1&&(at=1))}return at*this.a.v},getValue:function(_e){this.iterateDynamicProperties(),this._mdf=_e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,_e&&this.data.r===2&&(this.e.v=this._currentTextLength);var tt=this.data.r===2?1:100/this.data.totalChars,nt=this.o.v/tt,rt=this.s.v/tt+nt,it=this.e.v/tt+nt;if(rt>it){var st=rt;rt=it,it=st}this.finalS=rt,this.finalE=it}},extendPrototype([DynamicPropertyContainer],j);function $(_e,tt,nt){return new j(_e,tt)}return{getTextSelectorProp:$}}();function TextAnimatorDataProperty(a,s,o){var j={propType:!1},$=PropertyFactory.getProp,_e=s.a;this.a={r:_e.r?$(a,_e.r,0,degToRads,o):j,rx:_e.rx?$(a,_e.rx,0,degToRads,o):j,ry:_e.ry?$(a,_e.ry,0,degToRads,o):j,sk:_e.sk?$(a,_e.sk,0,degToRads,o):j,sa:_e.sa?$(a,_e.sa,0,degToRads,o):j,s:_e.s?$(a,_e.s,1,.01,o):j,a:_e.a?$(a,_e.a,1,0,o):j,o:_e.o?$(a,_e.o,0,.01,o):j,p:_e.p?$(a,_e.p,1,0,o):j,sw:_e.sw?$(a,_e.sw,0,0,o):j,sc:_e.sc?$(a,_e.sc,1,0,o):j,fc:_e.fc?$(a,_e.fc,1,0,o):j,fh:_e.fh?$(a,_e.fh,0,0,o):j,fs:_e.fs?$(a,_e.fs,0,.01,o):j,fb:_e.fb?$(a,_e.fb,0,.01,o):j,t:_e.t?$(a,_e.t,0,0,o):j},this.s=TextSelectorProp.getTextSelectorProp(a,s.s,o),this.s.t=s.s.t}function TextAnimatorProperty(a,s,o){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=a,this._renderType=s,this._elem=o,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(o)}TextAnimatorProperty.prototype.searchProperties=function(){var a,s=this._textData.a.length,o,j=PropertyFactory.getProp;for(a=0;a<s;a+=1)o=this._textData.a[a],this._animatorsData[a]=new TextAnimatorDataProperty(this._elem,o,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:j(this._elem,this._textData.p.a,0,0,this),f:j(this._elem,this._textData.p.f,0,0,this),l:j(this._elem,this._textData.p.l,0,0,this),r:j(this._elem,this._textData.p.r,0,0,this),p:j(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=j(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(a,s){if(this.lettersChangedFlag=s,!(!this._mdf&&!this._isFirstFrame&&!s&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var o=this._moreOptions.alignment.v,j=this._animatorsData,$=this._textData,_e=this.mHelper,tt=this._renderType,nt=this.renderedLetters.length,rt,it,st,at,ot=a.l,ct,ft,ht,mt,lt,ut,dt,gt,Et,St,Tt,Mt,Bt,Rt,Ut;if(this._hasMaskedPath){if(Ut=this._pathData.m,!this._pathData.n||this._pathData._mdf){var Ht=Ut.v;this._pathData.r.v&&(Ht=Ht.reverse()),ct={tLength:0,segments:[]},at=Ht._length-1;var Wt;for(Mt=0,st=0;st<at;st+=1)Wt=bez.buildBezierData(Ht.v[st],Ht.v[st+1],[Ht.o[st][0]-Ht.v[st][0],Ht.o[st][1]-Ht.v[st][1]],[Ht.i[st+1][0]-Ht.v[st+1][0],Ht.i[st+1][1]-Ht.v[st+1][1]]),ct.tLength+=Wt.segmentLength,ct.segments.push(Wt),Mt+=Wt.segmentLength;st=at,Ut.v.c&&(Wt=bez.buildBezierData(Ht.v[st],Ht.v[0],[Ht.o[st][0]-Ht.v[st][0],Ht.o[st][1]-Ht.v[st][1]],[Ht.i[0][0]-Ht.v[0][0],Ht.i[0][1]-Ht.v[0][1]]),ct.tLength+=Wt.segmentLength,ct.segments.push(Wt),Mt+=Wt.segmentLength),this._pathData.pi=ct}if(ct=this._pathData.pi,ft=this._pathData.f.v,dt=0,ut=1,mt=0,lt=!0,St=ct.segments,ft<0&&Ut.v.c)for(ct.tLength<Math.abs(ft)&&(ft=-Math.abs(ft)%ct.tLength),dt=St.length-1,Et=St[dt].points,ut=Et.length-1;ft<0;)ft+=Et[ut].partialLength,ut-=1,ut<0&&(dt-=1,Et=St[dt].points,ut=Et.length-1);Et=St[dt].points,gt=Et[ut-1],ht=Et[ut],Tt=ht.partialLength}at=ot.length,rt=0,it=0;var Jt=a.finalSize*1.2*.714,sn=!0,jt,Vt,Lt,Qt,nn;Qt=j.length;var mn,Zt=-1,cn,Ot,rn,fn=ft,hn=dt,Tn=ut,Nn=-1,Pn,Dn,ln,Cn,bn,kn,Sn,xn,Qn="",nr=this.defaultPropsArray,or;if(a.j===2||a.j===1){var mr=0,$n=0,tn=a.j===2?-.5:-1,$t=0,An=!0;for(st=0;st<at;st+=1)if(ot[st].n){for(mr&&(mr+=$n);$t<st;)ot[$t].animatorJustifyOffset=mr,$t+=1;mr=0,An=!0}else{for(Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.t.propType&&(An&&a.j===2&&($n+=jt.t.v*tn),Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),mn.length?mr+=jt.t.v*mn[0]*tn:mr+=jt.t.v*mn*tn);An=!1}for(mr&&(mr+=$n);$t<st;)ot[$t].animatorJustifyOffset=mr,$t+=1}for(st=0;st<at;st+=1){if(_e.reset(),Pn=1,ot[st].n)rt=0,it+=a.yOffset,it+=sn?1:0,ft=fn,sn=!1,this._hasMaskedPath&&(dt=hn,ut=Tn,Et=St[dt].points,gt=Et[ut-1],ht=Et[ut],Tt=ht.partialLength,mt=0),Qn="",xn="",kn="",or="",nr=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Nn!==ot[st].line){switch(a.j){case 1:ft+=Mt-a.lineWidths[ot[st].line];break;case 2:ft+=(Mt-a.lineWidths[ot[st].line])/2;break}Nn=ot[st].line}Zt!==ot[st].ind&&(ot[Zt]&&(ft+=ot[Zt].extra),ft+=ot[st].an/2,Zt=ot[st].ind),ft+=o[0]*ot[st].an*.005;var En=0;for(Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.p.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),mn.length?En+=jt.p.v[0]*mn[0]:En+=jt.p.v[0]*mn),jt.a.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),mn.length?En+=jt.a.v[0]*mn[0]:En+=jt.a.v[0]*mn);for(lt=!0,this._pathData.a.v&&(ft=ot[0].an*.5+(Mt-this._pathData.f.v-ot[0].an*.5-ot[ot.length-1].an*.5)*Zt/(at-1),ft+=this._pathData.f.v);lt;)mt+Tt>=ft+En||!Et?(Bt=(ft+En-mt)/ht.partialLength,Ot=gt.point[0]+(ht.point[0]-gt.point[0])*Bt,rn=gt.point[1]+(ht.point[1]-gt.point[1])*Bt,_e.translate(-o[0]*ot[st].an*.005,-(o[1]*Jt)*.01),lt=!1):Et&&(mt+=ht.partialLength,ut+=1,ut>=Et.length&&(ut=0,dt+=1,St[dt]?Et=St[dt].points:Ut.v.c?(ut=0,dt=0,Et=St[dt].points):(mt-=ht.partialLength,Et=null)),Et&&(gt=ht,ht=Et[ut],Tt=ht.partialLength));cn=ot[st].an/2-ot[st].add,_e.translate(-cn,0,0)}else cn=ot[st].an/2-ot[st].add,_e.translate(-cn,0,0),_e.translate(-o[0]*ot[st].an*.005,-o[1]*Jt*.01,0);for(Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.t.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),(rt!==0||a.j!==0)&&(this._hasMaskedPath?mn.length?ft+=jt.t.v*mn[0]:ft+=jt.t.v*mn:mn.length?rt+=jt.t.v*mn[0]:rt+=jt.t.v*mn));for(a.strokeWidthAnim&&(ln=a.sw||0),a.strokeColorAnim&&(a.sc?Dn=[a.sc[0],a.sc[1],a.sc[2]]:Dn=[0,0,0]),a.fillColorAnim&&a.fc&&(Cn=[a.fc[0],a.fc[1],a.fc[2]]),Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.a.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),mn.length?_e.translate(-jt.a.v[0]*mn[0],-jt.a.v[1]*mn[1],jt.a.v[2]*mn[2]):_e.translate(-jt.a.v[0]*mn,-jt.a.v[1]*mn,jt.a.v[2]*mn));for(Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.s.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),mn.length?_e.scale(1+(jt.s.v[0]-1)*mn[0],1+(jt.s.v[1]-1)*mn[1],1):_e.scale(1+(jt.s.v[0]-1)*mn,1+(jt.s.v[1]-1)*mn,1));for(Lt=0;Lt<Qt;Lt+=1){if(jt=j[Lt].a,Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),jt.sk.propType&&(mn.length?_e.skewFromAxis(-jt.sk.v*mn[0],jt.sa.v*mn[1]):_e.skewFromAxis(-jt.sk.v*mn,jt.sa.v*mn)),jt.r.propType&&(mn.length?_e.rotateZ(-jt.r.v*mn[2]):_e.rotateZ(-jt.r.v*mn)),jt.ry.propType&&(mn.length?_e.rotateY(jt.ry.v*mn[1]):_e.rotateY(jt.ry.v*mn)),jt.rx.propType&&(mn.length?_e.rotateX(jt.rx.v*mn[0]):_e.rotateX(jt.rx.v*mn)),jt.o.propType&&(mn.length?Pn+=(jt.o.v*mn[0]-Pn)*mn[0]:Pn+=(jt.o.v*mn-Pn)*mn),a.strokeWidthAnim&&jt.sw.propType&&(mn.length?ln+=jt.sw.v*mn[0]:ln+=jt.sw.v*mn),a.strokeColorAnim&&jt.sc.propType)for(bn=0;bn<3;bn+=1)mn.length?Dn[bn]+=(jt.sc.v[bn]-Dn[bn])*mn[0]:Dn[bn]+=(jt.sc.v[bn]-Dn[bn])*mn;if(a.fillColorAnim&&a.fc){if(jt.fc.propType)for(bn=0;bn<3;bn+=1)mn.length?Cn[bn]+=(jt.fc.v[bn]-Cn[bn])*mn[0]:Cn[bn]+=(jt.fc.v[bn]-Cn[bn])*mn;jt.fh.propType&&(mn.length?Cn=addHueToRGB(Cn,jt.fh.v*mn[0]):Cn=addHueToRGB(Cn,jt.fh.v*mn)),jt.fs.propType&&(mn.length?Cn=addSaturationToRGB(Cn,jt.fs.v*mn[0]):Cn=addSaturationToRGB(Cn,jt.fs.v*mn)),jt.fb.propType&&(mn.length?Cn=addBrightnessToRGB(Cn,jt.fb.v*mn[0]):Cn=addBrightnessToRGB(Cn,jt.fb.v*mn))}}for(Lt=0;Lt<Qt;Lt+=1)jt=j[Lt].a,jt.p.propType&&(Vt=j[Lt].s,mn=Vt.getMult(ot[st].anIndexes[Lt],$.a[Lt].s.totalChars),this._hasMaskedPath?mn.length?_e.translate(0,jt.p.v[1]*mn[0],-jt.p.v[2]*mn[1]):_e.translate(0,jt.p.v[1]*mn,-jt.p.v[2]*mn):mn.length?_e.translate(jt.p.v[0]*mn[0],jt.p.v[1]*mn[1],-jt.p.v[2]*mn[2]):_e.translate(jt.p.v[0]*mn,jt.p.v[1]*mn,-jt.p.v[2]*mn));if(a.strokeWidthAnim&&(kn=ln<0?0:ln),a.strokeColorAnim&&(Sn="rgb("+Math.round(Dn[0]*255)+","+Math.round(Dn[1]*255)+","+Math.round(Dn[2]*255)+")"),a.fillColorAnim&&a.fc&&(xn="rgb("+Math.round(Cn[0]*255)+","+Math.round(Cn[1]*255)+","+Math.round(Cn[2]*255)+")"),this._hasMaskedPath){if(_e.translate(0,-a.ls),_e.translate(0,o[1]*Jt*.01+it,0),this._pathData.p.v){Rt=(ht.point[1]-gt.point[1])/(ht.point[0]-gt.point[0]);var In=Math.atan(Rt)*180/Math.PI;ht.point[0]<gt.point[0]&&(In+=180),_e.rotate(-In*Math.PI/180)}_e.translate(Ot,rn,0),ft-=o[0]*ot[st].an*.005,ot[st+1]&&Zt!==ot[st+1].ind&&(ft+=ot[st].an/2,ft+=a.tr*.001*a.finalSize)}else{switch(_e.translate(rt,it,0),a.ps&&_e.translate(a.ps[0],a.ps[1]+a.ascent,0),a.j){case 1:_e.translate(ot[st].animatorJustifyOffset+a.justifyOffset+(a.boxWidth-a.lineWidths[ot[st].line]),0,0);break;case 2:_e.translate(ot[st].animatorJustifyOffset+a.justifyOffset+(a.boxWidth-a.lineWidths[ot[st].line])/2,0,0);break}_e.translate(0,-a.ls),_e.translate(cn,0,0),_e.translate(o[0]*ot[st].an*.005,o[1]*Jt*.01,0),rt+=ot[st].l+a.tr*.001*a.finalSize}tt==="html"?Qn=_e.toCSS():tt==="svg"?Qn=_e.to2dCSS():nr=[_e.props[0],_e.props[1],_e.props[2],_e.props[3],_e.props[4],_e.props[5],_e.props[6],_e.props[7],_e.props[8],_e.props[9],_e.props[10],_e.props[11],_e.props[12],_e.props[13],_e.props[14],_e.props[15]],or=Pn}nt<=st?(nn=new LetterProps(or,kn,Sn,xn,Qn,nr),this.renderedLetters.push(nn),nt+=1,this.lettersChangedFlag=!0):(nn=this.renderedLetters[st],this.lettersChangedFlag=nn.update(or,kn,Sn,xn,Qn,nr)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(a,s,o){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(a,s,o),this.textProperty=new TextProperty(this,a.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(a.t,this.renderType,this),this.initTransform(a,s,o),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(a){this._mdf=!1,this.prepareRenderableFrame(a),this.prepareProperties(a,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(a,s){var o,j=s.length,$,_e="";for(o=0;o<j;o+=1)s[o].ty==="sh"&&($=s[o].ks.k,_e+=buildShapeString($,$.i.length,!0,a));return _e},ITextElement.prototype.updateDocumentData=function(a,s){this.textProperty.updateDocumentData(a,s)},ITextElement.prototype.canResizeFont=function(a){this.textProperty.canResizeFont(a)},ITextElement.prototype.setMinimumFontSize=function(a){this.textProperty.setMinimumFontSize(a)},ITextElement.prototype.applyTextPropertiesToMatrix=function(a,s,o,j,$){switch(a.ps&&s.translate(a.ps[0],a.ps[1]+a.ascent,0),s.translate(0,-a.ls,0),a.j){case 1:s.translate(a.justifyOffset+(a.boxWidth-a.lineWidths[o]),0,0);break;case 2:s.translate(a.justifyOffset+(a.boxWidth-a.lineWidths[o])/2,0,0);break}s.translate(j,$,0)},ITextElement.prototype.buildColor=function(a){return"rgb("+Math.round(a[0]*255)+","+Math.round(a[1]*255)+","+Math.round(a[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){};var emptyShapeData={shapes:[]};function SVGTextLottieElement(a,s,o){this.textSpans=[],this.renderType="svg",this.initElement(a,s,o)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(a){for(var s=0,o=a.length,j=[],$="";s<o;)a[s]===String.fromCharCode(13)||a[s]===String.fromCharCode(3)?(j.push($),$=""):$+=a[s],s+=1;return j.push($),j},SVGTextLottieElement.prototype.buildShapeData=function(a,s){if(a.shapes&&a.shapes.length){var o=a.shapes[0];if(o.it){var j=o.it[o.it.length-1];j.s&&(j.s.k[0]=s,j.s.k[1]=s)}}return a},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var a,s,o=this.textProperty.currentData;this.renderedLetters=createSizedArray(o?o.l.length:0),o.fc?this.layerElement.setAttribute("fill",this.buildColor(o.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),o.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(o.sc)),this.layerElement.setAttribute("stroke-width",o.sw)),this.layerElement.setAttribute("font-size",o.finalSize);var j=this.globalData.fontManager.getFontByName(o.f);if(j.fClass)this.layerElement.setAttribute("class",j.fClass);else{this.layerElement.setAttribute("font-family",j.fFamily);var $=o.fWeight,_e=o.fStyle;this.layerElement.setAttribute("font-style",_e),this.layerElement.setAttribute("font-weight",$)}this.layerElement.setAttribute("aria-label",o.t);var tt=o.l||[],nt=!!this.globalData.fontManager.chars;s=tt.length;var rt,it=this.mHelper,st="",at=this.data.singleShape,ot=0,ct=0,ft=!0,ht=o.tr*.001*o.finalSize;if(at&&!nt&&!o.sz){var mt=this.textContainer,lt="start";switch(o.j){case 1:lt="end";break;case 2:lt="middle";break;default:lt="start";break}mt.setAttribute("text-anchor",lt),mt.setAttribute("letter-spacing",ht);var ut=this.buildTextContents(o.finalText);for(s=ut.length,ct=o.ps?o.ps[1]+o.ascent:0,a=0;a<s;a+=1)rt=this.textSpans[a].span||createNS("tspan"),rt.textContent=ut[a],rt.setAttribute("x",0),rt.setAttribute("y",ct),rt.style.display="inherit",mt.appendChild(rt),this.textSpans[a]||(this.textSpans[a]={span:null,glyph:null}),this.textSpans[a].span=rt,ct+=o.finalLineHeight;this.layerElement.appendChild(mt)}else{var dt=this.textSpans.length,gt;for(a=0;a<s;a+=1){if(this.textSpans[a]||(this.textSpans[a]={span:null,childSpan:null,glyph:null}),!nt||!at||a===0){if(rt=dt>a?this.textSpans[a].span:createNS(nt?"g":"text"),dt<=a){if(rt.setAttribute("stroke-linecap","butt"),rt.setAttribute("stroke-linejoin","round"),rt.setAttribute("stroke-miterlimit","4"),this.textSpans[a].span=rt,nt){var Et=createNS("g");rt.appendChild(Et),this.textSpans[a].childSpan=Et}this.textSpans[a].span=rt,this.layerElement.appendChild(rt)}rt.style.display="inherit"}if(it.reset(),at&&(tt[a].n&&(ot=-ht,ct+=o.yOffset,ct+=ft?1:0,ft=!1),this.applyTextPropertiesToMatrix(o,it,tt[a].line,ot,ct),ot+=tt[a].l||0,ot+=ht),nt){gt=this.globalData.fontManager.getCharData(o.finalText[a],j.fStyle,this.globalData.fontManager.getFontByName(o.f).fFamily);var St;if(gt.t===1)St=new SVGCompElement(gt.data,this.globalData,this);else{var Tt=emptyShapeData;gt.data&&gt.data.shapes&&(Tt=this.buildShapeData(gt.data,o.finalSize)),St=new SVGShapeElement(Tt,this.globalData,this)}if(this.textSpans[a].glyph){var Mt=this.textSpans[a].glyph;this.textSpans[a].childSpan.removeChild(Mt.layerElement),Mt.destroy()}this.textSpans[a].glyph=St,St._debug=!0,St.prepareFrame(0),St.renderFrame(),this.textSpans[a].childSpan.appendChild(St.layerElement),gt.t===1&&this.textSpans[a].childSpan.setAttribute("transform","scale("+o.finalSize/100+","+o.finalSize/100+")")}else at&&rt.setAttribute("transform","translate("+it.props[12]+","+it.props[13]+")"),rt.textContent=tt[a].val,rt.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}at&&rt&&rt.setAttribute("d",st)}for(;a<this.textSpans.length;)this.textSpans[a].span.style.display="none",a+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var a=this.layerElement.getBBox();this.bbox={top:a.y,left:a.x,width:a.width,height:a.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var a,s=this.textSpans.length,o;for(this.renderedFrame=this.comp.renderedFrame,a=0;a<s;a+=1)o=this.textSpans[a].glyph,o&&(o.prepareFrame(this.comp.renderedFrame-this.data.st),o._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if((!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var a,s,o=this.textAnimator.renderedLetters,j=this.textProperty.currentData.l;s=j.length;var $,_e,tt;for(a=0;a<s;a+=1)j[a].n||($=o[a],_e=this.textSpans[a].span,tt=this.textSpans[a].glyph,tt&&tt.renderFrame(),$._mdf.m&&_e.setAttribute("transform",$.m),$._mdf.o&&_e.setAttribute("opacity",$.o),$._mdf.sw&&_e.setAttribute("stroke-width",$.sw),$._mdf.sc&&_e.setAttribute("stroke",$.sc),$._mdf.fc&&_e.setAttribute("fill",$.fc))}};function ISolidElement(a,s,o){this.initElement(a,s,o)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var a=createNS("rect");a.setAttribute("width",this.data.sw),a.setAttribute("height",this.data.sh),a.setAttribute("fill",this.data.sc),this.layerElement.appendChild(a)};function NullElement(a,s,o){this.initFrame(),this.initBaseData(a,s,o),this.initFrame(),this.initTransform(a,s,o),this.initHierarchy()}NullElement.prototype.prepareFrame=function(a){this.prepareProperties(a,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(a){return new NullElement(a,this.globalData,this)},SVGRendererBase.prototype.createShape=function(a){return new SVGShapeElement(a,this.globalData,this)},SVGRendererBase.prototype.createText=function(a){return new SVGTextLottieElement(a,this.globalData,this)},SVGRendererBase.prototype.createImage=function(a){return new IImageElement(a,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(a){return new ISolidElement(a,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(a){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+a.w+" "+a.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",a.w),this.svgElement.setAttribute("height",a.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var s=this.globalData.defs;this.setupGlobalData(a,s),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=a;var o=createNS("clipPath"),j=createNS("rect");j.setAttribute("width",a.w),j.setAttribute("height",a.h),j.setAttribute("x",0),j.setAttribute("y",0);var $=createElementID();o.setAttribute("id",$),o.appendChild(j),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+$+")"),s.appendChild(o),this.layers=a.layers,this.elements=createSizedArray(a.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var a,s=this.layers?this.layers.length:0;for(a=0;a<s;a+=1)this.elements[a]&&this.elements[a].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.buildItem=function(a){var s=this.elements;if(!(s[a]||this.layers[a].ty===99)){s[a]=!0;var o=this.createItem(this.layers[a]);s[a]=o,getExpressionsPlugin()&&(this.layers[a].ty===0&&this.globalData.projectInterface.registerComposition(o),o.initExpressions()),this.appendElementInPos(o,a),this.layers[a].tt&&(!this.elements[a-1]||this.elements[a-1]===!0?(this.buildItem(a-1),this.addPendingElement(o)):o.setMatte(s[a-1].layerId))}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var a=this.pendingElements.pop();if(a.checkParenting(),a.data.tt)for(var s=0,o=this.elements.length;s<o;){if(this.elements[s]===a){a.setMatte(this.elements[s-1].layerId);break}s+=1}}},SVGRendererBase.prototype.renderFrame=function(a){if(!(this.renderedFrame===a||this.destroyed)){a===null?a=this.renderedFrame:this.renderedFrame=a,this.globalData.frameNum=a,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=a,this.globalData._mdf=!1;var s,o=this.layers.length;for(this.completeLayers||this.checkLayers(a),s=o-1;s>=0;s-=1)(this.completeLayers||this.elements[s])&&this.elements[s].prepareFrame(a-this.layers[s].st);if(this.globalData._mdf)for(s=0;s<o;s+=1)(this.completeLayers||this.elements[s])&&this.elements[s].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(a,s){var o=a.getBaseElement();if(o){for(var j=0,$;j<s;)this.elements[j]&&this.elements[j]!==!0&&this.elements[j].getBaseElement()&&($=this.elements[j].getBaseElement()),j+=1;$?this.layerElement.insertBefore(o,$):this.layerElement.appendChild(o)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(a,s,o){this.initFrame(),this.initBaseData(a,s,o),this.initTransform(a,s,o),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!s.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(a){if(this._mdf=!1,this.prepareRenderableFrame(a),this.prepareProperties(a,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=a/this.data.sr;else{var s=this.tm.v;s===this.data.op&&(s=this.data.op-1),this.renderedFrame=s}var o,j=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),o=j-1;o>=0;o-=1)(this.completeLayers||this.elements[o])&&(this.elements[o].prepareFrame(this.renderedFrame-this.layers[o].st),this.elements[o]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var a,s=this.layers.length;for(a=0;a<s;a+=1)(this.completeLayers||this.elements[a])&&this.elements[a].renderFrame()},ICompElement.prototype.setElements=function(a){this.elements=a},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var a,s=this.layers.length;for(a=0;a<s;a+=1)this.elements[a]&&this.elements[a].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(a,s,o){this.layers=a.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(a,s,o),this.tm=a.tm?PropertyFactory.getProp(this,a.tm,0,s.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(a){return new SVGCompElement(a,this.globalData,this)};function SVGRenderer(a,s){this.animationItem=a,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var o="";if(s&&s.title){var j=createNS("title"),$=createElementID();j.setAttribute("id",$),j.textContent=s.title,this.svgElement.appendChild(j),o+=$}if(s&&s.description){var _e=createNS("desc"),tt=createElementID();_e.setAttribute("id",tt),_e.textContent=s.description,this.svgElement.appendChild(_e),o+=" "+tt}o&&this.svgElement.setAttribute("aria-labelledby",o);var nt=createNS("defs");this.svgElement.appendChild(nt);var rt=createNS("g");this.svgElement.appendChild(rt),this.layerElement=rt,this.renderConfig={preserveAspectRatio:s&&s.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:s&&s.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:s&&s.contentVisibility||"visible",progressiveLoad:s&&s.progressiveLoad||!1,hideOnTransparent:!(s&&s.hideOnTransparent===!1),viewBoxOnly:s&&s.viewBoxOnly||!1,viewBoxSize:s&&s.viewBoxSize||!1,className:s&&s.className||"",id:s&&s.id||"",focusable:s&&s.focusable,filterSize:{width:s&&s.filterSize&&s.filterSize.width||"100%",height:s&&s.filterSize&&s.filterSize.height||"100%",x:s&&s.filterSize&&s.filterSize.x||"0%",y:s&&s.filterSize&&s.filterSize.y||"0%"},width:s&&s.width,height:s&&s.height},this.globalData={_mdf:!1,frameNum:-1,defs:nt,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(a){return new SVGCompElement(a,this.globalData,this)};function CVContextData(){this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1;var a,s=15;for(this.savedOp=createTypedArray("float32",s),a=0;a<s;a+=1)this.saved[a]=createTypedArray("float32",16);this._length=s}CVContextData.prototype.duplicate=function(){var a=this._length*2,s=this.savedOp;this.savedOp=createTypedArray("float32",a),this.savedOp.set(s);var o=0;for(o=this._length;o<a;o+=1)this.saved[o]=createTypedArray("float32",16);this._length=a},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(a){var s,o=a.length,j="_";for(s=0;s<o;s+=1)j+=a[s].transform.key+"_";var $=this.sequences[j];return $||($={transforms:[].concat(a),finalTransform:new Matrix,_mdf:!1},this.sequences[j]=$,this.sequenceList.push($)),$},processSequence:function(a,s){for(var o=0,j=a.transforms.length,$=s;o<j&&!s;){if(a.transforms[o].transform.mProps._mdf){$=!0;break}o+=1}if($){var _e;for(a.finalTransform.reset(),o=j-1;o>=0;o-=1)_e=a.transforms[o].transform.mProps.v.props,a.finalTransform.transform(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5],_e[6],_e[7],_e[8],_e[9],_e[10],_e[11],_e[12],_e[13],_e[14],_e[15])}a._mdf=$},processSequences:function(a){var s,o=this.sequenceList.length;for(s=0;s<o;s+=1)this.processSequence(this.sequenceList[s],a)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};function CVEffects(){}CVEffects.prototype.renderFrame=function(){};function CVMaskElement(a,s){this.data=a,this.element=s,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var o,j=this.masksProperties.length,$=!1;for(o=0;o<j;o+=1)this.masksProperties[o].mode!=="n"&&($=!0),this.viewData[o]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[o],3);this.hasMasks=$,$&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var a=this.element.finalTransform.mat,s=this.element.canvasContext,o,j=this.masksProperties.length,$,_e,tt;for(s.beginPath(),o=0;o<j;o+=1)if(this.masksProperties[o].mode!=="n"){this.masksProperties[o].inv&&(s.moveTo(0,0),s.lineTo(this.element.globalData.compSize.w,0),s.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),s.lineTo(0,this.element.globalData.compSize.h),s.lineTo(0,0)),tt=this.viewData[o].v,$=a.applyToPointArray(tt.v[0][0],tt.v[0][1],0),s.moveTo($[0],$[1]);var nt,rt=tt._length;for(nt=1;nt<rt;nt+=1)_e=a.applyToTriplePoints(tt.o[nt-1],tt.i[nt],tt.v[nt]),s.bezierCurveTo(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5]);_e=a.applyToTriplePoints(tt.o[nt-1],tt.i[0],tt.v[0]),s.bezierCurveTo(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5])}this.element.globalData.renderer.save(!0),s.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects},createContent:function(){},setBlendMode:function(){var a=this.globalData;if(a.blendMode!==this.data.bm){a.blendMode=this.data.bm;var s=getBlendMode(this.data.bm);a.canvasContext.globalCompositeOperation=s}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!(this.hidden||this.data.hd)){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var a=this.data.ty===0;this.globalData.renderer.save(a),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(a),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(a,s,o,j){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var $=4;s.ty==="rc"?$=5:s.ty==="el"?$=6:s.ty==="sr"&&($=7),this.sh=ShapePropertyFactory.getShapeProp(a,s,$,a);var _e,tt=o.length,nt;for(_e=0;_e<tt;_e+=1)o[_e].closed||(nt={transforms:j.addTransformSequence(o[_e].transforms),trNodes:[]},this.styledShapes.push(nt),o[_e].elements.push(nt))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(a,s,o){this.shapes=[],this.shapesData=a.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(a,s,o)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(a,s){var o={data:a,type:a.ty,preTransforms:this.transformsManager.addTransformSequence(s),transforms:[],elements:[],closed:a.hd===!0},j={};if(a.ty==="fl"||a.ty==="st"?(j.c=PropertyFactory.getProp(this,a.c,1,255,this),j.c.k||(o.co="rgb("+bmFloor(j.c.v[0])+","+bmFloor(j.c.v[1])+","+bmFloor(j.c.v[2])+")")):(a.ty==="gf"||a.ty==="gs")&&(j.s=PropertyFactory.getProp(this,a.s,1,null,this),j.e=PropertyFactory.getProp(this,a.e,1,null,this),j.h=PropertyFactory.getProp(this,a.h||{k:0},0,.01,this),j.a=PropertyFactory.getProp(this,a.a||{k:0},0,degToRads,this),j.g=new GradientProperty(this,a.g,this)),j.o=PropertyFactory.getProp(this,a.o,0,.01,this),a.ty==="st"||a.ty==="gs"){if(o.lc=lineCapEnum[a.lc||2],o.lj=lineJoinEnum[a.lj||2],a.lj==1&&(o.ml=a.ml),j.w=PropertyFactory.getProp(this,a.w,0,null,this),j.w.k||(o.wi=j.w.v),a.d){var $=new DashProperty(this,a.d,"canvas",this);j.d=$,j.d.k||(o.da=j.d.dashArray,o.do=j.d.dashoffset[0])}}else o.r=a.r===2?"evenodd":"nonzero";return this.stylesList.push(o),j.style=o,j},CVShapeElement.prototype.createGroupElement=function(){var a={it:[],prevViewData:[]};return a},CVShapeElement.prototype.createTransformElement=function(a){var s={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,a.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,a,this)}};return s},CVShapeElement.prototype.createShapeElement=function(a){var s=new CVShapeData(this,a,this.stylesList,this.transformsManager);return this.shapes.push(s),this.addShapeToModifiers(s),s},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var a,s=this.itemsData.length;for(a=0;a<s;a+=1)this.prevViewData[a]=this.itemsData[a];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),s=this.dynamicProperties.length,a=0;a<s;a+=1)this.dynamicProperties[a].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(a){var s,o=this.stylesList.length;for(s=0;s<o;s+=1)this.stylesList[s].closed||this.stylesList[s].transforms.push(a)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var a,s=this.stylesList.length;for(a=0;a<s;a+=1)this.stylesList[a].closed||this.stylesList[a].transforms.pop()},CVShapeElement.prototype.closeStyles=function(a){var s,o=a.length;for(s=0;s<o;s+=1)a[s].closed=!0},CVShapeElement.prototype.searchShapes=function(a,s,o,j,$){var _e,tt=a.length-1,nt,rt,it=[],st=[],at,ot,ct,ft=[].concat($);for(_e=tt;_e>=0;_e-=1){if(at=this.searchProcessedElement(a[_e]),at?s[_e]=o[at-1]:a[_e]._shouldRender=j,a[_e].ty==="fl"||a[_e].ty==="st"||a[_e].ty==="gf"||a[_e].ty==="gs")at?s[_e].style.closed=!1:s[_e]=this.createStyleElement(a[_e],ft),it.push(s[_e].style);else if(a[_e].ty==="gr"){if(!at)s[_e]=this.createGroupElement(a[_e]);else for(rt=s[_e].it.length,nt=0;nt<rt;nt+=1)s[_e].prevViewData[nt]=s[_e].it[nt];this.searchShapes(a[_e].it,s[_e].it,s[_e].prevViewData,j,ft)}else a[_e].ty==="tr"?(at||(ct=this.createTransformElement(a[_e]),s[_e]=ct),ft.push(s[_e]),this.addTransformToStyleList(s[_e])):a[_e].ty==="sh"||a[_e].ty==="rc"||a[_e].ty==="el"||a[_e].ty==="sr"?at||(s[_e]=this.createShapeElement(a[_e])):a[_e].ty==="tm"||a[_e].ty==="rd"||a[_e].ty==="pb"?(at?(ot=s[_e],ot.closed=!1):(ot=ShapeModifiers.getModifier(a[_e].ty),ot.init(this,a[_e]),s[_e]=ot,this.shapeModifiers.push(ot)),st.push(ot)):a[_e].ty==="rp"&&(at?(ot=s[_e],ot.closed=!0):(ot=ShapeModifiers.getModifier(a[_e].ty),s[_e]=ot,ot.init(this,a,_e,s),this.shapeModifiers.push(ot),j=!1),st.push(ot));this.addProcessedElement(a[_e],_e+1)}for(this.removeTransformFromStyleList(),this.closeStyles(it),tt=st.length,_e=0;_e<tt;_e+=1)st[_e].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(a,s){(a._opMdf||s.op._mdf||this._isFirstFrame)&&(s.opacity=a.opacity,s.opacity*=s.op.v,s._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var a,s=this.stylesList.length,o,j,$,_e,tt,nt,rt=this.globalData.renderer,it=this.globalData.canvasContext,st,at;for(a=0;a<s;a+=1)if(at=this.stylesList[a],st=at.type,!((st==="st"||st==="gs")&&at.wi===0||!at.data._shouldRender||at.coOp===0||this.globalData.currentGlobalAlpha===0)){for(rt.save(),tt=at.elements,st==="st"||st==="gs"?(it.strokeStyle=st==="st"?at.co:at.grd,it.lineWidth=at.wi,it.lineCap=at.lc,it.lineJoin=at.lj,it.miterLimit=at.ml||0):it.fillStyle=st==="fl"?at.co:at.grd,rt.ctxOpacity(at.coOp),st!=="st"&&st!=="gs"&&it.beginPath(),rt.ctxTransform(at.preTransforms.finalTransform.props),j=tt.length,o=0;o<j;o+=1){for((st==="st"||st==="gs")&&(it.beginPath(),at.da&&(it.setLineDash(at.da),it.lineDashOffset=at.do)),nt=tt[o].trNodes,_e=nt.length,$=0;$<_e;$+=1)nt[$].t==="m"?it.moveTo(nt[$].p[0],nt[$].p[1]):nt[$].t==="c"?it.bezierCurveTo(nt[$].pts[0],nt[$].pts[1],nt[$].pts[2],nt[$].pts[3],nt[$].pts[4],nt[$].pts[5]):it.closePath();(st==="st"||st==="gs")&&(it.stroke(),at.da&&it.setLineDash(this.dashResetter))}st!=="st"&&st!=="gs"&&it.fill(at.r),rt.restore()}},CVShapeElement.prototype.renderShape=function(a,s,o,j){var $,_e=s.length-1,tt;for(tt=a,$=_e;$>=0;$-=1)s[$].ty==="tr"?(tt=o[$].transform,this.renderShapeTransform(a,tt)):s[$].ty==="sh"||s[$].ty==="el"||s[$].ty==="rc"||s[$].ty==="sr"?this.renderPath(s[$],o[$]):s[$].ty==="fl"?this.renderFill(s[$],o[$],tt):s[$].ty==="st"?this.renderStroke(s[$],o[$],tt):s[$].ty==="gf"||s[$].ty==="gs"?this.renderGradientFill(s[$],o[$],tt):s[$].ty==="gr"?this.renderShape(tt,s[$].it,o[$].it):s[$].ty;j&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(a,s){if(this._isFirstFrame||s._mdf||a.transforms._mdf){var o=a.trNodes,j=s.paths,$,_e,tt,nt=j._length;o.length=0;var rt=a.transforms.finalTransform;for(tt=0;tt<nt;tt+=1){var it=j.shapes[tt];if(it&&it.v){for(_e=it._length,$=1;$<_e;$+=1)$===1&&o.push({t:"m",p:rt.applyToPointArray(it.v[0][0],it.v[0][1],0)}),o.push({t:"c",pts:rt.applyToTriplePoints(it.o[$-1],it.i[$],it.v[$])});_e===1&&o.push({t:"m",p:rt.applyToPointArray(it.v[0][0],it.v[0][1],0)}),it.c&&_e&&(o.push({t:"c",pts:rt.applyToTriplePoints(it.o[$-1],it.i[0],it.v[0])}),o.push({t:"z"}))}}a.trNodes=o}},CVShapeElement.prototype.renderPath=function(a,s){if(a.hd!==!0&&a._shouldRender){var o,j=s.styledShapes.length;for(o=0;o<j;o+=1)this.renderStyledShape(s.styledShapes[o],s.sh)}},CVShapeElement.prototype.renderFill=function(a,s,o){var j=s.style;(s.c._mdf||this._isFirstFrame)&&(j.co="rgb("+bmFloor(s.c.v[0])+","+bmFloor(s.c.v[1])+","+bmFloor(s.c.v[2])+")"),(s.o._mdf||o._opMdf||this._isFirstFrame)&&(j.coOp=s.o.v*o.opacity)},CVShapeElement.prototype.renderGradientFill=function(a,s,o){var j=s.style,$;if(!j.grd||s.g._mdf||s.s._mdf||s.e._mdf||a.t!==1&&(s.h._mdf||s.a._mdf)){var _e=this.globalData.canvasContext,tt=s.s.v,nt=s.e.v;if(a.t===1)$=_e.createLinearGradient(tt[0],tt[1],nt[0],nt[1]);else{var rt=Math.sqrt(Math.pow(tt[0]-nt[0],2)+Math.pow(tt[1]-nt[1],2)),it=Math.atan2(nt[1]-tt[1],nt[0]-tt[0]),st=s.h.v;st>=1?st=.99:st<=-1&&(st=-.99);var at=rt*st,ot=Math.cos(it+s.a.v)*at+tt[0],ct=Math.sin(it+s.a.v)*at+tt[1];$=_e.createRadialGradient(ot,ct,0,tt[0],tt[1],rt)}var ft,ht=a.g.p,mt=s.g.c,lt=1;for(ft=0;ft<ht;ft+=1)s.g._hasOpacity&&s.g._collapsable&&(lt=s.g.o[ft*2+1]),$.addColorStop(mt[ft*4]/100,"rgba("+mt[ft*4+1]+","+mt[ft*4+2]+","+mt[ft*4+3]+","+lt+")");j.grd=$}j.coOp=s.o.v*o.opacity},CVShapeElement.prototype.renderStroke=function(a,s,o){var j=s.style,$=s.d;$&&($._mdf||this._isFirstFrame)&&(j.da=$.dashArray,j.do=$.dashoffset[0]),(s.c._mdf||this._isFirstFrame)&&(j.co="rgb("+bmFloor(s.c.v[0])+","+bmFloor(s.c.v[1])+","+bmFloor(s.c.v[2])+")"),(s.o._mdf||o._opMdf||this._isFirstFrame)&&(j.coOp=s.o.v*o.opacity),(s.w._mdf||this._isFirstFrame)&&(j.wi=s.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(a,s,o){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(a,s,o)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var a=this.textProperty.currentData;this.renderedLetters=createSizedArray(a.l?a.l.length:0);var s=!1;a.fc?(s=!0,this.values.fill=this.buildColor(a.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=s;var o=!1;a.sc&&(o=!0,this.values.stroke=this.buildColor(a.sc),this.values.sWidth=a.sw);var j=this.globalData.fontManager.getFontByName(a.f),$,_e,tt=a.l,nt=this.mHelper;this.stroke=o,this.values.fValue=a.finalSize+"px "+this.globalData.fontManager.getFontByName(a.f).fFamily,_e=a.finalText.length;var rt,it,st,at,ot,ct,ft,ht,mt,lt,ut=this.data.singleShape,dt=a.tr*.001*a.finalSize,gt=0,Et=0,St=!0,Tt=0;for($=0;$<_e;$+=1){rt=this.globalData.fontManager.getCharData(a.finalText[$],j.fStyle,this.globalData.fontManager.getFontByName(a.f).fFamily),it=rt&&rt.data||{},nt.reset(),ut&&tt[$].n&&(gt=-dt,Et+=a.yOffset,Et+=St?1:0,St=!1),ot=it.shapes?it.shapes[0].it:[],ft=ot.length,nt.scale(a.finalSize/100,a.finalSize/100),ut&&this.applyTextPropertiesToMatrix(a,nt,tt[$].line,gt,Et),mt=createSizedArray(ft-1);var Mt=0;for(ct=0;ct<ft;ct+=1)if(ot[ct].ty==="sh"){for(at=ot[ct].ks.k.i.length,ht=ot[ct].ks.k,lt=[],st=1;st<at;st+=1)st===1&&lt.push(nt.applyToX(ht.v[0][0],ht.v[0][1],0),nt.applyToY(ht.v[0][0],ht.v[0][1],0)),lt.push(nt.applyToX(ht.o[st-1][0],ht.o[st-1][1],0),nt.applyToY(ht.o[st-1][0],ht.o[st-1][1],0),nt.applyToX(ht.i[st][0],ht.i[st][1],0),nt.applyToY(ht.i[st][0],ht.i[st][1],0),nt.applyToX(ht.v[st][0],ht.v[st][1],0),nt.applyToY(ht.v[st][0],ht.v[st][1],0));lt.push(nt.applyToX(ht.o[st-1][0],ht.o[st-1][1],0),nt.applyToY(ht.o[st-1][0],ht.o[st-1][1],0),nt.applyToX(ht.i[0][0],ht.i[0][1],0),nt.applyToY(ht.i[0][0],ht.i[0][1],0),nt.applyToX(ht.v[0][0],ht.v[0][1],0),nt.applyToY(ht.v[0][0],ht.v[0][1],0)),mt[Mt]=lt,Mt+=1}ut&&(gt+=tt[$].l,gt+=dt),this.textSpans[Tt]?this.textSpans[Tt].elem=mt:this.textSpans[Tt]={elem:mt},Tt+=1}},CVTextElement.prototype.renderInnerContent=function(){var a=this.canvasContext;a.font=this.values.fValue,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var s,o,j,$,_e,tt,nt=this.textAnimator.renderedLetters,rt=this.textProperty.currentData.l;o=rt.length;var it,st=null,at=null,ot=null,ct,ft;for(s=0;s<o;s+=1)if(!rt[s].n){if(it=nt[s],it&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(it.p),this.globalData.renderer.ctxOpacity(it.o)),this.fill){for(it&&it.fc?st!==it.fc&&(st=it.fc,a.fillStyle=it.fc):st!==this.values.fill&&(st=this.values.fill,a.fillStyle=this.values.fill),ct=this.textSpans[s].elem,$=ct.length,this.globalData.canvasContext.beginPath(),j=0;j<$;j+=1)for(ft=ct[j],tt=ft.length,this.globalData.canvasContext.moveTo(ft[0],ft[1]),_e=2;_e<tt;_e+=6)this.globalData.canvasContext.bezierCurveTo(ft[_e],ft[_e+1],ft[_e+2],ft[_e+3],ft[_e+4],ft[_e+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(it&&it.sw?ot!==it.sw&&(ot=it.sw,a.lineWidth=it.sw):ot!==this.values.sWidth&&(ot=this.values.sWidth,a.lineWidth=this.values.sWidth),it&&it.sc?at!==it.sc&&(at=it.sc,a.strokeStyle=it.sc):at!==this.values.stroke&&(at=this.values.stroke,a.strokeStyle=this.values.stroke),ct=this.textSpans[s].elem,$=ct.length,this.globalData.canvasContext.beginPath(),j=0;j<$;j+=1)for(ft=ct[j],tt=ft.length,this.globalData.canvasContext.moveTo(ft[0],ft[1]),_e=2;_e<tt;_e+=6)this.globalData.canvasContext.bezierCurveTo(ft[_e],ft[_e+1],ft[_e+2],ft[_e+3],ft[_e+4],ft[_e+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}it&&this.globalData.renderer.restore()}};function CVImageElement(a,s,o){this.assetData=s.getAssetData(a.refId),this.img=s.imageLoader.getAsset(this.assetData),this.initElement(a,s,o)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var a=createTag("canvas");a.width=this.assetData.w,a.height=this.assetData.h;var s=a.getContext("2d"),o=this.img.width,j=this.img.height,$=o/j,_e=this.assetData.w/this.assetData.h,tt,nt,rt=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;$>_e&&rt==="xMidYMid slice"||$<_e&&rt!=="xMidYMid slice"?(nt=j,tt=nt*_e):(tt=o,nt=tt/_e),s.drawImage(this.img,(o-tt)/2,(j-nt)/2,tt,nt,0,0,this.assetData.w,this.assetData.h),this.img=a}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(a,s,o){this.initElement(a,s,o)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var a=this.canvasContext;a.fillStyle=this.data.sc,a.fillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(a,s){this.animationItem=a,this.renderConfig={clearCanvas:s&&s.clearCanvas!==void 0?s.clearCanvas:!0,context:s&&s.context||null,progressiveLoad:s&&s.progressiveLoad||!1,preserveAspectRatio:s&&s.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:s&&s.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:s&&s.contentVisibility||"visible",className:s&&s.className||"",id:s&&s.id||""},this.renderConfig.dpr=s&&s.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=s&&s.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(a){return new CVShapeElement(a,this.globalData,this)},CanvasRendererBase.prototype.createText=function(a){return new CVTextElement(a,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(a){return new CVImageElement(a,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(a){return new CVSolidElement(a,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(a){if(!(a[0]===1&&a[1]===0&&a[4]===0&&a[5]===1&&a[12]===0&&a[13]===0)){if(!this.renderConfig.clearCanvas){this.canvasContext.transform(a[0],a[1],a[4],a[5],a[12],a[13]);return}this.transformMat.cloneFromProps(a);var s=this.contextData.cTr.props;this.transformMat.transform(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var o=this.contextData.cTr.props;this.canvasContext.setTransform(o[0],o[1],o[4],o[5],o[12],o[13])}},CanvasRendererBase.prototype.ctxOpacity=function(a){if(!this.renderConfig.clearCanvas){this.canvasContext.globalAlpha*=a<0?0:a,this.globalData.currentGlobalAlpha=this.contextData.cO;return}this.contextData.cO*=a<0?0:a,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(a){if(!this.renderConfig.clearCanvas){this.canvasContext.save();return}a&&this.canvasContext.save();var s=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var o,j=this.contextData.saved[this.contextData.cArrPos];for(o=0;o<16;o+=1)j[o]=s[o];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1},CanvasRendererBase.prototype.restore=function(a){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}a&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var s=this.contextData.saved[this.contextData.cArrPos],o,j=this.contextData.cTr.props;for(o=0;o<16;o+=1)j[o]=s[o];this.canvasContext.setTransform(s[0],s[1],s[4],s[5],s[12],s[13]),s=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=s,this.globalData.currentGlobalAlpha!==s&&(this.canvasContext.globalAlpha=s,this.globalData.currentGlobalAlpha=s)},CanvasRendererBase.prototype.configAnimation=function(a){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var s=this.animationItem.container.style;s.width="100%",s.height="100%";var o="0px 0px 0px";s.transformOrigin=o,s.mozTransformOrigin=o,s.webkitTransformOrigin=o,s["-webkit-transform"]=o,s.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=a,this.layers=a.layers,this.transformCanvas={w:a.w,h:a.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(a,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(a.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(){this.reset();var a,s;this.animationItem.wrapper&&this.animationItem.container?(a=this.animationItem.wrapper.offsetWidth,s=this.animationItem.wrapper.offsetHeight,this.animationItem.container.setAttribute("width",a*this.renderConfig.dpr),this.animationItem.container.setAttribute("height",s*this.renderConfig.dpr)):(a=this.canvasContext.canvas.width*this.renderConfig.dpr,s=this.canvasContext.canvas.height*this.renderConfig.dpr);var o,j;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var $=this.renderConfig.preserveAspectRatio.split(" "),_e=$[1]||"meet",tt=$[0]||"xMidYMid",nt=tt.substr(0,4),rt=tt.substr(4);o=a/s,j=this.transformCanvas.w/this.transformCanvas.h,j>o&&_e==="meet"||j<o&&_e==="slice"?(this.transformCanvas.sx=a/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=a/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=s/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=s/(this.transformCanvas.h/this.renderConfig.dpr)),nt==="xMid"&&(j<o&&_e==="meet"||j>o&&_e==="slice")?this.transformCanvas.tx=(a-this.transformCanvas.w*(s/this.transformCanvas.h))/2*this.renderConfig.dpr:nt==="xMax"&&(j<o&&_e==="meet"||j>o&&_e==="slice")?this.transformCanvas.tx=(a-this.transformCanvas.w*(s/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,rt==="YMid"&&(j>o&&_e==="meet"||j<o&&_e==="slice")?this.transformCanvas.ty=(s-this.transformCanvas.h*(a/this.transformCanvas.w))/2*this.renderConfig.dpr:rt==="YMax"&&(j>o&&_e==="meet"||j<o&&_e==="slice")?this.transformCanvas.ty=(s-this.transformCanvas.h*(a/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=a/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=s/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var a,s=this.layers?this.layers.length:0;for(a=s-1;a>=0;a-=1)this.elements[a]&&this.elements[a].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(a,s){if(!(this.renderedFrame===a&&this.renderConfig.clearCanvas===!0&&!s||this.destroyed||a===-1)){this.renderedFrame=a,this.globalData.frameNum=a-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||s,this.globalData.projectInterface.currentFrame=a;var o,j=this.layers.length;for(this.completeLayers||this.checkLayers(a),o=0;o<j;o+=1)(this.completeLayers||this.elements[o])&&this.elements[o].prepareFrame(a-this.layers[o].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),o=j-1;o>=0;o-=1)(this.completeLayers||this.elements[o])&&this.elements[o].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(a){var s=this.elements;if(!(s[a]||this.layers[a].ty===99)){var o=this.createItem(this.layers[a],this,this.globalData);s[a]=o,o.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var a=this.pendingElements.pop();a.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CVCompElement(a,s,o){this.completeLayers=!1,this.layers=a.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(a,s,o),this.tm=a.tm?PropertyFactory.getProp(this,a.tm,0,s.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var a=this.canvasContext;a.beginPath(),a.moveTo(0,0),a.lineTo(this.data.w,0),a.lineTo(this.data.w,this.data.h),a.lineTo(0,this.data.h),a.lineTo(0,0),a.clip();var s,o=this.layers.length;for(s=o-1;s>=0;s-=1)(this.completeLayers||this.elements[s])&&this.elements[s].renderFrame()},CVCompElement.prototype.destroy=function(){var a,s=this.layers.length;for(a=s-1;a>=0;a-=1)this.elements[a]&&this.elements[a].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(a){return new CVCompElement(a,this.globalData,this)};function CanvasRenderer(a,s){this.animationItem=a,this.renderConfig={clearCanvas:s&&s.clearCanvas!==void 0?s.clearCanvas:!0,context:s&&s.context||null,progressiveLoad:s&&s.progressiveLoad||!1,preserveAspectRatio:s&&s.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:s&&s.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:s&&s.contentVisibility||"visible",className:s&&s.className||"",id:s&&s.id||""},this.renderConfig.dpr=s&&s.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=s&&s.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(a){return new CVCompElement(a,this.globalData,this)},registerRenderer("canvas",CanvasRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier);const Expressions=function(){var a={};a.initExpressions=s;function s(o){var j=0,$=[];function _e(){j+=1}function tt(){j-=1,j===0&&rt()}function nt(it){$.indexOf(it)===-1&&$.push(it)}function rt(){var it,st=$.length;for(it=0;it<st;it+=1)$[it].release();$.length=0}o.renderer.compInterface=CompExpressionInterface(o.renderer),o.renderer.globalData.projectInterface.registerComposition(o.renderer),o.renderer.globalData.pushExpression=_e,o.renderer.globalData.popExpression=tt,o.renderer.globalData.registerExpressionProperty=nt}return a}();function seedRandom(a,s){var o=this,j=256,$=6,_e=52,tt="random",nt=s.pow(j,$),rt=s.pow(2,_e),it=rt*2,st=j-1,at;function ot(dt,gt,Et){var St=[];gt=gt===!0?{entropy:!0}:gt||{};var Tt=mt(ht(gt.entropy?[dt,ut(a)]:dt===null?lt():dt,3),St),Mt=new ct(St),Bt=function(){for(var Rt=Mt.g($),Ut=nt,Ht=0;Rt<rt;)Rt=(Rt+Ht)*j,Ut*=j,Ht=Mt.g(1);for(;Rt>=it;)Rt/=2,Ut/=2,Ht>>>=1;return(Rt+Ht)/Ut};return Bt.int32=function(){return Mt.g(4)|0},Bt.quick=function(){return Mt.g(4)/4294967296},Bt.double=Bt,mt(ut(Mt.S),a),(gt.pass||Et||function(Rt,Ut,Ht,Wt){return Wt&&(Wt.S&&ft(Wt,Mt),Rt.state=function(){return ft(Mt,{})}),Ht?(s[tt]=Rt,Ut):Rt})(Bt,Tt,"global"in gt?gt.global:this==s,gt.state)}s["seed"+tt]=ot;function ct(dt){var gt,Et=dt.length,St=this,Tt=0,Mt=St.i=St.j=0,Bt=St.S=[];for(Et||(dt=[Et++]);Tt<j;)Bt[Tt]=Tt++;for(Tt=0;Tt<j;Tt++)Bt[Tt]=Bt[Mt=st&Mt+dt[Tt%Et]+(gt=Bt[Tt])],Bt[Mt]=gt;St.g=function(Rt){for(var Ut,Ht=0,Wt=St.i,Jt=St.j,sn=St.S;Rt--;)Ut=sn[Wt=st&Wt+1],Ht=Ht*j+sn[st&(sn[Wt]=sn[Jt=st&Jt+Ut])+(sn[Jt]=Ut)];return St.i=Wt,St.j=Jt,Ht}}function ft(dt,gt){return gt.i=dt.i,gt.j=dt.j,gt.S=dt.S.slice(),gt}function ht(dt,gt){var Et=[],St=typeof dt,Tt;if(gt&&St=="object")for(Tt in dt)try{Et.push(ht(dt[Tt],gt-1))}catch{}return Et.length?Et:St=="string"?dt:dt+"\0"}function mt(dt,gt){for(var Et=dt+"",St,Tt=0;Tt<Et.length;)gt[st&Tt]=st&(St^=gt[st&Tt]*19)+Et.charCodeAt(Tt++);return ut(gt)}function lt(){try{var dt=new Uint8Array(j);return(o.crypto||o.msCrypto).getRandomValues(dt),ut(dt)}catch{var gt=o.navigator,Et=gt&&gt.plugins;return[+new Date,o,Et,o.screen,ut(a)]}}function ut(dt){return String.fromCharCode.apply(0,dt)}mt(s.random(),a)}function initialize$2(a){seedRandom([],a)}var propTypes={SHAPE:"shape"};const ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;initialize$2(BMMath);function $bm_isInstanceOfArray(a){return a.constructor===Array||a.constructor===Float32Array}function isNumerable(a,s){return a==="number"||a==="boolean"||a==="string"||s instanceof Number}function $bm_neg(a){var s=typeof a;if(s==="number"||s==="boolean"||a instanceof Number)return-a;if($bm_isInstanceOfArray(a)){var o,j=a.length,$=[];for(o=0;o<j;o+=1)$[o]=-a[o];return $}return a.propType?a.v:-a}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(a,s){var o=typeof a,j=typeof s;if(o==="string"||j==="string"||isNumerable(o,a)&&isNumerable(j,s))return a+s;if($bm_isInstanceOfArray(a)&&isNumerable(j,s))return a=a.slice(0),a[0]+=s,a;if(isNumerable(o,a)&&$bm_isInstanceOfArray(s))return s=s.slice(0),s[0]=a+s[0],s;if($bm_isInstanceOfArray(a)&&$bm_isInstanceOfArray(s)){for(var $=0,_e=a.length,tt=s.length,nt=[];$<_e||$<tt;)(typeof a[$]=="number"||a[$]instanceof Number)&&(typeof s[$]=="number"||s[$]instanceof Number)?nt[$]=a[$]+s[$]:nt[$]=s[$]===void 0?a[$]:a[$]||s[$],$+=1;return nt}return 0}var add=sum;function sub(a,s){var o=typeof a,j=typeof s;if(isNumerable(o,a)&&isNumerable(j,s))return o==="string"&&(a=parseInt(a,10)),j==="string"&&(s=parseInt(s,10)),a-s;if($bm_isInstanceOfArray(a)&&isNumerable(j,s))return a=a.slice(0),a[0]-=s,a;if(isNumerable(o,a)&&$bm_isInstanceOfArray(s))return s=s.slice(0),s[0]=a-s[0],s;if($bm_isInstanceOfArray(a)&&$bm_isInstanceOfArray(s)){for(var $=0,_e=a.length,tt=s.length,nt=[];$<_e||$<tt;)(typeof a[$]=="number"||a[$]instanceof Number)&&(typeof s[$]=="number"||s[$]instanceof Number)?nt[$]=a[$]-s[$]:nt[$]=s[$]===void 0?a[$]:a[$]||s[$],$+=1;return nt}return 0}function mul(a,s){var o=typeof a,j=typeof s,$;if(isNumerable(o,a)&&isNumerable(j,s))return a*s;var _e,tt;if($bm_isInstanceOfArray(a)&&isNumerable(j,s)){for(tt=a.length,$=createTypedArray("float32",tt),_e=0;_e<tt;_e+=1)$[_e]=a[_e]*s;return $}if(isNumerable(o,a)&&$bm_isInstanceOfArray(s)){for(tt=s.length,$=createTypedArray("float32",tt),_e=0;_e<tt;_e+=1)$[_e]=a*s[_e];return $}return 0}function div(a,s){var o=typeof a,j=typeof s,$;if(isNumerable(o,a)&&isNumerable(j,s))return a/s;var _e,tt;if($bm_isInstanceOfArray(a)&&isNumerable(j,s)){for(tt=a.length,$=createTypedArray("float32",tt),_e=0;_e<tt;_e+=1)$[_e]=a[_e]/s;return $}if(isNumerable(o,a)&&$bm_isInstanceOfArray(s)){for(tt=s.length,$=createTypedArray("float32",tt),_e=0;_e<tt;_e+=1)$[_e]=a/s[_e];return $}return 0}function mod(a,s){return typeof a=="string"&&(a=parseInt(a,10)),typeof s=="string"&&(s=parseInt(s,10)),a%s}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(a,s,o){if(s>o){var j=o;o=s,s=j}return Math.min(Math.max(a,s),o)}function radiansToDegrees(a){return a/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(a){return a*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(a,s){if(typeof a=="number"||a instanceof Number)return s=s||0,Math.abs(a-s);s||(s=helperLengthArray);var o,j=Math.min(a.length,s.length),$=0;for(o=0;o<j;o+=1)$+=Math.pow(s[o]-a[o],2);return Math.sqrt($)}function normalize(a){return div(a,length(a))}function rgbToHsl(a){var s=a[0],o=a[1],j=a[2],$=Math.max(s,o,j),_e=Math.min(s,o,j),tt,nt,rt=($+_e)/2;if($===_e)tt=0,nt=0;else{var it=$-_e;switch(nt=rt>.5?it/(2-$-_e):it/($+_e),$){case s:tt=(o-j)/it+(o<j?6:0);break;case o:tt=(j-s)/it+2;break;case j:tt=(s-o)/it+4;break}tt/=6}return[tt,nt,rt,a[3]]}function hue2rgb(a,s,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?a+(s-a)*6*o:o<1/2?s:o<2/3?a+(s-a)*(2/3-o)*6:a}function hslToRgb(a){var s=a[0],o=a[1],j=a[2],$,_e,tt;if(o===0)$=j,tt=j,_e=j;else{var nt=j<.5?j*(1+o):j+o-j*o,rt=2*j-nt;$=hue2rgb(rt,nt,s+1/3),_e=hue2rgb(rt,nt,s),tt=hue2rgb(rt,nt,s-1/3)}return[$,_e,tt,a[3]]}function linear(a,s,o,j,$){if((j===void 0||$===void 0)&&(j=s,$=o,s=0,o=1),o<s){var _e=o;o=s,s=_e}if(a<=s)return j;if(a>=o)return $;var tt=o===s?0:(a-s)/(o-s);if(!j.length)return j+($-j)*tt;var nt,rt=j.length,it=createTypedArray("float32",rt);for(nt=0;nt<rt;nt+=1)it[nt]=j[nt]+($[nt]-j[nt])*tt;return it}function random(a,s){if(s===void 0&&(a===void 0?(a=0,s=1):(s=a,a=void 0)),s.length){var o,j=s.length;a||(a=createTypedArray("float32",j));var $=createTypedArray("float32",j),_e=BMMath.random();for(o=0;o<j;o+=1)$[o]=a[o]+_e*(s[o]-a[o]);return $}a===void 0&&(a=0);var tt=BMMath.random();return a+tt*(s-a)}function createPath(a,s,o,j){var $,_e=a.length,tt=shapePool.newElement();tt.setPathData(!!j,_e);var nt=[0,0],rt,it;for($=0;$<_e;$+=1)rt=s&&s[$]?s[$]:nt,it=o&&o[$]?o[$]:nt,tt.setTripleAt(a[$][0],a[$][1],it[0]+a[$][0],it[1]+a[$][1],rt[0]+a[$][0],rt[1]+a[$][1],$,!0);return tt}function initiateExpression(elem,data,property){var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=function a(s,o){var j,$,_e=this.pv.length?this.pv.length:1,tt=createTypedArray("float32",_e);s=5;var nt=Math.floor(time*s);for(j=0,$=0;j<nt;){for($=0;$<_e;$+=1)tt[$]+=-o+o*2*BMMath.random();j+=1}var rt=time*s,it=rt-Math.floor(rt),st=createTypedArray("float32",_e);if(_e>1){for($=0;$<_e;$+=1)st[$]=this.pv[$]+tt[$]+(-o+o*2*BMMath.random())*it;return st}return this.pv+tt[0]+(-o+o*2*BMMath.random())*it}.bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(a,s){return loopIn(a,s,!0)}function loopOutDuration(a,s){return loopOut(a,s,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(a,s){var o=[s[0]-a[0],s[1]-a[1],s[2]-a[2]],j=Math.atan2(o[0],Math.sqrt(o[1]*o[1]+o[2]*o[2]))/degToRads,$=-Math.atan2(o[1],o[2])/degToRads;return[$,j,0]}function easeOut(a,s,o,j,$){return applyEase(easeOutBez,a,s,o,j,$)}function easeIn(a,s,o,j,$){return applyEase(easeInBez,a,s,o,j,$)}function ease(a,s,o,j,$){return applyEase(easeInOutBez,a,s,o,j,$)}function applyEase(a,s,o,j,$,_e){$===void 0?($=o,_e=j):s=(s-o)/(j-o),s>1?s=1:s<0&&(s=0);var tt=a(s);if($bm_isInstanceOfArray($)){var nt,rt=$.length,it=createTypedArray("float32",rt);for(nt=0;nt<rt;nt+=1)it[nt]=(_e[nt]-$[nt])*tt+$[nt];return it}return(_e-$)*tt+$}function nearestKey(a){var s,o=data.k.length,j,$;if(!data.k.length||typeof data.k[0]=="number")j=0,$=0;else if(j=-1,a*=elem.comp.globalData.frameRate,a<data.k[0].t)j=1,$=data.k[0].t;else{for(s=0;s<o-1;s+=1)if(a===data.k[s].t){j=s+1,$=data.k[s].t;break}else if(a>data.k[s].t&&a<data.k[s+1].t){a-data.k[s].t>data.k[s+1].t-a?(j=s+2,$=data.k[s+1].t):(j=s+1,$=data.k[s].t);break}j===-1&&(j=s+1,$=data.k[s].t)}var _e={};return _e.index=j,_e.time=$/elem.comp.globalData.frameRate,_e}function key(a){var s,o,j;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+a);a-=1,s={time:data.k[a].t/elem.comp.globalData.frameRate,value:[]};var $=Object.prototype.hasOwnProperty.call(data.k[a],"s")?data.k[a].s:data.k[a-1].e;for(j=$.length,o=0;o<j;o+=1)s[o]=$[o],s.value[o]=$[o];return s}function framesToTime(a,s){return s||(s=elem.comp.globalData.frameRate),a/s}function timeToFrames(a,s){return!a&&a!==0&&(a=time),s||(s=elem.comp.globalData.frameRate),a*s}function seedRandom(a){BMMath.seedrandom(randSeed+a)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(a,s){return typeof value=="string"?s===void 0?value.substring(a):value.substring(a,s):""}function substr(a,s){return typeof value=="string"?s===void 0?value.substr(a):value.substr(a,s):""}function posterizeTime(a){time=a===0?0:Math.floor(time*a)/a,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(a){return value=a,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath],ob}(),expressionHelpers=function(){function a(tt,nt,rt){nt.x&&(rt.k=!0,rt.x=!0,rt.initiateExpression=ExpressionManager.initiateExpression,rt.effectsSequence.push(rt.initiateExpression(tt,nt,rt).bind(rt)))}function s(tt){return tt*=this.elem.globalData.frameRate,tt-=this.offsetTime,tt!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<tt?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(tt,this._cachingAtTime),this._cachingAtTime.lastFrame=tt),this._cachingAtTime.value}function o(tt){var nt=-.01,rt=this.getValueAtTime(tt),it=this.getValueAtTime(tt+nt),st=0;if(rt.length){var at;for(at=0;at<rt.length;at+=1)st+=Math.pow(it[at]-rt[at],2);st=Math.sqrt(st)*100}else st=0;return st}function j(tt){if(this.vel!==void 0)return this.vel;var nt=-.001,rt=this.getValueAtTime(tt),it=this.getValueAtTime(tt+nt),st;if(rt.length){st=createTypedArray("float32",rt.length);var at;for(at=0;at<rt.length;at+=1)st[at]=(it[at]-rt[at])/nt}else st=(it-rt)/nt;return st}function $(){return this.pv}function _e(tt){this.propertyGroup=tt}return{searchExpressions:a,getSpeedAtTime:o,getVelocityAtTime:j,getValueAtTime:s,getStaticValueAtTime:$,setGroupProperty:_e}}();function addPropertyDecorator(){function a(ot,ct,ft){if(!this.k||!this.keyframes)return this.pv;ot=ot?ot.toLowerCase():"";var ht=this.comp.renderedFrame,mt=this.keyframes,lt=mt[mt.length-1].t;if(ht<=lt)return this.pv;var ut,dt;ft?(ct?ut=Math.abs(lt-this.elem.comp.globalData.frameRate*ct):ut=Math.max(0,lt-this.elem.data.ip),dt=lt-ut):((!ct||ct>mt.length-1)&&(ct=mt.length-1),dt=mt[mt.length-1-ct].t,ut=lt-dt);var gt,Et,St;if(ot==="pingpong"){var Tt=Math.floor((ht-dt)/ut);if(Tt%2!==0)return this.getValueAtTime((ut-(ht-dt)%ut+dt)/this.comp.globalData.frameRate,0)}else if(ot==="offset"){var Mt=this.getValueAtTime(dt/this.comp.globalData.frameRate,0),Bt=this.getValueAtTime(lt/this.comp.globalData.frameRate,0),Rt=this.getValueAtTime(((ht-dt)%ut+dt)/this.comp.globalData.frameRate,0),Ut=Math.floor((ht-dt)/ut);if(this.pv.length){for(St=new Array(Mt.length),Et=St.length,gt=0;gt<Et;gt+=1)St[gt]=(Bt[gt]-Mt[gt])*Ut+Rt[gt];return St}return(Bt-Mt)*Ut+Rt}else if(ot==="continue"){var Ht=this.getValueAtTime(lt/this.comp.globalData.frameRate,0),Wt=this.getValueAtTime((lt-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(St=new Array(Ht.length),Et=St.length,gt=0;gt<Et;gt+=1)St[gt]=Ht[gt]+(Ht[gt]-Wt[gt])*((ht-lt)/this.comp.globalData.frameRate)/5e-4;return St}return Ht+(Ht-Wt)*((ht-lt)/.001)}return this.getValueAtTime(((ht-dt)%ut+dt)/this.comp.globalData.frameRate,0)}function s(ot,ct,ft){if(!this.k)return this.pv;ot=ot?ot.toLowerCase():"";var ht=this.comp.renderedFrame,mt=this.keyframes,lt=mt[0].t;if(ht>=lt)return this.pv;var ut,dt;ft?(ct?ut=Math.abs(this.elem.comp.globalData.frameRate*ct):ut=Math.max(0,this.elem.data.op-lt),dt=lt+ut):((!ct||ct>mt.length-1)&&(ct=mt.length-1),dt=mt[ct].t,ut=dt-lt);var gt,Et,St;if(ot==="pingpong"){var Tt=Math.floor((lt-ht)/ut);if(Tt%2===0)return this.getValueAtTime(((lt-ht)%ut+lt)/this.comp.globalData.frameRate,0)}else if(ot==="offset"){var Mt=this.getValueAtTime(lt/this.comp.globalData.frameRate,0),Bt=this.getValueAtTime(dt/this.comp.globalData.frameRate,0),Rt=this.getValueAtTime((ut-(lt-ht)%ut+lt)/this.comp.globalData.frameRate,0),Ut=Math.floor((lt-ht)/ut)+1;if(this.pv.length){for(St=new Array(Mt.length),Et=St.length,gt=0;gt<Et;gt+=1)St[gt]=Rt[gt]-(Bt[gt]-Mt[gt])*Ut;return St}return Rt-(Bt-Mt)*Ut}else if(ot==="continue"){var Ht=this.getValueAtTime(lt/this.comp.globalData.frameRate,0),Wt=this.getValueAtTime((lt+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(St=new Array(Ht.length),Et=St.length,gt=0;gt<Et;gt+=1)St[gt]=Ht[gt]+(Ht[gt]-Wt[gt])*(lt-ht)/.001;return St}return Ht+(Ht-Wt)*(lt-ht)/.001}return this.getValueAtTime((ut-((lt-ht)%ut+lt))/this.comp.globalData.frameRate,0)}function o(ot,ct){if(!this.k)return this.pv;if(ot=(ot||.4)*.5,ct=Math.floor(ct||5),ct<=1)return this.pv;var ft=this.comp.renderedFrame/this.comp.globalData.frameRate,ht=ft-ot,mt=ft+ot,lt=ct>1?(mt-ht)/(ct-1):1,ut=0,dt=0,gt;this.pv.length?gt=createTypedArray("float32",this.pv.length):gt=0;for(var Et;ut<ct;){if(Et=this.getValueAtTime(ht+ut*lt),this.pv.length)for(dt=0;dt<this.pv.length;dt+=1)gt[dt]+=Et[dt];else gt+=Et;ut+=1}if(this.pv.length)for(dt=0;dt<this.pv.length;dt+=1)gt[dt]/=ct;else gt/=ct;return gt}function j(ot){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var ct=this._transformCachingAtTime.v;if(ct.cloneFromProps(this.pre.props),this.appliedTransformations<1){var ft=this.a.getValueAtTime(ot);ct.translate(-ft[0]*this.a.mult,-ft[1]*this.a.mult,ft[2]*this.a.mult)}if(this.appliedTransformations<2){var ht=this.s.getValueAtTime(ot);ct.scale(ht[0]*this.s.mult,ht[1]*this.s.mult,ht[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var mt=this.sk.getValueAtTime(ot),lt=this.sa.getValueAtTime(ot);ct.skewFromAxis(-mt*this.sk.mult,lt*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var ut=this.r.getValueAtTime(ot);ct.rotate(-ut*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var dt=this.rz.getValueAtTime(ot),gt=this.ry.getValueAtTime(ot),Et=this.rx.getValueAtTime(ot),St=this.or.getValueAtTime(ot);ct.rotateZ(-dt*this.rz.mult).rotateY(gt*this.ry.mult).rotateX(Et*this.rx.mult).rotateZ(-St[2]*this.or.mult).rotateY(St[1]*this.or.mult).rotateX(St[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var Tt=this.px.getValueAtTime(ot),Mt=this.py.getValueAtTime(ot);if(this.data.p.z){var Bt=this.pz.getValueAtTime(ot);ct.translate(Tt*this.px.mult,Mt*this.py.mult,-Bt*this.pz.mult)}else ct.translate(Tt*this.px.mult,Mt*this.py.mult,0)}else{var Rt=this.p.getValueAtTime(ot);ct.translate(Rt[0]*this.p.mult,Rt[1]*this.p.mult,-Rt[2]*this.p.mult)}return ct}function $(){return this.v.clone(new Matrix)}var _e=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(ot,ct,ft){var ht=_e(ot,ct,ft);return ht.dynamicProperties.length?ht.getValueAtTime=j.bind(ht):ht.getValueAtTime=$.bind(ht),ht.setGroupProperty=expressionHelpers.setGroupProperty,ht};var tt=PropertyFactory.getProp;PropertyFactory.getProp=function(ot,ct,ft,ht,mt){var lt=tt(ot,ct,ft,ht,mt);lt.kf?lt.getValueAtTime=expressionHelpers.getValueAtTime.bind(lt):lt.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(lt),lt.setGroupProperty=expressionHelpers.setGroupProperty,lt.loopOut=a,lt.loopIn=s,lt.smooth=o,lt.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(lt),lt.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(lt),lt.numKeys=ct.a===1?ct.k.length:0,lt.propertyIndex=ct.ix;var ut=0;return ft!==0&&(ut=createTypedArray("float32",ct.a===1?ct.k[0].s.length:ct.k.length)),lt._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:ut},expressionHelpers.searchExpressions(ot,ct,lt),lt.k&&mt.addDynamicProperty(lt),lt};function nt(ot){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),ot*=this.elem.globalData.frameRate,ot-=this.offsetTime,ot!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<ot?this._caching.lastIndex:0,this._cachingAtTime.lastTime=ot,this.interpolateShape(ot,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var rt=ShapePropertyFactory.getConstructorFunction(),it=ShapePropertyFactory.getKeyframedConstructorFunction();function st(){}st.prototype={vertices:function(ot,ct){this.k&&this.getValue();var ft=this.v;ct!==void 0&&(ft=this.getValueAtTime(ct,0));var ht,mt=ft._length,lt=ft[ot],ut=ft.v,dt=createSizedArray(mt);for(ht=0;ht<mt;ht+=1)ot==="i"||ot==="o"?dt[ht]=[lt[ht][0]-ut[ht][0],lt[ht][1]-ut[ht][1]]:dt[ht]=[lt[ht][0],lt[ht][1]];return dt},points:function(ot){return this.vertices("v",ot)},inTangents:function(ot){return this.vertices("i",ot)},outTangents:function(ot){return this.vertices("o",ot)},isClosed:function(){return this.v.c},pointOnPath:function(ot,ct){var ft=this.v;ct!==void 0&&(ft=this.getValueAtTime(ct,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(ft));for(var ht=this._segmentsLength,mt=ht.lengths,lt=ht.totalLength*ot,ut=0,dt=mt.length,gt=0,Et;ut<dt;){if(gt+mt[ut].addedLength>lt){var St=ut,Tt=ft.c&&ut===dt-1?0:ut+1,Mt=(lt-gt)/mt[ut].addedLength;Et=bez.getPointInSegment(ft.v[St],ft.v[Tt],ft.o[St],ft.i[Tt],Mt,mt[ut]);break}else gt+=mt[ut].addedLength;ut+=1}return Et||(Et=ft.c?[ft.v[0][0],ft.v[0][1]]:[ft.v[ft._length-1][0],ft.v[ft._length-1][1]]),Et},vectorOnPath:function(ot,ct,ft){ot==1?ot=this.v.c:ot==0&&(ot=.999);var ht=this.pointOnPath(ot,ct),mt=this.pointOnPath(ot+.001,ct),lt=mt[0]-ht[0],ut=mt[1]-ht[1],dt=Math.sqrt(Math.pow(lt,2)+Math.pow(ut,2));if(dt===0)return[0,0];var gt=ft==="tangent"?[lt/dt,ut/dt]:[-ut/dt,lt/dt];return gt},tangentOnPath:function(ot,ct){return this.vectorOnPath(ot,ct,"tangent")},normalOnPath:function(ot,ct){return this.vectorOnPath(ot,ct,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([st],rt),extendPrototype([st],it),it.prototype.getValueAtTime=nt,it.prototype.initiateExpression=ExpressionManager.initiateExpression;var at=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(ot,ct,ft,ht,mt){var lt=at(ot,ct,ft,ht,mt);return lt.propertyIndex=ct.ix,lt.lock=!1,ft===3?expressionHelpers.searchExpressions(ot,ct.pt,lt):ft===4&&expressionHelpers.searchExpressions(ot,ct.ks,lt),lt.k&&ot.addDynamicProperty(lt),lt}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function a(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(s,o){var j=this.calculateExpression(o);if(s.t!==j){var $={};return this.copyData($,s),$.t=j.toString(),$.__complete=!1,$}return s},TextProperty.prototype.searchProperty=function(){var s=this.searchKeyframes(),o=this.searchExpressions();return this.kf=s||o,this.kf},TextProperty.prototype.searchExpressions=a}function initialize(){addDecorator()}return setExpressionsPlugin(Expressions),initialize$1(),initialize(),lottie})();class LottieLoader extends Loader{setQuality(s){this._quality=s}load(s,o,j,$){const _e=this._quality||1,tt=new CanvasTexture;tt.minFilter=NearestFilter;const nt=new FileLoader(this.manager);return nt.setPath(this.path),nt.setWithCredentials(this.withCredentials),nt.load(s,function(rt){const it=JSON.parse(rt),st=document.createElement("div");st.style.width=it.w+"px",st.style.height=it.h+"px",document.body.appendChild(st);const at=lottie.loadAnimation({container:st,animType:"canvas",loop:!0,autoplay:!0,animationData:it,rendererSettings:{dpr:_e}});tt.animation=at,tt.image=at.container,at.addEventListener("enterFrame",function(){tt.needsUpdate=!0}),st.style.display="none",o!==void 0&&o(tt)},j,$),tt}}const{parseBuffer}=(()=>{var a=0,s=-3;function o(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function j(pt,xt){this.source=pt,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=xt,this.destLen=0,this.ltree=new o,this.dtree=new o}var $=new o,_e=new o,tt=new Uint8Array(30),nt=new Uint16Array(30),rt=new Uint8Array(30),it=new Uint16Array(30),st=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),at=new o,ot=new Uint8Array(288+32);function ct(pt,xt,Ct,It){var Pt,kt;for(Pt=0;Pt<Ct;++Pt)pt[Pt]=0;for(Pt=0;Pt<30-Ct;++Pt)pt[Pt+Ct]=Pt/Ct|0;for(kt=It,Pt=0;Pt<30;++Pt)xt[Pt]=kt,kt+=1<<pt[Pt]}function ft(pt,xt){var Ct;for(Ct=0;Ct<7;++Ct)pt.table[Ct]=0;for(pt.table[7]=24,pt.table[8]=152,pt.table[9]=112,Ct=0;Ct<24;++Ct)pt.trans[Ct]=256+Ct;for(Ct=0;Ct<144;++Ct)pt.trans[24+Ct]=Ct;for(Ct=0;Ct<8;++Ct)pt.trans[24+144+Ct]=280+Ct;for(Ct=0;Ct<112;++Ct)pt.trans[24+144+8+Ct]=144+Ct;for(Ct=0;Ct<5;++Ct)xt.table[Ct]=0;for(xt.table[5]=32,Ct=0;Ct<32;++Ct)xt.trans[Ct]=Ct}var ht=new Uint16Array(16);function mt(pt,xt,Ct,It){var Pt,kt;for(Pt=0;Pt<16;++Pt)pt.table[Pt]=0;for(Pt=0;Pt<It;++Pt)pt.table[xt[Ct+Pt]]++;for(pt.table[0]=0,kt=0,Pt=0;Pt<16;++Pt)ht[Pt]=kt,kt+=pt.table[Pt];for(Pt=0;Pt<It;++Pt)xt[Ct+Pt]&&(pt.trans[ht[xt[Ct+Pt]]++]=Pt)}function lt(pt){pt.bitcount--||(pt.tag=pt.source[pt.sourceIndex++],pt.bitcount=7);var xt=pt.tag&1;return pt.tag>>>=1,xt}function ut(pt,xt,Ct){if(!xt)return Ct;for(;pt.bitcount<24;)pt.tag|=pt.source[pt.sourceIndex++]<<pt.bitcount,pt.bitcount+=8;var It=pt.tag&65535>>>16-xt;return pt.tag>>>=xt,pt.bitcount-=xt,It+Ct}function dt(pt,xt){for(;pt.bitcount<24;)pt.tag|=pt.source[pt.sourceIndex++]<<pt.bitcount,pt.bitcount+=8;var Ct=0,It=0,Pt=0,kt=pt.tag;do It=2*It+(kt&1),kt>>>=1,++Pt,Ct+=xt.table[Pt],It-=xt.table[Pt];while(It>=0);return pt.tag=kt,pt.bitcount-=Pt,xt.trans[Ct+It]}function gt(pt,xt,Ct){var It,Pt,kt,Yt,un,an;for(It=ut(pt,5,257),Pt=ut(pt,5,1),kt=ut(pt,4,4),Yt=0;Yt<19;++Yt)ot[Yt]=0;for(Yt=0;Yt<kt;++Yt){var jn=ut(pt,3,0);ot[st[Yt]]=jn}for(mt(at,ot,0,19),un=0;un<It+Pt;){var Wn=dt(pt,at);switch(Wn){case 16:var lr=ot[un-1];for(an=ut(pt,2,3);an;--an)ot[un++]=lr;break;case 17:for(an=ut(pt,3,3);an;--an)ot[un++]=0;break;case 18:for(an=ut(pt,7,11);an;--an)ot[un++]=0;break;default:ot[un++]=Wn;break}}mt(xt,ot,0,It),mt(Ct,ot,It,Pt)}function Et(pt,xt,Ct){for(;;){var It=dt(pt,xt);if(It===256)return a;if(It<256)pt.dest[pt.destLen++]=It;else{var Pt,kt,Yt,un;for(It-=257,Pt=ut(pt,tt[It],nt[It]),kt=dt(pt,Ct),Yt=pt.destLen-ut(pt,rt[kt],it[kt]),un=Yt;un<Yt+Pt;++un)pt.dest[pt.destLen++]=pt.dest[un]}}}function St(pt){for(var xt,Ct,It;pt.bitcount>8;)pt.sourceIndex--,pt.bitcount-=8;if(xt=pt.source[pt.sourceIndex+1],xt=256*xt+pt.source[pt.sourceIndex],Ct=pt.source[pt.sourceIndex+3],Ct=256*Ct+pt.source[pt.sourceIndex+2],xt!==(~Ct&65535))return s;for(pt.sourceIndex+=4,It=xt;It;--It)pt.dest[pt.destLen++]=pt.source[pt.sourceIndex++];return pt.bitcount=0,a}function Tt(pt,xt){var Ct=new j(pt,xt),It,Pt,kt;do{switch(It=lt(Ct),Pt=ut(Ct,2,0),Pt){case 0:kt=St(Ct);break;case 1:kt=Et(Ct,$,_e);break;case 2:gt(Ct,Ct.ltree,Ct.dtree),kt=Et(Ct,Ct.ltree,Ct.dtree);break;default:kt=s}if(kt!==a)throw new Error("Data error")}while(!It);return Ct.destLen<Ct.dest.length?typeof Ct.dest.slice=="function"?Ct.dest.slice(0,Ct.destLen):Ct.dest.subarray(0,Ct.destLen):Ct.dest}ft($,_e),ct(tt,nt,4,3),ct(rt,it,2,1),tt[28]=0,nt[28]=258;var Mt=Tt;function Bt(pt,xt,Ct,It,Pt){return Math.pow(1-Pt,3)*pt+3*Math.pow(1-Pt,2)*Pt*xt+3*(1-Pt)*Math.pow(Pt,2)*Ct+Math.pow(Pt,3)*It}function Rt(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}Rt.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},Rt.prototype.addPoint=function(pt,xt){typeof pt=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=pt,this.x2=pt),pt<this.x1&&(this.x1=pt),pt>this.x2&&(this.x2=pt)),typeof xt=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=xt,this.y2=xt),xt<this.y1&&(this.y1=xt),xt>this.y2&&(this.y2=xt))},Rt.prototype.addX=function(pt){this.addPoint(pt,null)},Rt.prototype.addY=function(pt){this.addPoint(null,pt)},Rt.prototype.addBezier=function(pt,xt,Ct,It,Pt,kt,Yt,un){var an=[pt,xt],jn=[Ct,It],Wn=[Pt,kt],lr=[Yt,un];this.addPoint(pt,xt),this.addPoint(Yt,un);for(var Yn=0;Yn<=1;Yn++){var hr=6*an[Yn]-12*jn[Yn]+6*Wn[Yn],Lr=-3*an[Yn]+9*jn[Yn]-9*Wn[Yn]+3*lr[Yn],jr=3*jn[Yn]-3*an[Yn];if(Lr===0){if(hr===0)continue;var Xr=-jr/hr;0<Xr&&Xr<1&&(Yn===0&&this.addX(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],Xr)),Yn===1&&this.addY(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],Xr)));continue}var Wr=Math.pow(hr,2)-4*jr*Lr;if(!(Wr<0)){var bs=(-hr+Math.sqrt(Wr))/(2*Lr);0<bs&&bs<1&&(Yn===0&&this.addX(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],bs)),Yn===1&&this.addY(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],bs)));var kr=(-hr-Math.sqrt(Wr))/(2*Lr);0<kr&&kr<1&&(Yn===0&&this.addX(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],kr)),Yn===1&&this.addY(Bt(an[Yn],jn[Yn],Wn[Yn],lr[Yn],kr)))}}},Rt.prototype.addQuad=function(pt,xt,Ct,It,Pt,kt){var Yt=pt+.6666666666666666*(Ct-pt),un=xt+2/3*(It-xt),an=Yt+1/3*(Pt-pt),jn=un+1/3*(kt-xt);this.addBezier(pt,xt,Yt,un,an,jn,Pt,kt)};function Ut(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}Ut.prototype.moveTo=function(pt,xt){this.commands.push({type:"M",x:pt,y:xt})},Ut.prototype.lineTo=function(pt,xt){this.commands.push({type:"L",x:pt,y:xt})},Ut.prototype.curveTo=Ut.prototype.bezierCurveTo=function(pt,xt,Ct,It,Pt,kt){this.commands.push({type:"C",x1:pt,y1:xt,x2:Ct,y2:It,x:Pt,y:kt})},Ut.prototype.quadTo=Ut.prototype.quadraticCurveTo=function(pt,xt,Ct,It){this.commands.push({type:"Q",x1:pt,y1:xt,x:Ct,y:It})},Ut.prototype.close=Ut.prototype.closePath=function(){this.commands.push({type:"Z"})},Ut.prototype.extend=function(pt){if(pt.commands)pt=pt.commands;else if(pt instanceof Rt){var xt=pt;this.moveTo(xt.x1,xt.y1),this.lineTo(xt.x2,xt.y1),this.lineTo(xt.x2,xt.y2),this.lineTo(xt.x1,xt.y2),this.close();return}Array.prototype.push.apply(this.commands,pt)},Ut.prototype.getBoundingBox=function(){for(var pt=new Rt,xt=0,Ct=0,It=0,Pt=0,kt=0;kt<this.commands.length;kt++){var Yt=this.commands[kt];switch(Yt.type){case"M":pt.addPoint(Yt.x,Yt.y),xt=It=Yt.x,Ct=Pt=Yt.y;break;case"L":pt.addPoint(Yt.x,Yt.y),It=Yt.x,Pt=Yt.y;break;case"Q":pt.addQuad(It,Pt,Yt.x1,Yt.y1,Yt.x,Yt.y),It=Yt.x,Pt=Yt.y;break;case"C":pt.addBezier(It,Pt,Yt.x1,Yt.y1,Yt.x2,Yt.y2,Yt.x,Yt.y),It=Yt.x,Pt=Yt.y;break;case"Z":It=xt,Pt=Ct;break;default:throw new Error("Unexpected path command "+Yt.type)}}return pt.isEmpty()&&pt.addPoint(0,0),pt},Ut.prototype.draw=function(pt){pt.beginPath();for(var xt=0;xt<this.commands.length;xt+=1){var Ct=this.commands[xt];Ct.type==="M"?pt.moveTo(Ct.x,Ct.y):Ct.type==="L"?pt.lineTo(Ct.x,Ct.y):Ct.type==="C"?pt.bezierCurveTo(Ct.x1,Ct.y1,Ct.x2,Ct.y2,Ct.x,Ct.y):Ct.type==="Q"?pt.quadraticCurveTo(Ct.x1,Ct.y1,Ct.x,Ct.y):Ct.type==="Z"&&pt.closePath()}this.fill&&(pt.fillStyle=this.fill,pt.fill()),this.stroke&&(pt.strokeStyle=this.stroke,pt.lineWidth=this.strokeWidth,pt.stroke())},Ut.prototype.toPathData=function(pt){pt=pt!==void 0?pt:2;function xt(Yt){return Math.round(Yt)===Yt?""+Math.round(Yt):Yt.toFixed(pt)}function Ct(){for(var Yt=arguments,un="",an=0;an<arguments.length;an+=1){var jn=Yt[an];jn>=0&&an>0&&(un+=" "),un+=xt(jn)}return un}for(var It="",Pt=0;Pt<this.commands.length;Pt+=1){var kt=this.commands[Pt];kt.type==="M"?It+="M"+Ct(kt.x,kt.y):kt.type==="L"?It+="L"+Ct(kt.x,kt.y):kt.type==="C"?It+="C"+Ct(kt.x1,kt.y1,kt.x2,kt.y2,kt.x,kt.y):kt.type==="Q"?It+="Q"+Ct(kt.x1,kt.y1,kt.x,kt.y):kt.type==="Z"&&(It+="Z")}return It},Ut.prototype.toSVG=function(pt){var xt='<path d="';return xt+=this.toPathData(pt),xt+='"',this.fill&&this.fill!=="black"&&(this.fill===null?xt+=' fill="none"':xt+=' fill="'+this.fill+'"'),this.stroke&&(xt+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),xt+="/>",xt},Ut.prototype.toDOMElement=function(pt){var xt=this.toPathData(pt),Ct=document.createElementNS("http://www.w3.org/2000/svg","path");return Ct.setAttribute("d",xt),Ct};function Ht(pt){throw new Error(pt)}function Wt(pt,xt){pt||Ht(xt)}var Jt={fail:Ht,argument:Wt,assert:Wt},sn=32768,jt=2147483648,Vt={},Lt={},Qt={};function nn(pt){return function(){return pt}}Lt.BYTE=function(pt){return Jt.argument(pt>=0&&pt<=255,"Byte value should be between 0 and 255."),[pt]},Qt.BYTE=nn(1),Lt.CHAR=function(pt){return[pt.charCodeAt(0)]},Qt.CHAR=nn(1),Lt.CHARARRAY=function(pt){typeof pt>"u"&&(pt="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var xt=[],Ct=0;Ct<pt.length;Ct+=1)xt[Ct]=pt.charCodeAt(Ct);return xt},Qt.CHARARRAY=function(pt){return typeof pt>"u"?0:pt.length},Lt.USHORT=function(pt){return[pt>>8&255,pt&255]},Qt.USHORT=nn(2),Lt.SHORT=function(pt){return pt>=sn&&(pt=-(2*sn-pt)),[pt>>8&255,pt&255]},Qt.SHORT=nn(2),Lt.UINT24=function(pt){return[pt>>16&255,pt>>8&255,pt&255]},Qt.UINT24=nn(3),Lt.ULONG=function(pt){return[pt>>24&255,pt>>16&255,pt>>8&255,pt&255]},Qt.ULONG=nn(4),Lt.LONG=function(pt){return pt>=jt&&(pt=-(2*jt-pt)),[pt>>24&255,pt>>16&255,pt>>8&255,pt&255]},Qt.LONG=nn(4),Lt.FIXED=Lt.ULONG,Qt.FIXED=Qt.ULONG,Lt.FWORD=Lt.SHORT,Qt.FWORD=Qt.SHORT,Lt.UFWORD=Lt.USHORT,Qt.UFWORD=Qt.USHORT,Lt.LONGDATETIME=function(pt){return[0,0,0,0,pt>>24&255,pt>>16&255,pt>>8&255,pt&255]},Qt.LONGDATETIME=nn(8),Lt.TAG=function(pt){return Jt.argument(pt.length===4,"Tag should be exactly 4 ASCII characters."),[pt.charCodeAt(0),pt.charCodeAt(1),pt.charCodeAt(2),pt.charCodeAt(3)]},Qt.TAG=nn(4),Lt.Card8=Lt.BYTE,Qt.Card8=Qt.BYTE,Lt.Card16=Lt.USHORT,Qt.Card16=Qt.USHORT,Lt.OffSize=Lt.BYTE,Qt.OffSize=Qt.BYTE,Lt.SID=Lt.USHORT,Qt.SID=Qt.USHORT,Lt.NUMBER=function(pt){return pt>=-107&&pt<=107?[pt+139]:pt>=108&&pt<=1131?(pt=pt-108,[(pt>>8)+247,pt&255]):pt>=-1131&&pt<=-108?(pt=-pt-108,[(pt>>8)+251,pt&255]):pt>=-32768&&pt<=32767?Lt.NUMBER16(pt):Lt.NUMBER32(pt)},Qt.NUMBER=function(pt){return Lt.NUMBER(pt).length},Lt.NUMBER16=function(pt){return[28,pt>>8&255,pt&255]},Qt.NUMBER16=nn(3),Lt.NUMBER32=function(pt){return[29,pt>>24&255,pt>>16&255,pt>>8&255,pt&255]},Qt.NUMBER32=nn(5),Lt.REAL=function(pt){var xt=pt.toString(),Ct=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(xt);if(Ct){var It=parseFloat("1e"+((Ct[2]?+Ct[2]:0)+Ct[1].length));xt=(Math.round(pt*It)/It).toString()}for(var Pt="",kt=0,Yt=xt.length;kt<Yt;kt+=1){var un=xt[kt];un==="e"?Pt+=xt[++kt]==="-"?"c":"b":un==="."?Pt+="a":un==="-"?Pt+="e":Pt+=un}Pt+=Pt.length&1?"f":"ff";for(var an=[30],jn=0,Wn=Pt.length;jn<Wn;jn+=2)an.push(parseInt(Pt.substr(jn,2),16));return an},Qt.REAL=function(pt){return Lt.REAL(pt).length},Lt.NAME=Lt.CHARARRAY,Qt.NAME=Qt.CHARARRAY,Lt.STRING=Lt.CHARARRAY,Qt.STRING=Qt.CHARARRAY,Vt.UTF8=function(pt,xt,Ct){for(var It=[],Pt=Ct,kt=0;kt<Pt;kt++,xt+=1)It[kt]=pt.getUint8(xt);return String.fromCharCode.apply(null,It)},Vt.UTF16=function(pt,xt,Ct){for(var It=[],Pt=Ct/2,kt=0;kt<Pt;kt++,xt+=2)It[kt]=pt.getUint16(xt);return String.fromCharCode.apply(null,It)},Lt.UTF16=function(pt){for(var xt=[],Ct=0;Ct<pt.length;Ct+=1){var It=pt.charCodeAt(Ct);xt[xt.length]=It>>8&255,xt[xt.length]=It&255}return xt},Qt.UTF16=function(pt){return pt.length*2};var mn={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};Vt.MACSTRING=function(pt,xt,Ct,It){var Pt=mn[It];if(Pt!==void 0){for(var kt="",Yt=0;Yt<Ct;Yt++){var un=pt.getUint8(xt+Yt);un<=127?kt+=String.fromCharCode(un):kt+=Pt[un&127]}return kt}};var Zt=typeof WeakMap=="function"&&new WeakMap,cn,Ot=function(pt){if(!cn){cn={};for(var xt in mn)cn[xt]=new String(xt)}var Ct=cn[pt];if(Ct!==void 0){if(Zt){var It=Zt.get(Ct);if(It!==void 0)return It}var Pt=mn[pt];if(Pt!==void 0){for(var kt={},Yt=0;Yt<Pt.length;Yt++)kt[Pt.charCodeAt(Yt)]=Yt+128;return Zt&&Zt.set(Ct,kt),kt}}};Lt.MACSTRING=function(pt,xt){var Ct=Ot(xt);if(Ct!==void 0){for(var It=[],Pt=0;Pt<pt.length;Pt++){var kt=pt.charCodeAt(Pt);if(kt>=128&&(kt=Ct[kt],kt===void 0))return;It[Pt]=kt}return It}},Qt.MACSTRING=function(pt,xt){var Ct=Lt.MACSTRING(pt,xt);return Ct!==void 0?Ct.length:0};function rn(pt){return pt>=-128&&pt<=127}function fn(pt,xt,Ct){for(var It=0,Pt=pt.length;xt<Pt&&It<64&&pt[xt]===0;)++xt,++It;return Ct.push(128|It-1),xt}function hn(pt,xt,Ct){for(var It=0,Pt=pt.length,kt=xt;kt<Pt&&It<64;){var Yt=pt[kt];if(!rn(Yt)||Yt===0&&kt+1<Pt&&pt[kt+1]===0)break;++kt,++It}Ct.push(It-1);for(var un=xt;un<kt;++un)Ct.push(pt[un]+256&255);return kt}function Tn(pt,xt,Ct){for(var It=0,Pt=pt.length,kt=xt;kt<Pt&&It<64;){var Yt=pt[kt];if(Yt===0||rn(Yt)&&kt+1<Pt&&rn(pt[kt+1]))break;++kt,++It}Ct.push(64|It-1);for(var un=xt;un<kt;++un){var an=pt[un];Ct.push(an+65536>>8&255,an+256&255)}return kt}Lt.VARDELTAS=function(pt){for(var xt=0,Ct=[];xt<pt.length;){var It=pt[xt];It===0?xt=fn(pt,xt,Ct):It>=-128&&It<=127?xt=hn(pt,xt,Ct):xt=Tn(pt,xt,Ct)}return Ct},Lt.INDEX=function(pt){for(var xt=1,Ct=[xt],It=[],Pt=0;Pt<pt.length;Pt+=1){var kt=Lt.OBJECT(pt[Pt]);Array.prototype.push.apply(It,kt),xt+=kt.length,Ct.push(xt)}if(It.length===0)return[0,0];for(var Yt=[],un=1+Math.floor(Math.log(xt)/Math.log(2))/8|0,an=[void 0,Lt.BYTE,Lt.USHORT,Lt.UINT24,Lt.ULONG][un],jn=0;jn<Ct.length;jn+=1){var Wn=an(Ct[jn]);Array.prototype.push.apply(Yt,Wn)}return Array.prototype.concat(Lt.Card16(pt.length),Lt.OffSize(un),Yt,It)},Qt.INDEX=function(pt){return Lt.INDEX(pt).length},Lt.DICT=function(pt){for(var xt=[],Ct=Object.keys(pt),It=Ct.length,Pt=0;Pt<It;Pt+=1){var kt=parseInt(Ct[Pt],0),Yt=pt[kt];xt=xt.concat(Lt.OPERAND(Yt.value,Yt.type)),xt=xt.concat(Lt.OPERATOR(kt))}return xt},Qt.DICT=function(pt){return Lt.DICT(pt).length},Lt.OPERATOR=function(pt){return pt<1200?[pt]:[12,pt-1200]},Lt.OPERAND=function(pt,xt){var Ct=[];if(Array.isArray(xt))for(var It=0;It<xt.length;It+=1)Jt.argument(pt.length===xt.length,"Not enough arguments given for type"+xt),Ct=Ct.concat(Lt.OPERAND(pt[It],xt[It]));else if(xt==="SID")Ct=Ct.concat(Lt.NUMBER(pt));else if(xt==="offset")Ct=Ct.concat(Lt.NUMBER32(pt));else if(xt==="number")Ct=Ct.concat(Lt.NUMBER(pt));else if(xt==="real")Ct=Ct.concat(Lt.REAL(pt));else throw new Error("Unknown operand type "+xt);return Ct},Lt.OP=Lt.BYTE,Qt.OP=Qt.BYTE;var Nn=typeof WeakMap=="function"&&new WeakMap;Lt.CHARSTRING=function(pt){if(Nn){var xt=Nn.get(pt);if(xt!==void 0)return xt}for(var Ct=[],It=pt.length,Pt=0;Pt<It;Pt+=1){var kt=pt[Pt];Ct=Ct.concat(Lt[kt.type](kt.value))}return Nn&&Nn.set(pt,Ct),Ct},Qt.CHARSTRING=function(pt){return Lt.CHARSTRING(pt).length},Lt.OBJECT=function(pt){var xt=Lt[pt.type];return Jt.argument(xt!==void 0,"No encoding function for type "+pt.type),xt(pt.value)},Qt.OBJECT=function(pt){var xt=Qt[pt.type];return Jt.argument(xt!==void 0,"No sizeOf function for type "+pt.type),xt(pt.value)},Lt.TABLE=function(pt){for(var xt=[],Ct=pt.fields.length,It=[],Pt=[],kt=0;kt<Ct;kt+=1){var Yt=pt.fields[kt],un=Lt[Yt.type];Jt.argument(un!==void 0,"No encoding function for field type "+Yt.type+" ("+Yt.name+")");var an=pt[Yt.name];an===void 0&&(an=Yt.value);var jn=un(an);Yt.type==="TABLE"?(Pt.push(xt.length),xt=xt.concat([0,0]),It.push(jn)):xt=xt.concat(jn)}for(var Wn=0;Wn<It.length;Wn+=1){var lr=Pt[Wn],Yn=xt.length;Jt.argument(Yn<65536,"Table "+pt.tableName+" too big."),xt[lr]=Yn>>8,xt[lr+1]=Yn&255,xt=xt.concat(It[Wn])}return xt},Qt.TABLE=function(pt){for(var xt=0,Ct=pt.fields.length,It=0;It<Ct;It+=1){var Pt=pt.fields[It],kt=Qt[Pt.type];Jt.argument(kt!==void 0,"No sizeOf function for field type "+Pt.type+" ("+Pt.name+")");var Yt=pt[Pt.name];Yt===void 0&&(Yt=Pt.value),xt+=kt(Yt),Pt.type==="TABLE"&&(xt+=2)}return xt},Lt.RECORD=Lt.TABLE,Qt.RECORD=Qt.TABLE,Lt.LITERAL=function(pt){return pt},Qt.LITERAL=function(pt){return pt.length};function Pn(pt,xt,Ct){if(xt.length&&(xt[0].name!=="coverageFormat"||xt[0].value===1))for(var It=0;It<xt.length;It+=1){var Pt=xt[It];this[Pt.name]=Pt.value}if(this.tableName=pt,this.fields=xt,Ct)for(var kt=Object.keys(Ct),Yt=0;Yt<kt.length;Yt+=1){var un=kt[Yt],an=Ct[un];this[un]!==void 0&&(this[un]=an)}}Pn.prototype.encode=function(){return Lt.TABLE(this)},Pn.prototype.sizeOf=function(){return Qt.TABLE(this)};function Dn(pt,xt,Ct){Ct===void 0&&(Ct=xt.length);var It=new Array(xt.length+1);It[0]={name:pt+"Count",type:"USHORT",value:Ct};for(var Pt=0;Pt<xt.length;Pt++)It[Pt+1]={name:pt+Pt,type:"USHORT",value:xt[Pt]};return It}function ln(pt,xt,Ct){var It=xt.length,Pt=new Array(It+1);Pt[0]={name:pt+"Count",type:"USHORT",value:It};for(var kt=0;kt<It;kt++)Pt[kt+1]={name:pt+kt,type:"TABLE",value:Ct(xt[kt],kt)};return Pt}function Cn(pt,xt,Ct){var It=xt.length,Pt=[];Pt[0]={name:pt+"Count",type:"USHORT",value:It};for(var kt=0;kt<It;kt++)Pt=Pt.concat(Ct(xt[kt],kt));return Pt}function bn(pt){pt.format===1?Pn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(Dn("glyph",pt.glyphs))):pt.format===2?Pn.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(Cn("rangeRecord",pt.ranges,function(xt){return[{name:"startGlyphID",type:"USHORT",value:xt.start},{name:"endGlyphID",type:"USHORT",value:xt.end},{name:"startCoverageIndex",type:"USHORT",value:xt.index}]}))):Jt.assert(!1,"Coverage format must be 1 or 2.")}bn.prototype=Object.create(Pn.prototype),bn.prototype.constructor=bn;function kn(pt){Pn.call(this,"scriptListTable",Cn("scriptRecord",pt,function(xt,Ct){var It=xt.script,Pt=It.defaultLangSys;return Jt.assert(!!Pt,"Unable to write GSUB: script "+xt.tag+" has no default language system."),[{name:"scriptTag"+Ct,type:"TAG",value:xt.tag},{name:"script"+Ct,type:"TABLE",value:new Pn("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Pn("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Pt.reqFeatureIndex}].concat(Dn("featureIndex",Pt.featureIndexes)))}].concat(Cn("langSys",It.langSysRecords,function(kt,Yt){var un=kt.langSys;return[{name:"langSysTag"+Yt,type:"TAG",value:kt.tag},{name:"langSys"+Yt,type:"TABLE",value:new Pn("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:un.reqFeatureIndex}].concat(Dn("featureIndex",un.featureIndexes)))}]})))}]}))}kn.prototype=Object.create(Pn.prototype),kn.prototype.constructor=kn;function Sn(pt){Pn.call(this,"featureListTable",Cn("featureRecord",pt,function(xt,Ct){var It=xt.feature;return[{name:"featureTag"+Ct,type:"TAG",value:xt.tag},{name:"feature"+Ct,type:"TABLE",value:new Pn("featureTable",[{name:"featureParams",type:"USHORT",value:It.featureParams}].concat(Dn("lookupListIndex",It.lookupListIndexes)))}]}))}Sn.prototype=Object.create(Pn.prototype),Sn.prototype.constructor=Sn;function xn(pt,xt){Pn.call(this,"lookupListTable",ln("lookup",pt,function(Ct){var It=xt[Ct.lookupType];return Jt.assert(!!It,"Unable to write GSUB lookup type "+Ct.lookupType+" tables."),new Pn("lookupTable",[{name:"lookupType",type:"USHORT",value:Ct.lookupType},{name:"lookupFlag",type:"USHORT",value:Ct.lookupFlag}].concat(ln("subtable",Ct.subtables,It)))}))}xn.prototype=Object.create(Pn.prototype),xn.prototype.constructor=xn;var Qn={Table:Pn,Record:Pn,Coverage:bn,ScriptList:kn,FeatureList:Sn,LookupList:xn,ushortList:Dn,tableList:ln,recordList:Cn};function nr(pt,xt){return pt.getUint8(xt)}function or(pt,xt){return pt.getUint16(xt,!1)}function mr(pt,xt){return pt.getInt16(xt,!1)}function $n(pt,xt){return pt.getUint32(xt,!1)}function tn(pt,xt){var Ct=pt.getInt16(xt,!1),It=pt.getUint16(xt+2,!1);return Ct+It/65535}function $t(pt,xt){for(var Ct="",It=xt;It<xt+4;It+=1)Ct+=String.fromCharCode(pt.getInt8(It));return Ct}function An(pt,xt,Ct){for(var It=0,Pt=0;Pt<Ct;Pt+=1)It<<=8,It+=pt.getUint8(xt+Pt);return It}function En(pt,xt,Ct){for(var It=[],Pt=xt;Pt<Ct;Pt+=1)It.push(pt.getUint8(Pt));return It}function In(pt){for(var xt="",Ct=0;Ct<pt.length;Ct+=1)xt+=String.fromCharCode(pt[Ct]);return xt}var Hn={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function yn(pt,xt){this.data=pt,this.offset=xt,this.relativeOffset=0}yn.prototype.parseByte=function(){var pt=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,pt},yn.prototype.parseChar=function(){var pt=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,pt},yn.prototype.parseCard8=yn.prototype.parseByte,yn.prototype.parseUShort=function(){var pt=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,pt},yn.prototype.parseCard16=yn.prototype.parseUShort,yn.prototype.parseSID=yn.prototype.parseUShort,yn.prototype.parseOffset16=yn.prototype.parseUShort,yn.prototype.parseShort=function(){var pt=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,pt},yn.prototype.parseF2Dot14=function(){var pt=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,pt},yn.prototype.parseULong=function(){var pt=$n(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,pt},yn.prototype.parseOffset32=yn.prototype.parseULong,yn.prototype.parseFixed=function(){var pt=tn(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,pt},yn.prototype.parseString=function(pt){var xt=this.data,Ct=this.offset+this.relativeOffset,It="";this.relativeOffset+=pt;for(var Pt=0;Pt<pt;Pt++)It+=String.fromCharCode(xt.getUint8(Ct+Pt));return It},yn.prototype.parseTag=function(){return this.parseString(4)},yn.prototype.parseLongDateTime=function(){var pt=$n(this.data,this.offset+this.relativeOffset+4);return pt-=2082844800,this.relativeOffset+=8,pt},yn.prototype.parseVersion=function(pt){var xt=or(this.data,this.offset+this.relativeOffset),Ct=or(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,pt===void 0&&(pt=4096),xt+Ct/pt/10},yn.prototype.skip=function(pt,xt){xt===void 0&&(xt=1),this.relativeOffset+=Hn[pt]*xt},yn.prototype.parseULongList=function(pt){pt===void 0&&(pt=this.parseULong());for(var xt=new Array(pt),Ct=this.data,It=this.offset+this.relativeOffset,Pt=0;Pt<pt;Pt++)xt[Pt]=Ct.getUint32(It),It+=4;return this.relativeOffset+=pt*4,xt},yn.prototype.parseOffset16List=yn.prototype.parseUShortList=function(pt){pt===void 0&&(pt=this.parseUShort());for(var xt=new Array(pt),Ct=this.data,It=this.offset+this.relativeOffset,Pt=0;Pt<pt;Pt++)xt[Pt]=Ct.getUint16(It),It+=2;return this.relativeOffset+=pt*2,xt},yn.prototype.parseShortList=function(pt){for(var xt=new Array(pt),Ct=this.data,It=this.offset+this.relativeOffset,Pt=0;Pt<pt;Pt++)xt[Pt]=Ct.getInt16(It),It+=2;return this.relativeOffset+=pt*2,xt},yn.prototype.parseByteList=function(pt){for(var xt=new Array(pt),Ct=this.data,It=this.offset+this.relativeOffset,Pt=0;Pt<pt;Pt++)xt[Pt]=Ct.getUint8(It++);return this.relativeOffset+=pt,xt},yn.prototype.parseList=function(pt,xt){xt||(xt=pt,pt=this.parseUShort());for(var Ct=new Array(pt),It=0;It<pt;It++)Ct[It]=xt.call(this);return Ct},yn.prototype.parseList32=function(pt,xt){xt||(xt=pt,pt=this.parseULong());for(var Ct=new Array(pt),It=0;It<pt;It++)Ct[It]=xt.call(this);return Ct},yn.prototype.parseRecordList=function(pt,xt){xt||(xt=pt,pt=this.parseUShort());for(var Ct=new Array(pt),It=Object.keys(xt),Pt=0;Pt<pt;Pt++){for(var kt={},Yt=0;Yt<It.length;Yt++){var un=It[Yt],an=xt[un];kt[un]=an.call(this)}Ct[Pt]=kt}return Ct},yn.prototype.parseRecordList32=function(pt,xt){xt||(xt=pt,pt=this.parseULong());for(var Ct=new Array(pt),It=Object.keys(xt),Pt=0;Pt<pt;Pt++){for(var kt={},Yt=0;Yt<It.length;Yt++){var un=It[Yt],an=xt[un];kt[un]=an.call(this)}Ct[Pt]=kt}return Ct},yn.prototype.parseStruct=function(pt){if(typeof pt=="function")return pt.call(this);for(var xt=Object.keys(pt),Ct={},It=0;It<xt.length;It++){var Pt=xt[It],kt=pt[Pt];Ct[Pt]=kt.call(this)}return Ct},yn.prototype.parseValueRecord=function(pt){if(pt===void 0&&(pt=this.parseUShort()),pt!==0){var xt={};return pt&1&&(xt.xPlacement=this.parseShort()),pt&2&&(xt.yPlacement=this.parseShort()),pt&4&&(xt.xAdvance=this.parseShort()),pt&8&&(xt.yAdvance=this.parseShort()),pt&16&&(xt.xPlaDevice=void 0,this.parseShort()),pt&32&&(xt.yPlaDevice=void 0,this.parseShort()),pt&64&&(xt.xAdvDevice=void 0,this.parseShort()),pt&128&&(xt.yAdvDevice=void 0,this.parseShort()),xt}},yn.prototype.parseValueRecordList=function(){for(var pt=this.parseUShort(),xt=this.parseUShort(),Ct=new Array(xt),It=0;It<xt;It++)Ct[It]=this.parseValueRecord(pt);return Ct},yn.prototype.parsePointer=function(pt){var xt=this.parseOffset16();if(xt>0)return new yn(this.data,this.offset+xt).parseStruct(pt)},yn.prototype.parsePointer32=function(pt){var xt=this.parseOffset32();if(xt>0)return new yn(this.data,this.offset+xt).parseStruct(pt)},yn.prototype.parseListOfLists=function(pt){for(var xt=this.parseOffset16List(),Ct=xt.length,It=this.relativeOffset,Pt=new Array(Ct),kt=0;kt<Ct;kt++){var Yt=xt[kt];if(Yt===0){Pt[kt]=void 0;continue}if(this.relativeOffset=Yt,pt){for(var un=this.parseOffset16List(),an=new Array(un.length),jn=0;jn<un.length;jn++)this.relativeOffset=Yt+un[jn],an[jn]=pt.call(this);Pt[kt]=an}else Pt[kt]=this.parseUShortList()}return this.relativeOffset=It,Pt},yn.prototype.parseCoverage=function(){var pt=this.offset+this.relativeOffset,xt=this.parseUShort(),Ct=this.parseUShort();if(xt===1)return{format:1,glyphs:this.parseUShortList(Ct)};if(xt===2){for(var It=new Array(Ct),Pt=0;Pt<Ct;Pt++)It[Pt]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:It}}throw new Error("0x"+pt.toString(16)+": Coverage format must be 1 or 2.")},yn.prototype.parseClassDef=function(){var pt=this.offset+this.relativeOffset,xt=this.parseUShort();if(xt===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(xt===2)return{format:2,ranges:this.parseRecordList({start:yn.uShort,end:yn.uShort,classId:yn.uShort})};throw new Error("0x"+pt.toString(16)+": ClassDef format must be 1 or 2.")},yn.list=function(pt,xt){return function(){return this.parseList(pt,xt)}},yn.list32=function(pt,xt){return function(){return this.parseList32(pt,xt)}},yn.recordList=function(pt,xt){return function(){return this.parseRecordList(pt,xt)}},yn.recordList32=function(pt,xt){return function(){return this.parseRecordList32(pt,xt)}},yn.pointer=function(pt){return function(){return this.parsePointer(pt)}},yn.pointer32=function(pt){return function(){return this.parsePointer32(pt)}},yn.tag=yn.prototype.parseTag,yn.byte=yn.prototype.parseByte,yn.uShort=yn.offset16=yn.prototype.parseUShort,yn.uShortList=yn.prototype.parseUShortList,yn.uLong=yn.offset32=yn.prototype.parseULong,yn.uLongList=yn.prototype.parseULongList,yn.struct=yn.prototype.parseStruct,yn.coverage=yn.prototype.parseCoverage,yn.classDef=yn.prototype.parseClassDef;var On={reserved:yn.uShort,reqFeatureIndex:yn.uShort,featureIndexes:yn.uShortList};yn.prototype.parseScriptList=function(){return this.parsePointer(yn.recordList({tag:yn.tag,script:yn.pointer({defaultLangSys:yn.pointer(On),langSysRecords:yn.recordList({tag:yn.tag,langSys:yn.pointer(On)})})}))||[]},yn.prototype.parseFeatureList=function(){return this.parsePointer(yn.recordList({tag:yn.tag,feature:yn.pointer({featureParams:yn.offset16,lookupListIndexes:yn.uShortList})}))||[]},yn.prototype.parseLookupList=function(pt){return this.parsePointer(yn.list(yn.pointer(function(){var xt=this.parseUShort();Jt.argument(1<=xt&&xt<=9,"GPOS/GSUB lookup type "+xt+" unknown.");var Ct=this.parseUShort(),It=Ct&16;return{lookupType:xt,lookupFlag:Ct,subtables:this.parseList(yn.pointer(pt[xt])),markFilteringSet:It?this.parseUShort():void 0}})))||[]},yn.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var pt=this.parseUShort(),xt=this.parseUShort();Jt.argument(pt===1&&xt<1,"GPOS/GSUB feature variations table unknown.");var Ct=this.parseRecordList32({conditionSetOffset:yn.offset32,featureTableSubstitutionOffset:yn.offset32});return Ct})||[]};var Mn={getByte:nr,getCard8:nr,getUShort:or,getCard16:or,getShort:mr,getULong:$n,getFixed:tn,getTag:$t,getOffset:An,getBytes:En,bytesToString:In,Parser:yn};function tr(pt,xt){xt.parseUShort(),pt.length=xt.parseULong(),pt.language=xt.parseULong();var Ct;pt.groupCount=Ct=xt.parseULong(),pt.glyphIndexMap={};for(var It=0;It<Ct;It+=1)for(var Pt=xt.parseULong(),kt=xt.parseULong(),Yt=xt.parseULong(),un=Pt;un<=kt;un+=1)pt.glyphIndexMap[un]=Yt,Yt++}function gr(pt,xt,Ct,It,Pt){pt.length=xt.parseUShort(),pt.language=xt.parseUShort();var kt;pt.segCount=kt=xt.parseUShort()>>1,xt.skip("uShort",3),pt.glyphIndexMap={};for(var Yt=new Mn.Parser(Ct,It+Pt+14),un=new Mn.Parser(Ct,It+Pt+16+kt*2),an=new Mn.Parser(Ct,It+Pt+16+kt*4),jn=new Mn.Parser(Ct,It+Pt+16+kt*6),Wn=It+Pt+16+kt*8,lr=0;lr<kt-1;lr+=1)for(var Yn=void 0,hr=Yt.parseUShort(),Lr=un.parseUShort(),jr=an.parseShort(),Xr=jn.parseUShort(),Wr=Lr;Wr<=hr;Wr+=1)Xr!==0?(Wn=jn.offset+jn.relativeOffset-2,Wn+=Xr,Wn+=(Wr-Lr)*2,Yn=Mn.getUShort(Ct,Wn),Yn!==0&&(Yn=Yn+jr&65535)):Yn=Wr+jr&65535,pt.glyphIndexMap[Wr]=Yn}function Cr(pt,xt){var Ct={};Ct.version=Mn.getUShort(pt,xt),Jt.argument(Ct.version===0,"cmap table version should be 0."),Ct.numTables=Mn.getUShort(pt,xt+2);for(var It=-1,Pt=Ct.numTables-1;Pt>=0;Pt-=1){var kt=Mn.getUShort(pt,xt+4+Pt*8),Yt=Mn.getUShort(pt,xt+4+Pt*8+2);if(kt===3&&(Yt===0||Yt===1||Yt===10)||kt===0&&(Yt===0||Yt===1||Yt===2||Yt===3||Yt===4)){It=Mn.getULong(pt,xt+4+Pt*8+4);break}}if(It===-1)throw new Error("No valid cmap sub-tables found.");var un=new Mn.Parser(pt,xt+It);if(Ct.format=un.parseUShort(),Ct.format===12)tr(Ct,un);else if(Ct.format===4)gr(Ct,un,pt,xt,It);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+Ct.format+").");return Ct}function Sr(pt,xt,Ct){pt.segments.push({end:xt,start:xt,delta:-(xt-Ct),offset:0,glyphIndex:Ct})}function Un(pt){pt.segments.push({end:65535,start:65535,delta:1,offset:0})}function Jn(pt){var xt=!0,Ct;for(Ct=pt.length-1;Ct>0;Ct-=1){var It=pt.get(Ct);if(It.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),xt=!1;break}}var Pt=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:xt?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:xt?12:12+8}];xt||(Pt=Pt.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),Pt=Pt.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var kt=new Qn.Table("cmap",Pt);for(kt.segments=[],Ct=0;Ct<pt.length;Ct+=1){for(var Yt=pt.get(Ct),un=0;un<Yt.unicodes.length;un+=1)Sr(kt,Yt.unicodes[un],Ct);kt.segments=kt.segments.sort(function(bs,kr){return bs.start-kr.start})}Un(kt);var an=kt.segments.length,jn=0,Wn=[],lr=[],Yn=[],hr=[],Lr=[],jr=[];for(Ct=0;Ct<an;Ct+=1){var Xr=kt.segments[Ct];Xr.end<=65535&&Xr.start<=65535?(Wn=Wn.concat({name:"end_"+Ct,type:"USHORT",value:Xr.end}),lr=lr.concat({name:"start_"+Ct,type:"USHORT",value:Xr.start}),Yn=Yn.concat({name:"idDelta_"+Ct,type:"SHORT",value:Xr.delta}),hr=hr.concat({name:"idRangeOffset_"+Ct,type:"USHORT",value:Xr.offset}),Xr.glyphId!==void 0&&(Lr=Lr.concat({name:"glyph_"+Ct,type:"USHORT",value:Xr.glyphId}))):jn+=1,!xt&&Xr.glyphIndex!==void 0&&(jr=jr.concat({name:"cmap12Start_"+Ct,type:"ULONG",value:Xr.start}),jr=jr.concat({name:"cmap12End_"+Ct,type:"ULONG",value:Xr.end}),jr=jr.concat({name:"cmap12Glyph_"+Ct,type:"ULONG",value:Xr.glyphIndex}))}if(kt.segCountX2=(an-jn)*2,kt.searchRange=Math.pow(2,Math.floor(Math.log(an-jn)/Math.log(2)))*2,kt.entrySelector=Math.log(kt.searchRange/2)/Math.log(2),kt.rangeShift=kt.segCountX2-kt.searchRange,kt.fields=kt.fields.concat(Wn),kt.fields.push({name:"reservedPad",type:"USHORT",value:0}),kt.fields=kt.fields.concat(lr),kt.fields=kt.fields.concat(Yn),kt.fields=kt.fields.concat(hr),kt.fields=kt.fields.concat(Lr),kt.cmap4Length=14+Wn.length*2+2+lr.length*2+Yn.length*2+hr.length*2+Lr.length*2,!xt){var Wr=16+jr.length*4;kt.cmap12Offset=12+2*2+4+kt.cmap4Length,kt.fields=kt.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:Wr},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:jr.length/3}]),kt.fields=kt.fields.concat(jr)}return kt}var pr={parse:Cr,make:Jn},Gn=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Zn=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],qn=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],vr=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function _r(pt){this.font=pt}_r.prototype.charToGlyphIndex=function(pt){var xt=pt.codePointAt(0),Ct=this.font.glyphs;if(Ct){for(var It=0;It<Ct.length;It+=1)for(var Pt=Ct.get(It),kt=0;kt<Pt.unicodes.length;kt+=1)if(Pt.unicodes[kt]===xt)return It}return null};function $r(pt){this.cmap=pt}$r.prototype.charToGlyphIndex=function(pt){return this.cmap.glyphIndexMap[pt.codePointAt(0)]||0};function es(pt,xt){this.encoding=pt,this.charset=xt}es.prototype.charToGlyphIndex=function(pt){var xt=pt.codePointAt(0),Ct=this.encoding[xt];return this.charset.indexOf(Ct)};function Hr(pt){switch(pt.version){case 1:this.names=vr.slice();break;case 2:this.names=new Array(pt.numberOfGlyphs);for(var xt=0;xt<pt.numberOfGlyphs;xt++)pt.glyphNameIndex[xt]<vr.length?this.names[xt]=vr[pt.glyphNameIndex[xt]]:this.names[xt]=pt.names[pt.glyphNameIndex[xt]-vr.length];break;case 2.5:this.names=new Array(pt.numberOfGlyphs);for(var Ct=0;Ct<pt.numberOfGlyphs;Ct++)this.names[Ct]=vr[Ct+pt.glyphNameIndex[Ct]];break;case 3:this.names=[];break;default:this.names=[];break}}Hr.prototype.nameToGlyphIndex=function(pt){return this.names.indexOf(pt)},Hr.prototype.glyphIndexToName=function(pt){return this.names[pt]};function Ur(pt){for(var xt,Ct=pt.tables.cmap.glyphIndexMap,It=Object.keys(Ct),Pt=0;Pt<It.length;Pt+=1){var kt=It[Pt],Yt=Ct[kt];xt=pt.glyphs.get(Yt),xt.addUnicode(parseInt(kt))}for(var un=0;un<pt.glyphs.length;un+=1)xt=pt.glyphs.get(un),pt.cffEncoding?pt.isCIDFont?xt.name="gid"+un:xt.name=pt.cffEncoding.charset[un]:pt.glyphNames.names&&(xt.name=pt.glyphNames.glyphIndexToName(un))}function Ir(pt){pt._IndexToUnicodeMap={};for(var xt=pt.tables.cmap.glyphIndexMap,Ct=Object.keys(xt),It=0;It<Ct.length;It+=1){var Pt=Ct[It],kt=xt[Pt];pt._IndexToUnicodeMap[kt]===void 0?pt._IndexToUnicodeMap[kt]={unicodes:[parseInt(Pt)]}:pt._IndexToUnicodeMap[kt].unicodes.push(parseInt(Pt))}}function Fr(pt,xt){xt.lowMemory?Ir(pt):Ur(pt)}function Pr(pt,xt,Ct,It,Pt){pt.beginPath(),pt.moveTo(xt,Ct),pt.lineTo(It,Pt),pt.stroke()}var Jr={line:Pr};function zs(pt,xt){var Ct=xt||new Ut;return{configurable:!0,get:function(){return typeof Ct=="function"&&(Ct=Ct()),Ct},set:function(It){Ct=It}}}function Ws(pt){this.bindConstructorValues(pt)}Ws.prototype.bindConstructorValues=function(pt){this.index=pt.index||0,this.name=pt.name||null,this.unicode=pt.unicode||void 0,this.unicodes=pt.unicodes||pt.unicode!==void 0?[pt.unicode]:[],"xMin"in pt&&(this.xMin=pt.xMin),"yMin"in pt&&(this.yMin=pt.yMin),"xMax"in pt&&(this.xMax=pt.xMax),"yMax"in pt&&(this.yMax=pt.yMax),"advanceWidth"in pt&&(this.advanceWidth=pt.advanceWidth),Object.defineProperty(this,"path",zs(this,pt.path))},Ws.prototype.addUnicode=function(pt){this.unicodes.length===0&&(this.unicode=pt),this.unicodes.push(pt)},Ws.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Ws.prototype.getPath=function(pt,xt,Ct,It,Pt){pt=pt!==void 0?pt:0,xt=xt!==void 0?xt:0,Ct=Ct!==void 0?Ct:72;var kt,Yt;It||(It={});var un=It.xScale,an=It.yScale;if(It.hinting&&Pt&&Pt.hinting&&(Yt=this.path&&Pt.hinting.exec(this,Ct)),Yt)kt=Pt.hinting.getCommands(Yt),pt=Math.round(pt),xt=Math.round(xt),un=an=1;else{kt=this.path.commands;var jn=1/(this.path.unitsPerEm||1e3)*Ct;un===void 0&&(un=jn),an===void 0&&(an=jn)}for(var Wn=new Ut,lr=0;lr<kt.length;lr+=1){var Yn=kt[lr];Yn.type==="M"?Wn.moveTo(pt+Yn.x*un,xt+-Yn.y*an):Yn.type==="L"?Wn.lineTo(pt+Yn.x*un,xt+-Yn.y*an):Yn.type==="Q"?Wn.quadraticCurveTo(pt+Yn.x1*un,xt+-Yn.y1*an,pt+Yn.x*un,xt+-Yn.y*an):Yn.type==="C"?Wn.curveTo(pt+Yn.x1*un,xt+-Yn.y1*an,pt+Yn.x2*un,xt+-Yn.y2*an,pt+Yn.x*un,xt+-Yn.y*an):Yn.type==="Z"&&Wn.closePath()}return Wn},Ws.prototype.getContours=function(){if(this.points===void 0)return[];for(var pt=[],xt=[],Ct=0;Ct<this.points.length;Ct+=1){var It=this.points[Ct];xt.push(It),It.lastPointOfContour&&(pt.push(xt),xt=[])}return Jt.argument(xt.length===0,"There are still points left in the current contour."),pt},Ws.prototype.getMetrics=function(){for(var pt=this.path.commands,xt=[],Ct=[],It=0;It<pt.length;It+=1){var Pt=pt[It];Pt.type!=="Z"&&(xt.push(Pt.x),Ct.push(Pt.y)),(Pt.type==="Q"||Pt.type==="C")&&(xt.push(Pt.x1),Ct.push(Pt.y1)),Pt.type==="C"&&(xt.push(Pt.x2),Ct.push(Pt.y2))}var kt={xMin:Math.min.apply(null,xt),yMin:Math.min.apply(null,Ct),xMax:Math.max.apply(null,xt),yMax:Math.max.apply(null,Ct),leftSideBearing:this.leftSideBearing};return isFinite(kt.xMin)||(kt.xMin=0),isFinite(kt.xMax)||(kt.xMax=this.advanceWidth),isFinite(kt.yMin)||(kt.yMin=0),isFinite(kt.yMax)||(kt.yMax=0),kt.rightSideBearing=this.advanceWidth-kt.leftSideBearing-(kt.xMax-kt.xMin),kt},Ws.prototype.draw=function(pt,xt,Ct,It,Pt){this.getPath(xt,Ct,It,Pt).draw(pt)},Ws.prototype.drawPoints=function(pt,xt,Ct,It){function Pt(lr,Yn,hr,Lr){pt.beginPath();for(var jr=0;jr<lr.length;jr+=1)pt.moveTo(Yn+lr[jr].x*Lr,hr+lr[jr].y*Lr),pt.arc(Yn+lr[jr].x*Lr,hr+lr[jr].y*Lr,2,0,Math.PI*2,!1);pt.closePath(),pt.fill()}xt=xt!==void 0?xt:0,Ct=Ct!==void 0?Ct:0,It=It!==void 0?It:24;for(var kt=1/this.path.unitsPerEm*It,Yt=[],un=[],an=this.path,jn=0;jn<an.commands.length;jn+=1){var Wn=an.commands[jn];Wn.x!==void 0&&Yt.push({x:Wn.x,y:-Wn.y}),Wn.x1!==void 0&&un.push({x:Wn.x1,y:-Wn.y1}),Wn.x2!==void 0&&un.push({x:Wn.x2,y:-Wn.y2})}pt.fillStyle="blue",Pt(Yt,xt,Ct,kt),pt.fillStyle="red",Pt(un,xt,Ct,kt)},Ws.prototype.drawMetrics=function(pt,xt,Ct,It){var Pt;xt=xt!==void 0?xt:0,Ct=Ct!==void 0?Ct:0,It=It!==void 0?It:24,Pt=1/this.path.unitsPerEm*It,pt.lineWidth=1,pt.strokeStyle="black",Jr.line(pt,xt,-1e4,xt,1e4),Jr.line(pt,-1e4,Ct,1e4,Ct);var kt=this.xMin||0,Yt=this.yMin||0,un=this.xMax||0,an=this.yMax||0,jn=this.advanceWidth||0;pt.strokeStyle="blue",Jr.line(pt,xt+kt*Pt,-1e4,xt+kt*Pt,1e4),Jr.line(pt,xt+un*Pt,-1e4,xt+un*Pt,1e4),Jr.line(pt,-1e4,Ct+-Yt*Pt,1e4,Ct+-Yt*Pt),Jr.line(pt,-1e4,Ct+-an*Pt,1e4,Ct+-an*Pt),pt.strokeStyle="green",Jr.line(pt,xt+jn*Pt,-1e4,xt+jn*Pt,1e4)};function Js(pt,xt,Ct){Object.defineProperty(pt,xt,{get:function(){return pt.path,pt[Ct]},set:function(It){pt[Ct]=It},enumerable:!0,configurable:!0})}function ao(pt,xt){if(this.font=pt,this.glyphs={},Array.isArray(xt))for(var Ct=0;Ct<xt.length;Ct++){var It=xt[Ct];It.path.unitsPerEm=pt.unitsPerEm,this.glyphs[Ct]=It}this.length=xt&&xt.length||0}ao.prototype.get=function(pt){if(this.glyphs[pt]===void 0){this.font._push(pt),typeof this.glyphs[pt]=="function"&&(this.glyphs[pt]=this.glyphs[pt]());var xt=this.glyphs[pt],Ct=this.font._IndexToUnicodeMap[pt];if(Ct)for(var It=0;It<Ct.unicodes.length;It++)xt.addUnicode(Ct.unicodes[It]);this.font.cffEncoding?this.font.isCIDFont?xt.name="gid"+pt:xt.name=this.font.cffEncoding.charset[pt]:this.font.glyphNames.names&&(xt.name=this.font.glyphNames.glyphIndexToName(pt)),this.glyphs[pt].advanceWidth=this.font._hmtxTableData[pt].advanceWidth,this.glyphs[pt].leftSideBearing=this.font._hmtxTableData[pt].leftSideBearing}else typeof this.glyphs[pt]=="function"&&(this.glyphs[pt]=this.glyphs[pt]());return this.glyphs[pt]},ao.prototype.push=function(pt,xt){this.glyphs[pt]=xt,this.length++};function Ks(pt,xt){return new Ws({index:xt,font:pt})}function Es(pt,xt,Ct,It,Pt,kt){return function(){var Yt=new Ws({index:xt,font:pt});return Yt.path=function(){Ct(Yt,It,Pt);var un=kt(pt.glyphs,Yt);return un.unitsPerEm=pt.unitsPerEm,un},Js(Yt,"xMin","_xMin"),Js(Yt,"xMax","_xMax"),Js(Yt,"yMin","_yMin"),Js(Yt,"yMax","_yMax"),Yt}}function Do(pt,xt,Ct,It){return function(){var Pt=new Ws({index:xt,font:pt});return Pt.path=function(){var kt=Ct(pt,Pt,It);return kt.unitsPerEm=pt.unitsPerEm,kt},Pt}}var js={GlyphSet:ao,glyphLoader:Ks,ttfGlyphLoader:Es,cffGlyphLoader:Do};function pn(pt,xt){if(pt===xt)return!0;if(Array.isArray(pt)&&Array.isArray(xt)){if(pt.length!==xt.length)return!1;for(var Ct=0;Ct<pt.length;Ct+=1)if(!pn(pt[Ct],xt[Ct]))return!1;return!0}else return!1}function Kt(pt){var xt;return pt.length<1240?xt=107:pt.length<33900?xt=1131:xt=32768,xt}function Gt(pt,xt,Ct){var It=[],Pt=[],kt=Mn.getCard16(pt,xt),Yt,un;if(kt!==0){var an=Mn.getByte(pt,xt+2);Yt=xt+(kt+1)*an+2;for(var jn=xt+3,Wn=0;Wn<kt+1;Wn+=1)It.push(Mn.getOffset(pt,jn,an)),jn+=an;un=Yt+It[kt]}else un=xt+2;for(var lr=0;lr<It.length-1;lr+=1){var Yn=Mn.getBytes(pt,Yt+It[lr],Yt+It[lr+1]);Ct&&(Yn=Ct(Yn)),Pt.push(Yn)}return{objects:Pt,startOffset:xt,endOffset:un}}function zt(pt,xt){var Ct=[],It=Mn.getCard16(pt,xt),Pt,kt;if(It!==0){var Yt=Mn.getByte(pt,xt+2);Pt=xt+(It+1)*Yt+2;for(var un=xt+3,an=0;an<It+1;an+=1)Ct.push(Mn.getOffset(pt,un,Yt)),un+=Yt;kt=Pt+Ct[It]}else kt=xt+2;return{offsets:Ct,startOffset:xt,endOffset:kt}}function on(pt,xt,Ct,It,Pt){var kt=Mn.getCard16(Ct,It),Yt=0;if(kt!==0){var un=Mn.getByte(Ct,It+2);Yt=It+(kt+1)*un+2}var an=Mn.getBytes(Ct,Yt+xt[pt],Yt+xt[pt+1]);return Pt&&(an=Pt(an)),an}function dn(pt){for(var xt="",Ct=15,It=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Pt=pt.parseByte(),kt=Pt>>4,Yt=Pt&15;if(kt===Ct||(xt+=It[kt],Yt===Ct))break;xt+=It[Yt]}return parseFloat(xt)}function Vn(pt,xt){var Ct,It,Pt,kt;if(xt===28)return Ct=pt.parseByte(),It=pt.parseByte(),Ct<<8|It;if(xt===29)return Ct=pt.parseByte(),It=pt.parseByte(),Pt=pt.parseByte(),kt=pt.parseByte(),Ct<<24|It<<16|Pt<<8|kt;if(xt===30)return dn(pt);if(xt>=32&&xt<=246)return xt-139;if(xt>=247&&xt<=250)return Ct=pt.parseByte(),(xt-247)*256+Ct+108;if(xt>=251&&xt<=254)return Ct=pt.parseByte(),-(xt-251)*256-Ct-108;throw new Error("Invalid b0 "+xt)}function Kn(pt){for(var xt={},Ct=0;Ct<pt.length;Ct+=1){var It=pt[Ct][0],Pt=pt[Ct][1],kt=void 0;if(Pt.length===1?kt=Pt[0]:kt=Pt,xt.hasOwnProperty(It)&&!isNaN(xt[It]))throw new Error("Object "+xt+" already has key "+It);xt[It]=kt}return xt}function sr(pt,xt,Ct){xt=xt!==void 0?xt:0;var It=new Mn.Parser(pt,xt),Pt=[],kt=[];for(Ct=Ct!==void 0?Ct:pt.length;It.relativeOffset<Ct;){var Yt=It.parseByte();Yt<=21?(Yt===12&&(Yt=1200+It.parseByte()),Pt.push([Yt,kt]),kt=[]):kt.push(Vn(It,Yt))}return Kn(Pt)}function ar(pt,xt){return xt<=390?xt=Gn[xt]:xt=pt[xt-391],xt}function cr(pt,xt,Ct){for(var It={},Pt,kt=0;kt<xt.length;kt+=1){var Yt=xt[kt];if(Array.isArray(Yt.type)){var un=[];un.length=Yt.type.length;for(var an=0;an<Yt.type.length;an++)Pt=pt[Yt.op]!==void 0?pt[Yt.op][an]:void 0,Pt===void 0&&(Pt=Yt.value!==void 0&&Yt.value[an]!==void 0?Yt.value[an]:null),Yt.type[an]==="SID"&&(Pt=ar(Ct,Pt)),un[an]=Pt;It[Yt.name]=un}else Pt=pt[Yt.op],Pt===void 0&&(Pt=Yt.value!==void 0?Yt.value:null),Yt.type==="SID"&&(Pt=ar(Ct,Pt)),It[Yt.name]=Pt}return It}function ur(pt,xt){var Ct={};return Ct.formatMajor=Mn.getCard8(pt,xt),Ct.formatMinor=Mn.getCard8(pt,xt+1),Ct.size=Mn.getCard8(pt,xt+2),Ct.offsetSize=Mn.getCard8(pt,xt+3),Ct.startOffset=xt,Ct.endOffset=xt+4,Ct}var wr=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Mr=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Rr(pt,xt){var Ct=sr(pt,0,pt.byteLength);return cr(Ct,wr,xt)}function cs(pt,xt,Ct,It){var Pt=sr(pt,xt,Ct);return cr(Pt,Mr,It)}function ps(pt,xt,Ct,It){for(var Pt=[],kt=0;kt<Ct.length;kt+=1){var Yt=new DataView(new Uint8Array(Ct[kt]).buffer),un=Rr(Yt,It);un._subrs=[],un._subrsBias=0,un._defaultWidthX=0,un._nominalWidthX=0;var an=un.private[0],jn=un.private[1];if(an!==0&&jn!==0){var Wn=cs(pt,jn+xt,an,It);if(un._defaultWidthX=Wn.defaultWidthX,un._nominalWidthX=Wn.nominalWidthX,Wn.subrs!==0){var lr=jn+Wn.subrs,Yn=Gt(pt,lr+xt);un._subrs=Yn.objects,un._subrsBias=Kt(un._subrs)}un._privateDict=Wn}Pt.push(un)}return Pt}function us(pt,xt,Ct,It){var Pt,kt,Yt=new Mn.Parser(pt,xt);Ct-=1;var un=[".notdef"],an=Yt.parseCard8();if(an===0)for(var jn=0;jn<Ct;jn+=1)Pt=Yt.parseSID(),un.push(ar(It,Pt));else if(an===1)for(;un.length<=Ct;){Pt=Yt.parseSID(),kt=Yt.parseCard8();for(var Wn=0;Wn<=kt;Wn+=1)un.push(ar(It,Pt)),Pt+=1}else if(an===2)for(;un.length<=Ct;){Pt=Yt.parseSID(),kt=Yt.parseCard16();for(var lr=0;lr<=kt;lr+=1)un.push(ar(It,Pt)),Pt+=1}else throw new Error("Unknown charset format "+an);return un}function Kr(pt,xt,Ct){var It,Pt={},kt=new Mn.Parser(pt,xt),Yt=kt.parseCard8();if(Yt===0)for(var un=kt.parseCard8(),an=0;an<un;an+=1)It=kt.parseCard8(),Pt[It]=an;else if(Yt===1){var jn=kt.parseCard8();It=1;for(var Wn=0;Wn<jn;Wn+=1)for(var lr=kt.parseCard8(),Yn=kt.parseCard8(),hr=lr;hr<=lr+Yn;hr+=1)Pt[hr]=It,It+=1}else throw new Error("Unknown encoding format "+Yt);return new es(Pt,Ct)}function As(pt,xt,Ct){var It,Pt,kt,Yt,un=new Ut,an=[],jn=0,Wn=!1,lr=!1,Yn=0,hr=0,Lr,jr,Xr,Wr;if(pt.isCIDFont){var bs=pt.tables.cff.topDict._fdSelect[xt.index],kr=pt.tables.cff.topDict._fdArray[bs];Lr=kr._subrs,jr=kr._subrsBias,Xr=kr._defaultWidthX,Wr=kr._nominalWidthX}else Lr=pt.tables.cff.topDict._subrs,jr=pt.tables.cff.topDict._subrsBias,Xr=pt.tables.cff.topDict._defaultWidthX,Wr=pt.tables.cff.topDict._nominalWidthX;var Zs=Xr;function Is(hs,bo){lr&&un.closePath(),un.moveTo(hs,bo),lr=!0}function fo(){var hs;hs=an.length%2!==0,hs&&!Wn&&(Zs=an.shift()+Wr),jn+=an.length>>1,an.length=0,Wn=!0}function Rs(hs){for(var bo,Zo,lo,Tl,Xl,oo,go,no,Qs,_o,Io,ss,po=0;po<hs.length;){var zo=hs[po];switch(po+=1,zo){case 1:fo();break;case 3:fo();break;case 4:an.length>1&&!Wn&&(Zs=an.shift()+Wr,Wn=!0),hr+=an.pop(),Is(Yn,hr);break;case 5:for(;an.length>0;)Yn+=an.shift(),hr+=an.shift(),un.lineTo(Yn,hr);break;case 6:for(;an.length>0&&(Yn+=an.shift(),un.lineTo(Yn,hr),an.length!==0);)hr+=an.shift(),un.lineTo(Yn,hr);break;case 7:for(;an.length>0&&(hr+=an.shift(),un.lineTo(Yn,hr),an.length!==0);)Yn+=an.shift(),un.lineTo(Yn,hr);break;case 8:for(;an.length>0;)It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt+an.shift(),un.curveTo(It,Pt,kt,Yt,Yn,hr);break;case 10:Xl=an.pop()+jr,oo=Lr[Xl],oo&&Rs(oo);break;case 11:return;case 12:switch(zo=hs[po],po+=1,zo){case 35:It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),go=kt+an.shift(),no=Yt+an.shift(),Qs=go+an.shift(),_o=no+an.shift(),Io=Qs+an.shift(),ss=_o+an.shift(),Yn=Io+an.shift(),hr=ss+an.shift(),an.shift(),un.curveTo(It,Pt,kt,Yt,go,no),un.curveTo(Qs,_o,Io,ss,Yn,hr);break;case 34:It=Yn+an.shift(),Pt=hr,kt=It+an.shift(),Yt=Pt+an.shift(),go=kt+an.shift(),no=Yt,Qs=go+an.shift(),_o=Yt,Io=Qs+an.shift(),ss=hr,Yn=Io+an.shift(),un.curveTo(It,Pt,kt,Yt,go,no),un.curveTo(Qs,_o,Io,ss,Yn,hr);break;case 36:It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),go=kt+an.shift(),no=Yt,Qs=go+an.shift(),_o=Yt,Io=Qs+an.shift(),ss=_o+an.shift(),Yn=Io+an.shift(),un.curveTo(It,Pt,kt,Yt,go,no),un.curveTo(Qs,_o,Io,ss,Yn,hr);break;case 37:It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),go=kt+an.shift(),no=Yt+an.shift(),Qs=go+an.shift(),_o=no+an.shift(),Io=Qs+an.shift(),ss=_o+an.shift(),Math.abs(Io-Yn)>Math.abs(ss-hr)?Yn=Io+an.shift():hr=ss+an.shift(),un.curveTo(It,Pt,kt,Yt,go,no),un.curveTo(Qs,_o,Io,ss,Yn,hr);break;default:console.log("Glyph "+xt.index+": unknown operator 1200"+zo),an.length=0}break;case 14:an.length>0&&!Wn&&(Zs=an.shift()+Wr,Wn=!0),lr&&(un.closePath(),lr=!1);break;case 18:fo();break;case 19:case 20:fo(),po+=jn+7>>3;break;case 21:an.length>2&&!Wn&&(Zs=an.shift()+Wr,Wn=!0),hr+=an.pop(),Yn+=an.pop(),Is(Yn,hr);break;case 22:an.length>1&&!Wn&&(Zs=an.shift()+Wr,Wn=!0),Yn+=an.pop(),Is(Yn,hr);break;case 23:fo();break;case 24:for(;an.length>2;)It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt+an.shift(),un.curveTo(It,Pt,kt,Yt,Yn,hr);Yn+=an.shift(),hr+=an.shift(),un.lineTo(Yn,hr);break;case 25:for(;an.length>6;)Yn+=an.shift(),hr+=an.shift(),un.lineTo(Yn,hr);It=Yn+an.shift(),Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt+an.shift(),un.curveTo(It,Pt,kt,Yt,Yn,hr);break;case 26:for(an.length%2&&(Yn+=an.shift());an.length>0;)It=Yn,Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt,hr=Yt+an.shift(),un.curveTo(It,Pt,kt,Yt,Yn,hr);break;case 27:for(an.length%2&&(hr+=an.shift());an.length>0;)It=Yn+an.shift(),Pt=hr,kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt,un.curveTo(It,Pt,kt,Yt,Yn,hr);break;case 28:bo=hs[po],Zo=hs[po+1],an.push((bo<<24|Zo<<16)>>16),po+=2;break;case 29:Xl=an.pop()+pt.gsubrsBias,oo=pt.gsubrs[Xl],oo&&Rs(oo);break;case 30:for(;an.length>0&&(It=Yn,Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt+(an.length===1?an.shift():0),un.curveTo(It,Pt,kt,Yt,Yn,hr),an.length!==0);)It=Yn+an.shift(),Pt=hr,kt=It+an.shift(),Yt=Pt+an.shift(),hr=Yt+an.shift(),Yn=kt+(an.length===1?an.shift():0),un.curveTo(It,Pt,kt,Yt,Yn,hr);break;case 31:for(;an.length>0&&(It=Yn+an.shift(),Pt=hr,kt=It+an.shift(),Yt=Pt+an.shift(),hr=Yt+an.shift(),Yn=kt+(an.length===1?an.shift():0),un.curveTo(It,Pt,kt,Yt,Yn,hr),an.length!==0);)It=Yn,Pt=hr+an.shift(),kt=It+an.shift(),Yt=Pt+an.shift(),Yn=kt+an.shift(),hr=Yt+(an.length===1?an.shift():0),un.curveTo(It,Pt,kt,Yt,Yn,hr);break;default:zo<32?console.log("Glyph "+xt.index+": unknown operator "+zo):zo<247?an.push(zo-139):zo<251?(bo=hs[po],po+=1,an.push((zo-247)*256+bo+108)):zo<255?(bo=hs[po],po+=1,an.push(-(zo-251)*256-bo-108)):(bo=hs[po],Zo=hs[po+1],lo=hs[po+2],Tl=hs[po+3],po+=4,an.push((bo<<24|Zo<<16|lo<<8|Tl)/65536))}}}return Rs(Ct),xt.advanceWidth=Zs,un}function ts(pt,xt,Ct,It){var Pt=[],kt,Yt=new Mn.Parser(pt,xt),un=Yt.parseCard8();if(un===0)for(var an=0;an<Ct;an++){if(kt=Yt.parseCard8(),kt>=It)throw new Error("CFF table CID Font FDSelect has bad FD index value "+kt+" (FD count "+It+")");Pt.push(kt)}else if(un===3){var jn=Yt.parseCard16(),Wn=Yt.parseCard16();if(Wn!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+Wn);for(var lr,Yn=0;Yn<jn;Yn++){if(kt=Yt.parseCard8(),lr=Yt.parseCard16(),kt>=It)throw new Error("CFF table CID Font FDSelect has bad FD index value "+kt+" (FD count "+It+")");if(lr>Ct)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+lr);for(;Wn<lr;Wn++)Pt.push(kt);Wn=lr}if(lr!==Ct)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+lr)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+un);return Pt}function Ts(pt,xt,Ct,It){Ct.tables.cff={};var Pt=ur(pt,xt),kt=Gt(pt,Pt.endOffset,Mn.bytesToString),Yt=Gt(pt,kt.endOffset),un=Gt(pt,Yt.endOffset,Mn.bytesToString),an=Gt(pt,un.endOffset);Ct.gsubrs=an.objects,Ct.gsubrsBias=Kt(Ct.gsubrs);var jn=ps(pt,xt,Yt.objects,un.objects);if(jn.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+jn.length);var Wn=jn[0];if(Ct.tables.cff.topDict=Wn,Wn._privateDict&&(Ct.defaultWidthX=Wn._privateDict.defaultWidthX,Ct.nominalWidthX=Wn._privateDict.nominalWidthX),Wn.ros[0]!==void 0&&Wn.ros[1]!==void 0&&(Ct.isCIDFont=!0),Ct.isCIDFont){var lr=Wn.fdArray,Yn=Wn.fdSelect;if(lr===0||Yn===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");lr+=xt;var hr=Gt(pt,lr),Lr=ps(pt,xt,hr.objects,un.objects);Wn._fdArray=Lr,Yn+=xt,Wn._fdSelect=ts(pt,Yn,Ct.numGlyphs,Lr.length)}var jr=xt+Wn.private[1],Xr=cs(pt,jr,Wn.private[0],un.objects);if(Ct.defaultWidthX=Xr.defaultWidthX,Ct.nominalWidthX=Xr.nominalWidthX,Xr.subrs!==0){var Wr=jr+Xr.subrs,bs=Gt(pt,Wr);Ct.subrs=bs.objects,Ct.subrsBias=Kt(Ct.subrs)}else Ct.subrs=[],Ct.subrsBias=0;var kr;It.lowMemory?(kr=zt(pt,xt+Wn.charStrings),Ct.nGlyphs=kr.offsets.length):(kr=Gt(pt,xt+Wn.charStrings),Ct.nGlyphs=kr.objects.length);var Zs=us(pt,xt+Wn.charset,Ct.nGlyphs,un.objects);if(Wn.encoding===0?Ct.cffEncoding=new es(Zn,Zs):Wn.encoding===1?Ct.cffEncoding=new es(qn,Zs):Ct.cffEncoding=Kr(pt,xt+Wn.encoding,Zs),Ct.encoding=Ct.encoding||Ct.cffEncoding,Ct.glyphs=new js.GlyphSet(Ct),It.lowMemory)Ct._push=function(Rs){var hs=on(Rs,kr.offsets,pt,xt+Wn.charStrings);Ct.glyphs.push(Rs,js.cffGlyphLoader(Ct,Rs,As,hs))};else for(var Is=0;Is<Ct.nGlyphs;Is+=1){var fo=kr.objects[Is];Ct.glyphs.push(Is,js.cffGlyphLoader(Ct,Is,As,fo))}}function Us(pt,xt){var Ct,It=Gn.indexOf(pt);return It>=0&&(Ct=It),It=xt.indexOf(pt),It>=0?Ct=It+Gn.length:(Ct=Gn.length+xt.length,xt.push(pt)),Ct}function Ss(){return new Qn.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function $s(pt){var xt=new Qn.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);xt.names=[];for(var Ct=0;Ct<pt.length;Ct+=1)xt.names.push({name:"name_"+Ct,type:"NAME",value:pt[Ct]});return xt}function Hs(pt,xt,Ct){for(var It={},Pt=0;Pt<pt.length;Pt+=1){var kt=pt[Pt],Yt=xt[kt.name];Yt!==void 0&&!pn(Yt,kt.value)&&(kt.type==="SID"&&(Yt=Us(Yt,Ct)),It[kt.op]={name:kt.name,type:kt.type,value:Yt})}return It}function Ys(pt,xt){var Ct=new Qn.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Ct.dict=Hs(wr,pt,xt),Ct}function co(pt){var xt=new Qn.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return xt.topDicts=[{name:"topDict_0",type:"TABLE",value:pt}],xt}function Cs(pt){var xt=new Qn.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);xt.strings=[];for(var Ct=0;Ct<pt.length;Ct+=1)xt.strings.push({name:"string_"+Ct,type:"STRING",value:pt[Ct]});return xt}function Ps(){return new Qn.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function Ns(pt,xt){for(var Ct=new Qn.Record("Charsets",[{name:"format",type:"Card8",value:0}]),It=0;It<pt.length;It+=1){var Pt=pt[It],kt=Us(Pt,xt);Ct.fields.push({name:"glyph_"+It,type:"SID",value:kt})}return Ct}function Gs(pt){var xt=[],Ct=pt.path;xt.push({name:"width",type:"NUMBER",value:pt.advanceWidth});for(var It=0,Pt=0,kt=0;kt<Ct.commands.length;kt+=1){var Yt=void 0,un=void 0,an=Ct.commands[kt];if(an.type==="Q"){var jn=.3333333333333333,Wn=2/3;an={type:"C",x:an.x,y:an.y,x1:Math.round(jn*It+Wn*an.x1),y1:Math.round(jn*Pt+Wn*an.y1),x2:Math.round(jn*an.x+Wn*an.x1),y2:Math.round(jn*an.y+Wn*an.y1)}}if(an.type==="M")Yt=Math.round(an.x-It),un=Math.round(an.y-Pt),xt.push({name:"dx",type:"NUMBER",value:Yt}),xt.push({name:"dy",type:"NUMBER",value:un}),xt.push({name:"rmoveto",type:"OP",value:21}),It=Math.round(an.x),Pt=Math.round(an.y);else if(an.type==="L")Yt=Math.round(an.x-It),un=Math.round(an.y-Pt),xt.push({name:"dx",type:"NUMBER",value:Yt}),xt.push({name:"dy",type:"NUMBER",value:un}),xt.push({name:"rlineto",type:"OP",value:5}),It=Math.round(an.x),Pt=Math.round(an.y);else if(an.type==="C"){var lr=Math.round(an.x1-It),Yn=Math.round(an.y1-Pt),hr=Math.round(an.x2-an.x1),Lr=Math.round(an.y2-an.y1);Yt=Math.round(an.x-an.x2),un=Math.round(an.y-an.y2),xt.push({name:"dx1",type:"NUMBER",value:lr}),xt.push({name:"dy1",type:"NUMBER",value:Yn}),xt.push({name:"dx2",type:"NUMBER",value:hr}),xt.push({name:"dy2",type:"NUMBER",value:Lr}),xt.push({name:"dx",type:"NUMBER",value:Yt}),xt.push({name:"dy",type:"NUMBER",value:un}),xt.push({name:"rrcurveto",type:"OP",value:8}),It=Math.round(an.x),Pt=Math.round(an.y)}}return xt.push({name:"endchar",type:"OP",value:14}),xt}function ro(pt){for(var xt=new Qn.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),Ct=0;Ct<pt.length;Ct+=1){var It=pt.get(Ct),Pt=Gs(It);xt.charStrings.push({name:It.name,type:"CHARSTRING",value:Pt})}return xt}function Gl(pt,xt){var Ct=new Qn.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return Ct.dict=Hs(Mr,pt,xt),Ct}function Bo(pt,xt){for(var Ct=new Qn.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),It=1/xt.unitsPerEm,Pt={version:xt.version,fullName:xt.fullName,familyName:xt.familyName,weight:xt.weightName,fontBBox:xt.fontBBox||[0,0,0,0],fontMatrix:[It,0,0,It,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},kt={},Yt=[],un,an=1;an<pt.length;an+=1)un=pt.get(an),Yt.push(un.name);var jn=[];Ct.header=Ss(),Ct.nameIndex=$s([xt.postScriptName]);var Wn=Ys(Pt,jn);Ct.topDictIndex=co(Wn),Ct.globalSubrIndex=Ps(),Ct.charsets=Ns(Yt,jn),Ct.charStringsIndex=ro(pt),Ct.privateDict=Gl(kt,jn),Ct.stringIndex=Cs(jn);var lr=Ct.header.sizeOf()+Ct.nameIndex.sizeOf()+Ct.topDictIndex.sizeOf()+Ct.stringIndex.sizeOf()+Ct.globalSubrIndex.sizeOf();return Pt.charset=lr,Pt.encoding=0,Pt.charStrings=Pt.charset+Ct.charsets.sizeOf(),Pt.private[1]=Pt.charStrings+Ct.charStringsIndex.sizeOf(),Wn=Ys(Pt,jn),Ct.topDictIndex=co(Wn),Ct}var $o={parse:Ts,make:Bo};function Lu(pt,xt){var Ct={},It=new Mn.Parser(pt,xt);return Ct.version=It.parseVersion(),Ct.fontRevision=Math.round(It.parseFixed()*1e3)/1e3,Ct.checkSumAdjustment=It.parseULong(),Ct.magicNumber=It.parseULong(),Jt.argument(Ct.magicNumber===1594834165,"Font header has wrong magic number."),Ct.flags=It.parseUShort(),Ct.unitsPerEm=It.parseUShort(),Ct.created=It.parseLongDateTime(),Ct.modified=It.parseLongDateTime(),Ct.xMin=It.parseShort(),Ct.yMin=It.parseShort(),Ct.xMax=It.parseShort(),Ct.yMax=It.parseShort(),Ct.macStyle=It.parseUShort(),Ct.lowestRecPPEM=It.parseUShort(),Ct.fontDirectionHint=It.parseShort(),Ct.indexToLocFormat=It.parseShort(),Ct.glyphDataFormat=It.parseShort(),Ct}function _d(pt){var xt=Math.round(new Date().getTime()/1e3)+2082844800,Ct=xt;return pt.createdTimestamp&&(Ct=pt.createdTimestamp+2082844800),new Qn.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:Ct},{name:"modified",type:"LONGDATETIME",value:xt},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],pt)}var fs={parse:Lu,make:_d};function gu(pt,xt){var Ct={},It=new Mn.Parser(pt,xt);return Ct.version=It.parseVersion(),Ct.ascender=It.parseShort(),Ct.descender=It.parseShort(),Ct.lineGap=It.parseShort(),Ct.advanceWidthMax=It.parseUShort(),Ct.minLeftSideBearing=It.parseShort(),Ct.minRightSideBearing=It.parseShort(),Ct.xMaxExtent=It.parseShort(),Ct.caretSlopeRise=It.parseShort(),Ct.caretSlopeRun=It.parseShort(),Ct.caretOffset=It.parseShort(),It.relativeOffset+=8,Ct.metricDataFormat=It.parseShort(),Ct.numberOfHMetrics=It.parseUShort(),Ct}function _n(pt){return new Qn.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],pt)}var vn={parse:gu,make:_n};function Bn(pt,xt,Ct,It,Pt){for(var kt,Yt,un=new Mn.Parser(pt,xt),an=0;an<It;an+=1){an<Ct&&(kt=un.parseUShort(),Yt=un.parseShort());var jn=Pt.get(an);jn.advanceWidth=kt,jn.leftSideBearing=Yt}}function wn(pt,xt,Ct,It,Pt){pt._hmtxTableData={};for(var kt,Yt,un=new Mn.Parser(xt,Ct),an=0;an<Pt;an+=1)an<It&&(kt=un.parseUShort(),Yt=un.parseShort()),pt._hmtxTableData[an]={advanceWidth:kt,leftSideBearing:Yt}}function Fn(pt,xt,Ct,It,Pt,kt,Yt){Yt.lowMemory?wn(pt,xt,Ct,It,Pt):Bn(xt,Ct,It,Pt,kt)}function fr(pt){for(var xt=new Qn.Table("hmtx",[]),Ct=0;Ct<pt.length;Ct+=1){var It=pt.get(Ct),Pt=It.advanceWidth||0,kt=It.leftSideBearing||0;xt.fields.push({name:"advanceWidth_"+Ct,type:"USHORT",value:Pt}),xt.fields.push({name:"leftSideBearing_"+Ct,type:"SHORT",value:kt})}return xt}var Er={parse:Fn,make:fr};function Tr(pt){for(var xt=new Qn.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:pt.length}]),Ct="",It=12+pt.length*4,Pt=0;Pt<pt.length;++Pt){var kt=Ct.indexOf(pt[Pt]);kt<0&&(kt=Ct.length,Ct+=pt[Pt]),xt.fields.push({name:"offset "+Pt,type:"USHORT",value:It+kt}),xt.fields.push({name:"length "+Pt,type:"USHORT",value:pt[Pt].length})}return xt.fields.push({name:"stringPool",type:"CHARARRAY",value:Ct}),xt}function _i(pt,xt){var Ct=new Mn.Parser(pt,xt),It=Ct.parseULong();Jt.argument(It===1,"Unsupported ltag table version."),Ct.skip("uLong",1);for(var Pt=Ct.parseULong(),kt=[],Yt=0;Yt<Pt;Yt++){for(var un="",an=xt+Ct.parseUShort(),jn=Ct.parseUShort(),Wn=an;Wn<an+jn;++Wn)un+=String.fromCharCode(pt.getInt8(Wn));kt.push(un)}return kt}var Yr={make:Tr,parse:_i};function Qr(pt,xt){var Ct={},It=new Mn.Parser(pt,xt);return Ct.version=It.parseVersion(),Ct.numGlyphs=It.parseUShort(),Ct.version===1&&(Ct.maxPoints=It.parseUShort(),Ct.maxContours=It.parseUShort(),Ct.maxCompositePoints=It.parseUShort(),Ct.maxCompositeContours=It.parseUShort(),Ct.maxZones=It.parseUShort(),Ct.maxTwilightPoints=It.parseUShort(),Ct.maxStorage=It.parseUShort(),Ct.maxFunctionDefs=It.parseUShort(),Ct.maxInstructionDefs=It.parseUShort(),Ct.maxStackElements=It.parseUShort(),Ct.maxSizeOfInstructions=It.parseUShort(),Ct.maxComponentElements=It.parseUShort(),Ct.maxComponentDepth=It.parseUShort()),Ct}function Dr(pt){return new Qn.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:pt}])}var vs={parse:Qr,make:Dr},Vr=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],ms={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Zr={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},io={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Xs(pt,xt,Ct){switch(pt){case 0:if(xt===65535)return"und";if(Ct)return Ct[xt];break;case 1:return ms[xt];case 3:return io[xt]}}var Vs="utf-16",Ms={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Yl={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Ro(pt,xt,Ct){switch(pt){case 0:return Vs;case 1:return Yl[Ct]||Ms[xt];case 3:if(xt===1||xt===10)return Vs;break}}function Wo(pt,xt,Ct){for(var It={},Pt=new Mn.Parser(pt,xt),kt=Pt.parseUShort(),Yt=Pt.parseUShort(),un=Pt.offset+Pt.parseUShort(),an=0;an<Yt;an++){var jn=Pt.parseUShort(),Wn=Pt.parseUShort(),lr=Pt.parseUShort(),Yn=Pt.parseUShort(),hr=Vr[Yn]||Yn,Lr=Pt.parseUShort(),jr=Pt.parseUShort(),Xr=Xs(jn,lr,Ct),Wr=Ro(jn,Wn,lr);if(Wr!==void 0&&Xr!==void 0){var bs=void 0;if(Wr===Vs?bs=Vt.UTF16(pt,un+jr,Lr):bs=Vt.MACSTRING(pt,un+jr,Lr,Wr),bs){var kr=It[hr];kr===void 0&&(kr=It[hr]={}),kr[Xr]=bs}}}return kt===1&&Pt.parseUShort(),It}function To(pt){var xt={};for(var Ct in pt)xt[pt[Ct]]=parseInt(Ct);return xt}function Au(pt,xt,Ct,It,Pt,kt){return new Qn.Record("NameRecord",[{name:"platformID",type:"USHORT",value:pt},{name:"encodingID",type:"USHORT",value:xt},{name:"languageID",type:"USHORT",value:Ct},{name:"nameID",type:"USHORT",value:It},{name:"length",type:"USHORT",value:Pt},{name:"offset",type:"USHORT",value:kt}])}function Gm(pt,xt){var Ct=pt.length,It=xt.length-Ct+1;e:for(var Pt=0;Pt<It;Pt++)for(;Pt<It;Pt++){for(var kt=0;kt<Ct;kt++)if(xt[Pt+kt]!==pt[kt])continue e;return Pt}return-1}function xp(pt,xt){var Ct=Gm(pt,xt);if(Ct<0){Ct=xt.length;for(var It=0,Pt=pt.length;It<Pt;++It)xt.push(pt[It])}return Ct}function u1(pt,xt){var Ct,It=[],Pt={},kt=To(Vr);for(var Yt in pt){var un=kt[Yt];if(un===void 0&&(un=Yt),Ct=parseInt(un),isNaN(Ct))throw new Error('Name table entry "'+Yt+'" does not exist, see nameTableNames for complete list.');Pt[Ct]=pt[Yt],It.push(Ct)}for(var an=To(ms),jn=To(io),Wn=[],lr=[],Yn=0;Yn<It.length;Yn++){Ct=It[Yn];var hr=Pt[Ct];for(var Lr in hr){var jr=hr[Lr],Xr=1,Wr=an[Lr],bs=Zr[Wr],kr=Ro(Xr,bs,Wr),Zs=Lt.MACSTRING(jr,kr);Zs===void 0&&(Xr=0,Wr=xt.indexOf(Lr),Wr<0&&(Wr=xt.length,xt.push(Lr)),bs=4,Zs=Lt.UTF16(jr));var Is=xp(Zs,lr);Wn.push(Au(Xr,bs,Wr,Ct,Zs.length,Is));var fo=jn[Lr];if(fo!==void 0){var Rs=Lt.UTF16(jr),hs=xp(Rs,lr);Wn.push(Au(3,1,fo,Ct,Rs.length,hs))}}}Wn.sort(function(lo,Tl){return lo.platformID-Tl.platformID||lo.encodingID-Tl.encodingID||lo.languageID-Tl.languageID||lo.nameID-Tl.nameID});for(var bo=new Qn.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:Wn.length},{name:"stringOffset",type:"USHORT",value:6+Wn.length*12}]),Zo=0;Zo<Wn.length;Zo++)bo.fields.push({name:"record_"+Zo,type:"RECORD",value:Wn[Zo]});return bo.fields.push({name:"strings",type:"LITERAL",value:lr}),bo}var Jl={parse:Wo,make:u1},Jp=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function Ep(pt){for(var xt=0;xt<Jp.length;xt+=1){var Ct=Jp[xt];if(pt>=Ct.begin&&pt<Ct.end)return xt}return-1}function h1(pt,xt){var Ct={},It=new Mn.Parser(pt,xt);Ct.version=It.parseUShort(),Ct.xAvgCharWidth=It.parseShort(),Ct.usWeightClass=It.parseUShort(),Ct.usWidthClass=It.parseUShort(),Ct.fsType=It.parseUShort(),Ct.ySubscriptXSize=It.parseShort(),Ct.ySubscriptYSize=It.parseShort(),Ct.ySubscriptXOffset=It.parseShort(),Ct.ySubscriptYOffset=It.parseShort(),Ct.ySuperscriptXSize=It.parseShort(),Ct.ySuperscriptYSize=It.parseShort(),Ct.ySuperscriptXOffset=It.parseShort(),Ct.ySuperscriptYOffset=It.parseShort(),Ct.yStrikeoutSize=It.parseShort(),Ct.yStrikeoutPosition=It.parseShort(),Ct.sFamilyClass=It.parseShort(),Ct.panose=[];for(var Pt=0;Pt<10;Pt++)Ct.panose[Pt]=It.parseByte();return Ct.ulUnicodeRange1=It.parseULong(),Ct.ulUnicodeRange2=It.parseULong(),Ct.ulUnicodeRange3=It.parseULong(),Ct.ulUnicodeRange4=It.parseULong(),Ct.achVendID=String.fromCharCode(It.parseByte(),It.parseByte(),It.parseByte(),It.parseByte()),Ct.fsSelection=It.parseUShort(),Ct.usFirstCharIndex=It.parseUShort(),Ct.usLastCharIndex=It.parseUShort(),Ct.sTypoAscender=It.parseShort(),Ct.sTypoDescender=It.parseShort(),Ct.sTypoLineGap=It.parseShort(),Ct.usWinAscent=It.parseUShort(),Ct.usWinDescent=It.parseUShort(),Ct.version>=1&&(Ct.ulCodePageRange1=It.parseULong(),Ct.ulCodePageRange2=It.parseULong()),Ct.version>=2&&(Ct.sxHeight=It.parseShort(),Ct.sCapHeight=It.parseShort(),Ct.usDefaultChar=It.parseUShort(),Ct.usBreakChar=It.parseUShort(),Ct.usMaxContent=It.parseUShort()),Ct}function Zl(pt){return new Qn.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],pt)}var ep={parse:h1,make:Zl,unicodeRanges:Jp,getUnicodeRange:Ep};function Zp(pt,xt){var Ct={},It=new Mn.Parser(pt,xt);switch(Ct.version=It.parseVersion(),Ct.italicAngle=It.parseFixed(),Ct.underlinePosition=It.parseShort(),Ct.underlineThickness=It.parseShort(),Ct.isFixedPitch=It.parseULong(),Ct.minMemType42=It.parseULong(),Ct.maxMemType42=It.parseULong(),Ct.minMemType1=It.parseULong(),Ct.maxMemType1=It.parseULong(),Ct.version){case 1:Ct.names=vr.slice();break;case 2:Ct.numberOfGlyphs=It.parseUShort(),Ct.glyphNameIndex=new Array(Ct.numberOfGlyphs);for(var Pt=0;Pt<Ct.numberOfGlyphs;Pt++)Ct.glyphNameIndex[Pt]=It.parseUShort();Ct.names=[];for(var kt=0;kt<Ct.numberOfGlyphs;kt++)if(Ct.glyphNameIndex[kt]>=vr.length){var Yt=It.parseChar();Ct.names.push(It.parseString(Yt))}break;case 2.5:Ct.numberOfGlyphs=It.parseUShort(),Ct.offset=new Array(Ct.numberOfGlyphs);for(var un=0;un<Ct.numberOfGlyphs;un++)Ct.offset[un]=It.parseChar();break}return Ct}function ku(){return new Qn.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var Xo={parse:Zp,make:ku},Rl=new Array(9);Rl[1]=function(){var xt=this.offset+this.relativeOffset,Ct=this.parseUShort();if(Ct===1)return{substFormat:1,coverage:this.parsePointer(yn.coverage),deltaGlyphId:this.parseUShort()};if(Ct===2)return{substFormat:2,coverage:this.parsePointer(yn.coverage),substitute:this.parseOffset16List()};Jt.assert(!1,"0x"+xt.toString(16)+": lookup type 1 format must be 1 or 2.")},Rl[2]=function(){var xt=this.parseUShort();return Jt.argument(xt===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:xt,coverage:this.parsePointer(yn.coverage),sequences:this.parseListOfLists()}},Rl[3]=function(){var xt=this.parseUShort();return Jt.argument(xt===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:xt,coverage:this.parsePointer(yn.coverage),alternateSets:this.parseListOfLists()}},Rl[4]=function(){var xt=this.parseUShort();return Jt.argument(xt===1,"GSUB ligature table identifier-format must be 1"),{substFormat:xt,coverage:this.parsePointer(yn.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var Nu={sequenceIndex:yn.uShort,lookupListIndex:yn.uShort};Rl[5]=function(){var xt=this.offset+this.relativeOffset,Ct=this.parseUShort();if(Ct===1)return{substFormat:Ct,coverage:this.parsePointer(yn.coverage),ruleSets:this.parseListOfLists(function(){var kt=this.parseUShort(),Yt=this.parseUShort();return{input:this.parseUShortList(kt-1),lookupRecords:this.parseRecordList(Yt,Nu)}})};if(Ct===2)return{substFormat:Ct,coverage:this.parsePointer(yn.coverage),classDef:this.parsePointer(yn.classDef),classSets:this.parseListOfLists(function(){var kt=this.parseUShort(),Yt=this.parseUShort();return{classes:this.parseUShortList(kt-1),lookupRecords:this.parseRecordList(Yt,Nu)}})};if(Ct===3){var It=this.parseUShort(),Pt=this.parseUShort();return{substFormat:Ct,coverages:this.parseList(It,yn.pointer(yn.coverage)),lookupRecords:this.parseRecordList(Pt,Nu)}}Jt.assert(!1,"0x"+xt.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Rl[6]=function(){var xt=this.offset+this.relativeOffset,Ct=this.parseUShort();if(Ct===1)return{substFormat:1,coverage:this.parsePointer(yn.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Nu)}})};if(Ct===2)return{substFormat:2,coverage:this.parsePointer(yn.coverage),backtrackClassDef:this.parsePointer(yn.classDef),inputClassDef:this.parsePointer(yn.classDef),lookaheadClassDef:this.parsePointer(yn.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Nu)}})};if(Ct===3)return{substFormat:3,backtrackCoverage:this.parseList(yn.pointer(yn.coverage)),inputCoverage:this.parseList(yn.pointer(yn.coverage)),lookaheadCoverage:this.parseList(yn.pointer(yn.coverage)),lookupRecords:this.parseRecordList(Nu)};Jt.assert(!1,"0x"+xt.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Rl[7]=function(){var xt=this.parseUShort();Jt.argument(xt===1,"GSUB Extension Substitution subtable identifier-format must be 1");var Ct=this.parseUShort(),It=new yn(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:Ct,extension:Rl[Ct].call(It)}},Rl[8]=function(){var xt=this.parseUShort();return Jt.argument(xt===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:xt,coverage:this.parsePointer(yn.coverage),backtrackCoverage:this.parseList(yn.pointer(yn.coverage)),lookaheadCoverage:this.parseList(yn.pointer(yn.coverage)),substitutes:this.parseUShortList()}};function Vm(pt,xt){xt=xt||0;var Ct=new yn(pt,xt),It=Ct.parseVersion(1);return Jt.argument(It===1||It===1.1,"Unsupported GSUB table version."),It===1?{version:It,scripts:Ct.parseScriptList(),features:Ct.parseFeatureList(),lookups:Ct.parseLookupList(Rl)}:{version:It,scripts:Ct.parseScriptList(),features:Ct.parseFeatureList(),lookups:Ct.parseLookupList(Rl),variations:Ct.parseFeatureVariationsList()}}var Mo=new Array(9);Mo[1]=function(xt){return xt.substFormat===1?new Qn.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)},{name:"deltaGlyphID",type:"USHORT",value:xt.deltaGlyphId}]):new Qn.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)}].concat(Qn.ushortList("substitute",xt.substitute)))},Mo[2]=function(xt){return Jt.assert(xt.substFormat===1,"Lookup type 2 substFormat must be 1."),new Qn.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)}].concat(Qn.tableList("seqSet",xt.sequences,function(Ct){return new Qn.Table("sequenceSetTable",Qn.ushortList("sequence",Ct))})))},Mo[3]=function(xt){return Jt.assert(xt.substFormat===1,"Lookup type 3 substFormat must be 1."),new Qn.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)}].concat(Qn.tableList("altSet",xt.alternateSets,function(Ct){return new Qn.Table("alternateSetTable",Qn.ushortList("alternate",Ct))})))},Mo[4]=function(xt){return Jt.assert(xt.substFormat===1,"Lookup type 4 substFormat must be 1."),new Qn.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)}].concat(Qn.tableList("ligSet",xt.ligatureSets,function(Ct){return new Qn.Table("ligatureSetTable",Qn.tableList("ligature",Ct,function(It){return new Qn.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:It.ligGlyph}].concat(Qn.ushortList("component",It.components,It.components.length+1)))}))})))},Mo[6]=function(xt){if(xt.substFormat===1){var Ct=new Qn.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:xt.substFormat},{name:"coverage",type:"TABLE",value:new Qn.Coverage(xt.coverage)}].concat(Qn.tableList("chainRuleSet",xt.chainRuleSets,function(kt){return new Qn.Table("chainRuleSetTable",Qn.tableList("chainRule",kt,function(Yt){var un=Qn.ushortList("backtrackGlyph",Yt.backtrack,Yt.backtrack.length).concat(Qn.ushortList("inputGlyph",Yt.input,Yt.input.length+1)).concat(Qn.ushortList("lookaheadGlyph",Yt.lookahead,Yt.lookahead.length)).concat(Qn.ushortList("substitution",[],Yt.lookupRecords.length));return Yt.lookupRecords.forEach(function(an,jn){un=un.concat({name:"sequenceIndex"+jn,type:"USHORT",value:an.sequenceIndex}).concat({name:"lookupListIndex"+jn,type:"USHORT",value:an.lookupListIndex})}),new Qn.Table("chainRuleTable",un)}))})));return Ct}else if(xt.substFormat===2)Jt.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(xt.substFormat===3){var It=[{name:"substFormat",type:"USHORT",value:xt.substFormat}];It.push({name:"backtrackGlyphCount",type:"USHORT",value:xt.backtrackCoverage.length}),xt.backtrackCoverage.forEach(function(kt,Yt){It.push({name:"backtrackCoverage"+Yt,type:"TABLE",value:new Qn.Coverage(kt)})}),It.push({name:"inputGlyphCount",type:"USHORT",value:xt.inputCoverage.length}),xt.inputCoverage.forEach(function(kt,Yt){It.push({name:"inputCoverage"+Yt,type:"TABLE",value:new Qn.Coverage(kt)})}),It.push({name:"lookaheadGlyphCount",type:"USHORT",value:xt.lookaheadCoverage.length}),xt.lookaheadCoverage.forEach(function(kt,Yt){It.push({name:"lookaheadCoverage"+Yt,type:"TABLE",value:new Qn.Coverage(kt)})}),It.push({name:"substitutionCount",type:"USHORT",value:xt.lookupRecords.length}),xt.lookupRecords.forEach(function(kt,Yt){It=It.concat({name:"sequenceIndex"+Yt,type:"USHORT",value:kt.sequenceIndex}).concat({name:"lookupListIndex"+Yt,type:"USHORT",value:kt.lookupListIndex})});var Pt=new Qn.Table("chainContextTable",It);return Pt}Jt.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function tp(pt){return new Qn.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Qn.ScriptList(pt.scripts)},{name:"features",type:"TABLE",value:new Qn.FeatureList(pt.features)},{name:"lookups",type:"TABLE",value:new Qn.LookupList(pt.lookups,Mo)}])}var Fl={parse:Vm,make:tp};function su(pt,xt){var Ct=new Mn.Parser(pt,xt),It=Ct.parseULong();Jt.argument(It===1,"Unsupported META table version."),Ct.parseULong(),Ct.parseULong();for(var Pt=Ct.parseULong(),kt={},Yt=0;Yt<Pt;Yt++){var un=Ct.parseTag(),an=Ct.parseULong(),jn=Ct.parseULong(),Wn=Vt.UTF8(pt,xt+an,jn);kt[un]=Wn}return kt}function Tu(pt){var xt=Object.keys(pt).length,Ct="",It=16+xt*12,Pt=new Qn.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:It},{name:"numTags",type:"ULONG",value:xt}]);for(var kt in pt){var Yt=Ct.length;Ct+=pt[kt],Pt.fields.push({name:"tag "+kt,type:"TAG",value:kt}),Pt.fields.push({name:"offset "+kt,type:"ULONG",value:It+Yt}),Pt.fields.push({name:"length "+kt,type:"ULONG",value:pt[kt].length})}return Pt.fields.push({name:"stringPool",type:"CHARARRAY",value:Ct}),Pt}var Du={parse:su,make:Tu};function zm(pt){return Math.log(pt)/Math.log(2)|0}function _c(pt){for(;pt.length%4!==0;)pt.push(0);for(var xt=0,Ct=0;Ct<pt.length;Ct+=4)xt+=(pt[Ct]<<24)+(pt[Ct+1]<<16)+(pt[Ct+2]<<8)+pt[Ct+3];return xt%=Math.pow(2,32),xt}function eu(pt,xt,Ct,It){return new Qn.Record("Table Record",[{name:"tag",type:"TAG",value:pt!==void 0?pt:""},{name:"checkSum",type:"ULONG",value:xt!==void 0?xt:0},{name:"offset",type:"ULONG",value:Ct!==void 0?Ct:0},{name:"length",type:"ULONG",value:It!==void 0?It:0}])}function Sp(pt){var xt=new Qn.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);xt.tables=pt,xt.numTables=pt.length;var Ct=Math.pow(2,zm(xt.numTables));xt.searchRange=16*Ct,xt.entrySelector=zm(Ct),xt.rangeShift=xt.numTables*16-xt.searchRange;for(var It=[],Pt=[],kt=xt.sizeOf()+eu().sizeOf()*xt.numTables;kt%4!==0;)kt+=1,Pt.push({name:"padding",type:"BYTE",value:0});for(var Yt=0;Yt<pt.length;Yt+=1){var un=pt[Yt];Jt.argument(un.tableName.length===4,"Table name"+un.tableName+" is invalid.");var an=un.sizeOf(),jn=eu(un.tableName,_c(un.encode()),kt,an);for(It.push({name:jn.tag+" Table Record",type:"RECORD",value:jn}),Pt.push({name:un.tableName+" table",type:"RECORD",value:un}),kt+=an,Jt.argument(!isNaN(kt),"Something went wrong calculating the offset.");kt%4!==0;)kt+=1,Pt.push({name:"padding",type:"BYTE",value:0})}return It.sort(function(Wn,lr){return Wn.value.tag>lr.value.tag?1:-1}),xt.fields=xt.fields.concat(It),xt.fields=xt.fields.concat(Pt),xt}function Ou(pt,xt,Ct){for(var It=0;It<xt.length;It+=1){var Pt=pt.charToGlyphIndex(xt[It]);if(Pt>0){var kt=pt.glyphs.get(Pt);return kt.getMetrics()}}return Ct}function em(pt){for(var xt=0,Ct=0;Ct<pt.length;Ct+=1)xt+=pt[Ct];return xt/pt.length}function _0(pt){for(var xt=[],Ct=[],It=[],Pt=[],kt=[],Yt=[],un=[],an,jn=0,Wn=0,lr=0,Yn=0,hr=0,Lr=0;Lr<pt.glyphs.length;Lr+=1){var jr=pt.glyphs.get(Lr),Xr=jr.unicode|0;if(isNaN(jr.advanceWidth))throw new Error("Glyph "+jr.name+" ("+Lr+"): advanceWidth is not a number.");(an>Xr||an===void 0)&&Xr>0&&(an=Xr),jn<Xr&&(jn=Xr);var Wr=ep.getUnicodeRange(Xr);if(Wr<32)Wn|=1<<Wr;else if(Wr<64)lr|=1<<Wr-32;else if(Wr<96)Yn|=1<<Wr-64;else if(Wr<123)hr|=1<<Wr-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(jr.name!==".notdef"){var bs=jr.getMetrics();xt.push(bs.xMin),Ct.push(bs.yMin),It.push(bs.xMax),Pt.push(bs.yMax),Yt.push(bs.leftSideBearing),un.push(bs.rightSideBearing),kt.push(jr.advanceWidth)}}var kr={xMin:Math.min.apply(null,xt),yMin:Math.min.apply(null,Ct),xMax:Math.max.apply(null,It),yMax:Math.max.apply(null,Pt),advanceWidthMax:Math.max.apply(null,kt),advanceWidthAvg:em(kt),minLeftSideBearing:Math.min.apply(null,Yt),maxLeftSideBearing:Math.max.apply(null,Yt),minRightSideBearing:Math.min.apply(null,un)};kr.ascender=pt.ascender,kr.descender=pt.descender;var Zs=fs.make({flags:3,unitsPerEm:pt.unitsPerEm,xMin:kr.xMin,yMin:kr.yMin,xMax:kr.xMax,yMax:kr.yMax,lowestRecPPEM:3,createdTimestamp:pt.createdTimestamp}),Is=vn.make({ascender:kr.ascender,descender:kr.descender,advanceWidthMax:kr.advanceWidthMax,minLeftSideBearing:kr.minLeftSideBearing,minRightSideBearing:kr.minRightSideBearing,xMaxExtent:kr.maxLeftSideBearing+(kr.xMax-kr.xMin),numberOfHMetrics:pt.glyphs.length}),fo=vs.make(pt.glyphs.length),Rs=ep.make(Object.assign({xAvgCharWidth:Math.round(kr.advanceWidthAvg),usFirstCharIndex:an,usLastCharIndex:jn,ulUnicodeRange1:Wn,ulUnicodeRange2:lr,ulUnicodeRange3:Yn,ulUnicodeRange4:hr,sTypoAscender:kr.ascender,sTypoDescender:kr.descender,sTypoLineGap:0,usWinAscent:kr.yMax,usWinDescent:Math.abs(kr.yMin),ulCodePageRange1:1,sxHeight:Ou(pt,"xyvw",{yMax:Math.round(kr.ascender/2)}).yMax,sCapHeight:Ou(pt,"HIKLEFJMNTZBDPRAGOQSUVWXY",kr).yMax,usDefaultChar:pt.hasChar(" ")?32:0,usBreakChar:pt.hasChar(" ")?32:0},pt.tables.os2)),hs=Er.make(pt.glyphs),bo=pr.make(pt.glyphs),Zo=pt.getEnglishName("fontFamily"),lo=pt.getEnglishName("fontSubfamily"),Tl=Zo+" "+lo,Xl=pt.getEnglishName("postScriptName");Xl||(Xl=Zo.replace(/\s/g,"")+"-"+lo);var oo={};for(var go in pt.names)oo[go]=pt.names[go];oo.uniqueID||(oo.uniqueID={en:pt.getEnglishName("manufacturer")+":"+Tl}),oo.postScriptName||(oo.postScriptName={en:Xl}),oo.preferredFamily||(oo.preferredFamily=pt.names.fontFamily),oo.preferredSubfamily||(oo.preferredSubfamily=pt.names.fontSubfamily);var no=[],Qs=Jl.make(oo,no),_o=no.length>0?Yr.make(no):void 0,Io=Xo.make(),ss=$o.make(pt.glyphs,{version:pt.getEnglishName("version"),fullName:Tl,familyName:Zo,weightName:lo,postScriptName:Xl,unitsPerEm:pt.unitsPerEm,fontBBox:[0,kr.yMin,kr.ascender,kr.advanceWidthMax]}),po=pt.metas&&Object.keys(pt.metas).length>0?Du.make(pt.metas):void 0,zo=[Zs,Is,fo,Rs,Qs,bo,Io,ss,hs];_o&&zo.push(_o),pt.tables.gsub&&zo.push(Fl.make(pt.tables.gsub)),po&&zo.push(po);for(var Ml=Sp(zo),d0=Ml.encode(),Il=_c(d0),p0=Ml.fields,s1=!1,vt=0;vt<p0.length;vt+=1)if(p0[vt].name==="head table"){p0[vt].value.checkSumAdjustment=2981146554-Il,s1=!0;break}if(!s1)throw new Error("Could not find head table with checkSum to adjust.");return Ml}var x0={make:Sp,fontToTable:_0,computeCheckSum:_c};function bp(pt,xt){for(var Ct=0,It=pt.length-1;Ct<=It;){var Pt=Ct+It>>>1,kt=pt[Pt].tag;if(kt===xt)return Pt;kt<xt?Ct=Pt+1:It=Pt-1}return-Ct-1}function Cp(pt,xt){for(var Ct=0,It=pt.length-1;Ct<=It;){var Pt=Ct+It>>>1,kt=pt[Pt];if(kt===xt)return Pt;kt<xt?Ct=Pt+1:It=Pt-1}return-Ct-1}function Hm(pt,xt){for(var Ct,It=0,Pt=pt.length-1;It<=Pt;){var kt=It+Pt>>>1;Ct=pt[kt];var Yt=Ct.start;if(Yt===xt)return Ct;Yt<xt?It=kt+1:Pt=kt-1}if(It>0)return Ct=pt[It-1],xt>Ct.end?0:Ct}function np(pt,xt){this.font=pt,this.tableName=xt}np.prototype={searchTag:bp,binSearch:Cp,getTable:function(pt){var xt=this.font.tables[this.tableName];return!xt&&pt&&(xt=this.font.tables[this.tableName]=this.createDefaultTable()),xt},getScriptNames:function(){var pt=this.getTable();return pt?pt.scripts.map(function(xt){return xt.tag}):[]},getDefaultScriptName:function(){var pt=this.getTable();if(pt){for(var xt=!1,Ct=0;Ct<pt.scripts.length;Ct++){var It=pt.scripts[Ct].tag;if(It==="DFLT")return It;It==="latn"&&(xt=!0)}if(xt)return"latn"}},getScriptTable:function(pt,xt){var Ct=this.getTable(xt);if(Ct){pt=pt||"DFLT";var It=Ct.scripts,Pt=bp(Ct.scripts,pt);if(Pt>=0)return It[Pt].script;if(xt){var kt={tag:pt,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return It.splice(-1-Pt,0,kt),kt.script}}},getLangSysTable:function(pt,xt,Ct){var It=this.getScriptTable(pt,Ct);if(It){if(!xt||xt==="dflt"||xt==="DFLT")return It.defaultLangSys;var Pt=bp(It.langSysRecords,xt);if(Pt>=0)return It.langSysRecords[Pt].langSys;if(Ct){var kt={tag:xt,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return It.langSysRecords.splice(-1-Pt,0,kt),kt.langSys}}},getFeatureTable:function(pt,xt,Ct,It){var Pt=this.getLangSysTable(pt,xt,It);if(Pt){for(var kt,Yt=Pt.featureIndexes,un=this.font.tables[this.tableName].features,an=0;an<Yt.length;an++)if(kt=un[Yt[an]],kt.tag===Ct)return kt.feature;if(It){var jn=un.length;return Jt.assert(jn===0||Ct>=un[jn-1].tag,"Features must be added in alphabetical order."),kt={tag:Ct,feature:{params:0,lookupListIndexes:[]}},un.push(kt),Yt.push(jn),kt.feature}}},getLookupTables:function(pt,xt,Ct,It,Pt){var kt=this.getFeatureTable(pt,xt,Ct,Pt),Yt=[];if(kt){for(var un,an=kt.lookupListIndexes,jn=this.font.tables[this.tableName].lookups,Wn=0;Wn<an.length;Wn++)un=jn[an[Wn]],un.lookupType===It&&Yt.push(un);if(Yt.length===0&&Pt){un={lookupType:It,lookupFlag:0,subtables:[],markFilteringSet:void 0};var lr=jn.length;return jn.push(un),an.push(lr),[un]}}return Yt},getGlyphClass:function(pt,xt){switch(pt.format){case 1:return pt.startGlyph<=xt&&xt<pt.startGlyph+pt.classes.length?pt.classes[xt-pt.startGlyph]:0;case 2:var Ct=Hm(pt.ranges,xt);return Ct?Ct.classId:0}},getCoverageIndex:function(pt,xt){switch(pt.format){case 1:var Ct=Cp(pt.glyphs,xt);return Ct>=0?Ct:-1;case 2:var It=Hm(pt.ranges,xt);return It?It.index+xt-It.start:-1}},expandCoverage:function(pt){if(pt.format===1)return pt.glyphs;for(var xt=[],Ct=pt.ranges,It=0;It<Ct.length;It++)for(var Pt=Ct[It],kt=Pt.start,Yt=Pt.end,un=kt;un<=Yt;un++)xt.push(un);return xt}};function rp(pt){np.call(this,pt,"gpos")}rp.prototype=np.prototype,rp.prototype.init=function(){var pt=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(pt)},rp.prototype.getKerningValue=function(pt,xt,Ct){for(var It=0;It<pt.length;It++)for(var Pt=pt[It].subtables,kt=0;kt<Pt.length;kt++){var Yt=Pt[kt],un=this.getCoverageIndex(Yt.coverage,xt);if(!(un<0))switch(Yt.posFormat){case 1:for(var an=Yt.pairSets[un],jn=0;jn<an.length;jn++){var Wn=an[jn];if(Wn.secondGlyph===Ct)return Wn.value1&&Wn.value1.xAdvance||0}break;case 2:var lr=this.getGlyphClass(Yt.classDef1,xt),Yn=this.getGlyphClass(Yt.classDef2,Ct),hr=Yt.classRecords[lr][Yn];return hr.value1&&hr.value1.xAdvance||0}}return 0},rp.prototype.getKerningTables=function(pt,xt){if(this.font.tables.gpos)return this.getLookupTables(pt,xt,"kern",2)};function ga(pt){np.call(this,pt,"gsub")}function ip(pt,xt){var Ct=pt.length;if(Ct!==xt.length)return!1;for(var It=0;It<Ct;It++)if(pt[It]!==xt[It])return!1;return!0}function Mu(pt,xt,Ct){for(var It=pt.subtables,Pt=0;Pt<It.length;Pt++){var kt=It[Pt];if(kt.substFormat===xt)return kt}if(Ct)return It.push(Ct),Ct}ga.prototype=np.prototype,ga.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},ga.prototype.getSingle=function(pt,xt,Ct){for(var It=[],Pt=this.getLookupTables(xt,Ct,pt,1),kt=0;kt<Pt.length;kt++)for(var Yt=Pt[kt].subtables,un=0;un<Yt.length;un++){var an=Yt[un],jn=this.expandCoverage(an.coverage),Wn=void 0;if(an.substFormat===1){var lr=an.deltaGlyphId;for(Wn=0;Wn<jn.length;Wn++){var Yn=jn[Wn];It.push({sub:Yn,by:Yn+lr})}}else{var hr=an.substitute;for(Wn=0;Wn<jn.length;Wn++)It.push({sub:jn[Wn],by:hr[Wn]})}}return It},ga.prototype.getMultiple=function(pt,xt,Ct){for(var It=[],Pt=this.getLookupTables(xt,Ct,pt,2),kt=0;kt<Pt.length;kt++)for(var Yt=Pt[kt].subtables,un=0;un<Yt.length;un++){var an=Yt[un],jn=this.expandCoverage(an.coverage),Wn=void 0;for(Wn=0;Wn<jn.length;Wn++){var lr=jn[Wn],Yn=an.sequences[Wn];It.push({sub:lr,by:Yn})}}return It},ga.prototype.getAlternates=function(pt,xt,Ct){for(var It=[],Pt=this.getLookupTables(xt,Ct,pt,3),kt=0;kt<Pt.length;kt++)for(var Yt=Pt[kt].subtables,un=0;un<Yt.length;un++)for(var an=Yt[un],jn=this.expandCoverage(an.coverage),Wn=an.alternateSets,lr=0;lr<jn.length;lr++)It.push({sub:jn[lr],by:Wn[lr]});return It},ga.prototype.getLigatures=function(pt,xt,Ct){for(var It=[],Pt=this.getLookupTables(xt,Ct,pt,4),kt=0;kt<Pt.length;kt++)for(var Yt=Pt[kt].subtables,un=0;un<Yt.length;un++)for(var an=Yt[un],jn=this.expandCoverage(an.coverage),Wn=an.ligatureSets,lr=0;lr<jn.length;lr++)for(var Yn=jn[lr],hr=Wn[lr],Lr=0;Lr<hr.length;Lr++){var jr=hr[Lr];It.push({sub:[Yn].concat(jr.components),by:jr.ligGlyph})}return It},ga.prototype.addSingle=function(pt,xt,Ct,It){var Pt=this.getLookupTables(Ct,It,pt,1,!0)[0],kt=Mu(Pt,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Jt.assert(kt.coverage.format===1,"Single: unable to modify coverage table format "+kt.coverage.format);var Yt=xt.sub,un=this.binSearch(kt.coverage.glyphs,Yt);un<0&&(un=-1-un,kt.coverage.glyphs.splice(un,0,Yt),kt.substitute.splice(un,0,0)),kt.substitute[un]=xt.by},ga.prototype.addMultiple=function(pt,xt,Ct,It){Jt.assert(xt.by instanceof Array&&xt.by.length>1,'Multiple: "by" must be an array of two or more ids');var Pt=this.getLookupTables(Ct,It,pt,2,!0)[0],kt=Mu(Pt,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Jt.assert(kt.coverage.format===1,"Multiple: unable to modify coverage table format "+kt.coverage.format);var Yt=xt.sub,un=this.binSearch(kt.coverage.glyphs,Yt);un<0&&(un=-1-un,kt.coverage.glyphs.splice(un,0,Yt),kt.sequences.splice(un,0,0)),kt.sequences[un]=xt.by},ga.prototype.addAlternate=function(pt,xt,Ct,It){var Pt=this.getLookupTables(Ct,It,pt,3,!0)[0],kt=Mu(Pt,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Jt.assert(kt.coverage.format===1,"Alternate: unable to modify coverage table format "+kt.coverage.format);var Yt=xt.sub,un=this.binSearch(kt.coverage.glyphs,Yt);un<0&&(un=-1-un,kt.coverage.glyphs.splice(un,0,Yt),kt.alternateSets.splice(un,0,0)),kt.alternateSets[un]=xt.by},ga.prototype.addLigature=function(pt,xt,Ct,It){var Pt=this.getLookupTables(Ct,It,pt,4,!0)[0],kt=Pt.subtables[0];kt||(kt={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},Pt.subtables[0]=kt),Jt.assert(kt.coverage.format===1,"Ligature: unable to modify coverage table format "+kt.coverage.format);var Yt=xt.sub[0],un=xt.sub.slice(1),an={ligGlyph:xt.by,components:un},jn=this.binSearch(kt.coverage.glyphs,Yt);if(jn>=0){for(var Wn=kt.ligatureSets[jn],lr=0;lr<Wn.length;lr++)if(ip(Wn[lr].components,un))return;Wn.push(an)}else jn=-1-jn,kt.coverage.glyphs.splice(jn,0,Yt),kt.ligatureSets.splice(jn,0,[an])},ga.prototype.getFeature=function(pt,xt,Ct){if(/ss\d\d/.test(pt))return this.getSingle(pt,xt,Ct);switch(pt){case"aalt":case"salt":return this.getSingle(pt,xt,Ct).concat(this.getAlternates(pt,xt,Ct));case"dlig":case"liga":case"rlig":return this.getLigatures(pt,xt,Ct);case"ccmp":return this.getMultiple(pt,xt,Ct).concat(this.getLigatures(pt,xt,Ct));case"stch":return this.getMultiple(pt,xt,Ct)}},ga.prototype.add=function(pt,xt,Ct,It){if(/ss\d\d/.test(pt))return this.addSingle(pt,xt,Ct,It);switch(pt){case"aalt":case"salt":return typeof xt.by=="number"?this.addSingle(pt,xt,Ct,It):this.addAlternate(pt,xt,Ct,It);case"dlig":case"liga":case"rlig":return this.addLigature(pt,xt,Ct,It);case"ccmp":return xt.by instanceof Array?this.addMultiple(pt,xt,Ct,It):this.addLigature(pt,xt,Ct,It)}};function _l(pt,xt){if(!pt)throw xt}function Tp(pt,xt,Ct,It,Pt){var kt;return(xt&It)>0?(kt=pt.parseByte(),xt&Pt||(kt=-kt),kt=Ct+kt):(xt&Pt)>0?kt=Ct:kt=Ct+pt.parseShort(),kt}function Ko(pt,xt,Ct){var It=new Mn.Parser(xt,Ct);pt.numberOfContours=It.parseShort(),pt._xMin=It.parseShort(),pt._yMin=It.parseShort(),pt._xMax=It.parseShort(),pt._yMax=It.parseShort();var Pt,kt;if(pt.numberOfContours>0){for(var Yt=pt.endPointIndices=[],un=0;un<pt.numberOfContours;un+=1)Yt.push(It.parseUShort());pt.instructionLength=It.parseUShort(),pt.instructions=[];for(var an=0;an<pt.instructionLength;an+=1)pt.instructions.push(It.parseByte());var jn=Yt[Yt.length-1]+1;Pt=[];for(var Wn=0;Wn<jn;Wn+=1)if(kt=It.parseByte(),Pt.push(kt),(kt&8)>0)for(var lr=It.parseByte(),Yn=0;Yn<lr;Yn+=1)Pt.push(kt),Wn+=1;if(Jt.argument(Pt.length===jn,"Bad flags."),Yt.length>0){var hr=[],Lr;if(jn>0){for(var jr=0;jr<jn;jr+=1)kt=Pt[jr],Lr={},Lr.onCurve=!!(kt&1),Lr.lastPointOfContour=Yt.indexOf(jr)>=0,hr.push(Lr);for(var Xr=0,Wr=0;Wr<jn;Wr+=1)kt=Pt[Wr],Lr=hr[Wr],Lr.x=Tp(It,kt,Xr,2,16),Xr=Lr.x;for(var bs=0,kr=0;kr<jn;kr+=1)kt=Pt[kr],Lr=hr[kr],Lr.y=Tp(It,kt,bs,4,32),bs=Lr.y}pt.points=hr}else pt.points=[]}else if(pt.numberOfContours===0)pt.points=[];else{pt.isComposite=!0,pt.points=[],pt.components=[];for(var Zs=!0;Zs;){Pt=It.parseUShort();var Is={glyphIndex:It.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(Pt&1)>0?(Pt&2)>0?(Is.dx=It.parseShort(),Is.dy=It.parseShort()):Is.matchedPoints=[It.parseUShort(),It.parseUShort()]:(Pt&2)>0?(Is.dx=It.parseChar(),Is.dy=It.parseChar()):Is.matchedPoints=[It.parseByte(),It.parseByte()],(Pt&8)>0?Is.xScale=Is.yScale=It.parseF2Dot14():(Pt&64)>0?(Is.xScale=It.parseF2Dot14(),Is.yScale=It.parseF2Dot14()):(Pt&128)>0&&(Is.xScale=It.parseF2Dot14(),Is.scale01=It.parseF2Dot14(),Is.scale10=It.parseF2Dot14(),Is.yScale=It.parseF2Dot14()),pt.components.push(Is),Zs=!!(Pt&32)}if(Pt&256){pt.instructionLength=It.parseUShort(),pt.instructions=[];for(var fo=0;fo<pt.instructionLength;fo+=1)pt.instructions.push(It.parseByte())}}}function xl(pt,xt){for(var Ct=[],It=0;It<pt.length;It+=1){var Pt=pt[It],kt={x:xt.xScale*Pt.x+xt.scale01*Pt.y+xt.dx,y:xt.scale10*Pt.x+xt.yScale*Pt.y+xt.dy,onCurve:Pt.onCurve,lastPointOfContour:Pt.lastPointOfContour};Ct.push(kt)}return Ct}function Uu(pt){for(var xt=[],Ct=[],It=0;It<pt.length;It+=1){var Pt=pt[It];Ct.push(Pt),Pt.lastPointOfContour&&(xt.push(Ct),Ct=[])}return Jt.argument(Ct.length===0,"There are still points left in the current contour."),xt}function ou(pt){var xt=new Ut;if(!pt)return xt;for(var Ct=Uu(pt),It=0;It<Ct.length;++It){var Pt=Ct[It],kt=null,Yt=Pt[Pt.length-1],un=Pt[0];if(Yt.onCurve)xt.moveTo(Yt.x,Yt.y);else if(un.onCurve)xt.moveTo(un.x,un.y);else{var an={x:(Yt.x+un.x)*.5,y:(Yt.y+un.y)*.5};xt.moveTo(an.x,an.y)}for(var jn=0;jn<Pt.length;++jn)if(kt=Yt,Yt=un,un=Pt[(jn+1)%Pt.length],Yt.onCurve)xt.lineTo(Yt.x,Yt.y);else{var Wn=un;kt.onCurve||((Yt.x+kt.x)*.5,(Yt.y+kt.y)*.5),un.onCurve||(Wn={x:(Yt.x+un.x)*.5,y:(Yt.y+un.y)*.5}),xt.quadraticCurveTo(Yt.x,Yt.y,Wn.x,Wn.y)}xt.closePath()}return xt}function au(pt,xt){if(xt.isComposite)for(var Ct=0;Ct<xt.components.length;Ct+=1){var It=xt.components[Ct],Pt=pt.get(It.glyphIndex);if(Pt.getPath(),Pt.points){var kt=void 0;if(It.matchedPoints===void 0)kt=xl(Pt.points,It);else{if(It.matchedPoints[0]>xt.points.length-1||It.matchedPoints[1]>Pt.points.length-1)throw Error("Matched points out of range in "+xt.name);var Yt=xt.points[It.matchedPoints[0]],un=Pt.points[It.matchedPoints[1]],an={xScale:It.xScale,scale01:It.scale01,scale10:It.scale10,yScale:It.yScale,dx:0,dy:0};un=xl([un],an)[0],an.dx=Yt.x-un.x,an.dy=Yt.y-un.y,kt=xl(Pt.points,an)}xt.points=xt.points.concat(kt)}}return ou(xt.points)}function Gu(pt,xt,Ct,It){for(var Pt=new js.GlyphSet(It),kt=0;kt<Ct.length-1;kt+=1){var Yt=Ct[kt],un=Ct[kt+1];Yt!==un?Pt.push(kt,js.ttfGlyphLoader(It,kt,Ko,pt,xt+Yt,au)):Pt.push(kt,js.glyphLoader(It,kt))}return Pt}function E0(pt,xt,Ct,It){var Pt=new js.GlyphSet(It);return It._push=function(kt){var Yt=Ct[kt],un=Ct[kt+1];Yt!==un?Pt.push(kt,js.ttfGlyphLoader(It,kt,Ko,pt,xt+Yt,au)):Pt.push(kt,js.glyphLoader(It,kt))},Pt}function tu(pt,xt,Ct,It,Pt){return Pt.lowMemory?E0(pt,xt,Ct,It):Gu(pt,xt,Ct,It)}var tm={getPath:ou,parse:tu},Oo,Fo,uo,lu;function Vl(pt){this.font=pt,this.getCommands=function(xt){return tm.getPath(xt).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function S0(pt){return pt}function Qm(pt){return Math.sign(pt)*Math.round(Math.abs(pt))}function Wm(pt){return Math.sign(pt)*Math.round(Math.abs(pt*2))/2}function nu(pt){return Math.sign(pt)*(Math.round(Math.abs(pt)+.5)-.5)}function b0(pt){return Math.sign(pt)*Math.ceil(Math.abs(pt))}function Vu(pt){return Math.sign(pt)*Math.floor(Math.abs(pt))}var zu=function(pt){var xt=this.srPeriod,Ct=this.srPhase,It=this.srThreshold,Pt=1;return pt<0&&(pt=-pt,Pt=-1),pt+=It-Ct,pt=Math.trunc(pt/xt)*xt,pt+=Ct,pt<0?Ct*Pt:pt*Pt},zl={x:1,y:0,axis:"x",distance:function(pt,xt,Ct,It){return(Ct?pt.xo:pt.x)-(It?xt.xo:xt.x)},interpolate:function(pt,xt,Ct,It){var Pt,kt,Yt,un,an,jn,Wn;if(!It||It===this){if(Pt=pt.xo-xt.xo,kt=pt.xo-Ct.xo,an=xt.x-xt.xo,jn=Ct.x-Ct.xo,Yt=Math.abs(Pt),un=Math.abs(kt),Wn=Yt+un,Wn===0){pt.x=pt.xo+(an+jn)/2;return}pt.x=pt.xo+(an*un+jn*Yt)/Wn;return}if(Pt=It.distance(pt,xt,!0,!0),kt=It.distance(pt,Ct,!0,!0),an=It.distance(xt,xt,!1,!0),jn=It.distance(Ct,Ct,!1,!0),Yt=Math.abs(Pt),un=Math.abs(kt),Wn=Yt+un,Wn===0){zl.setRelative(pt,pt,(an+jn)/2,It,!0);return}zl.setRelative(pt,pt,(an*un+jn*Yt)/Wn,It,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(pt,xt,Ct,It,Pt){if(!It||It===this){pt.x=(Pt?xt.xo:xt.x)+Ct;return}var kt=Pt?xt.xo:xt.x,Yt=Pt?xt.yo:xt.y,un=kt+Ct*It.x,an=Yt+Ct*It.y;pt.x=un+(pt.y-an)/It.normalSlope},slope:0,touch:function(pt){pt.xTouched=!0},touched:function(pt){return pt.xTouched},untouch:function(pt){pt.xTouched=!1}},Pl={x:0,y:1,axis:"y",distance:function(pt,xt,Ct,It){return(Ct?pt.yo:pt.y)-(It?xt.yo:xt.y)},interpolate:function(pt,xt,Ct,It){var Pt,kt,Yt,un,an,jn,Wn;if(!It||It===this){if(Pt=pt.yo-xt.yo,kt=pt.yo-Ct.yo,an=xt.y-xt.yo,jn=Ct.y-Ct.yo,Yt=Math.abs(Pt),un=Math.abs(kt),Wn=Yt+un,Wn===0){pt.y=pt.yo+(an+jn)/2;return}pt.y=pt.yo+(an*un+jn*Yt)/Wn;return}if(Pt=It.distance(pt,xt,!0,!0),kt=It.distance(pt,Ct,!0,!0),an=It.distance(xt,xt,!1,!0),jn=It.distance(Ct,Ct,!1,!0),Yt=Math.abs(Pt),un=Math.abs(kt),Wn=Yt+un,Wn===0){Pl.setRelative(pt,pt,(an+jn)/2,It,!0);return}Pl.setRelative(pt,pt,(an*un+jn*Yt)/Wn,It,!0)},normalSlope:0,setRelative:function(pt,xt,Ct,It,Pt){if(!It||It===this){pt.y=(Pt?xt.yo:xt.y)+Ct;return}var kt=Pt?xt.xo:xt.x,Yt=Pt?xt.yo:xt.y,un=kt+Ct*It.x,an=Yt+Ct*It.y;pt.y=an+It.normalSlope*(pt.x-un)},slope:Number.POSITIVE_INFINITY,touch:function(pt){pt.yTouched=!0},touched:function(pt){return pt.yTouched},untouch:function(pt){pt.yTouched=!1}};Object.freeze(zl),Object.freeze(Pl);function wu(pt,xt){this.x=pt,this.y=xt,this.axis=void 0,this.slope=xt/pt,this.normalSlope=-pt/xt,Object.freeze(this)}wu.prototype.distance=function(pt,xt,Ct,It){return this.x*zl.distance(pt,xt,Ct,It)+this.y*Pl.distance(pt,xt,Ct,It)},wu.prototype.interpolate=function(pt,xt,Ct,It){var Pt,kt,Yt,un,an,jn,Wn;if(Yt=It.distance(pt,xt,!0,!0),un=It.distance(pt,Ct,!0,!0),Pt=It.distance(xt,xt,!1,!0),kt=It.distance(Ct,Ct,!1,!0),an=Math.abs(Yt),jn=Math.abs(un),Wn=an+jn,Wn===0){this.setRelative(pt,pt,(Pt+kt)/2,It,!0);return}this.setRelative(pt,pt,(Pt*jn+kt*an)/Wn,It,!0)},wu.prototype.setRelative=function(pt,xt,Ct,It,Pt){It=It||this;var kt=Pt?xt.xo:xt.x,Yt=Pt?xt.yo:xt.y,un=kt+Ct*It.x,an=Yt+Ct*It.y,jn=It.normalSlope,Wn=this.slope,lr=pt.x,Yn=pt.y;pt.x=(Wn*lr-jn*un+an-Yn)/(Wn-jn),pt.y=Wn*(pt.x-lr)+Yn},wu.prototype.touch=function(pt){pt.xTouched=!0,pt.yTouched=!0};function sp(pt,xt){var Ct=Math.sqrt(pt*pt+xt*xt);return pt/=Ct,xt/=Ct,pt===1&&xt===0?zl:pt===0&&xt===1?Pl:new wu(pt,xt)}function cu(pt,xt,Ct,It){this.x=this.xo=Math.round(pt*64)/64,this.y=this.yo=Math.round(xt*64)/64,this.lastPointOfContour=Ct,this.onCurve=It,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}cu.prototype.nextTouched=function(pt){for(var xt=this.nextPointOnContour;!pt.touched(xt)&&xt!==this;)xt=xt.nextPointOnContour;return xt},cu.prototype.prevTouched=function(pt){for(var xt=this.prevPointOnContour;!pt.touched(xt)&&xt!==this;)xt=xt.prevPointOnContour;return xt};var uu=Object.freeze(new cu(0,0)),Mp={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Hl(pt,xt){switch(this.env=pt,this.stack=[],this.prog=xt,pt){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=zl,this.round=Qm}}Vl.prototype.exec=function(pt,xt){if(typeof xt!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var Ct=this.font,It=this._prepState;if(!It||It.ppem!==xt){var Pt=this._fpgmState;if(!Pt){Hl.prototype=Mp,Pt=this._fpgmState=new Hl("fpgm",Ct.tables.fpgm),Pt.funcs=[],Pt.font=Ct,exports.DEBUG&&(console.log("---EXEC FPGM---"),Pt.step=-1);try{Fo(Pt)}catch(jn){console.log("Hinting error in FPGM:"+jn),this._errorState=3;return}}Hl.prototype=Pt,It=this._prepState=new Hl("prep",Ct.tables.prep),It.ppem=xt;var kt=Ct.tables.cvt;if(kt)for(var Yt=It.cvt=new Array(kt.length),un=xt/Ct.unitsPerEm,an=0;an<kt.length;an++)Yt[an]=kt[an]*un;else It.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),It.step=-1);try{Fo(It)}catch(jn){this._errorState<2&&console.log("Hinting error in PREP:"+jn),this._errorState=2}}if(!(this._errorState>1))try{return uo(pt,It)}catch(jn){this._errorState<1&&(console.log("Hinting error:"+jn),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}},uo=function(pt,xt){var Ct=xt.ppem/xt.font.unitsPerEm,It=Ct,Pt=pt.components,kt,Yt,un;if(Hl.prototype=xt,!Pt)un=new Hl("glyf",pt.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),un.step=-1),lu(pt,un,Ct,It),Yt=un.gZone;else{var an=xt.font;Yt=[],kt=[];for(var jn=0;jn<Pt.length;jn++){var Wn=Pt[jn],lr=an.glyphs.get(Wn.glyphIndex);un=new Hl("glyf",lr.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+jn+"---"),un.step=-1),lu(lr,un,Ct,It);for(var Yn=Math.round(Wn.dx*Ct),hr=Math.round(Wn.dy*It),Lr=un.gZone,jr=un.contours,Xr=0;Xr<Lr.length;Xr++){var Wr=Lr[Xr];Wr.xTouched=Wr.yTouched=!1,Wr.xo=Wr.x=Wr.x+Yn,Wr.yo=Wr.y=Wr.y+hr}var bs=Yt.length;Yt.push.apply(Yt,Lr);for(var kr=0;kr<jr.length;kr++)kt.push(jr[kr]+bs)}pt.instructions&&!un.inhibitGridFit&&(un=new Hl("glyf",pt.instructions),un.gZone=un.z0=un.z1=un.z2=Yt,un.contours=kt,Yt.push(new cu(0,0),new cu(Math.round(pt.advanceWidth*Ct),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),un.step=-1),Fo(un),Yt.length-=2)}return Yt},lu=function(pt,xt,Ct,It){for(var Pt=pt.points||[],kt=Pt.length,Yt=xt.gZone=xt.z0=xt.z1=xt.z2=[],un=xt.contours=[],an,jn=0;jn<kt;jn++)an=Pt[jn],Yt[jn]=new cu(an.x*Ct,an.y*It,an.lastPointOfContour,an.onCurve);for(var Wn,lr,Yn=0;Yn<kt;Yn++)an=Yt[Yn],Wn||(Wn=an,un.push(Yn)),an.lastPointOfContour?(an.nextPointOnContour=Wn,Wn.prevPointOnContour=an,Wn=void 0):(lr=Yt[Yn+1],an.nextPointOnContour=lr,lr.prevPointOnContour=an);if(!xt.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",xt.stack);for(var hr=0;hr<kt;hr++)console.log(hr,Yt[hr].x,Yt[hr].y)}if(Yt.push(new cu(0,0),new cu(Math.round(pt.advanceWidth*Ct),0)),Fo(xt),Yt.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",xt.stack);for(var Lr=0;Lr<kt;Lr++)console.log(Lr,Yt[Lr].x,Yt[Lr].y)}}},Fo=function(pt){var xt=pt.prog;if(xt){var Ct=xt.length,It;for(pt.ip=0;pt.ip<Ct;pt.ip++){if(exports.DEBUG&&pt.step++,It=Oo[xt[pt.ip]],!It)throw new Error("unknown instruction: 0x"+Number(xt[pt.ip]).toString(16));It(pt)}}};function Po(pt){for(var xt=pt.tZone=new Array(pt.gZone.length),Ct=0;Ct<xt.length;Ct++)xt[Ct]=new cu(0,0)}function Iu(pt,xt){var Ct=pt.prog,It=pt.ip,Pt=1,kt;do if(kt=Ct[++It],kt===88)Pt++;else if(kt===89)Pt--;else if(kt===64)It+=Ct[It+1]+1;else if(kt===65)It+=2*Ct[It+1]+1;else if(kt>=176&&kt<=183)It+=kt-176+1;else if(kt>=184&&kt<=191)It+=(kt-184+1)*2;else if(xt&&Pt===1&&kt===27)break;while(Pt>0);pt.ip=It}function Hu(pt,xt){exports.DEBUG&&console.log(xt.step,"SVTCA["+pt.axis+"]"),xt.fv=xt.pv=xt.dpv=pt}function Ll(pt,xt){exports.DEBUG&&console.log(xt.step,"SPVTCA["+pt.axis+"]"),xt.pv=xt.dpv=pt}function wp(pt,xt){exports.DEBUG&&console.log(xt.step,"SFVTCA["+pt.axis+"]"),xt.fv=pt}function Qu(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=Ct.pop(),kt=xt.z2[It],Yt=xt.z1[Pt];exports.DEBUG&&console.log("SPVTL["+pt+"]",It,Pt);var un,an;pt?(un=kt.y-Yt.y,an=Yt.x-kt.x):(un=Yt.x-kt.x,an=Yt.y-kt.y),xt.pv=xt.dpv=sp(un,an)}function op(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=Ct.pop(),kt=xt.z2[It],Yt=xt.z1[Pt];exports.DEBUG&&console.log("SFVTL["+pt+"]",It,Pt);var un,an;pt?(un=kt.y-Yt.y,an=Yt.x-kt.x):(un=Yt.x-kt.x,an=Yt.y-kt.y),xt.fv=sp(un,an)}function Nl(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"SPVFS[]",Ct,It),pt.pv=pt.dpv=sp(It,Ct)}function Ao(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"SPVFS[]",Ct,It),pt.fv=sp(It,Ct)}function Ip(pt){var xt=pt.stack,Ct=pt.pv;exports.DEBUG&&console.log(pt.step,"GPV[]"),xt.push(Ct.x*16384),xt.push(Ct.y*16384)}function nm(pt){var xt=pt.stack,Ct=pt.fv;exports.DEBUG&&console.log(pt.step,"GFV[]"),xt.push(Ct.x*16384),xt.push(Ct.y*16384)}function jm(pt){pt.fv=pt.pv,exports.DEBUG&&console.log(pt.step,"SFVTPV[]")}function rm(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop(),Pt=xt.pop(),kt=xt.pop(),Yt=xt.pop(),un=pt.z0,an=pt.z1,jn=un[Ct],Wn=un[It],lr=an[Pt],Yn=an[kt],hr=pt.z2[Yt];exports.DEBUG&&console.log("ISECT[], ",Ct,It,Pt,kt,Yt);var Lr=jn.x,jr=jn.y,Xr=Wn.x,Wr=Wn.y,bs=lr.x,kr=lr.y,Zs=Yn.x,Is=Yn.y,fo=(Lr-Xr)*(kr-Is)-(jr-Wr)*(bs-Zs),Rs=Lr*Wr-jr*Xr,hs=bs*Is-kr*Zs;hr.x=(Rs*(bs-Zs)-hs*(Lr-Xr))/fo,hr.y=(Rs*(kr-Is)-hs*(jr-Wr))/fo}function Ql(pt){pt.rp0=pt.stack.pop(),exports.DEBUG&&console.log(pt.step,"SRP0[]",pt.rp0)}function ap(pt){pt.rp1=pt.stack.pop(),exports.DEBUG&&console.log(pt.step,"SRP1[]",pt.rp1)}function So(pt){pt.rp2=pt.stack.pop(),exports.DEBUG&&console.log(pt.step,"SRP2[]",pt.rp2)}function Yo(pt){var xt=pt.stack.pop();switch(exports.DEBUG&&console.log(pt.step,"SZP0[]",xt),pt.zp0=xt,xt){case 0:pt.tZone||Po(pt),pt.z0=pt.tZone;break;case 1:pt.z0=pt.gZone;break;default:throw new Error("Invalid zone pointer")}}function Uo(pt){var xt=pt.stack.pop();switch(exports.DEBUG&&console.log(pt.step,"SZP1[]",xt),pt.zp1=xt,xt){case 0:pt.tZone||Po(pt),pt.z1=pt.tZone;break;case 1:pt.z1=pt.gZone;break;default:throw new Error("Invalid zone pointer")}}function Dl(pt){var xt=pt.stack.pop();switch(exports.DEBUG&&console.log(pt.step,"SZP2[]",xt),pt.zp2=xt,xt){case 0:pt.tZone||Po(pt),pt.z2=pt.tZone;break;case 1:pt.z2=pt.gZone;break;default:throw new Error("Invalid zone pointer")}}function Bp(pt){var xt=pt.stack.pop();switch(exports.DEBUG&&console.log(pt.step,"SZPS[]",xt),pt.zp0=pt.zp1=pt.zp2=xt,xt){case 0:pt.tZone||Po(pt),pt.z0=pt.z1=pt.z2=pt.tZone;break;case 1:pt.z0=pt.z1=pt.z2=pt.gZone;break;default:throw new Error("Invalid zone pointer")}}function Rp(pt){pt.loop=pt.stack.pop(),exports.DEBUG&&console.log(pt.step,"SLOOP[]",pt.loop)}function C0(pt){exports.DEBUG&&console.log(pt.step,"RTG[]"),pt.round=Qm}function jo(pt){exports.DEBUG&&console.log(pt.step,"RTHG[]"),pt.round=nu}function $m(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"SMD[]",xt),pt.minDis=xt/64}function im(pt){exports.DEBUG&&console.log(pt.step,"ELSE[]"),Iu(pt,!1)}function sm(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"JMPR[]",xt),pt.ip+=xt-1}function vu(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"SCVTCI[]",xt),pt.cvCutIn=xt/64}function Wl(pt){var xt=pt.stack;exports.DEBUG&&console.log(pt.step,"DUP[]"),xt.push(xt[xt.length-1])}function hu(pt){exports.DEBUG&&console.log(pt.step,"POP[]"),pt.stack.pop()}function om(pt){exports.DEBUG&&console.log(pt.step,"CLEAR[]"),pt.stack.length=0}function am(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"SWAP[]"),xt.push(Ct),xt.push(It)}function Xm(pt){var xt=pt.stack;exports.DEBUG&&console.log(pt.step,"DEPTH[]"),xt.push(xt.length)}function T0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"LOOPCALL[]",Ct,It);var Pt=pt.ip,kt=pt.prog;pt.prog=pt.funcs[Ct];for(var Yt=0;Yt<It;Yt++)Fo(pt),exports.DEBUG&&console.log(++pt.step,Yt+1<It?"next loopcall":"done loopcall",Yt);pt.ip=Pt,pt.prog=kt}function lm(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"CALL[]",xt);var Ct=pt.ip,It=pt.prog;pt.prog=pt.funcs[xt],Fo(pt),pt.ip=Ct,pt.prog=It,exports.DEBUG&&console.log(++pt.step,"returning from",xt)}function M0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"CINDEX[]",Ct),xt.push(xt[xt.length-Ct])}function w0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"MINDEX[]",Ct),xt.push(xt.splice(xt.length-Ct,1)[0])}function I0(pt){if(pt.env!=="fpgm")throw new Error("FDEF not allowed here");var xt=pt.stack,Ct=pt.prog,It=pt.ip,Pt=xt.pop(),kt=It;for(exports.DEBUG&&console.log(pt.step,"FDEF[]",Pt);Ct[++It]!==45;);pt.ip=It,pt.funcs[Pt]=Ct.slice(kt+1,It)}function Fp(pt,xt){var Ct=xt.stack.pop(),It=xt.z0[Ct],Pt=xt.fv,kt=xt.pv;exports.DEBUG&&console.log(xt.step,"MDAP["+pt+"]",Ct);var Yt=kt.distance(It,uu);pt&&(Yt=xt.round(Yt)),Pt.setRelative(It,uu,Yt,kt),Pt.touch(It),xt.rp0=xt.rp1=Ct}function lp(pt,xt){var Ct=xt.z2,It=Ct.length-2,Pt,kt,Yt;exports.DEBUG&&console.log(xt.step,"IUP["+pt.axis+"]");for(var un=0;un<It;un++)Pt=Ct[un],!pt.touched(Pt)&&(kt=Pt.prevTouched(pt),kt!==Pt&&(Yt=Pt.nextTouched(pt),kt===Yt&&pt.setRelative(Pt,Pt,pt.distance(kt,kt,!1,!0),pt,!0),pt.interpolate(Pt,kt,Yt,pt)))}function cm(pt,xt){for(var Ct=xt.stack,It=pt?xt.rp1:xt.rp2,Pt=(pt?xt.z0:xt.z1)[It],kt=xt.fv,Yt=xt.pv,un=xt.loop,an=xt.z2;un--;){var jn=Ct.pop(),Wn=an[jn],lr=Yt.distance(Pt,Pt,!1,!0);kt.setRelative(Wn,Wn,lr,Yt),kt.touch(Wn),exports.DEBUG&&console.log(xt.step,(xt.loop>1?"loop "+(xt.loop-un)+": ":"")+"SHP["+(pt?"rp1":"rp2")+"]",jn)}xt.loop=1}function Wu(pt,xt){var Ct=xt.stack,It=pt?xt.rp1:xt.rp2,Pt=(pt?xt.z0:xt.z1)[It],kt=xt.fv,Yt=xt.pv,un=Ct.pop(),an=xt.z2[xt.contours[un]],jn=an;exports.DEBUG&&console.log(xt.step,"SHC["+pt+"]",un);var Wn=Yt.distance(Pt,Pt,!1,!0);do jn!==Pt&&kt.setRelative(jn,jn,Wn,Yt),jn=jn.nextPointOnContour;while(jn!==an)}function cp(pt,xt){var Ct=xt.stack,It=pt?xt.rp1:xt.rp2,Pt=(pt?xt.z0:xt.z1)[It],kt=xt.fv,Yt=xt.pv,un=Ct.pop();exports.DEBUG&&console.log(xt.step,"SHZ["+pt+"]",un);var an;switch(un){case 0:an=xt.tZone;break;case 1:an=xt.gZone;break;default:throw new Error("Invalid zone")}for(var jn,Wn=Yt.distance(Pt,Pt,!1,!0),lr=an.length-2,Yn=0;Yn<lr;Yn++)jn=an[Yn],kt.setRelative(jn,jn,Wn,Yt)}function Km(pt){for(var xt=pt.stack,Ct=pt.loop,It=pt.fv,Pt=xt.pop()/64,kt=pt.z2;Ct--;){var Yt=xt.pop(),un=kt[Yt];exports.DEBUG&&console.log(pt.step,(pt.loop>1?"loop "+(pt.loop-Ct)+": ":"")+"SHPIX[]",Yt,Pt),It.setRelative(un,un,Pt),It.touch(un)}pt.loop=1}function ju(pt){for(var xt=pt.stack,Ct=pt.rp1,It=pt.rp2,Pt=pt.loop,kt=pt.z0[Ct],Yt=pt.z1[It],un=pt.fv,an=pt.dpv,jn=pt.z2;Pt--;){var Wn=xt.pop(),lr=jn[Wn];exports.DEBUG&&console.log(pt.step,(pt.loop>1?"loop "+(pt.loop-Pt)+": ":"")+"IP[]",Wn,Ct,"<->",It),un.interpolate(lr,kt,Yt,an),un.touch(lr)}pt.loop=1}function Ym(pt,xt){var Ct=xt.stack,It=Ct.pop()/64,Pt=Ct.pop(),kt=xt.z1[Pt],Yt=xt.z0[xt.rp0],un=xt.fv,an=xt.pv;un.setRelative(kt,Yt,It,an),un.touch(kt),exports.DEBUG&&console.log(xt.step,"MSIRP["+pt+"]",It,Pt),xt.rp1=xt.rp0,xt.rp2=Pt,pt&&(xt.rp0=Pt)}function um(pt){for(var xt=pt.stack,Ct=pt.rp0,It=pt.z0[Ct],Pt=pt.loop,kt=pt.fv,Yt=pt.pv,un=pt.z1;Pt--;){var an=xt.pop(),jn=un[an];exports.DEBUG&&console.log(pt.step,(pt.loop>1?"loop "+(pt.loop-Pt)+": ":"")+"ALIGNRP[]",an),kt.setRelative(jn,It,0,Yt),kt.touch(jn)}pt.loop=1}function B0(pt){exports.DEBUG&&console.log(pt.step,"RTDG[]"),pt.round=Wm}function Bu(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=Ct.pop(),kt=xt.z0[Pt],Yt=xt.fv,un=xt.pv,an=xt.cvt[It];exports.DEBUG&&console.log(xt.step,"MIAP["+pt+"]",It,"(",an,")",Pt);var jn=un.distance(kt,uu);pt&&(Math.abs(jn-an)<xt.cvCutIn&&(jn=an),jn=xt.round(jn)),Yt.setRelative(kt,uu,jn,un),xt.zp0===0&&(kt.xo=kt.x,kt.yo=kt.y),Yt.touch(kt),xt.rp0=xt.rp1=Pt}function hm(pt){var xt=pt.prog,Ct=pt.ip,It=pt.stack,Pt=xt[++Ct];exports.DEBUG&&console.log(pt.step,"NPUSHB[]",Pt);for(var kt=0;kt<Pt;kt++)It.push(xt[++Ct]);pt.ip=Ct}function R0(pt){var xt=pt.ip,Ct=pt.prog,It=pt.stack,Pt=Ct[++xt];exports.DEBUG&&console.log(pt.step,"NPUSHW[]",Pt);for(var kt=0;kt<Pt;kt++){var Yt=Ct[++xt]<<8|Ct[++xt];Yt&32768&&(Yt=-((Yt^65535)+1)),It.push(Yt)}pt.ip=xt}function qm(pt){var xt=pt.stack,Ct=pt.store;Ct||(Ct=pt.store=[]);var It=xt.pop(),Pt=xt.pop();exports.DEBUG&&console.log(pt.step,"WS",It,Pt),Ct[Pt]=It}function F0(pt){var xt=pt.stack,Ct=pt.store,It=xt.pop();exports.DEBUG&&console.log(pt.step,"RS",It);var Pt=Ct&&Ct[It]||0;xt.push(Pt)}function Jm(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"WCVTP",Ct,It),pt.cvt[It]=Ct/64}function P0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"RCVT",Ct),xt.push(pt.cvt[Ct]*64)}function L0(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=xt.z2[It];exports.DEBUG&&console.log(xt.step,"GC["+pt+"]",It),Ct.push(xt.dpv.distance(Pt,uu,pt,!1)*64)}function Zm(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=Ct.pop(),kt=xt.z1[It],Yt=xt.z0[Pt],un=xt.dpv.distance(Yt,kt,pt,pt);exports.DEBUG&&console.log(xt.step,"MD["+pt+"]",It,Pt,"->",un),xt.stack.push(Math.round(un*64))}function k0(pt){exports.DEBUG&&console.log(pt.step,"MPPEM[]"),pt.stack.push(pt.ppem)}function N0(pt){exports.DEBUG&&console.log(pt.step,"FLIPON[]"),pt.autoFlip=!0}function D0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"LT[]",Ct,It),xt.push(It<Ct?1:0)}function fu(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"LTEQ[]",Ct,It),xt.push(It<=Ct?1:0)}function up(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"GT[]",Ct,It),xt.push(It>Ct?1:0)}function f1(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"GTEQ[]",Ct,It),xt.push(It>=Ct?1:0)}function d1(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"EQ[]",Ct,It),xt.push(Ct===It?1:0)}function e0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"NEQ[]",Ct,It),xt.push(Ct!==It?1:0)}function t0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"ODD[]",Ct),xt.push(Math.trunc(Ct)%2?1:0)}function fm(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"EVEN[]",Ct),xt.push(Math.trunc(Ct)%2?0:1)}function dm(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"IF[]",xt),xt||(Iu(pt,!0),exports.DEBUG&&console.log(pt.step,"EIF[]"))}function O0(pt){exports.DEBUG&&console.log(pt.step,"EIF[]")}function U0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"AND[]",Ct,It),xt.push(Ct&&It?1:0)}function G0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"OR[]",Ct,It),xt.push(Ct||It?1:0)}function n0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"NOT[]",Ct),xt.push(Ct?0:1)}function Ol(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=xt.fv,kt=xt.pv,Yt=xt.ppem,un=xt.deltaBase+(pt-1)*16,an=xt.deltaShift,jn=xt.z0;exports.DEBUG&&console.log(xt.step,"DELTAP["+pt+"]",It,Ct);for(var Wn=0;Wn<It;Wn++){var lr=Ct.pop(),Yn=Ct.pop(),hr=un+((Yn&240)>>4);if(hr===Yt){var Lr=(Yn&15)-8;Lr>=0&&Lr++,exports.DEBUG&&console.log(xt.step,"DELTAPFIX",lr,"by",Lr*an);var jr=jn[lr];Pt.setRelative(jr,jr,Lr*an,kt)}}}function V0(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"SDB[]",Ct),pt.deltaBase=Ct}function Pp(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"SDS[]",Ct),pt.deltaShift=Math.pow(.5,Ct)}function Lp(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"ADD[]",Ct,It),xt.push(It+Ct)}function pm(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"SUB[]",Ct,It),xt.push(It-Ct)}function mm(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"DIV[]",Ct,It),xt.push(It*64/Ct)}function z0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"MUL[]",Ct,It),xt.push(It*Ct/64)}function kp(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"ABS[]",Ct),xt.push(Math.abs(Ct))}function qo(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"NEG[]",Ct),xt.push(-Ct)}function p1(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"FLOOR[]",Ct),xt.push(Math.floor(Ct/64)*64)}function m1(pt){var xt=pt.stack,Ct=xt.pop();exports.DEBUG&&console.log(pt.step,"CEILING[]",Ct),xt.push(Math.ceil(Ct/64)*64)}function Jo(pt,xt){var Ct=xt.stack,It=Ct.pop();exports.DEBUG&&console.log(xt.step,"ROUND[]"),Ct.push(xt.round(It/64)*64)}function xa(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"WCVTF[]",Ct,It),pt.cvt[It]=Ct*pt.ppem/pt.font.unitsPerEm}function gm(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=xt.ppem,kt=xt.deltaBase+(pt-1)*16,Yt=xt.deltaShift;exports.DEBUG&&console.log(xt.step,"DELTAC["+pt+"]",It,Ct);for(var un=0;un<It;un++){var an=Ct.pop(),jn=Ct.pop(),Wn=kt+((jn&240)>>4);if(Wn===Pt){var lr=(jn&15)-8;lr>=0&&lr++;var Yn=lr*Yt;exports.DEBUG&&console.log(xt.step,"DELTACFIX",an,"by",Yn),xt.cvt[an]+=Yn}}}function H0(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"SROUND[]",xt),pt.round=zu;var Ct;switch(xt&192){case 0:Ct=.5;break;case 64:Ct=1;break;case 128:Ct=2;break;default:throw new Error("invalid SROUND value")}switch(pt.srPeriod=Ct,xt&48){case 0:pt.srPhase=0;break;case 16:pt.srPhase=.25*Ct;break;case 32:pt.srPhase=.5*Ct;break;case 48:pt.srPhase=.75*Ct;break;default:throw new Error("invalid SROUND value")}xt&=15,xt===0?pt.srThreshold=0:pt.srThreshold=(xt/8-.5)*Ct}function Q0(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"S45ROUND[]",xt),pt.round=zu;var Ct;switch(xt&192){case 0:Ct=Math.sqrt(2)/2;break;case 64:Ct=Math.sqrt(2);break;case 128:Ct=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(pt.srPeriod=Ct,xt&48){case 0:pt.srPhase=0;break;case 16:pt.srPhase=.25*Ct;break;case 32:pt.srPhase=.5*Ct;break;case 48:pt.srPhase=.75*Ct;break;default:throw new Error("invalid S45ROUND value")}xt&=15,xt===0?pt.srThreshold=0:pt.srThreshold=(xt/8-.5)*Ct}function W0(pt){exports.DEBUG&&console.log(pt.step,"ROFF[]"),pt.round=S0}function j0(pt){exports.DEBUG&&console.log(pt.step,"RUTG[]"),pt.round=b0}function r0(pt){exports.DEBUG&&console.log(pt.step,"RDTG[]"),pt.round=Vu}function $0(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"SCANCTRL[]",xt)}function Am(pt,xt){var Ct=xt.stack,It=Ct.pop(),Pt=Ct.pop(),kt=xt.z2[It],Yt=xt.z1[Pt];exports.DEBUG&&console.log(xt.step,"SDPVTL["+pt+"]",It,Pt);var un,an;pt?(un=kt.y-Yt.y,an=Yt.x-kt.x):(un=Yt.x-kt.x,an=Yt.y-kt.y),xt.dpv=sp(un,an)}function X0(pt){var xt=pt.stack,Ct=xt.pop(),It=0;exports.DEBUG&&console.log(pt.step,"GETINFO[]",Ct),Ct&1&&(It=35),Ct&32&&(It|=4096),xt.push(It)}function K0(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop(),Pt=xt.pop();exports.DEBUG&&console.log(pt.step,"ROLL[]"),xt.push(It),xt.push(Ct),xt.push(Pt)}function vm(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"MAX[]",Ct,It),xt.push(Math.max(It,Ct))}function ym(pt){var xt=pt.stack,Ct=xt.pop(),It=xt.pop();exports.DEBUG&&console.log(pt.step,"MIN[]",Ct,It),xt.push(Math.min(It,Ct))}function Y0(pt){var xt=pt.stack.pop();exports.DEBUG&&console.log(pt.step,"SCANTYPE[]",xt)}function _m(pt){var xt=pt.stack.pop(),Ct=pt.stack.pop();switch(exports.DEBUG&&console.log(pt.step,"INSTCTRL[]",xt,Ct),xt){case 1:pt.inhibitGridFit=!!Ct;return;case 2:pt.ignoreCvt=!!Ct;return;default:throw new Error("invalid INSTCTRL[] selector")}}function yu(pt,xt){var Ct=xt.stack,It=xt.prog,Pt=xt.ip;exports.DEBUG&&console.log(xt.step,"PUSHB["+pt+"]");for(var kt=0;kt<pt;kt++)Ct.push(It[++Pt]);xt.ip=Pt}function _u(pt,xt){var Ct=xt.ip,It=xt.prog,Pt=xt.stack;exports.DEBUG&&console.log(xt.ip,"PUSHW["+pt+"]");for(var kt=0;kt<pt;kt++){var Yt=It[++Ct]<<8|It[++Ct];Yt&32768&&(Yt=-((Yt^65535)+1)),Pt.push(Yt)}xt.ip=Ct}function ns(pt,xt,Ct,It,Pt,kt){var Yt=kt.stack,un=pt&&Yt.pop(),an=Yt.pop(),jn=kt.rp0,Wn=kt.z0[jn],lr=kt.z1[an],Yn=kt.minDis,hr=kt.fv,Lr=kt.dpv,jr,Xr,Wr,bs;Xr=jr=Lr.distance(lr,Wn,!0,!0),Wr=Xr>=0?1:-1,Xr=Math.abs(Xr),pt&&(bs=kt.cvt[un],It&&Math.abs(Xr-bs)<kt.cvCutIn&&(Xr=bs)),Ct&&Xr<Yn&&(Xr=Yn),It&&(Xr=kt.round(Xr)),hr.setRelative(lr,Wn,Wr*Xr,Lr),hr.touch(lr),exports.DEBUG&&console.log(kt.step,(pt?"MIRP[":"MDRP[")+(xt?"M":"m")+(Ct?">":"_")+(It?"R":"_")+(Pt===0?"Gr":Pt===1?"Bl":Pt===2?"Wh":"")+"]",pt?un+"("+kt.cvt[un]+","+bs+")":"",an,"(d =",jr,"->",Wr*Xr,")"),kt.rp1=kt.rp0,kt.rp2=an,xt&&(kt.rp0=an)}Oo=[Hu.bind(void 0,Pl),Hu.bind(void 0,zl),Ll.bind(void 0,Pl),Ll.bind(void 0,zl),wp.bind(void 0,Pl),wp.bind(void 0,zl),Qu.bind(void 0,0),Qu.bind(void 0,1),op.bind(void 0,0),op.bind(void 0,1),Nl,Ao,Ip,nm,jm,rm,Ql,ap,So,Yo,Uo,Dl,Bp,Rp,C0,jo,$m,im,sm,vu,void 0,void 0,Wl,hu,om,am,Xm,M0,w0,void 0,void 0,void 0,T0,lm,I0,void 0,Fp.bind(void 0,0),Fp.bind(void 0,1),lp.bind(void 0,Pl),lp.bind(void 0,zl),cm.bind(void 0,0),cm.bind(void 0,1),Wu.bind(void 0,0),Wu.bind(void 0,1),cp.bind(void 0,0),cp.bind(void 0,1),Km,ju,Ym.bind(void 0,0),Ym.bind(void 0,1),um,B0,Bu.bind(void 0,0),Bu.bind(void 0,1),hm,R0,qm,F0,Jm,P0,L0.bind(void 0,0),L0.bind(void 0,1),void 0,Zm.bind(void 0,0),Zm.bind(void 0,1),k0,void 0,N0,void 0,void 0,D0,fu,up,f1,d1,e0,t0,fm,dm,O0,U0,G0,n0,Ol.bind(void 0,1),V0,Pp,Lp,pm,mm,z0,kp,qo,p1,m1,Jo.bind(void 0,0),Jo.bind(void 0,1),Jo.bind(void 0,2),Jo.bind(void 0,3),void 0,void 0,void 0,void 0,xa,Ol.bind(void 0,2),Ol.bind(void 0,3),gm.bind(void 0,1),gm.bind(void 0,2),gm.bind(void 0,3),H0,Q0,void 0,void 0,W0,void 0,j0,r0,hu,hu,void 0,void 0,void 0,void 0,void 0,$0,Am.bind(void 0,0),Am.bind(void 0,1),X0,void 0,K0,vm,ym,Y0,_m,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,yu.bind(void 0,1),yu.bind(void 0,2),yu.bind(void 0,3),yu.bind(void 0,4),yu.bind(void 0,5),yu.bind(void 0,6),yu.bind(void 0,7),yu.bind(void 0,8),_u.bind(void 0,1),_u.bind(void 0,2),_u.bind(void 0,3),_u.bind(void 0,4),_u.bind(void 0,5),_u.bind(void 0,6),_u.bind(void 0,7),_u.bind(void 0,8),ns.bind(void 0,0,0,0,0,0),ns.bind(void 0,0,0,0,0,1),ns.bind(void 0,0,0,0,0,2),ns.bind(void 0,0,0,0,0,3),ns.bind(void 0,0,0,0,1,0),ns.bind(void 0,0,0,0,1,1),ns.bind(void 0,0,0,0,1,2),ns.bind(void 0,0,0,0,1,3),ns.bind(void 0,0,0,1,0,0),ns.bind(void 0,0,0,1,0,1),ns.bind(void 0,0,0,1,0,2),ns.bind(void 0,0,0,1,0,3),ns.bind(void 0,0,0,1,1,0),ns.bind(void 0,0,0,1,1,1),ns.bind(void 0,0,0,1,1,2),ns.bind(void 0,0,0,1,1,3),ns.bind(void 0,0,1,0,0,0),ns.bind(void 0,0,1,0,0,1),ns.bind(void 0,0,1,0,0,2),ns.bind(void 0,0,1,0,0,3),ns.bind(void 0,0,1,0,1,0),ns.bind(void 0,0,1,0,1,1),ns.bind(void 0,0,1,0,1,2),ns.bind(void 0,0,1,0,1,3),ns.bind(void 0,0,1,1,0,0),ns.bind(void 0,0,1,1,0,1),ns.bind(void 0,0,1,1,0,2),ns.bind(void 0,0,1,1,0,3),ns.bind(void 0,0,1,1,1,0),ns.bind(void 0,0,1,1,1,1),ns.bind(void 0,0,1,1,1,2),ns.bind(void 0,0,1,1,1,3),ns.bind(void 0,1,0,0,0,0),ns.bind(void 0,1,0,0,0,1),ns.bind(void 0,1,0,0,0,2),ns.bind(void 0,1,0,0,0,3),ns.bind(void 0,1,0,0,1,0),ns.bind(void 0,1,0,0,1,1),ns.bind(void 0,1,0,0,1,2),ns.bind(void 0,1,0,0,1,3),ns.bind(void 0,1,0,1,0,0),ns.bind(void 0,1,0,1,0,1),ns.bind(void 0,1,0,1,0,2),ns.bind(void 0,1,0,1,0,3),ns.bind(void 0,1,0,1,1,0),ns.bind(void 0,1,0,1,1,1),ns.bind(void 0,1,0,1,1,2),ns.bind(void 0,1,0,1,1,3),ns.bind(void 0,1,1,0,0,0),ns.bind(void 0,1,1,0,0,1),ns.bind(void 0,1,1,0,0,2),ns.bind(void 0,1,1,0,0,3),ns.bind(void 0,1,1,0,1,0),ns.bind(void 0,1,1,0,1,1),ns.bind(void 0,1,1,0,1,2),ns.bind(void 0,1,1,0,1,3),ns.bind(void 0,1,1,1,0,0),ns.bind(void 0,1,1,1,0,1),ns.bind(void 0,1,1,1,0,2),ns.bind(void 0,1,1,1,0,3),ns.bind(void 0,1,1,1,1,0),ns.bind(void 0,1,1,1,1,1),ns.bind(void 0,1,1,1,1,2),ns.bind(void 0,1,1,1,1,3)];function $u(pt){this.char=pt,this.state={},this.activeState=null}function hp(pt,xt,Ct){this.contextName=Ct,this.startIndex=pt,this.endOffset=xt}function q0(pt,xt,Ct){this.contextName=pt,this.openRange=null,this.ranges=[],this.checkStart=xt,this.checkEnd=Ct}function Lo(pt,xt){this.context=pt,this.index=xt,this.length=pt.length,this.current=pt[xt],this.backtrack=pt.slice(0,xt),this.lookahead=pt.slice(xt+1)}function xm(pt){this.eventId=pt,this.subscribers=[]}function g1(pt){var xt=this,Ct=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];Ct.forEach(function(Pt){Object.defineProperty(xt.events,Pt,{value:new xm(Pt)})}),pt&&Ct.forEach(function(Pt){var kt=pt[Pt];typeof kt=="function"&&xt.events[Pt].subscribe(kt)});var It=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];It.forEach(function(Pt){xt.events[Pt].subscribe(xt.updateContextsRanges)})}function ho(pt){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],g1.call(this,pt)}$u.prototype.setState=function(pt,xt){return this.state[pt]=xt,this.activeState={key:pt,value:this.state[pt]},this.activeState},$u.prototype.getState=function(pt){return this.state[pt]||null},ho.prototype.inboundIndex=function(pt){return pt>=0&&pt<this.tokens.length},ho.prototype.composeRUD=function(pt){var xt=this,Ct=!0,It=pt.map(function(kt){return xt[kt[0]].apply(xt,kt.slice(1).concat(Ct))}),Pt=function(kt){return typeof kt=="object"&&kt.hasOwnProperty("FAIL")};if(It.every(Pt))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:It.filter(Pt)};this.dispatch("composeRUD",[It.filter(function(kt){return!Pt(kt)})])},ho.prototype.replaceRange=function(pt,xt,Ct,It){xt=xt!==null?xt:this.tokens.length;var Pt=Ct.every(function(Yt){return Yt instanceof $u});if(!isNaN(pt)&&this.inboundIndex(pt)&&Pt){var kt=this.tokens.splice.apply(this.tokens,[pt,xt].concat(Ct));return It||this.dispatch("replaceToken",[pt,xt,Ct]),[kt,Ct]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}},ho.prototype.replaceToken=function(pt,xt,Ct){if(!isNaN(pt)&&this.inboundIndex(pt)&&xt instanceof $u){var It=this.tokens.splice(pt,1,xt);return Ct||this.dispatch("replaceToken",[pt,xt]),[It[0],xt]}else return{FAIL:"replaceToken: invalid token or index."}},ho.prototype.removeRange=function(pt,xt,Ct){xt=isNaN(xt)?this.tokens.length:xt;var It=this.tokens.splice(pt,xt);return Ct||this.dispatch("removeRange",[It,pt,xt]),It},ho.prototype.removeToken=function(pt,xt){if(!isNaN(pt)&&this.inboundIndex(pt)){var Ct=this.tokens.splice(pt,1);return xt||this.dispatch("removeToken",[Ct,pt]),Ct}else return{FAIL:"removeToken: invalid token index."}},ho.prototype.insertToken=function(pt,xt,Ct){var It=pt.every(function(Pt){return Pt instanceof $u});return It?(this.tokens.splice.apply(this.tokens,[xt,0].concat(pt)),Ct||this.dispatch("insertToken",[pt,xt]),pt):{FAIL:"insertToken: invalid token(s)."}},ho.prototype.registerModifier=function(pt,xt,Ct){this.events.newToken.subscribe(function(It,Pt){var kt=[It,Pt],Yt=xt===null||xt.apply(this,kt)===!0,un=[It,Pt];if(Yt){var an=Ct.apply(this,un);It.setState(pt,an)}}),this.registeredModifiers.push(pt)},xm.prototype.subscribe=function(pt){return typeof pt=="function"?this.subscribers.push(pt)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},xm.prototype.unsubscribe=function(pt){this.subscribers.splice(pt,1)},Lo.prototype.setCurrentIndex=function(pt){this.index=pt,this.current=this.context[pt],this.backtrack=this.context.slice(0,pt),this.lookahead=this.context.slice(pt+1)},Lo.prototype.get=function(pt){switch(!0){case pt===0:return this.current;case(pt<0&&Math.abs(pt)<=this.backtrack.length):return this.backtrack.slice(pt)[0];case(pt>0&&pt<=this.lookahead.length):return this.lookahead[pt-1];default:return null}},ho.prototype.rangeToText=function(pt){if(pt instanceof hp)return this.getRangeTokens(pt).map(function(xt){return xt.char}).join("")},ho.prototype.getText=function(){return this.tokens.map(function(pt){return pt.char}).join("")},ho.prototype.getContext=function(pt){var xt=this.registeredContexts[pt];return xt||null},ho.prototype.on=function(pt,xt){var Ct=this.events[pt];return Ct?Ct.subscribe(xt):null},ho.prototype.dispatch=function(pt,xt){var Ct=this,It=this.events[pt];It instanceof xm&&It.subscribers.forEach(function(Pt){Pt.apply(Ct,xt||[])})},ho.prototype.registerContextChecker=function(pt,xt,Ct){if(this.getContext(pt))return{FAIL:"context name '"+pt+"' is already registered."};if(typeof xt!="function")return{FAIL:"missing context start check."};if(typeof Ct!="function")return{FAIL:"missing context end check."};var It=new q0(pt,xt,Ct);return this.registeredContexts[pt]=It,this.contextCheckers.push(It),It},ho.prototype.getRangeTokens=function(pt){var xt=pt.startIndex+pt.endOffset;return[].concat(this.tokens.slice(pt.startIndex,xt))},ho.prototype.getContextRanges=function(pt){var xt=this.getContext(pt);return xt?xt.ranges:{FAIL:"context checker '"+pt+"' is not registered."}},ho.prototype.resetContextsRanges=function(){var pt=this.registeredContexts;for(var xt in pt)if(pt.hasOwnProperty(xt)){var Ct=pt[xt];Ct.ranges=[]}},ho.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var pt=this.tokens.map(function(It){return It.char}),xt=0;xt<pt.length;xt++){var Ct=new Lo(pt,xt);this.runContextCheck(Ct)}this.dispatch("updateContextsRanges",[this.registeredContexts])},ho.prototype.setEndOffset=function(pt,xt){var Ct=this.getContext(xt).openRange.startIndex,It=new hp(Ct,pt,xt),Pt=this.getContext(xt).ranges;return It.rangeId=xt+"."+Pt.length,Pt.push(It),this.getContext(xt).openRange=null,It},ho.prototype.runContextCheck=function(pt){var xt=this,Ct=pt.index;this.contextCheckers.forEach(function(It){var Pt=It.contextName,kt=xt.getContext(Pt).openRange;if(!kt&&It.checkStart(pt)&&(kt=new hp(Ct,null,Pt),xt.getContext(Pt).openRange=kt,xt.dispatch("contextStart",[Pt,Ct])),kt&&It.checkEnd(pt)){var Yt=Ct-kt.startIndex+1,un=xt.setEndOffset(Yt,Pt);xt.dispatch("contextEnd",[Pt,un])}})},ho.prototype.tokenize=function(pt){this.tokens=[],this.resetContextsRanges();var xt=Array.from(pt);this.dispatch("start");for(var Ct=0;Ct<xt.length;Ct++){var It=xt[Ct],Pt=new Lo(xt,Ct);this.dispatch("next",[Pt]),this.runContextCheck(Pt);var kt=new $u(It);this.tokens.push(kt),this.dispatch("newToken",[kt,Pt])}return this.dispatch("end",[this.tokens]),this.tokens};function ba(pt){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(pt)}function J0(pt){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(pt)}function zr(pt){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(pt)}function Xu(pt){return/[A-z]/.test(pt)}function i0(pt){return/\s/.test(pt)}function $a(pt){this.font=pt,this.features={}}function Ku(pt){this.id=pt.id,this.tag=pt.tag,this.substitution=pt.substitution}function ru(pt,xt){if(!pt)return-1;switch(xt.format){case 1:return xt.glyphs.indexOf(pt);case 2:for(var Ct=xt.ranges,It=0;It<Ct.length;It++){var Pt=Ct[It];if(pt>=Pt.start&&pt<=Pt.end){var kt=pt-Pt.start;return Pt.index+kt}}break;default:return-1}return-1}function Np(pt,xt){var Ct=ru(pt,xt.coverage);return Ct===-1?null:pt+xt.deltaGlyphId}function Em(pt,xt){var Ct=ru(pt,xt.coverage);return Ct===-1?null:xt.substitute[Ct]}function Sm(pt,xt){for(var Ct=[],It=0;It<pt.length;It++){var Pt=pt[It],kt=xt.current;kt=Array.isArray(kt)?kt[0]:kt;var Yt=ru(kt,Pt);Yt!==-1&&Ct.push(Yt)}return Ct.length!==pt.length?-1:Ct}function Z0(pt,xt){var Ct=xt.inputCoverage.length+xt.lookaheadCoverage.length+xt.backtrackCoverage.length;if(pt.context.length<Ct)return[];var It=Sm(xt.inputCoverage,pt);if(It===-1)return[];var Pt=xt.inputCoverage.length-1;if(pt.lookahead.length<xt.lookaheadCoverage.length)return[];for(var kt=pt.lookahead.slice(Pt);kt.length&&zr(kt[0].char);)kt.shift();var Yt=new Lo(kt,0),un=Sm(xt.lookaheadCoverage,Yt),an=[].concat(pt.backtrack);for(an.reverse();an.length&&zr(an[0].char);)an.shift();if(an.length<xt.backtrackCoverage.length)return[];var jn=new Lo(an,0),Wn=Sm(xt.backtrackCoverage,jn),lr=It.length===xt.inputCoverage.length&&un.length===xt.lookaheadCoverage.length&&Wn.length===xt.backtrackCoverage.length,Yn=[];if(lr)for(var hr=0;hr<xt.lookupRecords.length;hr++)for(var Lr=xt.lookupRecords[hr],jr=Lr.lookupListIndex,Xr=this.getLookupByIndex(jr),Wr=0;Wr<Xr.subtables.length;Wr++){var bs=Xr.subtables[Wr],kr=this.getLookupMethod(Xr,bs),Zs=this.getSubstitutionType(Xr,bs);if(Zs==="12")for(var Is=0;Is<It.length;Is++){var fo=pt.get(Is),Rs=kr(fo);Rs&&Yn.push(Rs)}}return Yn}function _g(pt,xt){var Ct=pt.current,It=ru(Ct,xt.coverage);if(It===-1)return null;for(var Pt,kt=xt.ligatureSets[It],Yt=0;Yt<kt.length;Yt++){Pt=kt[Yt];for(var un=0;un<Pt.components.length;un++){var an=pt.lookahead[un],jn=Pt.components[un];if(an!==jn)break;if(un===Pt.components.length-1)return Pt}}return null}function e1(pt,xt){var Ct=ru(pt,xt.coverage);return Ct===-1?null:xt.sequences[Ct]}$a.prototype.getDefaultScriptFeaturesIndexes=function(){for(var pt=this.font.tables.gsub.scripts,xt=0;xt<pt.length;xt++){var Ct=pt[xt];if(Ct.tag==="DFLT")return Ct.script.defaultLangSys.featureIndexes}return[]},$a.prototype.getScriptFeaturesIndexes=function(pt){var xt=this.font.tables;if(!xt.gsub)return[];if(!pt)return this.getDefaultScriptFeaturesIndexes();for(var Ct=this.font.tables.gsub.scripts,It=0;It<Ct.length;It++){var Pt=Ct[It];if(Pt.tag===pt&&Pt.script.defaultLangSys)return Pt.script.defaultLangSys.featureIndexes;var kt=Pt.langSysRecords;if(kt)for(var Yt=0;Yt<kt.length;Yt++){var un=kt[Yt];if(un.tag===pt){var an=un.langSys;return an.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()},$a.prototype.mapTagsToFeatures=function(pt,xt){for(var Ct={},It=0;It<pt.length;It++){var Pt=pt[It].tag,kt=pt[It].feature;Ct[Pt]=kt}this.features[xt].tags=Ct},$a.prototype.getScriptFeatures=function(pt){var xt=this.features[pt];if(this.features.hasOwnProperty(pt))return xt;var Ct=this.getScriptFeaturesIndexes(pt);if(!Ct)return null;var It=this.font.tables.gsub;return xt=Ct.map(function(Pt){return It.features[Pt]}),this.features[pt]=xt,this.mapTagsToFeatures(xt,pt),xt},$a.prototype.getSubstitutionType=function(pt,xt){var Ct=pt.lookupType.toString(),It=xt.substFormat.toString();return Ct+It},$a.prototype.getLookupMethod=function(pt,xt){var Ct=this,It=this.getSubstitutionType(pt,xt);switch(It){case"11":return function(Pt){return Np.apply(Ct,[Pt,xt])};case"12":return function(Pt){return Em.apply(Ct,[Pt,xt])};case"63":return function(Pt){return Z0.apply(Ct,[Pt,xt])};case"41":return function(Pt){return _g.apply(Ct,[Pt,xt])};case"21":return function(Pt){return e1.apply(Ct,[Pt,xt])};default:throw new Error("lookupType: "+pt.lookupType+" - substFormat: "+xt.substFormat+" is not yet supported")}},$a.prototype.lookupFeature=function(pt){var xt=pt.contextParams,Ct=xt.index,It=this.getFeature({tag:pt.tag,script:pt.script});if(!It)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+pt.tag+"' for script '"+pt.script+"'.");for(var Pt=this.getFeatureLookups(It),kt=[].concat(xt.context),Yt=0;Yt<Pt.length;Yt++)for(var un=Pt[Yt],an=this.getLookupSubtables(un),jn=0;jn<an.length;jn++){var Wn=an[jn],lr=this.getSubstitutionType(un,Wn),Yn=this.getLookupMethod(un,Wn),hr=void 0;switch(lr){case"11":hr=Yn(xt.current),hr&&kt.splice(Ct,1,new Ku({id:11,tag:pt.tag,substitution:hr}));break;case"12":hr=Yn(xt.current),hr&&kt.splice(Ct,1,new Ku({id:12,tag:pt.tag,substitution:hr}));break;case"63":hr=Yn(xt),Array.isArray(hr)&&hr.length&&kt.splice(Ct,1,new Ku({id:63,tag:pt.tag,substitution:hr}));break;case"41":hr=Yn(xt),hr&&kt.splice(Ct,1,new Ku({id:41,tag:pt.tag,substitution:hr}));break;case"21":hr=Yn(xt.current),hr&&kt.splice(Ct,1,new Ku({id:21,tag:pt.tag,substitution:hr}));break}xt=new Lo(kt,Ct),!(Array.isArray(hr)&&!hr.length)&&(hr=null)}return kt.length?kt:null},$a.prototype.supports=function(pt){if(!pt.script)return!1;this.getScriptFeatures(pt.script);var xt=this.features.hasOwnProperty(pt.script);if(!pt.tag)return xt;var Ct=this.features[pt.script].some(function(It){return It.tag===pt.tag});return xt&&Ct},$a.prototype.getLookupSubtables=function(pt){return pt.subtables||null},$a.prototype.getLookupByIndex=function(pt){var xt=this.font.tables.gsub.lookups;return xt[pt]||null},$a.prototype.getFeatureLookups=function(pt){return pt.lookupListIndexes.map(this.getLookupByIndex.bind(this))},$a.prototype.getFeature=function(xt){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(xt.script)||this.getScriptFeatures(xt.script);var Ct=this.features[xt.script];return Ct?Ct.tags[xt.tag]?this.features[xt.script].tags[xt.tag]:null:{FAIL:"No feature for script "+xt.script}};function t1(pt){var xt=pt.current,Ct=pt.get(-1);return Ct===null&&ba(xt)||!ba(Ct)&&ba(xt)}function n1(pt){var xt=pt.get(1);return xt===null||!ba(xt)}var s0={startCheck:t1,endCheck:n1};function o0(pt){var xt=pt.current,Ct=pt.get(-1);return(ba(xt)||zr(xt))&&!ba(Ct)}function r1(pt){var xt=pt.get(1);switch(!0){case xt===null:return!0;case(!ba(xt)&&!zr(xt)):var Ct=i0(xt);if(!Ct)return!0;if(Ct){var It=!1;if(It=pt.lookahead.some(function(Pt){return ba(Pt)||zr(Pt)}),!It)return!0}break;default:return!1}}var a0={startCheck:o0,endCheck:r1};function bm(pt,xt,Ct){xt[Ct].setState(pt.tag,pt.substitution)}function A1(pt,xt,Ct){xt[Ct].setState(pt.tag,pt.substitution)}function v1(pt,xt,Ct){pt.substitution.forEach(function(It,Pt){var kt=xt[Ct+Pt];kt.setState(pt.tag,It)})}function i1(pt,xt,Ct){var It=xt[Ct];It.setState(pt.tag,pt.substitution.ligGlyph);for(var Pt=pt.substitution.components.length,kt=0;kt<Pt;kt++)It=xt[Ct+kt+1],It.setState("deleted",!0)}var l0={11:bm,12:A1,63:v1,41:i1};function Cm(pt,xt,Ct){pt instanceof Ku&&l0[pt.id]&&l0[pt.id](pt,xt,Ct)}function so(pt){for(var xt=[].concat(pt.backtrack),Ct=xt.length-1;Ct>=0;Ct--){var It=xt[Ct],Pt=J0(It),kt=zr(It);if(!Pt&&!kt)return!0;if(Pt)return!1}return!1}function Yu(pt){if(J0(pt.current))return!1;for(var xt=0;xt<pt.lookahead.length;xt++){var Ct=pt.lookahead[xt],It=zr(Ct);if(!It)return!0}return!1}function Tm(pt){var xt=this,Ct="arab",It=this.featuresTags[Ct],Pt=this.tokenizer.getRangeTokens(pt);if(Pt.length!==1){var kt=new Lo(Pt.map(function(un){return un.getState("glyphIndex")}),0),Yt=new Lo(Pt.map(function(un){return un.char}),0);Pt.forEach(function(un,an){if(!zr(un.char)){kt.setCurrentIndex(an),Yt.setCurrentIndex(an);var jn=0;so(Yt)&&(jn|=1),Yu(Yt)&&(jn|=2);var Wn;switch(jn){case 1:Wn="fina";break;case 2:Wn="init";break;case 3:Wn="medi";break}if(It.indexOf(Wn)!==-1){var lr=xt.query.lookupFeature({tag:Wn,script:Ct,contextParams:kt});if(lr instanceof Error)return console.info(lr.message);lr.forEach(function(Yn,hr){Yn instanceof Ku&&(Cm(Yn,Pt,hr),kt.context[hr]=Yn.substitution)})}}})}}function Co(pt,xt){var Ct=pt.map(function(It){return It.activeState.value});return new Lo(Ct,xt||0)}function Ru(pt){var xt=this,Ct="arab",It=this.tokenizer.getRangeTokens(pt),Pt=Co(It);Pt.context.forEach(function(kt,Yt){Pt.setCurrentIndex(Yt);var un=xt.query.lookupFeature({tag:"rlig",script:Ct,contextParams:Pt});un.length&&(un.forEach(function(an){return Cm(an,It,Yt)}),Pt=Co(It))})}function Mm(pt){var xt=pt.current,Ct=pt.get(-1);return Ct===null&&Xu(xt)||!Xu(Ct)&&Xu(xt)}function Dp(pt){var xt=pt.get(1);return xt===null||!Xu(xt)}var c0={startCheck:Mm,endCheck:Dp};function xu(pt,xt){var Ct=pt.map(function(It){return It.activeState.value});return new Lo(Ct,xt||0)}function wm(pt){var xt=this,Ct="latn",It=this.tokenizer.getRangeTokens(pt),Pt=xu(It);Pt.context.forEach(function(kt,Yt){Pt.setCurrentIndex(Yt);var un=xt.query.lookupFeature({tag:"liga",script:Ct,contextParams:Pt});un.length&&(un.forEach(function(an){return Cm(an,It,Yt)}),Pt=xu(It))})}function El(pt){this.baseDir=pt||"ltr",this.tokenizer=new ho,this.featuresTags={}}El.prototype.setText=function(pt){this.text=pt},El.prototype.contextChecks={latinWordCheck:c0,arabicWordCheck:s0,arabicSentenceCheck:a0};function Op(pt){var xt=this.contextChecks[pt+"Check"];return this.tokenizer.registerContextChecker(pt,xt.startCheck,xt.endCheck)}function y1(){return Op.call(this,"latinWord"),Op.call(this,"arabicWord"),Op.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function Up(){var pt=this,xt=this.tokenizer.getContextRanges("arabicSentence");xt.forEach(function(Ct){var It=pt.tokenizer.getRangeTokens(Ct);pt.tokenizer.replaceRange(Ct.startIndex,Ct.endOffset,It.reverse())})}El.prototype.registerFeatures=function(pt,xt){var Ct=this,It=xt.filter(function(Pt){return Ct.query.supports({script:pt,tag:Pt})});this.featuresTags.hasOwnProperty(pt)?this.featuresTags[pt]=this.featuresTags[pt].concat(It):this.featuresTags[pt]=It},El.prototype.applyFeatures=function(pt,xt){if(!pt)throw new Error("No valid font was provided to apply features");this.query||(this.query=new $a(pt));for(var Ct=0;Ct<xt.length;Ct++){var It=xt[Ct];this.query.supports({script:It.script})&&this.registerFeatures(It.script,It.tags)}},El.prototype.registerModifier=function(pt,xt,Ct){this.tokenizer.registerModifier(pt,xt,Ct)};function Gp(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function vo(){var pt=this,xt="arab";if(this.featuresTags.hasOwnProperty(xt)){Gp.call(this);var Ct=this.tokenizer.getContextRanges("arabicWord");Ct.forEach(function(It){Tm.call(pt,It)})}}function Ds(){var pt=this,xt="arab";if(this.featuresTags.hasOwnProperty(xt)){var Ct=this.featuresTags[xt];if(Ct.indexOf("rlig")!==-1){Gp.call(this);var It=this.tokenizer.getContextRanges("arabicWord");It.forEach(function(Pt){Ru.call(pt,Pt)})}}}function wo(){var pt=this,xt="latn";if(this.featuresTags.hasOwnProperty(xt)){var Ct=this.featuresTags[xt];if(Ct.indexOf("liga")!==-1){Gp.call(this);var It=this.tokenizer.getContextRanges("latinWord");It.forEach(function(Pt){wm.call(pt,Pt)})}}}El.prototype.checkContextReady=function(pt){return!!this.tokenizer.getContext(pt)},El.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(vo.call(this),Ds.call(this)),this.checkContextReady("latinWord")&&wo.call(this),this.checkContextReady("arabicSentence")&&Up.call(this)},El.prototype.processText=function(pt){(!this.text||this.text!==pt)&&(this.setText(pt),y1.call(this),this.applyFeaturesToContexts())},El.prototype.getBidiText=function(pt){return this.processText(pt),this.tokenizer.getText()},El.prototype.getTextGlyphs=function(pt){this.processText(pt);for(var xt=[],Ct=0;Ct<this.tokenizer.tokens.length;Ct++){var It=this.tokenizer.tokens[Ct];if(!It.state.deleted){var Pt=It.activeState.value;xt.push(Array.isArray(Pt)?Pt[0]:Pt)}}return xt};function ws(pt){pt=pt||{},pt.tables=pt.tables||{},pt.empty||(_l(pt.familyName,"When creating a new Font object, familyName is required."),_l(pt.styleName,"When creating a new Font object, styleName is required."),_l(pt.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),_l(pt.ascender,"When creating a new Font object, ascender is required."),_l(pt.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:pt.familyName||" "},fontSubfamily:{en:pt.styleName||" "},fullName:{en:pt.fullName||pt.familyName+" "+pt.styleName},postScriptName:{en:pt.postScriptName||(pt.familyName+pt.styleName).replace(/\s/g,"")},designer:{en:pt.designer||" "},designerURL:{en:pt.designerURL||" "},manufacturer:{en:pt.manufacturer||" "},manufacturerURL:{en:pt.manufacturerURL||" "},license:{en:pt.license||" "},licenseURL:{en:pt.licenseURL||" "},version:{en:pt.version||"Version 0.1"},description:{en:pt.description||" "},copyright:{en:pt.copyright||" "},trademark:{en:pt.trademark||" "}},this.unitsPerEm=pt.unitsPerEm||1e3,this.ascender=pt.ascender,this.descender=pt.descender,this.createdTimestamp=pt.createdTimestamp,this.tables=Object.assign(pt.tables,{os2:Object.assign({usWeightClass:pt.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:pt.widthClass||this.usWidthClasses.MEDIUM,fsSelection:pt.fsSelection||this.fsSelectionValues.REGULAR},pt.tables.os2)})),this.supported=!0,this.glyphs=new js.GlyphSet(this,pt.glyphs||[]),this.encoding=new _r(this),this.position=new rp(this),this.substitution=new ga(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new Vl(this)}})}ws.prototype.hasChar=function(pt){return this.encoding.charToGlyphIndex(pt)!==null},ws.prototype.charToGlyphIndex=function(pt){return this.encoding.charToGlyphIndex(pt)},ws.prototype.charToGlyph=function(pt){var xt=this.charToGlyphIndex(pt),Ct=this.glyphs.get(xt);return Ct||(Ct=this.glyphs.get(0)),Ct},ws.prototype.updateFeatures=function(pt){return this.defaultRenderOptions.features.map(function(xt){return xt.script==="latn"?{script:"latn",tags:xt.tags.filter(function(Ct){return pt[Ct]})}:xt})},ws.prototype.stringToGlyphs=function(pt,xt){var Ct=this,It=new El,Pt=function(lr){return Ct.charToGlyphIndex(lr.char)};It.registerModifier("glyphIndex",null,Pt);var kt=xt?this.updateFeatures(xt.features):this.defaultRenderOptions.features;It.applyFeatures(this,kt);for(var Yt=It.getTextGlyphs(pt),un=Yt.length,an=new Array(un),jn=this.glyphs.get(0),Wn=0;Wn<un;Wn+=1)an[Wn]=this.glyphs.get(Yt[Wn])||jn;return an},ws.prototype.nameToGlyphIndex=function(pt){return this.glyphNames.nameToGlyphIndex(pt)},ws.prototype.nameToGlyph=function(pt){var xt=this.nameToGlyphIndex(pt),Ct=this.glyphs.get(xt);return Ct||(Ct=this.glyphs.get(0)),Ct},ws.prototype.glyphIndexToName=function(pt){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(pt):""},ws.prototype.getKerningValue=function(pt,xt){pt=pt.index||pt,xt=xt.index||xt;var Ct=this.position.defaultKerningTables;return Ct?this.position.getKerningValue(Ct,pt,xt):this.kerningPairs[pt+","+xt]||0},ws.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},ws.prototype.forEachGlyph=function(pt,xt,Ct,It,Pt,kt){xt=xt!==void 0?xt:0,Ct=Ct!==void 0?Ct:0,It=It!==void 0?It:72,Pt=Object.assign({},this.defaultRenderOptions,Pt);var Yt=1/this.unitsPerEm*It,un=this.stringToGlyphs(pt,Pt),an;if(Pt.kerning){var jn=Pt.script||this.position.getDefaultScriptName();an=this.position.getKerningTables(jn,Pt.language)}for(var Wn=0;Wn<un.length;Wn+=1){var lr=un[Wn];if(kt.call(this,lr,xt,Ct,It,Pt),lr.advanceWidth&&(xt+=lr.advanceWidth*Yt),Pt.kerning&&Wn<un.length-1){var Yn=an?this.position.getKerningValue(an,lr.index,un[Wn+1].index):this.getKerningValue(lr,un[Wn+1]);xt+=Yn*Yt}Pt.letterSpacing?xt+=Pt.letterSpacing*It:Pt.tracking&&(xt+=Pt.tracking/1e3*It)}return xt},ws.prototype.getPath=function(pt,xt,Ct,It,Pt){var kt=new Ut;return this.forEachGlyph(pt,xt,Ct,It,Pt,function(Yt,un,an,jn){var Wn=Yt.getPath(un,an,jn,Pt,this);kt.extend(Wn)}),kt},ws.prototype.getPaths=function(pt,xt,Ct,It,Pt){var kt=[];return this.forEachGlyph(pt,xt,Ct,It,Pt,function(Yt,un,an,jn){var Wn=Yt.getPath(un,an,jn,Pt,this);kt.push(Wn)}),kt},ws.prototype.getAdvanceWidth=function(pt,xt,Ct){return this.forEachGlyph(pt,0,0,xt,Ct,function(){})},ws.prototype.draw=function(pt,xt,Ct,It,Pt,kt){this.getPath(xt,Ct,It,Pt,kt).draw(pt)},ws.prototype.drawPoints=function(pt,xt,Ct,It,Pt,kt){this.forEachGlyph(xt,Ct,It,Pt,kt,function(Yt,un,an,jn){Yt.drawPoints(pt,un,an,jn)})},ws.prototype.drawMetrics=function(pt,xt,Ct,It,Pt,kt){this.forEachGlyph(xt,Ct,It,Pt,kt,function(Yt,un,an,jn){Yt.drawMetrics(pt,un,an,jn)})},ws.prototype.getEnglishName=function(pt){var xt=this.names[pt];if(xt)return xt.en},ws.prototype.validate=function(){var pt=this;function xt(It){}function Ct(It){var Pt=pt.getEnglishName(It);Pt&&Pt.trim().length>0}Ct("fontFamily"),Ct("weightName"),Ct("manufacturer"),Ct("copyright"),Ct("version"),this.unitsPerEm>0},ws.prototype.toTables=function(){return x0.fontToTable(this)},ws.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},ws.prototype.toArrayBuffer=function(){for(var pt=this.toTables(),xt=pt.encode(),Ct=new ArrayBuffer(xt.length),It=new Uint8Array(Ct),Pt=0;Pt<xt.length;Pt++)It[Pt]=xt[Pt];return Ct},ws.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},ws.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},ws.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};function Go(pt,xt){var Ct=JSON.stringify(pt),It=256;for(var Pt in xt){var kt=parseInt(Pt);if(!(!kt||kt<256)){if(JSON.stringify(xt[Pt])===Ct)return kt;It<=kt&&(It=kt+1)}}return xt[It]=pt,It}function Ul(pt,xt,Ct){var It=Go(xt.name,Ct);return[{name:"tag_"+pt,type:"TAG",value:xt.tag},{name:"minValue_"+pt,type:"FIXED",value:xt.minValue<<16},{name:"defaultValue_"+pt,type:"FIXED",value:xt.defaultValue<<16},{name:"maxValue_"+pt,type:"FIXED",value:xt.maxValue<<16},{name:"flags_"+pt,type:"USHORT",value:0},{name:"nameID_"+pt,type:"USHORT",value:It}]}function fp(pt,xt,Ct){var It={},Pt=new Mn.Parser(pt,xt);return It.tag=Pt.parseTag(),It.minValue=Pt.parseFixed(),It.defaultValue=Pt.parseFixed(),It.maxValue=Pt.parseFixed(),Pt.skip("uShort",1),It.name=Ct[Pt.parseUShort()]||{},It}function ko(pt,xt,Ct,It){for(var Pt=Go(xt.name,It),kt=[{name:"nameID_"+pt,type:"USHORT",value:Pt},{name:"flags_"+pt,type:"USHORT",value:0}],Yt=0;Yt<Ct.length;++Yt){var un=Ct[Yt].tag;kt.push({name:"axis_"+pt+" "+un,type:"FIXED",value:xt.coordinates[un]<<16})}return kt}function Vp(pt,xt,Ct,It){var Pt={},kt=new Mn.Parser(pt,xt);Pt.name=It[kt.parseUShort()]||{},kt.skip("uShort",1),Pt.coordinates={};for(var Yt=0;Yt<Ct.length;++Yt)Pt.coordinates[Ct[Yt].tag]=kt.parseFixed();return Pt}function dp(pt,xt){var Ct=new Qn.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:pt.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:pt.instances.length},{name:"instanceSize",type:"USHORT",value:4+pt.axes.length*4}]);Ct.offsetToData=Ct.sizeOf();for(var It=0;It<pt.axes.length;It++)Ct.fields=Ct.fields.concat(Ul(It,pt.axes[It],xt));for(var Pt=0;Pt<pt.instances.length;Pt++)Ct.fields=Ct.fields.concat(ko(Pt,pt.instances[Pt],pt.axes,xt));return Ct}function Im(pt,xt,Ct){var It=new Mn.Parser(pt,xt),Pt=It.parseULong();Jt.argument(Pt===65536,"Unsupported fvar table version.");var kt=It.parseOffset16();It.skip("uShort",1);for(var Yt=It.parseUShort(),un=It.parseUShort(),an=It.parseUShort(),jn=It.parseUShort(),Wn=[],lr=0;lr<Yt;lr++)Wn.push(fp(pt,xt+kt+lr*un,Ct));for(var Yn=[],hr=xt+kt+Yt*un,Lr=0;Lr<an;Lr++)Yn.push(Vp(pt,hr+Lr*jn,Wn,Ct));return{axes:Wn,instances:Yn}}var u0={make:dp,parse:Im},zp=function(){return{coverage:this.parsePointer(yn.coverage),attachPoints:this.parseList(yn.pointer(yn.uShortList))}},Sl=function(){var pt=this.parseUShort();if(Jt.argument(pt===1||pt===2||pt===3,"Unsupported CaretValue table version."),pt===1)return{coordinate:this.parseShort()};if(pt===2)return{pointindex:this.parseShort()};if(pt===3)return{coordinate:this.parseShort()}},Bm=function(){return this.parseList(yn.pointer(Sl))},Hp=function(){return{coverage:this.parsePointer(yn.coverage),ligGlyphs:this.parseList(yn.pointer(Bm))}},pp=function(){return this.parseUShort(),this.parseList(yn.pointer(yn.coverage))};function Rm(pt,xt){xt=xt||0;var Ct=new yn(pt,xt),It=Ct.parseVersion(1);Jt.argument(It===1||It===1.2||It===1.3,"Unsupported GDEF table version.");var Pt={version:It,classDef:Ct.parsePointer(yn.classDef),attachList:Ct.parsePointer(zp),ligCaretList:Ct.parsePointer(Hp),markAttachClassDef:Ct.parsePointer(yn.classDef)};return It>=1.2&&(Pt.markGlyphSets=Ct.parsePointer(pp)),Pt}var h0={parse:Rm},Vo=new Array(10);Vo[1]=function(){var xt=this.offset+this.relativeOffset,Ct=this.parseUShort();if(Ct===1)return{posFormat:1,coverage:this.parsePointer(yn.coverage),value:this.parseValueRecord()};if(Ct===2)return{posFormat:2,coverage:this.parsePointer(yn.coverage),values:this.parseValueRecordList()};Jt.assert(!1,"0x"+xt.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Vo[2]=function(){var xt=this.offset+this.relativeOffset,Ct=this.parseUShort();Jt.assert(Ct===1||Ct===2,"0x"+xt.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var It=this.parsePointer(yn.coverage),Pt=this.parseUShort(),kt=this.parseUShort();if(Ct===1)return{posFormat:Ct,coverage:It,valueFormat1:Pt,valueFormat2:kt,pairSets:this.parseList(yn.pointer(yn.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(Pt),value2:this.parseValueRecord(kt)}})))};if(Ct===2){var Yt=this.parsePointer(yn.classDef),un=this.parsePointer(yn.classDef),an=this.parseUShort(),jn=this.parseUShort();return{posFormat:Ct,coverage:It,valueFormat1:Pt,valueFormat2:kt,classDef1:Yt,classDef2:un,class1Count:an,class2Count:jn,classRecords:this.parseList(an,yn.list(jn,function(){return{value1:this.parseValueRecord(Pt),value2:this.parseValueRecord(kt)}}))}}},Vo[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Vo[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Vo[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Vo[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Vo[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Vo[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Vo[9]=function(){return{error:"GPOS Lookup 9 not supported"}};function Fm(pt,xt){xt=xt||0;var Ct=new yn(pt,xt),It=Ct.parseVersion(1);return Jt.argument(It===1||It===1.1,"Unsupported GPOS table version "+It),It===1?{version:It,scripts:Ct.parseScriptList(),features:Ct.parseFeatureList(),lookups:Ct.parseLookupList(Vo)}:{version:It,scripts:Ct.parseScriptList(),features:Ct.parseFeatureList(),lookups:Ct.parseLookupList(Vo),variations:Ct.parseFeatureVariationsList()}}var Fu=new Array(10);function Qp(pt){return new Qn.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Qn.ScriptList(pt.scripts)},{name:"features",type:"TABLE",value:new Qn.FeatureList(pt.features)},{name:"lookups",type:"TABLE",value:new Qn.LookupList(pt.lookups,Fu)}])}var mp={parse:Fm,make:Qp};function gp(pt){var xt={};pt.skip("uShort");var Ct=pt.parseUShort();Jt.argument(Ct===0,"Unsupported kern sub-table version."),pt.skip("uShort",2);var It=pt.parseUShort();pt.skip("uShort",3);for(var Pt=0;Pt<It;Pt+=1){var kt=pt.parseUShort(),Yt=pt.parseUShort(),un=pt.parseShort();xt[kt+","+Yt]=un}return xt}function Pm(pt){var xt={};pt.skip("uShort");var Ct=pt.parseULong();Ct>1&&console.warn("Only the first kern subtable is supported."),pt.skip("uLong");var It=pt.parseUShort(),Pt=It&255;if(pt.skip("uShort"),Pt===0){var kt=pt.parseUShort();pt.skip("uShort",3);for(var Yt=0;Yt<kt;Yt+=1){var un=pt.parseUShort(),an=pt.parseUShort(),jn=pt.parseShort();xt[un+","+an]=jn}}return xt}function Wp(pt,xt){var Ct=new Mn.Parser(pt,xt),It=Ct.parseUShort();if(It===0)return gp(Ct);if(It===1)return Pm(Ct);throw new Error("Unsupported kern table version ("+It+").")}var Al={parse:Wp};function du(pt,xt,Ct,It){for(var Pt=new Mn.Parser(pt,xt),kt=It?Pt.parseUShort:Pt.parseULong,Yt=[],un=0;un<Ct+1;un+=1){var an=kt.call(Pt);It&&(an*=2),Yt.push(an)}return Yt}var $l={parse:du};function jp(pt,xt){for(var Ct=[],It=12,Pt=0;Pt<xt;Pt+=1){var kt=Mn.getTag(pt,It),Yt=Mn.getULong(pt,It+4),un=Mn.getULong(pt,It+8),an=Mn.getULong(pt,It+12);Ct.push({tag:kt,checksum:Yt,offset:un,length:an,compression:!1}),It+=16}return Ct}function Cl(pt,xt){for(var Ct=[],It=44,Pt=0;Pt<xt;Pt+=1){var kt=Mn.getTag(pt,It),Yt=Mn.getULong(pt,It+4),un=Mn.getULong(pt,It+8),an=Mn.getULong(pt,It+12),jn=void 0;un<an?jn="WOFF":jn=!1,Ct.push({tag:kt,offset:Yt,compression:jn,compressedLength:un,length:an}),It+=20}return Ct}function yo(pt,xt){if(xt.compression==="WOFF"){var Ct=new Uint8Array(pt.buffer,xt.offset+2,xt.compressedLength-2),It=new Uint8Array(xt.length);if(Mt(Ct,It),It.byteLength!==xt.length)throw new Error("Decompression error: "+xt.tag+" decompressed length doesn't match recorded length");var Pt=new DataView(It.buffer,0);return{data:Pt,offset:0}}else return{data:pt,offset:xt.offset}}function f0(pt,xt){xt=xt??{};var Ct,It,Pt=new ws({empty:!0}),kt=new DataView(pt,0),Yt,un=[],an=Mn.getTag(kt,0);if(an===String.fromCharCode(0,1,0,0)||an==="true"||an==="typ1")Pt.outlinesFormat="truetype",Yt=Mn.getUShort(kt,4),un=jp(kt,Yt);else if(an==="OTTO")Pt.outlinesFormat="cff",Yt=Mn.getUShort(kt,4),un=jp(kt,Yt);else if(an==="wOFF"){var jn=Mn.getTag(kt,4);if(jn===String.fromCharCode(0,1,0,0))Pt.outlinesFormat="truetype";else if(jn==="OTTO")Pt.outlinesFormat="cff";else throw new Error("Unsupported OpenType flavor "+an);Yt=Mn.getUShort(kt,12),un=Cl(kt,Yt)}else throw new Error("Unsupported OpenType signature "+an);for(var Wn,lr,Yn,hr,Lr,jr,Xr,Wr,bs,kr,Zs,Is,fo=0;fo<Yt;fo+=1){var Rs=un[fo],hs=void 0;switch(Rs.tag){case"cmap":hs=yo(kt,Rs),Pt.tables.cmap=pr.parse(hs.data,hs.offset),Pt.encoding=new $r(Pt.tables.cmap);break;case"cvt ":hs=yo(kt,Rs),Is=new Mn.Parser(hs.data,hs.offset),Pt.tables.cvt=Is.parseShortList(Rs.length/2);break;case"fvar":lr=Rs;break;case"fpgm":hs=yo(kt,Rs),Is=new Mn.Parser(hs.data,hs.offset),Pt.tables.fpgm=Is.parseByteList(Rs.length);break;case"head":hs=yo(kt,Rs),Pt.tables.head=fs.parse(hs.data,hs.offset),Pt.unitsPerEm=Pt.tables.head.unitsPerEm,Ct=Pt.tables.head.indexToLocFormat;break;case"hhea":hs=yo(kt,Rs),Pt.tables.hhea=vn.parse(hs.data,hs.offset),Pt.ascender=Pt.tables.hhea.ascender,Pt.descender=Pt.tables.hhea.descender,Pt.numberOfHMetrics=Pt.tables.hhea.numberOfHMetrics;break;case"hmtx":Xr=Rs;break;case"ltag":hs=yo(kt,Rs),It=Yr.parse(hs.data,hs.offset);break;case"maxp":hs=yo(kt,Rs),Pt.tables.maxp=vs.parse(hs.data,hs.offset),Pt.numGlyphs=Pt.tables.maxp.numGlyphs;break;case"name":kr=Rs;break;case"OS/2":hs=yo(kt,Rs),Pt.tables.os2=ep.parse(hs.data,hs.offset);break;case"post":hs=yo(kt,Rs),Pt.tables.post=Xo.parse(hs.data,hs.offset),Pt.glyphNames=new Hr(Pt.tables.post);break;case"prep":hs=yo(kt,Rs),Is=new Mn.Parser(hs.data,hs.offset),Pt.tables.prep=Is.parseByteList(Rs.length);break;case"glyf":Yn=Rs;break;case"loca":bs=Rs;break;case"CFF ":Wn=Rs;break;case"kern":Wr=Rs;break;case"GDEF":hr=Rs;break;case"GPOS":Lr=Rs;break;case"GSUB":jr=Rs;break;case"meta":Zs=Rs;break}}var bo=yo(kt,kr);if(Pt.tables.name=Jl.parse(bo.data,bo.offset,It),Pt.names=Pt.tables.name,Yn&&bs){var Zo=Ct===0,lo=yo(kt,bs),Tl=$l.parse(lo.data,lo.offset,Pt.numGlyphs,Zo),Xl=yo(kt,Yn);Pt.glyphs=tm.parse(Xl.data,Xl.offset,Tl,Pt,xt)}else if(Wn){var oo=yo(kt,Wn);$o.parse(oo.data,oo.offset,Pt,xt)}else throw new Error("Font doesn't contain TrueType or CFF outlines.");var go=yo(kt,Xr);if(Er.parse(Pt,go.data,go.offset,Pt.numberOfHMetrics,Pt.numGlyphs,Pt.glyphs,xt),Fr(Pt,xt),Wr){var no=yo(kt,Wr);Pt.kerningPairs=Al.parse(no.data,no.offset)}else Pt.kerningPairs={};if(hr){var Qs=yo(kt,hr);Pt.tables.gdef=h0.parse(Qs.data,Qs.offset)}if(Lr){var _o=yo(kt,Lr);Pt.tables.gpos=mp.parse(_o.data,_o.offset),Pt.position.init()}if(jr){var Io=yo(kt,jr);Pt.tables.gsub=Fl.parse(Io.data,Io.offset)}if(lr){var ss=yo(kt,lr);Pt.tables.fvar=u0.parse(ss.data,ss.offset,Pt.names)}if(Zs){var po=yo(kt,Zs);Pt.tables.meta=Du.parse(po.data,po.offset),Pt.metas=Pt.tables.meta}return Pt}return{parseBuffer:f0}})();class TTFLoader extends Loader{constructor(s){super(s),this.reversed=!1}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(parseBuffer(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o($,_e){const tt=Math.round,nt={},rt=1e5/(($.unitsPerEm||2048)*72),it=$.encoding.cmap.glyphIndexMap,st=Object.keys(it);for(let at=0;at<st.length;at++){const ot=st[at],ct=$.glyphs.glyphs[it[ot]];if(ot!==void 0){const ft={ha:tt(ct.advanceWidth*rt),x_min:tt(ct.xMin*rt),x_max:tt(ct.xMax*rt),o:""};_e&&(ct.path.commands=j(ct.path.commands)),ct.path.commands.forEach(function(ht){ht.type.toLowerCase()==="c"&&(ht.type="b"),ft.o+=ht.type.toLowerCase()+" ",ht.x!==void 0&&ht.y!==void 0&&(ft.o+=tt(ht.x*rt)+" "+tt(ht.y*rt)+" "),ht.x1!==void 0&&ht.y1!==void 0&&(ft.o+=tt(ht.x1*rt)+" "+tt(ht.y1*rt)+" "),ht.x2!==void 0&&ht.y2!==void 0&&(ft.o+=tt(ht.x2*rt)+" "+tt(ht.y2*rt)+" ")}),nt[String.fromCodePoint(ct.unicode)]=ft}}return{glyphs:nt,familyName:$.getEnglishName("fullName"),ascender:tt($.ascender*rt),descender:tt($.descender*rt),underlinePosition:$.tables.post.underlinePosition,underlineThickness:$.tables.post.underlineThickness,boundingBox:{xMin:$.tables.head.xMin,xMax:$.tables.head.xMax,yMin:$.tables.head.yMin,yMax:$.tables.head.yMax},resolution:1e3,original_font_information:$.tables.name}}function j($){const _e=[];let tt;$.forEach(function(rt){rt.type.toLowerCase()==="m"?(tt=[rt],_e.push(tt)):rt.type.toLowerCase()!=="z"&&tt.push(rt)});const nt=[];return _e.forEach(function(rt){const it={type:"m",x:rt[rt.length-1].x,y:rt[rt.length-1].y};nt.push(it);for(let st=rt.length-1;st>0;st--){const at=rt[st],ot={type:at.type};at.x2!==void 0&&at.y2!==void 0?(ot.x1=at.x2,ot.y1=at.y2,ot.x2=at.x1,ot.y2=at.y1):at.x1!==void 0&&at.y1!==void 0&&(ot.x1=at.x1,ot.y1=at.y1),ot.x=rt[st-1].x,ot.y=rt[st-1].y,nt.push(ot)}}),nt}return o(parseBuffer(s),this.reversed)}}class RGBELoader extends DataTextureLoader{constructor(s){super(s),this.type=HalfFloatType}parse(s){const nt=function(dt,gt){switch(dt){case 1:console.error("THREE.RGBELoader Read Error: "+(gt||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(gt||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(gt||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(gt||""))}return-1},at=`
`,ot=function(dt,gt,Et){gt=gt||1024;let Tt=dt.pos,Mt=-1,Bt=0,Rt="",Ut=String.fromCharCode.apply(null,new Uint16Array(dt.subarray(Tt,Tt+128)));for(;0>(Mt=Ut.indexOf(at))&&Bt<gt&&Tt<dt.byteLength;)Rt+=Ut,Bt+=Ut.length,Tt+=128,Ut+=String.fromCharCode.apply(null,new Uint16Array(dt.subarray(Tt,Tt+128)));return-1<Mt?(Et!==!1&&(dt.pos+=Bt+Mt+1),Rt+Ut.slice(0,Mt)):!1},ct=function(dt){const gt=/^#\?(\S+)/,Et=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,St=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Tt=/^\s*FORMAT=(\S+)\s*$/,Mt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Bt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Rt,Ut;if(dt.pos>=dt.byteLength||!(Rt=ot(dt)))return nt(1,"no header found");if(!(Ut=Rt.match(gt)))return nt(3,"bad initial token");for(Bt.valid|=1,Bt.programtype=Ut[1],Bt.string+=Rt+`
`;Rt=ot(dt),Rt!==!1;){if(Bt.string+=Rt+`
`,Rt.charAt(0)==="#"){Bt.comments+=Rt+`
`;continue}if((Ut=Rt.match(Et))&&(Bt.gamma=parseFloat(Ut[1])),(Ut=Rt.match(St))&&(Bt.exposure=parseFloat(Ut[1])),(Ut=Rt.match(Tt))&&(Bt.valid|=2,Bt.format=Ut[1]),(Ut=Rt.match(Mt))&&(Bt.valid|=4,Bt.height=parseInt(Ut[1],10),Bt.width=parseInt(Ut[2],10)),Bt.valid&2&&Bt.valid&4)break}return Bt.valid&2?Bt.valid&4?Bt:nt(3,"missing image size specifier"):nt(3,"missing format specifier")},ft=function(dt,gt,Et){const St=gt;if(St<8||St>32767||dt[0]!==2||dt[1]!==2||dt[2]&128)return new Uint8Array(dt);if(St!==(dt[2]<<8|dt[3]))return nt(3,"wrong scanline width");const Tt=new Uint8Array(4*gt*Et);if(!Tt.length)return nt(4,"unable to allocate buffer space");let Mt=0,Bt=0;const Rt=4*St,Ut=new Uint8Array(4),Ht=new Uint8Array(Rt);let Wt=Et;for(;Wt>0&&Bt<dt.byteLength;){if(Bt+4>dt.byteLength)return nt(1);if(Ut[0]=dt[Bt++],Ut[1]=dt[Bt++],Ut[2]=dt[Bt++],Ut[3]=dt[Bt++],Ut[0]!=2||Ut[1]!=2||(Ut[2]<<8|Ut[3])!=St)return nt(3,"bad rgbe scanline format");let Jt=0,sn;for(;Jt<Rt&&Bt<dt.byteLength;){sn=dt[Bt++];const Vt=sn>128;if(Vt&&(sn-=128),sn===0||Jt+sn>Rt)return nt(3,"bad scanline data");if(Vt){const Lt=dt[Bt++];for(let Qt=0;Qt<sn;Qt++)Ht[Jt++]=Lt}else Ht.set(dt.subarray(Bt,Bt+sn),Jt),Jt+=sn,Bt+=sn}const jt=St;for(let Vt=0;Vt<jt;Vt++){let Lt=0;Tt[Mt]=Ht[Vt+Lt],Lt+=St,Tt[Mt+1]=Ht[Vt+Lt],Lt+=St,Tt[Mt+2]=Ht[Vt+Lt],Lt+=St,Tt[Mt+3]=Ht[Vt+Lt],Mt+=4}Wt--}return Tt},ht=function(dt,gt,Et,St){const Tt=dt[gt+3],Mt=Math.pow(2,Tt-128)/255;Et[St+0]=dt[gt+0]*Mt,Et[St+1]=dt[gt+1]*Mt,Et[St+2]=dt[gt+2]*Mt,Et[St+3]=1},mt=function(dt,gt,Et,St){const Tt=dt[gt+3],Mt=Math.pow(2,Tt-128)/255;Et[St+0]=DataUtils.toHalfFloat(Math.min(dt[gt+0]*Mt,65504)),Et[St+1]=DataUtils.toHalfFloat(Math.min(dt[gt+1]*Mt,65504)),Et[St+2]=DataUtils.toHalfFloat(Math.min(dt[gt+2]*Mt,65504)),Et[St+3]=DataUtils.toHalfFloat(1)},lt=new Uint8Array(s);lt.pos=0;const ut=ct(lt);if(ut!==-1){const dt=ut.width,gt=ut.height,Et=ft(lt.subarray(lt.pos),dt,gt);if(Et!==-1){let St,Tt,Mt;switch(this.type){case FloatType:Mt=Et.length/4;const Bt=new Float32Array(Mt*4);for(let Ut=0;Ut<Mt;Ut++)ht(Et,Ut*4,Bt,Ut*4);St=Bt,Tt=FloatType;break;case HalfFloatType:Mt=Et.length/4;const Rt=new Uint16Array(Mt*4);for(let Ut=0;Ut<Mt;Ut++)mt(Et,Ut*4,Rt,Ut*4);St=Rt,Tt=HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:dt,height:gt,data:St,header:ut.string,gamma:ut.gamma,exposure:ut.exposure,type:Tt}}}return null}setDataType(s){return this.type=s,this}load(s,o,j,$){function _e(tt,nt){switch(tt.type){case FloatType:case HalfFloatType:"colorSpace"in tt?tt.colorSpace="srgb-linear":tt.encoding=3e3,tt.minFilter=LinearFilter,tt.magFilter=LinearFilter,tt.generateMipmaps=!1,tt.flipY=!0;break}o&&o(tt,nt)}return super.load(s,_e,j,$)}}class AssimpLoader extends Loader{load(s,o,j,$){var _e=this,tt=_e.path===""?LoaderUtils.extractUrlBase(s):_e.path,nt=new FileLoader(_e.manager);nt.setPath(_e.path),nt.setResponseType("arraybuffer"),nt.setRequestHeader(_e.requestHeader),nt.setWithCredentials(_e.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}parse(s,o){var j=new TextureLoader(this.manager);j.setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);var $={};$.KeyFrame=class{constructor(Gt,zt){this.time=Gt,this.matrix=zt.clone(),this.position=new Vector3,this.quaternion=new Quaternion,this.scale=new Vector3(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){var on=new $.KeyFrame(this.time,this.matrix);return on},this.lerp=function(on,dn){dn-=this.time;var Vn=on.time-this.time,Kn=dn/Vn,sr=1-Kn,ar=this.position,cr=this.quaternion,ur=on.position,wr=on.quaternion;return $.KeyFrame.tempAniPos.x=ar.x*sr+ur.x*Kn,$.KeyFrame.tempAniPos.y=ar.y*sr+ur.y*Kn,$.KeyFrame.tempAniPos.z=ar.z*sr+ur.z*Kn,$.KeyFrame.tempAniQuat.set(cr.x,cr.y,cr.z,cr.w),$.KeyFrame.tempAniQuat.slerp(wr,Kn),$.KeyFrame.tempAniMatrix.compose($.KeyFrame.tempAniPos,$.KeyFrame.tempAniQuat,$.KeyFrame.tempAniScale)}}},$.KeyFrame.tempAniPos=new Vector3,$.KeyFrame.tempAniQuat=new Quaternion,$.KeyFrame.tempAniScale=new Vector3(1,1,1),$.KeyFrame.tempAniMatrix=new Matrix4,$.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(Gt){this.keys.push(Gt)},this.init=function(){if(this.sortKeys(),this.keys.length>0?this.length=this.keys[this.keys.length-1].time:this.length=0,!!this.fps){for(let Gt=0;Gt<this.length*this.fps;Gt++)for(let zt=0;zt<this.keys.length;zt++)if(this.keys[zt].time==Gt){this._accelTable[Gt]=zt;break}else if(this.keys[zt].time<Gt/this.fps&&this.keys[zt+1]&&this.keys[zt+1].time>=Gt/this.fps){this._accelTable[Gt]=zt;break}}},this.parseFromThree=function(Gt){var zt=Gt.fps;this.target=Gt.node;var on=Gt.hierarchy[0].keys;for(let dn=0;dn<on.length;dn++)this.addKey(new $.KeyFrame(dn/zt||on[dn].time,on[dn].targets[0].data));this.init()},this.parseFromCollada=function(Gt){var zt=Gt.keys,on=this.fps;for(let dn=0;dn<zt.length;dn++)this.addKey(new $.KeyFrame(dn/on||zt[dn].time,zt[dn].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(Gt,zt){return Gt.time-zt.time},this.clone=function(){var Gt=new $.KeyFrameTrack;Gt.target=this.target,Gt.time=this.time,Gt.length=this.length;for(let zt=0;zt<this.keys.length;zt++)Gt.addKey(this.keys[zt].clone());return Gt.init(),Gt},this.reTarget=function(Gt,zt){zt||(zt=$.TrackTargetNodeNameCompare),this.target=zt(Gt,this.target)},this.keySearchAccel=function(Gt){return Gt*=this.fps,Gt=Math.floor(Gt),this._accelTable[Gt]||0},this.setTime=function(Gt){Gt=Math.abs(Gt),this.length&&(Gt=Gt%this.length+.05);var zt=null,on=null;for(let dn=this.keySearchAccel(Gt);dn<this.keys.length;dn++)if(this.keys[dn].time==Gt){zt=this.keys[dn],on=this.keys[dn];break}else if(this.keys[dn].time<Gt&&this.keys[dn+1]&&this.keys[dn+1].time>Gt){zt=this.keys[dn],on=this.keys[dn+1];break}else if(this.keys[dn].time<Gt&&dn==this.keys.length-1){zt=this.keys[dn],on=this.keys[0].clone(),on.time+=this.length+.05;break}if(zt&&on&&zt!==on){this.target.matrixAutoUpdate=!1,this.target.matrix.copy(zt.lerp(on,Gt)),this.target.matrixWorldNeedsUpdate=!0;return}if(zt&&on&&zt==on){this.target.matrixAutoUpdate=!1,this.target.matrix.copy(zt.matrix),this.target.matrixWorldNeedsUpdate=!0;return}}},$.TrackTargetNodeNameCompare=function(Gt,zt){function on(dn,Vn){if(dn.name==Vn)return dn;for(let sr=0;sr<dn.children.length;sr++){var Kn=on(dn.children[sr],Vn);if(Kn)return Kn}return null}return on(Gt,zt.name)},$.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(Gt){this.tracks.push(Gt),this.length=Math.max(Gt.length,this.length)},this.setTime=function(Gt){this.time=Gt;for(let zt=0;zt<this.tracks.length;zt++)this.tracks[zt].setTime(Gt)},this.clone=function(Gt,zt){zt||(zt=$.TrackTargetNodeNameCompare);var on=new $.Animation;on.target=Gt;for(let Vn=0;Vn<this.tracks.length;Vn++){var dn=this.tracks[Vn].clone();dn.reTarget(Gt,zt),on.addTrack(dn)}return on}};var _e=4660,tt=4661,nt=4662,rt=4663,it=4664,st=4665,at=4666,ot=4667,ct=4668,ft=4669,ht=4670,mt=1,lt=2,ut=4,dt=256,gt=65536,Et=1,St=4;//! A directional light source has a well-defined direction
//! but is infinitely far away. That's quite a good
//! approximation for sun light.
var Tt=1;//! A point light source has a well-defined position
//! in space but no direction - it emits light in all
//! directions. A normal bulb is a point light.
//! A spot light source emits light in a specific
//! angle. It has a position and a direction it is pointing to.
//! A good example for a spot light is a light spot in
//! sport arenas.
var Mt=3;//! The generic light level of the world, including the bounces
//! of all other lightsources.
//! Typically, there's at most one ambient light in a scene.
//! This light type doesn't have a valid position, direction, or
//! other properties, just a color.
var Bt=1,Rt=6,Ut=8,Ht=10,Wt=4;function Jt(Gt){return dt<<Gt}function sn(Gt){return gt<<Gt}function jt(Gt){for(let dn in Gt.mMeshes){var zt=Gt.mMeshes[dn];for(let Vn in zt.mBones){var on=Gt.findNode(zt.mBones[Vn].mName);on&&(on.isBone=!0)}}}function Vt(Gt,zt){var on=new Bone;on.matrix.copy(Gt.matrix),on.matrixWorld.copy(Gt.matrixWorld),on.position.copy(Gt.position),on.quaternion.copy(Gt.quaternion),on.scale.copy(Gt.scale),zt.nodeCount++,on.name="bone_"+Gt.name+zt.nodeCount.toString(),zt.nodeToBoneMap[Gt.name]||(zt.nodeToBoneMap[Gt.name]=[]),zt.nodeToBoneMap[Gt.name].push(on);for(let Vn in Gt.children){var dn=Vt(Gt.children[Vn],zt);on.add(dn)}return on}function Lt(Gt,zt){var on=[];for(let Vn=0;Vn<Gt.length;Vn++)on.push({i:Gt[Vn],w:zt[Vn]});for(on.sort(function(Vn,Kn){return Kn.w-Vn.w});on.length<4;)on.push({i:0,w:0});on.length>4&&(on.length=4);var dn=0;for(let Vn=0;Vn<4;Vn++)dn+=on[Vn].w*on[Vn].w;dn=Math.sqrt(dn);for(let Vn=0;Vn<4;Vn++)on[Vn].w=on[Vn].w/dn,Gt[Vn]=on[Vn].i,zt[Vn]=on[Vn].w}function Qt(Gt,zt){if(Gt.name.indexOf("bone_"+zt)==0)return Gt;for(let dn in Gt.children){var on=Qt(Gt.children[dn],zt);if(on)return on}}class nn{constructor(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(zt){if(this.mBones.length!=0){for(var on=[],dn=[],Vn=zt.findNode(this.mBones[0].mName);Vn.mParent&&Vn.mParent.isBone;)Vn=Vn.mParent;var Kn=Vn.toTHREE(zt),sr=Vt(Kn,zt);this.threeNode.add(sr);for(let wr=0;wr<this.mBones.length;wr++){var ar=Qt(sr,this.mBones[wr].mName);if(ar){var cr=ar;on.push(cr),dn.push(this.mBones[wr].mOffsetMatrix.toTHREE())}else{var Vn=zt.findNode(this.mBones[wr].mName);if(!Vn)return;var Kn=Vn.toTHREE(zt),sr=Vt(Kn,zt);this.threeNode.add(sr);var ar=Qt(sr,this.mBones[wr].mName),cr=ar;on.push(cr),dn.push(this.mBones[wr].mOffsetMatrix.toTHREE())}}var ur=new Skeleton(on,dn);this.threeNode.bind(ur,new Matrix4),this.threeNode.material.skinning=!0}},this.toTHREE=function(zt){if(this.threeNode)return this.threeNode;var on=new BufferGeometry,dn;if(zt.mMaterials[this.mMaterialIndex]?dn=zt.mMaterials[this.mMaterialIndex].toTHREE(zt):dn=new MeshLambertMaterial,on.setIndex(new BufferAttribute(new Uint32Array(this.mIndexArray),1)),on.setAttribute("position",new BufferAttribute(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&on.setAttribute("normal",new BufferAttribute(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&on.setAttribute("color",new BufferAttribute(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&on.setAttribute("uv",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&on.setAttribute("uv1",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&on.setAttribute("tangents",new BufferAttribute(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&on.setAttribute("bitangents",new BufferAttribute(this.mBitangentBuffer,3)),this.mBones.length>0){var Vn=[],Kn=[];for(let wr=0;wr<this.mBones.length;wr++)for(let Mr=0;Mr<this.mBones[wr].mWeights.length;Mr++){var sr=this.mBones[wr].mWeights[Mr];sr&&(Vn[sr.mVertexId]||(Vn[sr.mVertexId]=[]),Kn[sr.mVertexId]||(Kn[sr.mVertexId]=[]),Vn[sr.mVertexId].push(sr.mWeight),Kn[sr.mVertexId].push(parseInt(wr)))}for(let wr in Kn)Lt(Kn[wr],Vn[wr]);var ar=[],cr=[];for(let wr=0;wr<Vn.length;wr++)for(let Mr=0;Mr<4;Mr++)Vn[wr]&&Kn[wr]?(ar.push(Vn[wr][Mr]),cr.push(Kn[wr][Mr])):(ar.push(0),cr.push(0));on.setAttribute("skinWeight",new BufferAttribute(new Float32Array(ar),Wt)),on.setAttribute("skinIndex",new BufferAttribute(new Float32Array(cr),Wt))}var ur;return this.mBones.length==0&&(ur=new Mesh(on,dn)),this.mBones.length>0&&(ur=new SkinnedMesh(on,dn),ur.normalizeSkinWeights()),this.threeNode=ur,ur}}}class mn{constructor(){this.mNumIndices=0,this.mIndices=[]}}class Zt{constructor(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new Vector3(this.x,this.y,this.z)}}}class cn{constructor(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new Color(this.r,this.g,this.b)}}}class Ot{constructor(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new Quaternion(this.x,this.y,this.z,this.w)}}}class rn{constructor(){this.mVertexId=0,this.mWeight=0}}class fn{constructor(){this.data=[],this.toString=function(){var zt="";return this.data.forEach(function(on){zt+=String.fromCharCode(on)}),zt.replace(/[^\x20-\x7E]+/g,"")}}}class hn{constructor(){this.mTime=0,this.mValue=null}}class Tn{constructor(){this.mTime=0,this.mValue=null}}class Nn{constructor(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(zt){if(this.threeNode)return this.threeNode;var on=new Object3D;on.name=this.mName,on.matrix=this.mTransformation.toTHREE();for(let dn=0;dn<this.mChildren.length;dn++)on.add(this.mChildren[dn].toTHREE(zt));for(let dn=0;dn<this.mMeshes.length;dn++)on.add(zt.mMeshes[this.mMeshes[dn]].toTHREE(zt));return this.threeNode=on,on.matrix.decompose(on.position,on.quaternion,on.scale),on}}}class Pn{constructor(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}}class Dn{constructor(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var zt=new Uint8Array(this.mData).buffer,on=new DataView(zt),dn=on.getFloat32(0,!0),Vn=on.getFloat32(4,!0),Kn=on.getFloat32(8,!0);return new Color(dn,Vn,Kn)},this.dataAsFloat=function(){var zt=new Uint8Array(this.mData).buffer,on=new DataView(zt),dn=on.getFloat32(0,!0);return dn},this.dataAsBool=function(){var zt=new Uint8Array(this.mData).buffer,on=new DataView(zt),dn=on.getFloat32(0,!0);return!!dn},this.dataAsString=function(){var zt=new fn;return zt.data=this.mData,zt.toString()},this.dataAsMap=function(){var zt=new fn;zt.data=this.mData;var on=zt.toString();return on=on.replace(/\\/g,"/"),on.indexOf("/")!=-1&&(on=on.substr(on.lastIndexOf("/")+1)),j.load(on)}}}var ln={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},Cn={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"};class bn{constructor(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(){var zt=new MeshPhongMaterial;for(let dn=0;dn<this.mProperties.length;dn++)if(Cn[this.mProperties[dn].mKey]=="float"&&(zt[ln[this.mProperties[dn].mKey]]=this.mProperties[dn].dataAsFloat()),Cn[this.mProperties[dn].mKey]=="color"&&(zt[ln[this.mProperties[dn].mKey]]=this.mProperties[dn].dataAsColor()),Cn[this.mProperties[dn].mKey]=="bool"&&(zt[ln[this.mProperties[dn].mKey]]=this.mProperties[dn].dataAsBool()),Cn[this.mProperties[dn].mKey]=="string"&&(zt[ln[this.mProperties[dn].mKey]]=this.mProperties[dn].dataAsString()),Cn[this.mProperties[dn].mKey]=="map"){var on=this.mProperties[dn];on.mSemantic==Bt&&(zt.map=this.mProperties[dn].dataAsMap()),on.mSemantic==Rt&&(zt.normalMap=this.mProperties[dn].dataAsMap()),on.mSemantic==Ht&&(zt.lightMap=this.mProperties[dn].dataAsMap()),on.mSemantic==Ut&&(zt.alphaMap=this.mProperties[dn].dataAsMap())}return zt.ambient.r=.53,zt.ambient.g=.53,zt.ambient.b=.53,zt.color.r=1,zt.color.g=1,zt.color.b=1,zt}}}function kn(Gt,zt,on){var dn=new Vector3,Vn=1-on;return dn.x=Gt.x*on+zt.x*Vn,dn.y=Gt.y*on+zt.y*Vn,dn.z=Gt.z*on+zt.z*Vn,dn}function Sn(Gt,zt,on){return Gt.clone().slerp(zt,1-on)}function xn(Gt,zt,on,dn){if(Gt.length==1)return Gt[0].mValue.toTHREE();var Vn=1/0,Kn=null,sr=null;for(let Mr=0;Mr<Gt.length;Mr++){var ar=Math.abs(Gt[Mr].mTime-zt);ar<Vn&&Gt[Mr].mTime<=zt&&(Vn=ar,Kn=Gt[Mr],sr=Gt[Mr+1])}if(Kn)if(sr){var cr=sr.mTime-Kn.mTime,ur=Kn.mTime-zt,wr=ur/cr;return dn(Kn.mValue.toTHREE(),sr.mValue.toTHREE(),wr)}else{sr=Gt[0].clone(),sr.mTime+=on;var cr=sr.mTime-Kn.mTime,ur=Kn.mTime-zt,wr=ur/cr;return dn(Kn.mValue.toTHREE(),sr.mValue.toTHREE(),wr)}else return null}class Qn{constructor(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(zt){zt||(zt=1);function on(dn){dn.mTime/=zt}this.mPositionKeys.forEach(on),this.mRotationKeys.forEach(on),this.mScalingKeys.forEach(on)},this.sortKeys=function(){function zt(on,dn){return on.mTime-dn.mTime}this.mPositionKeys.sort(zt),this.mRotationKeys.sort(zt),this.mScalingKeys.sort(zt)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(zt){return zt.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(zt){return zt.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(zt){return zt.mTime})))},this.toTHREE=function(zt){this.sortKeys();var on=this.getLength(),dn=new $.KeyFrameTrack;for(let Rr=0;Rr<on;Rr+=.05){var Vn=new Matrix4,Kn=Rr,sr=xn(this.mPositionKeys,Kn,on,kn),ar=xn(this.mScalingKeys,Kn,on,kn),cr=xn(this.mRotationKeys,Kn,on,Sn);Vn.compose(sr,cr,ar);var ur=new $.KeyFrame(Kn,Vn);dn.addKey(ur)}dn.target=zt.findNode(this.mNodeName).toTHREE();var wr=[dn];if(zt.nodeToBoneMap[this.mNodeName])for(let Rr=0;Rr<zt.nodeToBoneMap[this.mNodeName].length;Rr++){var Mr=dn.clone();Mr.target=zt.nodeToBoneMap[this.mNodeName][Rr],wr.push(Mr)}return wr}}}class nr{constructor(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(zt){var on=new $.Animation;for(let Vn in this.mChannels){this.mChannels[Vn].init(this.mTicksPerSecond);var dn=this.mChannels[Vn].toTHREE(zt);for(let Kn in dn)dn[Kn].init(),on.addTrack(dn[Kn])}return on.length=Math.max.apply(null,on.tracks.map(function(Vn){return Vn.length})),on}}}class or{constructor(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}}class mr{constructor(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}}class $n{constructor(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}}class tn{constructor(){this.versionMajor=0,this.versionMinor=0,this.versionRevision=0,this.compileFlags=0,this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(zt,on){if(on||(on=this.mRootNode),on.mName==zt)return on;for(let Vn=0;Vn<on.mChildren.length;Vn++){var dn=this.findNode(zt,on.mChildren[Vn]);if(dn)return dn}return null},this.toTHREE=function(){this.nodeCount=0,jt(this);var zt=this.mRootNode.toTHREE(this);for(let dn in this.mMeshes)this.mMeshes[dn].hookupSkeletons(this);if(this.mAnimations.length>0)var on=this.mAnimations[0].toTHREE(this);return{object:zt,animation:on}}}}class $t{constructor(){this.elements=[[],[],[],[]],this.toTHREE=function(){var zt=new Matrix4;for(let on=0;on<4;++on)for(let dn=0;dn<4;++dn)zt.elements[on*4+dn]=this.elements[dn][on];return zt}}}var An=!0;function En(Gt){var zt=Gt.getFloat32(Gt.readOffset,An);return Gt.readOffset+=4,zt}function In(Gt){var zt=Gt.getFloat64(Gt.readOffset,An);return Gt.readOffset+=8,zt}function Hn(Gt){var zt=Gt.getUint8(Gt.readOffset);return Gt.readOffset+=1,zt}function yn(Gt){var zt=Gt.getUint16(Gt.readOffset,An);return Gt.readOffset+=2,zt}function On(Gt){var zt=Gt.getUint32(Gt.readOffset,An);return Gt.readOffset+=4,zt}function Mn(Gt){var zt=Gt.getUint32(Gt.readOffset,An);return Gt.readOffset+=4,zt}function tr(Gt){var zt=new Zt;return zt.x=En(Gt),zt.y=En(Gt),zt.z=En(Gt),zt}function gr(Gt){var zt=new cn;return zt.r=En(Gt),zt.g=En(Gt),zt.b=En(Gt),zt}function Cr(Gt){var zt=new Ot;return zt.w=En(Gt),zt.x=En(Gt),zt.y=En(Gt),zt.z=En(Gt),zt}function Sr(Gt){var zt=new fn,on=On(Gt);return Gt.ReadBytes(zt.data,1,on),zt.toString()}function Un(Gt){var zt=new rn;return zt.mVertexId=On(Gt),zt.mWeight=En(Gt),zt}function Jn(Gt){var zt=new $t;for(let on=0;on<4;++on)for(let dn=0;dn<4;++dn)zt.elements[on][dn]=En(Gt);return zt}function pr(Gt){var zt=new hn;return zt.mTime=In(Gt),zt.mValue=tr(Gt),zt}function Gn(Gt){var zt=new Tn;return zt.mTime=In(Gt),zt.mValue=Cr(Gt),zt}function Zn(Gt,zt,on){for(let dn=0;dn<on;dn++)zt[dn]=Un(Gt)}function qn(Gt,zt,on){for(let dn=0;dn<on;dn++)zt[dn]=pr(Gt)}function vr(Gt,zt,on){for(let dn=0;dn<on;dn++)zt[dn]=Gn(Gt)}function _r(Gt,zt,on){return Gt.Seek(sizeof(zt)*on,Ks)}function $r(Gt){if(!Gt)throw"asset failed"}function es(Gt,zt,on){var dn=Mn(Gt);$r(dn==ct),Mn(Gt);var Vn=new Nn;if(Vn.mParent=zt,Vn.mDepth=on,Vn.mName=Sr(Gt),Vn.mTransformation=Jn(Gt),Vn.mNumChildren=On(Gt),Vn.mNumMeshes=On(Gt),Vn.mNumMeshes){Vn.mMeshes=[];for(let sr=0;sr<Vn.mNumMeshes;++sr)Vn.mMeshes[sr]=On(Gt)}if(Vn.mNumChildren){Vn.mChildren=[];for(let sr=0;sr<Vn.mNumChildren;++sr){var Kn=es(Gt,Vn,on++);Vn.mChildren[sr]=Kn}}return Vn}function Hr(Gt,zt){var on=Mn(Gt);return $r(on==at),Mn(Gt),zt.mName=Sr(Gt),zt.mNumWeights=On(Gt),zt.mOffsetMatrix=Jn(Gt),js?_r(Gt,zt.mWeights,zt.mNumWeights):(zt.mWeights=[],Zn(Gt,zt.mWeights,zt.mNumWeights)),zt}function Ur(Gt,zt){var on=Mn(Gt);$r(on==rt),Mn(Gt),zt.mPrimitiveTypes=On(Gt),zt.mNumVertices=On(Gt),zt.mNumFaces=On(Gt),zt.mNumBones=On(Gt),zt.mMaterialIndex=On(Gt),zt.mNumUVComponents=[];var dn=On(Gt);dn&mt&&(js?_r(Gt,zt.mVertices,zt.mNumVertices):(zt.mVertices=[],zt.mVertexBuffer=Gt.subArray32(Gt.readOffset,Gt.readOffset+zt.mNumVertices*3*4),Gt.Seek(zt.mNumVertices*3*4,Ks))),dn&lt&&(js?_r(Gt,zt.mNormals,zt.mNumVertices):(zt.mNormals=[],zt.mNormalBuffer=Gt.subArray32(Gt.readOffset,Gt.readOffset+zt.mNumVertices*3*4),Gt.Seek(zt.mNumVertices*3*4,Ks))),dn&ut&&(js?(_r(Gt,zt.mTangents,zt.mNumVertices),_r(Gt,zt.mBitangents,zt.mNumVertices)):(zt.mTangents=[],zt.mTangentBuffer=Gt.subArray32(Gt.readOffset,Gt.readOffset+zt.mNumVertices*3*4),Gt.Seek(zt.mNumVertices*3*4,Ks),zt.mBitangents=[],zt.mBitangentBuffer=Gt.subArray32(Gt.readOffset,Gt.readOffset+zt.mNumVertices*3*4),Gt.Seek(zt.mNumVertices*3*4,Ks)));for(let Kn=0;Kn<Et&&dn&sn(Kn);++Kn)js?_r(Gt,zt.mColors[Kn],zt.mNumVertices):(zt.mColors[Kn]=[],zt.mColorBuffer=Gt.subArray32(Gt.readOffset,Gt.readOffset+zt.mNumVertices*4*4),Gt.Seek(zt.mNumVertices*4*4,Ks));zt.mTexCoordsBuffers=[];for(let Kn=0;Kn<St&&dn&Jt(Kn);++Kn)if(zt.mNumUVComponents[Kn]=On(Gt),js)_r(Gt,zt.mTextureCoords[Kn],zt.mNumVertices);else{zt.mTextureCoords[Kn]=[],zt.mTexCoordsBuffers[Kn]=[];for(let sr=0;sr<zt.mNumVertices;sr++)zt.mTexCoordsBuffers[Kn].push(En(Gt)),zt.mTexCoordsBuffers[Kn].push(En(Gt)),En(Gt)}if(js)On(Gt);else{zt.mFaces=[],zt.mIndexArray=[];for(let Kn=0;Kn<zt.mNumFaces;++Kn){var Vn=zt.mFaces[Kn]=new mn;Vn.mNumIndices=yn(Gt),Vn.mIndices=[];for(let sr=0;sr<Vn.mNumIndices;++sr)zt.mNumVertices<1<<16?Vn.mIndices[sr]=yn(Gt):Vn.mIndices[sr]=On(Gt);if(Vn.mNumIndices===3)zt.mIndexArray.push(Vn.mIndices[0]),zt.mIndexArray.push(Vn.mIndices[1]),zt.mIndexArray.push(Vn.mIndices[2]);else if(Vn.mNumIndices===4)zt.mIndexArray.push(Vn.mIndices[0]),zt.mIndexArray.push(Vn.mIndices[1]),zt.mIndexArray.push(Vn.mIndices[2]),zt.mIndexArray.push(Vn.mIndices[2]),zt.mIndexArray.push(Vn.mIndices[3]),zt.mIndexArray.push(Vn.mIndices[0]);else throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.")}}if(zt.mNumBones){zt.mBones=[];for(let Kn=0;Kn<zt.mNumBones;++Kn)zt.mBones[Kn]=new Pn,Hr(Gt,zt.mBones[Kn])}}function Ir(Gt,zt){var on=Mn(Gt);$r(on==ht),Mn(Gt),zt.mKey=Sr(Gt),zt.mSemantic=On(Gt),zt.mIndex=On(Gt),zt.mDataLength=On(Gt),zt.mType=On(Gt),zt.mData=[],Gt.ReadBytes(zt.mData,1,zt.mDataLength)}function Fr(Gt,zt){var on=Mn(Gt);if($r(on==ft),Mn(Gt),zt.mNumAllocated=zt.mNumProperties=On(Gt),zt.mNumProperties){zt.mProperties&&delete zt.mProperties,zt.mProperties=[];for(let dn=0;dn<zt.mNumProperties;++dn)zt.mProperties[dn]=new Dn,Ir(Gt,zt.mProperties[dn])}}function Pr(Gt,zt){var on=Mn(Gt);$r(on==it),Mn(Gt),zt.mNodeName=Sr(Gt),zt.mNumPositionKeys=On(Gt),zt.mNumRotationKeys=On(Gt),zt.mNumScalingKeys=On(Gt),zt.mPreState=On(Gt),zt.mPostState=On(Gt),zt.mNumPositionKeys&&(js?_r(Gt,zt.mPositionKeys,zt.mNumPositionKeys):(zt.mPositionKeys=[],qn(Gt,zt.mPositionKeys,zt.mNumPositionKeys))),zt.mNumRotationKeys&&(js?_r(Gt,zt.mRotationKeys,zt.mNumRotationKeys):(zt.mRotationKeys=[],vr(Gt,zt.mRotationKeys,zt.mNumRotationKeys))),zt.mNumScalingKeys&&(js?_r(Gt,zt.mScalingKeys,zt.mNumScalingKeys):(zt.mScalingKeys=[],qn(Gt,zt.mScalingKeys,zt.mNumScalingKeys)))}function Jr(Gt,zt){var on=Mn(Gt);if($r(on==ot),Mn(Gt),zt.mName=Sr(Gt),zt.mDuration=In(Gt),zt.mTicksPerSecond=In(Gt),zt.mNumChannels=On(Gt),zt.mNumChannels){zt.mChannels=[];for(let dn=0;dn<zt.mNumChannels;++dn)zt.mChannels[dn]=new Qn,Pr(Gt,zt.mChannels[dn])}}function zs(Gt,zt){var on=Mn(Gt);$r(on==nt),Mn(Gt),zt.mWidth=On(Gt),zt.mHeight=On(Gt),Gt.ReadBytes(zt.achFormatHint,1,4),js||(zt.mHeight?(zt.pcData=[],Gt.ReadBytes(zt.pcData,1,zt.mWidth*zt.mHeight*4)):(zt.pcData=[],Gt.ReadBytes(zt.pcData,1,zt.mWidth)))}function Ws(Gt,zt){var on=Mn(Gt);$r(on==tt),Mn(Gt),zt.mName=Sr(Gt),zt.mType=On(Gt),zt.mType!=Tt&&(zt.mAttenuationConstant=En(Gt),zt.mAttenuationLinear=En(Gt),zt.mAttenuationQuadratic=En(Gt)),zt.mColorDiffuse=gr(Gt),zt.mColorSpecular=gr(Gt),zt.mColorAmbient=gr(Gt),zt.mType==Mt&&(zt.mAngleInnerCone=En(Gt),zt.mAngleOuterCone=En(Gt))}function Js(Gt,zt){var on=Mn(Gt);$r(on==_e),Mn(Gt),zt.mName=Sr(Gt),zt.mPosition=tr(Gt),zt.mLookAt=tr(Gt),zt.mUp=tr(Gt),zt.mHorizontalFOV=En(Gt),zt.mClipPlaneNear=En(Gt),zt.mClipPlaneFar=En(Gt),zt.mAspect=En(Gt)}function ao(Gt,zt){var on=Mn(Gt);if($r(on==st),Mn(Gt),zt.mFlags=On(Gt),zt.mNumMeshes=On(Gt),zt.mNumMaterials=On(Gt),zt.mNumAnimations=On(Gt),zt.mNumTextures=On(Gt),zt.mNumLights=On(Gt),zt.mNumCameras=On(Gt),zt.mRootNode=new Nn,zt.mRootNode=es(Gt,null,0),zt.mNumMeshes){zt.mMeshes=[];for(let dn=0;dn<zt.mNumMeshes;++dn)zt.mMeshes[dn]=new nn,Ur(Gt,zt.mMeshes[dn])}if(zt.mNumMaterials){zt.mMaterials=[];for(let dn=0;dn<zt.mNumMaterials;++dn)zt.mMaterials[dn]=new bn,Fr(Gt,zt.mMaterials[dn])}if(zt.mNumAnimations){zt.mAnimations=[];for(let dn=0;dn<zt.mNumAnimations;++dn)zt.mAnimations[dn]=new nr,Jr(Gt,zt.mAnimations[dn])}if(zt.mNumTextures){zt.mTextures=[];for(let dn=0;dn<zt.mNumTextures;++dn)zt.mTextures[dn]=new or,zs(Gt,zt.mTextures[dn])}if(zt.mNumLights){zt.mLights=[];for(let dn=0;dn<zt.mNumLights;++dn)zt.mLights[dn]=new mr,Ws(Gt,zt.mLights[dn])}if(zt.mNumCameras){zt.mCameras=[];for(let dn=0;dn<zt.mNumCameras;++dn)zt.mCameras[dn]=new $n,Js(Gt,zt.mCameras[dn])}}var Ks=0,Es=1;function Do(Gt){Gt.readOffset=0,Gt.Seek=function(zt,on){on==Ks&&(Gt.readOffset+=zt),on==Es&&(Gt.readOffset=zt)},Gt.ReadBytes=function(zt,on,dn){var Vn=on*dn;for(let Kn=0;Kn<Vn;Kn++)zt[Kn]=Hn(this)},Gt.subArray32=function(zt,on){var dn=this.buffer,Vn=dn.slice(zt,on);return new Float32Array(Vn)},Gt.subArrayUint16=function(zt,on){var dn=this.buffer,Vn=dn.slice(zt,on);return new Uint16Array(Vn)},Gt.subArrayUint8=function(zt,on){var dn=this.buffer,Vn=dn.slice(zt,on);return new Uint8Array(Vn)},Gt.subArrayUint32=function(zt,on){var dn=this.buffer,Vn=dn.slice(zt,on);return new Uint32Array(Vn)}}var js,pn;function Kt(Gt){var zt=new tn,on=new DataView(Gt);if(Do(on),on.Seek(44,Ks),zt.versionMajor=On(on),zt.versionMinor=On(on),zt.versionRevision=On(on),zt.compileFlags=On(on),js=yn(on)>0,pn=yn(on)>0,js)throw"Shortened binaries are not supported!";if(on.Seek(256,Ks),on.Seek(128,Ks),on.Seek(64,Ks),pn){var dn=Mn(on),Vn=on.FileSize()-on.Tell(),Kn=[];on.Read(Kn,1,Vn);var sr=[];uncompress(sr,dn,Kn,Vn);var ar=new ArrayBuffer(sr);ao(ar,zt)}else ao(on,zt);return zt.toTHREE()}return Kt(s)}}class MDDLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.load(s,function(nt){o(_e.parse(nt))},j,$)}parse(s){const o=new DataView(s),j=o.getUint32(0),$=o.getUint32(4);let _e=8;const tt=new Float32Array(j),nt=new Float32Array(j*j).fill(0);for(let at=0;at<j;at++)tt[at]=o.getFloat32(_e),_e+=4,nt[j*at+at]=1;const rt=new NumberKeyframeTrack(".morphTargetInfluences",tt,nt),it=new AnimationClip("default",tt[tt.length-1],[rt]),st=[];for(let at=0;at<j;at++){const ot=new Float32Array($*3);for(let ft=0;ft<$;ft++){const ht=ft*3;ot[ht+0]=o.getFloat32(_e),_e+=4,ot[ht+1]=o.getFloat32(_e),_e+=4,ot[ht+2]=o.getFloat32(_e),_e+=4}const ct=new BufferAttribute(ot,3);ct.name="morph_"+at,st.push(ct)}return{morphTargets:st,clip:it}}}const hasColorSpace="colorSpace"in new Texture;class EXRLoader extends DataTextureLoader{constructor(s){super(s),this.type=HalfFloatType}parse(s){const Bt=Math.pow(2.7182818,2.2);function Rt(pn,Kt){for(var Gt=0,zt=0;zt<65536;++zt)(zt==0||pn[zt>>3]&1<<(zt&7))&&(Kt[Gt++]=zt);for(var on=Gt-1;Gt<65536;)Kt[Gt++]=0;return on}function Ut(pn){for(var Kt=0;Kt<16384;Kt++)pn[Kt]={},pn[Kt].len=0,pn[Kt].lit=0,pn[Kt].p=null}const Ht={l:0,c:0,lc:0};function Wt(pn,Kt,Gt,zt,on){for(;Gt<pn;)Kt=Kt<<8|Sr(zt,on),Gt+=8;Gt-=pn,Ht.l=Kt>>Gt&(1<<pn)-1,Ht.c=Kt,Ht.lc=Gt}const Jt=new Array(59);function sn(pn){for(var Kt=0;Kt<=58;++Kt)Jt[Kt]=0;for(var Kt=0;Kt<65537;++Kt)Jt[pn[Kt]]+=1;for(var Gt=0,Kt=58;Kt>0;--Kt){var zt=Gt+Jt[Kt]>>1;Jt[Kt]=Gt,Gt=zt}for(var Kt=0;Kt<65537;++Kt){var on=pn[Kt];on>0&&(pn[Kt]=on|Jt[on]++<<6)}}function jt(pn,Kt,Gt,zt,on,dn,Vn){for(var Kn=Gt,sr=0,ar=0;on<=dn;on++){if(Kn.value-Gt.value>zt)return!1;Wt(6,sr,ar,pn,Kn);var cr=Ht.l;if(sr=Ht.c,ar=Ht.lc,Vn[on]=cr,cr==63){if(Kn.value-Gt.value>zt)throw"Something wrong with hufUnpackEncTable";Wt(8,sr,ar,pn,Kn);var ur=Ht.l+6;if(sr=Ht.c,ar=Ht.lc,on+ur>dn+1)throw"Something wrong with hufUnpackEncTable";for(;ur--;)Vn[on++]=0;on--}else if(cr>=59){var ur=cr-59+2;if(on+ur>dn+1)throw"Something wrong with hufUnpackEncTable";for(;ur--;)Vn[on++]=0;on--}}sn(Vn)}function Vt(pn){return pn&63}function Lt(pn){return pn>>6}function Qt(pn,Kt,Gt,zt){for(;Kt<=Gt;Kt++){var on=Lt(pn[Kt]),dn=Vt(pn[Kt]);if(on>>dn)throw"Invalid table entry";if(dn>14){var Vn=zt[on>>dn-14];if(Vn.len)throw"Invalid table entry";if(Vn.lit++,Vn.p){var Kn=Vn.p;Vn.p=new Array(Vn.lit);for(var sr=0;sr<Vn.lit-1;++sr)Vn.p[sr]=Kn[sr]}else Vn.p=new Array(1);Vn.p[Vn.lit-1]=Kt}else if(dn)for(var ar=0,sr=1<<14-dn;sr>0;sr--){var Vn=zt[(on<<14-dn)+ar];if(Vn.len||Vn.p)throw"Invalid table entry";Vn.len=dn,Vn.lit=Kt,ar++}}return!0}const nn={c:0,lc:0};function mn(pn,Kt,Gt,zt){pn=pn<<8|Sr(Gt,zt),Kt+=8,nn.c=pn,nn.lc=Kt}const Zt={c:0,lc:0};function cn(pn,Kt,Gt,zt,on,dn,Vn,Kn,sr,ar){if(pn==Kt){zt<8&&(mn(Gt,zt,on,Vn),Gt=nn.c,zt=nn.lc),zt-=8;var cr=Gt>>zt,cr=new Uint8Array([cr])[0];if(sr.value+cr>ar)return!1;for(var ur=Kn[sr.value-1];cr-- >0;)Kn[sr.value++]=ur}else if(sr.value<ar)Kn[sr.value++]=pn;else return!1;Zt.c=Gt,Zt.lc=zt}function Ot(pn){return pn&65535}function rn(pn){var Kt=Ot(pn);return Kt>32767?Kt-65536:Kt}const fn={a:0,b:0};function hn(pn,Kt){var Gt=rn(pn),zt=rn(Kt),on=zt,dn=Gt+(on&1)+(on>>1),Vn=dn,Kn=dn-on;fn.a=Vn,fn.b=Kn}function Tn(pn,Kt){var Gt=Ot(pn),zt=Ot(Kt),on=Gt-(zt>>1)&65535,dn=zt+on-32768&65535;fn.a=dn,fn.b=on}function Nn(pn,Kt,Gt,zt,on,dn,Vn){for(var Kn=Vn<16384,sr=Gt>on?on:Gt,ar=1,cr;ar<=sr;)ar<<=1;for(ar>>=1,cr=ar,ar>>=1;ar>=1;){for(var ur=0,wr=ur+dn*(on-cr),Mr=dn*ar,Rr=dn*cr,cs=zt*ar,ps=zt*cr,us,Kr,As,ts;ur<=wr;ur+=Rr){for(var Ts=ur,Us=ur+zt*(Gt-cr);Ts<=Us;Ts+=ps){var Ss=Ts+cs,$s=Ts+Mr,Hs=$s+cs;Kn?(hn(pn[Ts+Kt],pn[$s+Kt]),us=fn.a,As=fn.b,hn(pn[Ss+Kt],pn[Hs+Kt]),Kr=fn.a,ts=fn.b,hn(us,Kr),pn[Ts+Kt]=fn.a,pn[Ss+Kt]=fn.b,hn(As,ts),pn[$s+Kt]=fn.a,pn[Hs+Kt]=fn.b):(Tn(pn[Ts+Kt],pn[$s+Kt]),us=fn.a,As=fn.b,Tn(pn[Ss+Kt],pn[Hs+Kt]),Kr=fn.a,ts=fn.b,Tn(us,Kr),pn[Ts+Kt]=fn.a,pn[Ss+Kt]=fn.b,Tn(As,ts),pn[$s+Kt]=fn.a,pn[Hs+Kt]=fn.b)}if(Gt&ar){var $s=Ts+Mr;Kn?hn(pn[Ts+Kt],pn[$s+Kt]):Tn(pn[Ts+Kt],pn[$s+Kt]),us=fn.a,pn[$s+Kt]=fn.b,pn[Ts+Kt]=us}}if(on&ar)for(var Ts=ur,Us=ur+zt*(Gt-cr);Ts<=Us;Ts+=ps){var Ss=Ts+cs;Kn?hn(pn[Ts+Kt],pn[Ss+Kt]):Tn(pn[Ts+Kt],pn[Ss+Kt]),us=fn.a,pn[Ss+Kt]=fn.b,pn[Ts+Kt]=us}cr=ar,ar>>=1}return ur}function Pn(pn,Kt,Gt,zt,on,dn,Vn,Kn,sr,ar){for(var cr=0,ur=0,wr=Kn,Mr=Math.trunc(on.value+(dn+7)/8);on.value<Mr;)for(mn(cr,ur,Gt,on),cr=nn.c,ur=nn.lc;ur>=14;){var Rr=cr>>ur-14&16383,cs=Kt[Rr];if(cs.len)ur-=cs.len,cn(cs.lit,Vn,cr,ur,Gt,zt,on,sr,ar,wr),cr=Zt.c,ur=Zt.lc;else{if(!cs.p)throw"hufDecode issues";var ps;for(ps=0;ps<cs.lit;ps++){for(var us=Vt(pn[cs.p[ps]]);ur<us&&on.value<Mr;)mn(cr,ur,Gt,on),cr=nn.c,ur=nn.lc;if(ur>=us&&Lt(pn[cs.p[ps]])==(cr>>ur-us&(1<<us)-1)){ur-=us,cn(cs.p[ps],Vn,cr,ur,Gt,zt,on,sr,ar,wr),cr=Zt.c,ur=Zt.lc;break}}if(ps==cs.lit)throw"hufDecode issues"}}var Kr=8-dn&7;for(cr>>=Kr,ur-=Kr;ur>0;){var cs=Kt[cr<<14-ur&16383];if(cs.len)ur-=cs.len,cn(cs.lit,Vn,cr,ur,Gt,zt,on,sr,ar,wr),cr=Zt.c,ur=Zt.lc;else throw"hufDecode issues"}return!0}function Dn(pn,Kt,Gt,zt,on,dn){var Vn={value:0},Kn=Gt.value,sr=Cr(Kt,Gt),ar=Cr(Kt,Gt);Gt.value+=4;var cr=Cr(Kt,Gt);if(Gt.value+=4,sr<0||sr>=65537||ar<0||ar>=65537)throw"Something wrong with HUF_ENCSIZE";var ur=new Array(65537),wr=new Array(16384);Ut(wr);var Mr=zt-(Gt.value-Kn);if(jt(pn,Kt,Gt,Mr,sr,ar,ur),cr>8*(zt-(Gt.value-Kn)))throw"Something wrong with hufUncompress";Qt(ur,sr,ar,wr),Pn(ur,wr,pn,Kt,Gt,cr,ar,dn,on,Vn)}function ln(pn,Kt,Gt){for(var zt=0;zt<Gt;++zt)Kt[zt]=pn[Kt[zt]]}function Cn(pn){for(var Kt=1;Kt<pn.length;Kt++){var Gt=pn[Kt-1]+pn[Kt]-128;pn[Kt]=Gt}}function bn(pn,Kt){for(var Gt=0,zt=Math.floor((pn.length+1)/2),on=0,dn=pn.length-1;!(on>dn||(Kt[on++]=pn[Gt++],on>dn));)Kt[on++]=pn[zt++]}function kn(pn){for(var Kt=pn.byteLength,Gt=new Array,zt=0,on=new DataView(pn);Kt>0;){var dn=on.getInt8(zt++);if(dn<0){var Vn=-dn;Kt-=Vn+1;for(var Kn=0;Kn<Vn;Kn++)Gt.push(on.getUint8(zt++))}else{var Vn=dn;Kt-=2;for(var sr=on.getUint8(zt++),Kn=0;Kn<Vn+1;Kn++)Gt.push(sr)}}return Gt}function Sn(pn,Kt,Gt,zt,on,dn){var Ss=new DataView(dn.buffer),Vn=Gt[pn.idx[0]].width,Kn=Gt[pn.idx[0]].height,sr=3,ar=Math.floor(Vn/8),cr=Math.ceil(Vn/8),ur=Math.ceil(Kn/8),wr=Vn-(cr-1)*8,Mr=Kn-(ur-1)*8,Rr={value:0},cs=new Array(sr),ps=new Array(sr),us=new Array(sr),Kr=new Array(sr),As=new Array(sr);for(let Cs=0;Cs<sr;++Cs)As[Cs]=Kt[pn.idx[Cs]],cs[Cs]=Cs<1?0:cs[Cs-1]+cr*ur,ps[Cs]=new Float32Array(64),us[Cs]=new Uint16Array(64),Kr[Cs]=new Uint16Array(cr*64);for(let Cs=0;Cs<ur;++Cs){var ts=8;Cs==ur-1&&(ts=Mr);var Ts=8;for(let Ns=0;Ns<cr;++Ns){Ns==cr-1&&(Ts=wr);for(let Gs=0;Gs<sr;++Gs)us[Gs].fill(0),us[Gs][0]=on[cs[Gs]++],xn(Rr,zt,us[Gs]),Qn(us[Gs],ps[Gs]),nr(ps[Gs]);or(ps);for(let Gs=0;Gs<sr;++Gs)mr(ps[Gs],Kr[Gs],Ns*64)}let Ps=0;for(let Ns=0;Ns<sr;++Ns){const Gs=Gt[pn.idx[Ns]].type;for(let ro=8*Cs;ro<8*Cs+ts;++ro){Ps=As[Ns][ro];for(let Gl=0;Gl<ar;++Gl){const Bo=Gl*64+(ro&7)*8;Ss.setUint16(Ps+0*2*Gs,Kr[Ns][Bo+0],!0),Ss.setUint16(Ps+1*2*Gs,Kr[Ns][Bo+1],!0),Ss.setUint16(Ps+2*2*Gs,Kr[Ns][Bo+2],!0),Ss.setUint16(Ps+3*2*Gs,Kr[Ns][Bo+3],!0),Ss.setUint16(Ps+4*2*Gs,Kr[Ns][Bo+4],!0),Ss.setUint16(Ps+5*2*Gs,Kr[Ns][Bo+5],!0),Ss.setUint16(Ps+6*2*Gs,Kr[Ns][Bo+6],!0),Ss.setUint16(Ps+7*2*Gs,Kr[Ns][Bo+7],!0),Ps+=8*2*Gs}}if(ar!=cr)for(let ro=8*Cs;ro<8*Cs+ts;++ro){const Gl=As[Ns][ro]+8*ar*2*Gs,Bo=ar*64+(ro&7)*8;for(let $o=0;$o<Ts;++$o)Ss.setUint16(Gl+$o*2*Gs,Kr[Ns][Bo+$o],!0)}}}for(var Us=new Uint16Array(Vn),Ss=new DataView(dn.buffer),$s=0;$s<sr;++$s){Gt[pn.idx[$s]].decoded=!0;var Hs=Gt[pn.idx[$s]].type;if(Gt[$s].type==2)for(var Ys=0;Ys<Kn;++Ys){const Cs=As[$s][Ys];for(var co=0;co<Vn;++co)Us[co]=Ss.getUint16(Cs+co*2*Hs,!0);for(var co=0;co<Vn;++co)Ss.setFloat32(Cs+co*2*Hs,Zn(Us[co]),!0)}}}function xn(pn,Kt,Gt){for(var zt,on=1;on<64;)zt=Kt[pn.value],zt==65280?on=64:zt>>8==255?on+=zt&255:(Gt[on]=zt,on++),pn.value++}function Qn(pn,Kt){Kt[0]=Zn(pn[0]),Kt[1]=Zn(pn[1]),Kt[2]=Zn(pn[5]),Kt[3]=Zn(pn[6]),Kt[4]=Zn(pn[14]),Kt[5]=Zn(pn[15]),Kt[6]=Zn(pn[27]),Kt[7]=Zn(pn[28]),Kt[8]=Zn(pn[2]),Kt[9]=Zn(pn[4]),Kt[10]=Zn(pn[7]),Kt[11]=Zn(pn[13]),Kt[12]=Zn(pn[16]),Kt[13]=Zn(pn[26]),Kt[14]=Zn(pn[29]),Kt[15]=Zn(pn[42]),Kt[16]=Zn(pn[3]),Kt[17]=Zn(pn[8]),Kt[18]=Zn(pn[12]),Kt[19]=Zn(pn[17]),Kt[20]=Zn(pn[25]),Kt[21]=Zn(pn[30]),Kt[22]=Zn(pn[41]),Kt[23]=Zn(pn[43]),Kt[24]=Zn(pn[9]),Kt[25]=Zn(pn[11]),Kt[26]=Zn(pn[18]),Kt[27]=Zn(pn[24]),Kt[28]=Zn(pn[31]),Kt[29]=Zn(pn[40]),Kt[30]=Zn(pn[44]),Kt[31]=Zn(pn[53]),Kt[32]=Zn(pn[10]),Kt[33]=Zn(pn[19]),Kt[34]=Zn(pn[23]),Kt[35]=Zn(pn[32]),Kt[36]=Zn(pn[39]),Kt[37]=Zn(pn[45]),Kt[38]=Zn(pn[52]),Kt[39]=Zn(pn[54]),Kt[40]=Zn(pn[20]),Kt[41]=Zn(pn[22]),Kt[42]=Zn(pn[33]),Kt[43]=Zn(pn[38]),Kt[44]=Zn(pn[46]),Kt[45]=Zn(pn[51]),Kt[46]=Zn(pn[55]),Kt[47]=Zn(pn[60]),Kt[48]=Zn(pn[21]),Kt[49]=Zn(pn[34]),Kt[50]=Zn(pn[37]),Kt[51]=Zn(pn[47]),Kt[52]=Zn(pn[50]),Kt[53]=Zn(pn[56]),Kt[54]=Zn(pn[59]),Kt[55]=Zn(pn[61]),Kt[56]=Zn(pn[35]),Kt[57]=Zn(pn[36]),Kt[58]=Zn(pn[48]),Kt[59]=Zn(pn[49]),Kt[60]=Zn(pn[57]),Kt[61]=Zn(pn[58]),Kt[62]=Zn(pn[62]),Kt[63]=Zn(pn[63])}function nr(pn){const Kt=.5*Math.cos(.7853975),Gt=.5*Math.cos(3.14159/16),zt=.5*Math.cos(3.14159/8),on=.5*Math.cos(3*3.14159/16),dn=.5*Math.cos(5*3.14159/16),Vn=.5*Math.cos(3*3.14159/8),Kn=.5*Math.cos(7*3.14159/16);for(var sr=new Array(4),ar=new Array(4),cr=new Array(4),ur=new Array(4),wr=0;wr<8;++wr){var Mr=wr*8;sr[0]=zt*pn[Mr+2],sr[1]=Vn*pn[Mr+2],sr[2]=zt*pn[Mr+6],sr[3]=Vn*pn[Mr+6],ar[0]=Gt*pn[Mr+1]+on*pn[Mr+3]+dn*pn[Mr+5]+Kn*pn[Mr+7],ar[1]=on*pn[Mr+1]-Kn*pn[Mr+3]-Gt*pn[Mr+5]-dn*pn[Mr+7],ar[2]=dn*pn[Mr+1]-Gt*pn[Mr+3]+Kn*pn[Mr+5]+on*pn[Mr+7],ar[3]=Kn*pn[Mr+1]-dn*pn[Mr+3]+on*pn[Mr+5]-Gt*pn[Mr+7],cr[0]=Kt*(pn[Mr+0]+pn[Mr+4]),cr[3]=Kt*(pn[Mr+0]-pn[Mr+4]),cr[1]=sr[0]+sr[3],cr[2]=sr[1]-sr[2],ur[0]=cr[0]+cr[1],ur[1]=cr[3]+cr[2],ur[2]=cr[3]-cr[2],ur[3]=cr[0]-cr[1],pn[Mr+0]=ur[0]+ar[0],pn[Mr+1]=ur[1]+ar[1],pn[Mr+2]=ur[2]+ar[2],pn[Mr+3]=ur[3]+ar[3],pn[Mr+4]=ur[3]-ar[3],pn[Mr+5]=ur[2]-ar[2],pn[Mr+6]=ur[1]-ar[1],pn[Mr+7]=ur[0]-ar[0]}for(var Rr=0;Rr<8;++Rr)sr[0]=zt*pn[16+Rr],sr[1]=Vn*pn[16+Rr],sr[2]=zt*pn[48+Rr],sr[3]=Vn*pn[48+Rr],ar[0]=Gt*pn[8+Rr]+on*pn[24+Rr]+dn*pn[40+Rr]+Kn*pn[56+Rr],ar[1]=on*pn[8+Rr]-Kn*pn[24+Rr]-Gt*pn[40+Rr]-dn*pn[56+Rr],ar[2]=dn*pn[8+Rr]-Gt*pn[24+Rr]+Kn*pn[40+Rr]+on*pn[56+Rr],ar[3]=Kn*pn[8+Rr]-dn*pn[24+Rr]+on*pn[40+Rr]-Gt*pn[56+Rr],cr[0]=Kt*(pn[Rr]+pn[32+Rr]),cr[3]=Kt*(pn[Rr]-pn[32+Rr]),cr[1]=sr[0]+sr[3],cr[2]=sr[1]-sr[2],ur[0]=cr[0]+cr[1],ur[1]=cr[3]+cr[2],ur[2]=cr[3]-cr[2],ur[3]=cr[0]-cr[1],pn[0+Rr]=ur[0]+ar[0],pn[8+Rr]=ur[1]+ar[1],pn[16+Rr]=ur[2]+ar[2],pn[24+Rr]=ur[3]+ar[3],pn[32+Rr]=ur[3]-ar[3],pn[40+Rr]=ur[2]-ar[2],pn[48+Rr]=ur[1]-ar[1],pn[56+Rr]=ur[0]-ar[0]}function or(pn){for(var Kt=0;Kt<64;++Kt){var Gt=pn[0][Kt],zt=pn[1][Kt],on=pn[2][Kt];pn[0][Kt]=Gt+1.5747*on,pn[1][Kt]=Gt-.1873*zt-.4682*on,pn[2][Kt]=Gt+1.8556*zt}}function mr(pn,Kt,Gt){for(var zt=0;zt<64;++zt)Kt[Gt+zt]=DataUtils.toHalfFloat($n(pn[zt]))}function $n(pn){return pn<=1?Math.sign(pn)*Math.pow(Math.abs(pn),2.2):Math.sign(pn)*Math.pow(Bt,Math.abs(pn)-1)}function tn(pn){return new DataView(pn.array.buffer,pn.offset.value,pn.size)}function $t(pn){var Kt=pn.viewer.buffer.slice(pn.offset.value,pn.offset.value+pn.size),Gt=new Uint8Array(kn(Kt)),zt=new Uint8Array(Gt.length);return Cn(Gt),bn(Gt,zt),new DataView(zt.buffer)}function An(pn){var Kt=pn.array.slice(pn.offset.value,pn.offset.value+pn.size),Gt=unzlibSync(Kt),zt=new Uint8Array(Gt.length);return Cn(Gt),bn(Gt,zt),new DataView(zt.buffer)}function En(pn){for(var Kt=pn.viewer,Gt={value:pn.offset.value},zt=new Uint16Array(pn.width*pn.scanlineBlockSize*(pn.channels*pn.type)),on=new Uint8Array(8192),dn=0,Vn=new Array(pn.channels),Kn=0;Kn<pn.channels;Kn++)Vn[Kn]={},Vn[Kn].start=dn,Vn[Kn].end=Vn[Kn].start,Vn[Kn].nx=pn.width,Vn[Kn].ny=pn.lines,Vn[Kn].size=pn.type,dn+=Vn[Kn].nx*Vn[Kn].ny*Vn[Kn].size;var sr=qn(Kt,Gt),ar=qn(Kt,Gt);if(ar>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(sr<=ar)for(var Kn=0;Kn<ar-sr+1;Kn++)on[Kn+sr]=Un(Kt,Gt);var cr=new Uint16Array(65536),ur=Rt(on,cr),wr=Cr(Kt,Gt);Dn(pn.array,Kt,Gt,wr,zt,dn);for(var Kn=0;Kn<pn.channels;++Kn)for(var Mr=Vn[Kn],Rr=0;Rr<Vn[Kn].size;++Rr)Nn(zt,Mr.start+Rr,Mr.nx,Mr.size,Mr.ny,Mr.nx*Mr.size,ur);ln(cr,zt,dn);for(var cs=0,ps=new Uint8Array(zt.buffer.byteLength),us=0;us<pn.lines;us++)for(var Kr=0;Kr<pn.channels;Kr++){var Mr=Vn[Kr],As=Mr.nx*Mr.size,ts=new Uint8Array(zt.buffer,Mr.end*2,As*2);ps.set(ts,cs),cs+=As*2,Mr.end+=As}return new DataView(ps.buffer)}function In(pn){var Kt=pn.array.slice(pn.offset.value,pn.offset.value+pn.size),Gt=unzlibSync(Kt);const zt=pn.lines*pn.channels*pn.width,on=pn.type==1?new Uint16Array(zt):new Uint32Array(zt);let dn=0,Vn=0;const Kn=new Array(4);for(let sr=0;sr<pn.lines;sr++)for(let ar=0;ar<pn.channels;ar++){let cr=0;switch(pn.type){case 1:Kn[0]=dn,Kn[1]=Kn[0]+pn.width,dn=Kn[1]+pn.width;for(let ur=0;ur<pn.width;++ur){const wr=Gt[Kn[0]++]<<8|Gt[Kn[1]++];cr+=wr,on[Vn]=cr,Vn++}break;case 2:Kn[0]=dn,Kn[1]=Kn[0]+pn.width,Kn[2]=Kn[1]+pn.width,dn=Kn[2]+pn.width;for(let ur=0;ur<pn.width;++ur){const wr=Gt[Kn[0]++]<<24|Gt[Kn[1]++]<<16|Gt[Kn[2]++]<<8;cr+=wr,on[Vn]=cr,Vn++}break}}return new DataView(on.buffer)}function Hn(pn){var Kt=pn.viewer,Gt={value:pn.offset.value},zt=new Uint8Array(pn.width*pn.lines*(pn.channels*pn.type*2)),on={version:Jn(Kt,Gt),unknownUncompressedSize:Jn(Kt,Gt),unknownCompressedSize:Jn(Kt,Gt),acCompressedSize:Jn(Kt,Gt),dcCompressedSize:Jn(Kt,Gt),rleCompressedSize:Jn(Kt,Gt),rleUncompressedSize:Jn(Kt,Gt),rleRawSize:Jn(Kt,Gt),totalAcUncompressedCount:Jn(Kt,Gt),totalDcUncompressedCount:Jn(Kt,Gt),acCompression:Jn(Kt,Gt)};if(on.version<2)throw"EXRLoader.parse: "+Ks.compression+" version "+on.version+" is unsupported";for(var dn=new Array,Vn=qn(Kt,Gt)-2;Vn>0;){var Kn=yn(Kt.buffer,Gt),sr=Un(Kt,Gt),ar=sr>>2&3,cr=(sr>>4)-1,ur=new Int8Array([cr])[0],wr=Un(Kt,Gt);dn.push({name:Kn,index:ur,type:wr,compression:ar}),Vn-=Kn.length+3}for(var Mr=Ks.channels,Rr=new Array(pn.channels),cs=0;cs<pn.channels;++cs){var ps=Rr[cs]={},us=Mr[cs];ps.name=us.name,ps.compression=0,ps.decoded=!1,ps.type=us.pixelType,ps.pLinear=us.pLinear,ps.width=pn.width,ps.height=pn.lines}for(var Kr={idx:new Array(3)},As=0;As<pn.channels;++As)for(var ps=Rr[As],cs=0;cs<dn.length;++cs){var ts=dn[cs];ps.name==ts.name&&(ps.compression=ts.compression,ts.index>=0&&(Kr.idx[ts.index]=As),ps.offset=As)}if(on.acCompressedSize>0)switch(on.acCompression){case 0:var Ss=new Uint16Array(on.totalAcUncompressedCount);Dn(pn.array,Kt,Gt,on.acCompressedSize,Ss,on.totalAcUncompressedCount);break;case 1:var Ts=pn.array.slice(Gt.value,Gt.value+on.totalAcUncompressedCount),Us=unzlibSync(Ts),Ss=new Uint16Array(Us.buffer);Gt.value+=on.totalAcUncompressedCount;break}if(on.dcCompressedSize>0){var $s={array:pn.array,offset:Gt,size:on.dcCompressedSize},Hs=new Uint16Array(An($s).buffer);Gt.value+=on.dcCompressedSize}if(on.rleRawSize>0){var Ts=pn.array.slice(Gt.value,Gt.value+on.rleCompressedSize),Us=unzlibSync(Ts),Ys=kn(Us.buffer);Gt.value+=on.rleCompressedSize}for(var co=0,Cs=new Array(Rr.length),cs=0;cs<Cs.length;++cs)Cs[cs]=new Array;for(var Ps=0;Ps<pn.lines;++Ps)for(var Ns=0;Ns<Rr.length;++Ns)Cs[Ns].push(co),co+=Rr[Ns].width*pn.type*2;Sn(Kr,Cs,Rr,Ss,Hs,zt);for(var cs=0;cs<Rr.length;++cs){var ps=Rr[cs];if(!ps.decoded)switch(ps.compression){case 2:for(var Gs=0,ro=0,Ps=0;Ps<pn.lines;++Ps){for(var Gl=Cs[cs][Gs],Bo=0;Bo<ps.width;++Bo){for(var $o=0;$o<2*ps.type;++$o)zt[Gl++]=Ys[ro+$o*ps.width*ps.height];ro++}Gs++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(zt.buffer)}function yn(pn,Kt){for(var Gt=new Uint8Array(pn),zt=0;Gt[Kt.value+zt]!=0;)zt+=1;var on=new TextDecoder().decode(Gt.slice(Kt.value,Kt.value+zt));return Kt.value=Kt.value+zt+1,on}function On(pn,Kt,Gt){var zt=new TextDecoder().decode(new Uint8Array(pn).slice(Kt.value,Kt.value+Gt));return Kt.value=Kt.value+Gt,zt}function Mn(pn,Kt){var Gt=gr(pn,Kt),zt=Cr(pn,Kt);return[Gt,zt]}function tr(pn,Kt){var Gt=Cr(pn,Kt),zt=Cr(pn,Kt);return[Gt,zt]}function gr(pn,Kt){var Gt=pn.getInt32(Kt.value,!0);return Kt.value=Kt.value+4,Gt}function Cr(pn,Kt){var Gt=pn.getUint32(Kt.value,!0);return Kt.value=Kt.value+4,Gt}function Sr(pn,Kt){var Gt=pn[Kt.value];return Kt.value=Kt.value+1,Gt}function Un(pn,Kt){var Gt=pn.getUint8(Kt.value);return Kt.value=Kt.value+1,Gt}const Jn=function(pn,Kt){let Gt;return"getBigInt64"in DataView.prototype?Gt=Number(pn.getBigInt64(Kt.value,!0)):Gt=pn.getUint32(Kt.value+4,!0)+Number(pn.getUint32(Kt.value,!0)<<32),Kt.value+=8,Gt};function pr(pn,Kt){var Gt=pn.getFloat32(Kt.value,!0);return Kt.value+=4,Gt}function Gn(pn,Kt){return DataUtils.toHalfFloat(pr(pn,Kt))}function Zn(pn){var Kt=(pn&31744)>>10,Gt=pn&1023;return(pn>>15?-1:1)*(Kt?Kt===31?Gt?NaN:1/0:Math.pow(2,Kt-15)*(1+Gt/1024):6103515625e-14*(Gt/1024))}function qn(pn,Kt){var Gt=pn.getUint16(Kt.value,!0);return Kt.value+=2,Gt}function vr(pn,Kt){return Zn(qn(pn,Kt))}function _r(pn,Kt,Gt,zt){for(var on=Gt.value,dn=[];Gt.value<on+zt-1;){var Vn=yn(Kt,Gt),Kn=gr(pn,Gt),sr=Un(pn,Gt);Gt.value+=3;var ar=gr(pn,Gt),cr=gr(pn,Gt);dn.push({name:Vn,pixelType:Kn,pLinear:sr,xSampling:ar,ySampling:cr})}return Gt.value+=1,dn}function $r(pn,Kt){var Gt=pr(pn,Kt),zt=pr(pn,Kt),on=pr(pn,Kt),dn=pr(pn,Kt),Vn=pr(pn,Kt),Kn=pr(pn,Kt),sr=pr(pn,Kt),ar=pr(pn,Kt);return{redX:Gt,redY:zt,greenX:on,greenY:dn,blueX:Vn,blueY:Kn,whiteX:sr,whiteY:ar}}function es(pn,Kt){var Gt=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],zt=Un(pn,Kt);return Gt[zt]}function Hr(pn,Kt){var Gt=Cr(pn,Kt),zt=Cr(pn,Kt),on=Cr(pn,Kt),dn=Cr(pn,Kt);return{xMin:Gt,yMin:zt,xMax:on,yMax:dn}}function Ur(pn,Kt){var Gt=["INCREASING_Y"],zt=Un(pn,Kt);return Gt[zt]}function Ir(pn,Kt){var Gt=pr(pn,Kt),zt=pr(pn,Kt);return[Gt,zt]}function Fr(pn,Kt){var Gt=pr(pn,Kt),zt=pr(pn,Kt),on=pr(pn,Kt);return[Gt,zt,on]}function Pr(pn,Kt,Gt,zt,on){if(zt==="string"||zt==="stringvector"||zt==="iccProfile")return On(Kt,Gt,on);if(zt==="chlist")return _r(pn,Kt,Gt,on);if(zt==="chromaticities")return $r(pn,Gt);if(zt==="compression")return es(pn,Gt);if(zt==="box2i")return Hr(pn,Gt);if(zt==="lineOrder")return Ur(pn,Gt);if(zt==="float")return pr(pn,Gt);if(zt==="v2f")return Ir(pn,Gt);if(zt==="v3f")return Fr(pn,Gt);if(zt==="int")return gr(pn,Gt);if(zt==="rational")return Mn(pn,Gt);if(zt==="timecode")return tr(pn,Gt);if(zt==="preview")return Gt.value+=on,"skipped";Gt.value+=on}function Jr(pn,Kt,Gt){const zt={};if(pn.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";zt.version=pn.getUint8(4);const on=pn.getUint8(5);zt.spec={singleTile:!!(on&2),longName:!!(on&4),deepFormat:!!(on&8),multiPart:!!(on&16)},Gt.value=8;for(var dn=!0;dn;){var Vn=yn(Kt,Gt);if(Vn==0)dn=!1;else{var Kn=yn(Kt,Gt),sr=Cr(pn,Gt),ar=Pr(pn,Kt,Gt,Kn,sr);ar===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Kn}'.`):zt[Vn]=ar}}if(on!=0)throw console.error("EXRHeader:",zt),"THREE.EXRLoader: provided file is currently unsupported.";return zt}function zs(pn,Kt,Gt,zt,on){const dn={size:0,viewer:Kt,array:Gt,offset:zt,width:pn.dataWindow.xMax-pn.dataWindow.xMin+1,height:pn.dataWindow.yMax-pn.dataWindow.yMin+1,channels:pn.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:pn.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(pn.compression){case"NO_COMPRESSION":dn.lines=1,dn.uncompress=tn;break;case"RLE_COMPRESSION":dn.lines=1,dn.uncompress=$t;break;case"ZIPS_COMPRESSION":dn.lines=1,dn.uncompress=An;break;case"ZIP_COMPRESSION":dn.lines=16,dn.uncompress=An;break;case"PIZ_COMPRESSION":dn.lines=32,dn.uncompress=En;break;case"PXR24_COMPRESSION":dn.lines=16,dn.uncompress=In;break;case"DWAA_COMPRESSION":dn.lines=32,dn.uncompress=Hn;break;case"DWAB_COMPRESSION":dn.lines=256,dn.uncompress=Hn;break;default:throw"EXRLoader.parse: "+pn.compression+" is unsupported"}if(dn.scanlineBlockSize=dn.lines,dn.type==1)switch(on){case FloatType:dn.getter=vr,dn.inputSize=2;break;case HalfFloatType:dn.getter=qn,dn.inputSize=2;break}else if(dn.type==2)switch(on){case FloatType:dn.getter=pr,dn.inputSize=4;break;case HalfFloatType:dn.getter=Gn,dn.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+dn.type+" for "+pn.compression+".";dn.blockCount=(pn.dataWindow.yMax+1)/dn.scanlineBlockSize;for(var Vn=0;Vn<dn.blockCount;Vn++)Jn(Kt,zt);dn.outputChannels=dn.channels==3?4:dn.channels;const Kn=dn.width*dn.height*dn.outputChannels;switch(on){case FloatType:dn.byteArray=new Float32Array(Kn),dn.channels<dn.outputChannels&&dn.byteArray.fill(1,0,Kn);break;case HalfFloatType:dn.byteArray=new Uint16Array(Kn),dn.channels<dn.outputChannels&&dn.byteArray.fill(15360,0,Kn);break;default:console.error("THREE.EXRLoader: unsupported type: ",on);break}return dn.bytesPerLine=dn.width*dn.inputSize*dn.channels,dn.outputChannels==4?dn.format=RGBAFormat:dn.format=RedFormat,hasColorSpace?dn.colorSpace="srgb-linear":dn.encoding=3e3,dn}const Ws=new DataView(s),Js=new Uint8Array(s),ao={value:0},Ks=Jr(Ws,s,ao),Es=zs(Ks,Ws,Js,ao,this.type),Do={value:0},js={R:0,G:1,B:2,A:3,Y:0};for(let pn=0;pn<Es.height/Es.scanlineBlockSize;pn++){const Kt=Cr(Ws,ao);Es.size=Cr(Ws,ao),Es.lines=Kt+Es.scanlineBlockSize>Es.height?Es.height-Kt:Es.scanlineBlockSize;const zt=Es.size<Es.lines*Es.bytesPerLine?Es.uncompress(Es):tn(Es);ao.value+=Es.size;for(let on=0;on<Es.scanlineBlockSize;on++){const dn=on+pn*Es.scanlineBlockSize;if(dn>=Es.height)break;for(let Vn=0;Vn<Es.channels;Vn++){const Kn=js[Ks.channels[Vn].name];for(let sr=0;sr<Es.width;sr++){Do.value=(on*(Es.channels*Es.width)+Vn*Es.width+sr)*Es.inputSize;const ar=(Es.height-1-dn)*(Es.width*Es.outputChannels)+sr*Es.outputChannels+Kn;Es.byteArray[ar]=Es.getter(zt,Do)}}}}return{header:Ks,width:Es.width,height:Es.height,data:Es.byteArray,format:Es.format,[hasColorSpace?"colorSpace":"encoding"]:Es[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(s){return this.type=s,this}load(s,o,j,$){function _e(tt,nt){hasColorSpace?tt.colorSpace=nt.colorSpace:tt.encoding=nt.encoding,tt.minFilter=LinearFilter,tt.magFilter=LinearFilter,tt.generateMipmaps=!1,tt.flipY=!1,o&&o(tt,nt)}return super.load(s,_e,j,$)}}class ThreeMFLoader extends Loader{constructor(s){super(s),this.availableExtensions=[]}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=this,j=new TextureLoader(this.manager);function $(Ot){let rn=null,fn=null,hn,Tn;const Nn=[],Pn=[];let Dn;const ln={},Cn={},bn={},kn={};try{rn=unzipSync(new Uint8Array(Ot))}catch(nr){if(nr instanceof ReferenceError)return console.error("THREE.3MFLoader: fflate missing and file is compressed."),null}for(fn in rn)fn.match(/\_rels\/.rels$/)?hn=fn:fn.match(/3D\/_rels\/.*\.model\.rels$/)?Tn=fn:fn.match(/^3D\/.*\.model$/)?Nn.push(fn):fn.match(/^3D\/Metadata\/.*\.xml$/)||(fn.match(/^3D\/Textures?\/.*/)?Pn.push(fn):fn.match(/^3D\/Other\/.*/));const Sn=rn[hn],xn=LoaderUtils.decodeText(Sn),Qn=_e(xn);if(Tn){const nr=rn[Tn],or=LoaderUtils.decodeText(nr);Dn=_e(or)}for(let nr=0;nr<Nn.length;nr++){const or=Nn[nr],mr=rn[or],$n=LoaderUtils.decodeText(mr),tn=new DOMParser().parseFromString($n,"application/xml");tn.documentElement.nodeName.toLowerCase()!=="model"&&console.error("THREE.3MFLoader: Error loading 3MF - no 3MF document found: ",or);const $t=tn.querySelector("model"),An={};for(let In=0;In<$t.attributes.length;In++){const Hn=$t.attributes[In];Hn.name.match(/^xmlns:(.+)$/)&&(An[Hn.value]=RegExp.$1)}const En=gt($t);En.xml=$t,0<Object.keys(An).length&&(En.extensions=An),ln[or]=En}for(let nr=0;nr<Pn.length;nr++){const or=Pn[nr];bn[or]=rn[or].buffer}return{rels:Qn,modelRels:Dn,model:ln,printTicket:Cn,texture:bn,other:kn}}function _e(Ot){const rn=[],hn=new DOMParser().parseFromString(Ot,"application/xml").querySelectorAll("Relationship");for(let Tn=0;Tn<hn.length;Tn++){const Nn=hn[Tn],Pn={target:Nn.getAttribute("Target"),id:Nn.getAttribute("Id"),type:Nn.getAttribute("Type")};rn.push(Pn)}return rn}function tt(Ot){const rn={};for(let fn=0;fn<Ot.length;fn++){const hn=Ot[fn],Tn=hn.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(Tn)&&(rn[Tn]=hn.textContent)}return rn}function nt(Ot){const rn={id:Ot.getAttribute("id"),basematerials:[]},fn=Ot.querySelectorAll("base");for(let hn=0;hn<fn.length;hn++){const Tn=fn[hn],Nn=ot(Tn);Nn.index=hn,rn.basematerials.push(Nn)}return rn}function rt(Ot){return{id:Ot.getAttribute("id"),path:Ot.getAttribute("path"),contenttype:Ot.getAttribute("contenttype"),tilestyleu:Ot.getAttribute("tilestyleu"),tilestylev:Ot.getAttribute("tilestylev"),filter:Ot.getAttribute("filter")}}function it(Ot){const rn={id:Ot.getAttribute("id"),texid:Ot.getAttribute("texid"),displaypropertiesid:Ot.getAttribute("displaypropertiesid")},fn=Ot.querySelectorAll("tex2coord"),hn=[];for(let Tn=0;Tn<fn.length;Tn++){const Nn=fn[Tn],Pn=Nn.getAttribute("u"),Dn=Nn.getAttribute("v");hn.push(parseFloat(Pn),parseFloat(Dn))}return rn.uvs=new Float32Array(hn),rn}function st(Ot){const rn={id:Ot.getAttribute("id"),displaypropertiesid:Ot.getAttribute("displaypropertiesid")},fn=Ot.querySelectorAll("color"),hn=[],Tn=new Color;for(let Nn=0;Nn<fn.length;Nn++){const Dn=fn[Nn].getAttribute("color");Tn.setStyle(Dn.substring(0,7)),Tn.convertSRGBToLinear(),hn.push(Tn.r,Tn.g,Tn.b)}return rn.colors=new Float32Array(hn),rn}function at(Ot){const rn={id:Ot.getAttribute("id")},fn=Ot.querySelectorAll("pbmetallic"),hn=[];for(let Tn=0;Tn<fn.length;Tn++){const Nn=fn[Tn];hn.push({name:Nn.getAttribute("name"),metallicness:parseFloat(Nn.getAttribute("metallicness")),roughness:parseFloat(Nn.getAttribute("roughness"))})}return rn.data=hn,rn}function ot(Ot){const rn={};return rn.name=Ot.getAttribute("name"),rn.displaycolor=Ot.getAttribute("displaycolor"),rn.displaypropertiesid=Ot.getAttribute("displaypropertiesid"),rn}function ct(Ot){const rn={},fn=[],hn=Ot.querySelectorAll("vertices vertex");for(let Dn=0;Dn<hn.length;Dn++){const ln=hn[Dn],Cn=ln.getAttribute("x"),bn=ln.getAttribute("y"),kn=ln.getAttribute("z");fn.push(parseFloat(Cn),parseFloat(bn),parseFloat(kn))}rn.vertices=new Float32Array(fn);const Tn=[],Nn=[],Pn=Ot.querySelectorAll("triangles triangle");for(let Dn=0;Dn<Pn.length;Dn++){const ln=Pn[Dn],Cn=ln.getAttribute("v1"),bn=ln.getAttribute("v2"),kn=ln.getAttribute("v3"),Sn=ln.getAttribute("p1"),xn=ln.getAttribute("p2"),Qn=ln.getAttribute("p3"),nr=ln.getAttribute("pid"),or={};or.v1=parseInt(Cn,10),or.v2=parseInt(bn,10),or.v3=parseInt(kn,10),Nn.push(or.v1,or.v2,or.v3),Sn&&(or.p1=parseInt(Sn,10)),xn&&(or.p2=parseInt(xn,10)),Qn&&(or.p3=parseInt(Qn,10)),nr&&(or.pid=nr),0<Object.keys(or).length&&Tn.push(or)}return rn.triangleProperties=Tn,rn.triangles=new Uint32Array(Nn),rn}function ft(Ot){const rn=[],fn=Ot.querySelectorAll("component");for(let hn=0;hn<fn.length;hn++){const Tn=fn[hn],Nn=ht(Tn);rn.push(Nn)}return rn}function ht(Ot){const rn={};rn.objectId=Ot.getAttribute("objectid");const fn=Ot.getAttribute("transform");return fn&&(rn.transform=mt(fn)),rn}function mt(Ot){const rn=[];Ot.split(" ").forEach(function(hn){rn.push(parseFloat(hn))});const fn=new Matrix4;return fn.set(rn[0],rn[3],rn[6],rn[9],rn[1],rn[4],rn[7],rn[10],rn[2],rn[5],rn[8],rn[11],0,0,0,1),fn}function lt(Ot){const rn={type:Ot.getAttribute("type")},fn=Ot.getAttribute("id");fn&&(rn.id=fn);const hn=Ot.getAttribute("pid");hn&&(rn.pid=hn);const Tn=Ot.getAttribute("pindex");Tn&&(rn.pindex=Tn);const Nn=Ot.getAttribute("thumbnail");Nn&&(rn.thumbnail=Nn);const Pn=Ot.getAttribute("partnumber");Pn&&(rn.partnumber=Pn);const Dn=Ot.getAttribute("name");Dn&&(rn.name=Dn);const ln=Ot.querySelector("mesh");ln&&(rn.mesh=ct(ln));const Cn=Ot.querySelector("components");return Cn&&(rn.components=ft(Cn)),rn}function ut(Ot){const rn={};rn.basematerials={};const fn=Ot.querySelectorAll("basematerials");for(let ln=0;ln<fn.length;ln++){const Cn=fn[ln],bn=nt(Cn);rn.basematerials[bn.id]=bn}rn.texture2d={};const hn=Ot.querySelectorAll("texture2d");for(let ln=0;ln<hn.length;ln++){const Cn=hn[ln],bn=rt(Cn);rn.texture2d[bn.id]=bn}rn.colorgroup={};const Tn=Ot.querySelectorAll("colorgroup");for(let ln=0;ln<Tn.length;ln++){const Cn=Tn[ln],bn=st(Cn);rn.colorgroup[bn.id]=bn}rn.pbmetallicdisplayproperties={};const Nn=Ot.querySelectorAll("pbmetallicdisplayproperties");for(let ln=0;ln<Nn.length;ln++){const Cn=Nn[ln],bn=at(Cn);rn.pbmetallicdisplayproperties[bn.id]=bn}rn.texture2dgroup={};const Pn=Ot.querySelectorAll("texture2dgroup");for(let ln=0;ln<Pn.length;ln++){const Cn=Pn[ln],bn=it(Cn);rn.texture2dgroup[bn.id]=bn}rn.object={};const Dn=Ot.querySelectorAll("object");for(let ln=0;ln<Dn.length;ln++){const Cn=Dn[ln],bn=lt(Cn);rn.object[bn.id]=bn}return rn}function dt(Ot){const rn=[],fn=Ot.querySelectorAll("item");for(let hn=0;hn<fn.length;hn++){const Tn=fn[hn],Nn={objectId:Tn.getAttribute("objectid")},Pn=Tn.getAttribute("transform");Pn&&(Nn.transform=mt(Pn)),rn.push(Nn)}return rn}function gt(Ot){const rn={unit:Ot.getAttribute("unit")||"millimeter"},fn=Ot.querySelectorAll("metadata");fn&&(rn.metadata=tt(fn));const hn=Ot.querySelector("resources");hn&&(rn.resources=ut(hn));const Tn=Ot.querySelector("build");return Tn&&(rn.build=dt(Tn)),rn}function Et(Ot,rn,fn,hn){const Tn=Ot.texid,Pn=fn.resources.texture2d[Tn];if(Pn){const Dn=hn[Pn.path],ln=Pn.contenttype,Cn=new Blob([Dn],{type:ln}),bn=URL.createObjectURL(Cn),kn=j.load(bn,function(){URL.revokeObjectURL(bn)});switch("colorSpace"in kn?kn.colorSpace="srgb":kn.encoding=3001,Pn.tilestyleu){case"wrap":kn.wrapS=RepeatWrapping;break;case"mirror":kn.wrapS=MirroredRepeatWrapping;break;case"none":case"clamp":kn.wrapS=ClampToEdgeWrapping;break;default:kn.wrapS=RepeatWrapping}switch(Pn.tilestylev){case"wrap":kn.wrapT=RepeatWrapping;break;case"mirror":kn.wrapT=MirroredRepeatWrapping;break;case"none":case"clamp":kn.wrapT=ClampToEdgeWrapping;break;default:kn.wrapT=RepeatWrapping}switch(Pn.filter){case"auto":kn.magFilter=LinearFilter,kn.minFilter=LinearMipmapLinearFilter;break;case"linear":kn.magFilter=LinearFilter,kn.minFilter=LinearFilter;break;case"nearest":kn.magFilter=NearestFilter,kn.minFilter=NearestFilter;break;default:kn.magFilter=LinearFilter,kn.minFilter=LinearMipmapLinearFilter}return kn}else return null}function St(Ot,rn,fn,hn,Tn,Nn,Pn){const Dn=Pn.pindex,ln={};for(let kn=0,Sn=rn.length;kn<Sn;kn++){const xn=rn[kn],Qn=xn.p1!==void 0?xn.p1:Dn;ln[Qn]===void 0&&(ln[Qn]=[]),ln[Qn].push(xn)}const Cn=Object.keys(ln),bn=[];for(let kn=0,Sn=Cn.length;kn<Sn;kn++){const xn=Cn[kn],Qn=ln[xn],nr=Ot.basematerials[xn],or=sn(nr,hn,Tn,Nn,Pn,jt),mr=new BufferGeometry,$n=[],tn=fn.vertices;for(let An=0,En=Qn.length;An<En;An++){const In=Qn[An];$n.push(tn[In.v1*3+0]),$n.push(tn[In.v1*3+1]),$n.push(tn[In.v1*3+2]),$n.push(tn[In.v2*3+0]),$n.push(tn[In.v2*3+1]),$n.push(tn[In.v2*3+2]),$n.push(tn[In.v3*3+0]),$n.push(tn[In.v3*3+1]),$n.push(tn[In.v3*3+2])}mr.setAttribute("position",new Float32BufferAttribute($n,3));const $t=new Mesh(mr,or);bn.push($t)}return bn}function Tt(Ot,rn,fn,hn,Tn,Nn,Pn){const Dn=new BufferGeometry,ln=[],Cn=[],bn=fn.vertices,kn=Ot.uvs;for(let nr=0,or=rn.length;nr<or;nr++){const mr=rn[nr];ln.push(bn[mr.v1*3+0]),ln.push(bn[mr.v1*3+1]),ln.push(bn[mr.v1*3+2]),ln.push(bn[mr.v2*3+0]),ln.push(bn[mr.v2*3+1]),ln.push(bn[mr.v2*3+2]),ln.push(bn[mr.v3*3+0]),ln.push(bn[mr.v3*3+1]),ln.push(bn[mr.v3*3+2]),Cn.push(kn[mr.p1*2+0]),Cn.push(kn[mr.p1*2+1]),Cn.push(kn[mr.p2*2+0]),Cn.push(kn[mr.p2*2+1]),Cn.push(kn[mr.p3*2+0]),Cn.push(kn[mr.p3*2+1])}Dn.setAttribute("position",new Float32BufferAttribute(ln,3)),Dn.setAttribute("uv",new Float32BufferAttribute(Cn,2));const Sn=sn(Ot,hn,Tn,Nn,Pn,Et),xn=new MeshPhongMaterial({map:Sn,flatShading:!0});return new Mesh(Dn,xn)}function Mt(Ot,rn,fn,hn,Tn,Nn){const Pn=new BufferGeometry,Dn=[],ln=[],Cn=fn.vertices,bn=Ot.colors;for(let xn=0,Qn=rn.length;xn<Qn;xn++){const nr=rn[xn],or=nr.v1,mr=nr.v2,$n=nr.v3;Dn.push(Cn[or*3+0]),Dn.push(Cn[or*3+1]),Dn.push(Cn[or*3+2]),Dn.push(Cn[mr*3+0]),Dn.push(Cn[mr*3+1]),Dn.push(Cn[mr*3+2]),Dn.push(Cn[$n*3+0]),Dn.push(Cn[$n*3+1]),Dn.push(Cn[$n*3+2]);const tn=nr.p1!==void 0?nr.p1:Nn.pindex,$t=nr.p2!==void 0?nr.p2:tn,An=nr.p3!==void 0?nr.p3:tn;ln.push(bn[tn*3+0]),ln.push(bn[tn*3+1]),ln.push(bn[tn*3+2]),ln.push(bn[$t*3+0]),ln.push(bn[$t*3+1]),ln.push(bn[$t*3+2]),ln.push(bn[An*3+0]),ln.push(bn[An*3+1]),ln.push(bn[An*3+2])}Pn.setAttribute("position",new Float32BufferAttribute(Dn,3)),Pn.setAttribute("color",new Float32BufferAttribute(ln,3));const kn=new MeshPhongMaterial({vertexColors:!0,flatShading:!0});return new Mesh(Pn,kn)}function Bt(Ot){const rn=new BufferGeometry;rn.setIndex(new BufferAttribute(Ot.triangles,1)),rn.setAttribute("position",new BufferAttribute(Ot.vertices,3));const fn=new MeshPhongMaterial({color:11184895,flatShading:!0});return new Mesh(rn,fn)}function Rt(Ot,rn,fn,hn,Tn,Nn){const Pn=Object.keys(Ot),Dn=[];for(let ln=0,Cn=Pn.length;ln<Cn;ln++){const bn=Pn[ln],kn=Ot[bn];switch(Ut(bn,hn)){case"material":const xn=hn.resources.basematerials[bn],Qn=St(xn,kn,rn,fn,hn,Tn,Nn);for(let mr=0,$n=Qn.length;mr<$n;mr++)Dn.push(Qn[mr]);break;case"texture":const nr=hn.resources.texture2dgroup[bn];Dn.push(Tt(nr,kn,rn,fn,hn,Tn,Nn));break;case"vertexColors":const or=hn.resources.colorgroup[bn];Dn.push(Mt(or,kn,rn,fn,hn,Nn));break;case"default":Dn.push(Bt(rn));break;default:console.error("THREE.3MFLoader: Unsupported resource type.")}}return Dn}function Ut(Ot,rn){return rn.resources.texture2dgroup[Ot]!==void 0?"texture":rn.resources.basematerials[Ot]!==void 0?"material":rn.resources.colorgroup[Ot]!==void 0?"vertexColors":Ot==="default"?"default":void 0}function Ht(Ot,rn,fn){const hn={},Tn=rn.triangleProperties,Nn=fn.pid;for(let Pn=0,Dn=Tn.length;Pn<Dn;Pn++){const ln=Tn[Pn];let Cn=ln.pid!==void 0?ln.pid:Nn;Cn===void 0&&(Cn="default"),hn[Cn]===void 0&&(hn[Cn]=[]),hn[Cn].push(ln)}return hn}function Wt(Ot,rn,fn,hn,Tn){const Nn=new Group,Pn=Ht(fn,Ot,Tn),Dn=Rt(Pn,Ot,rn,fn,hn,Tn);for(let ln=0,Cn=Dn.length;ln<Cn;ln++)Nn.add(Dn[ln]);return Nn}function Jt(Ot,rn,fn){if(!Ot)return;const hn=[],Tn=Object.keys(Ot);for(let Nn=0;Nn<Tn.length;Nn++){const Pn=Tn[Nn];for(let Dn=0;Dn<o.availableExtensions.length;Dn++){const ln=o.availableExtensions[Dn];ln.ns===Pn&&hn.push(ln)}}for(let Nn=0;Nn<hn.length;Nn++){const Pn=hn[Nn];Pn.apply(fn,Ot[Pn.ns],rn)}}function sn(Ot,rn,fn,hn,Tn,Nn){return Ot.build!==void 0||(Ot.build=Nn(Ot,rn,fn,hn,Tn)),Ot.build}function jt(Ot,rn,fn){let hn;const Tn=Ot.displaypropertiesid,Nn=fn.resources.pbmetallicdisplayproperties;if(Tn!==null&&Nn[Tn]!==void 0){const Cn=Nn[Tn].data[Ot.index];hn=new MeshStandardMaterial({flatShading:!0,roughness:Cn.roughness,metalness:Cn.metallicness})}else hn=new MeshPhongMaterial({flatShading:!0});hn.name=Ot.name;const Pn=Ot.displaycolor,Dn=Pn.substring(0,7);return hn.color.setStyle(Dn),hn.color.convertSRGBToLinear(),Pn.length===9&&(hn.opacity=parseInt(Pn.charAt(7)+Pn.charAt(8),16)/255),hn}function Vt(Ot,rn,fn,hn){const Tn=new Group;for(let Nn=0;Nn<Ot.length;Nn++){const Pn=Ot[Nn];let Dn=rn[Pn.objectId];Dn===void 0&&(Lt(Pn.objectId,rn,fn,hn),Dn=rn[Pn.objectId]);const ln=Dn.clone(),Cn=Pn.transform;Cn&&ln.applyMatrix4(Cn),Tn.add(ln)}return Tn}function Lt(Ot,rn,fn,hn){const Tn=fn.resources.object[Ot];if(Tn.mesh){const Nn=Tn.mesh,Pn=fn.extensions,Dn=fn.xml;Jt(Pn,Nn,Dn),rn[Tn.id]=sn(Nn,rn,fn,hn,Tn,Wt)}else{const Nn=Tn.components;rn[Tn.id]=sn(Nn,rn,fn,hn,Tn,Vt)}}function Qt(Ot){const rn=Ot.model,fn=Ot.modelRels,hn={},Tn=Object.keys(rn),Nn={};if(fn)for(let Pn=0,Dn=fn.length;Pn<Dn;Pn++){const ln=fn[Pn],Cn=ln.target.substring(1);Ot.texture[Cn]&&(Nn[ln.target]=Ot.texture[Cn])}for(let Pn=0;Pn<Tn.length;Pn++){const Dn=Tn[Pn],ln=rn[Dn],Cn=Object.keys(ln.resources.object);for(let bn=0;bn<Cn.length;bn++){const kn=Cn[bn];Lt(kn,hn,ln,Nn)}}return hn}function nn(Ot){for(let rn=0;rn<Ot.length;rn++){const fn=Ot[rn];if(fn.target.split(".").pop().toLowerCase()==="model")return fn}}function mn(Ot,rn){const fn=new Group,hn=nn(rn.rels),Tn=rn.model[hn.target.substring(1)].build;for(let Nn=0;Nn<Tn.length;Nn++){const Pn=Tn[Nn],Dn=Ot[Pn.objectId],ln=Pn.transform;ln&&Dn.applyMatrix4(ln),fn.add(Dn)}return fn}const Zt=$(s),cn=Qt(Zt);return mn(cn,Zt)}addExtension(s){this.availableExtensions.push(s)}}class XYZLoader extends Loader{load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=s.split(`
`),j=[],$=[];for(let tt of o){if(tt=tt.trim(),tt.charAt(0)==="#")continue;const nt=tt.split(/\s+/);nt.length===3&&(j.push(parseFloat(nt[0])),j.push(parseFloat(nt[1])),j.push(parseFloat(nt[2]))),nt.length===6&&(j.push(parseFloat(nt[0])),j.push(parseFloat(nt[1])),j.push(parseFloat(nt[2])),$.push(parseFloat(nt[3])/255),$.push(parseFloat(nt[4])/255),$.push(parseFloat(nt[5])/255))}const _e=new BufferGeometry;return _e.setAttribute("position",new Float32BufferAttribute(j,3)),$.length>0&&_e.setAttribute("color",new Float32BufferAttribute($,3)),_e}}class VTKLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(rt){var it=[],st=[],at=[],ot=[],ct,ft=/^[^\d.\s-]+/,ht=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,mt=/^(\d+)\s+([\s\d]*)/,lt=/^POINTS /,ut=/^POLYGONS /,dt=/^TRIANGLE_STRIPS /,gt=/^POINT_DATA[ ]+(\d+)/,Et=/^CELL_DATA[ ]+(\d+)/,St=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,Tt=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,Mt=!1,Bt=!1,Rt=!1,Ut=!1,Ht=!1,Wt=!1,Jt=!1,sn=rt.split(`
`);for(var jt in sn){var Vt=sn[jt].trim();if(Vt.indexOf("DATASET")===0){var Lt=Vt.split(" ")[1];if(Lt!=="POLYDATA")throw new Error("Unsupported DATASET type: "+Lt)}else if(Mt)for(;(ct=ht.exec(Vt))!==null&&ft.exec(Vt)===null;){var Qt=parseFloat(ct[1]),nn=parseFloat(ct[2]),mn=parseFloat(ct[3]);st.push(Qt,nn,mn)}else if(Bt){if((ct=mt.exec(Vt))!==null){var Zt=parseInt(ct[1]),cn=ct[2].split(/\s+/);if(Zt>=3)for(var Ot=parseInt(cn[0]),rn,fn,hn=1,Tn=0;Tn<Zt-2;++Tn)rn=parseInt(cn[hn]),fn=parseInt(cn[hn+1]),it.push(Ot,rn,fn),hn++}}else if(Rt){if((ct=mt.exec(Vt))!==null){var Zt=parseInt(ct[1]),cn=ct[2].split(/\s+/);if(Zt>=3)for(var Ot,rn,fn,Tn=0;Tn<Zt-2;Tn++)Tn%2===1?(Ot=parseInt(cn[Tn]),rn=parseInt(cn[Tn+2]),fn=parseInt(cn[Tn+1]),it.push(Ot,rn,fn)):(Ot=parseInt(cn[Tn]),rn=parseInt(cn[Tn+1]),fn=parseInt(cn[Tn+2]),it.push(Ot,rn,fn))}}else if(Ut||Ht){if(Wt)for(;(ct=ht.exec(Vt))!==null&&ft.exec(Vt)===null;){var Nn=parseFloat(ct[1]),Pn=parseFloat(ct[2]),Dn=parseFloat(ct[3]);at.push(Nn,Pn,Dn)}else if(Jt)for(;(ct=ht.exec(Vt))!==null&&ft.exec(Vt)===null;){var ln=parseFloat(ct[1]),Cn=parseFloat(ct[2]),bn=parseFloat(ct[3]);ot.push(ln,Cn,bn)}}ut.exec(Vt)!==null?(Bt=!0,Mt=!1,Rt=!1):lt.exec(Vt)!==null?(Bt=!1,Mt=!0,Rt=!1):dt.exec(Vt)!==null?(Bt=!1,Mt=!1,Rt=!0):gt.exec(Vt)!==null?(Ut=!0,Mt=!1,Bt=!1,Rt=!1):Et.exec(Vt)!==null?(Ht=!0,Mt=!1,Bt=!1,Rt=!1):St.exec(Vt)!==null?(Wt=!0,Jt=!1,Mt=!1,Bt=!1,Rt=!1):Tt.exec(Vt)!==null&&(Jt=!0,Wt=!1,Mt=!1,Bt=!1,Rt=!1)}var kn=new BufferGeometry;if(kn.setIndex(it),kn.setAttribute("position",new Float32BufferAttribute(st,3)),ot.length===st.length&&kn.setAttribute("normal",new Float32BufferAttribute(ot,3)),at.length!==it.length)at.length===st.length&&kn.setAttribute("color",new Float32BufferAttribute(at,3));else{kn=kn.toNonIndexed();var Sn=kn.attributes.position.count/3;if(at.length===Sn*3){for(var xn=[],jt=0;jt<Sn;jt++){var Nn=at[3*jt+0],Pn=at[3*jt+1],Dn=at[3*jt+2];xn.push(Nn,Pn,Dn),xn.push(Nn,Pn,Dn),xn.push(Nn,Pn,Dn)}kn.setAttribute("color",new Float32BufferAttribute(xn,3))}}return kn}function j(rt){var it,st,at,ot,ct,ft=new Uint8Array(rt),ht=new DataView(rt),mt=[],lt=[],ut=[],dt=0;function gt(sn,jt){for(var Vt=jt,Lt=sn[Vt],Qt=[];Lt!==10;)Qt.push(String.fromCharCode(Lt)),Vt++,Lt=sn[Vt];return{start:jt,end:Vt,next:Vt+1,parsedString:Qt.join("")}}for(var Et,St;;){if(Et=gt(ft,dt),St=Et.parsedString,St.indexOf("DATASET")===0){var Tt=St.split(" ")[1];if(Tt!=="POLYDATA")throw new Error("Unsupported DATASET type: "+Tt)}else if(St.indexOf("POINTS")===0){for(ot=parseInt(St.split(" ")[1],10),it=ot*4*3,mt=new Float32Array(ot*3),st=Et.next,at=0;at<ot;at++)mt[3*at]=ht.getFloat32(st,!1),mt[3*at+1]=ht.getFloat32(st+4,!1),mt[3*at+2]=ht.getFloat32(st+8,!1),st=st+12;Et.next=Et.next+it+1}else if(St.indexOf("TRIANGLE_STRIPS")===0){var Mt=parseInt(St.split(" ")[1],10),Bt=parseInt(St.split(" ")[2],10);it=Bt*4,ut=new Uint32Array(3*Bt-9*Mt);var Rt=0;for(st=Et.next,at=0;at<Mt;at++){var Ut=ht.getInt32(st,!1),Ht=[];for(st+=4,ct=0;ct<Ut;ct++)Ht.push(ht.getInt32(st,!1)),st+=4;for(var Wt=0;Wt<Ut-2;Wt++)Wt%2?(ut[Rt++]=Ht[Wt],ut[Rt++]=Ht[Wt+2],ut[Rt++]=Ht[Wt+1]):(ut[Rt++]=Ht[Wt],ut[Rt++]=Ht[Wt+1],ut[Rt++]=Ht[Wt+2])}Et.next=Et.next+it+1}else if(St.indexOf("POLYGONS")===0){var Mt=parseInt(St.split(" ")[1],10),Bt=parseInt(St.split(" ")[2],10);it=Bt*4,ut=new Uint32Array(3*Bt-9*Mt);var Rt=0;for(st=Et.next,at=0;at<Mt;at++){var Ut=ht.getInt32(st,!1),Ht=[];for(st+=4,ct=0;ct<Ut;ct++)Ht.push(ht.getInt32(st,!1)),st+=4;for(var Wt=1;Wt<Ut-1;Wt++)ut[Rt++]=Ht[0],ut[Rt++]=Ht[Wt],ut[Rt++]=Ht[Wt+1]}Et.next=Et.next+it+1}else if(St.indexOf("POINT_DATA")===0){for(ot=parseInt(St.split(" ")[1],10),Et=gt(ft,Et.next),it=ot*4*3,lt=new Float32Array(ot*3),st=Et.next,at=0;at<ot;at++)lt[3*at]=ht.getFloat32(st,!1),lt[3*at+1]=ht.getFloat32(st+4,!1),lt[3*at+2]=ht.getFloat32(st+8,!1),st+=12;Et.next=Et.next+it}if(dt=Et.next,dt>=ft.byteLength)break}var Jt=new BufferGeometry;return Jt.setIndex(new BufferAttribute(ut,1)),Jt.setAttribute("position",new BufferAttribute(mt,3)),lt.length===mt.length&&Jt.setAttribute("normal",new BufferAttribute(lt,3)),Jt}function $(rt,it){const st=rt.length,at=new Float32Array(st+it.length);return at.set(rt),at.set(it,st),at}function _e(rt,it){var st=rt.length,at=new Int32Array(st+it.length);return at.set(rt),at.set(it,st),at}function tt(rt){function it(Pn){var Dn={};if(Pn.nodeType===1){if(Pn.attributes&&Pn.attributes.length>0){Dn.attributes={};for(var ln=0;ln<Pn.attributes.length;ln++){var Cn=Pn.attributes.item(ln);Dn.attributes[Cn.nodeName]=Cn.nodeValue.trim()}}}else Pn.nodeType===3&&(Dn=Pn.nodeValue.trim());if(Pn.hasChildNodes())for(var bn=0;bn<Pn.childNodes.length;bn++){var kn=Pn.childNodes.item(bn),Sn=kn.nodeName;if(typeof Dn[Sn]>"u"){var xn=it(kn);xn!==""&&(Dn[Sn]=xn)}else{if(typeof Dn[Sn].push>"u"){var Qn=Dn[Sn];Dn[Sn]=[Qn]}var xn=it(kn);xn!==""&&Dn[Sn].push(xn)}}return Dn}function st(Pn){var Dn=typeof Uint8Array<"u"?Uint8Array:Array,ln,Cn=[],bn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",or=bn.length;for(ln=0;ln<or;ln++);for(ln=0;ln<or;++ln)Cn[bn.charCodeAt(ln)]=ln;Cn["-".charCodeAt(0)]=62,Cn["_".charCodeAt(0)]=63;var kn,Sn,xn,Qn,nr,or=Pn.length;if(or%4>0)throw new Error("Invalid string. Length must be a multiple of 4");Qn=Pn[or-2]==="="?2:Pn[or-1]==="="?1:0,nr=new Dn(or*3/4-Qn),Sn=Qn>0?or-4:or;var mr=0;for(ln=0,kn=0;ln<Sn;ln+=4,kn+=3)xn=Cn[Pn.charCodeAt(ln)]<<18|Cn[Pn.charCodeAt(ln+1)]<<12|Cn[Pn.charCodeAt(ln+2)]<<6|Cn[Pn.charCodeAt(ln+3)],nr[mr++]=(xn&16711680)>>16,nr[mr++]=(xn&65280)>>8,nr[mr++]=xn&255;return Qn===2?(xn=Cn[Pn.charCodeAt(ln)]<<2|Cn[Pn.charCodeAt(ln+1)]>>4,nr[mr++]=xn&255):Qn===1&&(xn=Cn[Pn.charCodeAt(ln)]<<10|Cn[Pn.charCodeAt(ln+1)]<<4|Cn[Pn.charCodeAt(ln+2)]>>2,nr[mr++]=xn>>8&255,nr[mr++]=xn&255),nr}function at(Pn,Dn){var ln=0;if(ft.attributes.header_type==="UInt64"?ln=8:ft.attributes.header_type==="UInt32"&&(ln=4),Pn.attributes.format==="binary"&&Dn){var Cn,bn,kn,Sn,xn,Qn,nr,or,mr;if(Pn.attributes.type==="Float32")var $n=new Float32Array;else if(Pn.attributes.type==="Int64")var $n=new Int32Array;Cn=Pn["#text"],kn=st(Cn),Sn=kn[0];for(var tn=1;tn<ln-1;tn++)Sn=Sn|kn[tn]<<tn*ln;Qn=(Sn+3)*ln,nr=Qn%3>0?3-Qn%3:0,Qn=Qn+nr,or=[],mr=Qn,or.push(mr),xn=3*ln;for(var tn=0;tn<Sn;tn++){for(var $t=kn[tn*ln+xn],An=1;An<ln-1;An++)$t=$t|kn[tn*ln+xn+An]<<An*8;mr=mr+$t,or.push(mr)}for(var tn=0;tn<or.length-1;tn++){var En=unzlibSync(kn.slice(or[tn],or[tn+1]));bn=En.buffer,Pn.attributes.type==="Float32"?(bn=new Float32Array(bn),$n=$($n,bn)):Pn.attributes.type==="Int64"&&(bn=new Int32Array(bn),$n=_e($n,bn))}delete Pn["#text"],Pn.attributes.type==="Int64"&&Pn.attributes.format==="binary"&&($n=$n.filter(function(In,Hn){if(Hn%2!==1)return!0}))}else{if(Pn.attributes.format==="binary"&&!Dn){var bn=st(Pn["#text"]);bn=bn.slice(ln).buffer}else if(Pn["#text"])var bn=Pn["#text"].split(/\s+/).filter(function(Hn){if(Hn!=="")return Hn});else var bn=new Int32Array(0).buffer;if(delete Pn["#text"],Pn.attributes.type==="Float32")var $n=new Float32Array(bn);else if(Pn.attributes.type==="Int32")var $n=new Int32Array(bn);else if(Pn.attributes.type==="Int64"){var $n=new Int32Array(bn);Pn.attributes.format==="binary"&&($n=$n.filter(function(Hn,yn){if(yn%2!==1)return!0}))}}return $n}var ot=null;if(window.DOMParser)try{ot=new DOMParser().parseFromString(rt,"text/xml")}catch{ot=null}else if(window.ActiveXObject)try{if(ot=new ActiveXObject("Microsoft.XMLDOM"),ot.async=!1,!ot.loadXML())throw new Error(ot.parseError.reason+ot.parseError.srcText)}catch{ot=null}else throw new Error("Cannot parse xml string!");var ct=ot.documentElement,ft=it(ct),ht=[],mt=[],lt=[];if(ft.PolyData){for(var ut=ft.PolyData.Piece,dt=ft.attributes.hasOwnProperty("compressor"),gt=["PointData","Points","Strips","Polys"],Et=0,St=gt.length;Et<St;){var Tt=ut[gt[Et]];if(Tt&&Tt.DataArray){if(Object.prototype.toString.call(Tt.DataArray)==="[object Array]")var Mt=Tt.DataArray;else var Mt=[Tt.DataArray];for(var Bt=0,Rt=Mt.length;Bt<Rt;)"#text"in Mt[Bt]&&Mt[Bt]["#text"].length>0&&(Mt[Bt].text=at(Mt[Bt],dt)),Bt++;switch(gt[Et]){case"PointData":var sn=parseInt(ut.attributes.NumberOfPoints),Ut=Tt.attributes.Normals;if(sn>0){for(var Ht=0,Wt=Mt.length;Ht<Wt;Ht++)if(Ut===Mt[Ht].attributes.Name){var Jt=Mt[Ht].attributes.NumberOfComponents;mt=new Float32Array(sn*Jt),mt.set(Mt[Ht].text,0)}}break;case"Points":var sn=parseInt(ut.attributes.NumberOfPoints);if(sn>0){var Jt=Tt.DataArray.attributes.NumberOfComponents;ht=new Float32Array(sn*Jt),ht.set(Tt.DataArray.text,0)}break;case"Strips":var jt=parseInt(ut.attributes.NumberOfStrips);if(jt>0){var Vt=new Int32Array(Tt.DataArray[0].text.length),Lt=new Int32Array(Tt.DataArray[1].text.length);Vt.set(Tt.DataArray[0].text,0),Lt.set(Tt.DataArray[1].text,0);var Qt=jt+Vt.length;lt=new Uint32Array(3*Qt-9*jt);for(var nn=0,Ht=0,Wt=jt;Ht<Wt;Ht++){for(var mn=[],Zt=0,cn=Lt[Ht],Ot=0;Zt<cn-Ot;Zt++)mn.push(Vt[Zt]),Ht>0&&(Ot=Lt[Ht-1]);for(var rn=0,cn=Lt[Ht],Ot=0;rn<cn-Ot-2;rn++)rn%2?(lt[nn++]=mn[rn],lt[nn++]=mn[rn+2],lt[nn++]=mn[rn+1]):(lt[nn++]=mn[rn],lt[nn++]=mn[rn+1],lt[nn++]=mn[rn+2]),Ht>0&&(Ot=Lt[Ht-1])}}break;case"Polys":var fn=parseInt(ut.attributes.NumberOfPolys);if(fn>0){var Vt=new Int32Array(Tt.DataArray[0].text.length),Lt=new Int32Array(Tt.DataArray[1].text.length);Vt.set(Tt.DataArray[0].text,0),Lt.set(Tt.DataArray[1].text,0);var Qt=fn+Vt.length;lt=new Uint32Array(3*Qt-9*fn);for(var nn=0,hn=0,Ht=0,Wt=fn,Ot=0;Ht<Wt;){for(var Tn=[],Zt=0,cn=Lt[Ht];Zt<cn-Ot;)Tn.push(Vt[hn++]),Zt++;for(var rn=1;rn<cn-Ot-1;)lt[nn++]=Tn[0],lt[nn++]=Tn[rn],lt[nn++]=Tn[rn+1],rn++;Ht++,Ot=Lt[Ht-1]}}break}}Et++}var Nn=new BufferGeometry;return Nn.setIndex(new BufferAttribute(lt,1)),Nn.setAttribute("position",new BufferAttribute(ht,3)),mt.length===ht.length&&Nn.setAttribute("normal",new BufferAttribute(mt,3)),Nn}else throw new Error("Unsupported DATASET type")}var nt=LoaderUtils.decodeText(new Uint8Array(s,0,250)).split(`
`);return nt[0].indexOf("xml")!==-1?tt(LoaderUtils.decodeText(s)):nt[2].includes("ASCII")?o(LoaderUtils.decodeText(s)):j(s)}}class LUT3dlLoader extends Loader{load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setResponseType("text"),_e.load(s,tt=>{try{o(this.parse(tt))}catch(nt){$?$(nt):console.error(nt),this.manager.itemError(s)}},j,$)}parse(s){s=s.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim();const o=s.split(/[\n\r]+/g),j=o[0].trim().split(/\s+/g).map(ft=>parseFloat(ft)),$=j[1]-j[0],_e=j.length;for(let ft=1,ht=j.length;ft<ht;ft++)if($!==j[ft]-j[ft-1])throw new Error("LUT3dlLoader: Inconsistent grid size not supported.");const tt=new Array(_e*_e*_e*4);let nt=0,rt=0;for(let ft=1,ht=o.length;ft<ht;ft++){const lt=o[ft].trim().split(/\s/g),ut=parseFloat(lt[0]),dt=parseFloat(lt[1]),gt=parseFloat(lt[2]);rt=Math.max(rt,ut,dt,gt);const Et=nt%_e,St=Math.floor(nt/_e)%_e,Tt=Math.floor(nt/(_e*_e))%_e,Mt=Et*_e*_e+St*_e+Tt;tt[4*Mt+0]=ut,tt[4*Mt+1]=dt,tt[4*Mt+2]=gt,tt[4*Mt+3]=1,nt+=1}const it=Math.ceil(Math.log2(rt)),st=Math.pow(2,it);for(let ft=0,ht=tt.length;ft<ht;ft+=4){const mt=tt[ft+0],lt=tt[ft+1],ut=tt[ft+2];tt[ft+0]=255*mt/st,tt[ft+1]=255*lt/st,tt[ft+2]=255*ut/st}const at=new Uint8Array(tt),ot=new DataTexture;ot.image.data=at,ot.image.width=_e,ot.image.height=_e*_e,ot.format=RGBAFormat,ot.type=UnsignedByteType,ot.magFilter=LinearFilter,ot.minFilter=LinearFilter,ot.wrapS=ClampToEdgeWrapping,ot.wrapT=ClampToEdgeWrapping,ot.generateMipmaps=!1,ot.needsUpdate=!0;const ct=new Data3DTexture;return ct.image.data=at,ct.image.width=_e,ct.image.height=_e,ct.image.depth=_e,ct.format=RGBAFormat,ct.type=UnsignedByteType,ct.magFilter=LinearFilter,ct.minFilter=LinearFilter,ct.wrapS=ClampToEdgeWrapping,ct.wrapT=ClampToEdgeWrapping,ct.wrapR=ClampToEdgeWrapping,ct.generateMipmaps=!1,ct.needsUpdate=!0,{size:_e,texture:ot,texture3D:ct}}}class DDSLoader extends CompressedTextureLoader{constructor(s){super(s)}parse(s,o){const j={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},$=542327876,_e=131072,tt=512,nt=1024,rt=2048,it=4096,st=8192,at=16384,ot=32768,ct=4;function ft(hn){return hn.charCodeAt(0)+(hn.charCodeAt(1)<<8)+(hn.charCodeAt(2)<<16)+(hn.charCodeAt(3)<<24)}function ht(hn){return String.fromCharCode(hn&255,hn>>8&255,hn>>16&255,hn>>24&255)}function mt(hn,Tn,Nn,Pn){const Dn=Nn*Pn*4,ln=new Uint8Array(hn,Tn,Dn),Cn=new Uint8Array(Dn);let bn=0,kn=0;for(let Sn=0;Sn<Pn;Sn++)for(let xn=0;xn<Nn;xn++){const Qn=ln[kn];kn++;const nr=ln[kn];kn++;const or=ln[kn];kn++;const mr=ln[kn];kn++,Cn[bn]=or,bn++,Cn[bn]=nr,bn++,Cn[bn]=Qn,bn++,Cn[bn]=mr,bn++}return Cn}const lt=ft("DXT1"),ut=ft("DXT3"),dt=ft("DXT5"),gt=ft("ETC1"),Et=31,St=0,Tt=1,Mt=2,Bt=3,Rt=4,Ut=7,Ht=20,Wt=21,Jt=22,sn=23,jt=24,Vt=25,Lt=26,Qt=28,nn=new Int32Array(s,0,Et);if(nn[St]!==$)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),j;if(!nn[Ht]&ct)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),j;let mn;const Zt=nn[Wt];let cn=!1;switch(Zt){case lt:mn=8,j.format=RGB_S3TC_DXT1_Format;break;case ut:mn=16,j.format=RGBA_S3TC_DXT3_Format;break;case dt:mn=16,j.format=RGBA_S3TC_DXT5_Format;break;case gt:mn=8,j.format=RGB_ETC1_Format;break;default:if(nn[Jt]===32&&nn[sn]&16711680&&nn[jt]&65280&&nn[Vt]&255&&nn[Lt]&4278190080)cn=!0,mn=64,j.format=RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",ht(Zt)),j}j.mipmapCount=1,nn[Mt]&_e&&o!==!1&&(j.mipmapCount=Math.max(1,nn[Ut]));const Ot=nn[Qt];if(j.isCubemap=!!(Ot&tt),j.isCubemap&&(!(Ot&nt)||!(Ot&rt)||!(Ot&it)||!(Ot&st)||!(Ot&at)||!(Ot&ot)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),j;j.width=nn[Rt],j.height=nn[Bt];let rn=nn[Tt]+4;const fn=j.isCubemap?6:1;for(let hn=0;hn<fn;hn++){let Tn=j.width,Nn=j.height;for(let Pn=0;Pn<j.mipmapCount;Pn++){let Dn,ln;cn?(Dn=mt(s,rn,Tn,Nn),ln=Dn.length):(ln=Math.max(4,Tn)/4*Math.max(4,Nn)/4*mn,Dn=new Uint8Array(s,rn,ln));const Cn={data:Dn,width:Tn,height:Nn};j.mipmaps.push(Cn),rn+=ln,Tn=Math.max(Tn>>1,1),Nn=Math.max(Nn>>1,1)}}return j}}class PVRLoader extends CompressedTextureLoader{constructor(s){super(s)}parse(s,o){const $=new Uint32Array(s,0,13),_e={buffer:s,header:$,loadMipmaps:o};if($[0]===55727696)return _parseV3(_e);if($[11]===559044176)return _parseV2(_e);console.error("THREE.PVRLoader: Unknown PVR format.")}}function _parseV3(a){const s=a.header;let o,j;const $=s[12],_e=s[2],tt=s[6],nt=s[7],rt=s[10],it=s[11];switch(_e){case 0:o=2,j=RGB_PVRTC_2BPPV1_Format;break;case 1:o=2,j=RGBA_PVRTC_2BPPV1_Format;break;case 2:o=4,j=RGB_PVRTC_4BPPV1_Format;break;case 3:o=4,j=RGBA_PVRTC_4BPPV1_Format;break;default:console.error("THREE.PVRLoader: Unsupported PVR format:",_e)}return a.dataPtr=52+$,a.bpp=o,a.format=j,a.width=nt,a.height=tt,a.numSurfaces=rt,a.numMipmaps=it,a.isCubemap=rt===6,_extract(a)}function _parseV2(a){const s=a.header,o=s[0],j=s[1],$=s[2],_e=s[3],tt=s[4],nt=s[10],rt=s[12],it=255,st=24,at=25,ot=tt&it;let ct,ft;const ht=nt>0;return ot===at?(ft=ht?RGBA_PVRTC_4BPPV1_Format:RGB_PVRTC_4BPPV1_Format,ct=4):ot===st?(ft=ht?RGBA_PVRTC_2BPPV1_Format:RGB_PVRTC_2BPPV1_Format,ct=2):console.error("THREE.PVRLoader: Unknown PVR format:",ot),a.dataPtr=o,a.bpp=ct,a.format=ft,a.width=$,a.height=j,a.numSurfaces=rt,a.numMipmaps=_e+1,a.isCubemap=rt===6,_extract(a)}function _extract(a){const s={mipmaps:[],width:a.width,height:a.height,format:a.format,mipmapCount:a.numMipmaps,isCubemap:a.isCubemap},o=a.buffer;let j=a.dataPtr,$=0,_e=0,tt=0,nt=0,rt=0,it=0;const st=a.bpp,at=a.numSurfaces;st===2?(tt=8,nt=4):(tt=4,nt=4),_e=tt*nt*st/8,s.mipmaps.length=a.numMipmaps*at;let ot=0;for(;ot<a.numMipmaps;){const ct=a.width>>ot,ft=a.height>>ot;rt=ct/tt,it=ft/nt,rt<2&&(rt=2),it<2&&(it=2),$=rt*it*_e;for(let ht=0;ht<at;ht++){const lt={data:new Uint8Array(o,j,$),width:ct,height:ft};s.mipmaps[ht*a.numMipmaps+ot]=lt,j+=$}ot++}return s}class GCodeLoader extends Loader{constructor(s){super(s),this.splitLayer=!1}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){let o={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},j=[],$;const _e=new LineBasicMaterial({color:16711680});_e.name="path";const tt=new LineBasicMaterial({color:65280});tt.name="extruded";function nt(ft){$={vertex:[],pathVertex:[],z:ft.z},j.push($)}function rt(ft,ht){$===void 0&&nt(ft),o.extruding?($.vertex.push(ft.x,ft.y,ft.z),$.vertex.push(ht.x,ht.y,ht.z)):($.pathVertex.push(ft.x,ft.y,ft.z),$.pathVertex.push(ht.x,ht.y,ht.z))}function it(ft,ht){return o.relative?ht:ht-ft}function st(ft,ht){return o.relative?ft+ht:ht}let at=s.replace(/;.+/g,"").split(`
`);for(let ft=0;ft<at.length;ft++){let ht=at[ft].split(" "),mt=ht[0].toUpperCase(),lt={};if(ht.splice(1).forEach(function(ut){if(ut[0]!==void 0){let dt=ut[0].toLowerCase(),gt=parseFloat(ut.substring(1));lt[dt]=gt}}),mt==="G0"||mt==="G1"){let ut={x:lt.x!==void 0?st(o.x,lt.x):o.x,y:lt.y!==void 0?st(o.y,lt.y):o.y,z:lt.z!==void 0?st(o.z,lt.z):o.z,e:lt.e!==void 0?st(o.e,lt.e):o.e,f:lt.f!==void 0?st(o.f,lt.f):o.f};it(o.e,ut.e)>0&&(ut.extruding=it(o.e,ut.e)>0,($==null||ut.z!=$.z)&&nt(ut)),rt(o,ut),o=ut}else if(!(mt==="G2"||mt==="G3")){if(mt==="G90")o.relative=!1;else if(mt==="G91")o.relative=!0;else if(mt==="G92"){let ut=o;ut.x=lt.x!==void 0?lt.x:ut.x,ut.y=lt.y!==void 0?lt.y:ut.y,ut.z=lt.z!==void 0?lt.z:ut.z,ut.e=lt.e!==void 0?lt.e:ut.e,o=ut}}}function ot(ft,ht,mt){let lt=new BufferGeometry;lt.setAttribute("position",new Float32BufferAttribute(ft,3));let ut=new LineSegments(lt,ht?tt:_e);ut.name="layer"+mt,ct.add(ut)}const ct=new Group;if(ct.name="gcode",this.splitLayer)for(let ft=0;ft<j.length;ft++){let ht=j[ft];ot(ht.vertex,!0,ft),ot(ht.pathVertex,!1,ft)}else{const ft=[],ht=[];for(let mt=0;mt<j.length;mt++){let lt=j[mt],ut=lt.vertex,dt=lt.pathVertex;for(let gt=0;gt<ut.length;gt++)ft.push(ut[gt]);for(let gt=0;gt<dt.length;gt++)ht.push(dt[gt])}ot(ft,!0,j.length),ot(ht,!1,j.length)}return ct.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),ct}}const _taskCache$2=new WeakMap,_BasisTextureLoader=class extends Loader{constructor(a){super(a),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig=null}setTranscoderPath(a){return this.transcoderPath=a,this}setWorkerLimit(a){return this.workerLimit=a,this}detectSupport(a){return this.workerConfig={astcSupported:a.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:a.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:a.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:a.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:a.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:a.extensions.has("WEBGL_compressed_texture_pvrtc")||a.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}load(a,s,o,j){const $=new FileLoader(this.manager);$.setResponseType("arraybuffer"),$.setWithCredentials(this.withCredentials);const _e=new CompressedTexture;return $.load(a,tt=>{if(_taskCache$2.has(tt))return _taskCache$2.get(tt).promise.then(s).catch(j);this._createTexture([tt]).then(function(nt){_e.copy(nt),_e.needsUpdate=!0,s&&s(_e)}).catch(j)},o,j),_e}parseInternalAsync(a){const{levels:s}=a,o=new Set;for(let j=0;j<s.length;j++)o.add(s[j].data.buffer);return this._createTexture(Array.from(o),{...a,lowLevel:!0})}_createTexture(a,s={}){let o,j;const $=s;let _e=0;for(let nt=0;nt<a.length;nt++)_e+=a[nt].byteLength;const tt=this._allocateWorker(_e).then(nt=>(o=nt,j=this.workerNextTaskID++,new Promise((rt,it)=>{o._callbacks[j]={resolve:rt,reject:it},o.postMessage({type:"transcode",id:j,buffers:a,taskConfig:$},a)}))).then(nt=>{const{mipmaps:rt,width:it,height:st,format:at}=nt,ot=new CompressedTexture(rt,it,st,at,UnsignedByteType);return ot.minFilter=rt.length===1?LinearFilter:LinearMipmapLinearFilter,ot.magFilter=LinearFilter,ot.generateMipmaps=!1,ot.needsUpdate=!0,ot});return tt.catch(()=>!0).then(()=>{o&&j&&(o._taskLoad-=_e,delete o._callbacks[j])}),_taskCache$2.set(a[0],{promise:tt}),tt}_initTranscoder(){if(!this.transcoderPending){const a=new FileLoader(this.manager);a.setPath(this.transcoderPath),a.setWithCredentials(this.withCredentials);const s=new Promise(($,_e)=>{a.load("basis_transcoder.js",$,void 0,_e)}),o=new FileLoader(this.manager);o.setPath(this.transcoderPath),o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials);const j=new Promise(($,_e)=>{o.load("basis_transcoder.wasm",$,void 0,_e)});this.transcoderPending=Promise.all([s,j]).then(([$,_e])=>{const tt=_BasisTextureLoader.BasisWorker.toString(),nt=["/* constants */","let _EngineFormat = "+JSON.stringify(_BasisTextureLoader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(_BasisTextureLoader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(_BasisTextureLoader.BasisFormat),"/* basis_transcoder.js */",$,"/* worker */",tt.substring(tt.indexOf("{")+1,tt.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([nt])),this.transcoderBinary=_e})}return this.transcoderPending}_allocateWorker(a){return this._initTranscoder().then(()=>{if(this.workerPool.length<this.workerLimit){const o=new Worker(this.workerSourceURL);o._callbacks={},o._taskLoad=0,o.postMessage({type:"init",config:this.workerConfig,transcoderBinary:this.transcoderBinary}),o.onmessage=function(j){const $=j.data;switch($.type){case"transcode":o._callbacks[$.id].resolve($);break;case"error":o._callbacks[$.id].reject($);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+$.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,j){return o._taskLoad>j._taskLoad?-1:1});const s=this.workerPool[this.workerPool.length-1];return s._taskLoad+=a,s})}dispose(){for(let a=0;a<this.workerPool.length;a++)this.workerPool[a].terminate();return this.workerPool.length=0,this}};let BasisTextureLoader=_BasisTextureLoader;class TDSLoader extends Loader{constructor(s){super(s),this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]}load(s,o,j,$){const _e=this,tt=this.path===""?LoaderUtils.extractUrlBase(s):this.path,nt=new FileLoader(this.manager);nt.setPath(this.path),nt.setResponseType("arraybuffer"),nt.setRequestHeader(this.requestHeader),nt.setWithCredentials(this.withCredentials),nt.load(s,function(rt){try{o(_e.parse(rt,tt))}catch(it){$?$(it):console.error(it),_e.manager.itemError(s)}},j,$)}parse(s,o){this.group=new Group,this.position=0,this.materials=[],this.meshes=[],this.readFile(s,o);for(let j=0;j<this.meshes.length;j++)this.group.add(this.meshes[j]);return this.group}readFile(s,o){const j=new DataView(s),$=this.readChunk(j);if($.id===MLIBMAGIC||$.id===CMAGIC||$.id===M3DMAGIC){let _e=this.nextChunk(j,$);for(;_e!==0;){if(_e===M3D_VERSION){const tt=this.readDWord(j);this.debugMessage("3DS file version: "+tt)}else _e===MDATA?(this.resetPosition(j),this.readMeshData(j,o)):this.debugMessage("Unknown main chunk: "+_e.toString(16));_e=this.nextChunk(j,$)}}this.debugMessage("Parsed "+this.meshes.length+" meshes")}readMeshData(s,o){const j=this.readChunk(s);let $=this.nextChunk(s,j);for(;$!==0;){if($===MESH_VERSION){const _e=+this.readDWord(s);this.debugMessage("Mesh Version: "+_e)}else if($===MASTER_SCALE){const _e=this.readFloat(s);this.debugMessage("Master scale: "+_e),this.group.scale.set(_e,_e,_e)}else $===NAMED_OBJECT?(this.debugMessage("Named Object"),this.resetPosition(s),this.readNamedObject(s)):$===MAT_ENTRY?(this.debugMessage("Material"),this.resetPosition(s),this.readMaterialEntry(s,o)):this.debugMessage("Unknown MDATA chunk: "+$.toString(16));$=this.nextChunk(s,j)}}readNamedObject(s){const o=this.readChunk(s),j=this.readString(s,64);o.cur=this.position;let $=this.nextChunk(s,o);for(;$!==0;){if($===N_TRI_OBJECT){this.resetPosition(s);const _e=this.readMesh(s);_e.name=j,this.meshes.push(_e)}else this.debugMessage("Unknown named object chunk: "+$.toString(16));$=this.nextChunk(s,o)}this.endChunk(o)}readMaterialEntry(s,o){const j=this.readChunk(s);let $=this.nextChunk(s,j);const _e=new MeshPhongMaterial;for(;$!==0;){if($===MAT_NAME)_e.name=this.readString(s,64),this.debugMessage("   Name: "+_e.name);else if($===MAT_WIRE)this.debugMessage("   Wireframe"),_e.wireframe=!0;else if($===MAT_WIRE_SIZE){const tt=this.readByte(s);_e.wireframeLinewidth=tt,this.debugMessage("   Wireframe Thickness: "+tt)}else if($===MAT_TWO_SIDE)_e.side=DoubleSide,this.debugMessage("   DoubleSided");else if($===MAT_ADDITIVE)this.debugMessage("   Additive Blending"),_e.blending=AdditiveBlending;else if($===MAT_DIFFUSE)this.debugMessage("   Diffuse Color"),_e.color=this.readColor(s);else if($===MAT_SPECULAR)this.debugMessage("   Specular Color"),_e.specular=this.readColor(s);else if($===MAT_AMBIENT)this.debugMessage("   Ambient color"),_e.color=this.readColor(s);else if($===MAT_SHININESS){const tt=this.readPercentage(s);_e.shininess=tt*100,this.debugMessage("   Shininess : "+tt)}else if($===MAT_TRANSPARENCY){const tt=this.readPercentage(s);_e.opacity=1-tt,this.debugMessage("  Transparency : "+tt),_e.transparent=_e.opacity<1}else $===MAT_TEXMAP?(this.debugMessage("   ColorMap"),this.resetPosition(s),_e.map=this.readMap(s,o)):$===MAT_BUMPMAP?(this.debugMessage("   BumpMap"),this.resetPosition(s),_e.bumpMap=this.readMap(s,o)):$===MAT_OPACMAP?(this.debugMessage("   OpacityMap"),this.resetPosition(s),_e.alphaMap=this.readMap(s,o)):$===MAT_SPECMAP?(this.debugMessage("   SpecularMap"),this.resetPosition(s),_e.specularMap=this.readMap(s,o)):this.debugMessage("   Unknown material chunk: "+$.toString(16));$=this.nextChunk(s,j)}this.endChunk(j),this.materials[_e.name]=_e}readMesh(s){const o=this.readChunk(s);let j=this.nextChunk(s,o);const $=new BufferGeometry,_e=new MeshPhongMaterial,tt=new Mesh($,_e);for(tt.name="mesh";j!==0;){if(j===POINT_ARRAY){const nt=this.readWord(s);this.debugMessage("   Vertex: "+nt);const rt=[];for(let it=0;it<nt;it++)rt.push(this.readFloat(s)),rt.push(this.readFloat(s)),rt.push(this.readFloat(s));$.setAttribute("position",new Float32BufferAttribute(rt,3))}else if(j===FACE_ARRAY)this.resetPosition(s),this.readFaceArray(s,tt);else if(j===TEX_VERTS){const nt=this.readWord(s);this.debugMessage("   UV: "+nt);const rt=[];for(let it=0;it<nt;it++)rt.push(this.readFloat(s)),rt.push(this.readFloat(s));$.setAttribute("uv",new Float32BufferAttribute(rt,2))}else if(j===MESH_MATRIX){this.debugMessage("   Tranformation Matrix (TODO)");const nt=[];for(let st=0;st<12;st++)nt[st]=this.readFloat(s);const rt=new Matrix4;rt.elements[0]=nt[0],rt.elements[1]=nt[6],rt.elements[2]=nt[3],rt.elements[3]=nt[9],rt.elements[4]=nt[2],rt.elements[5]=nt[8],rt.elements[6]=nt[5],rt.elements[7]=nt[11],rt.elements[8]=nt[1],rt.elements[9]=nt[7],rt.elements[10]=nt[4],rt.elements[11]=nt[10],rt.elements[12]=0,rt.elements[13]=0,rt.elements[14]=0,rt.elements[15]=1,rt.transpose();const it=new Matrix4;it.copy(rt).invert(),$.applyMatrix4(it),rt.decompose(tt.position,tt.quaternion,tt.scale)}else this.debugMessage("   Unknown mesh chunk: "+j.toString(16));j=this.nextChunk(s,o)}return this.endChunk(o),$.computeVertexNormals(),tt}readFaceArray(s,o){const j=this.readChunk(s),$=this.readWord(s);this.debugMessage("   Faces: "+$);const _e=[];for(let rt=0;rt<$;++rt)_e.push(this.readWord(s),this.readWord(s),this.readWord(s)),this.readWord(s);o.geometry.setIndex(_e);let tt=0,nt=0;for(;this.position<j.end;){const rt=this.readChunk(s);if(rt.id===MSH_MAT_GROUP){this.debugMessage("      Material Group"),this.resetPosition(s);const it=this.readMaterialGroup(s),st=it.index.length*3;o.geometry.addGroup(nt,st,tt),nt+=st,tt++;const at=this.materials[it.name];Array.isArray(o.material)===!1&&(o.material=[]),at!==void 0&&o.material.push(at)}else this.debugMessage("      Unknown face array chunk: "+rt.toString(16));this.endChunk(rt)}o.material.length===1&&(o.material=o.material[0]),this.endChunk(j)}readMap(s,o){const j=this.readChunk(s);let $=this.nextChunk(s,j),_e={};const tt=new TextureLoader(this.manager);for(tt.setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);$!==0;){if($===MAT_MAPNAME){const nt=this.readString(s,128);_e=tt.load(nt),this.debugMessage("      File: "+o+nt)}else $===MAT_MAP_UOFFSET?(_e.offset.x=this.readFloat(s),this.debugMessage("      OffsetX: "+_e.offset.x)):$===MAT_MAP_VOFFSET?(_e.offset.y=this.readFloat(s),this.debugMessage("      OffsetY: "+_e.offset.y)):$===MAT_MAP_USCALE?(_e.repeat.x=this.readFloat(s),this.debugMessage("      RepeatX: "+_e.repeat.x)):$===MAT_MAP_VSCALE?(_e.repeat.y=this.readFloat(s),this.debugMessage("      RepeatY: "+_e.repeat.y)):this.debugMessage("      Unknown map chunk: "+$.toString(16));$=this.nextChunk(s,j)}return this.endChunk(j),_e}readMaterialGroup(s){this.readChunk(s);const o=this.readString(s,64),j=this.readWord(s);this.debugMessage("         Name: "+o),this.debugMessage("         Faces: "+j);const $=[];for(let _e=0;_e<j;++_e)$.push(this.readWord(s));return{name:o,index:$}}readColor(s){const o=this.readChunk(s),j=new Color;if(o.id===COLOR_24||o.id===LIN_COLOR_24){const $=this.readByte(s),_e=this.readByte(s),tt=this.readByte(s);j.setRGB($/255,_e/255,tt/255),this.debugMessage("      Color: "+j.r+", "+j.g+", "+j.b)}else if(o.id===COLOR_F||o.id===LIN_COLOR_F){const $=this.readFloat(s),_e=this.readFloat(s),tt=this.readFloat(s);j.setRGB($,_e,tt),this.debugMessage("      Color: "+j.r+", "+j.g+", "+j.b)}else this.debugMessage("      Unknown color chunk: "+o.toString(16));return this.endChunk(o),j}readChunk(s){const o={};return o.cur=this.position,o.id=this.readWord(s),o.size=this.readDWord(s),o.end=o.cur+o.size,o.cur+=6,o}endChunk(s){this.position=s.end}nextChunk(s,o){if(o.cur>=o.end)return 0;this.position=o.cur;try{const j=this.readChunk(s);return o.cur+=j.size,j.id}catch{return this.debugMessage("Unable to read chunk at "+this.position),0}}resetPosition(){this.position-=6}readByte(s){const o=s.getUint8(this.position,!0);return this.position+=1,o}readFloat(s){try{const o=s.getFloat32(this.position,!0);return this.position+=4,o}catch(o){this.debugMessage(o+" "+this.position+" "+s.byteLength)}}readInt(s){const o=s.getInt32(this.position,!0);return this.position+=4,o}readShort(s){const o=s.getInt16(this.position,!0);return this.position+=2,o}readDWord(s){const o=s.getUint32(this.position,!0);return this.position+=4,o}readWord(s){const o=s.getUint16(this.position,!0);return this.position+=2,o}readString(s,o){let j="";for(let $=0;$<o;$++){const _e=this.readByte(s);if(!_e)break;j+=String.fromCharCode(_e)}return j}readPercentage(s){const o=this.readChunk(s);let j;switch(o.id){case INT_PERCENTAGE:j=this.readShort(s)/100;break;case FLOAT_PERCENTAGE:j=this.readFloat(s);break;default:this.debugMessage("      Unknown percentage chunk: "+o.toString(16))}return this.endChunk(o),j}debugMessage(s){this.debug&&console.log(s)}}const M3DMAGIC=19789,MLIBMAGIC=15786,CMAGIC=49725,M3D_VERSION=2,COLOR_F=16,COLOR_24=17,LIN_COLOR_24=18,LIN_COLOR_F=19,INT_PERCENTAGE=48,FLOAT_PERCENTAGE=49,MDATA=15677,MESH_VERSION=15678,MASTER_SCALE=256,MAT_ENTRY=45055,MAT_NAME=40960,MAT_AMBIENT=40976,MAT_DIFFUSE=40992,MAT_SPECULAR=41008,MAT_SHININESS=41024,MAT_TRANSPARENCY=41040,MAT_TWO_SIDE=41089,MAT_ADDITIVE=41091,MAT_WIRE=41093,MAT_WIRE_SIZE=41095,MAT_TEXMAP=41472,MAT_OPACMAP=41488,MAT_BUMPMAP=41520,MAT_SPECMAP=41476,MAT_MAPNAME=41728,MAT_MAP_USCALE=41812,MAT_MAP_VSCALE=41814,MAT_MAP_UOFFSET=41816,MAT_MAP_VOFFSET=41818,NAMED_OBJECT=16384,N_TRI_OBJECT=16640,POINT_ARRAY=16656,FACE_ARRAY=16672,MSH_MAT_GROUP=16688,TEX_VERTS=16704,MESH_MATRIX=16736,FINISH_TYPE_DEFAULT=0,FINISH_TYPE_CHROME=1,FINISH_TYPE_PEARLESCENT=2,FINISH_TYPE_RUBBER=3,FINISH_TYPE_MATTE_METALLIC=4,FINISH_TYPE_METAL=5,FILE_LOCATION_AS_IS=0,FILE_LOCATION_TRY_PARTS=1,FILE_LOCATION_TRY_P=2,FILE_LOCATION_TRY_MODELS=3,FILE_LOCATION_TRY_RELATIVE=4,FILE_LOCATION_TRY_ABSOLUTE=5,FILE_LOCATION_NOT_FOUND=6,MAIN_COLOUR_CODE="16",MAIN_EDGE_COLOUR_CODE="24",_tempVec0=new Vector3,_tempVec1=new Vector3;class LDrawConditionalLineMaterial extends ShaderMaterial{constructor(s){super({uniforms:UniformsUtils.merge([UniformsLib.fog,{diffuse:{value:new Color},opacity:{value:1}}]),vertexShader:`
        attribute vec3 control0;
        attribute vec3 control1;
        attribute vec3 direction;
        varying float discardFlag;

        #include <common>
        #include <color_pars_vertex>
        #include <fog_pars_vertex>
        #include <logdepthbuf_pars_vertex>
        #include <clipping_planes_pars_vertex>

        void main() {
          #include <color_vertex>

          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
          gl_Position = projectionMatrix * mvPosition;

          // Transform the line segment ends and control points into camera clip space
          vec4 c0 = projectionMatrix * modelViewMatrix * vec4(control0, 1.0);
          vec4 c1 = projectionMatrix * modelViewMatrix * vec4(control1, 1.0);
          vec4 p0 = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          vec4 p1 = projectionMatrix * modelViewMatrix * vec4(position + direction, 1.0);

          c0.xy /= c0.w;
          c1.xy /= c1.w;
          p0.xy /= p0.w;
          p1.xy /= p1.w;

          // Get the direction of the segment and an orthogonal vector
          vec2 dir = p1.xy - p0.xy;
          vec2 norm = vec2(-dir.y, dir.x);

          // Get control point directions from the line
          vec2 c0dir = c0.xy - p1.xy;
          vec2 c1dir = c1.xy - p1.xy;

          // If the vectors to the controls points are pointed in different directions away
          // from the line segment then the line should not be drawn.
          float d0 = dot(normalize(norm), normalize(c0dir));
          float d1 = dot(normalize(norm), normalize(c1dir));
          discardFlag = float(sign(d0) != sign(d1));

          #include <logdepthbuf_vertex>
          #include <clipping_planes_vertex>
          #include <fog_vertex>
        }
      `,fragmentShader:`
        uniform vec3 diffuse;
        uniform float opacity;
        varying float discardFlag;

        #include <common>
        #include <color_pars_fragment>
        #include <fog_pars_fragment>
        #include <logdepthbuf_pars_fragment>
        #include <clipping_planes_pars_fragment>

        void main() {
          if (discardFlag > 0.5) discard;

          #include <clipping_planes_fragment>
          vec3 outgoingLight = vec3(0.0);
          vec4 diffuseColor = vec4(diffuse, opacity);
          #include <logdepthbuf_fragment>
          #include <color_fragment>
          outgoingLight = diffuseColor.rgb; // simple shader
          gl_FragColor = vec4(outgoingLight, diffuseColor.a);
          #include <tonemapping_fragment>
          #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
          #include <fog_fragment>
          #include <premultiplied_alpha_fragment>
        }
      `}),Object.defineProperties(this,{opacity:{get:function(){return this.uniforms.opacity.value},set:function(o){this.uniforms.opacity.value=o}},color:{get:function(){return this.uniforms.diffuse.value}}}),this.setValues(s),this.isLDrawConditionalLineMaterial=!0}}class ConditionalLineSegments extends LineSegments{constructor(s,o){super(s,o),this.isConditionalLine=!0}}function generateFaceNormals(a){for(let s=0,o=a.length;s<o;s++){const j=a[s],$=j.vertices,_e=$[0],tt=$[1],nt=$[2];_tempVec0.subVectors(tt,_e),_tempVec1.subVectors(nt,tt),j.faceNormal=new Vector3().crossVectors(_tempVec0,_tempVec1).normalize()}}const _ray$1=new Ray;function smoothNormals(a,s,o=!1){const j=100.00000001000001;function $(ot){const ct=~~(ot.x*j),ft=~~(ot.y*j),ht=~~(ot.z*j);return`${ct},${ft},${ht}`}function _e(ot,ct){return`${$(ot)}_${$(ct)}`}function tt(ot,ct,ft){ft.direction.subVectors(ct,ot).normalize();const ht=ot.dot(ft.direction);return ft.origin.copy(ot).addScaledVector(ft.direction,-ht),ft}function nt(ot){return _e(ot.origin,ot.direction)}const rt=new Set,it=new Map,st={},at=[];for(let ot=0,ct=s.length;ot<ct;ot++){const ht=s[ot].vertices,mt=ht[0],lt=ht[1];if(rt.add(_e(mt,lt)),rt.add(_e(lt,mt)),o){const ut=tt(mt,lt,new Ray),dt=nt(ut);if(!it.has(dt)){tt(lt,mt,ut);const Tt=nt(ut),Mt={ray:ut,distances:[]};it.set(dt,Mt),it.set(Tt,Mt)}const gt=it.get(dt);let Et=gt.ray.direction.dot(mt),St=gt.ray.direction.dot(lt);Et>St&&([Et,St]=[St,Et]),gt.distances.push(Et,St)}}for(let ot=0,ct=a.length;ot<ct;ot++){const ft=a[ot],ht=ft.vertices,mt=ht.length;for(let lt=0;lt<mt;lt++){const ut=lt,dt=(lt+1)%mt,gt=ht[ut],Et=ht[dt],St=_e(gt,Et);if(rt.has(St))continue;if(o){tt(gt,Et,_ray$1);const Mt=nt(_ray$1);if(it.has(Mt)){const Bt=it.get(Mt),{ray:Rt,distances:Ut}=Bt;let Ht=Rt.direction.dot(gt),Wt=Rt.direction.dot(Et);Ht>Wt&&([Ht,Wt]=[Wt,Ht]);let Jt=!1;for(let sn=0,jt=Ut.length;sn<jt;sn+=2)if(Ht>=Ut[sn]&&Wt<=Ut[sn+1]){Jt=!0;break}if(Jt)continue}}const Tt={index:ut,tri:ft};st[St]=Tt}}for(;;){let ot=null;for(const ft in st){ot=st[ft];break}if(ot===null)break;const ct=[ot];for(;ct.length>0;){const ft=ct.pop().tri,ht=ft.vertices,mt=ft.normals,lt=ft.faceNormal,ut=ht.length;for(let dt=0;dt<ut;dt++){const gt=dt,Et=(dt+1)%ut,St=ht[gt],Tt=ht[Et],Mt=_e(St,Tt);delete st[Mt];const Bt=_e(Tt,St),Rt=st[Bt];if(Rt){const Ut=Rt.tri,Ht=Rt.index,Wt=Ut.normals,Jt=Wt.length,sn=Ut.faceNormal;if(Math.abs(Ut.faceNormal.dot(ft.faceNormal))<.25)continue;Bt in st&&(ct.push(Rt),delete st[Bt]);const jt=(Ht+1)%Jt;mt[gt]&&Wt[jt]&&mt[gt]!==Wt[jt]&&(Wt[jt].norm.add(mt[gt].norm),mt[gt].norm=Wt[jt].norm);let Vt=mt[gt]||Wt[jt];Vt===null&&(Vt={norm:new Vector3},at.push(Vt.norm)),mt[gt]===null&&(mt[gt]=Vt,Vt.norm.add(lt)),Wt[jt]===null&&(Wt[jt]=Vt,Vt.norm.add(sn)),mt[Et]&&Wt[Ht]&&mt[Et]!==Wt[Ht]&&(Wt[Ht].norm.add(mt[Et].norm),mt[Et].norm=Wt[Ht].norm);let Lt=mt[Et]||Wt[Ht];Lt===null&&(Lt={norm:new Vector3},at.push(Lt.norm)),mt[Et]===null&&(mt[Et]=Lt,Lt.norm.add(lt)),Wt[Ht]===null&&(Wt[Ht]=Lt,Lt.norm.add(sn))}}}}for(let ot=0,ct=at.length;ot<ct;ot++)at[ot].normalize()}function isPartType(a){return a==="Part"||a==="Unofficial_Part"}function isPrimitiveType(a){return/primitive/i.test(a)||a==="Subpart"}class LineParser{constructor(s,o){this.line=s,this.lineLength=s.length,this.currentCharIndex=0,this.currentChar=" ",this.lineNumber=o}seekNonSpace(){for(;this.currentCharIndex<this.lineLength;){if(this.currentChar=this.line.charAt(this.currentCharIndex),this.currentChar!==" "&&this.currentChar!=="	")return;this.currentCharIndex++}}getToken(){const s=this.currentCharIndex++;for(;this.currentCharIndex<this.lineLength&&(this.currentChar=this.line.charAt(this.currentCharIndex),!(this.currentChar===" "||this.currentChar==="	"));)this.currentCharIndex++;const o=this.currentCharIndex;return this.seekNonSpace(),this.line.substring(s,o)}getVector(){return new Vector3(parseFloat(this.getToken()),parseFloat(this.getToken()),parseFloat(this.getToken()))}getRemainingString(){return this.line.substring(this.currentCharIndex,this.lineLength)}isAtTheEnd(){return this.currentCharIndex>=this.lineLength}setToEnd(){this.currentCharIndex=this.lineLength}getLineNumberString(){return this.lineNumber>=0?" at line "+this.lineNumber:""}}class LDrawParsedCache{constructor(s){this.loader=s,this._cache={}}cloneResult(s){const o={};return o.faces=s.faces.map(j=>({colorCode:j.colorCode,material:j.material,vertices:j.vertices.map($=>$.clone()),normals:j.normals.map(()=>null),faceNormal:null})),o.conditionalSegments=s.conditionalSegments.map(j=>({colorCode:j.colorCode,material:j.material,vertices:j.vertices.map($=>$.clone()),controlPoints:j.controlPoints.map($=>$.clone())})),o.lineSegments=s.lineSegments.map(j=>({colorCode:j.colorCode,material:j.material,vertices:j.vertices.map($=>$.clone())})),o.type=s.type,o.category=s.category,o.keywords=s.keywords,o.subobjects=s.subobjects,o.totalFaces=s.totalFaces,o.startingConstructionStep=s.startingConstructionStep,o.materials=s.materials,o.group=null,o}async fetchData(s){let o=!1,j=FILE_LOCATION_AS_IS;for(;j!==FILE_LOCATION_NOT_FOUND;){let $=s;switch(j){case FILE_LOCATION_AS_IS:j=j+1;break;case FILE_LOCATION_TRY_PARTS:$="parts/"+$,j=j+1;break;case FILE_LOCATION_TRY_P:$="p/"+$,j=j+1;break;case FILE_LOCATION_TRY_MODELS:$="models/"+$,j=j+1;break;case FILE_LOCATION_TRY_RELATIVE:$=s.substring(0,s.lastIndexOf("/")+1)+$,j=j+1;break;case FILE_LOCATION_TRY_ABSOLUTE:o?j=FILE_LOCATION_NOT_FOUND:(s=s.toLowerCase(),$=s,o=!0,j=FILE_LOCATION_AS_IS);break}const _e=this.loader,tt=new FileLoader(_e.manager);tt.setPath(_e.partsLibraryPath),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials);try{return await tt.loadAsync($)}catch{continue}}throw new Error('LDrawLoader: Subobject "'+s+'" could not be loaded.')}parse(s,o=null){const j=this.loader,$=[],_e=[],tt=[],nt=[],rt={},it=Mt=>rt[Mt]||null;let st="Model",at=null,ot=null,ct=0;s.indexOf(`\r
`)!==-1&&(s=s.replace(/\r\n/g,`
`));const ft=s.split(`
`),ht=ft.length;let mt=!1,lt=null,ut=null,dt=!1,gt=!0,Et=!1,St=!0,Tt=!1;for(let Mt=0;Mt<ht;Mt++){const Bt=ft[Mt];if(Bt.length===0)continue;if(mt){Bt.startsWith("0 FILE ")?(this.setData(lt,ut),lt=Bt.substring(7),ut=""):ut+=Bt+`
`;continue}const Rt=new LineParser(Bt,Mt+1);if(Rt.seekNonSpace(),Rt.isAtTheEnd())continue;const Ut=Rt.getToken();let Ht,Wt,Jt,sn,jt,Vt,Lt,Qt,nn,mn,Zt;switch(Ut){case"0":const cn=Rt.getToken();if(cn)switch(cn){case"!LDRAW_ORG":st=Rt.getToken();break;case"!COLOUR":Ht=j.parseColorMetaDirective(Rt),Ht?rt[Ht.userData.code]=Ht:console.warn("LDrawLoader: Error parsing material"+Rt.getLineNumberString());break;case"!CATEGORY":at=Rt.getToken();break;case"!KEYWORDS":const Qn=Rt.getRemainingString().split(",");Qn.length>0&&(ot||(ot=[]),Qn.forEach(function(nr){ot.push(nr.trim())}));break;case"FILE":Mt>0&&(mt=!0,lt=Rt.getRemainingString(),ut="",dt=!1,gt=!0);break;case"BFC":for(;!Rt.isAtTheEnd();){const nr=Rt.getToken();switch(nr){case"CERTIFY":case"NOCERTIFY":dt=nr==="CERTIFY",gt=!0;break;case"CW":case"CCW":gt=nr==="CCW";break;case"INVERTNEXT":Et=!0;break;case"CLIP":case"NOCLIP":St=nr==="CLIP";break;default:console.warn('THREE.LDrawLoader: BFC directive "'+nr+'" is unknown.');break}}break;case"STEP":Tt=!0;break}break;case"1":Wt=Rt.getToken(),Ht=it(Wt);const Ot=parseFloat(Rt.getToken()),rn=parseFloat(Rt.getToken()),fn=parseFloat(Rt.getToken()),hn=parseFloat(Rt.getToken()),Tn=parseFloat(Rt.getToken()),Nn=parseFloat(Rt.getToken()),Pn=parseFloat(Rt.getToken()),Dn=parseFloat(Rt.getToken()),ln=parseFloat(Rt.getToken()),Cn=parseFloat(Rt.getToken()),bn=parseFloat(Rt.getToken()),kn=parseFloat(Rt.getToken()),Sn=new Matrix4().set(hn,Tn,Nn,Ot,Pn,Dn,ln,rn,Cn,bn,kn,fn,0,0,0,1);let xn=Rt.getRemainingString().trim().replace(/\\/g,"/");j.fileMap[xn]?xn=j.fileMap[xn]:xn.startsWith("s/")?xn="parts/"+xn:xn.startsWith("48/")&&(xn="p/"+xn),nt.push({material:Ht,colorCode:Wt,matrix:Sn,fileName:xn,inverted:Et,startingConstructionStep:Tt}),Et=!1;break;case"2":Wt=Rt.getToken(),Ht=it(Wt),Vt=Rt.getVector(),Lt=Rt.getVector(),Jt={material:Ht,colorCode:Wt,vertices:[Vt,Lt]},_e.push(Jt);break;case"5":Wt=Rt.getToken(),Ht=it(Wt),Vt=Rt.getVector(),Lt=Rt.getVector(),mn=Rt.getVector(),Zt=Rt.getVector(),Jt={material:Ht,colorCode:Wt,vertices:[Vt,Lt],controlPoints:[mn,Zt]},tt.push(Jt);break;case"3":Wt=Rt.getToken(),Ht=it(Wt),sn=gt,jt=!dt||!St,sn===!0?(Vt=Rt.getVector(),Lt=Rt.getVector(),Qt=Rt.getVector()):(Qt=Rt.getVector(),Lt=Rt.getVector(),Vt=Rt.getVector()),$.push({material:Ht,colorCode:Wt,faceNormal:null,vertices:[Vt,Lt,Qt],normals:[null,null,null]}),ct++,jt===!0&&($.push({material:Ht,colorCode:Wt,faceNormal:null,vertices:[Qt,Lt,Vt],normals:[null,null,null]}),ct++);break;case"4":Wt=Rt.getToken(),Ht=it(Wt),sn=gt,jt=!dt||!St,sn===!0?(Vt=Rt.getVector(),Lt=Rt.getVector(),Qt=Rt.getVector(),nn=Rt.getVector()):(nn=Rt.getVector(),Qt=Rt.getVector(),Lt=Rt.getVector(),Vt=Rt.getVector()),$.push({material:Ht,colorCode:Wt,faceNormal:null,vertices:[Vt,Lt,Qt,nn],normals:[null,null,null,null]}),ct+=2,jt===!0&&($.push({material:Ht,colorCode:Wt,faceNormal:null,vertices:[nn,Qt,Lt,Vt],normals:[null,null,null,null]}),ct+=2);break;default:throw new Error('LDrawLoader: Unknown line type "'+Ut+'"'+Rt.getLineNumberString()+".")}}return mt&&this.setData(lt,ut),{faces:$,conditionalSegments:tt,lineSegments:_e,type:st,category:at,keywords:ot,subobjects:nt,totalFaces:ct,startingConstructionStep:Tt,materials:rt,fileName:o,group:null}}getData(s,o=!0){const j=s.toLowerCase(),$=this._cache[j];return $===null||$ instanceof Promise?null:o?this.cloneResult($):$}async ensureDataLoaded(s){const o=s.toLowerCase();o in this._cache||(this._cache[o]=this.fetchData(s).then(j=>{const $=this.parse(j,s);return this._cache[o]=$,$})),await this._cache[o]}setData(s,o){const j=s.toLowerCase();this._cache[j]=this.parse(o,s)}}function getMaterialFromCode(a,s,o,j){return(!j&&a===MAIN_COLOUR_CODE||j&&a===MAIN_EDGE_COLOUR_CODE)&&(a=s),o[a]||null}class LDrawPartsGeometryCache{constructor(s){this.loader=s,this.parseCache=new LDrawParsedCache(s),this._cache={}}async processIntoMesh(s){const o=this.loader,j=this.parseCache,$=new Set,_e=async(nt,rt=null)=>{const it=nt.subobjects,st=[];for(let ct=0,ft=it.length;ct<ft;ct++){const ht=it[ct],mt=j.ensureDataLoaded(ht.fileName).then(()=>{const lt=j.getData(ht.fileName,!1);return isPrimitiveType(lt.type)?_e(j.getData(ht.fileName),ht):this.loadModel(ht.fileName).catch(ut=>(console.warn(ut),null))});st.push(mt)}const at=new Group;at.userData.category=nt.category,at.userData.keywords=nt.keywords,nt.group=at;const ot=await Promise.all(st);for(let ct=0,ft=ot.length;ct<ft;ct++){const ht=nt.subobjects[ct],mt=ot[ct];if(mt===null)continue;if(mt.isGroup){const Ht=mt;ht.matrix.decompose(Ht.position,Ht.quaternion,Ht.scale),Ht.userData.startingConstructionStep=ht.startingConstructionStep,Ht.name=ht.fileName,o.applyMaterialsToMesh(Ht,ht.colorCode,nt.materials),at.add(Ht);continue}mt.group.children.length&&at.add(mt.group);const lt=nt.lineSegments,ut=nt.conditionalSegments,dt=nt.faces,gt=mt.lineSegments,Et=mt.conditionalSegments,St=mt.faces,Tt=ht.matrix,Mt=ht.inverted,Bt=Tt.determinant()<0,Rt=ht.colorCode,Ut=Rt===MAIN_COLOUR_CODE?MAIN_EDGE_COLOUR_CODE:Rt;for(let Ht=0,Wt=gt.length;Ht<Wt;Ht++){const Jt=gt[Ht],sn=Jt.vertices;sn[0].applyMatrix4(Tt),sn[1].applyMatrix4(Tt),Jt.colorCode=Jt.colorCode===MAIN_EDGE_COLOUR_CODE?Ut:Jt.colorCode,Jt.material=Jt.material||getMaterialFromCode(Jt.colorCode,Jt.colorCode,nt.materials,!0),lt.push(Jt)}for(let Ht=0,Wt=Et.length;Ht<Wt;Ht++){const Jt=Et[Ht],sn=Jt.vertices,jt=Jt.controlPoints;sn[0].applyMatrix4(Tt),sn[1].applyMatrix4(Tt),jt[0].applyMatrix4(Tt),jt[1].applyMatrix4(Tt),Jt.colorCode=Jt.colorCode===MAIN_EDGE_COLOUR_CODE?Ut:Jt.colorCode,Jt.material=Jt.material||getMaterialFromCode(Jt.colorCode,Jt.colorCode,nt.materials,!0),ut.push(Jt)}for(let Ht=0,Wt=St.length;Ht<Wt;Ht++){const Jt=St[Ht],sn=Jt.vertices;for(let jt=0,Vt=sn.length;jt<Vt;jt++)sn[jt].applyMatrix4(Tt);Jt.colorCode=Jt.colorCode===MAIN_COLOUR_CODE?Rt:Jt.colorCode,Jt.material=Jt.material||getMaterialFromCode(Jt.colorCode,Rt,nt.materials,!1),$.add(Jt.colorCode),Bt!==Mt&&sn.reverse(),dt.push(Jt)}nt.totalFaces+=mt.totalFaces}return rt&&o.applyMaterialsToMesh(at,rt.colorCode,nt.materials),nt};for(let nt=0,rt=s.faces;nt<rt;nt++)$.add(s.faces[nt].colorCode);if(await _e(s),o.smoothNormals){const nt=$.size>1;generateFaceNormals(s.faces),smoothNormals(s.faces,s.lineSegments,nt)}const tt=s.group;return s.faces.length>0&&tt.add(createObject(s.faces,3,!1,s.totalFaces)),s.lineSegments.length>0&&tt.add(createObject(s.lineSegments,2)),s.conditionalSegments.length>0&&tt.add(createObject(s.conditionalSegments,2,!0)),tt}hasCachedModel(s){return s!==null&&s.toLowerCase()in this._cache}async getCachedModel(s){if(s!==null&&this.hasCachedModel(s)){const o=s.toLowerCase();return(await this._cache[o]).clone()}else return null}async loadModel(s){const o=this.parseCache,j=s.toLowerCase();if(this.hasCachedModel(s))return this.getCachedModel(s);{await o.ensureDataLoaded(s);const $=o.getData(s),_e=this.processIntoMesh($);return this.hasCachedModel(s)?this.getCachedModel(s):(isPartType($.type)&&(this._cache[j]=_e),(await _e).clone())}}async parseModel(s){const j=this.parseCache.parse(s);return isPartType(j.type)&&this.hasCachedModel(j.fileName)?this.getCachedModel(j.fileName):this.processIntoMesh(j)}}function sortByMaterial(a,s){return a.colorCode===s.colorCode?0:a.colorCode<s.colorCode?-1:1}function createObject(a,s,o=!1,j=null){a.sort(sortByMaterial),j===null&&(j=a.length);const $=new Float32Array(s*j*3),_e=s===3?new Float32Array(s*j*3):null,tt=[],nt=new Array(6),rt=new BufferGeometry;let it=null,st=0,at=0,ot=0;for(let ft=0,ht=a.length;ft<ht;ft++){const mt=a[ft];let lt=mt.vertices;lt.length===4&&(nt[0]=lt[0],nt[1]=lt[1],nt[2]=lt[2],nt[3]=lt[0],nt[4]=lt[2],nt[5]=lt[3],lt=nt);for(let ut=0,dt=lt.length;ut<dt;ut++){const gt=lt[ut],Et=ot+ut*3;$[Et+0]=gt.x,$[Et+1]=gt.y,$[Et+2]=gt.z}if(s===3){if(!mt.faceNormal){const dt=lt[0],gt=lt[1],Et=lt[2];_tempVec0.subVectors(gt,dt),_tempVec1.subVectors(Et,gt),mt.faceNormal=new Vector3().crossVectors(_tempVec0,_tempVec1).normalize()}let ut=mt.normals;ut.length===4&&(nt[0]=ut[0],nt[1]=ut[1],nt[2]=ut[2],nt[3]=ut[0],nt[4]=ut[2],nt[5]=ut[3],ut=nt);for(let dt=0,gt=ut.length;dt<gt;dt++){let Et=mt.faceNormal;ut[dt]&&(Et=ut[dt].norm);const St=ot+dt*3;_e[St+0]=Et.x,_e[St+1]=Et.y,_e[St+2]=Et.z}}if(it!==mt.colorCode){it!==null&&rt.addGroup(st,at,tt.length-1);const ut=mt.material;ut!==null?s===3?tt.push(ut):s===2&&(ut!==null?o?tt.push(ut.userData.edgeMaterial.userData.conditionalEdgeMaterial):tt.push(ut.userData.edgeMaterial):tt.push(null)):tt.push(mt.colorCode),it=mt.colorCode,st=ot/3,at=lt.length}else at+=lt.length;ot+=3*lt.length}at>0&&rt.addGroup(st,1/0,tt.length-1),rt.setAttribute("position",new BufferAttribute($,3)),_e!==null&&rt.setAttribute("normal",new BufferAttribute(_e,3));let ct=null;if(s===2?o?ct=new ConditionalLineSegments(rt,tt.length===1?tt[0]:tt):ct=new LineSegments(rt,tt.length===1?tt[0]:tt):s===3&&(ct=new Mesh(rt,tt.length===1?tt[0]:tt)),o){ct.isConditionalLine=!0;const ft=new Float32Array(a.length*3*2),ht=new Float32Array(a.length*3*2),mt=new Float32Array(a.length*3*2);for(let lt=0,ut=a.length;lt<ut;lt++){const dt=a[lt],gt=dt.vertices,Et=dt.controlPoints,St=Et[0],Tt=Et[1],Mt=gt[0],Bt=gt[1],Rt=lt*3*2;ft[Rt+0]=St.x,ft[Rt+1]=St.y,ft[Rt+2]=St.z,ft[Rt+3]=St.x,ft[Rt+4]=St.y,ft[Rt+5]=St.z,ht[Rt+0]=Tt.x,ht[Rt+1]=Tt.y,ht[Rt+2]=Tt.z,ht[Rt+3]=Tt.x,ht[Rt+4]=Tt.y,ht[Rt+5]=Tt.z,mt[Rt+0]=Bt.x-Mt.x,mt[Rt+1]=Bt.y-Mt.y,mt[Rt+2]=Bt.z-Mt.z,mt[Rt+3]=Bt.x-Mt.x,mt[Rt+4]=Bt.y-Mt.y,mt[Rt+5]=Bt.z-Mt.z}rt.setAttribute("control0",new BufferAttribute(ft,3,!1)),rt.setAttribute("control1",new BufferAttribute(ht,3,!1)),rt.setAttribute("direction",new BufferAttribute(mt,3,!1))}return ct}class LDrawLoader extends Loader{constructor(s){super(s),this.materials=[],this.materialLibrary={},this.partsCache=new LDrawPartsGeometryCache(this),this.fileMap={},this.setMaterials([]),this.smoothNormals=!0,this.partsLibraryPath=""}setPartsLibraryPath(s){return this.partsLibraryPath=s,this}async preloadMaterials(s){const o=new FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const j=await o.loadAsync(s),$=/^0 !COLOUR/,_e=j.split(/[\n\r]/g),tt=[];for(let nt=0,rt=_e.length;nt<rt;nt++){const it=_e[nt];if($.test(it)){const st=it.replace($,""),at=this.parseColorMetaDirective(new LineParser(st));tt.push(at)}}this.setMaterials(tt)}load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials),_e.load(s,tt=>{this.partsCache.parseModel(tt,this.materialLibrary).then(nt=>{this.applyMaterialsToMesh(nt,MAIN_COLOUR_CODE,this.materialLibrary,!0),this.computeConstructionSteps(nt),o(nt)}).catch($)},j,$)}parse(s,o){this.partsCache.parseModel(s,this.materialLibrary).then(j=>{this.computeConstructionSteps(j),o(j)})}setMaterials(s){this.materialLibrary={},this.materials=[];for(let o=0,j=s.length;o<j;o++)this.addMaterial(s[o]);return this.addMaterial(this.parseColorMetaDirective(new LineParser("Main_Colour CODE 16 VALUE #FF8080 EDGE #333333"))),this.addMaterial(this.parseColorMetaDirective(new LineParser("Edge_Colour CODE 24 VALUE #A0A0A0 EDGE #333333"))),this}setFileMap(s){return this.fileMap=s,this}addMaterial(s){const o=this.materialLibrary;return o[s.userData.code]||(this.materials.push(s),o[s.userData.code]=s),this}getMaterial(s){if(s.startsWith("0x2")){const o=s.substring(3);return this.parseColorMetaDirective(new LineParser("Direct_Color_"+o+" CODE -1 VALUE #"+o+" EDGE #"+o))}return this.materialLibrary[s]||null}applyMaterialsToMesh(s,o,j,$=!1){const _e=this,tt=o===MAIN_COLOUR_CODE;s.traverse(rt=>{if(rt.isMesh||rt.isLineSegments)if(Array.isArray(rt.material))for(let it=0,st=rt.material.length;it<st;it++)rt.material[it].isMaterial||(rt.material[it]=nt(rt,rt.material[it]));else rt.material.isMaterial||(rt.material=nt(rt,rt.material))});function nt(rt,it){if(tt&&!(it in j)&&!$)return it;const st=rt.isLineSegments||rt.isConditionalLine;(!st&&it===MAIN_COLOUR_CODE||st&&it===MAIN_EDGE_COLOUR_CODE)&&(it=o);let ot=null;if(it in j)ot=j[it];else if($){if(ot=_e.getMaterial(it),ot===null)throw new Error(`LDrawLoader: Material properties for code ${it} not available.`)}else return it;return rt.isLineSegments&&(ot=ot.userData.edgeMaterial,rt.isConditionalLine&&(ot=ot.userData.conditionalEdgeMaterial)),ot}}getMainMaterial(){return this.getMaterial(MAIN_COLOUR_CODE)}getMainEdgeMaterial(){return this.getMaterial(MAIN_EDGE_COLOUR_CODE)}parseColorMetaDirective(s){let o=null,j=16711935,$=16711935,_e=1,tt=!1,nt=0,rt=FINISH_TYPE_DEFAULT,it=null;const st=s.getToken();if(!st)throw new Error('LDrawLoader: Material name was expected after "!COLOUR tag'+s.getLineNumberString()+".");let at=null;for(;at=s.getToken(),!!at;)switch(at.toUpperCase()){case"CODE":o=s.getToken();break;case"VALUE":if(j=s.getToken(),j.startsWith("0x"))j="#"+j.substring(2);else if(!j.startsWith("#"))throw new Error("LDrawLoader: Invalid color while parsing material"+s.getLineNumberString()+".");break;case"EDGE":if($=s.getToken(),$.startsWith("0x"))$="#"+$.substring(2);else if(!$.startsWith("#")){if(it=this.getMaterial($),!it)throw new Error("LDrawLoader: Invalid edge color while parsing material"+s.getLineNumberString()+".");it=it.userData.edgeMaterial}break;case"ALPHA":if(_e=parseInt(s.getToken()),isNaN(_e))throw new Error("LDrawLoader: Invalid alpha value in material definition"+s.getLineNumberString()+".");_e=Math.max(0,Math.min(1,_e/255)),_e<1&&(tt=!0);break;case"LUMINANCE":if(nt=parseInt(s.getToken()),isNaN(nt))throw new Error("LDrawLoader: Invalid luminance value in material definition"+LineParser.getLineNumberString()+".");nt=Math.max(0,Math.min(1,nt/255));break;case"CHROME":rt=FINISH_TYPE_CHROME;break;case"PEARLESCENT":rt=FINISH_TYPE_PEARLESCENT;break;case"RUBBER":rt=FINISH_TYPE_RUBBER;break;case"MATTE_METALLIC":rt=FINISH_TYPE_MATTE_METALLIC;break;case"METAL":rt=FINISH_TYPE_METAL;break;case"MATERIAL":s.setToEnd();break;default:throw new Error('LDrawLoader: Unknown token "'+at+'" while parsing material'+s.getLineNumberString()+".")}let ot=null;switch(rt){case FINISH_TYPE_DEFAULT:ot=new MeshStandardMaterial({color:j,roughness:.3,metalness:0});break;case FINISH_TYPE_PEARLESCENT:ot=new MeshStandardMaterial({color:j,roughness:.3,metalness:.25});break;case FINISH_TYPE_CHROME:ot=new MeshStandardMaterial({color:j,roughness:0,metalness:1});break;case FINISH_TYPE_RUBBER:ot=new MeshStandardMaterial({color:j,roughness:.9,metalness:0});break;case FINISH_TYPE_MATTE_METALLIC:ot=new MeshStandardMaterial({color:j,roughness:.8,metalness:.4});break;case FINISH_TYPE_METAL:ot=new MeshStandardMaterial({color:j,roughness:.2,metalness:.85});break}return ot.transparent=tt,ot.premultipliedAlpha=!0,ot.opacity=_e,ot.depthWrite=!tt,ot.polygonOffset=!0,ot.polygonOffsetFactor=1,nt!==0&&ot.emissive.set(ot.color).multiplyScalar(nt),it||(it=new LineBasicMaterial({color:$,transparent:tt,opacity:_e,depthWrite:!tt}),it.userData.code=o,it.name=st+" - Edge",it.userData.conditionalEdgeMaterial=new LDrawConditionalLineMaterial({fog:!0,transparent:tt,depthWrite:!tt,color:$,opacity:_e})),ot.userData.code=o,ot.name=st,ot.userData.edgeMaterial=it,this.addMaterial(ot),ot}computeConstructionSteps(s){let o=0;s.traverse(j=>{j.isGroup&&(j.userData.startingConstructionStep&&o++,j.userData.constructionStep=o)}),s.userData.numConstructionSteps=o+1}}class SVGLoader extends Loader{constructor(s){super(s),this.defaultDPI=90,this.defaultUnit="px"}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=this;function j(Zt,cn){if(Zt.nodeType!==1)return;const Ot=gt(Zt);let rn=!0,fn=null;switch(Zt.nodeName){case"svg":break;case"style":_e(Zt);break;case"g":cn=ft(Zt,cn);break;case"path":cn=ft(Zt,cn),Zt.hasAttribute("d")&&(fn=$(Zt));break;case"rect":cn=ft(Zt,cn),fn=rt(Zt);break;case"polygon":cn=ft(Zt,cn),fn=it(Zt);break;case"polyline":cn=ft(Zt,cn),fn=st(Zt);break;case"circle":cn=ft(Zt,cn),fn=at(Zt);break;case"ellipse":cn=ft(Zt,cn),fn=ot(Zt);break;case"line":cn=ft(Zt,cn),fn=ct(Zt);break;case"defs":rn=!1;break;case"mask":rn=!1;break;case"use":cn=ft(Zt,cn);const hn=Zt.href.baseVal.substring(1),Tn=Zt.viewportElement.getElementById(hn);Tn?j(Tn,cn):console.warn("SVGLoader: 'use node' references non-existent node id: "+hn);break}if(fn&&(cn.fill!==void 0&&cn.fill!=="none"&&fn.color.setStyle(cn.fill),St(fn,Qt),Rt.push(fn),fn.userData={node:Zt,style:cn}),rn){const hn=Zt.childNodes;for(let Tn=0;Tn<hn.length;Tn++)j(hn[Tn],cn)}Ot&&(Ht.pop(),Ht.length>0?Qt.copy(Ht[Ht.length-1]):Qt.identity())}function $(Zt){const cn=new ShapePath,Ot=new Vector2,rn=new Vector2,fn=new Vector2;let hn=!0,Tn=!1;const Pn=Zt.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi);for(let Dn=0,ln=Pn.length;Dn<ln;Dn++){const Cn=Pn[Dn],bn=Cn.charAt(0),kn=Cn.substr(1).trim();hn===!0&&(Tn=!0,hn=!1);let Sn;switch(bn){case"M":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2)Ot.x=Sn[xn+0],Ot.y=Sn[xn+1],rn.x=Ot.x,rn.y=Ot.y,xn===0?cn.moveTo(Ot.x,Ot.y):cn.lineTo(Ot.x,Ot.y),xn===0&&fn.copy(Ot);break;case"H":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn++)Ot.x=Sn[xn],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"V":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn++)Ot.y=Sn[xn],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"L":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2)Ot.x=Sn[xn+0],Ot.y=Sn[xn+1],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"C":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=6)cn.bezierCurveTo(Sn[xn+0],Sn[xn+1],Sn[xn+2],Sn[xn+3],Sn[xn+4],Sn[xn+5]),rn.x=Sn[xn+2],rn.y=Sn[xn+3],Ot.x=Sn[xn+4],Ot.y=Sn[xn+5],xn===0&&Tn===!0&&fn.copy(Ot);break;case"S":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=4)cn.bezierCurveTo(ht(Ot.x,rn.x),ht(Ot.y,rn.y),Sn[xn+0],Sn[xn+1],Sn[xn+2],Sn[xn+3]),rn.x=Sn[xn+0],rn.y=Sn[xn+1],Ot.x=Sn[xn+2],Ot.y=Sn[xn+3],xn===0&&Tn===!0&&fn.copy(Ot);break;case"Q":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=4)cn.quadraticCurveTo(Sn[xn+0],Sn[xn+1],Sn[xn+2],Sn[xn+3]),rn.x=Sn[xn+0],rn.y=Sn[xn+1],Ot.x=Sn[xn+2],Ot.y=Sn[xn+3],xn===0&&Tn===!0&&fn.copy(Ot);break;case"T":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2){const nr=ht(Ot.x,rn.x),or=ht(Ot.y,rn.y);cn.quadraticCurveTo(nr,or,Sn[xn+0],Sn[xn+1]),rn.x=nr,rn.y=or,Ot.x=Sn[xn+0],Ot.y=Sn[xn+1],xn===0&&Tn===!0&&fn.copy(Ot)}break;case"A":Sn=mt(kn,[3,4],7);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=7){if(Sn[xn+5]==Ot.x&&Sn[xn+6]==Ot.y)continue;const nr=Ot.clone();Ot.x=Sn[xn+5],Ot.y=Sn[xn+6],rn.x=Ot.x,rn.y=Ot.y,tt(cn,Sn[xn],Sn[xn+1],Sn[xn+2],Sn[xn+3],Sn[xn+4],nr,Ot),xn===0&&Tn===!0&&fn.copy(Ot)}break;case"m":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2)Ot.x+=Sn[xn+0],Ot.y+=Sn[xn+1],rn.x=Ot.x,rn.y=Ot.y,xn===0?cn.moveTo(Ot.x,Ot.y):cn.lineTo(Ot.x,Ot.y),xn===0&&fn.copy(Ot);break;case"h":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn++)Ot.x+=Sn[xn],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"v":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn++)Ot.y+=Sn[xn],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"l":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2)Ot.x+=Sn[xn+0],Ot.y+=Sn[xn+1],rn.x=Ot.x,rn.y=Ot.y,cn.lineTo(Ot.x,Ot.y),xn===0&&Tn===!0&&fn.copy(Ot);break;case"c":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=6)cn.bezierCurveTo(Ot.x+Sn[xn+0],Ot.y+Sn[xn+1],Ot.x+Sn[xn+2],Ot.y+Sn[xn+3],Ot.x+Sn[xn+4],Ot.y+Sn[xn+5]),rn.x=Ot.x+Sn[xn+2],rn.y=Ot.y+Sn[xn+3],Ot.x+=Sn[xn+4],Ot.y+=Sn[xn+5],xn===0&&Tn===!0&&fn.copy(Ot);break;case"s":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=4)cn.bezierCurveTo(ht(Ot.x,rn.x),ht(Ot.y,rn.y),Ot.x+Sn[xn+0],Ot.y+Sn[xn+1],Ot.x+Sn[xn+2],Ot.y+Sn[xn+3]),rn.x=Ot.x+Sn[xn+0],rn.y=Ot.y+Sn[xn+1],Ot.x+=Sn[xn+2],Ot.y+=Sn[xn+3],xn===0&&Tn===!0&&fn.copy(Ot);break;case"q":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=4)cn.quadraticCurveTo(Ot.x+Sn[xn+0],Ot.y+Sn[xn+1],Ot.x+Sn[xn+2],Ot.y+Sn[xn+3]),rn.x=Ot.x+Sn[xn+0],rn.y=Ot.y+Sn[xn+1],Ot.x+=Sn[xn+2],Ot.y+=Sn[xn+3],xn===0&&Tn===!0&&fn.copy(Ot);break;case"t":Sn=mt(kn);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=2){const nr=ht(Ot.x,rn.x),or=ht(Ot.y,rn.y);cn.quadraticCurveTo(nr,or,Ot.x+Sn[xn+0],Ot.y+Sn[xn+1]),rn.x=nr,rn.y=or,Ot.x=Ot.x+Sn[xn+0],Ot.y=Ot.y+Sn[xn+1],xn===0&&Tn===!0&&fn.copy(Ot)}break;case"a":Sn=mt(kn,[3,4],7);for(let xn=0,Qn=Sn.length;xn<Qn;xn+=7){if(Sn[xn+5]==0&&Sn[xn+6]==0)continue;const nr=Ot.clone();Ot.x+=Sn[xn+5],Ot.y+=Sn[xn+6],rn.x=Ot.x,rn.y=Ot.y,tt(cn,Sn[xn],Sn[xn+1],Sn[xn+2],Sn[xn+3],Sn[xn+4],nr,Ot),xn===0&&Tn===!0&&fn.copy(Ot)}break;case"Z":case"z":cn.currentPath.autoClose=!0,cn.currentPath.curves.length>0&&(Ot.copy(fn),cn.currentPath.currentPoint.copy(Ot),hn=!0);break;default:console.warn(Cn)}Tn=!1}return cn}function _e(Zt){if(!(!Zt.sheet||!Zt.sheet.cssRules||!Zt.sheet.cssRules.length))for(let cn=0;cn<Zt.sheet.cssRules.length;cn++){const Ot=Zt.sheet.cssRules[cn];if(Ot.type!==1)continue;const rn=Ot.selectorText.split(/,/gm).filter(Boolean).map(fn=>fn.trim());for(let fn=0;fn<rn.length;fn++)Ut[rn[fn]]=Object.assign(Ut[rn[fn]]||{},Ot.style)}}function tt(Zt,cn,Ot,rn,fn,hn,Tn,Nn){if(cn==0||Ot==0){Zt.lineTo(Nn.x,Nn.y);return}rn=rn*Math.PI/180,cn=Math.abs(cn),Ot=Math.abs(Ot);const Pn=(Tn.x-Nn.x)/2,Dn=(Tn.y-Nn.y)/2,ln=Math.cos(rn)*Pn+Math.sin(rn)*Dn,Cn=-Math.sin(rn)*Pn+Math.cos(rn)*Dn;let bn=cn*cn,kn=Ot*Ot;const Sn=ln*ln,xn=Cn*Cn,Qn=Sn/bn+xn/kn;if(Qn>1){const Hn=Math.sqrt(Qn);cn=Hn*cn,Ot=Hn*Ot,bn=cn*cn,kn=Ot*Ot}const nr=bn*xn+kn*Sn,or=(bn*kn-nr)/nr;let mr=Math.sqrt(Math.max(0,or));fn===hn&&(mr=-mr);const $n=mr*cn*Cn/Ot,tn=-mr*Ot*ln/cn,$t=Math.cos(rn)*$n-Math.sin(rn)*tn+(Tn.x+Nn.x)/2,An=Math.sin(rn)*$n+Math.cos(rn)*tn+(Tn.y+Nn.y)/2,En=nt(1,0,(ln-$n)/cn,(Cn-tn)/Ot),In=nt((ln-$n)/cn,(Cn-tn)/Ot,(-ln-$n)/cn,(-Cn-tn)/Ot)%(Math.PI*2);Zt.currentPath.absellipse($t,An,cn,Ot,En,En+In,hn===0,rn)}function nt(Zt,cn,Ot,rn){const fn=Zt*Ot+cn*rn,hn=Math.sqrt(Zt*Zt+cn*cn)*Math.sqrt(Ot*Ot+rn*rn);let Tn=Math.acos(Math.max(-1,Math.min(1,fn/hn)));return Zt*rn-cn*Ot<0&&(Tn=-Tn),Tn}function rt(Zt){const cn=dt(Zt.getAttribute("x")||0),Ot=dt(Zt.getAttribute("y")||0),rn=dt(Zt.getAttribute("rx")||Zt.getAttribute("ry")||0),fn=dt(Zt.getAttribute("ry")||Zt.getAttribute("rx")||0),hn=dt(Zt.getAttribute("width")),Tn=dt(Zt.getAttribute("height")),Nn=1-.551915024494,Pn=new ShapePath;return Pn.moveTo(cn+rn,Ot),Pn.lineTo(cn+hn-rn,Ot),(rn!==0||fn!==0)&&Pn.bezierCurveTo(cn+hn-rn*Nn,Ot,cn+hn,Ot+fn*Nn,cn+hn,Ot+fn),Pn.lineTo(cn+hn,Ot+Tn-fn),(rn!==0||fn!==0)&&Pn.bezierCurveTo(cn+hn,Ot+Tn-fn*Nn,cn+hn-rn*Nn,Ot+Tn,cn+hn-rn,Ot+Tn),Pn.lineTo(cn+rn,Ot+Tn),(rn!==0||fn!==0)&&Pn.bezierCurveTo(cn+rn*Nn,Ot+Tn,cn,Ot+Tn-fn*Nn,cn,Ot+Tn-fn),Pn.lineTo(cn,Ot+fn),(rn!==0||fn!==0)&&Pn.bezierCurveTo(cn,Ot+fn*Nn,cn+rn*Nn,Ot,cn+rn,Ot),Pn}function it(Zt){function cn(hn,Tn,Nn){const Pn=dt(Tn),Dn=dt(Nn);fn===0?rn.moveTo(Pn,Dn):rn.lineTo(Pn,Dn),fn++}const Ot=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,rn=new ShapePath;let fn=0;return Zt.getAttribute("points").replace(Ot,cn),rn.currentPath.autoClose=!0,rn}function st(Zt){function cn(hn,Tn,Nn){const Pn=dt(Tn),Dn=dt(Nn);fn===0?rn.moveTo(Pn,Dn):rn.lineTo(Pn,Dn),fn++}const Ot=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,rn=new ShapePath;let fn=0;return Zt.getAttribute("points").replace(Ot,cn),rn.currentPath.autoClose=!1,rn}function at(Zt){const cn=dt(Zt.getAttribute("cx")||0),Ot=dt(Zt.getAttribute("cy")||0),rn=dt(Zt.getAttribute("r")||0),fn=new Path;fn.absarc(cn,Ot,rn,0,Math.PI*2);const hn=new ShapePath;return hn.subPaths.push(fn),hn}function ot(Zt){const cn=dt(Zt.getAttribute("cx")||0),Ot=dt(Zt.getAttribute("cy")||0),rn=dt(Zt.getAttribute("rx")||0),fn=dt(Zt.getAttribute("ry")||0),hn=new Path;hn.absellipse(cn,Ot,rn,fn,0,Math.PI*2);const Tn=new ShapePath;return Tn.subPaths.push(hn),Tn}function ct(Zt){const cn=dt(Zt.getAttribute("x1")||0),Ot=dt(Zt.getAttribute("y1")||0),rn=dt(Zt.getAttribute("x2")||0),fn=dt(Zt.getAttribute("y2")||0),hn=new ShapePath;return hn.moveTo(cn,Ot),hn.lineTo(rn,fn),hn.currentPath.autoClose=!1,hn}function ft(Zt,cn){cn=Object.assign({},cn);let Ot={};if(Zt.hasAttribute("class")){const Tn=Zt.getAttribute("class").split(/\s/).filter(Boolean).map(Nn=>Nn.trim());for(let Nn=0;Nn<Tn.length;Nn++)Ot=Object.assign(Ot,Ut["."+Tn[Nn]])}Zt.hasAttribute("id")&&(Ot=Object.assign(Ot,Ut["#"+Zt.getAttribute("id")]));function rn(Tn,Nn,Pn){Pn===void 0&&(Pn=function(ln){return ln.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),ln}),Zt.hasAttribute(Tn)&&(cn[Nn]=Pn(Zt.getAttribute(Tn))),Ot[Tn]&&(cn[Nn]=Pn(Ot[Tn])),Zt.style&&Zt.style[Tn]!==""&&(cn[Nn]=Pn(Zt.style[Tn]))}function fn(Tn){return Math.max(0,Math.min(1,dt(Tn)))}function hn(Tn){return Math.max(0,dt(Tn))}return rn("fill","fill"),rn("fill-opacity","fillOpacity",fn),rn("fill-rule","fillRule"),rn("opacity","opacity",fn),rn("stroke","stroke"),rn("stroke-opacity","strokeOpacity",fn),rn("stroke-width","strokeWidth",hn),rn("stroke-linejoin","strokeLineJoin"),rn("stroke-linecap","strokeLineCap"),rn("stroke-miterlimit","strokeMiterLimit",hn),rn("visibility","visibility"),cn}function ht(Zt,cn){return Zt-(cn-Zt)}function mt(Zt,cn,Ot){if(typeof Zt!="string")throw new TypeError("Invalid input: "+typeof Zt);const rn={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},fn=0,hn=1,Tn=2,Nn=3;let Pn=fn,Dn=!0,ln="",Cn="";const bn=[];function kn(nr,or,mr){const $n=new SyntaxError('Unexpected character "'+nr+'" at index '+or+".");throw $n.partial=mr,$n}function Sn(){ln!==""&&(Cn===""?bn.push(Number(ln)):bn.push(Number(ln)*Math.pow(10,Number(Cn)))),ln="",Cn=""}let xn;const Qn=Zt.length;for(let nr=0;nr<Qn;nr++){if(xn=Zt[nr],Array.isArray(cn)&&cn.includes(bn.length%Ot)&&rn.FLAGS.test(xn)){Pn=hn,ln=xn,Sn();continue}if(Pn===fn){if(rn.WHITESPACE.test(xn))continue;if(rn.DIGIT.test(xn)||rn.SIGN.test(xn)){Pn=hn,ln=xn;continue}if(rn.POINT.test(xn)){Pn=Tn,ln=xn;continue}rn.COMMA.test(xn)&&(Dn&&kn(xn,nr,bn),Dn=!0)}if(Pn===hn){if(rn.DIGIT.test(xn)){ln+=xn;continue}if(rn.POINT.test(xn)){ln+=xn,Pn=Tn;continue}if(rn.EXP.test(xn)){Pn=Nn;continue}rn.SIGN.test(xn)&&ln.length===1&&rn.SIGN.test(ln[0])&&kn(xn,nr,bn)}if(Pn===Tn){if(rn.DIGIT.test(xn)){ln+=xn;continue}if(rn.EXP.test(xn)){Pn=Nn;continue}rn.POINT.test(xn)&&ln[ln.length-1]==="."&&kn(xn,nr,bn)}if(Pn===Nn){if(rn.DIGIT.test(xn)){Cn+=xn;continue}if(rn.SIGN.test(xn)){if(Cn===""){Cn+=xn;continue}Cn.length===1&&rn.SIGN.test(Cn)&&kn(xn,nr,bn)}}rn.WHITESPACE.test(xn)?(Sn(),Pn=fn,Dn=!1):rn.COMMA.test(xn)?(Sn(),Pn=fn,Dn=!0):rn.SIGN.test(xn)?(Sn(),Pn=hn,ln=xn):rn.POINT.test(xn)?(Sn(),Pn=Tn,ln=xn):kn(xn,nr,bn)}return Sn(),bn}const lt=["mm","cm","in","pt","pc","px"],ut={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function dt(Zt){let cn="px";if(typeof Zt=="string"||Zt instanceof String)for(let rn=0,fn=lt.length;rn<fn;rn++){const hn=lt[rn];if(Zt.endsWith(hn)){cn=hn,Zt=Zt.substring(0,Zt.length-hn.length);break}}let Ot;return cn==="px"&&o.defaultUnit!=="px"?Ot=ut.in[o.defaultUnit]/o.defaultDPI:(Ot=ut[cn][o.defaultUnit],Ot<0&&(Ot=ut[cn].in*o.defaultDPI)),Ot*parseFloat(Zt)}function gt(Zt){if(!(Zt.hasAttribute("transform")||Zt.nodeName==="use"&&(Zt.hasAttribute("x")||Zt.hasAttribute("y"))))return null;const cn=Et(Zt);return Ht.length>0&&cn.premultiply(Ht[Ht.length-1]),Qt.copy(cn),Ht.push(cn),cn}function Et(Zt){const cn=new Matrix3,Ot=Wt;if(Zt.nodeName==="use"&&(Zt.hasAttribute("x")||Zt.hasAttribute("y"))){const rn=dt(Zt.getAttribute("x")),fn=dt(Zt.getAttribute("y"));cn.translate(rn,fn)}if(Zt.hasAttribute("transform")){const rn=Zt.getAttribute("transform").split(")");for(let fn=rn.length-1;fn>=0;fn--){const hn=rn[fn].trim();if(hn==="")continue;const Tn=hn.indexOf("("),Nn=hn.length;if(Tn>0&&Tn<Nn){const Pn=hn.substr(0,Tn),Dn=mt(hn.substr(Tn+1,Nn-Tn-1));switch(Ot.identity(),Pn){case"translate":if(Dn.length>=1){const ln=Dn[0];let Cn=ln;Dn.length>=2&&(Cn=Dn[1]),Ot.translate(ln,Cn)}break;case"rotate":if(Dn.length>=1){let ln=0,Cn=0,bn=0;ln=-Dn[0]*Math.PI/180,Dn.length>=3&&(Cn=Dn[1],bn=Dn[2]),Jt.identity().translate(-Cn,-bn),sn.identity().rotate(ln),jt.multiplyMatrices(sn,Jt),Jt.identity().translate(Cn,bn),Ot.multiplyMatrices(Jt,jt)}break;case"scale":if(Dn.length>=1){const ln=Dn[0];let Cn=ln;Dn.length>=2&&(Cn=Dn[1]),Ot.scale(ln,Cn)}break;case"skewX":Dn.length===1&&Ot.set(1,Math.tan(Dn[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":Dn.length===1&&Ot.set(1,0,0,Math.tan(Dn[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":Dn.length===6&&Ot.set(Dn[0],Dn[2],Dn[4],Dn[1],Dn[3],Dn[5],0,0,1);break}}cn.premultiply(Ot)}}return cn}function St(Zt,cn){function Ot(hn){Lt.set(hn.x,hn.y,1).applyMatrix3(cn),hn.set(Lt.x,Lt.y)}const rn=Tt(cn),fn=Zt.subPaths;for(let hn=0,Tn=fn.length;hn<Tn;hn++){const Pn=fn[hn].curves;for(let Dn=0;Dn<Pn.length;Dn++){const ln=Pn[Dn];ln.isLineCurve?(Ot(ln.v1),Ot(ln.v2)):ln.isCubicBezierCurve?(Ot(ln.v0),Ot(ln.v1),Ot(ln.v2),Ot(ln.v3)):ln.isQuadraticBezierCurve?(Ot(ln.v0),Ot(ln.v1),Ot(ln.v2)):ln.isEllipseCurve&&(rn&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),Vt.set(ln.aX,ln.aY),Ot(Vt),ln.aX=Vt.x,ln.aY=Vt.y,ln.xRadius*=Mt(cn),ln.yRadius*=Bt(cn))}}}function Tt(Zt){return Zt.elements[1]!==0||Zt.elements[3]!==0}function Mt(Zt){const cn=Zt.elements;return Math.sqrt(cn[0]*cn[0]+cn[1]*cn[1])}function Bt(Zt){const cn=Zt.elements;return Math.sqrt(cn[3]*cn[3]+cn[4]*cn[4])}const Rt=[],Ut={},Ht=[],Wt=new Matrix3,Jt=new Matrix3,sn=new Matrix3,jt=new Matrix3,Vt=new Vector2,Lt=new Vector3,Qt=new Matrix3,nn=new DOMParser().parseFromString(s,"image/svg+xml");return j(nn.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:Rt,xml:nn.documentElement}}static createShapes(s){const j={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},$={loc:j.ORIGIN,t:0};function _e(mt,lt,ut,dt){const gt=mt.x,Et=lt.x,St=ut.x,Tt=dt.x,Mt=mt.y,Bt=lt.y,Rt=ut.y,Ut=dt.y,Ht=(Tt-St)*(Mt-Rt)-(Ut-Rt)*(gt-St),Wt=(Et-gt)*(Mt-Rt)-(Bt-Mt)*(gt-St),Jt=(Ut-Rt)*(Et-gt)-(Tt-St)*(Bt-Mt),sn=Ht/Jt,jt=Wt/Jt;if(Jt===0&&Ht!==0||sn<=0||sn>=1||jt<0||jt>1)return null;if(Ht===0&&Jt===0){for(let Vt=0;Vt<2;Vt++)if(tt(Vt===0?ut:dt,mt,lt),$.loc==j.ORIGIN){const Lt=Vt===0?ut:dt;return{x:Lt.x,y:Lt.y,t:$.t}}else if($.loc==j.BETWEEN){const Lt=+(gt+$.t*(Et-gt)).toPrecision(10),Qt=+(Mt+$.t*(Bt-Mt)).toPrecision(10);return{x:Lt,y:Qt,t:$.t}}return null}else{for(let Qt=0;Qt<2;Qt++)if(tt(Qt===0?ut:dt,mt,lt),$.loc==j.ORIGIN){const nn=Qt===0?ut:dt;return{x:nn.x,y:nn.y,t:$.t}}const Vt=+(gt+sn*(Et-gt)).toPrecision(10),Lt=+(Mt+sn*(Bt-Mt)).toPrecision(10);return{x:Vt,y:Lt,t:sn}}}function tt(mt,lt,ut){const dt=ut.x-lt.x,gt=ut.y-lt.y,Et=mt.x-lt.x,St=mt.y-lt.y,Tt=dt*St-Et*gt;if(mt.x===lt.x&&mt.y===lt.y){$.loc=j.ORIGIN,$.t=0;return}if(mt.x===ut.x&&mt.y===ut.y){$.loc=j.DESTINATION,$.t=1;return}if(Tt<-Number.EPSILON){$.loc=j.LEFT;return}if(Tt>Number.EPSILON){$.loc=j.RIGHT;return}if(dt*Et<0||gt*St<0){$.loc=j.BEHIND;return}if(Math.sqrt(dt*dt+gt*gt)<Math.sqrt(Et*Et+St*St)){$.loc=j.BEYOND;return}let Mt;dt!==0?Mt=Et/dt:Mt=St/gt,$.loc=j.BETWEEN,$.t=Mt}function nt(mt,lt){const ut=[],dt=[];for(let gt=1;gt<mt.length;gt++){const Et=mt[gt-1],St=mt[gt];for(let Tt=1;Tt<lt.length;Tt++){const Mt=lt[Tt-1],Bt=lt[Tt],Rt=_e(Et,St,Mt,Bt);Rt!==null&&ut.find(Ut=>Ut.t<=Rt.t+Number.EPSILON&&Ut.t>=Rt.t-Number.EPSILON)===void 0&&(ut.push(Rt),dt.push(new Vector2(Rt.x,Rt.y)))}}return dt}function rt(mt,lt,ut){const dt=new Vector2;lt.getCenter(dt);const gt=[];return ut.forEach(Et=>{Et.boundingBox.containsPoint(dt)&&nt(mt,Et.points).forEach(Tt=>{gt.push({identifier:Et.identifier,isCW:Et.isCW,point:Tt})})}),gt.sort((Et,St)=>Et.point.x-St.point.x),gt}function it(mt,lt,ut,dt,gt){(gt==null||gt==="")&&(gt="nonzero");const Et=new Vector2;mt.boundingBox.getCenter(Et);const St=[new Vector2(ut,Et.y),new Vector2(dt,Et.y)],Tt=rt(St,mt.boundingBox,lt);Tt.sort((Wt,Jt)=>Wt.point.x-Jt.point.x);const Mt=[],Bt=[];Tt.forEach(Wt=>{Wt.identifier===mt.identifier?Mt.push(Wt):Bt.push(Wt)});const Rt=Mt[0].point.x,Ut=[];let Ht=0;for(;Ht<Bt.length&&Bt[Ht].point.x<Rt;)Ut.length>0&&Ut[Ut.length-1]===Bt[Ht].identifier?Ut.pop():Ut.push(Bt[Ht].identifier),Ht++;if(Ut.push(mt.identifier),gt==="evenodd"){const Wt=Ut.length%2===0,Jt=Ut[Ut.length-2];return{identifier:mt.identifier,isHole:Wt,for:Jt}}else if(gt==="nonzero"){let Wt=!0,Jt=null,sn=null;for(let jt=0;jt<Ut.length;jt++){const Vt=Ut[jt];Wt?(sn=lt[Vt].isCW,Wt=!1,Jt=Vt):sn!==lt[Vt].isCW&&(sn=lt[Vt].isCW,Wt=!0)}return{identifier:mt.identifier,isHole:Wt,for:Jt}}else console.warn('fill-rule: "'+gt+'" is currently not implemented.')}let st=0,at=999999999,ot=-999999999,ct=s.subPaths.map(mt=>{const lt=mt.getPoints();let ut=-999999999,dt=999999999,gt=-999999999,Et=999999999;for(let St=0;St<lt.length;St++){const Tt=lt[St];Tt.y>ut&&(ut=Tt.y),Tt.y<dt&&(dt=Tt.y),Tt.x>gt&&(gt=Tt.x),Tt.x<Et&&(Et=Tt.x)}return ot<=gt&&(ot=gt+1),at>=Et&&(at=Et-1),{curves:mt.curves,points:lt,isCW:ShapeUtils.isClockWise(lt),identifier:st++,boundingBox:new Box2(new Vector2(Et,dt),new Vector2(gt,ut))}});ct=ct.filter(mt=>mt.points.length>1);const ft=ct.map(mt=>it(mt,ct,at,ot,s.userData.style.fillRule)),ht=[];return ct.forEach(mt=>{if(!ft[mt.identifier].isHole){const ut=new Shape;ut.curves=mt.curves,ft.filter(gt=>gt.isHole&&gt.for===mt.identifier).forEach(gt=>{const Et=ct[gt.identifier],St=new Path;St.curves=Et.curves,ut.holes.push(St)}),ht.push(ut)}}),ht}static getStrokeStyle(s,o,j,$,_e){return s=s!==void 0?s:1,o=o!==void 0?o:"#000",j=j!==void 0?j:"miter",$=$!==void 0?$:"butt",_e=_e!==void 0?_e:4,{strokeColor:o,strokeWidth:s,strokeLineJoin:j,strokeLineCap:$,strokeMiterLimit:_e}}static pointsToStroke(s,o,j,$){const _e=[],tt=[],nt=[];if(SVGLoader.pointsToStrokeWithBuffers(s,o,j,$,_e,tt,nt)===0)return null;const rt=new BufferGeometry;return rt.setAttribute("position",new Float32BufferAttribute(_e,3)),rt.setAttribute("normal",new Float32BufferAttribute(tt,3)),rt.setAttribute("uv",new Float32BufferAttribute(nt,2)),rt}static pointsToStrokeWithBuffers(s,o,j,$,_e,tt,nt,rt){const it=new Vector2,st=new Vector2,at=new Vector2,ot=new Vector2,ct=new Vector2,ft=new Vector2,ht=new Vector2,mt=new Vector2,lt=new Vector2,ut=new Vector2,dt=new Vector2,gt=new Vector2,Et=new Vector2,St=new Vector2,Tt=new Vector2,Mt=new Vector2,Bt=new Vector2;j=j!==void 0?j:12,$=$!==void 0?$:.001,rt=rt!==void 0?rt:0,s=Cn(s);const Rt=s.length;if(Rt<2)return 0;const Ut=s[0].equals(s[Rt-1]);let Ht,Wt=s[0],Jt;const sn=o.strokeWidth/2,jt=1/(Rt-1);let Vt=0,Lt,Qt,nn,mn,Zt=!1,cn=0,Ot=rt*3,rn=rt*2;fn(s[0],s[1],it).multiplyScalar(sn),mt.copy(s[0]).sub(it),lt.copy(s[0]).add(it),ut.copy(mt),dt.copy(lt);for(let bn=1;bn<Rt;bn++){Ht=s[bn],bn===Rt-1?Ut?Jt=s[1]:Jt=void 0:Jt=s[bn+1];const kn=it;if(fn(Wt,Ht,kn),at.copy(kn).multiplyScalar(sn),gt.copy(Ht).sub(at),Et.copy(Ht).add(at),Lt=Vt+jt,Qt=!1,Jt!==void 0){fn(Ht,Jt,st),at.copy(st).multiplyScalar(sn),St.copy(Ht).sub(at),Tt.copy(Ht).add(at),nn=!0,at.subVectors(Jt,Wt),kn.dot(at)<0&&(nn=!1),bn===1&&(Zt=nn),at.subVectors(Jt,Ht),at.normalize();const Sn=Math.abs(kn.dot(at));if(Sn!==0){const xn=sn/Sn;at.multiplyScalar(-xn),ot.subVectors(Ht,Wt),ct.copy(ot).setLength(xn).add(at),Mt.copy(ct).negate();const Qn=ct.length(),nr=ot.length();ot.divideScalar(nr),ft.subVectors(Jt,Ht);const or=ft.length();switch(ft.divideScalar(or),ot.dot(Mt)<nr&&ft.dot(Mt)<or&&(Qt=!0),Bt.copy(ct).add(Ht),Mt.add(Ht),mn=!1,Qt?nn?(Tt.copy(Mt),Et.copy(Mt)):(St.copy(Mt),gt.copy(Mt)):Nn(),o.strokeLineJoin){case"bevel":Pn(nn,Qt,Lt);break;case"round":Dn(nn,Qt),nn?Tn(Ht,gt,St,Lt,0):Tn(Ht,Tt,Et,Lt,1);break;case"miter":case"miter-clip":default:const mr=sn*o.strokeMiterLimit/Qn;if(mr<1)if(o.strokeLineJoin!=="miter-clip"){Pn(nn,Qt,Lt);break}else Dn(nn,Qt),nn?(ft.subVectors(Bt,gt).multiplyScalar(mr).add(gt),ht.subVectors(Bt,St).multiplyScalar(mr).add(St),hn(gt,Lt,0),hn(ft,Lt,0),hn(Ht,Lt,.5),hn(Ht,Lt,.5),hn(ft,Lt,0),hn(ht,Lt,0),hn(Ht,Lt,.5),hn(ht,Lt,0),hn(St,Lt,0)):(ft.subVectors(Bt,Et).multiplyScalar(mr).add(Et),ht.subVectors(Bt,Tt).multiplyScalar(mr).add(Tt),hn(Et,Lt,1),hn(ft,Lt,1),hn(Ht,Lt,.5),hn(Ht,Lt,.5),hn(ft,Lt,1),hn(ht,Lt,1),hn(Ht,Lt,.5),hn(ht,Lt,1),hn(Tt,Lt,1));else Qt?(nn?(hn(lt,Vt,1),hn(mt,Vt,0),hn(Bt,Lt,0),hn(lt,Vt,1),hn(Bt,Lt,0),hn(Mt,Lt,1)):(hn(lt,Vt,1),hn(mt,Vt,0),hn(Bt,Lt,1),hn(mt,Vt,0),hn(Mt,Lt,0),hn(Bt,Lt,1)),nn?St.copy(Bt):Tt.copy(Bt)):nn?(hn(gt,Lt,0),hn(Bt,Lt,0),hn(Ht,Lt,.5),hn(Ht,Lt,.5),hn(Bt,Lt,0),hn(St,Lt,0)):(hn(Et,Lt,1),hn(Bt,Lt,1),hn(Ht,Lt,.5),hn(Ht,Lt,.5),hn(Bt,Lt,1),hn(Tt,Lt,1)),mn=!0;break}}else Nn()}else Nn();!Ut&&bn===Rt-1&&ln(s[0],ut,dt,nn,!0,Vt),Vt=Lt,Wt=Ht,mt.copy(St),lt.copy(Tt)}if(!Ut)ln(Ht,gt,Et,nn,!1,Lt);else if(Qt&&_e){let bn=Bt,kn=Mt;Zt!==nn&&(bn=Mt,kn=Bt),nn?(mn||Zt)&&(kn.toArray(_e,0*3),kn.toArray(_e,3*3),mn&&bn.toArray(_e,1*3)):(mn||!Zt)&&(kn.toArray(_e,1*3),kn.toArray(_e,3*3),mn&&bn.toArray(_e,0*3))}return cn;function fn(bn,kn,Sn){return Sn.subVectors(kn,bn),Sn.set(-Sn.y,Sn.x).normalize()}function hn(bn,kn,Sn){_e&&(_e[Ot]=bn.x,_e[Ot+1]=bn.y,_e[Ot+2]=0,tt&&(tt[Ot]=0,tt[Ot+1]=0,tt[Ot+2]=1),Ot+=3,nt&&(nt[rn]=kn,nt[rn+1]=Sn,rn+=2)),cn+=3}function Tn(bn,kn,Sn,xn,Qn){it.copy(kn).sub(bn).normalize(),st.copy(Sn).sub(bn).normalize();let nr=Math.PI;const or=it.dot(st);Math.abs(or)<1&&(nr=Math.abs(Math.acos(or))),nr/=j,at.copy(kn);for(let mr=0,$n=j-1;mr<$n;mr++)ot.copy(at).rotateAround(bn,nr),hn(at,xn,Qn),hn(ot,xn,Qn),hn(bn,xn,.5),at.copy(ot);hn(ot,xn,Qn),hn(Sn,xn,Qn),hn(bn,xn,.5)}function Nn(){hn(lt,Vt,1),hn(mt,Vt,0),hn(gt,Lt,0),hn(lt,Vt,1),hn(gt,Lt,1),hn(Et,Lt,0)}function Pn(bn,kn,Sn){kn?bn?(hn(lt,Vt,1),hn(mt,Vt,0),hn(gt,Lt,0),hn(lt,Vt,1),hn(gt,Lt,0),hn(Mt,Lt,1),hn(gt,Sn,0),hn(St,Sn,0),hn(Mt,Sn,.5)):(hn(lt,Vt,1),hn(mt,Vt,0),hn(Et,Lt,1),hn(mt,Vt,0),hn(Mt,Lt,0),hn(Et,Lt,1),hn(Et,Sn,1),hn(Tt,Sn,0),hn(Mt,Sn,.5)):bn?(hn(gt,Sn,0),hn(St,Sn,0),hn(Ht,Sn,.5)):(hn(Et,Sn,1),hn(Tt,Sn,0),hn(Ht,Sn,.5))}function Dn(bn,kn){kn&&(bn?(hn(lt,Vt,1),hn(mt,Vt,0),hn(gt,Lt,0),hn(lt,Vt,1),hn(gt,Lt,0),hn(Mt,Lt,1),hn(gt,Vt,0),hn(Ht,Lt,.5),hn(Mt,Lt,1),hn(Ht,Lt,.5),hn(St,Vt,0),hn(Mt,Lt,1)):(hn(lt,Vt,1),hn(mt,Vt,0),hn(Et,Lt,1),hn(mt,Vt,0),hn(Mt,Lt,0),hn(Et,Lt,1),hn(Et,Vt,1),hn(Mt,Lt,0),hn(Ht,Lt,.5),hn(Ht,Lt,.5),hn(Mt,Lt,0),hn(Tt,Vt,1)))}function ln(bn,kn,Sn,xn,Qn,nr){switch(o.strokeLineCap){case"round":Qn?Tn(bn,Sn,kn,nr,.5):Tn(bn,kn,Sn,nr,.5);break;case"square":if(Qn)it.subVectors(kn,bn),st.set(it.y,-it.x),at.addVectors(it,st).add(bn),ot.subVectors(st,it).add(bn),xn?(at.toArray(_e,1*3),ot.toArray(_e,0*3),ot.toArray(_e,3*3)):(at.toArray(_e,1*3),at.toArray(_e,3*3),ot.toArray(_e,0*3));else{it.subVectors(Sn,bn),st.set(it.y,-it.x),at.addVectors(it,st).add(bn),ot.subVectors(st,it).add(bn);const or=_e.length;xn?(at.toArray(_e,or-1*3),ot.toArray(_e,or-2*3),ot.toArray(_e,or-4*3)):(at.toArray(_e,or-2*3),ot.toArray(_e,or-1*3),ot.toArray(_e,or-4*3))}break}}function Cn(bn){let kn=!1;for(let xn=1,Qn=bn.length-1;xn<Qn;xn++)if(bn[xn].distanceTo(bn[xn+1])<$){kn=!0;break}if(!kn)return bn;const Sn=[];Sn.push(bn[0]);for(let xn=1,Qn=bn.length-1;xn<Qn;xn++)bn[xn].distanceTo(bn[xn+1])>=$&&Sn.push(bn[xn]);return Sn.push(bn[bn.length-1]),Sn}}}const _taskCache$1=new WeakMap;class Rhino3dmLoader extends Loader{constructor(s){super(s),this.libraryPath="",this.libraryPending=null,this.libraryBinary=null,this.libraryConfig={},this.url="",this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={},this.materials=[]}setLibraryPath(s){return this.libraryPath=s,this}setWorkerLimit(s){return this.workerLimit=s,this}load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setResponseType("arraybuffer"),_e.setRequestHeader(this.requestHeader),this.url=s,_e.load(s,tt=>{if(_taskCache$1.has(tt))return _taskCache$1.get(tt).promise.then(o).catch($);this.decodeObjects(tt,s).then(o).catch($)},j,$)}debug(){console.log("Task load: ",this.workerPool.map(s=>s._taskLoad))}decodeObjects(s,o){let j,$;const _e=s.byteLength,tt=this._getWorker(_e).then(nt=>(j=nt,$=this.workerNextTaskID++,new Promise((rt,it)=>{j._callbacks[$]={resolve:rt,reject:it},j.postMessage({type:"decode",id:$,buffer:s},[s])}))).then(nt=>this._createGeometry(nt.data));return tt.catch(()=>!0).then(()=>{j&&$&&this._releaseTask(j,$)}),_taskCache$1.set(s,{url:o,promise:tt}),tt}parse(s,o,j){this.decodeObjects(s,"").then(o).catch(j)}_compareMaterials(s){const o={};o.name=s.name,o.color={},o.color.r=s.color.r,o.color.g=s.color.g,o.color.b=s.color.b,o.type=s.type;for(let j=0;j<this.materials.length;j++){const $=this.materials[j],_e={};if(_e.name=$.name,_e.color={},_e.color.r=$.color.r,_e.color.g=$.color.g,_e.color.b=$.color.b,_e.type=$.type,JSON.stringify(o)===JSON.stringify(_e))return $}return this.materials.push(s),s}_createMaterial(s){if(s===void 0)return new MeshStandardMaterial({color:new Color(1,1,1),metalness:.8,name:"default",side:2});const o=s.diffuseColor,j=new Color(o.r/255,o.g/255,o.b/255);o.r===0&&o.g===0&&o.b===0&&(j.r=1,j.g=1,j.b=1);const $=new MeshStandardMaterial({color:j,name:s.name,side:2,transparent:s.transparency>0,opacity:1-s.transparency}),_e=new TextureLoader;for(let tt=0;tt<s.textures.length;tt++){const nt=s.textures[tt];if(nt.image!==null){const rt=_e.load(nt.image);switch(nt.type){case"Diffuse":$.map=rt;break;case"Bump":$.bumpMap=rt;break;case"Transparency":$.alphaMap=rt,$.transparent=!0;break;case"Emap":$.envMap=rt;break}}}return $}_createGeometry(s){const o=new Object3D,j=[],$=[],_e=[];o.userData.layers=s.layers,o.userData.groups=s.groups,o.userData.settings=s.settings,o.userData.objectType="File3dm",o.userData.materials=null,o.name=this.url;let tt=s.objects;const nt=s.materials;for(let rt=0;rt<tt.length;rt++){const it=tt[rt],st=it.attributes;switch(it.objectType){case"InstanceDefinition":$.push(it);break;case"InstanceReference":_e.push(it);break;default:let at;if(st.materialIndex>=0){const ct=nt[st.materialIndex];let ft=this._createMaterial(ct);ft=this._compareMaterials(ft),at=this._createObject(it,ft)}else{const ct=this._createMaterial();at=this._createObject(it,ct)}if(at===void 0)continue;const ot=s.layers[st.layerIndex];at.visible=ot?s.layers[st.layerIndex].visible:!0,st.isInstanceDefinitionObject?j.push(at):o.add(at);break}}for(let rt=0;rt<$.length;rt++){const it=$[rt];tt=[];for(let st=0;st<it.attributes.objectIds.length;st++){const at=it.attributes.objectIds[st];for(let ot=0;ot<j.length;ot++){const ct=j[ot].userData.attributes.id;at===ct&&tt.push(j[ot])}}for(let st=0;st<_e.length;st++){const at=_e[st];if(at.geometry.parentIdefId===it.attributes.id){const ot=new Object3D,ct=at.geometry.xform.array,ft=new Matrix4;ft.set(ct[0],ct[1],ct[2],ct[3],ct[4],ct[5],ct[6],ct[7],ct[8],ct[9],ct[10],ct[11],ct[12],ct[13],ct[14],ct[15]),ot.applyMatrix4(ft);for(let ht=0;ht<tt.length;ht++)ot.add(tt[ht].clone(!0));o.add(ot)}}}return o.userData.materials=this.materials,o}_createObject(s,o){const j=new BufferGeometryLoader,$=s.attributes;let _e,tt,nt,rt;switch(s.objectType){case"Point":case"PointSet":_e=j.parse(s.geometry),_e.attributes.hasOwnProperty("color")?tt=new PointsMaterial({vertexColors:!0,sizeAttenuation:!1,size:2}):(nt=$.drawColor,rt=new Color(nt.r/255,nt.g/255,nt.b/255),tt=new PointsMaterial({color:rt,sizeAttenuation:!1,size:2})),tt=this._compareMaterials(tt);const it=new Points(_e,tt);return it.userData.attributes=$,it.userData.objectType=s.objectType,$.name&&(it.name=$.name),it;case"Mesh":case"Extrusion":case"SubD":case"Brep":if(s.geometry===null)return;_e=j.parse(s.geometry),_e.attributes.hasOwnProperty("color")&&(o.vertexColors=!0),o===null&&(o=this._createMaterial(),o=this._compareMaterials(o));const st=new Mesh(_e,o);return st.castShadow=$.castsShadows,st.receiveShadow=$.receivesShadows,st.userData.attributes=$,st.userData.objectType=s.objectType,$.name&&(st.name=$.name),st;case"Curve":_e=j.parse(s.geometry),nt=$.drawColor,rt=new Color(nt.r/255,nt.g/255,nt.b/255),tt=new LineBasicMaterial({color:rt}),tt=this._compareMaterials(tt);const at=new Line(_e,tt);return at.userData.attributes=$,at.userData.objectType=s.objectType,$.name&&(at.name=$.name),at;case"TextDot":_e=s.geometry;const ot=document.createElement("canvas").getContext("2d"),ct=`${_e.fontHeight}px ${_e.fontFace}`;ot.font=ct;const ft=ot.measureText(_e.text).width+10,ht=_e.fontHeight+10,mt=window.devicePixelRatio;ot.canvas.width=ft*mt,ot.canvas.height=ht*mt,ot.canvas.style.width=ft+"px",ot.canvas.style.height=ht+"px",ot.setTransform(mt,0,0,mt,0,0),ot.font=ct,ot.textBaseline="middle",ot.textAlign="center",rt=$.drawColor,ot.fillStyle=`rgba(${rt.r},${rt.g},${rt.b},${rt.a})`,ot.fillRect(0,0,ft,ht),ot.fillStyle="white",ot.fillText(_e.text,ft/2,ht/2);const lt=new CanvasTexture(ot.canvas);lt.minFilter=LinearFilter,lt.wrapS=ClampToEdgeWrapping,lt.wrapT=ClampToEdgeWrapping,tt=new SpriteMaterial({map:lt,depthTest:!1});const ut=new Sprite(tt);return ut.position.set(_e.point[0],_e.point[1],_e.point[2]),ut.scale.set(ft/10,ht/10,1),ut.userData.attributes=$,ut.userData.objectType=s.objectType,$.name&&(ut.name=$.name),ut;case"Light":_e=s.geometry;let dt;if(_e.isDirectionalLight)dt=new DirectionalLight,dt.castShadow=$.castsShadows,dt.position.set(_e.location[0],_e.location[1],_e.location[2]),dt.target.position.set(_e.direction[0],_e.direction[1],_e.direction[2]),dt.shadow.normalBias=.1;else if(_e.isPointLight)dt=new PointLight,dt.castShadow=$.castsShadows,dt.position.set(_e.location[0],_e.location[1],_e.location[2]),dt.shadow.normalBias=.1;else if(_e.isRectangularLight){dt=new RectAreaLight;const gt=Math.abs(_e.width[2]),Et=Math.abs(_e.length[0]);dt.position.set(_e.location[0]-Et/2,_e.location[1],_e.location[2]-gt/2),dt.height=Et,dt.width=gt,dt.lookAt(new Vector3(_e.direction[0],_e.direction[1],_e.direction[2]))}else if(_e.isSpotLight)dt=new SpotLight,dt.castShadow=$.castsShadows,dt.position.set(_e.location[0],_e.location[1],_e.location[2]),dt.target.position.set(_e.direction[0],_e.direction[1],_e.direction[2]),dt.angle=_e.spotAngleRadians,dt.shadow.normalBias=.1;else if(_e.isLinearLight){console.warn("THREE.3DMLoader:  No conversion exists for linear lights.");return}return dt&&(dt.intensity=_e.intensity,nt=_e.diffuse,rt=new Color(nt.r/255,nt.g/255,nt.b/255),dt.color=rt,dt.userData.attributes=$,dt.userData.objectType=s.objectType),dt}}_initLibrary(){if(!this.libraryPending){const s=new FileLoader(this.manager);s.setPath(this.libraryPath);const o=new Promise((_e,tt)=>{s.load("rhino3dm.js",_e,void 0,tt)}),j=new FileLoader(this.manager);j.setPath(this.libraryPath),j.setResponseType("arraybuffer");const $=new Promise((_e,tt)=>{j.load("rhino3dm.wasm",_e,void 0,tt)});this.libraryPending=Promise.all([o,$]).then(([_e,tt])=>{this.libraryConfig.wasmBinary=tt;const nt=Rhino3dmWorker.toString(),rt=["/* rhino3dm.js */",_e,"/* worker */",nt.substring(nt.indexOf("{")+1,nt.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([rt]))})}return this.libraryPending}_getWorker(s){return this._initLibrary().then(()=>{if(this.workerPool.length<this.workerLimit){const j=new Worker(this.workerSourceURL);j._callbacks={},j._taskCosts={},j._taskLoad=0,j.postMessage({type:"init",libraryConfig:this.libraryConfig}),j.onmessage=function($){const _e=$.data;switch(_e.type){case"decode":j._callbacks[_e.id].resolve(_e);break;case"error":j._callbacks[_e.id].reject(_e);break;default:console.error('THREE.Rhino3dmLoader: Unexpected message, "'+_e.type+'"')}},this.workerPool.push(j)}else this.workerPool.sort(function(j,$){return j._taskLoad>$._taskLoad?-1:1});const o=this.workerPool[this.workerPool.length-1];return o._taskLoad+=s,o})}_releaseTask(s,o){s._taskLoad-=s._taskCosts[o],delete s._callbacks[o],delete s._taskCosts[o]}dispose(){for(let s=0;s<this.workerPool.length;++s)this.workerPool[s].terminate();return this.workerPool.length=0,this}}function Rhino3dmWorker(){let a,s,o;onmessage=function(nt){const rt=nt.data;switch(rt.type){case"init":s=rt.libraryConfig;const it=s.wasmBinary;let st;a=new Promise(function(ot){st={wasmBinary:it,onRuntimeInitialized:ot},rhino3dm(st)}).then(()=>{o=st});break;case"decode":const at=rt.buffer;a.then(()=>{const ot=j(o,at);self.postMessage({type:"decode",id:rt.id,data:ot})});break}};function j(nt,rt){const it=new Uint8Array(rt),st=nt.File3dm.fromByteArray(it),at=[],ot=[],ct=[],ft=[],ht=[],mt=[],lt=st.objects(),ut=lt.count;for(let St=0;St<ut;St++){const Tt=lt.get(St),Mt=$(Tt,st);Tt.delete(),Mt&&at.push(Mt)}for(let St=0;St<st.instanceDefinitions().count();St++){const Tt=st.instanceDefinitions().get(St),Mt=_e(Tt);Mt.objectIds=Tt.getObjectIds(),at.push({geometry:null,attributes:Mt,objectType:"InstanceDefinition"})}const dt=[nt.TextureType.Diffuse,nt.TextureType.Bump,nt.TextureType.Transparency,nt.TextureType.Opacity,nt.TextureType.Emap],gt=[nt.TextureType.PBR_BaseColor,nt.TextureType.PBR_Subsurface,nt.TextureType.PBR_SubsurfaceScattering,nt.TextureType.PBR_SubsurfaceScatteringRadius,nt.TextureType.PBR_Metallic,nt.TextureType.PBR_Specular,nt.TextureType.PBR_SpecularTint,nt.TextureType.PBR_Roughness,nt.TextureType.PBR_Anisotropic,nt.TextureType.PBR_Anisotropic_Rotation,nt.TextureType.PBR_Sheen,nt.TextureType.PBR_SheenTint,nt.TextureType.PBR_Clearcoat,nt.TextureType.PBR_ClearcoatBump,nt.TextureType.PBR_ClearcoatRoughness,nt.TextureType.PBR_OpacityIor,nt.TextureType.PBR_OpacityRoughness,nt.TextureType.PBR_Emission,nt.TextureType.PBR_AmbientOcclusion,nt.TextureType.PBR_Displacement];for(let St=0;St<st.materials().count();St++){const Tt=st.materials().get(St),Mt=Tt.physicallyBased();let Bt=_e(Tt);const Rt=[];for(let Ut=0;Ut<dt.length;Ut++){const Ht=Tt.getTexture(dt[Ut]);if(Ht){let Wt=dt[Ut].constructor.name;Wt=Wt.substring(12,Wt.length);const Jt={type:Wt},sn=st.getEmbeddedFileAsBase64(Ht.fileName);sn?Jt.image="data:image/png;base64,"+sn:(console.warn(`THREE.3DMLoader: Image for ${Wt} texture not embedded in file.`),Jt.image=null),Rt.push(Jt),Ht.delete()}}if(Bt.textures=Rt,Mt.supported){console.log("pbr true");for(let Ht=0;Ht<gt.length;Ht++){const Wt=Tt.getTexture(dt[Ht]);if(Wt){const Jt=st.getEmbeddedFileAsBase64(Wt.fileName);let sn=dt[Ht].constructor.name;sn=sn.substring(12,sn.length);const jt={type:sn,image:"data:image/png;base64,"+Jt};Rt.push(jt),Wt.delete()}}const Ut=_e(Tt.physicallyBased());Bt=Object.assign(Ut,Bt)}ot.push(Bt),Tt.delete(),Mt.delete()}for(let St=0;St<st.layers().count();St++){const Tt=st.layers().get(St),Mt=_e(Tt);ct.push(Mt),Tt.delete()}for(let St=0;St<st.views().count();St++){const Tt=st.views().get(St),Mt=_e(Tt);ft.push(Mt),Tt.delete()}for(let St=0;St<st.namedViews().count();St++){const Tt=st.namedViews().get(St),Mt=_e(Tt);ht.push(Mt),Tt.delete()}for(let St=0;St<st.groups().count();St++){const Tt=st.groups().get(St),Mt=_e(Tt);mt.push(Mt),Tt.delete()}const Et=_e(st.settings());return st.delete(),{objects:at,materials:ot,layers:ct,views:ft,namedViews:ht,groups:mt,settings:Et}}function $(nt,rt){const it=nt.geometry(),st=nt.attributes();let at=it.objectType,ot,ct,ft,ht,mt;switch(at){case o.ObjectType.Curve:const lt=tt(it,100);ft={},ct={},ht={},ft.itemSize=3,ft.type="Float32Array",ft.array=[];for(let St=0;St<lt.length;St++)ft.array.push(lt[St][0]),ft.array.push(lt[St][1]),ft.array.push(lt[St][2]);ct.position=ft,ht.attributes=ct,ot={data:ht};break;case o.ObjectType.Point:const ut=it.location;ft={};const dt={};ct={},ht={},ft.itemSize=3,ft.type="Float32Array",ft.array=[ut[0],ut[1],ut[2]];const gt=st.drawColor(rt);dt.itemSize=3,dt.type="Float32Array",dt.array=[gt.r/255,gt.g/255,gt.b/255],ct.position=ft,ct.color=dt,ht.attributes=ct,ot={data:ht};break;case o.ObjectType.PointSet:case o.ObjectType.Mesh:ot=it.toThreejsJSON();break;case o.ObjectType.Brep:const Et=it.faces();mt=new o.Mesh;for(let St=0;St<Et.count;St++){const Tt=Et.get(St),Mt=Tt.getMesh(o.MeshType.Any);Mt&&(mt.append(Mt),Mt.delete()),Tt.delete()}mt.faces().count>0&&(mt.compact(),ot=mt.toThreejsJSON(),Et.delete()),mt.delete();break;case o.ObjectType.Extrusion:mt=it.getMesh(o.MeshType.Any),mt&&(ot=mt.toThreejsJSON(),mt.delete());break;case o.ObjectType.TextDot:ot=_e(it);break;case o.ObjectType.Light:ot=_e(it);break;case o.ObjectType.InstanceReference:ot=_e(it),ot.xform=_e(it.xform),ot.xform.array=it.xform.toFloatArray(!0);break;case o.ObjectType.SubD:it.subdivide(3),mt=o.Mesh.createFromSubDControlNet(it),mt&&(ot=mt.toThreejsJSON(),mt.delete());break;default:console.warn(`THREE.3DMLoader: TODO: Implement ${at.constructor.name}`);break}if(ot)return ct=_e(st),ct.geometry=_e(it),st.groupCount>0&&(ct.groupIds=st.getGroupList()),st.userStringCount>0&&(ct.userStrings=st.getUserStrings()),it.userStringCount>0&&(ct.geometry.userStrings=it.getUserStrings()),ct.drawColor=st.drawColor(rt),at=at.constructor.name,at=at.substring(11,at.length),{geometry:ot,attributes:ct,objectType:at};console.warn(`THREE.3DMLoader: ${at.constructor.name} has no associated mesh geometry.`)}function _e(nt){const rt={};for(const it in nt){const st=nt[it];typeof st!="function"&&(typeof st=="object"&&st!==null&&st.hasOwnProperty("constructor")?rt[it]={name:st.constructor.name,value:st.value}:rt[it]=st)}return rt}function tt(nt,rt){let it=rt,st=[];const at=[];if(nt instanceof o.LineCurve)return[nt.pointAtStart,nt.pointAtEnd];if(nt instanceof o.PolylineCurve){it=nt.pointCount;for(let ft=0;ft<it;ft++)st.push(nt.point(ft));return st}if(nt instanceof o.PolyCurve){const ft=nt.segmentCount;for(let ht=0;ht<ft;ht++){const mt=nt.segmentCurve(ht),lt=tt(mt,it);st=st.concat(lt),mt.delete()}return st}if(nt instanceof o.ArcCurve&&(it=Math.floor(nt.angleDegrees/5),it=it<2?2:it),nt instanceof o.NurbsCurve&&nt.degree===1){const ft=nt.tryGetPolyline();for(let ht=0;ht<ft.count;ht++)st.push(ft.get(ht));return ft.delete(),st}const ot=nt.domain,ct=it-1;for(let ft=0;ft<it;ft++){const ht=ot[0]+ft/ct*(ot[1]-ot[0]);if(ht===ot[0]||ht===ot[1]){at.push(ht);continue}const mt=nt.tangentAt(ht),lt=nt.tangentAt(at.slice(-1)[0]),ut=mt[0]*mt[0]+mt[1]*mt[1]+mt[2]*mt[2],dt=lt[0]*lt[0]+lt[1]*lt[1]+lt[2]*lt[2],gt=Math.sqrt(ut*dt);let Et;if(gt===0)Et=Math.PI/2;else{const St=(mt.x*lt.x+mt.y*lt.y+mt.z*lt.z)/gt;Et=Math.acos(Math.max(-1,Math.min(1,St)))}Et<.1||at.push(ht)}return st=at.map(ft=>nt.pointAt(ft)),st}}const _object_pattern=/^[og]\s*(.+)?/,_material_library_pattern=/^mtllib /,_material_use_pattern=/^usemtl /,_map_use_pattern=/^usemap /,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_ab=new Vector3,_cb=new Vector3;function ParserState(){const a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(s,o){if(this.object&&this.object.fromDeclaration===!1){this.object.name=s,this.object.fromDeclaration=o!==!1;return}const j=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:s||"",fromDeclaration:o!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function($,_e){const tt=this._finalize(!1);tt&&(tt.inherited||tt.groupCount<=0)&&this.materials.splice(tt.index,1);const nt={index:this.materials.length,name:$||"",mtllib:Array.isArray(_e)&&_e.length>0?_e[_e.length-1]:"",smooth:tt!==void 0?tt.smooth:this.smooth,groupStart:tt!==void 0?tt.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(rt){const it={index:typeof rt=="number"?rt:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return it.clone=this.clone.bind(it),it}};return this.materials.push(nt),nt},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function($){const _e=this.currentMaterial();if(_e&&_e.groupEnd===-1&&(_e.groupEnd=this.geometry.vertices.length/3,_e.groupCount=_e.groupEnd-_e.groupStart,_e.inherited=!1),$&&this.materials.length>1)for(let tt=this.materials.length-1;tt>=0;tt--)this.materials[tt].groupCount<=0&&this.materials.splice(tt,1);return $&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),_e}},j&&j.name&&typeof j.clone=="function"){const $=j.clone(0);$.inherited=!0,this.object.materials.push($)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(s,o){const j=parseInt(s,10);return(j>=0?j-1:j+o/3)*3},parseNormalIndex:function(s,o){const j=parseInt(s,10);return(j>=0?j-1:j+o/3)*3},parseUVIndex:function(s,o){const j=parseInt(s,10);return(j>=0?j-1:j+o/2)*2},addVertex:function(s,o,j){const $=this.vertices,_e=this.object.geometry.vertices;_e.push($[s+0],$[s+1],$[s+2]),_e.push($[o+0],$[o+1],$[o+2]),_e.push($[j+0],$[j+1],$[j+2])},addVertexPoint:function(s){const o=this.vertices;this.object.geometry.vertices.push(o[s+0],o[s+1],o[s+2])},addVertexLine:function(s){const o=this.vertices;this.object.geometry.vertices.push(o[s+0],o[s+1],o[s+2])},addNormal:function(s,o,j){const $=this.normals,_e=this.object.geometry.normals;_e.push($[s+0],$[s+1],$[s+2]),_e.push($[o+0],$[o+1],$[o+2]),_e.push($[j+0],$[j+1],$[j+2])},addFaceNormal:function(s,o,j){const $=this.vertices,_e=this.object.geometry.normals;_vA.fromArray($,s),_vB.fromArray($,o),_vC.fromArray($,j),_cb.subVectors(_vC,_vB),_ab.subVectors(_vA,_vB),_cb.cross(_ab),_cb.normalize(),_e.push(_cb.x,_cb.y,_cb.z),_e.push(_cb.x,_cb.y,_cb.z),_e.push(_cb.x,_cb.y,_cb.z)},addColor:function(s,o,j){const $=this.colors,_e=this.object.geometry.colors;$[s]!==void 0&&_e.push($[s+0],$[s+1],$[s+2]),$[o]!==void 0&&_e.push($[o+0],$[o+1],$[o+2]),$[j]!==void 0&&_e.push($[j+0],$[j+1],$[j+2])},addUV:function(s,o,j){const $=this.uvs,_e=this.object.geometry.uvs;_e.push($[s+0],$[s+1]),_e.push($[o+0],$[o+1]),_e.push($[j+0],$[j+1])},addDefaultUV:function(){const s=this.object.geometry.uvs;s.push(0,0),s.push(0,0),s.push(0,0)},addUVLine:function(s){const o=this.uvs;this.object.geometry.uvs.push(o[s+0],o[s+1])},addFace:function(s,o,j,$,_e,tt,nt,rt,it){const st=this.vertices.length;let at=this.parseVertexIndex(s,st),ot=this.parseVertexIndex(o,st),ct=this.parseVertexIndex(j,st);if(this.addVertex(at,ot,ct),this.addColor(at,ot,ct),nt!==void 0&&nt!==""){const ft=this.normals.length;at=this.parseNormalIndex(nt,ft),ot=this.parseNormalIndex(rt,ft),ct=this.parseNormalIndex(it,ft),this.addNormal(at,ot,ct)}else this.addFaceNormal(at,ot,ct);if($!==void 0&&$!==""){const ft=this.uvs.length;at=this.parseUVIndex($,ft),ot=this.parseUVIndex(_e,ft),ct=this.parseUVIndex(tt,ft),this.addUV(at,ot,ct),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(s){this.object.geometry.type="Points";const o=this.vertices.length;for(let j=0,$=s.length;j<$;j++){const _e=this.parseVertexIndex(s[j],o);this.addVertexPoint(_e),this.addColor(_e)}},addLineGeometry:function(s,o){this.object.geometry.type="Line";const j=this.vertices.length,$=this.uvs.length;for(let _e=0,tt=s.length;_e<tt;_e++)this.addVertexLine(this.parseVertexIndex(s[_e],j));for(let _e=0,tt=o.length;_e<tt;_e++)this.addUVLine(this.parseUVIndex(o[_e],$))}};return a.startObject("",!1),a}class OBJLoader extends Loader{constructor(s){super(s),this.materials=null}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}setMaterials(s){return this.materials=s,this}parse(s){const o=new ParserState;s.indexOf(`\r
`)!==-1&&(s=s.replace(/\r\n/g,`
`)),s.indexOf(`\\
`)!==-1&&(s=s.replace(/\\\n/g,""));const j=s.split(`
`);let $="",_e="",tt=0,nt=[];const rt=typeof"".trimLeft=="function";for(let at=0,ot=j.length;at<ot;at++)if($=j[at],$=rt?$.trimLeft():$.trim(),tt=$.length,tt!==0&&(_e=$.charAt(0),_e!=="#"))if(_e==="v"){const ct=$.split(/\s+/);switch(ct[0]){case"v":o.vertices.push(parseFloat(ct[1]),parseFloat(ct[2]),parseFloat(ct[3])),ct.length>=7?o.colors.push(parseFloat(ct[4]),parseFloat(ct[5]),parseFloat(ct[6])):o.colors.push(void 0,void 0,void 0);break;case"vn":o.normals.push(parseFloat(ct[1]),parseFloat(ct[2]),parseFloat(ct[3]));break;case"vt":o.uvs.push(parseFloat(ct[1]),parseFloat(ct[2]));break}}else if(_e==="f"){const ft=$.substr(1).trim().split(/\s+/),ht=[];for(let lt=0,ut=ft.length;lt<ut;lt++){const dt=ft[lt];if(dt.length>0){const gt=dt.split("/");ht.push(gt)}}const mt=ht[0];for(let lt=1,ut=ht.length-1;lt<ut;lt++){const dt=ht[lt],gt=ht[lt+1];o.addFace(mt[0],dt[0],gt[0],mt[1],dt[1],gt[1],mt[2],dt[2],gt[2])}}else if(_e==="l"){const ct=$.substring(1).trim().split(" ");let ft=[];const ht=[];if($.indexOf("/")===-1)ft=ct;else for(let mt=0,lt=ct.length;mt<lt;mt++){const ut=ct[mt].split("/");ut[0]!==""&&ft.push(ut[0]),ut[1]!==""&&ht.push(ut[1])}o.addLineGeometry(ft,ht)}else if(_e==="p"){const ft=$.substr(1).trim().split(" ");o.addPointGeometry(ft)}else if((nt=_object_pattern.exec($))!==null){const ct=(" "+nt[0].substr(1).trim()).substr(1);o.startObject(ct)}else if(_material_use_pattern.test($))o.object.startMaterial($.substring(7).trim(),o.materialLibraries);else if(_material_library_pattern.test($))o.materialLibraries.push($.substring(7).trim());else if(_map_use_pattern.test($))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(_e==="s"){if(nt=$.split(" "),nt.length>1){const ft=nt[1].trim().toLowerCase();o.object.smooth=ft!=="0"&&ft!=="off"}else o.object.smooth=!0;const ct=o.object.currentMaterial();ct&&(ct.smooth=o.object.smooth)}else{if($==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+$+'"')}o.finalize();const it=new Group;if(it.materialLibraries=[].concat(o.materialLibraries),!(o.objects.length===1&&o.objects[0].geometry.vertices.length===0)===!0)for(let at=0,ot=o.objects.length;at<ot;at++){const ct=o.objects[at],ft=ct.geometry,ht=ct.materials,mt=ft.type==="Line",lt=ft.type==="Points";let ut=!1;if(ft.vertices.length===0)continue;const dt=new BufferGeometry;dt.setAttribute("position",new Float32BufferAttribute(ft.vertices,3)),ft.normals.length>0&&dt.setAttribute("normal",new Float32BufferAttribute(ft.normals,3)),ft.colors.length>0&&(ut=!0,dt.setAttribute("color",new Float32BufferAttribute(ft.colors,3))),ft.hasUVIndices===!0&&dt.setAttribute("uv",new Float32BufferAttribute(ft.uvs,2));const gt=[];for(let St=0,Tt=ht.length;St<Tt;St++){const Mt=ht[St],Bt=Mt.name+"_"+Mt.smooth+"_"+ut;let Rt=o.materials[Bt];if(this.materials!==null){if(Rt=this.materials.create(Mt.name),mt&&Rt&&!(Rt instanceof LineBasicMaterial)){const Ut=new LineBasicMaterial;Material.prototype.copy.call(Ut,Rt),Ut.color.copy(Rt.color),Rt=Ut}else if(lt&&Rt&&!(Rt instanceof PointsMaterial)){const Ut=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call(Ut,Rt),Ut.color.copy(Rt.color),Ut.map=Rt.map,Rt=Ut}}Rt===void 0&&(mt?Rt=new LineBasicMaterial:lt?Rt=new PointsMaterial({size:1,sizeAttenuation:!1}):Rt=new MeshPhongMaterial,Rt.name=Mt.name,Rt.flatShading=!Mt.smooth,Rt.vertexColors=ut,o.materials[Bt]=Rt),gt.push(Rt)}let Et;if(gt.length>1){for(let St=0,Tt=ht.length;St<Tt;St++){const Mt=ht[St];dt.addGroup(Mt.groupStart,Mt.groupCount,St)}mt?Et=new LineSegments(dt,gt):lt?Et=new Points(dt,gt):Et=new Mesh(dt,gt)}else mt?Et=new LineSegments(dt,gt[0]):lt?Et=new Points(dt,gt[0]):Et=new Mesh(dt,gt[0]);Et.name=ct.name,it.add(Et)}else if(o.vertices.length>0){const at=new PointsMaterial({size:1,sizeAttenuation:!1}),ot=new BufferGeometry;ot.setAttribute("position",new Float32BufferAttribute(o.vertices,3)),o.colors.length>0&&o.colors[0]!==void 0&&(ot.setAttribute("color",new Float32BufferAttribute(o.colors,3)),at.vertexColors=!0);const ct=new Points(ot,at);it.add(ct)}return it}}class AMFLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(gt){let Et=new DataView(gt);if(String.fromCharCode(Et.getUint8(0),Et.getUint8(1))==="PK"){let Bt=null,Rt=null;console.log("THREE.AMFLoader: Loading Zip");try{Bt=unzipSync(new Uint8Array(gt))}catch(Ut){if(Ut instanceof ReferenceError)return console.log("THREE.AMFLoader: fflate missing and file is compressed."),null}for(Rt in Bt)if(Rt.toLowerCase().substr(-4)===".amf")break;console.log("THREE.AMFLoader: Trying to load file asset: "+Rt),Et=new DataView(Bt[Rt].buffer)}const Tt=LoaderUtils.decodeText(Et),Mt=new DOMParser().parseFromString(Tt,"application/xml");return Mt.documentElement.nodeName.toLowerCase()!=="amf"?(console.log("THREE.AMFLoader: Error loading AMF - no AMF document found."),null):Mt}function j(gt){let Et=1,St="millimeter";gt.documentElement.attributes.unit!==void 0&&(St=gt.documentElement.attributes.unit.value.toLowerCase());const Tt={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return Tt[St]!==void 0&&(Et=Tt[St]),console.log("THREE.AMFLoader: Unit scale: "+Et),Et}function $(gt){let Et="AMF Material";const St=gt.attributes.id.textContent;let Tt={r:1,g:1,b:1,a:1},Mt=null;for(let Bt=0;Bt<gt.childNodes.length;Bt++){const Rt=gt.childNodes[Bt];Rt.nodeName==="metadata"&&Rt.attributes.type!==void 0?Rt.attributes.type.value==="name"&&(Et=Rt.textContent):Rt.nodeName==="color"&&(Tt=_e(Rt))}return Mt=new MeshPhongMaterial({flatShading:!0,color:new Color(Tt.r,Tt.g,Tt.b),name:Et}),Tt.a!==1&&(Mt.transparent=!0,Mt.opacity=Tt.a),{id:St,material:Mt}}function _e(gt){const Et={r:1,g:1,b:1,a:1};for(let St=0;St<gt.childNodes.length;St++){const Tt=gt.childNodes[St];Tt.nodeName==="r"?Et.r=Tt.textContent:Tt.nodeName==="g"?Et.g=Tt.textContent:Tt.nodeName==="b"?Et.b=Tt.textContent:Tt.nodeName==="a"&&(Et.a=Tt.textContent)}return Et}function tt(gt){const Et={name:"",triangles:[],materialid:null};let St=gt.firstElementChild;for(gt.attributes.materialid!==void 0&&(Et.materialId=gt.attributes.materialid.nodeValue);St;){if(St.nodeName==="metadata")St.attributes.type!==void 0&&St.attributes.type.value==="name"&&(Et.name=St.textContent);else if(St.nodeName==="triangle"){const Tt=St.getElementsByTagName("v1")[0].textContent,Mt=St.getElementsByTagName("v2")[0].textContent,Bt=St.getElementsByTagName("v3")[0].textContent;Et.triangles.push(Tt,Mt,Bt)}St=St.nextElementSibling}return Et}function nt(gt){const Et=[],St=[];let Tt=gt.firstElementChild;for(;Tt;){if(Tt.nodeName==="vertex"){let Mt=Tt.firstElementChild;for(;Mt;){if(Mt.nodeName==="coordinates"){const Bt=Mt.getElementsByTagName("x")[0].textContent,Rt=Mt.getElementsByTagName("y")[0].textContent,Ut=Mt.getElementsByTagName("z")[0].textContent;Et.push(Bt,Rt,Ut)}else if(Mt.nodeName==="normal"){const Bt=Mt.getElementsByTagName("nx")[0].textContent,Rt=Mt.getElementsByTagName("ny")[0].textContent,Ut=Mt.getElementsByTagName("nz")[0].textContent;St.push(Bt,Rt,Ut)}Mt=Mt.nextElementSibling}}Tt=Tt.nextElementSibling}return{vertices:Et,normals:St}}function rt(gt){const Et=gt.attributes.id.textContent,St={name:"amfobject",meshes:[]};let Tt=null,Mt=gt.firstElementChild;for(;Mt;){if(Mt.nodeName==="metadata")Mt.attributes.type!==void 0&&Mt.attributes.type.value==="name"&&(St.name=Mt.textContent);else if(Mt.nodeName==="color")Tt=_e(Mt);else if(Mt.nodeName==="mesh"){let Bt=Mt.firstElementChild;const Rt={vertices:[],normals:[],volumes:[],color:Tt};for(;Bt;){if(Bt.nodeName==="vertices"){const Ut=nt(Bt);Rt.normals=Rt.normals.concat(Ut.normals),Rt.vertices=Rt.vertices.concat(Ut.vertices)}else Bt.nodeName==="volume"&&Rt.volumes.push(tt(Bt));Bt=Bt.nextElementSibling}St.meshes.push(Rt)}Mt=Mt.nextElementSibling}return{id:Et,obj:St}}const it=o(s);let st="",at="";const ot=j(it),ct={},ft={},ht=it.documentElement.childNodes;let mt,lt;for(mt=0;mt<ht.length;mt++){const gt=ht[mt];if(gt.nodeName==="metadata")gt.attributes.type!==void 0&&(gt.attributes.type.value==="name"?st=gt.textContent:gt.attributes.type.value==="author"&&(at=gt.textContent));else if(gt.nodeName==="material"){const Et=$(gt);ct[Et.id]=Et.material}else if(gt.nodeName==="object"){const Et=rt(gt);ft[Et.id]=Et.obj}}const ut=new Group,dt=new MeshPhongMaterial({color:11184895,flatShading:!0});ut.name=st,ut.userData.author=at,ut.userData.loader="AMF";for(const gt in ft){const Et=ft[gt],St=Et.meshes,Tt=new Group;for(Tt.name=Et.name||"",mt=0;mt<St.length;mt++){let Mt=dt;const Bt=St[mt],Rt=new Float32BufferAttribute(Bt.vertices,3);let Ut=null;if(Bt.normals.length&&(Ut=new Float32BufferAttribute(Bt.normals,3)),Bt.color){const Wt=Bt.color;Mt=dt.clone(),Mt.color=new Color(Wt.r,Wt.g,Wt.b),Wt.a!==1&&(Mt.transparent=!0,Mt.opacity=Wt.a)}const Ht=Bt.volumes;for(lt=0;lt<Ht.length;lt++){const Wt=Ht[lt],Jt=new BufferGeometry;let sn=Mt;Jt.setIndex(Wt.triangles),Jt.setAttribute("position",Rt.clone()),Ut&&Jt.setAttribute("normal",Ut.clone()),ct[Wt.materialId]!==void 0&&(sn=ct[Wt.materialId]),Jt.scale(ot,ot,ot),Tt.add(new Mesh(Jt,sn.clone()))}}ut.add(Tt)}return ut}}class MMDLoader extends Loader{constructor(s){super(s),this.loader=new FileLoader(this.manager),this.parser=null,this.meshBuilder=new MeshBuilder(this.manager),this.animationBuilder=new AnimationBuilder}setAnimationPath(s){return this.animationPath=s,this}load(s,o,j,$){const _e=this.meshBuilder.setCrossOrigin(this.crossOrigin);let tt;this.resourcePath!==""?tt=this.resourcePath:this.path!==""?tt=this.path:tt=LoaderUtils.extractUrlBase(s);const nt=this._extractExtension(s).toLowerCase();if(nt!=="pmd"&&nt!=="pmx"){$&&$(new Error("THREE.MMDLoader: Unknown model file extension ."+nt+"."));return}this[nt==="pmd"?"loadPMD":"loadPMX"](s,function(rt){o(_e.build(rt,tt,j,$))},j,$)}loadAnimation(s,o,j,$,_e){const tt=this.animationBuilder;this.loadVMD(s,function(nt){j(o.isCamera?tt.buildCameraAnimation(nt):tt.build(nt,o))},$,_e)}loadWithAnimation(s,o,j,$,_e){const tt=this;this.load(s,function(nt){tt.loadAnimation(o,nt,function(rt){j({mesh:nt,animation:rt})},$,_e)},$,_e)}loadPMD(s,o,j,$){const _e=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(s,function(tt){o(_e.parsePmd(tt,!0))},j,$)}loadPMX(s,o,j,$){const _e=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(s,function(tt){o(_e.parsePmx(tt,!0))},j,$)}loadVMD(s,o,j,$){const _e=Array.isArray(s)?s:[s],tt=[],nt=_e.length,rt=this._getParser();this.loader.setMimeType(void 0).setPath(this.animationPath).setResponseType("arraybuffer").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials);for(let it=0,st=_e.length;it<st;it++)this.loader.load(_e[it],function(at){tt.push(rt.parseVmd(at,!0)),tt.length===nt&&o(rt.mergeVmds(tt))},j,$)}loadVPD(s,o,j,$,_e){const tt=this._getParser();this.loader.setMimeType(o?void 0:"text/plain; charset=shift_jis").setPath(this.animationPath).setResponseType("text").setRequestHeader(this.requestHeader).setWithCredentials(this.withCredentials).load(s,function(nt){j(tt.parseVpd(nt,!0))},$,_e)}_extractExtension(s){const o=s.lastIndexOf(".");return o<0?"":s.slice(o+1)}_getParser(){return this.parser===null&&(this.parser=new Parser),this.parser}}const DEFAULT_TOON_TEXTURES=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];class MeshBuilder{constructor(s){this.crossOrigin="anonymous",this.geometryBuilder=new GeometryBuilder,this.materialBuilder=new MaterialBuilder(s)}setCrossOrigin(s){return this.crossOrigin=s,this}build(s,o,j,$){const _e=this.geometryBuilder.build(s),tt=this.materialBuilder.setCrossOrigin(this.crossOrigin).setResourcePath(o).build(s,_e,j,$),nt=new SkinnedMesh(_e,tt),rt=new Skeleton(initBones(nt));return nt.bind(rt),nt}}function initBones(a){const s=a.geometry,o=[];if(s&&s.bones!==void 0){for(let j=0,$=s.bones.length;j<$;j++){const _e=s.bones[j],tt=new Bone;o.push(tt),tt.name=_e.name,tt.position.fromArray(_e.pos),tt.quaternion.fromArray(_e.rotq),_e.scl!==void 0&&tt.scale.fromArray(_e.scl)}for(let j=0,$=s.bones.length;j<$;j++){const _e=s.bones[j];_e.parent!==-1&&_e.parent!==null&&o[_e.parent]!==void 0?o[_e.parent].add(o[j]):a.add(o[j])}}return a.updateMatrixWorld(!0),o}class GeometryBuilder{build(s){const o=[],j=[],$=[],_e=[],tt=[],nt=[],rt=[],it=[],st=[],at=[],ot=[],ct=[],ft=[],ht=[];let mt=0;const lt={};for(let gt=0;gt<s.metadata.vertexCount;gt++){const Et=s.vertices[gt];for(let St=0,Tt=Et.position.length;St<Tt;St++)o.push(Et.position[St]);for(let St=0,Tt=Et.normal.length;St<Tt;St++)$.push(Et.normal[St]);for(let St=0,Tt=Et.uv.length;St<Tt;St++)j.push(Et.uv[St]);for(let St=0;St<4;St++)rt.push(Et.skinIndices.length-1>=St?Et.skinIndices[St]:0);for(let St=0;St<4;St++)it.push(Et.skinWeights.length-1>=St?Et.skinWeights[St]:0)}for(let gt=0;gt<s.metadata.faceCount;gt++){const Et=s.faces[gt];for(let St=0,Tt=Et.indices.length;St<Tt;St++)_e.push(Et.indices[St])}for(let gt=0;gt<s.metadata.materialCount;gt++){const Et=s.materials[gt];tt.push({offset:mt*3,count:Et.faceCount*3}),mt+=Et.faceCount}for(let gt=0;gt<s.metadata.rigidBodyCount;gt++){const Et=s.rigidBodies[gt];let St=lt[Et.boneIndex];St=St===void 0?Et.type:Math.max(Et.type,St),lt[Et.boneIndex]=St}for(let gt=0;gt<s.metadata.boneCount;gt++){const Et=s.bones[gt],St={index:gt,transformationClass:Et.transformationClass,parent:Et.parentIndex,name:Et.name,pos:Et.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:lt[gt]!==void 0?lt[gt]:-1};St.parent!==-1&&(St.pos[0]-=s.bones[St.parent].position[0],St.pos[1]-=s.bones[St.parent].position[1],St.pos[2]-=s.bones[St.parent].position[2]),nt.push(St)}if(s.metadata.format==="pmd")for(let gt=0;gt<s.metadata.ikCount;gt++){const Et=s.iks[gt],St={target:Et.target,effector:Et.effector,iteration:Et.iteration,maxAngle:Et.maxAngle*4,links:[]};for(let Tt=0,Mt=Et.links.length;Tt<Mt;Tt++){const Bt={};Bt.index=Et.links[Tt].index,Bt.enabled=!0,s.bones[Bt.index].name.indexOf("ひざ")>=0&&(Bt.limitation=new Vector3(1,0,0)),St.links.push(Bt)}ot.push(St)}else for(let gt=0;gt<s.metadata.boneCount;gt++){const Et=s.bones[gt].ik;if(Et===void 0)continue;const St={target:gt,effector:Et.effector,iteration:Et.iteration,maxAngle:Et.maxAngle,links:[]};for(let Tt=0,Mt=Et.links.length;Tt<Mt;Tt++){const Bt={};if(Bt.index=Et.links[Tt].index,Bt.enabled=!0,Et.links[Tt].angleLimitation===1){const Rt=Et.links[Tt].lowerLimitationAngle,Ut=Et.links[Tt].upperLimitationAngle,Ht=-Ut[0],Wt=-Ut[1];Ut[0]=-Rt[0],Ut[1]=-Rt[1],Rt[0]=Ht,Rt[1]=Wt,Bt.rotationMin=new Vector3().fromArray(Rt),Bt.rotationMax=new Vector3().fromArray(Ut)}St.links.push(Bt)}ot.push(St),nt[gt].ik=St}if(s.metadata.format==="pmx"){let gt=function(Tt){Tt.param&&(ct.push(Tt.param),nt[Tt.param.index].grant=Tt.param),Tt.visited=!0;for(let Mt=0,Bt=Tt.children.length;Mt<Bt;Mt++){const Rt=Tt.children[Mt];Rt.visited||gt(Rt)}};const Et={};for(let Tt=0;Tt<s.metadata.boneCount;Tt++){const Mt=s.bones[Tt],Bt=Mt.grant;if(Bt===void 0)continue;const Rt={index:Tt,parentIndex:Bt.parentIndex,ratio:Bt.ratio,isLocal:Bt.isLocal,affectRotation:Bt.affectRotation,affectPosition:Bt.affectPosition,transformationClass:Mt.transformationClass};Et[Tt]={parent:null,children:[],param:Rt,visited:!1}}const St={parent:null,children:[],param:null,visited:!1};for(const Tt in Et){const Mt=Et[Tt],Bt=Et[Mt.parentIndex]||St;Mt.parent=Bt,Bt.children.push(Mt)}gt(St)}function ut(gt,Et,St){for(let Tt=0;Tt<Et.elementCount;Tt++){const Mt=Et.elements[Tt];let Bt;s.metadata.format==="pmd"?Bt=s.morphs[0].elements[Mt.index].index:Bt=Mt.index,gt.array[Bt*3+0]+=Mt.position[0]*St,gt.array[Bt*3+1]+=Mt.position[1]*St,gt.array[Bt*3+2]+=Mt.position[2]*St}}for(let gt=0;gt<s.metadata.morphCount;gt++){const Et=s.morphs[gt],St={name:Et.name},Tt=new Float32BufferAttribute(s.metadata.vertexCount*3,3);Tt.name=Et.name;for(let Mt=0;Mt<s.metadata.vertexCount*3;Mt++)Tt.array[Mt]=o[Mt];if(s.metadata.format==="pmd")gt!==0&&ut(Tt,Et,1);else if(Et.type===0)for(let Mt=0;Mt<Et.elementCount;Mt++){const Bt=s.morphs[Et.elements[Mt].index],Rt=Et.elements[Mt].ratio;Bt.type===1&&ut(Tt,Bt,Rt)}else Et.type===1?ut(Tt,Et,1):Et.type===2||Et.type===3||Et.type===4||Et.type===5||Et.type===6||Et.type===7||Et.type;st.push(St),at.push(Tt)}for(let gt=0;gt<s.metadata.rigidBodyCount;gt++){const Et=s.rigidBodies[gt],St={};for(const Tt in Et)St[Tt]=Et[Tt];if(s.metadata.format==="pmx"&&St.boneIndex!==-1){const Tt=s.bones[St.boneIndex];St.position[0]-=Tt.position[0],St.position[1]-=Tt.position[1],St.position[2]-=Tt.position[2]}ft.push(St)}for(let gt=0;gt<s.metadata.constraintCount;gt++){const Et=s.constraints[gt],St={};for(const Bt in Et)St[Bt]=Et[Bt];const Tt=ft[St.rigidBodyIndex1],Mt=ft[St.rigidBodyIndex2];Tt.type!==0&&Mt.type===2&&Tt.boneIndex!==-1&&Mt.boneIndex!==-1&&s.bones[Mt.boneIndex].parentIndex===Tt.boneIndex&&(Mt.type=1),ht.push(St)}const dt=new BufferGeometry;dt.setAttribute("position",new Float32BufferAttribute(o,3)),dt.setAttribute("normal",new Float32BufferAttribute($,3)),dt.setAttribute("uv",new Float32BufferAttribute(j,2)),dt.setAttribute("skinIndex",new Uint16BufferAttribute(rt,4)),dt.setAttribute("skinWeight",new Float32BufferAttribute(it,4)),dt.setIndex(_e);for(let gt=0,Et=tt.length;gt<Et;gt++)dt.addGroup(tt[gt].offset,tt[gt].count,gt);return dt.bones=nt,dt.morphTargets=st,dt.morphAttributes.position=at,dt.morphTargetsRelative=!1,dt.userData.MMD={bones:nt,iks:ot,grants:ct,rigidBodies:ft,constraints:ht,format:s.metadata.format},dt.computeBoundingSphere(),dt}}class MaterialBuilder{constructor(s){this.manager=s,this.textureLoader=new TextureLoader(this.manager),this.tgaLoader=null,this.crossOrigin="anonymous",this.resourcePath=void 0}setCrossOrigin(s){return this.crossOrigin=s,this}setResourcePath(s){return this.resourcePath=s,this}build(s,o){const j=[],$={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(let _e=0;_e<s.metadata.materialCount;_e++){const tt=s.materials[_e],nt={userData:{}};if(tt.name!==void 0&&(nt.name=tt.name),nt.color=new Color().fromArray(tt.diffuse),nt.opacity=tt.diffuse[3],nt.emissive=new Color().fromArray(tt.ambient),nt.transparent=nt.opacity!==1,nt.skinning=o.bones.length>0,nt.morphTargets=o.morphTargets.length>0,nt.fog=!0,nt.blending=CustomBlending,nt.blendSrc=SrcAlphaFactor,nt.blendDst=OneMinusSrcAlphaFactor,nt.blendSrcAlpha=SrcAlphaFactor,nt.blendDstAlpha=DstAlphaFactor,s.metadata.format==="pmx"&&(tt.flag&1)===1?nt.side=DoubleSide:nt.side=nt.opacity===1?FrontSide:DoubleSide,s.metadata.format==="pmd"){if(tt.fileName){const st=tt.fileName.split("*");if(nt.map=this._loadTexture(st[0],$),st.length>1){const at=st[1].slice(-4).toLowerCase();nt.envMap=this._loadTexture(st[1],$),nt.combine=at===".sph"?MultiplyOperation:AddOperation}}const rt=tt.toonIndex===-1?"toon00.bmp":s.toonTextures[tt.toonIndex].fileName;nt.gradientMap=this._loadTexture(rt,$,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(rt)}),nt.userData.outlineParameters={thickness:tt.edgeFlag===1?.003:0,color:[0,0,0],alpha:1,visible:tt.edgeFlag===1}}else{tt.textureIndex!==-1&&(nt.map=this._loadTexture(s.textures[tt.textureIndex],$)),tt.envTextureIndex!==-1&&(tt.envFlag===1||tt.envFlag==2)&&(nt.envMap=this._loadTexture(s.textures[tt.envTextureIndex],$),nt.combine=tt.envFlag===1?MultiplyOperation:AddOperation);let rt,it;tt.toonIndex===-1||tt.toonFlag!==0?(rt="toon"+("0"+(tt.toonIndex+1)).slice(-2)+".bmp",it=!0):(rt=s.textures[tt.toonIndex],it=!1),nt.gradientMap=this._loadTexture(rt,$,{isToonTexture:!0,isDefaultToonTexture:it}),nt.userData.outlineParameters={thickness:tt.edgeSize/300,color:tt.edgeColor.slice(0,3),alpha:tt.edgeColor[3],visible:(tt.flag&16)!==0&&tt.edgeSize>0}}nt.map!==void 0&&(nt.transparent||this._checkImageTransparency(nt.map,o,_e),nt.emissive.multiplyScalar(.2)),j.push(new MeshToonMaterial(nt))}if(s.metadata.format==="pmx"){let _e=function(tt,nt){for(let rt=0,it=tt.length;rt<it;rt++){const st=tt[rt];if(st.index===-1)continue;const at=nt[st.index];at.opacity!==st.diffuse[3]&&(at.transparent=!0)}};for(let tt=0,nt=s.morphs.length;tt<nt;tt++){const rt=s.morphs[tt],it=rt.elements;if(rt.type===0)for(let st=0,at=it.length;st<at;st++){const ot=s.morphs[it[st].index];ot.type===8&&_e(ot.elements,j)}else rt.type===8&&_e(it,j)}}return j}_getTGALoader(){if(this.tgaLoader===null){if(TGALoader===void 0)throw new Error("THREE.MMDLoader: Import TGALoader");this.tgaLoader=new TGALoader(this.manager)}return this.tgaLoader}_isDefaultToonTexture(s){return s.length!==10?!1:/toon(10|0[0-9])\.bmp/.test(s)}_loadTexture(s,o,j,$,_e){j=j||{};const tt=this;let nt;if(j.isDefaultToonTexture===!0){let st;try{st=parseInt(s.match(/toon([0-9]{2})\.bmp$/)[1])}catch{console.warn("THREE.MMDLoader: "+s+" seems like a not right default texture path. Using toon00.bmp instead."),st=0}nt=DEFAULT_TOON_TEXTURES[st]}else nt=this.resourcePath+s;if(o[nt]!==void 0)return o[nt];let rt=this.manager.getHandler(nt);rt===null&&(rt=s.slice(-4).toLowerCase()===".tga"?this._getTGALoader():this.textureLoader);const it=rt.load(nt,function(st){j.isToonTexture===!0&&(st.image=tt._getRotatedImage(st.image),st.magFilter=NearestFilter,st.minFilter=NearestFilter),st.flipY=!1,st.wrapS=RepeatWrapping,st.wrapT=RepeatWrapping;for(let at=0;at<it.readyCallbacks.length;at++)it.readyCallbacks[at](it);delete it.readyCallbacks},$,_e);return it.readyCallbacks=[],o[nt]=it,it}_getRotatedImage(s){const o=document.createElement("canvas"),j=o.getContext("2d"),$=s.width,_e=s.height;return o.width=$,o.height=_e,j.clearRect(0,0,$,_e),j.translate($/2,_e/2),j.rotate(.5*Math.PI),j.translate(-$/2,-_e/2),j.drawImage(s,0,0),j.getImageData(0,0,$,_e)}_checkImageTransparency(s,o,j){s.readyCallbacks.push(function($){function _e(st){const at=document.createElement("canvas");at.width=st.width,at.height=st.height;const ot=at.getContext("2d");return ot.drawImage(st,0,0),ot.getImageData(0,0,at.width,at.height)}function tt(st,at,ot){const ct=st.width,ft=st.height,ht=st.data,mt=253;if(ht.length/(ct*ft)!==4)return!1;for(let lt=0;lt<ot.length;lt+=3){const ut={x:0,y:0};for(let dt=0;dt<3;dt++){const gt=ot[lt*3+dt],Et={x:at[gt*2+0],y:at[gt*2+1]};if(nt(st,Et)<mt)return!0;ut.x+=Et.x,ut.y+=Et.y}if(ut.x/=3,ut.y/=3,nt(st,ut)<mt)return!0}return!1}function nt(st,at){const ot=st.width,ct=st.height;let ft=Math.round(at.x*ot)%ot,ht=Math.round(at.y*ct)%ct;ft<0&&(ft+=ot),ht<0&&(ht+=ct);const mt=ht*ot+ft;return st.data[mt*4+3]}const rt=$.image.data!==void 0?$.image:_e($.image),it=o.groups[j];tt(rt,o.attributes.uv.array,o.index.array.slice(it.start,it.start+it.count))&&(s.transparent=!0)})}}class AnimationBuilder{build(s,o){const j=this.buildSkeletalAnimation(s,o).tracks,$=this.buildMorphAnimation(s,o).tracks;for(let _e=0,tt=$.length;_e<tt;_e++)j.push($[_e]);return new AnimationClip("",-1,j)}buildSkeletalAnimation(s,o){function j(rt,it,st){rt.push(it[st+0]/127),rt.push(it[st+8]/127),rt.push(it[st+4]/127),rt.push(it[st+12]/127)}const $=[],_e={},tt=o.skeleton.bones,nt={};for(let rt=0,it=tt.length;rt<it;rt++)nt[tt[rt].name]=!0;for(let rt=0;rt<s.metadata.motionCount;rt++){const it=s.motions[rt],st=it.boneName;nt[st]!==void 0&&(_e[st]=_e[st]||[],_e[st].push(it))}for(const rt in _e){const it=_e[rt];it.sort(function(lt,ut){return lt.frameNum-ut.frameNum});const st=[],at=[],ot=[],ct=[],ft=[],ht=o.skeleton.getBoneByName(rt).position.toArray();for(let lt=0,ut=it.length;lt<ut;lt++){const dt=it[lt].frameNum/30,gt=it[lt].position,Et=it[lt].rotation,St=it[lt].interpolation;st.push(dt);for(let Tt=0;Tt<3;Tt++)at.push(ht[Tt]+gt[Tt]);for(let Tt=0;Tt<4;Tt++)ot.push(Et[Tt]);for(let Tt=0;Tt<3;Tt++)j(ct,St,Tt);j(ft,St,3)}const mt=".bones["+rt+"]";$.push(this._createTrack(mt+".position",VectorKeyframeTrack,st,at,ct)),$.push(this._createTrack(mt+".quaternion",QuaternionKeyframeTrack,st,ot,ft))}return new AnimationClip("",-1,$)}buildMorphAnimation(s,o){const j=[],$={},_e=o.morphTargetDictionary;for(let tt=0;tt<s.metadata.morphCount;tt++){const nt=s.morphs[tt],rt=nt.morphName;_e[rt]!==void 0&&($[rt]=$[rt]||[],$[rt].push(nt))}for(const tt in $){const nt=$[tt];nt.sort(function(st,at){return st.frameNum-at.frameNum});const rt=[],it=[];for(let st=0,at=nt.length;st<at;st++)rt.push(nt[st].frameNum/30),it.push(nt[st].weight);j.push(new NumberKeyframeTrack(".morphTargetInfluences["+_e[tt]+"]",rt,it))}return new AnimationClip("",-1,j)}buildCameraAnimation(s){function o(gt,Et){gt.push(Et.x),gt.push(Et.y),gt.push(Et.z)}function j(gt,Et){gt.push(Et.x),gt.push(Et.y),gt.push(Et.z),gt.push(Et.w)}function $(gt,Et,St){gt.push(Et[St*4+0]/127),gt.push(Et[St*4+1]/127),gt.push(Et[St*4+2]/127),gt.push(Et[St*4+3]/127)}const _e=s.cameras===void 0?[]:s.cameras.slice();_e.sort(function(gt,Et){return gt.frameNum-Et.frameNum});const tt=[],nt=[],rt=[],it=[],st=[],at=[],ot=[],ct=[],ft=[],ht=new Quaternion,mt=new Euler,lt=new Vector3,ut=new Vector3;for(let gt=0,Et=_e.length;gt<Et;gt++){const St=_e[gt],Tt=St.frameNum/30,Mt=St.position,Bt=St.rotation,Rt=St.distance,Ut=St.fov,Ht=St.interpolation;tt.push(Tt),lt.set(0,0,-Rt),ut.set(Mt[0],Mt[1],Mt[2]),mt.set(-Bt[0],-Bt[1],-Bt[2]),ht.setFromEuler(mt),lt.add(ut),lt.applyQuaternion(ht),o(nt,ut),j(rt,ht),o(it,lt),st.push(Ut);for(let Wt=0;Wt<3;Wt++)$(at,Ht,Wt);$(ot,Ht,3);for(let Wt=0;Wt<3;Wt++)$(ct,Ht,4);$(ft,Ht,5)}const dt=[];return dt.push(this._createTrack("target.position",VectorKeyframeTrack,tt,nt,at)),dt.push(this._createTrack(".quaternion",QuaternionKeyframeTrack,tt,rt,ot)),dt.push(this._createTrack(".position",VectorKeyframeTrack,tt,it,ct)),dt.push(this._createTrack(".fov",NumberKeyframeTrack,tt,st,ft)),new AnimationClip("",-1,dt)}_createTrack(s,o,j,$,_e){if(j.length>2){j=j.slice(),$=$.slice(),_e=_e.slice();const nt=$.length/j.length,rt=_e.length/j.length;let it=1;for(let st=2,at=j.length;st<at;st++){for(let ot=0;ot<nt;ot++)if($[it*nt+ot]!==$[(it-1)*nt+ot]||$[it*nt+ot]!==$[st*nt+ot]){it++;break}if(st>it){j[it]=j[st];for(let ot=0;ot<nt;ot++)$[it*nt+ot]=$[st*nt+ot];for(let ot=0;ot<rt;ot++)_e[it*rt+ot]=_e[st*rt+ot]}}j.length=it+1,$.length=(it+1)*nt,_e.length=(it+1)*rt}const tt=new o(s,j,$);return tt.createInterpolant=function(rt){return new CubicBezierInterpolation(this.times,this.values,this.getValueSize(),rt,new Float32Array(_e))},tt}}class CubicBezierInterpolation extends Interpolant{constructor(s,o,j,$,_e){super(s,o,j,$),this.interpolationParams=_e}interpolate_(s,o,j,$){const _e=this.resultBuffer,tt=this.sampleValues,nt=this.valueSize,rt=this.interpolationParams,it=s*nt,st=it-nt,at=$-o<1/30*1.5?0:(j-o)/($-o);if(nt===4){const ot=rt[s*4+0],ct=rt[s*4+1],ft=rt[s*4+2],ht=rt[s*4+3],mt=this._calculate(ot,ct,ft,ht,at);Quaternion.slerpFlat(_e,0,tt,st,tt,it,mt)}else if(nt===3)for(let ot=0;ot!==nt;++ot){const ct=rt[s*12+ot*4+0],ft=rt[s*12+ot*4+1],ht=rt[s*12+ot*4+2],mt=rt[s*12+ot*4+3],lt=this._calculate(ct,ft,ht,mt,at);_e[ot]=tt[st+ot]*(1-lt)+tt[it+ot]*lt}else{const ot=rt[s*4+0],ct=rt[s*4+1],ft=rt[s*4+2],ht=rt[s*4+3],mt=this._calculate(ot,ct,ft,ht,at);_e[0]=tt[st]*(1-mt)+tt[it]*mt}return _e}_calculate(s,o,j,$,_e){let tt=.5,nt=tt,rt=1-nt;const it=15,st=1e-5,at=Math;let ot,ct,ft;for(let ht=0;ht<it;ht++){ot=3*rt*rt*nt,ct=3*rt*nt*nt,ft=nt*nt*nt;const mt=ot*s+ct*o+ft-_e;if(at.abs(mt)<st)break;tt/=2,nt+=mt<0?tt:-tt,rt=1-nt}return ot*j+ct*$+ft}}class KTXLoader extends CompressedTextureLoader{constructor(s){super(s)}parse(s,o){const j=new KhronosTextureContainer(s,1);return{mipmaps:j.mipmaps(o),width:j.pixelWidth,height:j.pixelHeight,format:j.glInternalFormat,isCubemap:j.numberOfFaces===6,mipmapCount:j.numberOfMipmapLevels}}}const HEADER_LEN=12+13*4,COMPRESSED_2D=0;class KhronosTextureContainer{constructor(s,o){this.arrayBuffer=s;const j=new Uint8Array(this.arrayBuffer,0,12);if(j[0]!==171||j[1]!==75||j[2]!==84||j[3]!==88||j[4]!==32||j[5]!==49||j[6]!==49||j[7]!==187||j[8]!==13||j[9]!==10||j[10]!==26||j[11]!==10){console.error("texture missing KTX identifier");return}const $=Uint32Array.BYTES_PER_ELEMENT,_e=new DataView(this.arrayBuffer,12,13*$),nt=_e.getUint32(0,!0)===67305985;if(this.glType=_e.getUint32(1*$,nt),this.glTypeSize=_e.getUint32(2*$,nt),this.glFormat=_e.getUint32(3*$,nt),this.glInternalFormat=_e.getUint32(4*$,nt),this.glBaseInternalFormat=_e.getUint32(5*$,nt),this.pixelWidth=_e.getUint32(6*$,nt),this.pixelHeight=_e.getUint32(7*$,nt),this.pixelDepth=_e.getUint32(8*$,nt),this.numberOfArrayElements=_e.getUint32(9*$,nt),this.numberOfFaces=_e.getUint32(10*$,nt),this.numberOfMipmapLevels=_e.getUint32(11*$,nt),this.bytesOfKeyValueData=_e.getUint32(12*$,nt),this.glType!==0){console.warn("only compressed formats currently supported");return}else this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels);if(this.pixelHeight===0||this.pixelDepth!==0){console.warn("only 2D textures currently supported");return}if(this.numberOfArrayElements!==0){console.warn("texture arrays not currently supported");return}if(this.numberOfFaces!==o){console.warn("number of faces expected"+o+", but found "+this.numberOfFaces);return}this.loadType=COMPRESSED_2D}mipmaps(s){const o=[];let j=HEADER_LEN+this.bytesOfKeyValueData,$=this.pixelWidth,_e=this.pixelHeight;const tt=s?this.numberOfMipmapLevels:1;for(let nt=0;nt<tt;nt++){const rt=new Int32Array(this.arrayBuffer,j,1)[0];j+=4;for(let it=0;it<this.numberOfFaces;it++){const st=new Uint8Array(this.arrayBuffer,j,rt);o.push({data:st,width:$,height:_e}),j+=rt,j+=3-(rt+3)%4}$=Math.max(1,$*.5),_e=Math.max(1,_e*.5)}return o}}class TiltLoader extends Loader{load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=new Group,j=unzipSync(new Uint8Array(s.slice(16))),$=JSON.parse(strFromU8(j["metadata.json"])),_e=new DataView(j["data.sketch"].buffer),tt=_e.getInt32(16,!0),nt={};let rt=20;for(let it=0;it<tt;it++){const st=_e.getInt32(rt,!0),at=[_e.getFloat32(rt+4,!0),_e.getFloat32(rt+8,!0),_e.getFloat32(rt+12,!0),_e.getFloat32(rt+16,!0)],ot=_e.getFloat32(rt+20,!0),ct=_e.getUint32(rt+24,!0),ft=_e.getUint32(rt+28,!0);let ht=0,mt=0;for(let gt=0;gt<4;gt++){const Et=1<<gt;(ct&Et)>0&&(ht+=4),(ft&Et)>0&&(mt+=4)}rt=rt+28+ht+4;const lt=_e.getInt32(rt,!0),ut=new Float32Array(lt*3),dt=new Float32Array(lt*4);rt=rt+4;for(let gt=0,Et=0;gt<ut.length;gt+=3,Et+=4)ut[gt+0]=_e.getFloat32(rt+0,!0),ut[gt+1]=_e.getFloat32(rt+4,!0),ut[gt+2]=_e.getFloat32(rt+8,!0),dt[Et+0]=_e.getFloat32(rt+12,!0),dt[Et+1]=_e.getFloat32(rt+16,!0),dt[Et+2]=_e.getFloat32(rt+20,!0),dt[Et+3]=_e.getFloat32(rt+24,!0),rt=rt+28+mt;st in nt||(nt[st]=[]),nt[st].push([ut,dt,ot,at])}for(const it in nt){const st=new StrokeGeometry(nt[it]),at=getMaterial($.BrushIndex[it]);o.add(new Mesh(st,at))}return o}}class StrokeGeometry extends BufferGeometry{constructor(s){super();const o=[],j=[],$=[],_e=new Vector3,tt=new Vector3,nt=new Quaternion,rt=new Quaternion,it=new Vector3,st=new Vector3,at=new Vector3,ot=new Vector3;for(const ct in s){const ft=s[ct],ht=ft[0],mt=ft[1],lt=ft[2],ut=ft[3];tt.fromArray(ht,0),rt.fromArray(mt,0);for(let dt=3,gt=4,Et=ht.length;dt<Et;dt+=3,gt+=4){_e.fromArray(ht,dt),nt.fromArray(mt,gt),it.set(-lt,0,0),it.applyQuaternion(nt),it.add(_e),st.set(lt,0,0),st.applyQuaternion(nt),st.add(_e),at.set(lt,0,0),at.applyQuaternion(rt),at.add(tt),ot.set(-lt,0,0),ot.applyQuaternion(rt),ot.add(tt),o.push(it.x,it.y,-it.z),o.push(st.x,st.y,-st.z),o.push(ot.x,ot.y,-ot.z),o.push(st.x,st.y,-st.z),o.push(at.x,at.y,-at.z),o.push(ot.x,ot.y,-ot.z),tt.copy(_e),rt.copy(nt),j.push(...ut),j.push(...ut),j.push(...ut),j.push(...ut),j.push(...ut),j.push(...ut);const St=dt/Et,Tt=(dt-3)/Et;$.push(St,0),$.push(St,1),$.push(Tt,0),$.push(St,1),$.push(Tt,1),$.push(Tt,0)}}this.setAttribute("position",new BufferAttribute(new Float32Array(o),3)),this.setAttribute("color",new BufferAttribute(new Float32Array(j),4)),this.setAttribute("uv",new BufferAttribute(new Float32Array($),2))}}const BRUSH_LIST_ARRAY={"89d104cd-d012-426b-b5b3-bbaee63ac43c":"Bubbles","700f3aa8-9a7c-2384-8b8a-ea028905dd8c":"CelVinyl","0f0ff7b2-a677-45eb-a7d6-0cd7206f4816":"ChromaticWave","1161af82-50cf-47db-9706-0c3576d43c43":"CoarseBristles","79168f10-6961-464a-8be1-57ed364c5600":"CoarseBristlesSingleSided","1caa6d7d-f015-3f54-3a4b-8b5354d39f81":"Comet","c8313697-2563-47fc-832e-290f4c04b901":"DiamondHull","4391aaaa-df73-4396-9e33-31e4e4930b27":"Disco","d1d991f2-e7a0-4cf1-b328-f57e915e6260":"DotMarker","6a1cf9f9-032c-45ec-9b1d-a6680bee30f7":"Dots","0d3889f3-3ede-470c-8af4-f44813306126":"DoubleTaperedFlat","0d3889f3-3ede-470c-8af4-de4813306126":"DoubleTaperedMarker","d0262945-853c-4481-9cbd-88586bed93cb":"DuctTape","3ca16e2f-bdcd-4da2-8631-dcef342f40f1":"DuctTapeSingleSided","f6e85de3-6dcc-4e7f-87fd-cee8c3d25d51":"Electricity","02ffb866-7fb2-4d15-b761-1012cefb1360":"Embers","cb92b597-94ca-4255-b017-0e3f42f12f9e":"Fire","2d35bcf0-e4d8-452c-97b1-3311be063130":"Flat","55303bc4-c749-4a72-98d9-d23e68e76e18":"FlatDeprecated","280c0a7a-aad8-416c-a7d2-df63d129ca70":"FlatSingleSided","cf019139-d41c-4eb0-a1d0-5cf54b0a42f3":"Highlighter","6a1cf9f9-032c-45ec-9b6e-a6680bee32e9":"HyperGrid","dce872c2-7b49-4684-b59b-c45387949c5c":"Hypercolor","e8ef32b1-baa8-460a-9c2c-9cf8506794f5":"HypercolorSingleSided","2f212815-f4d3-c1a4-681a-feeaf9c6dc37":"Icing","f5c336cf-5108-4b40-ade9-c687504385ab":"Ink","c0012095-3ffd-4040-8ee1-fc180d346eaa":"InkSingleSided","4a76a27a-44d8-4bfe-9a8c-713749a499b0":"Leaves","ea19de07-d0c0-4484-9198-18489a3c1487":"LeavesSingleSided","2241cd32-8ba2-48a5-9ee7-2caef7e9ed62":"Light","4391aaaa-df81-4396-9e33-31e4e4930b27":"LightWire","d381e0f5-3def-4a0d-8853-31e9200bcbda":"Lofted","429ed64a-4e97-4466-84d3-145a861ef684":"Marker","79348357-432d-4746-8e29-0e25c112e3aa":"MatteHull","b2ffef01-eaaa-4ab5-aa64-95a2c4f5dbc6":"NeonPulse","f72ec0e7-a844-4e38-82e3-140c44772699":"OilPaint","c515dad7-4393-4681-81ad-162ef052241b":"OilPaintSingleSided","f1114e2e-eb8d-4fde-915a-6e653b54e9f5":"Paper","759f1ebd-20cd-4720-8d41-234e0da63716":"PaperSingleSided","e0abbc80-0f80-e854-4970-8924a0863dcc":"Petal","c33714d1-b2f9-412e-bd50-1884c9d46336":"Plasma","ad1ad437-76e2-450d-a23a-e17f8310b960":"Rainbow","faaa4d44-fcfb-4177-96be-753ac0421ba3":"ShinyHull","70d79cca-b159-4f35-990c-f02193947fe8":"Smoke","d902ed8b-d0d1-476c-a8de-878a79e3a34c":"Snow","accb32f5-4509-454f-93f8-1df3fd31df1b":"SoftHighlighter","cf7f0059-7aeb-53a4-2b67-c83d863a9ffa":"Spikes","8dc4a70c-d558-4efd-a5ed-d4e860f40dc3":"Splatter","7a1c8107-50c5-4b70-9a39-421576d6617e":"SplatterSingleSided","0eb4db27-3f82-408d-b5a1-19ebd7d5b711":"Stars","44bb800a-fbc3-4592-8426-94ecb05ddec3":"Streamers","0077f88c-d93a-42f3-b59b-b31c50cdb414":"Taffy","b468c1fb-f254-41ed-8ec9-57030bc5660c":"TaperedFlat","c8ccb53d-ae13-45ef-8afb-b730d81394eb":"TaperedFlatSingleSided","d90c6ad8-af0f-4b54-b422-e0f92abe1b3c":"TaperedMarker","1a26b8c0-8a07-4f8a-9fac-d2ef36e0cad0":"TaperedMarker_Flat","75b32cf0-fdd6-4d89-a64b-e2a00b247b0f":"ThickPaint","fdf0326a-c0d1-4fed-b101-9db0ff6d071f":"ThickPaintSingleSided","4391385a-df73-4396-9e33-31e4e4930b27":"Toon","a8fea537-da7c-4d4b-817f-24f074725d6d":"UnlitHull","d229d335-c334-495a-a801-660ac8a87360":"VelvetInk","10201aa3-ebc2-42d8-84b7-2e63f6eeb8ab":"Waveform","b67c0e81-ce6d-40a8-aeb0-ef036b081aa3":"WetPaint","dea67637-cd1a-27e4-c9b1-52f4bbcb84e5":"WetPaintSingleSided","5347acf0-a8e2-47b6-8346-30c70719d763":"WigglyGraphite","e814fef1-97fd-7194-4a2f-50c2bb918be2":"WigglyGraphiteSingleSided","4391385a-cf83-4396-9e33-31e4e4930b27":"Wire"},common$2={colors:{BloomColor:`
			vec3 BloomColor(vec3 color, float gain) {
				// Guarantee that there's at least a little bit of all 3 channels.
				// This makes fully-saturated strokes (which only have 2 non-zero
				// color channels) eventually clip to white rather than to a secondary.
				float cmin = length(color.rgb) * .05;
				color.rgb = max(color.rgb, vec3(cmin, cmin, cmin));
				// If we try to remove this pow() from .a, it brightens up
				// pressure-sensitive strokes; looks better as-is.
				color = pow(color, vec3(2.2));
				color.rgb *= 2. * exp(gain * 10.);
				return color;
			}
		`,LinearToSrgb:`
			vec3 LinearToSrgb(vec3 color) {
				// Approximation http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html
				vec3 linearColor = color.rgb;
				vec3 S1 = sqrt(linearColor);
				vec3 S2 = sqrt(S1);
				vec3 S3 = sqrt(S2);
				color.rgb = 0.662002687 * S1 + 0.684122060 * S2 - 0.323583601 * S3 - 0.0225411470 * linearColor;
				return color;
			}
		`,hsv:`
			// uniform sampler2D lookupTex;
			vec4 lookup(vec4 textureColor) {
				return textureColor;
			}

			vec3 lookup(vec3 textureColor) {
				return textureColor;
			}

			vec3 hsv2rgb( vec3 hsv ) {
				vec3 rgb = clamp( abs(mod(hsv.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0 );
				return hsv.z * mix( vec3(1.0), rgb, hsv.y);
			}

			vec3 rgb2hsv( vec3 rgb ) {
				vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
				vec4 p = mix(vec4(rgb.bg, K.wz), vec4(rgb.gb, K.xy), step(rgb.b, rgb.g));
				vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));

				float d = q.x - min(q.w, q.y);
				float e = 1.0e-10;

				return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
			}
		`,SrgbToLinear:`
			vec3 SrgbToLinear(vec3 color) {
				// Approximation http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html
				vec3 sRGB = color.rgb;
				color.rgb = sRGB * (sRGB * (sRGB * 0.305306011 + 0.682171111) + 0.012522878);
				return color;
			}
		`}},shaders=()=>({Light:{uniforms:{mainTex:{value:new TextureLoader().setPath("./textures/tiltbrush/").loader.load("Light.webp")},alphaTest:{value:.067},emission_gain:{value:.45},alpha:{value:1}},vertexShader:`
			precision highp float;
			precision highp int;

			attribute vec2 uv;
			attribute vec4 color;
			attribute vec3 position;

			uniform mat4 modelMatrix;
			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;
			uniform mat4 viewMatrix;
			uniform mat3 normalMatrix;
			uniform vec3 cameraPosition;

			varying vec2 vUv;
			varying vec3 vColor;

			${common$2.colors.LinearToSrgb}
			${common$2.colors.hsv}

			void main() {

				vUv = uv;

				vColor = lookup(color.rgb);

				vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

				gl_Position = projectionMatrix * mvPosition;

			}
		`,fragmentShader:`
			precision highp float;
			precision highp int;

			uniform float emission_gain;

			uniform sampler2D mainTex;
			uniform float alphaTest;

			varying vec2 vUv;
			varying vec3 vColor;

			${common$2.colors.BloomColor}
			${common$2.colors.SrgbToLinear}

			void main(){
				vec4 col = texture2D(mainTex, vUv);
				vec3 color = vColor;
				color = BloomColor(color, emission_gain);
				color = color * col.rgb;
				color = color * col.a;
				color = SrgbToLinear(color);
				gl_FragColor = vec4(color, 1.0);
			}
		`,side:2,transparent:!0,depthFunc:2,depthWrite:!0,depthTest:!1,blending:5,blendDst:201,blendDstAlpha:201,blendEquation:100,blendEquationAlpha:100,blendSrc:201,blendSrcAlpha:201}});function getMaterial(a){switch(BRUSH_LIST_ARRAY[a]){case"Light":return new RawShaderMaterial(shaders().Light);default:return new MeshBasicMaterial({vertexColors:!0,side:DoubleSide})}}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(s){super(s),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(s){return this.decoderPath=s,this}setDecoderConfig(s){return this.decoderConfig=s,this}setWorkerLimit(s){return this.workerLimit=s,this}load(s,o,j,$){const _e=new FileLoader(this.manager);_e.setPath(this.path),_e.setResponseType("arraybuffer"),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials),_e.load(s,tt=>{const nt={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(tt,nt).then(o).catch($)},j,$)}decodeDracoFile(s,o,j,$){const _e={attributeIDs:j||this.defaultAttributeIDs,attributeTypes:$||this.defaultAttributeTypes,useUniqueIDs:!!j};this.decodeGeometry(s,_e).then(o)}decodeGeometry(s,o){for(const rt in o.attributeTypes){const it=o.attributeTypes[rt];it.BYTES_PER_ELEMENT!==void 0&&(o.attributeTypes[rt]=it.name)}const j=JSON.stringify(o);if(_taskCache.has(s)){const rt=_taskCache.get(s);if(rt.key===j)return rt.promise;if(s.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let $;const _e=this.workerNextTaskID++,tt=s.byteLength,nt=this._getWorker(_e,tt).then(rt=>($=rt,new Promise((it,st)=>{$._callbacks[_e]={resolve:it,reject:st},$.postMessage({type:"decode",id:_e,taskConfig:o,buffer:s},[s])}))).then(rt=>this._createGeometry(rt.geometry));return nt.catch(()=>!0).then(()=>{$&&_e&&this._releaseTask($,_e)}),_taskCache.set(s,{key:j,promise:nt}),nt}_createGeometry(s){const o=new BufferGeometry;s.index&&o.setIndex(new BufferAttribute(s.index.array,1));for(let j=0;j<s.attributes.length;j++){const $=s.attributes[j],_e=$.name,tt=$.array,nt=$.itemSize;o.setAttribute(_e,new BufferAttribute(tt,nt))}return o}_loadLibrary(s,o){const j=new FileLoader(this.manager);return j.setPath(this.decoderPath),j.setResponseType(o),j.setWithCredentials(this.withCredentials),new Promise(($,_e)=>{j.load(s,$,void 0,_e)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const s=typeof WebAssembly!="object"||this.decoderConfig.type==="js",o=[];return s?o.push(this._loadLibrary("draco_decoder.js","text")):(o.push(this._loadLibrary("draco_wasm_wrapper.js","text")),o.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(o).then(j=>{const $=j[0];s||(this.decoderConfig.wasmBinary=j[1]);const _e=DRACOWorker.toString(),tt=["/* draco decoder */",$,"","/* worker */",_e.substring(_e.indexOf("{")+1,_e.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([tt]))}),this.decoderPending}_getWorker(s,o){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const $=new Worker(this.workerSourceURL);$._callbacks={},$._taskCosts={},$._taskLoad=0,$.postMessage({type:"init",decoderConfig:this.decoderConfig}),$.onmessage=function(_e){const tt=_e.data;switch(tt.type){case"decode":$._callbacks[tt.id].resolve(tt);break;case"error":$._callbacks[tt.id].reject(tt);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+tt.type+'"')}},this.workerPool.push($)}else this.workerPool.sort(function($,_e){return $._taskLoad>_e._taskLoad?-1:1});const j=this.workerPool[this.workerPool.length-1];return j._taskCosts[s]=o,j._taskLoad+=o,j})}_releaseTask(s,o){s._taskLoad-=s._taskCosts[o],delete s._callbacks[o],delete s._taskCosts[o]}debug(){console.log("Task load: ",this.workerPool.map(s=>s._taskLoad))}dispose(){for(let s=0;s<this.workerPool.length;++s)this.workerPool[s].terminate();return this.workerPool.length=0,this}}function DRACOWorker(){let a,s;onmessage=function(tt){const nt=tt.data;switch(nt.type){case"init":a=nt.decoderConfig,s=new Promise(function(st){a.onModuleLoaded=function(at){st({draco:at})},DracoDecoderModule(a)});break;case"decode":const rt=nt.buffer,it=nt.taskConfig;s.then(st=>{const at=st.draco,ot=new at.Decoder,ct=new at.DecoderBuffer;ct.Init(new Int8Array(rt),rt.byteLength);try{const ft=o(at,ot,ct,it),ht=ft.attributes.map(mt=>mt.array.buffer);ft.index&&ht.push(ft.index.array.buffer),self.postMessage({type:"decode",id:nt.id,geometry:ft},ht)}catch(ft){console.error(ft),self.postMessage({type:"error",id:nt.id,error:ft.message})}finally{at.destroy(ct),at.destroy(ot)}});break}};function o(tt,nt,rt,it){const st=it.attributeIDs,at=it.attributeTypes;let ot,ct;const ft=nt.GetEncodedGeometryType(rt);if(ft===tt.TRIANGULAR_MESH)ot=new tt.Mesh,ct=nt.DecodeBufferToMesh(rt,ot);else if(ft===tt.POINT_CLOUD)ot=new tt.PointCloud,ct=nt.DecodeBufferToPointCloud(rt,ot);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!ct.ok()||ot.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+ct.error_msg());const ht={index:null,attributes:[]};for(const mt in st){const lt=self[at[mt]];let ut,dt;if(it.useUniqueIDs)dt=st[mt],ut=nt.GetAttributeByUniqueId(ot,dt);else{if(dt=nt.GetAttributeId(ot,tt[st[mt]]),dt===-1)continue;ut=nt.GetAttribute(ot,dt)}ht.attributes.push($(tt,nt,ot,mt,lt,ut))}return ft===tt.TRIANGULAR_MESH&&(ht.index=j(tt,nt,ot)),tt.destroy(ot),ht}function j(tt,nt,rt){const st=rt.num_faces()*3,at=st*4,ot=tt._malloc(at);nt.GetTrianglesUInt32Array(rt,at,ot);const ct=new Uint32Array(tt.HEAPF32.buffer,ot,st).slice();return tt._free(ot),{array:ct,itemSize:1}}function $(tt,nt,rt,it,st,at){const ot=at.num_components(),ft=rt.num_points()*ot,ht=ft*st.BYTES_PER_ELEMENT,mt=_e(tt,st),lt=tt._malloc(ht);nt.GetAttributeDataArrayForAllPoints(rt,at,mt,ht,lt);const ut=new st(tt.HEAPF32.buffer,lt,ft).slice();return tt._free(lt),{name:it,array:ut,itemSize:ot}}function _e(tt,nt){switch(nt){case Float32Array:return tt.DT_FLOAT32;case Int8Array:return tt.DT_INT8;case Int16Array:return tt.DT_INT16;case Int32Array:return tt.DT_INT32;case Uint8Array:return tt.DT_UINT8;case Uint16Array:return tt.DT_UINT16;case Uint32Array:return tt.DT_UINT32}}}class HDRCubeTextureLoader extends Loader{constructor(s){super(s),this.hdrLoader=new RGBELoader,this.type=HalfFloatType}load(s,o,j,$){Array.isArray(s)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(s),s=o,o=j,j=$,$=arguments[4]);const _e=new CubeTexture;switch(_e.type=this.type,_e.type){case FloatType:case HalfFloatType:"colorSpace"in _e?_e.colorSpace="srgb-linear":_e.encoding=3e3,_e.minFilter=LinearFilter,_e.magFilter=LinearFilter,_e.generateMipmaps=!1;break}const tt=this;let nt=0;function rt(it,st,at,ot){new FileLoader(tt.manager).setPath(tt.path).setResponseType("arraybuffer").setWithCredentials(tt.withCredentials).load(s[it],function(ct){nt++;const ft=tt.hdrLoader.parse(ct);if(ft){if(ft.data!==void 0){const ht=new DataTexture(ft.data,ft.width,ft.height);ht.type=_e.type,ht.encoding=_e.encoding,ht.format=_e.format,ht.minFilter=_e.minFilter,ht.magFilter=_e.magFilter,ht.generateMipmaps=_e.generateMipmaps,_e.images[it]=ht}nt===6&&(_e.needsUpdate=!0,st&&st(_e))}},at,ot)}for(let it=0;it<s.length;it++)rt(it,o,j,$);return _e}setDataType(s){return this.type=s,this.hdrLoader.setDataType(s),this}}class PDBLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){function o(ct){return ct.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function j(ct){return ct.charAt(0).toUpperCase()+ct.substr(1).toLowerCase()}function $(ct,ft){return"s"+Math.min(ct,ft)+"e"+Math.max(ct,ft)}function _e(ct,ft,ht,mt){const lt=parseInt(ot[mt].substr(ct,ft));if(lt){const ut=$(ht,lt);st[ut]===void 0&&(it.push([ht-1,lt-1,1]),st[ut]=it.length-1)}}function tt(){const ct={geometryAtoms:new BufferGeometry,geometryBonds:new BufferGeometry,json:{atoms:rt}},ft=ct.geometryAtoms,ht=ct.geometryBonds,mt=[],lt=[],ut=[];for(let dt=0,gt=rt.length;dt<gt;dt++){const Et=rt[dt],St=Et[0],Tt=Et[1],Mt=Et[2];mt.push(St,Tt,Mt);const Bt=Et[3][0]/255,Rt=Et[3][1]/255,Ut=Et[3][2]/255;lt.push(Bt,Rt,Ut)}for(let dt=0,gt=it.length;dt<gt;dt++){const Et=it[dt],St=Et[0],Tt=Et[1],Mt=at[St],Bt=at[Tt];let Rt=Mt[0],Ut=Mt[1],Ht=Mt[2];ut.push(Rt,Ut,Ht),Rt=Bt[0],Ut=Bt[1],Ht=Bt[2],ut.push(Rt,Ut,Ht)}return ft.setAttribute("position",new Float32BufferAttribute(mt,3)),ft.setAttribute("color",new Float32BufferAttribute(lt,3)),ht.setAttribute("position",new Float32BufferAttribute(ut,3)),ct}const nt={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},rt=[],it=[],st={},at={},ot=s.split(`
`);for(let ct=0,ft=ot.length;ct<ft;ct++)if(ot[ct].substr(0,4)==="ATOM"||ot[ct].substr(0,6)==="HETATM"){const ht=parseFloat(ot[ct].substr(30,7)),mt=parseFloat(ot[ct].substr(38,7)),lt=parseFloat(ot[ct].substr(46,7)),ut=parseInt(ot[ct].substr(6,5))-1;let dt=o(ot[ct].substr(76,2)).toLowerCase();dt===""&&(dt=o(ot[ct].substr(12,2)).toLowerCase());const gt=[ht,mt,lt,nt[dt],j(dt)];rt.push(gt),at[ut]=gt}else if(ot[ct].substr(0,6)==="CONECT"){const ht=parseInt(ot[ct].substr(6,5));_e(11,5,ht,ct),_e(16,5,ht,ct),_e(21,5,ht,ct),_e(26,5,ht,ct)}return tt()}}let bigEndianPlatform=null;function isBigEndianPlatform(){if(bigEndianPlatform===null){const a=new ArrayBuffer(2),s=new Uint8Array(a),o=new Uint16Array(a);s[0]=170,s[1]=187,bigEndianPlatform=o[0]===43707}return bigEndianPlatform}const InvertedEncodingTypes=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],getMethods={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function copyFromBuffer(a,s,o,j,$){const _e=s.BYTES_PER_ELEMENT;let tt;if($===isBigEndianPlatform()||_e===1)tt=new s(a,o,j);else{const nt=new DataView(a,o,j*_e),rt=getMethods[s.name],it=!$;tt=new s(j);for(let st=0;st<j;st++)tt[st]=nt[rt](st*_e,it)}return tt}function decodePrwm(a){const s=new Uint8Array(a),o=s[0];let j=s[1];const $=!!(j>>7&1),_e=j>>6&1,tt=(j>>5&1)===1,nt=j&31;let rt=0,it=0;if(tt?(rt=(s[2]<<16)+(s[3]<<8)+s[4],it=(s[5]<<16)+(s[6]<<8)+s[7]):(rt=s[2]+(s[3]<<8)+(s[4]<<16),it=s[5]+(s[6]<<8)+(s[7]<<16)),o===0)throw new Error("PRWM decoder: Invalid format version: 0");if(o!==1)throw new Error("PRWM decoder: Unsupported format version: "+o);if(!$){if(_e!==0)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(it!==0)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}let st=8;const at={};for(let ct=0;ct<nt;ct++){let ft="";for(;st<s.length;){const gt=s[st];if(st++,gt===0)break;ft+=String.fromCharCode(gt)}j=s[st];const ht=j>>7&1,mt=(j>>4&3)+1,lt=j&15,ut=InvertedEncodingTypes[lt];st++,st=Math.ceil(st/4)*4;const dt=copyFromBuffer(a,ut,st,mt*rt,tt);st+=ut.BYTES_PER_ELEMENT*mt*rt,at[ft]={type:ht,cardinality:mt,values:dt}}st=Math.ceil(st/4)*4;let ot=null;return $&&(ot=copyFromBuffer(a,_e===1?Uint32Array:Uint16Array,st,it,tt)),{version:o,attributes:at,indices:ot}}class PRWMLoader extends Loader{constructor(s){super(s)}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),s=s.replace(/\*/g,isBigEndianPlatform()?"be":"le"),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=decodePrwm(s),j=Object.keys(o.attributes),$=new BufferGeometry;for(let _e=0;_e<j.length;_e++){const tt=o.attributes[j[_e]];$.setAttribute(j[_e],new BufferAttribute(tt.values,tt.cardinality,tt.normalized))}return o.indices!==null&&$.setIndex(new BufferAttribute(o.indices,1)),$}static isBigEndianPlatform(){return isBigEndianPlatform()}}let UPNG;function init(){if(UPNG)return UPNG;UPNG={},UPNG.toRGBA8=function(a){var s=a.width,o=a.height;if(a.tabs.acTL==null)return[UPNG.toRGBA8.decodeImage(a.data,s,o,a).buffer];var j=[];a.frames[0].data==null&&(a.frames[0].data=a.data);for(var $=s*o*4,_e=new Uint8Array($),tt=new Uint8Array($),nt=new Uint8Array($),rt=0;rt<a.frames.length;rt++){var it=a.frames[rt],st=it.rect.x,at=it.rect.y,ot=it.rect.width,ct=it.rect.height,ft=UPNG.toRGBA8.decodeImage(it.data,ot,ct,a);if(rt!=0)for(var ht=0;ht<$;ht++)nt[ht]=_e[ht];if(it.blend==0?UPNG._copyTile(ft,ot,ct,_e,s,o,st,at,0):it.blend==1&&UPNG._copyTile(ft,ot,ct,_e,s,o,st,at,1),j.push(_e.buffer.slice(0)),it.dispose==1)UPNG._copyTile(tt,ot,ct,_e,s,o,st,at,0);else if(it.dispose==2)for(var ht=0;ht<$;ht++)_e[ht]=nt[ht]}return j},UPNG.toRGBA8.decodeImage=function(a,s,o,j){var $=s*o,_e=UPNG.decode._getBPP(j),tt=Math.ceil(s*_e/8),nt=new Uint8Array($*4),rt=new Uint32Array(nt.buffer),it=j.ctype,st=j.depth,at=UPNG._bin.readUshort;if(it==6){var ot=$<<2;if(st==8)for(var ct=0;ct<ot;ct+=4)nt[ct]=a[ct],nt[ct+1]=a[ct+1],nt[ct+2]=a[ct+2],nt[ct+3]=a[ct+3];if(st==16)for(var ct=0;ct<ot;ct++)nt[ct]=a[ct<<1]}else if(it==2){var ft=j.tabs.tRNS;if(ft==null){if(st==8)for(var ct=0;ct<$;ct++){var ht=ct*3;rt[ct]=255<<24|a[ht+2]<<16|a[ht+1]<<8|a[ht]}if(st==16)for(var ct=0;ct<$;ct++){var ht=ct*6;rt[ct]=255<<24|a[ht+4]<<16|a[ht+2]<<8|a[ht]}}else{var mt=ft[0],lt=ft[1],ut=ft[2];if(st==8)for(var ct=0;ct<$;ct++){var dt=ct<<2,ht=ct*3;rt[ct]=255<<24|a[ht+2]<<16|a[ht+1]<<8|a[ht],a[ht]==mt&&a[ht+1]==lt&&a[ht+2]==ut&&(nt[dt+3]=0)}if(st==16)for(var ct=0;ct<$;ct++){var dt=ct<<2,ht=ct*6;rt[ct]=255<<24|a[ht+4]<<16|a[ht+2]<<8|a[ht],at(a,ht)==mt&&at(a,ht+2)==lt&&at(a,ht+4)==ut&&(nt[dt+3]=0)}}}else if(it==3){var gt=j.tabs.PLTE,Et=j.tabs.tRNS,St=Et?Et.length:0;if(st==1)for(var Tt=0;Tt<o;Tt++)for(var Mt=Tt*tt,Bt=Tt*s,ct=0;ct<s;ct++){var dt=Bt+ct<<2,Rt=a[Mt+(ct>>3)]>>7-((ct&7)<<0)&1,Ut=3*Rt;nt[dt]=gt[Ut],nt[dt+1]=gt[Ut+1],nt[dt+2]=gt[Ut+2],nt[dt+3]=Rt<St?Et[Rt]:255}if(st==2)for(var Tt=0;Tt<o;Tt++)for(var Mt=Tt*tt,Bt=Tt*s,ct=0;ct<s;ct++){var dt=Bt+ct<<2,Rt=a[Mt+(ct>>2)]>>6-((ct&3)<<1)&3,Ut=3*Rt;nt[dt]=gt[Ut],nt[dt+1]=gt[Ut+1],nt[dt+2]=gt[Ut+2],nt[dt+3]=Rt<St?Et[Rt]:255}if(st==4)for(var Tt=0;Tt<o;Tt++)for(var Mt=Tt*tt,Bt=Tt*s,ct=0;ct<s;ct++){var dt=Bt+ct<<2,Rt=a[Mt+(ct>>1)]>>4-((ct&1)<<2)&15,Ut=3*Rt;nt[dt]=gt[Ut],nt[dt+1]=gt[Ut+1],nt[dt+2]=gt[Ut+2],nt[dt+3]=Rt<St?Et[Rt]:255}if(st==8)for(var ct=0;ct<$;ct++){var dt=ct<<2,Rt=a[ct],Ut=3*Rt;nt[dt]=gt[Ut],nt[dt+1]=gt[Ut+1],nt[dt+2]=gt[Ut+2],nt[dt+3]=Rt<St?Et[Rt]:255}}else if(it==4){if(st==8)for(var ct=0;ct<$;ct++){var dt=ct<<2,Ht=ct<<1,Wt=a[Ht];nt[dt]=Wt,nt[dt+1]=Wt,nt[dt+2]=Wt,nt[dt+3]=a[Ht+1]}if(st==16)for(var ct=0;ct<$;ct++){var dt=ct<<2,Ht=ct<<2,Wt=a[Ht];nt[dt]=Wt,nt[dt+1]=Wt,nt[dt+2]=Wt,nt[dt+3]=a[Ht+2]}}else if(it==0)for(var mt=j.tabs.tRNS?j.tabs.tRNS:-1,Tt=0;Tt<o;Tt++){var Jt=Tt*tt,sn=Tt*s;if(st==1)for(var jt=0;jt<s;jt++){var Wt=255*(a[Jt+(jt>>>3)]>>>7-(jt&7)&1),Vt=Wt==mt*255?0:255;rt[sn+jt]=Vt<<24|Wt<<16|Wt<<8|Wt}else if(st==2)for(var jt=0;jt<s;jt++){var Wt=85*(a[Jt+(jt>>>2)]>>>6-((jt&3)<<1)&3),Vt=Wt==mt*85?0:255;rt[sn+jt]=Vt<<24|Wt<<16|Wt<<8|Wt}else if(st==4)for(var jt=0;jt<s;jt++){var Wt=17*(a[Jt+(jt>>>1)]>>>4-((jt&1)<<2)&15),Vt=Wt==mt*17?0:255;rt[sn+jt]=Vt<<24|Wt<<16|Wt<<8|Wt}else if(st==8)for(var jt=0;jt<s;jt++){var Wt=a[Jt+jt],Vt=Wt==mt?0:255;rt[sn+jt]=Vt<<24|Wt<<16|Wt<<8|Wt}else if(st==16)for(var jt=0;jt<s;jt++){var Wt=a[Jt+(jt<<1)],Vt=at(a,Jt+(jt<<1))==mt?0:255;rt[sn+jt]=Vt<<24|Wt<<16|Wt<<8|Wt}}return nt},UPNG.decode=function(a){for(var s=new Uint8Array(a),o=8,j=UPNG._bin,$=j.readUshort,_e=j.readUint,tt={tabs:{},frames:[]},nt=new Uint8Array(s.length),rt=0,it,st=0,at,ot,ct,ft=[137,80,78,71,13,10,26,10],ht=0;ht<8;ht++)if(s[ht]!=ft[ht])throw new Error("The input is not a PNG file!");for(;o<s.length;){var mt=j.readUint(s,o);o+=4;var lt=j.readASCII(s,o,4);if(o+=4,lt=="IHDR")UPNG.decode._IHDR(s,o,tt);else if(lt=="CgBI")tt.tabs[lt]=s.slice(o,o+4);else if(lt=="IDAT"){for(var ht=0;ht<mt;ht++)nt[rt+ht]=s[o+ht];rt+=mt}else if(lt=="acTL")tt.tabs[lt]={num_frames:_e(s,o),num_plays:_e(s,o+4)},it=new Uint8Array(s.length);else if(lt=="fcTL"){if(st!=0){var ut=tt.frames[tt.frames.length-1];ut.data=UPNG.decode._decompress(tt,it.slice(0,st),ut.rect.width,ut.rect.height),st=0}var dt={x:_e(s,o+12),y:_e(s,o+16),width:_e(s,o+4),height:_e(s,o+8)},gt=$(s,o+22);gt=$(s,o+20)/(gt==0?100:gt);var Et={rect:dt,delay:Math.round(gt*1e3),dispose:s[o+24],blend:s[o+25]};tt.frames.push(Et)}else if(lt=="fdAT"){for(var ht=0;ht<mt-4;ht++)it[st+ht]=s[o+ht+4];st+=mt-4}else if(lt=="pHYs")tt.tabs[lt]=[j.readUint(s,o),j.readUint(s,o+4),s[o+8]];else if(lt=="cHRM"){tt.tabs[lt]=[];for(var ht=0;ht<8;ht++)tt.tabs[lt].push(j.readUint(s,o+ht*4))}else if(lt=="tEXt"||lt=="zTXt"){tt.tabs[lt]==null&&(tt.tabs[lt]={});var St=j.nextZero(s,o);ot=j.readASCII(s,o,St-o);var Tt=o+mt-St-1;lt=="tEXt"?at=j.readASCII(s,St+1,Tt):(ct=UPNG.decode._inflate(s.slice(St+2,St+2+Tt)),at=j.readUTF8(ct,0,ct.length)),tt.tabs[lt][ot]=at}else if(lt=="iTXt"){tt.tabs[lt]==null&&(tt.tabs[lt]={});var St=0,Mt=o;St=j.nextZero(s,Mt),ot=j.readASCII(s,Mt,St-Mt),Mt=St+1;var Bt=s[Mt];Mt+=2,St=j.nextZero(s,Mt),j.readASCII(s,Mt,St-Mt),Mt=St+1,St=j.nextZero(s,Mt),j.readUTF8(s,Mt,St-Mt),Mt=St+1;var Tt=mt-(Mt-o);Bt==0?at=j.readUTF8(s,Mt,Tt):(ct=UPNG.decode._inflate(s.slice(Mt,Mt+Tt)),at=j.readUTF8(ct,0,ct.length)),tt.tabs[lt][ot]=at}else if(lt=="PLTE")tt.tabs[lt]=j.readBytes(s,o,mt);else if(lt=="hIST"){var Rt=tt.tabs.PLTE.length/3;tt.tabs[lt]=[];for(var ht=0;ht<Rt;ht++)tt.tabs[lt].push($(s,o+ht*2))}else if(lt=="tRNS")tt.ctype==3?tt.tabs[lt]=j.readBytes(s,o,mt):tt.ctype==0?tt.tabs[lt]=$(s,o):tt.ctype==2&&(tt.tabs[lt]=[$(s,o),$(s,o+2),$(s,o+4)]);else if(lt=="gAMA")tt.tabs[lt]=j.readUint(s,o)/1e5;else if(lt=="sRGB")tt.tabs[lt]=s[o];else if(lt=="bKGD")tt.ctype==0||tt.ctype==4?tt.tabs[lt]=[$(s,o)]:tt.ctype==2||tt.ctype==6?tt.tabs[lt]=[$(s,o),$(s,o+2),$(s,o+4)]:tt.ctype==3&&(tt.tabs[lt]=s[o]);else if(lt=="IEND")break;o+=mt,j.readUint(s,o),o+=4}if(st!=0){var ut=tt.frames[tt.frames.length-1];ut.data=UPNG.decode._decompress(tt,it.slice(0,st),ut.rect.width,ut.rect.height)}return tt.data=UPNG.decode._decompress(tt,nt,tt.width,tt.height),delete tt.compress,delete tt.interlace,delete tt.filter,tt},UPNG.decode._decompress=function(a,s,o,j){var $=UPNG.decode._getBPP(a),_e=Math.ceil(o*$/8),tt=new Uint8Array((_e+1+a.interlace)*j);return a.tabs.CgBI?s=UPNG.inflateRaw(s,tt):s=UPNG.decode._inflate(s,tt),a.interlace==0?s=UPNG.decode._filterZero(s,a,0,o,j):a.interlace==1&&(s=UPNG.decode._readInterlace(s,a)),s},UPNG.decode._inflate=function(a,s){var o=UPNG.inflateRaw(new Uint8Array(a.buffer,2,a.length-6),s);return o},UPNG.inflateRaw=function(){var a={};return a.H={},a.H.N=function(s,o){var j=Uint8Array,$=0,_e=0,tt=0,nt=0,rt=0,it=0,st=0,at=0,ot=0,ct,ft;if(s[0]==3&&s[1]==0)return o||new j(0);var ht=a.H,mt=ht.b,lt=ht.e,ut=ht.R,dt=ht.n,gt=ht.A,Et=ht.Z,St=ht.m,Tt=o==null;for(Tt&&(o=new j(s.length>>>2<<5));$==0;){if($=mt(s,ot,1),_e=mt(s,ot+1,2),ot+=3,_e==0){ot&7&&(ot+=8-(ot&7));var Mt=(ot>>>3)+4,Bt=s[Mt-4]|s[Mt-3]<<8;Tt&&(o=a.H.W(o,at+Bt)),o.set(new j(s.buffer,s.byteOffset+Mt,Bt),at),ot=Mt+Bt<<3,at+=Bt;continue}if(Tt&&(o=a.H.W(o,at+(1<<17))),_e==1&&(ct=St.J,ft=St.h,it=(1<<9)-1,st=(1<<5)-1),_e==2){tt=lt(s,ot,5)+257,nt=lt(s,ot+5,5)+1,rt=lt(s,ot+10,4)+4,ot+=14;for(var Rt=1,Ut=0;Ut<38;Ut+=2)St.Q[Ut]=0,St.Q[Ut+1]=0;for(var Ut=0;Ut<rt;Ut++){var Ht=lt(s,ot+Ut*3,3);St.Q[(St.X[Ut]<<1)+1]=Ht,Ht>Rt&&(Rt=Ht)}ot+=3*rt,dt(St.Q,Rt),gt(St.Q,Rt,St.u),ct=St.w,ft=St.d,ot=ut(St.u,(1<<Rt)-1,tt+nt,s,ot,St.v);var Wt=ht.V(St.v,0,tt,St.C);it=(1<<Wt)-1;var Jt=ht.V(St.v,tt,nt,St.D);st=(1<<Jt)-1,dt(St.C,Wt),gt(St.C,Wt,ct),dt(St.D,Jt),gt(St.D,Jt,ft)}for(;;){var sn=ct[Et(s,ot)&it];ot+=sn&15;var jt=sn>>>4;if(!(jt>>>8))o[at++]=jt;else{if(jt==256)break;var Vt=at+jt-254;if(jt>264){var Lt=St.q[jt-257];Vt=at+(Lt>>>3)+lt(s,ot,Lt&7),ot+=Lt&7}var Qt=ft[Et(s,ot)&st];ot+=Qt&15;var nn=Qt>>>4,mn=St.c[nn],Zt=(mn>>>4)+mt(s,ot,mn&15);for(ot+=mn&15;at<Vt;)o[at]=o[at++-Zt],o[at]=o[at++-Zt],o[at]=o[at++-Zt],o[at]=o[at++-Zt];at=Vt}}}return o.length==at?o:o.slice(0,at)},a.H.W=function(s,o){var j=s.length;if(o<=j)return s;var $=new Uint8Array(j<<1);return $.set(s,0),$},a.H.R=function(s,o,j,$,_e,tt){for(var nt=a.H.e,rt=a.H.Z,it=0;it<j;){var st=s[rt($,_e)&o];_e+=st&15;var at=st>>>4;if(at<=15)tt[it]=at,it++;else{var ot=0,ct=0;at==16?(ct=3+nt($,_e,2),_e+=2,ot=tt[it-1]):at==17?(ct=3+nt($,_e,3),_e+=3):at==18&&(ct=11+nt($,_e,7),_e+=7);for(var ft=it+ct;it<ft;)tt[it]=ot,it++}}return _e},a.H.V=function(s,o,j,$){for(var _e=0,tt=0,nt=$.length>>>1;tt<j;){var rt=s[tt+o];$[tt<<1]=0,$[(tt<<1)+1]=rt,rt>_e&&(_e=rt),tt++}for(;tt<nt;)$[tt<<1]=0,$[(tt<<1)+1]=0,tt++;return _e},a.H.n=function(s,o){for(var j=a.H.m,$=s.length,_e,tt,nt,rt,it,st=j.j,rt=0;rt<=o;rt++)st[rt]=0;for(rt=1;rt<$;rt+=2)st[s[rt]]++;var at=j.K;for(_e=0,st[0]=0,tt=1;tt<=o;tt++)_e=_e+st[tt-1]<<1,at[tt]=_e;for(nt=0;nt<$;nt+=2)it=s[nt+1],it!=0&&(s[nt]=at[it],at[it]++)},a.H.A=function(s,o,j){for(var $=s.length,_e=a.H.m,tt=_e.r,nt=0;nt<$;nt+=2)if(s[nt+1]!=0)for(var rt=nt>>1,it=s[nt+1],st=rt<<4|it,at=o-it,ot=s[nt]<<at,ct=ot+(1<<at);ot!=ct;){var ft=tt[ot]>>>15-o;j[ft]=st,ot++}},a.H.l=function(s,o){for(var j=a.H.m.r,$=15-o,_e=0;_e<s.length;_e+=2){var tt=s[_e]<<o-s[_e+1];s[_e]=j[tt]>>>$}},a.H.M=function(s,o,j){j=j<<(o&7);var $=o>>>3;s[$]|=j,s[$+1]|=j>>>8},a.H.I=function(s,o,j){j=j<<(o&7);var $=o>>>3;s[$]|=j,s[$+1]|=j>>>8,s[$+2]|=j>>>16},a.H.e=function(s,o,j){return(s[o>>>3]|s[(o>>>3)+1]<<8)>>>(o&7)&(1<<j)-1},a.H.b=function(s,o,j){return(s[o>>>3]|s[(o>>>3)+1]<<8|s[(o>>>3)+2]<<16)>>>(o&7)&(1<<j)-1},a.H.Z=function(s,o){return(s[o>>>3]|s[(o>>>3)+1]<<8|s[(o>>>3)+2]<<16)>>>(o&7)},a.H.i=function(s,o){return(s[o>>>3]|s[(o>>>3)+1]<<8|s[(o>>>3)+2]<<16|s[(o>>>3)+3]<<24)>>>(o&7)},a.H.m=function(){var s=Uint16Array,o=Uint32Array;return{K:new s(16),j:new s(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new s(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new o(32),J:new s(512),_:[],h:new s(32),$:[],w:new s(32768),C:[],v:[],d:new s(32768),D:[],u:new s(512),Q:[],r:new s(1<<15),s:new o(286),Y:new o(30),a:new o(19),t:new o(15e3),k:new s(1<<16),g:new s(1<<15)}}(),function(){for(var s=a.H.m,o=1<<15,j=0;j<o;j++){var $=j;$=($&2863311530)>>>1|($&1431655765)<<1,$=($&3435973836)>>>2|($&858993459)<<2,$=($&4042322160)>>>4|($&252645135)<<4,$=($&4278255360)>>>8|($&16711935)<<8,s.r[j]=($>>>16|$<<16)>>>17}function _e(tt,nt,rt){for(;nt--!=0;)tt.push(0,rt)}for(var j=0;j<32;j++)s.q[j]=s.S[j]<<3|s.T[j],s.c[j]=s.p[j]<<4|s.z[j];_e(s._,144,8),_e(s._,255-143,9),_e(s._,279-255,7),_e(s._,287-279,8),a.H.n(s._,9),a.H.A(s._,9,s.J),a.H.l(s._,9),_e(s.$,32,5),a.H.n(s.$,5),a.H.A(s.$,5,s.h),a.H.l(s.$,5),_e(s.Q,19,0),_e(s.C,286,0),_e(s.D,30,0),_e(s.v,320,0)}(),a.H.N}(),UPNG.decode._readInterlace=function(a,s){for(var o=s.width,j=s.height,$=UPNG.decode._getBPP(s),_e=$>>3,tt=Math.ceil(o*$/8),nt=new Uint8Array(j*tt),rt=0,it=[0,0,4,0,2,0,1],st=[0,4,0,2,0,1,0],at=[8,8,8,4,4,2,2],ot=[8,8,4,4,2,2,1],ct=0;ct<7;){for(var ft=at[ct],ht=ot[ct],mt=0,lt=0,ut=it[ct];ut<j;)ut+=ft,lt++;for(var dt=st[ct];dt<o;)dt+=ht,mt++;var gt=Math.ceil(mt*$/8);UPNG.decode._filterZero(a,s,rt,mt,lt);for(var Et=0,St=it[ct],Tt;St<j;){for(var Mt=st[ct],Bt=rt+Et*gt<<3;Mt<o;){if($==1&&(Tt=a[Bt>>3],Tt=Tt>>7-(Bt&7)&1,nt[St*tt+(Mt>>3)]|=Tt<<7-((Mt&7)<<0)),$==2&&(Tt=a[Bt>>3],Tt=Tt>>6-(Bt&7)&3,nt[St*tt+(Mt>>2)]|=Tt<<6-((Mt&3)<<1)),$==4&&(Tt=a[Bt>>3],Tt=Tt>>4-(Bt&7)&15,nt[St*tt+(Mt>>1)]|=Tt<<4-((Mt&1)<<2)),$>=8)for(var Rt=St*tt+Mt*_e,Ut=0;Ut<_e;Ut++)nt[Rt+Ut]=a[(Bt>>3)+Ut];Bt+=$,Mt+=ht}Et++,St+=ft}mt*lt!=0&&(rt+=lt*(1+gt)),ct=ct+1}return nt},UPNG.decode._getBPP=function(a){var s=[1,null,3,1,2,null,4][a.ctype];return s*a.depth},UPNG.decode._filterZero=function(a,s,o,j,$){var _e=UPNG.decode._getBPP(s),tt=Math.ceil(j*_e/8),nt=UPNG.decode._paeth;_e=Math.ceil(_e/8);var rt,it,st=a[o],at=0;if(st>1&&(a[o]=[0,0,1][st-2]),st==3)for(at=_e;at<tt;at++)a[at+1]=a[at+1]+(a[at+1-_e]>>>1)&255;for(var ot=0;ot<$;ot++)if(rt=o+ot*tt,it=rt+ot+1,st=a[it-1],at=0,st==0)for(;at<tt;at++)a[rt+at]=a[it+at];else if(st==1){for(;at<_e;at++)a[rt+at]=a[it+at];for(;at<tt;at++)a[rt+at]=a[it+at]+a[rt+at-_e]}else if(st==2)for(;at<tt;at++)a[rt+at]=a[it+at]+a[rt+at-tt];else if(st==3){for(;at<_e;at++)a[rt+at]=a[it+at]+(a[rt+at-tt]>>>1);for(;at<tt;at++)a[rt+at]=a[it+at]+(a[rt+at-tt]+a[rt+at-_e]>>>1)}else{for(;at<_e;at++)a[rt+at]=a[it+at]+nt(0,a[rt+at-tt],0);for(;at<tt;at++)a[rt+at]=a[it+at]+nt(a[rt+at-_e],a[rt+at-tt],a[rt+at-_e-tt])}return a},UPNG.decode._paeth=function(a,s,o){var j=a+s-o,$=j-a,_e=j-s,tt=j-o;return $*$<=_e*_e&&$*$<=tt*tt?a:_e*_e<=tt*tt?s:o},UPNG.decode._IHDR=function(a,s,o){var j=UPNG._bin;o.width=j.readUint(a,s),s+=4,o.height=j.readUint(a,s),s+=4,o.depth=a[s],s++,o.ctype=a[s],s++,o.compress=a[s],s++,o.filter=a[s],s++,o.interlace=a[s],s++},UPNG._bin={nextZero:function(a,s){for(;a[s]!=0;)s++;return s},readUshort:function(a,s){return a[s]<<8|a[s+1]},writeUshort:function(a,s,o){a[s]=o>>8&255,a[s+1]=o&255},readUint:function(a,s){return a[s]*(256*256*256)+(a[s+1]<<16|a[s+2]<<8|a[s+3])},writeUint:function(a,s,o){a[s]=o>>24&255,a[s+1]=o>>16&255,a[s+2]=o>>8&255,a[s+3]=o&255},readASCII:function(a,s,o){for(var j="",$=0;$<o;$++)j+=String.fromCharCode(a[s+$]);return j},writeASCII:function(a,s,o){for(var j=0;j<o.length;j++)a[s+j]=o.charCodeAt(j)},readBytes:function(a,s,o){for(var j=[],$=0;$<o;$++)j.push(a[s+$]);return j},pad:function(a){return a.length<2?"0"+a:a},readUTF8:function(a,s,o){for(var j="",$,_e=0;_e<o;_e++)j+="%"+UPNG._bin.pad(a[s+_e].toString(16));try{$=decodeURIComponent(j)}catch{return UPNG._bin.readASCII(a,s,o)}return $}},UPNG._copyTile=function(a,s,o,j,$,_e,tt,nt,rt){for(var it=Math.min(s,$),st=Math.min(o,_e),at=0,ot=0,ct=0;ct<st;ct++)for(var ft=0;ft<it;ft++)if(tt>=0&&nt>=0?(at=ct*s+ft<<2,ot=(nt+ct)*$+tt+ft<<2):(at=(-nt+ct)*s-tt+ft<<2,ot=ct*$+ft<<2),rt==0)j[ot]=a[at],j[ot+1]=a[at+1],j[ot+2]=a[at+2],j[ot+3]=a[at+3];else if(rt==1){var ht=a[at+3]*.00392156862745098,mt=a[at]*ht,lt=a[at+1]*ht,ut=a[at+2]*ht,dt=j[ot+3]*(1/255),gt=j[ot]*dt,Et=j[ot+1]*dt,St=j[ot+2]*dt,Tt=1-ht,Mt=ht+dt*Tt,Bt=Mt==0?0:1/Mt;j[ot+3]=255*Mt,j[ot+0]=(mt+gt*Tt)*Bt,j[ot+1]=(lt+Et*Tt)*Bt,j[ot+2]=(ut+St*Tt)*Bt}else if(rt==2){var ht=a[at+3],mt=a[at],lt=a[at+1],ut=a[at+2],dt=j[ot+3],gt=j[ot],Et=j[ot+1],St=j[ot+2];ht==dt&&mt==gt&&lt==Et&&ut==St?(j[ot]=0,j[ot+1]=0,j[ot+2]=0,j[ot+3]=0):(j[ot]=mt,j[ot+1]=lt,j[ot+2]=ut,j[ot+3]=ht)}else if(rt==3){var ht=a[at+3],mt=a[at],lt=a[at+1],ut=a[at+2],dt=j[ot+3],gt=j[ot],Et=j[ot+1],St=j[ot+2];if(ht==dt&&mt==gt&&lt==Et&&ut==St)continue;if(ht<220&&dt>20)return!1}return!0}}class RGBMLoader extends DataTextureLoader{constructor(s){super(s),this.type=HalfFloatType,this.maxRange=7}setDataType(s){return this.type=s,this}setMaxRange(s){return this.maxRange=s,this}loadCubemap(s,o,j,$){const _e=new CubeTexture;let tt=0;const nt=this;function rt(it){nt.load(s[it],function(st){_e.images[it]=st,tt++,tt===6&&(_e.needsUpdate=!0,o&&o(_e))},void 0,$)}for(let it=0;it<s.length;++it)rt(it);return _e.type=this.type,_e.format=RGBAFormat,_e.minFilter=LinearFilter,_e.generateMipmaps=!1,_e}parse(s){init();const o=UPNG.decode(s),j=UPNG.toRGBA8(o)[0],$=new Uint8Array(j),_e=o.width*o.height*4,tt=this.type===HalfFloatType?new Uint16Array(_e):new Float32Array(_e);for(let nt=0;nt<$.length;nt+=4){const rt=$[nt+0]/255,it=$[nt+1]/255,st=$[nt+2]/255,at=$[nt+3]/255;this.type===HalfFloatType?(tt[nt+0]=DataUtils.toHalfFloat(Math.min(rt*at*this.maxRange,65504)),tt[nt+1]=DataUtils.toHalfFloat(Math.min(it*at*this.maxRange,65504)),tt[nt+2]=DataUtils.toHalfFloat(Math.min(st*at*this.maxRange,65504)),tt[nt+3]=DataUtils.toHalfFloat(1)):(tt[nt+0]=rt*at*this.maxRange,tt[nt+1]=it*at*this.maxRange,tt[nt+2]=st*at*this.maxRange,tt[nt+3]=1)}return{width:o.width,height:o.height,data:tt,format:RGBAFormat,type:this.type,flipY:!0}}}class VOXLoader extends Loader{load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s){const o=new DataView(s),j=o.getUint32(0,!0),$=o.getUint32(4,!0);if(j!==542658390||$!==150){console.error("Not a valid VOX file");return}const _e=[0,4294967295,4291624959,4288282623,4284940287,4281597951,4278255615,4294954239,4291611903,4288269567,4284927231,4281584895,4278242559,4294941183,4291598847,4288256511,4284914175,4281571839,4278229503,4294928127,4291585791,4288243455,4284901119,4281558783,4278216447,4294915071,4291572735,4288230399,4284888063,4281545727,4278203391,4294902015,4291559679,4288217343,4284875007,4281532671,4278190335,4294967244,4291624908,4288282572,4284940236,4281597900,4278255564,4294954188,4291611852,4288269516,4284927180,4281584844,4278242508,4294941132,4291598796,4288256460,4284914124,4281571788,4278229452,4294928076,4291585740,4288243404,4284901068,4281558732,4278216396,4294915020,4291572684,4288230348,4284888012,4281545676,4278203340,4294901964,4291559628,4288217292,4284874956,4281532620,4278190284,4294967193,4291624857,4288282521,4284940185,4281597849,4278255513,4294954137,4291611801,4288269465,4284927129,4281584793,4278242457,4294941081,4291598745,4288256409,4284914073,4281571737,4278229401,4294928025,4291585689,4288243353,4284901017,4281558681,4278216345,4294914969,4291572633,4288230297,4284887961,4281545625,4278203289,4294901913,4291559577,4288217241,4284874905,4281532569,4278190233,4294967142,4291624806,4288282470,4284940134,4281597798,4278255462,4294954086,4291611750,4288269414,4284927078,4281584742,4278242406,4294941030,4291598694,4288256358,4284914022,4281571686,4278229350,4294927974,4291585638,4288243302,4284900966,4281558630,4278216294,4294914918,4291572582,4288230246,4284887910,4281545574,4278203238,4294901862,4291559526,4288217190,4284874854,4281532518,4278190182,4294967091,4291624755,4288282419,4284940083,4281597747,4278255411,4294954035,4291611699,4288269363,4284927027,4281584691,4278242355,4294940979,4291598643,4288256307,4284913971,4281571635,4278229299,4294927923,4291585587,4288243251,4284900915,4281558579,4278216243,4294914867,4291572531,4288230195,4284887859,4281545523,4278203187,4294901811,4291559475,4288217139,4284874803,4281532467,4278190131,4294967040,4291624704,4288282368,4284940032,4281597696,4278255360,4294953984,4291611648,4288269312,4284926976,4281584640,4278242304,4294940928,4291598592,4288256256,4284913920,4281571584,4278229248,4294927872,4291585536,4288243200,4284900864,4281558528,4278216192,4294914816,4291572480,4288230144,4284887808,4281545472,4278203136,4294901760,4291559424,4288217088,4284874752,4281532416,4278190318,4278190301,4278190267,4278190250,4278190216,4278190199,4278190165,4278190148,4278190114,4278190097,4278251008,4278246656,4278237952,4278233600,4278224896,4278220544,4278211840,4278207488,4278198784,4278194432,4293787648,4292673536,4290445312,4289331200,4287102976,4285988864,4283760640,4282646528,4280418304,4279304192,4293848814,4292730333,4290493371,4289374890,4287137928,4286019447,4283782485,4282664004,4280427042,4279308561];let tt=8,nt;const rt=[];for(;tt<o.byteLength;){let it="";for(let at=0;at<4;at++)it+=String.fromCharCode(o.getUint8(tt++));const st=o.getUint32(tt,!0);if(tt+=4,tt+=4,it==="SIZE"){const at=o.getUint32(tt,!0);tt+=4;const ot=o.getUint32(tt,!0);tt+=4;const ct=o.getUint32(tt,!0);tt+=4,nt={palette:_e,size:{x:at,y:ot,z:ct}},rt.push(nt),tt+=st-3*4}else if(it==="XYZI"){const at=o.getUint32(tt,!0);tt+=4,nt.data=new Uint8Array(s,tt,at*4),tt+=at*4}else if(it==="RGBA"){const at=[0];for(let ot=0;ot<256;ot++)at[ot+1]=o.getUint32(tt,!0),tt+=4;nt.palette=at}else tt+=st}return rt}}class VOXMesh extends Mesh{constructor(s){const o=s.data,j=s.size,$=s.palette,_e=[],tt=[],nt=[0,0,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1],rt=[1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0],it=[0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1],st=[0,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0],at=[0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0],ot=[0,1,1,1,1,1,0,1,0,1,1,0,0,1,0,1,1,1];function ct(gt,Et,St,Tt,Mt,Bt,Rt){Et-=j.x/2,St-=j.z/2,Tt+=j.y/2;for(let Ut=0;Ut<18;Ut+=3)_e.push(gt[Ut+0]+Et,gt[Ut+1]+St,gt[Ut+2]+Tt),tt.push(Mt,Bt,Rt)}const ft=j.x,ht=j.x*j.y,mt=new Uint8Array(j.x*j.y*j.z);for(let gt=0;gt<o.length;gt+=4){const Et=o[gt+0],St=o[gt+1],Tt=o[gt+2],Mt=Et+St*ft+Tt*ht;mt[Mt]=255}let lt=!1;for(let gt=0;gt<o.length;gt+=4){const Et=o[gt+0],St=o[gt+1],Tt=o[gt+2],Mt=o[gt+3],Bt=$[Mt],Rt=(Bt>>0&255)/255,Ut=(Bt>>8&255)/255,Ht=(Bt>>16&255)/255;(Rt>0||Ut>0||Ht>0)&&(lt=!0);const Wt=Et+St*ft+Tt*ht;(mt[Wt+1]===0||Et===j.x-1)&&ct(rt,Et,Tt,-St,Rt,Ut,Ht),(mt[Wt-1]===0||Et===0)&&ct(nt,Et,Tt,-St,Rt,Ut,Ht),(mt[Wt+ft]===0||St===j.y-1)&&ct(st,Et,Tt,-St,Rt,Ut,Ht),(mt[Wt-ft]===0||St===0)&&ct(it,Et,Tt,-St,Rt,Ut,Ht),(mt[Wt+ht]===0||Tt===j.z-1)&&ct(ot,Et,Tt,-St,Rt,Ut,Ht),(mt[Wt-ht]===0||Tt===0)&&ct(at,Et,Tt,-St,Rt,Ut,Ht)}const ut=new BufferGeometry;ut.setAttribute("position",new Float32BufferAttribute(_e,3)),ut.computeVertexNormals();const dt=new MeshStandardMaterial;lt&&(ut.setAttribute("color",new Float32BufferAttribute(tt,3)),dt.vertexColors=!0),super(ut,dt)}}class PCDLoader extends Loader{constructor(s){super(s),this.littleEndian=!0}load(s,o,j,$){const _e=this,tt=new FileLoader(_e.manager);tt.setPath(_e.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(_e.requestHeader),tt.setWithCredentials(_e.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt,s))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}parse(s,o){function j(ft,ht){const mt=ft.length,lt=new Uint8Array(ht);let ut=0,dt=0,gt,Et,St;do if(gt=ft[ut++],gt<1<<5){if(gt++,dt+gt>ht)throw new Error("Output buffer is not large enough");if(ut+gt>mt)throw new Error("Invalid compressed data");do lt[dt++]=ft[ut++];while(--gt)}else{if(Et=gt>>5,St=dt-((gt&31)<<8)-1,ut>=mt)throw new Error("Invalid compressed data");if(Et===7&&(Et+=ft[ut++],ut>=mt))throw new Error("Invalid compressed data");if(St-=ft[ut++],dt+Et+2>ht)throw new Error("Output buffer is not large enough");if(St<0)throw new Error("Invalid compressed data");if(St>=dt)throw new Error("Invalid compressed data");do lt[dt++]=lt[St++];while(--Et+2)}while(ut<mt);return lt}function $(ft){const ht={},mt=ft.search(/[\r\n]DATA\s(\S*)\s/i),lt=/[\r\n]DATA\s(\S*)\s/i.exec(ft.substr(mt-1));if(ht.data=lt[1],ht.headerLen=lt[0].length+mt,ht.str=ft.substr(0,ht.headerLen),ht.str=ht.str.replace(/\#.*/gi,""),ht.version=/VERSION (.*)/i.exec(ht.str),ht.fields=/FIELDS (.*)/i.exec(ht.str),ht.size=/SIZE (.*)/i.exec(ht.str),ht.type=/TYPE (.*)/i.exec(ht.str),ht.count=/COUNT (.*)/i.exec(ht.str),ht.width=/WIDTH (.*)/i.exec(ht.str),ht.height=/HEIGHT (.*)/i.exec(ht.str),ht.viewpoint=/VIEWPOINT (.*)/i.exec(ht.str),ht.points=/POINTS (.*)/i.exec(ht.str),ht.version!==null&&(ht.version=parseFloat(ht.version[1])),ht.fields!==null&&(ht.fields=ht.fields[1].split(" ")),ht.type!==null&&(ht.type=ht.type[1].split(" ")),ht.width!==null&&(ht.width=parseInt(ht.width[1])),ht.height!==null&&(ht.height=parseInt(ht.height[1])),ht.viewpoint!==null&&(ht.viewpoint=ht.viewpoint[1]),ht.points!==null&&(ht.points=parseInt(ht.points[1],10)),ht.points===null&&(ht.points=ht.width*ht.height),ht.size!==null&&(ht.size=ht.size[1].split(" ").map(function(dt){return parseInt(dt,10)})),ht.count!==null)ht.count=ht.count[1].split(" ").map(function(dt){return parseInt(dt,10)});else{ht.count=[];for(let dt=0,gt=ht.fields.length;dt<gt;dt++)ht.count.push(1)}ht.offset={};let ut=0;for(let dt=0,gt=ht.fields.length;dt<gt;dt++)ht.data==="ascii"?ht.offset[ht.fields[dt]]=dt:(ht.offset[ht.fields[dt]]=ut,ut+=ht.size[dt]*ht.count[dt]);return ht.rowSize=ut,ht}const _e=LoaderUtils.decodeText(new Uint8Array(s)),tt=$(_e),nt=[],rt=[],it=[];if(tt.data==="ascii"){const ft=tt.offset,mt=_e.substr(tt.headerLen).split(`
`);for(let lt=0,ut=mt.length;lt<ut;lt++){if(mt[lt]==="")continue;const dt=mt[lt].split(" ");if(ft.x!==void 0&&(nt.push(parseFloat(dt[ft.x])),nt.push(parseFloat(dt[ft.y])),nt.push(parseFloat(dt[ft.z]))),ft.rgb!==void 0){const gt=parseFloat(dt[ft.rgb]),Et=gt>>16&255,St=gt>>8&255,Tt=gt>>0&255;it.push(Et/255,St/255,Tt/255)}ft.normal_x!==void 0&&(rt.push(parseFloat(dt[ft.normal_x])),rt.push(parseFloat(dt[ft.normal_y])),rt.push(parseFloat(dt[ft.normal_z])))}}if(tt.data==="binary_compressed"){const ft=new Uint32Array(s.slice(tt.headerLen,tt.headerLen+8)),ht=ft[0],mt=ft[1],lt=j(new Uint8Array(s,tt.headerLen+8,ht),mt),ut=new DataView(lt.buffer),dt=tt.offset;for(let gt=0;gt<tt.points;gt++)dt.x!==void 0&&(nt.push(ut.getFloat32(tt.points*dt.x+tt.size[0]*gt,this.littleEndian)),nt.push(ut.getFloat32(tt.points*dt.y+tt.size[1]*gt,this.littleEndian)),nt.push(ut.getFloat32(tt.points*dt.z+tt.size[2]*gt,this.littleEndian))),dt.rgb!==void 0&&(it.push(ut.getUint8(tt.points*dt.rgb+tt.size[3]*gt+2)/255),it.push(ut.getUint8(tt.points*dt.rgb+tt.size[3]*gt+1)/255),it.push(ut.getUint8(tt.points*dt.rgb+tt.size[3]*gt+0)/255)),dt.normal_x!==void 0&&(rt.push(ut.getFloat32(tt.points*dt.normal_x+tt.size[4]*gt,this.littleEndian)),rt.push(ut.getFloat32(tt.points*dt.normal_y+tt.size[5]*gt,this.littleEndian)),rt.push(ut.getFloat32(tt.points*dt.normal_z+tt.size[6]*gt,this.littleEndian)))}if(tt.data==="binary"){const ft=new DataView(s,tt.headerLen),ht=tt.offset;for(let mt=0,lt=0;mt<tt.points;mt++,lt+=tt.rowSize)ht.x!==void 0&&(nt.push(ft.getFloat32(lt+ht.x,this.littleEndian)),nt.push(ft.getFloat32(lt+ht.y,this.littleEndian)),nt.push(ft.getFloat32(lt+ht.z,this.littleEndian))),ht.rgb!==void 0&&(it.push(ft.getUint8(lt+ht.rgb+2)/255),it.push(ft.getUint8(lt+ht.rgb+1)/255),it.push(ft.getUint8(lt+ht.rgb+0)/255)),ht.normal_x!==void 0&&(rt.push(ft.getFloat32(lt+ht.normal_x,this.littleEndian)),rt.push(ft.getFloat32(lt+ht.normal_y,this.littleEndian)),rt.push(ft.getFloat32(lt+ht.normal_z,this.littleEndian)))}const st=new BufferGeometry;nt.length>0&&st.setAttribute("position",new Float32BufferAttribute(nt,3)),rt.length>0&&st.setAttribute("normal",new Float32BufferAttribute(rt,3)),it.length>0&&st.setAttribute("color",new Float32BufferAttribute(it,3)),st.computeBoundingSphere();const at=new PointsMaterial({size:.005});it.length>0?at.vertexColors=!0:at.color.setHex(Math.random()*16777215);const ot=new Points(st,at);let ct=o.split("").reverse().join("");return ct=/([^\/]*)/.exec(ct),ct=ct[1].split("").reverse().join(""),ot.name=ct,ot}}class LWO2Parser{constructor(s){this.IFF=s}parseBlock(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();const s=this.IFF.reader.getIDTag();let o=this.IFF.reader.getUint32();switch(o>this.IFF.reader.dv.byteLength-this.IFF.reader.offset&&(this.IFF.reader.offset-=4,o=this.IFF.reader.getUint16()),this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=o,s){case"FORM":this.IFF.parseForm(o);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"AUVO":case"STCK":case"PROC":case"VALU":case"FUNC":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NVSK":case"NCRD":case"WRPW":case"WRPH":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"NODS":case"VERS":case"ENUM":case"TAG ":case"OPAC":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"GLOW":case"GVAL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(o);break;case"SURF":this.IFF.parseSurfaceLwo2(o);break;case"CLIP":this.IFF.parseClipLwo2(o);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":o===4?this.IFF.currentNode[s]=this.IFF.reader.getInt32():this.IFF.reader.skip(o);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(o);break;case"PNTS":this.IFF.parsePoints(o);break;case"VMAP":this.IFF.parseVertexMapping(o);break;case"AUVU":case"AUVN":this.IFF.reader.skip(o-1),this.IFF.reader.getVariableLengthIndex();break;case"POLS":this.IFF.parsePolygonList(o);break;case"TAGS":this.IFF.parseTagStrings(o);break;case"PTAG":this.IFF.parsePolygonTagMapping(o);break;case"VMAD":this.IFF.parseVertexMapping(o,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":const j=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=j;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":o===4?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(o);break;case"SMAN":const $=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!($<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.reader.skip(2);break;case"TMAP":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(o);break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(o);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;case"BLOK":break;default:this.IFF.parseUnknownCHUNK(s,o)}s!="FORM"&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=s,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}}class LWO3Parser{constructor(s){this.IFF=s}parseBlock(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();const s=this.IFF.reader.getIDTag(),o=this.IFF.reader.getUint32();switch(this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=o,s){case"FORM":this.IFF.parseForm(o);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"STCK":case"VALU":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NCRD":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"VERS":case"ENUM":case"TAG ":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"GLOW":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(o);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":o===4?this.IFF.currentNode[s]=this.IFF.reader.getInt32():this.IFF.reader.skip(o);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(o);break;case"PNTS":this.IFF.parsePoints(o);break;case"VMAP":this.IFF.parseVertexMapping(o);break;case"POLS":this.IFF.parsePolygonList(o);break;case"TAGS":this.IFF.parseTagStrings(o);break;case"PTAG":this.IFF.parsePolygonTagMapping(o);break;case"VMAD":this.IFF.parseVertexMapping(o,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":const j=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=j;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":o===4?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(o);break;case"SMAN":const $=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!($<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.currentSurface.attributes.imageMapIndex=this.IFF.reader.getUint32();break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(o);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;default:this.IFF.parseUnknownCHUNK(s,o)}s!="FORM"&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=s,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}}class IFFParser{constructor(){this.debugger=new Debugger}parse(s){if(this.reader=new DataViewReader(s),this.tree={materials:{},layers:[],tags:[],textures:[]},this.currentLayer=this.tree,this.currentForm=this.tree,this.parseTopForm(),this.tree.format!==void 0){if(this.tree.format==="LWO2")for(this.parser=new LWO2Parser(this);!this.reader.endOfFile();)this.parser.parseBlock();else if(this.tree.format==="LWO3")for(this.parser=new LWO3Parser(this);!this.reader.endOfFile();)this.parser.parseBlock();return this.debugger.offset=this.reader.offset,this.debugger.closeForms(),this.tree}}parseTopForm(){this.debugger.offset=this.reader.offset;var s=this.reader.getIDTag();if(s!=="FORM"){console.warn("LWOLoader: Top-level FORM missing.");return}var o=this.reader.getUint32();this.debugger.dataOffset=this.reader.offset,this.debugger.length=o;var j=this.reader.getIDTag();j==="LWO2"?this.tree.format=j:j==="LWO3"&&(this.tree.format=j),this.debugger.node=0,this.debugger.nodeID=j,this.debugger.log()}parseForm(s){var o=this.reader.getIDTag();switch(o){case"ISEQ":case"ANIM":case"STCC":case"VPVL":case"VPRM":case"NROT":case"WRPW":case"WRPH":case"FUNC":case"FALL":case"OPAC":case"GRAD":case"ENVS":case"VMOP":case"VMBG":case"OMAX":case"STEX":case"CKBG":case"CKEY":case"VMLA":case"VMLB":this.debugger.skipped=!0,this.skipForm(s);break;case"META":case"NNDS":case"NODS":case"NDTA":case"ADAT":case"AOVS":case"BLOK":case"IBGC":case"IOPC":case"IIMG":case"TXTR":this.debugger.length=4,this.debugger.skipped=!0;break;case"IFAL":case"ISCL":case"IPOS":case"IROT":case"IBMP":case"IUTD":case"IVTD":this.parseTextureNodeAttribute(o);break;case"ENVL":this.parseEnvelope(s);break;case"CLIP":this.tree.format==="LWO2"?this.parseForm(s):this.parseClip(s);break;case"STIL":this.parseImage();break;case"XREF":this.reader.skip(8),this.currentForm.referenceTexture={index:this.reader.getUint32(),refName:this.reader.getString()};break;case"IMST":this.parseImageStateForm(s);break;case"SURF":this.parseSurfaceForm(s);break;case"VALU":this.parseValueForm(s);break;case"NTAG":this.parseSubNode(s);break;case"ATTR":case"SATR":this.setupForm("attributes",s);break;case"NCON":this.parseConnections(s);break;case"SSHA":this.parentForm=this.currentForm,this.currentForm=this.currentSurface,this.setupForm("surfaceShader",s);break;case"SSHD":this.setupForm("surfaceShaderData",s);break;case"ENTR":this.parseEntryForm(s);break;case"IMAP":this.parseImageMap(s);break;case"TAMP":this.parseXVAL("amplitude",s);break;case"TMAP":this.setupForm("textureMap",s);break;case"CNTR":this.parseXVAL3("center",s);break;case"SIZE":this.parseXVAL3("scale",s);break;case"ROTA":this.parseXVAL3("rotation",s);break;default:this.parseUnknownForm(o,s)}this.debugger.node=0,this.debugger.nodeID=o,this.debugger.log()}setupForm(s,o){this.currentForm||(this.currentForm=this.currentNode),this.currentFormEnd=this.reader.offset+o,this.parentForm=this.currentForm,this.currentForm[s]?(console.warn("LWOLoader: form already exists on parent: ",s,this.currentForm),this.currentForm=this.currentForm[s]):(this.currentForm[s]={},this.currentForm=this.currentForm[s])}skipForm(s){this.reader.skip(s-4)}parseUnknownForm(s,o){console.warn("LWOLoader: unknown FORM encountered: "+s,o),printBuffer(this.reader.dv.buffer,this.reader.offset,o-4),this.reader.skip(o-4)}parseSurfaceForm(s){this.reader.skip(8);var o=this.reader.getString(),j={attributes:{},connections:{},name:o,inputName:o,nodes:{},source:this.reader.getString()};this.tree.materials[o]=j,this.currentSurface=j,this.parentForm=this.tree.materials,this.currentForm=j,this.currentFormEnd=this.reader.offset+s}parseSurfaceLwo2(s){var o=this.reader.getString(),j={attributes:{},connections:{},name:o,nodes:{},source:this.reader.getString()};this.tree.materials[o]=j,this.currentSurface=j,this.parentForm=this.tree.materials,this.currentForm=j,this.currentFormEnd=this.reader.offset+s}parseSubNode(s){this.reader.skip(8);var o=this.reader.getString(),j={name:o};this.currentForm=j,this.currentNode=j,this.currentFormEnd=this.reader.offset+s}parseConnections(s){this.currentFormEnd=this.reader.offset+s,this.parentForm=this.currentForm,this.currentForm=this.currentSurface.connections}parseEntryForm(s){this.reader.skip(8);var o=this.reader.getString();this.currentForm=this.currentNode.attributes,this.setupForm(o,s)}parseValueForm(){this.reader.skip(8);var s=this.reader.getString();s==="double"?this.currentForm.value=this.reader.getUint64():s==="int"?this.currentForm.value=this.reader.getUint32():s==="vparam"?(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64()):s==="vparam3"&&(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64Array(3))}parseImageStateForm(){this.reader.skip(8),this.currentForm.mipMapLevel=this.reader.getFloat32()}parseImageMap(s){this.currentFormEnd=this.reader.offset+s,this.parentForm=this.currentForm,this.currentForm.maps||(this.currentForm.maps=[]);var o={};this.currentForm.maps.push(o),this.currentForm=o,this.reader.skip(10)}parseTextureNodeAttribute(s){switch(this.reader.skip(28),this.reader.skip(20),s){case"ISCL":this.currentNode.scale=this.reader.getFloat32Array(3);break;case"IPOS":this.currentNode.position=this.reader.getFloat32Array(3);break;case"IROT":this.currentNode.rotation=this.reader.getFloat32Array(3);break;case"IFAL":this.currentNode.falloff=this.reader.getFloat32Array(3);break;case"IBMP":this.currentNode.amplitude=this.reader.getFloat32();break;case"IUTD":this.currentNode.uTiles=this.reader.getFloat32();break;case"IVTD":this.currentNode.vTiles=this.reader.getFloat32();break}this.reader.skip(2)}parseEnvelope(s){this.reader.skip(s-4)}parseClip(s){var o=this.reader.getIDTag();if(o==="FORM"){this.reader.skip(16),this.currentNode.fileName=this.reader.getString();return}this.reader.setOffset(this.reader.offset-4),this.currentFormEnd=this.reader.offset+s,this.parentForm=this.currentForm,this.reader.skip(8);var j={index:this.reader.getUint32()};this.tree.textures.push(j),this.currentForm=j}parseClipLwo2(s){for(var o={index:this.reader.getUint32(),fileName:""};;){var j=this.reader.getIDTag(),$=this.reader.getUint16();if(j==="STIL"){o.fileName=this.reader.getString();break}if($>=s)break}this.tree.textures.push(o),this.currentForm=o}parseImage(){this.reader.skip(8),this.currentForm.fileName=this.reader.getString()}parseXVAL(s,o){var j=this.reader.offset+o-4;this.reader.skip(8),this.currentForm[s]=this.reader.getFloat32(),this.reader.setOffset(j)}parseXVAL3(s,o){var j=this.reader.offset+o-4;this.reader.skip(8),this.currentForm[s]={x:this.reader.getFloat32(),y:this.reader.getFloat32(),z:this.reader.getFloat32()},this.reader.setOffset(j)}parseObjectTag(){this.tree.objectTags||(this.tree.objectTags={}),this.tree.objectTags[this.reader.getIDTag()]={tagString:this.reader.getString()}}parseLayer(s){var o={number:this.reader.getUint16(),flags:this.reader.getUint16(),pivot:this.reader.getFloat32Array(3),name:this.reader.getString()};this.tree.layers.push(o),this.currentLayer=o;var j=16+stringOffset(this.currentLayer.name);this.currentLayer.parent=j<s?this.reader.getUint16():-1}parsePoints(s){this.currentPoints=[];for(var o=0;o<s/4;o+=3)this.currentPoints.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32())}parseVertexMapping(s,o){var j=this.reader.offset+s,$=this.reader.getString();if(this.reader.offset===j){this.currentForm.UVChannel=$;return}this.reader.setOffset(this.reader.offset-stringOffset($));var _e=this.reader.getIDTag();this.reader.getUint16();var tt=this.reader.getString(),nt=s-6-stringOffset(tt);switch(_e){case"TXUV":this.parseUVMapping(tt,j,o);break;case"MORF":case"SPOT":this.parseMorphTargets(tt,j,_e);break;case"APSL":case"NORM":case"WGHT":case"MNVW":case"PICK":case"RGB ":case"RGBA":this.reader.skip(nt);break;default:console.warn("LWOLoader: unknown vertex map type: "+_e),this.reader.skip(nt)}}parseUVMapping(s,o,j){for(var $=[],_e=[],tt=[];this.reader.offset<o;)$.push(this.reader.getVariableLengthIndex()),j&&_e.push(this.reader.getVariableLengthIndex()),tt.push(this.reader.getFloat32(),this.reader.getFloat32());j?(this.currentLayer.discontinuousUVs||(this.currentLayer.discontinuousUVs={}),this.currentLayer.discontinuousUVs[s]={uvIndices:$,polyIndices:_e,uvs:tt}):(this.currentLayer.uvs||(this.currentLayer.uvs={}),this.currentLayer.uvs[s]={uvIndices:$,uvs:tt})}parseMorphTargets(s,o,j){var $=[],_e=[];for(j=j==="MORF"?"relative":"absolute";this.reader.offset<o;)$.push(this.reader.getVariableLengthIndex()),_e.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32());this.currentLayer.morphTargets||(this.currentLayer.morphTargets={}),this.currentLayer.morphTargets[s]={indices:$,points:_e,type:j}}parsePolygonList(s){for(var o=this.reader.offset+s,j=this.reader.getIDTag(),$=[],_e=[];this.reader.offset<o;){var tt=this.reader.getUint16();tt=tt&1023,_e.push(tt);for(var nt=0;nt<tt;nt++)$.push(this.reader.getVariableLengthIndex())}var rt={type:j,vertexIndices:$,polygonDimensions:_e,points:this.currentPoints};_e[0]===1?rt.type="points":_e[0]===2&&(rt.type="lines"),this.currentLayer.geometry=rt}parseTagStrings(s){this.tree.tags=this.reader.getStringArray(s)}parsePolygonTagMapping(s){var o=this.reader.offset+s,j=this.reader.getIDTag();j==="SURF"?this.parseMaterialIndices(o):this.reader.skip(s-4)}parseMaterialIndices(s){for(this.currentLayer.geometry.materialIndices=[];this.reader.offset<s;){var o=this.reader.getVariableLengthIndex(),j=this.reader.getUint16();this.currentLayer.geometry.materialIndices.push(o,j)}}parseUnknownCHUNK(s,o){console.warn("LWOLoader: unknown chunk type: "+s+" length: "+o);var j=this.reader.getString(o);this.currentForm[s]=j}}class DataViewReader{constructor(s){this.dv=new DataView(s),this.offset=0,this._textDecoder=new TextDecoder,this._bytes=new Uint8Array(s)}size(){return this.dv.buffer.byteLength}setOffset(s){s>0&&s<this.dv.buffer.byteLength?this.offset=s:console.error("LWOLoader: invalid buffer offset")}endOfFile(){return this.offset>=this.size()}skip(s){this.offset+=s}getUint8(){var s=this.dv.getUint8(this.offset);return this.offset+=1,s}getUint16(){var s=this.dv.getUint16(this.offset);return this.offset+=2,s}getInt32(){var s=this.dv.getInt32(this.offset,!1);return this.offset+=4,s}getUint32(){var s=this.dv.getUint32(this.offset,!1);return this.offset+=4,s}getUint64(){var s,o;return o=this.getUint32(),s=this.getUint32(),o*4294967296+s}getFloat32(){var s=this.dv.getFloat32(this.offset,!1);return this.offset+=4,s}getFloat32Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getFloat32());return o}getFloat64(){var s=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,s}getFloat64Array(s){for(var o=[],j=0;j<s;j++)o.push(this.getFloat64());return o}getVariableLengthIndex(){var s=this.getUint8();return s===255?this.getUint8()*65536+this.getUint8()*256+this.getUint8():s*256+this.getUint8()}getIDTag(){return this.getString(4)}getString(s){if(s===0)return;const o=this.offset;let j,$;return s?($=s,j=this._textDecoder.decode(new Uint8Array(this.dv.buffer,o,s))):($=this._bytes.indexOf(0,o)-o,j=this._textDecoder.decode(new Uint8Array(this.dv.buffer,o,$)),$++,$+=$%2),this.skip($),j}getStringArray(s){var o=this.getString(s);return o=o.split("\0"),o.filter(Boolean)}}class Debugger{constructor(){this.active=!1,this.depth=0,this.formList=[]}enable(){this.active=!0}log(){if(this.active){var s;switch(this.node){case 0:s="FORM";break;case 1:s="CHK";break;case 2:s="S-CHK";break}console.log("| ".repeat(this.depth)+s,this.nodeID,`( ${this.offset} ) -> ( ${this.dataOffset+this.length} )`,this.node==0?" {":"",this.skipped?"SKIPPED":"",this.node==0&&this.skipped?"}":""),this.node==0&&!this.skipped&&(this.depth+=1,this.formList.push(this.dataOffset+this.length)),this.skipped=!1}}closeForms(){if(this.active)for(var s=this.formList.length-1;s>=0;s--)this.offset>=this.formList[s]&&(this.depth-=1,console.log("| ".repeat(this.depth)+"}"),this.formList.splice(-1,1))}}function isEven(a){return a%2}function stringOffset(a){return a.length+1+(isEven(a.length+1)?1:0)}function printBuffer(a,s,o){console.log(new TextDecoder().decode(new Uint8Array(a,s,o)))}let _lwoTree;class LWOLoader extends Loader{constructor(s,o={}){super(s),this.resourcePath=o.resourcePath!==void 0?o.resourcePath:""}load(s,o,j,$){const _e=this,tt=_e.path===""?extractParentUrl(s,"Objects"):_e.path,nt=s.split(tt).pop().split(".")[0],rt=new FileLoader(this.manager);rt.setPath(_e.path),rt.setResponseType("arraybuffer"),rt.load(s,function(it){try{o(_e.parse(it,tt,nt))}catch(st){$?$(st):console.error(st),_e.manager.itemError(s)}},j,$)}parse(s,o,j){_lwoTree=new IFFParser().parse(s);const $=new TextureLoader(this.manager).setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);return new LWOTreeParser($).parse(j)}}class LWOTreeParser{constructor(s){this.textureLoader=s}parse(s){return this.materials=new MaterialParser(this.textureLoader).parse(),this.defaultLayerName=s,this.meshes=this.parseLayers(),{materials:this.materials,meshes:this.meshes}}parseLayers(){const s=[],o=[],j=new GeometryParser,$=this;return _lwoTree.layers.forEach(function(_e){const tt=j.parse(_e.geometry,_e),nt=$.parseMesh(tt,_e);s[_e.number]=nt,_e.parent===-1?o.push(nt):s[_e.parent].add(nt)}),this.applyPivots(o),o}parseMesh(s,o){let j;const $=this.getMaterials(s.userData.matNames,o.geometry.type);return this.duplicateUVs(s,$),o.geometry.type==="points"?j=new Points(s,$):o.geometry.type==="lines"?j=new LineSegments(s,$):j=new Mesh(s,$),o.name?j.name=o.name:j.name=this.defaultLayerName+"_layer_"+o.number,j.userData.pivot=o.pivot,j}applyPivots(s){s.forEach(function(o){o.traverse(function(j){const $=j.userData.pivot;if(j.position.x+=$[0],j.position.y+=$[1],j.position.z+=$[2],j.parent){const _e=j.parent.userData.pivot;j.position.x-=_e[0],j.position.y-=_e[1],j.position.z-=_e[2]}})})}getMaterials(s,o){const j=[],$=this;s.forEach(function(tt,nt){j[nt]=$.getMaterialByName(tt)}),(o==="points"||o==="lines")&&j.forEach(function(tt,nt){const rt={color:tt.color};o==="points"?(rt.size=.1,rt.map=tt.map,rt.morphTargets=tt.morphTargets,j[nt]=new PointsMaterial(rt)):o==="lines"&&(j[nt]=new LineBasicMaterial(rt))});const _e=j.filter(Boolean);return _e.length===1?_e[0]:j}getMaterialByName(s){return this.materials.filter(function(o){return o.name===s})[0]}duplicateUVs(s,o){let j=!1;Array.isArray(o)?o.forEach(function($){$.aoMap&&(j=!0)}):o.aoMap&&(j=!0),j&&s.setAttribute("uv2",new BufferAttribute(s.attributes.uv.array,2))}}class MaterialParser{constructor(s){this.textureLoader=s}parse(){const s=[];this.textures={};for(const o in _lwoTree.materials)_lwoTree.format==="LWO3"?s.push(this.parseMaterial(_lwoTree.materials[o],o,_lwoTree.textures)):_lwoTree.format==="LWO2"&&s.push(this.parseMaterialLwo2(_lwoTree.materials[o],o,_lwoTree.textures));return s}parseMaterial(s,o,j){let $={name:o,side:this.getSide(s.attributes),flatShading:this.getSmooth(s.attributes)};const _e=this.parseConnections(s.connections,s.nodes),tt=this.parseTextureNodes(_e.maps);this.parseAttributeImageMaps(_e.attributes,j,tt,s.maps);const nt=this.parseAttributes(_e.attributes,tt);this.parseEnvMap(_e,tt,nt),$=Object.assign(tt,$),$=Object.assign($,nt);const rt=this.getMaterialType(_e.attributes);return new rt($)}parseMaterialLwo2(s,o){let j={name:o,side:this.getSide(s.attributes),flatShading:this.getSmooth(s.attributes)};const $=this.parseAttributes(s.attributes,{});return j=Object.assign(j,$),new MeshPhongMaterial(j)}getSide(s){if(!s.side)return BackSide;switch(s.side){case 0:case 1:return BackSide;case 2:return FrontSide;case 3:return DoubleSide}}getSmooth(s){return s.smooth?!s.smooth:!0}parseConnections(s,o){const j={maps:{}},$=s.inputName,_e=s.inputNodeName,tt=s.nodeName,nt=this;return $.forEach(function(rt,it){if(rt==="Material"){const st=nt.getNodeByRefName(_e[it],o);j.attributes=st.attributes,j.envMap=st.fileName,j.name=_e[it]}}),tt.forEach(function(rt,it){rt===j.name&&(j.maps[$[it]]=nt.getNodeByRefName(_e[it],o))}),j}getNodeByRefName(s,o){for(const j in o)if(o[j].refName===s)return o[j]}parseTextureNodes(s){const o={};for(const j in s){const $=s[j],_e=$.fileName;if(!_e)return;const tt=this.loadTexture(_e);switch($.widthWrappingMode!==void 0&&(tt.wrapS=this.getWrappingType($.widthWrappingMode)),$.heightWrappingMode!==void 0&&(tt.wrapT=this.getWrappingType($.heightWrappingMode)),j){case"Color":o.map=tt;break;case"Roughness":o.roughnessMap=tt,o.roughness=.5;break;case"Specular":o.specularMap=tt,o.specular=16777215;break;case"Luminous":o.emissiveMap=tt,o.emissive=8421504;break;case"Luminous Color":o.emissive=8421504;break;case"Metallic":o.metalnessMap=tt,o.metalness=.5;break;case"Transparency":case"Alpha":o.alphaMap=tt,o.transparent=!0;break;case"Normal":o.normalMap=tt,$.amplitude!==void 0&&(o.normalScale=new Vector2($.amplitude,$.amplitude));break;case"Bump":o.bumpMap=tt;break}}return o.roughnessMap&&o.specularMap&&delete o.specularMap,o}parseAttributeImageMaps(s,o,j){for(const $ in s){const _e=s[$];if(_e.maps){const tt=_e.maps[0],nt=this.getTexturePathByIndex(tt.imageIndex,o);if(!nt)return;const rt=this.loadTexture(nt);switch(tt.wrap!==void 0&&(rt.wrapS=this.getWrappingType(tt.wrap.w)),tt.wrap!==void 0&&(rt.wrapT=this.getWrappingType(tt.wrap.h)),$){case"Color":j.map=rt;break;case"Diffuse":j.aoMap=rt;break;case"Roughness":j.roughnessMap=rt,j.roughness=1;break;case"Specular":j.specularMap=rt,j.specular=16777215;break;case"Luminosity":j.emissiveMap=rt,j.emissive=8421504;break;case"Metallic":j.metalnessMap=rt,j.metalness=1;break;case"Transparency":case"Alpha":j.alphaMap=rt,j.transparent=!0;break;case"Normal":j.normalMap=rt;break;case"Bump":j.bumpMap=rt;break}}}}parseAttributes(s,o){const j={};return s.Color&&!o.map?j.color=new Color().fromArray(s.Color.value):j.color=new Color,s.Transparency&&s.Transparency.value!==0&&(j.opacity=1-s.Transparency.value,j.transparent=!0),s["Bump Height"]&&(j.bumpScale=s["Bump Height"].value*.1),s["Refraction Index"]&&(j.refractionRatio=1/s["Refraction Index"].value),this.parsePhysicalAttributes(j,s,o),this.parseStandardAttributes(j,s,o),this.parsePhongAttributes(j,s,o),j}parsePhysicalAttributes(s,o){o.Clearcoat&&o.Clearcoat.value>0&&(s.clearcoat=o.Clearcoat.value,o["Clearcoat Gloss"]&&(s.clearcoatRoughness=.5*(1-o["Clearcoat Gloss"].value)))}parseStandardAttributes(s,o,j){o.Luminous&&(s.emissiveIntensity=o.Luminous.value,o["Luminous Color"]&&!j.emissive?s.emissive=new Color().fromArray(o["Luminous Color"].value):s.emissive=new Color(8421504)),o.Roughness&&!j.roughnessMap&&(s.roughness=o.Roughness.value),o.Metallic&&!j.metalnessMap&&(s.metalness=o.Metallic.value)}parsePhongAttributes(s,o,j){o.Diffuse&&s.color.multiplyScalar(o.Diffuse.value),o.Reflection&&(s.reflectivity=o.Reflection.value,s.combine=AddOperation),o.Luminosity&&(s.emissiveIntensity=o.Luminosity.value,!j.emissiveMap&&!j.map?s.emissive=s.color:s.emissive=new Color(8421504)),!o.Roughness&&o.Specular&&!j.specularMap&&(o["Color Highlight"]?s.specular=new Color().setScalar(o.Specular.value).lerp(s.color.clone().multiplyScalar(o.Specular.value),o["Color Highlight"].value):s.specular=new Color().setScalar(o.Specular.value)),s.specular&&o.Glossiness&&(s.shininess=7+Math.pow(2,o.Glossiness.value*12+2))}parseEnvMap(s,o,j){if(s.envMap){const $=this.loadTexture(s.envMap);j.transparent&&j.opacity<.999?($.mapping=EquirectangularRefractionMapping,j.reflectivity!==void 0&&(delete j.reflectivity,delete j.combine),j.metalness!==void 0&&delete j.metalness):$.mapping=EquirectangularReflectionMapping,o.envMap=$}}getTexturePathByIndex(s){let o="";return _lwoTree.textures&&_lwoTree.textures.forEach(function(j){j.index===s&&(o=j.fileName)}),o}loadTexture(s){return s?this.textureLoader.load(s,void 0,void 0,function(){console.warn("LWOLoader: non-standard resource hierarchy. Use `resourcePath` parameter to specify root content directory.")}):null}getWrappingType(s){switch(s){case 0:return console.warn('LWOLoader: "Reset" texture wrapping type is not supported in three.js'),ClampToEdgeWrapping;case 1:return RepeatWrapping;case 2:return MirroredRepeatWrapping;case 3:return ClampToEdgeWrapping}}getMaterialType(s){return s.Clearcoat&&s.Clearcoat.value>0?MeshPhysicalMaterial:s.Roughness?MeshStandardMaterial:MeshPhongMaterial}}class GeometryParser{parse(s,o){const j=new BufferGeometry;j.setAttribute("position",new Float32BufferAttribute(s.points,3));const $=this.splitIndices(s.vertexIndices,s.polygonDimensions);return j.setIndex($),this.parseGroups(j,s),j.computeVertexNormals(),this.parseUVs(j,o,$),this.parseMorphTargets(j,o,$),j.translate(-o.pivot[0],-o.pivot[1],-o.pivot[2]),j}splitIndices(s,o){const j=[];let $=0;return o.forEach(function(_e){if(_e<4)for(let tt=0;tt<_e;tt++)j.push(s[$+tt]);else if(_e===4)j.push(s[$],s[$+1],s[$+2],s[$],s[$+2],s[$+3]);else if(_e>4){for(let tt=1;tt<_e-1;tt++)j.push(s[$],s[$+tt],s[$+tt+1]);console.warn("LWOLoader: polygons with greater than 4 sides are not supported")}$+=_e}),j}parseGroups(s,o){const j=_lwoTree.tags,$=[];let _e=3;o.type==="lines"&&(_e=2),o.type==="points"&&(_e=1);const tt=this.splitMaterialIndices(o.polygonDimensions,o.materialIndices);let nt=0;const rt={};let it,st,at=0,ot=0;for(let ct=0;ct<tt.length;ct+=2){if(st=tt[ct+1],ct===0&&($[nt]=j[st]),it===void 0&&(it=st),st!==it){let ft;rt[j[it]]?ft=rt[j[it]]:(ft=nt,rt[j[it]]=nt,$[nt]=j[it],nt++),s.addGroup(at,ot,ft),at+=ot,it=st,ot=0}ot+=_e}if(s.groups.length>0){let ct;rt[j[st]]?ct=rt[j[st]]:(ct=nt,rt[j[st]]=nt,$[nt]=j[st]),s.addGroup(at,ot,ct)}s.userData.matNames=$}splitMaterialIndices(s,o){const j=[];return s.forEach(function($,_e){if($<=3)j.push(o[_e*2],o[_e*2+1]);else if($===4)j.push(o[_e*2],o[_e*2+1],o[_e*2],o[_e*2+1]);else for(let tt=0;tt<$-2;tt++)j.push(o[_e*2],o[_e*2+1])}),j}parseUVs(s,o){const j=Array.from(Array(s.attributes.position.count*2),function(){return 0});for(const $ in o.uvs){const _e=o.uvs[$].uvs;o.uvs[$].uvIndices.forEach(function(nt,rt){j[nt*2]=_e[rt*2],j[nt*2+1]=_e[rt*2+1]})}s.setAttribute("uv",new Float32BufferAttribute(j,2))}parseMorphTargets(s,o){let j=0;for(const $ in o.morphTargets){const _e=s.attributes.position.array.slice();s.morphAttributes.position||(s.morphAttributes.position=[]);const tt=o.morphTargets[$].points,nt=o.morphTargets[$].indices,rt=o.morphTargets[$].type;nt.forEach(function(it,st){rt==="relative"?(_e[it*3]+=tt[st*3],_e[it*3+1]+=tt[st*3+1],_e[it*3+2]+=tt[st*3+2]):(_e[it*3]=tt[st*3],_e[it*3+1]=tt[st*3+1],_e[it*3+2]=tt[st*3+2])}),s.morphAttributes.position[j]=new Float32BufferAttribute(_e,3),s.morphAttributes.position[j].name=$,j++}s.morphTargetsRelative=!1}}function extractParentUrl(a,s){const o=a.indexOf(s);return o===-1?"./":a.substr(0,o)}class PLYLoader extends Loader{constructor(s){super(s),this.propertyNameMapping={}}load(s,o,j,$){const _e=this,tt=new FileLoader(this.manager);tt.setPath(this.path),tt.setResponseType("arraybuffer"),tt.setRequestHeader(this.requestHeader),tt.setWithCredentials(this.withCredentials),tt.load(s,function(nt){try{o(_e.parse(nt))}catch(rt){$?$(rt):console.error(rt),_e.manager.itemError(s)}},j,$)}setPropertyNameMapping(s){this.propertyNameMapping=s}parse(s){function o(ct){const ft=/ply([\s\S]*)end_header\r?\n/;let ht="",mt=0;const lt=ft.exec(ct);lt!==null&&(ht=lt[1],mt=new Blob([lt[0]]).size);const ut={comments:[],elements:[],headerLength:mt,objInfo:""},dt=ht.split(`
`);let gt;function Et(St,Tt){const Mt={type:St[0]};return Mt.type==="list"?(Mt.name=St[3],Mt.countType=St[1],Mt.itemType=St[2]):Mt.name=St[1],Mt.name in Tt&&(Mt.name=Tt[Mt.name]),Mt}for(let St=0;St<dt.length;St++){let Tt=dt[St];if(Tt=Tt.trim(),Tt==="")continue;const Mt=Tt.split(/\s+/),Bt=Mt.shift();switch(Tt=Mt.join(" "),Bt){case"format":ut.format=Mt[0],ut.version=Mt[1];break;case"comment":ut.comments.push(Tt);break;case"element":gt!==void 0&&ut.elements.push(gt),gt={},gt.name=Mt[0],gt.count=parseInt(Mt[1]),gt.properties=[];break;case"property":gt.properties.push(Et(Mt,ot.propertyNameMapping));break;case"obj_info":ut.objInfo=Tt;break;default:console.log("unhandled",Bt,Mt)}}return gt!==void 0&&ut.elements.push(gt),ut}function j(ct,ft){switch(ft){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(ct);case"float":case"double":case"float32":case"float64":return parseFloat(ct)}}function $(ct,ft){const ht=ft.split(/\s+/),mt={};for(let lt=0;lt<ct.length;lt++)if(ct[lt].type==="list"){const ut=[],dt=j(ht.shift(),ct[lt].countType);for(let gt=0;gt<dt;gt++)ut.push(j(ht.shift(),ct[lt].itemType));mt[ct[lt].name]=ut}else mt[ct[lt].name]=j(ht.shift(),ct[lt].type);return mt}function _e(ct,ft){const ht={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let mt;const lt=/end_header\s([\s\S]*)$/;let ut="";(mt=lt.exec(ct))!==null&&(ut=mt[1]);const dt=ut.split(`
`);let gt=0,Et=0;for(let St=0;St<dt.length;St++){let Tt=dt[St];if(Tt=Tt.trim(),Tt==="")continue;Et>=ft.elements[gt].count&&(gt++,Et=0);const Mt=$(ft.elements[gt].properties,Tt);nt(ht,ft.elements[gt].name,Mt),Et++}return tt(ht)}function tt(ct){let ft=new BufferGeometry;return ct.indices.length>0&&ft.setIndex(ct.indices),ft.setAttribute("position",new Float32BufferAttribute(ct.vertices,3)),ct.normals.length>0&&ft.setAttribute("normal",new Float32BufferAttribute(ct.normals,3)),ct.uvs.length>0&&ft.setAttribute("uv",new Float32BufferAttribute(ct.uvs,2)),ct.colors.length>0&&ft.setAttribute("color",new Float32BufferAttribute(ct.colors,3)),ct.faceVertexUvs.length>0&&(ft=ft.toNonIndexed(),ft.setAttribute("uv",new Float32BufferAttribute(ct.faceVertexUvs,2))),ft.computeBoundingSphere(),ft}function nt(ct,ft,ht){if(ft==="vertex")ct.vertices.push(ht.x,ht.y,ht.z),"nx"in ht&&"ny"in ht&&"nz"in ht&&ct.normals.push(ht.nx,ht.ny,ht.nz),"s"in ht&&"t"in ht&&ct.uvs.push(ht.s,ht.t),"red"in ht&&"green"in ht&&"blue"in ht&&ct.colors.push(ht.red/255,ht.green/255,ht.blue/255);else if(ft==="face"){const mt=ht.vertex_indices||ht.vertex_index,lt=ht.texcoord;mt.length===3?(ct.indices.push(mt[0],mt[1],mt[2]),lt&&lt.length===6&&(ct.faceVertexUvs.push(lt[0],lt[1]),ct.faceVertexUvs.push(lt[2],lt[3]),ct.faceVertexUvs.push(lt[4],lt[5]))):mt.length===4&&(ct.indices.push(mt[0],mt[1],mt[3]),ct.indices.push(mt[1],mt[2],mt[3]))}}function rt(ct,ft,ht,mt){switch(ht){case"int8":case"char":return[ct.getInt8(ft),1];case"uint8":case"uchar":return[ct.getUint8(ft),1];case"int16":case"short":return[ct.getInt16(ft,mt),2];case"uint16":case"ushort":return[ct.getUint16(ft,mt),2];case"int32":case"int":return[ct.getInt32(ft,mt),4];case"uint32":case"uint":return[ct.getUint32(ft,mt),4];case"float32":case"float":return[ct.getFloat32(ft,mt),4];case"float64":case"double":return[ct.getFloat64(ft,mt),8]}}function it(ct,ft,ht,mt){const lt={};let ut,dt=0;for(let gt=0;gt<ht.length;gt++)if(ht[gt].type==="list"){const Et=[];ut=rt(ct,ft+dt,ht[gt].countType,mt);const St=ut[0];dt+=ut[1];for(let Tt=0;Tt<St;Tt++)ut=rt(ct,ft+dt,ht[gt].itemType,mt),Et.push(ut[0]),dt+=ut[1];lt[ht[gt].name]=Et}else ut=rt(ct,ft+dt,ht[gt].type,mt),lt[ht[gt].name]=ut[0],dt+=ut[1];return[lt,dt]}function st(ct,ft){const ht={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},mt=ft.format==="binary_little_endian",lt=new DataView(ct,ft.headerLength);let ut,dt=0;for(let gt=0;gt<ft.elements.length;gt++)for(let Et=0;Et<ft.elements[gt].count;Et++){ut=it(lt,dt,ft.elements[gt].properties,mt),dt+=ut[1];const St=ut[0];nt(ht,ft.elements[gt].name,St)}return tt(ht)}let at;const ot=this;if(s instanceof ArrayBuffer){const ct=LoaderUtils.decodeText(new Uint8Array(s)),ft=o(ct);at=ft.format==="ascii"?_e(ct,ft):st(s,ft)}else at=_e(s,o(s));return at}}const _box$1=new Box3,_vector=new Vector3;class LineSegmentsGeometry extends InstancedBufferGeometry{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const s=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],o=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],j=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(j),this.setAttribute("position",new Float32BufferAttribute(s,3)),this.setAttribute("uv",new Float32BufferAttribute(o,2))}applyMatrix4(s){const o=this.attributes.instanceStart,j=this.attributes.instanceEnd;return o!==void 0&&(o.applyMatrix4(s),j.applyMatrix4(s),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(s){let o;s instanceof Float32Array?o=s:Array.isArray(s)&&(o=new Float32Array(s));const j=new InstancedInterleavedBuffer(o,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute(j,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(j,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(s){let o;s instanceof Float32Array?o=s:Array.isArray(s)&&(o=new Float32Array(s));const j=new InstancedInterleavedBuffer(o,6,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute(j,3,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute(j,3,3)),this}fromWireframeGeometry(s){return this.setPositions(s.attributes.position.array),this}fromEdgesGeometry(s){return this.setPositions(s.attributes.position.array),this}fromMesh(s){return this.fromWireframeGeometry(new WireframeGeometry(s.geometry)),this}fromLineSegments(s){const o=s.geometry;return this.setPositions(o.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const s=this.attributes.instanceStart,o=this.attributes.instanceEnd;s!==void 0&&o!==void 0&&(this.boundingBox.setFromBufferAttribute(s),_box$1.setFromBufferAttribute(o),this.boundingBox.union(_box$1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingBox===null&&this.computeBoundingBox();const s=this.attributes.instanceStart,o=this.attributes.instanceEnd;if(s!==void 0&&o!==void 0){const j=this.boundingSphere.center;this.boundingBox.getCenter(j);let $=0;for(let _e=0,tt=s.count;_e<tt;_e++)_vector.fromBufferAttribute(s,_e),$=Math.max($,j.distanceToSquared(_vector)),_vector.fromBufferAttribute(o,_e),$=Math.max($,j.distanceToSquared(_vector));this.boundingSphere.radius=Math.sqrt($),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(s){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(s)}}class LineMaterial extends ShaderMaterial{constructor(s){super({type:"LineMaterial",uniforms:UniformsUtils.clone(UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <color_pars_vertex>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				attribute vec3 instanceColorStart;
				attribute vec3 instanceColorEnd;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <color_pars_fragment>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );

					#include <logdepthbuf_fragment>
					#include <color_fragment>

					gl_FragColor = vec4( diffuseColor.rgb, alpha );

					#include <tonemapping_fragment>
					#include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(o){this.uniforms.diffuse.value=o}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(o){o===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(o){this.uniforms.linewidth.value=o}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(o){Boolean(o)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),o===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(o){this.uniforms.dashScale.value=o}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(o){this.uniforms.dashSize.value=o}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(o){this.uniforms.dashOffset.value=o}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(o){this.uniforms.gapSize.value=o}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(o){this.uniforms.opacity.value=o}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(o){this.uniforms.resolution.value.copy(o)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)},set:function(o){Boolean(o)!==Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),o===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(s)}}const _start$1=new Vector3,_end$1=new Vector3;class Wireframe extends Mesh{constructor(s=new LineSegmentsGeometry,o=new LineMaterial({color:Math.random()*16777215})){super(s,o),this.isWireframe=!0,this.type="Wireframe"}computeLineDistances(){const s=this.geometry,o=s.attributes.instanceStart,j=s.attributes.instanceEnd,$=new Float32Array(2*o.count);for(let tt=0,nt=0,rt=o.count;tt<rt;tt++,nt+=2)_start$1.fromBufferAttribute(o,tt),_end$1.fromBufferAttribute(j,tt),$[nt]=nt===0?0:$[nt-1],$[nt+1]=$[nt]+_start$1.distanceTo(_end$1);const _e=new InstancedInterleavedBuffer($,2,1);return s.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(_e,1,0)),s.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(_e,1,1)),this}}const _start=new Vector3,_end=new Vector3,_start4=new Vector4,_end4=new Vector4,_ssOrigin=new Vector4,_ssOrigin3=new Vector3,_mvMatrix=new Matrix4,_line=new Line3,_closestPoint=new Vector3,_box=new Box3,_sphere=new Sphere,_clipToWorldVector=new Vector4;let _ray,_instanceStart,_instanceEnd,_lineWidth;function getWorldSpaceHalfWidth(a,s,o){return _clipToWorldVector.set(0,0,-s,1).applyMatrix4(a.projectionMatrix),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),_clipToWorldVector.x=_lineWidth/o.width,_clipToWorldVector.y=_lineWidth/o.height,_clipToWorldVector.applyMatrix4(a.projectionMatrixInverse),_clipToWorldVector.multiplyScalar(1/_clipToWorldVector.w),Math.abs(Math.max(_clipToWorldVector.x,_clipToWorldVector.y))}function raycastWorldUnits(a,s){for(let o=0,j=_instanceStart.count;o<j;o++){_line.start.fromBufferAttribute(_instanceStart,o),_line.end.fromBufferAttribute(_instanceEnd,o);const $=new Vector3,_e=new Vector3;_ray.distanceSqToSegment(_line.start,_line.end,_e,$),_e.distanceTo($)<_lineWidth*.5&&s.push({point:_e,pointOnLine:$,distance:_ray.origin.distanceTo(_e),object:a,face:null,faceIndex:o,uv:null,uv2:null})}}function raycastScreenSpace(a,s,o){const j=s.projectionMatrix,_e=a.material.resolution,tt=a.matrixWorld,nt=a.geometry,rt=nt.attributes.instanceStart,it=nt.attributes.instanceEnd,st=-s.near;_ray.at(1,_ssOrigin),_ssOrigin.w=1,_ssOrigin.applyMatrix4(s.matrixWorldInverse),_ssOrigin.applyMatrix4(j),_ssOrigin.multiplyScalar(1/_ssOrigin.w),_ssOrigin.x*=_e.x/2,_ssOrigin.y*=_e.y/2,_ssOrigin.z=0,_ssOrigin3.copy(_ssOrigin),_mvMatrix.multiplyMatrices(s.matrixWorldInverse,tt);for(let at=0,ot=rt.count;at<ot;at++){if(_start4.fromBufferAttribute(rt,at),_end4.fromBufferAttribute(it,at),_start4.w=1,_end4.w=1,_start4.applyMatrix4(_mvMatrix),_end4.applyMatrix4(_mvMatrix),_start4.z>st&&_end4.z>st)continue;if(_start4.z>st){const ut=_start4.z-_end4.z,dt=(_start4.z-st)/ut;_start4.lerp(_end4,dt)}else if(_end4.z>st){const ut=_end4.z-_start4.z,dt=(_end4.z-st)/ut;_end4.lerp(_start4,dt)}_start4.applyMatrix4(j),_end4.applyMatrix4(j),_start4.multiplyScalar(1/_start4.w),_end4.multiplyScalar(1/_end4.w),_start4.x*=_e.x/2,_start4.y*=_e.y/2,_end4.x*=_e.x/2,_end4.y*=_e.y/2,_line.start.copy(_start4),_line.start.z=0,_line.end.copy(_end4),_line.end.z=0;const ft=_line.closestPointToPointParameter(_ssOrigin3,!0);_line.at(ft,_closestPoint);const ht=MathUtils.lerp(_start4.z,_end4.z,ft),mt=ht>=-1&&ht<=1,lt=_ssOrigin3.distanceTo(_closestPoint)<_lineWidth*.5;if(mt&&lt){_line.start.fromBufferAttribute(rt,at),_line.end.fromBufferAttribute(it,at),_line.start.applyMatrix4(tt),_line.end.applyMatrix4(tt);const ut=new Vector3,dt=new Vector3;_ray.distanceSqToSegment(_line.start,_line.end,dt,ut),o.push({point:dt,pointOnLine:ut,distance:_ray.origin.distanceTo(dt),object:a,face:null,faceIndex:at,uv:null,uv2:null})}}}class LineSegments2 extends Mesh{constructor(s=new LineSegmentsGeometry,o=new LineMaterial({color:Math.random()*16777215})){super(s,o),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const s=this.geometry,o=s.attributes.instanceStart,j=s.attributes.instanceEnd,$=new Float32Array(2*o.count);for(let tt=0,nt=0,rt=o.count;tt<rt;tt++,nt+=2)_start.fromBufferAttribute(o,tt),_end.fromBufferAttribute(j,tt),$[nt]=nt===0?0:$[nt-1],$[nt+1]=$[nt]+_start.distanceTo(_end);const _e=new InstancedInterleavedBuffer($,2,1);return s.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(_e,1,0)),s.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(_e,1,1)),this}raycast(s,o){const j=this.material.worldUnits,$=s.camera;$===null&&!j&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const _e=s.params.Line2!==void 0&&s.params.Line2.threshold||0;_ray=s.ray;const tt=this.matrixWorld,nt=this.geometry,rt=this.material;_lineWidth=rt.linewidth+_e,_instanceStart=nt.attributes.instanceStart,_instanceEnd=nt.attributes.instanceEnd,nt.boundingSphere===null&&nt.computeBoundingSphere(),_sphere.copy(nt.boundingSphere).applyMatrix4(tt);let it;if(j)it=_lineWidth*.5;else{const at=Math.max($.near,_sphere.distanceToPoint(_ray.origin));it=getWorldSpaceHalfWidth($,at,rt.resolution)}if(_sphere.radius+=it,_ray.intersectsSphere(_sphere)===!1)return;nt.boundingBox===null&&nt.computeBoundingBox(),_box.copy(nt.boundingBox).applyMatrix4(tt);let st;if(j)st=_lineWidth*.5;else{const at=Math.max($.near,_box.distanceToPoint(_ray.origin));st=getWorldSpaceHalfWidth($,at,rt.resolution)}_box.expandByScalar(st),_ray.intersectsBox(_box)!==!1&&(j?raycastWorldUnits(this,o):raycastScreenSpace(this,$,o))}}class LightProbeHelper extends Mesh{constructor(s,o){const j=new ShaderMaterial({type:"LightProbeHelperMaterial",uniforms:{sh:{value:s.sh.coefficients},intensity:{value:s.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","	vNormal = normalize( normalMatrix * normal );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","	// matrix is assumed to be orthogonal","	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","	// normal is assumed to have unit length","	float x = normal.x, y = normal.y, z = normal.z;","	// band 0","	vec3 result = shCoefficients[ 0 ] * 0.886227;","	// band 1","	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","	// band 2","	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","	return result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","	vec3 normal = normalize( vNormal );","	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","	vec3 irradiance = shGetIrradianceAt( worldNormal, sh );","	vec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","	gl_FragColor = linearToOutputTexel( vec4( outgoingLight, 1.0 ) );","}"].join(`
`)}),$=new SphereGeometry(1,32,16);super($,j),this.lightProbe=s,this.size=o,this.type="LightProbeHelper",this.onBeforeRender()}dispose(){this.geometry.dispose(),this.material.dispose()}onBeforeRender(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity}}const _v1$1=new Vector3,_v2$1=new Vector3;class VertexTangentsHelper extends LineSegments{constructor(s,o=1,j=65535){const $=new BufferGeometry,_e=s.geometry.attributes.tangent.count,tt=new Float32BufferAttribute(_e*2*3,3);$.setAttribute("position",tt),super($,new LineBasicMaterial({color:j,toneMapped:!1})),this.object=s,this.size=o,this.type="VertexTangentsHelper",this.matrixAutoUpdate=!1,this.update()}update(){this.object.updateMatrixWorld(!0);const s=this.object.matrixWorld,o=this.geometry.attributes.position,j=this.object.geometry,$=j.attributes.position,_e=j.attributes.tangent;let tt=0;for(let nt=0,rt=$.count;nt<rt;nt++)_v1$1.fromBufferAttribute($,nt).applyMatrix4(s),_v2$1.fromBufferAttribute(_e,nt),_v2$1.transformDirection(s).multiplyScalar(this.size).add(_v1$1),o.setXYZ(tt,_v1$1.x,_v1$1.y,_v1$1.z),tt=tt+1,o.setXYZ(tt,_v2$1.x,_v2$1.y,_v2$1.z),tt=tt+1;o.needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}class PositionalAudioHelper extends Line{constructor(s,o=1,j=16,$=2){const _e=new BufferGeometry,tt=j+$*2,nt=new Float32Array((tt*3+3)*3);_e.setAttribute("position",new BufferAttribute(nt,3));const rt=new LineBasicMaterial({color:65280}),it=new LineBasicMaterial({color:16776960});super(_e,[it,rt]),this.type="PositionalAudioHelper",this.audio=s,this.range=o,this.divisionsInnerAngle=j,this.divisionsOuterAngle=$,this.update()}update(){const s=this.audio,o=this.range,j=this.divisionsInnerAngle,$=this.divisionsOuterAngle,_e=MathUtils.degToRad(s.panner.coneInnerAngle),tt=MathUtils.degToRad(s.panner.coneOuterAngle),nt=_e/2,rt=tt/2;let it=0,st=0,at,ot;const ct=this.geometry,ft=ct.attributes.position;ct.clearGroups();function ht(mt,lt,ut,dt){const gt=(lt-mt)/ut;for(ft.setXYZ(it,0,0,0),st++,at=mt;at<lt;at+=gt)ot=it+st,ft.setXYZ(ot,Math.sin(at)*o,0,Math.cos(at)*o),ft.setXYZ(ot+1,Math.sin(Math.min(at+gt,lt))*o,0,Math.cos(Math.min(at+gt,lt))*o),ft.setXYZ(ot+2,0,0,0),st+=3;ct.addGroup(it,st,dt),it+=st,st=0}ht(-rt,-nt,$,0),ht(-nt,nt,j,1),ht(nt,rt,$,0),ft.needsUpdate=!0,_e===tt&&(this.material[0].visible=!1)}dispose(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()}}const _v1=new Vector3,_v2=new Vector3,_normalMatrix=new Matrix3;class VertexNormalsHelper extends LineSegments{constructor(s,o=1,j=16711680){const $=new BufferGeometry,_e=s.geometry.attributes.normal.count,tt=new Float32BufferAttribute(_e*2*3,3);$.setAttribute("position",tt),super($,new LineBasicMaterial({color:j,toneMapped:!1})),this.object=s,this.size=o,this.type="VertexNormalsHelper",this.matrixAutoUpdate=!1,this.update()}update(){this.object.updateMatrixWorld(!0),_normalMatrix.getNormalMatrix(this.object.matrixWorld);const s=this.object.matrixWorld,o=this.geometry.attributes.position,j=this.object.geometry;if(j){const $=j.attributes.position,_e=j.attributes.normal;let tt=0;for(let nt=0,rt=$.count;nt<rt;nt++)_v1.fromBufferAttribute($,nt).applyMatrix4(s),_v2.fromBufferAttribute(_e,nt),_v2.applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1),o.setXYZ(tt,_v1.x,_v1.y,_v1.z),tt=tt+1,o.setXYZ(tt,_v2.x,_v2.y,_v2.z),tt=tt+1}o.needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}class RectAreaLightHelper extends Line{constructor(s,o){const j=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],$=new BufferGeometry;$.setAttribute("position",new Float32BufferAttribute(j,3)),$.computeBoundingSphere();const _e=new LineBasicMaterial({fog:!1});super($,_e),this.light=s,this.color=o,this.type="RectAreaLightHelper";const tt=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],nt=new BufferGeometry;nt.setAttribute("position",new Float32BufferAttribute(tt,3)),nt.computeBoundingSphere(),this.add(new Mesh(nt,new MeshBasicMaterial({side:BackSide,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const s=this.material.color,o=Math.max(s.r,s.g,s.b);o>1&&s.multiplyScalar(1/o),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}class GrannyKnot extends Curve{getPoint(s,o=new Vector3){const j=o;s=2*Math.PI*s;const $=-.22*Math.cos(s)-1.28*Math.sin(s)-.44*Math.cos(3*s)-.78*Math.sin(3*s),_e=-.1*Math.cos(2*s)-.27*Math.sin(2*s)+.38*Math.cos(4*s)+.46*Math.sin(4*s),tt=.7*Math.cos(3*s)-.4*Math.sin(3*s);return j.set($,_e,tt).multiplyScalar(20)}}class HeartCurve extends Curve{constructor(s=5){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s*=2*Math.PI;const $=16*Math.pow(Math.sin(s),3),_e=13*Math.cos(s)-5*Math.cos(2*s)-2*Math.cos(3*s)-Math.cos(4*s),tt=0;return j.set($,_e,tt).multiplyScalar(this.scale)}}class VivianiCurve extends Curve{constructor(s=70){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s=s*4*Math.PI;const $=this.scale/2,_e=$*(1+Math.cos(s)),tt=$*Math.sin(s),nt=2*$*Math.sin(s/2);return j.set(_e,tt,nt)}}class KnotCurve extends Curve{getPoint(s,o=new Vector3){const j=o;s*=2*Math.PI;const $=10,_e=50,tt=_e*Math.sin(s),nt=Math.cos(s)*($+_e*Math.cos(s)),rt=Math.sin(s)*($+_e*Math.cos(s));return j.set(tt,nt,rt)}}class HelixCurve extends Curve{getPoint(s,o=new Vector3){const j=o,$=30,_e=150,tt=2*Math.PI*s*_e/30,nt=Math.cos(tt)*$,rt=Math.sin(tt)*$,it=_e*s;return j.set(nt,rt,it)}}class TrefoilKnot extends Curve{constructor(s=10){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s*=Math.PI*2;const $=(2+Math.cos(3*s))*Math.cos(2*s),_e=(2+Math.cos(3*s))*Math.sin(2*s),tt=Math.sin(3*s);return j.set($,_e,tt).multiplyScalar(this.scale)}}class TorusKnot extends Curve{constructor(s=10){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o,$=3,_e=4;s*=Math.PI*2;const tt=(2+Math.cos(_e*s))*Math.cos($*s),nt=(2+Math.cos(_e*s))*Math.sin($*s),rt=Math.sin(_e*s);return j.set(tt,nt,rt).multiplyScalar(this.scale)}}class CinquefoilKnot extends Curve{constructor(s=10){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o,$=2,_e=5;s*=Math.PI*2;const tt=(2+Math.cos(_e*s))*Math.cos($*s),nt=(2+Math.cos(_e*s))*Math.sin($*s),rt=Math.sin(_e*s);return j.set(tt,nt,rt).multiplyScalar(this.scale)}}class TrefoilPolynomialKnot extends Curve{constructor(s=10){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s=s*4-2;const $=Math.pow(s,3)-3*s,_e=Math.pow(s,4)-4*s*s,tt=1/5*Math.pow(s,5)-2*s;return j.set($,_e,tt).multiplyScalar(this.scale)}}function scaleTo(a,s,o){const j=s-a;return o*j+a}class FigureEightPolynomialKnot extends Curve{constructor(s=1){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s=scaleTo(-4,4,s);const $=2/5*s*(s*s-7)*(s*s-10),_e=Math.pow(s,4)-13*s*s,tt=1/10*s*(s*s-4)*(s*s-9)*(s*s-12);return j.set($,_e,tt).multiplyScalar(this.scale)}}class DecoratedTorusKnot4a extends Curve{constructor(s=40){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o;s*=Math.PI*2;const $=Math.cos(2*s)*(1+.6*(Math.cos(5*s)+.75*Math.cos(10*s))),_e=Math.sin(2*s)*(1+.6*(Math.cos(5*s)+.75*Math.cos(10*s))),tt=.35*Math.sin(5*s);return j.set($,_e,tt).multiplyScalar(this.scale)}}class DecoratedTorusKnot4b extends Curve{constructor(s=40){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o,$=s*Math.PI*2,_e=Math.cos(2*$)*(1+.45*Math.cos(3*$)+.4*Math.cos(9*$)),tt=Math.sin(2*$)*(1+.45*Math.cos(3*$)+.4*Math.cos(9*$)),nt=.2*Math.sin(9*$);return j.set(_e,tt,nt).multiplyScalar(this.scale)}}class DecoratedTorusKnot5a extends Curve{constructor(s=40){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o,$=s*Math.PI*2,_e=Math.cos(3*$)*(1+.3*Math.cos(5*$)+.5*Math.cos(10*$)),tt=Math.sin(3*$)*(1+.3*Math.cos(5*$)+.5*Math.cos(10*$)),nt=.2*Math.sin(20*$);return j.set(_e,tt,nt).multiplyScalar(this.scale)}}class DecoratedTorusKnot5c extends Curve{constructor(s=40){super(),this.scale=s}getPoint(s,o=new Vector3){const j=o,$=s*Math.PI*2,_e=Math.cos(4*$)*(1+.5*(Math.cos(5*$)+.4*Math.cos(20*$))),tt=Math.sin(4*$)*(1+.5*(Math.cos(5*$)+.4*Math.cos(20*$))),nt=.35*Math.sin(15*$);return j.set(_e,tt,nt).multiplyScalar(this.scale)}}const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3;class Geometry extends EventDispatcher{static createBufferGeometryFromObject(s){let o=new BufferGeometry;const j=s.geometry;if(s.isPoints||s.isLine){const $=new Float32BufferAttribute(j.vertices.length*3,3),_e=new Float32BufferAttribute(j.colors.length*3,3);if(o.setAttribute("position",$.copyVector3sArray(j.vertices)),o.setAttribute("color",_e.copyColorsArray(j.colors)),j.lineDistances&&j.lineDistances.length===j.vertices.length){const tt=new Float32BufferAttribute(j.lineDistances.length,1);o.setAttribute("lineDistance",tt.copyArray(j.lineDistances))}j.boundingSphere!==null&&(o.boundingSphere=j.boundingSphere.clone()),j.boundingBox!==null&&(o.boundingBox=j.boundingBox.clone())}else s.isMesh&&(o=j.toBufferGeometry());return o}constructor(){super(),this.isGeometry=!0,this.uuid=MathUtils.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(s){const o=new Matrix3().getNormalMatrix(s);for(let j=0,$=this.vertices.length;j<$;j++)this.vertices[j].applyMatrix4(s);for(let j=0,$=this.faces.length;j<$;j++){const _e=this.faces[j];_e.normal.applyMatrix3(o).normalize();for(let tt=0,nt=_e.vertexNormals.length;tt<nt;tt++)_e.vertexNormals[tt].applyMatrix3(o).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(s){return _m1.makeRotationX(s),this.applyMatrix4(_m1),this}rotateY(s){return _m1.makeRotationY(s),this.applyMatrix4(_m1),this}rotateZ(s){return _m1.makeRotationZ(s),this.applyMatrix4(_m1),this}translate(s,o,j){return _m1.makeTranslation(s,o,j),this.applyMatrix4(_m1),this}scale(s,o,j){return _m1.makeScale(s,o,j),this.applyMatrix4(_m1),this}lookAt(s){return _obj.lookAt(s),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}fromBufferGeometry(s){const o=this,j=s.index!==null?s.index:void 0,$=s.attributes;if($.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const _e=$.position,tt=$.normal,nt=$.color,rt=$.uv,it=$.uv2;it!==void 0&&(this.faceVertexUvs[1]=[]);for(let ot=0;ot<_e.count;ot++)o.vertices.push(new Vector3().fromBufferAttribute(_e,ot)),nt!==void 0&&o.colors.push(new Color().fromBufferAttribute(nt,ot));function st(ot,ct,ft,ht){const mt=nt===void 0?[]:[o.colors[ot].clone(),o.colors[ct].clone(),o.colors[ft].clone()],lt=tt===void 0?[]:[new Vector3().fromBufferAttribute(tt,ot),new Vector3().fromBufferAttribute(tt,ct),new Vector3().fromBufferAttribute(tt,ft)],ut=new Face3(ot,ct,ft,lt,mt,ht);o.faces.push(ut),rt!==void 0&&o.faceVertexUvs[0].push([new Vector2().fromBufferAttribute(rt,ot),new Vector2().fromBufferAttribute(rt,ct),new Vector2().fromBufferAttribute(rt,ft)]),it!==void 0&&o.faceVertexUvs[1].push([new Vector2().fromBufferAttribute(it,ot),new Vector2().fromBufferAttribute(it,ct),new Vector2().fromBufferAttribute(it,ft)])}const at=s.groups;if(at.length>0)for(let ot=0;ot<at.length;ot++){const ct=at[ot],ft=ct.start,ht=ct.count;for(let mt=ft,lt=ft+ht;mt<lt;mt+=3)j!==void 0?st(j.getX(mt),j.getX(mt+1),j.getX(mt+2),ct.materialIndex):st(mt,mt+1,mt+2,ct.materialIndex)}else if(j!==void 0)for(let ot=0;ot<j.count;ot+=3)st(j.getX(ot),j.getX(ot+1),j.getX(ot+2));else for(let ot=0;ot<_e.count;ot+=3)st(ot,ot+1,ot+2);return this.computeFaceNormals(),s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone()),s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}normalize(){this.computeBoundingSphere();const s=this.boundingSphere.center,o=this.boundingSphere.radius,j=o===0?1:1/o,$=new Matrix4;return $.set(j,0,0,-j*s.x,0,j,0,-j*s.y,0,0,j,-j*s.z,0,0,0,1),this.applyMatrix4($),this}computeFaceNormals(){const s=new Vector3,o=new Vector3;for(let j=0,$=this.faces.length;j<$;j++){const _e=this.faces[j],tt=this.vertices[_e.a],nt=this.vertices[_e.b],rt=this.vertices[_e.c];s.subVectors(rt,nt),o.subVectors(tt,nt),s.cross(o),s.normalize(),_e.normal.copy(s)}}computeVertexNormals(s=!0){const o=new Array(this.vertices.length);for(let j=0,$=this.vertices.length;j<$;j++)o[j]=new Vector3;if(s){const j=new Vector3,$=new Vector3;for(let _e=0,tt=this.faces.length;_e<tt;_e++){const nt=this.faces[_e],rt=this.vertices[nt.a],it=this.vertices[nt.b],st=this.vertices[nt.c];j.subVectors(st,it),$.subVectors(rt,it),j.cross($),o[nt.a].add(j),o[nt.b].add(j),o[nt.c].add(j)}}else{this.computeFaceNormals();for(let j=0,$=this.faces.length;j<$;j++){const _e=this.faces[j];o[_e.a].add(_e.normal),o[_e.b].add(_e.normal),o[_e.c].add(_e.normal)}}for(let j=0,$=this.vertices.length;j<$;j++)o[j].normalize();for(let j=0,$=this.faces.length;j<$;j++){const _e=this.faces[j],tt=_e.vertexNormals;tt.length===3?(tt[0].copy(o[_e.a]),tt[1].copy(o[_e.b]),tt[2].copy(o[_e.c])):(tt[0]=o[_e.a].clone(),tt[1]=o[_e.b].clone(),tt[2]=o[_e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let s=0,o=this.faces.length;s<o;s++){const j=this.faces[s],$=j.vertexNormals;$.length===3?($[0].copy(j.normal),$[1].copy(j.normal),$[2].copy(j.normal)):($[0]=j.normal.clone(),$[1]=j.normal.clone(),$[2]=j.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let o=0,j=this.faces.length;o<j;o++){const $=this.faces[o];$.__originalFaceNormal?$.__originalFaceNormal.copy($.normal):$.__originalFaceNormal=$.normal.clone(),$.__originalVertexNormals||($.__originalVertexNormals=[]);for(let _e=0,tt=$.vertexNormals.length;_e<tt;_e++)$.__originalVertexNormals[_e]?$.__originalVertexNormals[_e].copy($.vertexNormals[_e]):$.__originalVertexNormals[_e]=$.vertexNormals[_e].clone()}const s=new Geometry;s.faces=this.faces;for(let o=0,j=this.morphTargets.length;o<j;o++){if(!this.morphNormals[o]){this.morphNormals[o]={},this.morphNormals[o].faceNormals=[],this.morphNormals[o].vertexNormals=[];const _e=this.morphNormals[o].faceNormals,tt=this.morphNormals[o].vertexNormals;for(let nt=0,rt=this.faces.length;nt<rt;nt++){const it=new Vector3,st={a:new Vector3,b:new Vector3,c:new Vector3};_e.push(it),tt.push(st)}}const $=this.morphNormals[o];s.vertices=this.morphTargets[o].vertices,s.computeFaceNormals(),s.computeVertexNormals();for(let _e=0,tt=this.faces.length;_e<tt;_e++){const nt=this.faces[_e],rt=$.faceNormals[_e],it=$.vertexNormals[_e];rt.copy(nt.normal),it.a.copy(nt.vertexNormals[0]),it.b.copy(nt.vertexNormals[1]),it.c.copy(nt.vertexNormals[2])}}for(let o=0,j=this.faces.length;o<j;o++){const $=this.faces[o];$.normal=$.__originalFaceNormal,$.vertexNormals=$.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.setFromPoints(this.vertices)}merge(s,o,j=0){if(!(s&&s.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",s);return}let $;const _e=this.vertices.length,tt=this.vertices,nt=s.vertices,rt=this.faces,it=s.faces,st=this.colors,at=s.colors;o!==void 0&&($=new Matrix3().getNormalMatrix(o));for(let ot=0,ct=nt.length;ot<ct;ot++){const ht=nt[ot].clone();o!==void 0&&ht.applyMatrix4(o),tt.push(ht)}for(let ot=0,ct=at.length;ot<ct;ot++)st.push(at[ot].clone());for(let ot=0,ct=it.length;ot<ct;ot++){const ft=it[ot];let ht,mt;const lt=ft.vertexNormals,ut=ft.vertexColors,dt=new Face3(ft.a+_e,ft.b+_e,ft.c+_e);dt.normal.copy(ft.normal),$!==void 0&&dt.normal.applyMatrix3($).normalize();for(let gt=0,Et=lt.length;gt<Et;gt++)ht=lt[gt].clone(),$!==void 0&&ht.applyMatrix3($).normalize(),dt.vertexNormals.push(ht);dt.color.copy(ft.color);for(let gt=0,Et=ut.length;gt<Et;gt++)mt=ut[gt],dt.vertexColors.push(mt.clone());dt.materialIndex=ft.materialIndex+j,rt.push(dt)}for(let ot=0,ct=s.faceVertexUvs.length;ot<ct;ot++){const ft=s.faceVertexUvs[ot];this.faceVertexUvs[ot]===void 0&&(this.faceVertexUvs[ot]=[]);for(let ht=0,mt=ft.length;ht<mt;ht++){const lt=ft[ht],ut=[];for(let dt=0,gt=lt.length;dt<gt;dt++)ut.push(lt[dt].clone());this.faceVertexUvs[ot].push(ut)}}}mergeMesh(s){if(!(s&&s.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",s);return}s.matrixAutoUpdate&&s.updateMatrix(),this.merge(s.geometry,s.matrix)}mergeVertices(s=4){const o={},j=[],$=[],_e=Math.pow(10,s);for(let rt=0,it=this.vertices.length;rt<it;rt++){const st=this.vertices[rt],at=`${Math.round(st.x*_e)}_${Math.round(st.y*_e)}_${Math.round(st.z*_e)}`;o[at]===void 0?(o[at]=rt,j.push(this.vertices[rt]),$[rt]=j.length-1):$[rt]=$[o[at]]}const tt=[];for(let rt=0,it=this.faces.length;rt<it;rt++){const st=this.faces[rt];st.a=$[st.a],st.b=$[st.b],st.c=$[st.c];const at=[st.a,st.b,st.c];for(let ot=0;ot<3;ot++)if(at[ot]===at[(ot+1)%3]){tt.push(rt);break}}for(let rt=tt.length-1;rt>=0;rt--){const it=tt[rt];this.faces.splice(it,1);for(let st=0,at=this.faceVertexUvs.length;st<at;st++)this.faceVertexUvs[st].splice(it,1)}const nt=this.vertices.length-j.length;return this.vertices=j,nt}setFromPoints(s){this.vertices=[];for(let o=0,j=s.length;o<j;o++){const $=s[o];this.vertices.push(new Vector3($.x,$.y,$.z||0))}return this}sortFacesByMaterialIndex(){const s=this.faces,o=s.length;for(let rt=0;rt<o;rt++)s[rt]._id=rt;function j(rt,it){return rt.materialIndex-it.materialIndex}s.sort(j);const $=this.faceVertexUvs[0],_e=this.faceVertexUvs[1];let tt,nt;$&&$.length===o&&(tt=[]),_e&&_e.length===o&&(nt=[]);for(let rt=0;rt<o;rt++){const it=s[rt]._id;tt&&tt.push($[it]),nt&&nt.push(_e[it])}tt&&(this.faceVertexUvs[0]=tt),nt&&(this.faceVertexUvs[1]=nt)}toJSON(){const s={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.parameters!==void 0){const ft=this.parameters;for(let ht in ft)ft[ht]!==void 0&&(s[ht]=ft[ht]);return s}const o=[];for(let ft=0;ft<this.vertices.length;ft++){const ht=this.vertices[ft];o.push(ht.x,ht.y,ht.z)}const j=[],$=[],_e={},tt=[],nt={},rt=[],it={};for(let ft=0;ft<this.faces.length;ft++){const ht=this.faces[ft],mt=!0,lt=!1,ut=this.faceVertexUvs[0][ft]!==void 0,dt=ht.normal.length()>0,gt=ht.vertexNormals.length>0,Et=ht.color.r!==1||ht.color.g!==1||ht.color.b!==1,St=ht.vertexColors.length>0;let Tt=0;if(Tt=st(Tt,0,0),Tt=st(Tt,1,mt),Tt=st(Tt,2,lt),Tt=st(Tt,3,ut),Tt=st(Tt,4,dt),Tt=st(Tt,5,gt),Tt=st(Tt,6,Et),Tt=st(Tt,7,St),j.push(Tt),j.push(ht.a,ht.b,ht.c),j.push(ht.materialIndex),ut){const Mt=this.faceVertexUvs[0][ft];j.push(ct(Mt[0]),ct(Mt[1]),ct(Mt[2]))}if(dt&&j.push(at(ht.normal)),gt){const Mt=ht.vertexNormals;j.push(at(Mt[0]),at(Mt[1]),at(Mt[2]))}if(Et&&j.push(ot(ht.color)),St){const Mt=ht.vertexColors;j.push(ot(Mt[0]),ot(Mt[1]),ot(Mt[2]))}}function st(ft,ht,mt){return mt?ft|1<<ht:ft&~(1<<ht)}function at(ft){const ht=ft.x.toString()+ft.y.toString()+ft.z.toString();return _e[ht]!==void 0||(_e[ht]=$.length/3,$.push(ft.x,ft.y,ft.z)),_e[ht]}function ot(ft){const ht=ft.r.toString()+ft.g.toString()+ft.b.toString();return nt[ht]!==void 0||(nt[ht]=tt.length,tt.push(ft.getHex())),nt[ht]}function ct(ft){const ht=ft.x.toString()+ft.y.toString();return it[ht]!==void 0||(it[ht]=rt.length/2,rt.push(ft.x,ft.y)),it[ht]}return s.data={},s.data.vertices=o,s.data.normals=$,tt.length>0&&(s.data.colors=tt),rt.length>0&&(s.data.uvs=[rt]),s.data.faces=j,s}clone(){return new Geometry().copy(this)}copy(s){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=s.name;const o=s.vertices;for(let ot=0,ct=o.length;ot<ct;ot++)this.vertices.push(o[ot].clone());const j=s.colors;for(let ot=0,ct=j.length;ot<ct;ot++)this.colors.push(j[ot].clone());const $=s.faces;for(let ot=0,ct=$.length;ot<ct;ot++)this.faces.push($[ot].clone());for(let ot=0,ct=s.faceVertexUvs.length;ot<ct;ot++){const ft=s.faceVertexUvs[ot];this.faceVertexUvs[ot]===void 0&&(this.faceVertexUvs[ot]=[]);for(let ht=0,mt=ft.length;ht<mt;ht++){const lt=ft[ht],ut=[];for(let dt=0,gt=lt.length;dt<gt;dt++){const Et=lt[dt];ut.push(Et.clone())}this.faceVertexUvs[ot].push(ut)}}const _e=s.morphTargets;for(let ot=0,ct=_e.length;ot<ct;ot++){const ft={};if(ft.name=_e[ot].name,_e[ot].vertices!==void 0){ft.vertices=[];for(let ht=0,mt=_e[ot].vertices.length;ht<mt;ht++)ft.vertices.push(_e[ot].vertices[ht].clone())}if(_e[ot].normals!==void 0){ft.normals=[];for(let ht=0,mt=_e[ot].normals.length;ht<mt;ht++)ft.normals.push(_e[ot].normals[ht].clone())}this.morphTargets.push(ft)}const tt=s.morphNormals;for(let ot=0,ct=tt.length;ot<ct;ot++){const ft={};if(tt[ot].vertexNormals!==void 0){ft.vertexNormals=[];for(let ht=0,mt=tt[ot].vertexNormals.length;ht<mt;ht++){const lt=tt[ot].vertexNormals[ht],ut={};ut.a=lt.a.clone(),ut.b=lt.b.clone(),ut.c=lt.c.clone(),ft.vertexNormals.push(ut)}}if(tt[ot].faceNormals!==void 0){ft.faceNormals=[];for(let ht=0,mt=tt[ot].faceNormals.length;ht<mt;ht++)ft.faceNormals.push(tt[ot].faceNormals[ht].clone())}this.morphNormals.push(ft)}const nt=s.skinWeights;for(let ot=0,ct=nt.length;ot<ct;ot++)this.skinWeights.push(nt[ot].clone());const rt=s.skinIndices;for(let ot=0,ct=rt.length;ot<ct;ot++)this.skinIndices.push(rt[ot].clone());const it=s.lineDistances;for(let ot=0,ct=it.length;ot<ct;ot++)this.lineDistances.push(it[ot]);const st=s.boundingBox;st!==null&&(this.boundingBox=st.clone());const at=s.boundingSphere;return at!==null&&(this.boundingSphere=at.clone()),this.elementsNeedUpdate=s.elementsNeedUpdate,this.verticesNeedUpdate=s.verticesNeedUpdate,this.uvsNeedUpdate=s.uvsNeedUpdate,this.normalsNeedUpdate=s.normalsNeedUpdate,this.colorsNeedUpdate=s.colorsNeedUpdate,this.lineDistancesNeedUpdate=s.lineDistancesNeedUpdate,this.groupsNeedUpdate=s.groupsNeedUpdate,this}toBufferGeometry(){const s=new DirectGeometry().fromGeometry(this),o=new BufferGeometry,j=new Float32Array(s.vertices.length*3);if(o.setAttribute("position",new BufferAttribute(j,3).copyVector3sArray(s.vertices)),s.normals.length>0){const $=new Float32Array(s.normals.length*3);o.setAttribute("normal",new BufferAttribute($,3).copyVector3sArray(s.normals))}if(s.colors.length>0){const $=new Float32Array(s.colors.length*3);o.setAttribute("color",new BufferAttribute($,3).copyColorsArray(s.colors))}if(s.uvs.length>0){const $=new Float32Array(s.uvs.length*2);o.setAttribute("uv",new BufferAttribute($,2).copyVector2sArray(s.uvs))}if(s.uvs2.length>0){const $=new Float32Array(s.uvs2.length*2);o.setAttribute("uv2",new BufferAttribute($,2).copyVector2sArray(s.uvs2))}o.groups=s.groups;for(let $ in s.morphTargets){const _e=[],tt=s.morphTargets[$];for(let nt=0,rt=tt.length;nt<rt;nt++){const it=tt[nt],st=new Float32BufferAttribute(it.data.length*3,3);st.name=it.name,_e.push(st.copyVector3sArray(it.data))}o.morphAttributes[$]=_e}if(s.skinIndices.length>0){const $=new Float32BufferAttribute(s.skinIndices.length*4,4);o.setAttribute("skinIndex",$.copyVector4sArray(s.skinIndices))}if(s.skinWeights.length>0){const $=new Float32BufferAttribute(s.skinWeights.length*4,4);o.setAttribute("skinWeight",$.copyVector4sArray(s.skinWeights))}return s.boundingSphere!==null&&(o.boundingSphere=s.boundingSphere.clone()),s.boundingBox!==null&&(o.boundingBox=s.boundingBox.clone()),o}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(s){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(s)}dispose(){this.dispatchEvent({type:"dispose"})}}class DirectGeometry{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(s){const o=[];let j,$,_e;const tt=s.faces;for($=0;$<tt.length;$++){const nt=tt[$];nt.materialIndex!==_e&&(_e=nt.materialIndex,j!==void 0&&(j.count=$*3-j.start,o.push(j)),j={start:$*3,materialIndex:_e})}j!==void 0&&(j.count=$*3-j.start,o.push(j)),this.groups=o}fromGeometry(s){const o=s.faces,j=s.vertices,$=s.faceVertexUvs,_e=$[0]&&$[0].length>0,tt=$[1]&&$[1].length>0,nt=s.morphTargets,rt=nt.length;let it;if(rt>0){it=[];for(let lt=0;lt<rt;lt++)it[lt]={name:nt[lt].name,data:[]};this.morphTargets.position=it}const st=s.morphNormals,at=st.length;let ot;if(at>0){ot=[];for(let lt=0;lt<at;lt++)ot[lt]={name:st[lt].name,data:[]};this.morphTargets.normal=ot}const ct=s.skinIndices,ft=s.skinWeights,ht=ct.length===j.length,mt=ft.length===j.length;j.length>0&&o.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let lt=0;lt<o.length;lt++){const ut=o[lt];this.vertices.push(j[ut.a],j[ut.b],j[ut.c]);const dt=ut.vertexNormals;if(dt.length===3)this.normals.push(dt[0],dt[1],dt[2]);else{const Et=ut.normal;this.normals.push(Et,Et,Et)}const gt=ut.vertexColors;if(gt.length===3)this.colors.push(gt[0],gt[1],gt[2]);else{const Et=ut.color;this.colors.push(Et,Et,Et)}if(_e===!0){const Et=$[0][lt];Et!==void 0?this.uvs.push(Et[0],Et[1],Et[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",lt),this.uvs.push(new Vector2,new Vector2,new Vector2))}if(tt===!0){const Et=$[1][lt];Et!==void 0?this.uvs2.push(Et[0],Et[1],Et[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",lt),this.uvs2.push(new Vector2,new Vector2,new Vector2))}for(let Et=0;Et<rt;Et++){const St=nt[Et].vertices;it[Et].data.push(St[ut.a],St[ut.b],St[ut.c])}for(let Et=0;Et<at;Et++){const St=st[Et].vertexNormals[lt];ot[Et].data.push(St.a,St.b,St.c)}ht&&this.skinIndices.push(ct[ut.a],ct[ut.b],ct[ut.c]),mt&&this.skinWeights.push(ft[ut.a],ft[ut.b],ft[ut.c])}return this.computeGroups(s),this.verticesNeedUpdate=s.verticesNeedUpdate,this.normalsNeedUpdate=s.normalsNeedUpdate,this.colorsNeedUpdate=s.colorsNeedUpdate,this.uvsNeedUpdate=s.uvsNeedUpdate,this.groupsNeedUpdate=s.groupsNeedUpdate,s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone()),this}}class Face3{constructor(s,o,j,$,_e,tt=0){this.a=s,this.b=o,this.c=j,this.normal=$&&$.isVector3?$:new Vector3,this.vertexNormals=Array.isArray($)?$:[],this.color=_e&&_e.isColor?_e:new Color,this.vertexColors=Array.isArray(_e)?_e:[],this.materialIndex=tt}clone(){return new this.constructor().copy(this)}copy(s){this.a=s.a,this.b=s.b,this.c=s.c,this.normal.copy(s.normal),this.color.copy(s.color),this.materialIndex=s.materialIndex;for(let o=0,j=s.vertexNormals.length;o<j;o++)this.vertexNormals[o]=s.vertexNormals[o].clone();for(let o=0,j=s.vertexColors.length;o<j;o++)this.vertexColors[o]=s.vertexColors[o].clone();return this}}let generated;const MeshoptDecoder=()=>{if(generated)return generated;const a="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",s="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",o=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),j=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let $=a;WebAssembly.validate(o)&&($=s);let _e;const tt=WebAssembly.instantiate(nt($),{}).then(at=>{_e=at.instance,_e.exports.__wasm_call_ctors()});function nt(at){const ot=new Uint8Array(at.length);for(let ft=0;ft<at.length;++ft){const ht=at.charCodeAt(ft);ot[ft]=ht>96?ht-71:ht>64?ht-65:ht>47?ht+4:ht>46?63:62}let ct=0;for(let ft=0;ft<at.length;++ft)ot[ct++]=ot[ft]<60?j[ot[ft]]:(ot[ft]-60)*64+ot[++ft];return ot.buffer.slice(0,ct)}function rt(at,ot,ct,ft,ht,mt){const lt=_e.exports.sbrk,ut=ct+3&-4,dt=lt(ut*ft),gt=lt(ht.length),Et=new Uint8Array(_e.exports.memory.buffer);Et.set(ht,gt);const St=at(dt,ct,ft,gt,ht.length);if(St===0&&mt&&mt(dt,ut,ft),ot.set(Et.subarray(dt,dt+ct*ft)),lt(dt-lt(0)),St!==0)throw new Error(`Malformed buffer data: ${St}`)}const it={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},st={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return generated={ready:tt,supported:!0,decodeVertexBuffer(at,ot,ct,ft,ht){rt(_e.exports.meshopt_decodeVertexBuffer,at,ot,ct,ft,_e.exports[it[ht]])},decodeIndexBuffer(at,ot,ct,ft){rt(_e.exports.meshopt_decodeIndexBuffer,at,ot,ct,ft)},decodeIndexSequence(at,ot,ct,ft){rt(_e.exports.meshopt_decodeIndexSequence,at,ot,ct,ft)},decodeGltfBuffer(at,ot,ct,ft,ht,mt){rt(_e.exports[st[ht]],at,ot,ct,ft,_e.exports[it[mt]])}},generated};function shaderMaterial(a,s,o,j){const $=class extends ShaderMaterial{constructor(tt={}){const nt=Object.entries(a);super({uniforms:nt.reduce((rt,[it,st])=>{const at=UniformsUtils.clone({[it]:{value:st}});return{...rt,...at}},{}),vertexShader:s,fragmentShader:o}),this.key="",nt.forEach(([rt])=>Object.defineProperty(this,rt,{get:()=>this.uniforms[rt].value,set:it=>this.uniforms[rt].value=it})),Object.assign(this,tt),j&&j(this)}};return $.key=MathUtils.generateUUID(),$}let dracoLoader=null;function extensions(a,s,o){return j=>{o&&o(j),a&&(dracoLoader||(dracoLoader=new DRACOLoader),dracoLoader.setDecoderPath(typeof a=="string"?a:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),j.setDRACOLoader(dracoLoader)),s&&j.setMeshoptDecoder(typeof MeshoptDecoder=="function"?MeshoptDecoder():MeshoptDecoder)}}function useGLTF(a,s=!0,o=!0,j){return useLoader(GLTFLoader,a,extensions(s,o,j))}useGLTF.preload=(a,s=!0,o=!0,j)=>useLoader.preload(GLTFLoader,a,extensions(s,o,j));useGLTF.clear=a=>useLoader.clear(GLTFLoader,a);const OrbitControls=reactExports.forwardRef(({makeDefault:a,camera:s,regress:o,domElement:j,enableDamping:$=!0,keyEvents:_e=!1,onChange:tt,onStart:nt,onEnd:rt,...it},st)=>{const at=useThree(St=>St.invalidate),ot=useThree(St=>St.camera),ct=useThree(St=>St.gl),ft=useThree(St=>St.events),ht=useThree(St=>St.setEvents),mt=useThree(St=>St.set),lt=useThree(St=>St.get),ut=useThree(St=>St.performance),dt=s||ot,gt=j||ft.connected||ct.domElement,Et=reactExports.useMemo(()=>new OrbitControls$1(dt),[dt]);return useFrame(()=>{Et.enabled&&Et.update()},-1),reactExports.useEffect(()=>(_e&&Et.connect(_e===!0?gt:_e),Et.connect(gt),()=>void Et.dispose()),[_e,gt,o,Et,at]),reactExports.useEffect(()=>{const St=Bt=>{at(),o&&ut.regress(),tt&&tt(Bt)},Tt=Bt=>{nt&&nt(Bt)},Mt=Bt=>{rt&&rt(Bt)};return Et.addEventListener("change",St),Et.addEventListener("start",Tt),Et.addEventListener("end",Mt),()=>{Et.removeEventListener("start",Tt),Et.removeEventListener("end",Mt),Et.removeEventListener("change",St)}},[tt,nt,rt,Et,at,ht]),reactExports.useEffect(()=>{if(a){const St=lt().controls;return mt({controls:Et}),()=>mt({controls:St})}},[a,Et]),reactExports.createElement("primitive",_extends({ref:st,object:Et,enableDamping:$},it))}),Center=reactExports.forwardRef(function a({children:s,disable:o,disableX:j,disableY:$,disableZ:_e,left:tt,right:nt,top:rt,bottom:it,front:st,back:at,onCentered:ot,precise:ct=!0,cacheKey:ft=0,...ht},mt){const lt=reactExports.useRef(null),ut=reactExports.useRef(null),dt=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{ut.current.matrixWorld.identity();const gt=new Box3().setFromObject(dt.current,ct),Et=new Vector3,St=new Sphere,Tt=gt.max.x-gt.min.x,Mt=gt.max.y-gt.min.y,Bt=gt.max.z-gt.min.z;gt.getCenter(Et),gt.getBoundingSphere(St);const Rt=rt?Mt/2:it?-Mt/2:0,Ut=tt?-Tt/2:nt?Tt/2:0,Ht=st?Bt/2:at?-Bt/2:0;ut.current.position.set(o||j?0:-Et.x+Ut,o||$?0:-Et.y+Rt,o||_e?0:-Et.z+Ht),typeof ot<"u"&&ot({parent:lt.current.parent,container:lt.current,width:Tt,height:Mt,depth:Bt,boundingBox:gt,boundingSphere:St,center:Et,verticalAlignment:Rt,horizontalAlignment:Ut,depthAlignment:Ht})},[ft,ot,rt,tt,st,o,j,$,_e,ct,nt,it,at]),reactExports.useImperativeHandle(mt,()=>lt.current,[]),reactExports.createElement("group",_extends({ref:lt},ht),reactExports.createElement("group",{ref:ut},reactExports.createElement("group",{ref:dt},s)))}),DiscardMaterial=shaderMaterial({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }"),isOrthographic=a=>a&&a.isOrthographicCamera,isBox3=a=>a&&a.isBox3,context=reactExports.createContext(null);function Bounds({children:a,damping:s=6,fit:o,clip:j,observe:$,margin:_e=1.2,eps:tt=.01,onFit:nt}){const rt=reactExports.useRef(null),{camera:it,invalidate:st,size:at,controls:ot}=useThree(),ct=ot,ft=reactExports.useRef(nt);ft.current=nt;function ht(St,Tt){return Math.abs(St.x-Tt.x)<tt&&Math.abs(St.y-Tt.y)<tt&&Math.abs(St.z-Tt.z)<tt}function mt(St,Tt,Mt,Bt){St.x=MathUtils.damp(St.x,Tt.x,Mt,Bt),St.y=MathUtils.damp(St.y,Tt.y,Mt,Bt),St.z=MathUtils.damp(St.z,Tt.z,Mt,Bt)}const[lt]=reactExports.useState(()=>({animating:!1,focus:new Vector3,camera:new Vector3,zoom:1})),[ut]=reactExports.useState(()=>({focus:new Vector3,camera:new Vector3,zoom:1})),[dt]=reactExports.useState(()=>new Box3),gt=reactExports.useMemo(()=>{function St(){const Tt=dt.getSize(new Vector3),Mt=dt.getCenter(new Vector3),Bt=Math.max(Tt.x,Tt.y,Tt.z),Rt=isOrthographic(it)?Bt*4:Bt/(2*Math.atan(Math.PI*it.fov/360)),Ut=isOrthographic(it)?Bt*4:Rt/it.aspect,Ht=_e*Math.max(Rt,Ut);return{box:dt,size:Tt,center:Mt,distance:Ht}}return{getSize:St,refresh(Tt){if(isBox3(Tt))dt.copy(Tt);else{const Mt=Tt||rt.current;Mt.updateWorldMatrix(!0,!0),dt.setFromObject(Mt)}if(dt.isEmpty()){const Mt=it.position.length()||10;dt.setFromCenterAndSize(new Vector3,new Vector3(Mt,Mt,Mt))}if((ct==null?void 0:ct.constructor.name)==="OrthographicTrackballControls"){const{distance:Mt}=St(),Bt=it.position.clone().sub(ct.target).normalize().multiplyScalar(Mt),Rt=ct.target.clone().add(Bt);it.position.copy(Rt)}return this},clip(){const{distance:Tt}=St();return ct&&(ct.maxDistance=Tt*10),it.near=Tt/100,it.far=Tt*100,it.updateProjectionMatrix(),ct&&ct.update(),st(),this},to({position:Tt,target:Mt}){lt.camera.copy(it.position);const{center:Bt}=St();return ut.camera.set(...Tt),Mt?ut.focus.set(...Mt):ut.focus.copy(Bt),s?lt.animating=!0:it.position.set(...Tt),this},fit(){lt.camera.copy(it.position),ct&&lt.focus.copy(ct.target);const{center:Tt,distance:Mt}=St(),Bt=Tt.clone().sub(it.position).normalize().multiplyScalar(Mt);if(ut.camera.copy(Tt).sub(Bt),ut.focus.copy(Tt),isOrthographic(it)){lt.zoom=it.zoom;let Rt=0,Ut=0;const Ht=[new Vector3(dt.min.x,dt.min.y,dt.min.z),new Vector3(dt.min.x,dt.max.y,dt.min.z),new Vector3(dt.min.x,dt.min.y,dt.max.z),new Vector3(dt.min.x,dt.max.y,dt.max.z),new Vector3(dt.max.x,dt.max.y,dt.max.z),new Vector3(dt.max.x,dt.max.y,dt.min.z),new Vector3(dt.max.x,dt.min.y,dt.max.z),new Vector3(dt.max.x,dt.min.y,dt.min.z)];Tt.applyMatrix4(it.matrixWorldInverse);for(const sn of Ht)sn.applyMatrix4(it.matrixWorldInverse),Rt=Math.max(Rt,Math.abs(sn.y-Tt.y)),Ut=Math.max(Ut,Math.abs(sn.x-Tt.x));Rt*=2,Ut*=2;const Wt=(it.top-it.bottom)/Rt,Jt=(it.right-it.left)/Ut;ut.zoom=Math.min(Wt,Jt)/_e,s||(it.zoom=ut.zoom,it.updateProjectionMatrix())}return s?lt.animating=!0:(it.position.copy(ut.camera),it.lookAt(ut.focus),ct&&(ct.target.copy(ut.focus),ct.update())),ft.current&&ft.current(this.getSize()),st(),this}}},[dt,it,ct,_e,s,st]);reactExports.useLayoutEffect(()=>{if(ct){const St=()=>lt.animating=!1;return ct.addEventListener("start",St),()=>ct.removeEventListener("start",St)}},[ct]);const Et=reactExports.useRef(0);return reactExports.useLayoutEffect(()=>{($||Et.current++===0)&&(gt.refresh(),o&&gt.fit(),j&&gt.clip())},[at,j,o,$,it,ct]),useFrame((St,Tt)=>{if(lt.animating){if(mt(lt.focus,ut.focus,s,Tt),mt(lt.camera,ut.camera,s,Tt),lt.zoom=MathUtils.damp(lt.zoom,ut.zoom,s,Tt),it.position.copy(lt.camera),isOrthographic(it)&&(it.zoom=lt.zoom,it.updateProjectionMatrix()),ct?(ct.target.copy(lt.focus),ct.update()):it.lookAt(lt.focus),st(),isOrthographic(it)&&!(Math.abs(lt.zoom-ut.zoom)<tt)||!isOrthographic(it)&&!ht(lt.camera,ut.camera)||ct&&!ht(lt.focus,ut.focus))return;lt.animating=!1}}),reactExports.createElement("group",{ref:rt},reactExports.createElement(context.Provider,{value:gt},a))}function useBounds(){return reactExports.useContext(context)}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray=a=>Array.isArray(a);function useEnvironment({files:a=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:s="",preset:o=void 0,encoding:j=void 0,extensions:$}={}){var _e;let tt=null,nt=!1,rt;if(o){if(!(o in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "));a=presetsObj[o],s=CUBEMAP_ROOT}if(nt=isArray(a),rt=isArray(a)?"cube":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":(_e=a.split(".").pop())==null?void 0:_e.toLowerCase(),tt=nt?CubeTextureLoader:rt==="hdr"?RGBELoader:rt==="exr"?EXRLoader:null,!tt)throw new Error("useEnvironment: Unrecognized file extension: "+a);const it=useLoader(tt,nt?[a]:a,ct=>{ct.setPath==null||ct.setPath(s),$&&$(ct)}),st=nt?it[0]:it;st.mapping=nt?CubeReflectionMapping:EquirectangularReflectionMapping;const at=3001,ot=3e3;return"colorSpace"in st?st.colorSpace=j??nt?"srgb":"srgb-linear":st.encoding=j??nt?at:ot,st}const isRef=a=>a.current&&a.current.isScene,resolveScene=a=>isRef(a)?a.current:a;function setEnvProps(a,s,o,j,$=0){const _e=resolveScene(s||o),tt=_e.background,nt=_e.environment,rt=_e.backgroundBlurriness||0;return a!=="only"&&(_e.environment=j),a&&(_e.background=j),a&&_e.backgroundBlurriness!==void 0&&(_e.backgroundBlurriness=$),()=>{a!=="only"&&(_e.environment=nt),a&&(_e.background=tt),a&&_e.backgroundBlurriness!==void 0&&(_e.backgroundBlurriness=rt)}}function EnvironmentMap({scene:a,background:s=!1,blur:o,map:j}){const $=useThree(_e=>_e.scene);return reactExports.useLayoutEffect(()=>{if(j)return setEnvProps(s,a,$,j,o)},[$,a,j,s,o]),null}function EnvironmentCube({background:a=!1,scene:s,blur:o,...j}){const $=useEnvironment(j),_e=useThree(tt=>tt.scene);return reactExports.useLayoutEffect(()=>setEnvProps(a,s,_e,$,o),[$,a,s,_e,o]),null}function EnvironmentPortal({children:a,near:s=1,far:o=1e3,resolution:j=256,frames:$=1,map:_e,background:tt=!1,blur:nt,scene:rt,files:it,path:st,preset:at=void 0,extensions:ot}){const ct=useThree(dt=>dt.gl),ft=useThree(dt=>dt.scene),ht=reactExports.useRef(null),[mt]=reactExports.useState(()=>new Scene),lt=reactExports.useMemo(()=>{const dt=new WebGLCubeRenderTarget(j);return dt.texture.type=HalfFloatType,dt},[j]);reactExports.useLayoutEffect(()=>($===1&&ht.current.update(ct,mt),setEnvProps(tt,rt,ft,lt.texture,nt)),[a,mt,lt.texture,rt,ft,tt,$,ct]);let ut=1;return useFrame(()=>{($===1/0||ut<$)&&(ht.current.update(ct,mt),ut++)}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,a,reactExports.createElement("cubeCamera",{ref:ht,args:[s,o,lt]}),it||at?reactExports.createElement(EnvironmentCube,{background:!0,files:it,preset:at,path:st,extensions:ot}):_e?reactExports.createElement(EnvironmentMap,{background:!0,map:_e,extensions:ot}):null),mt))}function EnvironmentGround(a){var s,o,j,$;const _e=useEnvironment(a),tt=a.map||_e;reactExports.useMemo(()=>extend({GroundProjectedEnvImpl:GroundProjectedEnv}),[]);const nt=reactExports.useMemo(()=>[tt],[tt]),rt=(s=a.ground)==null?void 0:s.height,it=(o=a.ground)==null?void 0:o.radius,st=(j=($=a.ground)==null?void 0:$.scale)!==null&&j!==void 0?j:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends({},a,{map:tt})),reactExports.createElement("groundProjectedEnvImpl",{args:nt,scale:st,height:rt,radius:it}))}function Environment(a){return a.ground?reactExports.createElement(EnvironmentGround,a):a.map?reactExports.createElement(EnvironmentMap,a):a.children?reactExports.createElement(EnvironmentPortal,a):reactExports.createElement(EnvironmentCube,a)}const ContactShadows=reactExports.forwardRef(({scale:a=10,frames:s=1/0,opacity:o=1,width:j=1,height:$=1,blur:_e=1,far:tt=10,resolution:nt=512,smooth:rt=!0,color:it="#000000",depthWrite:st=!1,renderOrder:at,...ot},ct)=>{const ft=reactExports.useRef(null),ht=useThree(Wt=>Wt.scene),mt=useThree(Wt=>Wt.gl),lt=reactExports.useRef(null);j=j*(Array.isArray(a)?a[0]:a||1),$=$*(Array.isArray(a)?a[1]:a||1);const[ut,dt,gt,Et,St,Tt,Mt]=reactExports.useMemo(()=>{const Wt=new WebGLRenderTarget(nt,nt),Jt=new WebGLRenderTarget(nt,nt);Jt.texture.generateMipmaps=Wt.texture.generateMipmaps=!1;const sn=new PlaneGeometry(j,$).rotateX(Math.PI/2),jt=new Mesh(sn),Vt=new MeshDepthMaterial;Vt.depthTest=Vt.depthWrite=!1,Vt.onBeforeCompile=nn=>{nn.uniforms={...nn.uniforms,ucolor:{value:new Color(it)}},nn.fragmentShader=nn.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),nn.fragmentShader=nn.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Lt=new ShaderMaterial(HorizontalBlurShader),Qt=new ShaderMaterial(VerticalBlurShader);return Qt.depthTest=Lt.depthTest=!1,[Wt,sn,Vt,jt,Lt,Qt,Jt]},[nt,j,$,a,it]),Bt=Wt=>{Et.visible=!0,Et.material=St,St.uniforms.tDiffuse.value=ut.texture,St.uniforms.h.value=Wt*1/256,mt.setRenderTarget(Mt),mt.render(Et,lt.current),Et.material=Tt,Tt.uniforms.tDiffuse.value=Mt.texture,Tt.uniforms.v.value=Wt*1/256,mt.setRenderTarget(ut),mt.render(Et,lt.current),Et.visible=!1};let Rt=0,Ut,Ht;return useFrame(()=>{lt.current&&(s===1/0||Rt<s)&&(Rt++,Ut=ht.background,Ht=ht.overrideMaterial,ft.current.visible=!1,ht.background=null,ht.overrideMaterial=gt,mt.setRenderTarget(ut),mt.render(ht,lt.current),Bt(_e),rt&&Bt(_e*.4),mt.setRenderTarget(null),ft.current.visible=!0,ht.overrideMaterial=Ht,ht.background=Ut)}),reactExports.useImperativeHandle(ct,()=>ft.current,[]),reactExports.createElement("group",_extends({"rotation-x":Math.PI/2},ot,{ref:ft}),reactExports.createElement("mesh",{renderOrder:at,geometry:dt,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},reactExports.createElement("meshBasicMaterial",{transparent:!0,map:ut.texture,opacity:o,depthWrite:st})),reactExports.createElement("orthographicCamera",{ref:lt,args:[-j/2,j/2,$/2,-$/2,0,tt]}))});function isLight(a){return a.isLight}function isGeometry(a){return!!a.geometry}const accumulativeContext=reactExports.createContext(null),SoftShadowMaterial=shaderMaterial({color:new Color,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <encodings_fragment>
   }`),AccumulativeShadows=reactExports.forwardRef(({children:a,temporal:s,frames:o=40,limit:j=1/0,blend:$=20,scale:_e=10,opacity:tt=1,alphaTest:nt=.75,color:rt="black",colorBlend:it=2,resolution:st=1024,toneMapped:at=!0,...ot},ct)=>{extend({SoftShadowMaterial});const ft=useThree(St=>St.gl),ht=useThree(St=>St.scene),mt=useThree(St=>St.camera),lt=useThree(St=>St.invalidate),ut=reactExports.useRef(null),dt=reactExports.useRef(null),[gt]=reactExports.useState(()=>new ProgressiveLightMap(ft,ht,st));reactExports.useLayoutEffect(()=>{gt.configure(ut.current)},[]);const Et=reactExports.useMemo(()=>({lights:new Map,temporal:!!s,frames:Math.max(2,o),blend:Math.max(2,o===1/0?$:o),count:0,getMesh:()=>ut.current,reset:()=>{gt.clear();const St=ut.current.material;St.opacity=0,St.alphaTest=0,Et.count=0},update:(St=1)=>{const Tt=ut.current.material;Et.temporal?(Tt.opacity=Math.min(tt,Tt.opacity+tt/Et.blend),Tt.alphaTest=Math.min(nt,Tt.alphaTest+nt/Et.blend)):(Tt.opacity=tt,Tt.alphaTest=nt),dt.current.visible=!0,gt.prepare();for(let Mt=0;Mt<St;Mt++)Et.lights.forEach(Bt=>Bt.update()),gt.update(mt,Et.blend);dt.current.visible=!1,gt.finish()}}),[gt,mt,ht,s,o,$,tt,nt]);return reactExports.useLayoutEffect(()=>{Et.reset(),!Et.temporal&&Et.frames!==1/0&&Et.update(Et.blend)}),reactExports.useImperativeHandle(ct,()=>Et,[Et]),useFrame(()=>{(Et.temporal||Et.frames===1/0)&&Et.count<Et.frames&&Et.count<j&&(lt(),Et.update(),Et.count++)}),reactExports.createElement("group",ot,reactExports.createElement("group",{traverse:()=>null,ref:dt},reactExports.createElement(accumulativeContext.Provider,{value:Et},a)),reactExports.createElement("mesh",{receiveShadow:!0,ref:ut,scale:_e,rotation:[-Math.PI/2,0,0]},reactExports.createElement("planeGeometry",null),reactExports.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:at,color:rt,blend:it,map:gt.progressiveLightMap2.texture})))}),RandomizedLight=reactExports.forwardRef(({castShadow:a=!0,bias:s=.001,mapSize:o=512,size:j=5,near:$=.5,far:_e=500,frames:tt=1,position:nt=[0,0,0],radius:rt=1,amount:it=8,intensity:st=1,ambient:at=.5,...ot},ct)=>{const ft=reactExports.useRef(null),ht=new Vector3(...nt).length(),mt=reactExports.useContext(accumulativeContext),lt=reactExports.useCallback(()=>{let dt;if(ft.current)for(let gt=0;gt<ft.current.children.length;gt++)if(dt=ft.current.children[gt],Math.random()>at)dt.position.set(nt[0]+MathUtils.randFloatSpread(rt),nt[1]+MathUtils.randFloatSpread(rt),nt[2]+MathUtils.randFloatSpread(rt));else{let Et=Math.acos(2*Math.random()-1)-Math.PI/2,St=2*Math.PI*Math.random();dt.position.set(Math.cos(Et)*Math.cos(St)*ht,Math.abs(Math.cos(Et)*Math.sin(St)*ht),Math.sin(Et)*ht)}},[rt,at,ht,...nt]),ut=reactExports.useMemo(()=>({update:lt}),[lt]);return reactExports.useImperativeHandle(ct,()=>ut,[ut]),reactExports.useLayoutEffect(()=>{const dt=ft.current;return mt&&mt.lights.set(dt.uuid,ut),()=>void mt.lights.delete(dt.uuid)},[mt,ut]),reactExports.createElement("group",_extends({ref:ft},ot),Array.from({length:it},(dt,gt)=>reactExports.createElement("directionalLight",{key:gt,castShadow:a,"shadow-bias":s,"shadow-mapSize":[o,o],intensity:st/it},reactExports.createElement("orthographicCamera",{attach:"shadow-camera",args:[-j,j,j,-j,$,_e]}))))});class ProgressiveLightMap{constructor(s,o,j=1024){this.renderer=s,this.res=j,this.scene=o,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new Color,this.clearAlpha=0;const $=/(Android|iPad|iPhone|iPod)/g.test(navigator.userAgent)?HalfFloatType:FloatType;this.progressiveLightMap1=new WebGLRenderTarget(this.res,this.res,{type:$}),this.progressiveLightMap2=new WebGLRenderTarget(this.res,this.res,{type:$}),this.discardMat=new DiscardMaterial,this.targetMat=new MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=_e=>{_e.vertexShader=`varying vec2 vUv;
`+_e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const tt=_e.fragmentShader.indexOf("void main() {");_e.fragmentShader=`varying vec2 vUv;
`+_e.fragmentShader.slice(0,tt)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+_e.fragmentShader.slice(tt-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,_e.uniforms.previousShadowMap=this.previousShadowMap,_e.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(s=>{isGeometry(s)?this.meshes.push({object:s,material:s.material}):isLight(s)&&this.lights.push({object:s,intensity:s.intensity})})}prepare(){this.lights.forEach(s=>s.object.intensity=0),this.meshes.forEach(s=>s.object.material=this.discardMat)}finish(){this.lights.forEach(s=>s.object.intensity=s.intensity),this.meshes.forEach(s=>s.object.material=s.material)}configure(s){this.object=s}update(s,o=100){if(!this.object)return;this.averagingWindow.value=o,this.object.material=this.targetMat;const j=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,$=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,_e=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(j),this.previousShadowMap.value=$.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,s),this.renderer.setRenderTarget(null),this.scene.background=_e}}const presets={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function Refit({radius:a,adjustCamera:s}){const o=useBounds();return reactExports.useEffect(()=>{s&&o.refresh().clip().fit()},[a,s]),null}function Stage({children:a,center:s,adjustCamera:o=!0,intensity:j=.5,shadows:$="contact",environment:_e="city",preset:tt="rembrandt",...nt}){var rt,it,st,at,ot,ct,ft,ht;const mt=typeof tt=="string"?presets[tt]:tt,[{radius:lt,height:ut},dt]=reactExports.useState({radius:0,width:0,height:0,depth:0}),gt=(rt=$==null?void 0:$.bias)!==null&&rt!==void 0?rt:-1e-4,Et=(it=$==null?void 0:$.normalBias)!==null&&it!==void 0?it:0,St=(st=$==null?void 0:$.size)!==null&&st!==void 0?st:1024,Tt=(at=$==null?void 0:$.offset)!==null&&at!==void 0?at:0,Mt=$==="contact"||($==null?void 0:$.type)==="contact",Bt=$==="accumulative"||($==null?void 0:$.type)==="accumulative",Rt={...typeof $=="object"?$:{}},Ut=_e?typeof _e=="string"?{preset:_e}:_e:null,Ht=reactExports.useCallback(Wt=>{const{width:Jt,height:sn,depth:jt,boundingSphere:Vt}=Wt;dt({radius:Vt.radius,width:Jt,height:sn,depth:jt}),s!=null&&s.onCentered&&s.onCentered(Wt)},[]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("ambientLight",{intensity:j/3}),reactExports.createElement("spotLight",{penumbra:1,position:[mt.main[0]*lt,mt.main[1]*lt,mt.main[2]*lt],intensity:j*2,castShadow:!!$,"shadow-bias":gt,"shadow-normalBias":Et,"shadow-mapSize":St}),reactExports.createElement("pointLight",{position:[mt.fill[0]*lt,mt.fill[1]*lt,mt.fill[2]*lt],intensity:j}),reactExports.createElement(Bounds,_extends({fit:!!o,clip:!!o,margin:Number(o),observe:!0},nt),reactExports.createElement(Refit,{radius:lt,adjustCamera:o}),reactExports.createElement(Center,_extends({},s,{position:[0,Tt/2,0],onCentered:Ht}),a)),reactExports.createElement("group",{position:[0,-ut/2-Tt/2,0]},Mt&&reactExports.createElement(ContactShadows,_extends({scale:lt*4,far:lt,blur:2},Rt)),Bt&&reactExports.createElement(AccumulativeShadows,_extends({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:lt*4},Rt),reactExports.createElement(RandomizedLight,{amount:(ot=Rt.amount)!==null&&ot!==void 0?ot:8,radius:(ct=Rt.radius)!==null&&ct!==void 0?ct:lt,ambient:(ft=Rt.ambient)!==null&&ft!==void 0?ft:.5,intensity:(ht=Rt.intensity)!==null&&ht!==void 0?ht:1,position:[mt.main[0]*lt,mt.main[1]*lt,mt.main[2]*lt],size:lt*4,bias:-gt,mapSize:St}))),_e&&reactExports.createElement(Environment,Ut))}const ConfiguratorContext=reactExports.createContext(),ConfiguratorProvider=({children:a})=>{const[s,o]=reactExports.useState(0),[j,$]=reactExports.useState("#777777"),[_e,tt]=reactExports.useState(100);return jsx(ConfiguratorContext.Provider,{value:{legs:s,setLegs:o,legsColor:j,setLegsColor:$,tableWidth:_e,setTableWidth:tt},children:a})},useConfigurator=()=>reactExports.useContext(ConfiguratorContext),ANIM_SPEED=12;function Table(a){const{nodes:s,materials:o}=useGLTF("./models/Table.gltf"),{legs:j,legsColor:$,tableWidth:_e}=useConfigurator(),tt=reactExports.useRef(),nt=reactExports.useRef(),rt=reactExports.useRef();return reactExports.useEffect(()=>{o.Metal.color=new Color($)},[$]),useFrame((it,st)=>{const at=_e/100,ot=new Vector3(at,1,1);tt.current.scale.lerp(ot,st*ANIM_SPEED);const ct=new Vector3(-1.5*at,0,0);nt.current.position.lerp(ct,st*ANIM_SPEED);const ft=new Vector3(1.5*at,0,0);rt.current.position.lerp(ft,st*ANIM_SPEED)}),jsxs("group",{...a,dispose:null,children:[jsx("mesh",{geometry:s.Plate.geometry,material:o.Plate,castShadow:!0,ref:tt}),j===0&&jsxs(Fragment,{children:[jsx("mesh",{castShadow:!0,geometry:s.Legs01Left.geometry,material:o.Metal,position:[-1.5,0,0],ref:nt}),jsx("mesh",{geometry:s.Legs01Right.geometry,material:o.Metal,position:[1.5,0,0],castShadow:!0,ref:rt})]}),j===1&&jsxs(Fragment,{children:[jsx("mesh",{geometry:s.Legs02Left.geometry,material:o.Metal,position:[-1.5,0,0],castShadow:!0,ref:nt}),jsx("mesh",{geometry:s.Legs02Right.geometry,material:o.Metal,position:[1.5,0,0],castShadow:!0,ref:rt})]}),j===2&&jsxs(Fragment,{children:[jsx("mesh",{geometry:s.Legs03Left.geometry,material:o.Metal,position:[-1.5,0,0],castShadow:!0,ref:nt}),jsx("mesh",{geometry:s.Legs03Right.geometry,material:o.Metal,position:[1.5,0,0],castShadow:!0,ref:rt})]})]})}useGLTF.preload("./models/Table.gltf");const Experience=()=>(useConfigurator(),jsxs(Fragment,{children:[jsx(Stage,{intensity:1.5,environment:"city",shadows:{type:"accumulative",color:"#d9afd9",colorBlend:2,opacity:2},adjustCamera:2,children:jsx(Table,{})}),jsx(OrbitControls,{makeDefault:!0,minPolarAngle:0,maxPolarAngle:Math.PI/2})]})),common={black:"#000",white:"#fff"},common$1=common,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey;function isPlainObject(a){return a!==null&&typeof a=="object"&&a.constructor===Object}function deepClone(a){if(!isPlainObject(a))return a;const s={};return Object.keys(a).forEach(o=>{s[o]=deepClone(a[o])}),s}function deepmerge(a,s,o={clone:!0}){const j=o.clone?_extends({},a):a;return isPlainObject(a)&&isPlainObject(s)&&Object.keys(s).forEach($=>{$!=="__proto__"&&(isPlainObject(s[$])&&$ in a&&isPlainObject(a[$])?j[$]=deepmerge(a[$],s[$],o):o.clone?j[$]=isPlainObject(s[$])?deepClone(s[$]):s[$]:j[$]=s[$])}),j}function formatMuiErrorMessage(a){let s="https://mui.com/production-error/?code="+a;for(let o=1;o<arguments.length;o+=1)s+="&args[]="+encodeURIComponent(arguments[o]);return"Minified MUI error #"+a+"; visit "+s+" for the full message."}function capitalize(a){if(typeof a!="string")throw new Error(formatMuiErrorMessage(7));return a.charAt(0).toUpperCase()+a.slice(1)}function createChainedFunction(...a){return a.reduce((s,o)=>o==null?s:function(...$){s.apply(this,$),o.apply(this,$)},()=>{})}function isMuiElement(a,s){return reactExports.isValidElement(a)&&s.indexOf(a.type.muiName)!==-1}function ownerDocument(a){return a&&a.ownerDocument||document}function setRef(a,s){typeof a=="function"?a(s):a&&(a.current=s)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(a){const[s,o]=reactExports.useState(a),j=a||s;return reactExports.useEffect(()=>{s==null&&(globalId+=1,o(`mui-${globalId}`))},[s]),j}const maybeReactUseId=React$1["useId"];function useId(a){if(maybeReactUseId!==void 0){const s=maybeReactUseId();return a??s}return useGlobalId(a)}function useControlled({controlled:a,default:s,name:o,state:j="value"}){const{current:$}=reactExports.useRef(a!==void 0),[_e,tt]=reactExports.useState(s),nt=$?a:_e,rt=reactExports.useCallback(it=>{$||tt(it)},[]);return[nt,rt]}function useEventCallback(a){const s=reactExports.useRef(a);return useEnhancedEffect$1(()=>{s.current=a}),reactExports.useCallback((...o)=>(0,s.current)(...o),[])}function useForkRef(...a){return reactExports.useMemo(()=>a.every(s=>s==null)?null:s=>{a.forEach(o=>{setRef(o,s)})},a)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(a){const{type:s,tagName:o}=a;return!!(o==="INPUT"&&inputTypesWhitelist[s]&&!a.readOnly||o==="TEXTAREA"&&!a.readOnly||a.isContentEditable)}function handleKeyDown(a){a.metaKey||a.altKey||a.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare(a){a.addEventListener("keydown",handleKeyDown,!0),a.addEventListener("mousedown",handlePointerDown,!0),a.addEventListener("pointerdown",handlePointerDown,!0),a.addEventListener("touchstart",handlePointerDown,!0),a.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(a){const{target:s}=a;try{return s.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(s)}function useIsFocusVisible(){const a=reactExports.useCallback($=>{$!=null&&prepare($.ownerDocument)},[]),s=reactExports.useRef(!1);function o(){return s.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),s.current=!1,!0):!1}function j($){return isFocusVisible($)?(s.current=!0,!0):!1}return{isFocusVisibleRef:s,onFocus:j,onBlur:o,ref:a}}const visuallyHidden={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},visuallyHidden$1=visuallyHidden;function resolveProps(a,s){const o=_extends({},s);return Object.keys(a).forEach(j=>{if(j.toString().match(/^(components|slots)$/))o[j]=_extends({},a[j],o[j]);else if(j.toString().match(/^(componentsProps|slotProps)$/)){const $=a[j]||{},_e=s[j];o[j]={},!_e||!Object.keys(_e)?o[j]=$:!$||!Object.keys($)?o[j]=_e:(o[j]=_extends({},_e),Object.keys($).forEach(tt=>{o[j][tt]=resolveProps($[tt],_e[tt])}))}else o[j]===void 0&&(o[j]=a[j])}),o}function composeClasses(a,s,o){const j={};return Object.keys(a).forEach($=>{j[$]=a[$].reduce((_e,tt)=>(tt&&(_e.push(s(tt)),o&&o[tt]&&_e.push(o[tt])),_e),[]).join(" ")}),j}const defaultGenerator=a=>a,createClassNameGenerator=()=>{let a=defaultGenerator;return{configure(s){a=s},generate(s){return a(s)},reset(){a=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),ClassNameGenerator$1=ClassNameGenerator,globalStateClassesMapping={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function generateUtilityClass(a,s,o="Mui"){const j=globalStateClassesMapping[s];return j?`${o}-${j}`:`${ClassNameGenerator$1.generate(a)}-${s}`}function generateUtilityClasses(a,s,o="Mui"){const j={};return s.forEach($=>{j[$]=generateUtilityClass(a,$,o)}),j}function _objectWithoutPropertiesLoose(a,s){if(a==null)return{};var o={},j=Object.keys(a),$,_e;for(_e=0;_e<j.length;_e++)$=j[_e],!(s.indexOf($)>=0)&&(o[$]=a[$]);return o}function memoize$1(a){var s=Object.create(null);return function(o){return s[o]===void 0&&(s[o]=a(o)),s[o]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(a){return reactPropsRegex.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91});function sheetForTag(a){if(a.sheet)return a.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===a)return document.styleSheets[s]}function createStyleElement(a){var s=document.createElement("style");return s.setAttribute("data-emotion",a.key),a.nonce!==void 0&&s.setAttribute("nonce",a.nonce),s.appendChild(document.createTextNode("")),s.setAttribute("data-s",""),s}var StyleSheet=function(){function a(o){var j=this;this._insertTag=function($){var _e;j.tags.length===0?j.insertionPoint?_e=j.insertionPoint.nextSibling:j.prepend?_e=j.container.firstChild:_e=j.before:_e=j.tags[j.tags.length-1].nextSibling,j.container.insertBefore($,_e),j.tags.push($)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var s=a.prototype;return s.hydrate=function(j){j.forEach(this._insertTag)},s.insert=function(j){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var $=this.tags[this.tags.length-1];if(this.isSpeedy){var _e=sheetForTag($);try{_e.insertRule(j,_e.cssRules.length)}catch{}}else $.appendChild(document.createTextNode(j));this.ctr++},s.flush=function(){this.tags.forEach(function(j){return j.parentNode&&j.parentNode.removeChild(j)}),this.tags=[],this.ctr=0},a}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash(a,s){return charat(a,0)^45?(((s<<2^charat(a,0))<<2^charat(a,1))<<2^charat(a,2))<<2^charat(a,3):0}function trim(a){return a.trim()}function match(a,s){return(a=s.exec(a))?a[0]:a}function replace(a,s,o){return a.replace(s,o)}function indexof(a,s){return a.indexOf(s)}function charat(a,s){return a.charCodeAt(s)|0}function substr(a,s,o){return a.slice(s,o)}function strlen(a){return a.length}function sizeof$1(a){return a.length}function append(a,s){return s.push(a),a}function combine(a,s){return a.map(s).join("")}var line=1,column=1,length=0,position=0,character=0,characters="";function node(a,s,o,j,$,_e,tt){return{value:a,root:s,parent:o,type:j,props:$,children:_e,line,column,length:tt,return:""}}function copy(a,s){return assign(node("",null,null,"",null,null,0),a,{length:-a.length},s)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(a,s){return substr(characters,a,s)}function token(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(a){return line=column=1,length=strlen(characters=a),position=0,[]}function dealloc(a){return characters="",a}function delimit(a){return trim(slice(position-1,delimiter(a===91?a+2:a===40?a+1:a)))}function whitespace(a){for(;(character=peek())&&character<33;)next();return token(a)>2||token(character)>3?"":" "}function escaping(a,s){for(;--s&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(a,caret()+(s<6&&peek()==32&&next()==32))}function delimiter(a){for(;next();)switch(character){case a:return position;case 34:case 39:a!==34&&a!==39&&delimiter(character);break;case 40:a===41&&delimiter(a);break;case 92:next();break}return position}function commenter(a,s){for(;next()&&a+character!==47+10;)if(a+character===42+42&&peek()===47)break;return"/*"+slice(s,position-1)+"*"+from(a===47?a:next())}function identifier(a){for(;!token(peek());)next();return slice(a,position)}function compile(a){return dealloc(parse("",null,null,null,[""],a=alloc(a),0,[0],a))}function parse(a,s,o,j,$,_e,tt,nt,rt){for(var it=0,st=0,at=tt,ot=0,ct=0,ft=0,ht=1,mt=1,lt=1,ut=0,dt="",gt=$,Et=_e,St=j,Tt=dt;mt;)switch(ft=ut,ut=next()){case 40:if(ft!=108&&charat(Tt,at-1)==58){indexof(Tt+=replace(delimit(ut),"&","&\f"),"&\f")!=-1&&(lt=-1);break}case 34:case 39:case 91:Tt+=delimit(ut);break;case 9:case 10:case 13:case 32:Tt+=whitespace(ft);break;case 92:Tt+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),s,o),rt);break;default:Tt+="/"}break;case 123*ht:nt[it++]=strlen(Tt)*lt;case 125*ht:case 59:case 0:switch(ut){case 0:case 125:mt=0;case 59+st:ct>0&&strlen(Tt)-at&&append(ct>32?declaration(Tt+";",j,o,at-1):declaration(replace(Tt," ","")+";",j,o,at-2),rt);break;case 59:Tt+=";";default:if(append(St=ruleset(Tt,s,o,it,st,$,nt,dt,gt=[],Et=[],at),_e),ut===123)if(st===0)parse(Tt,s,St,St,gt,_e,at,nt,Et);else switch(ot===99&&charat(Tt,3)===110?100:ot){case 100:case 109:case 115:parse(a,St,St,j&&append(ruleset(a,St,St,0,0,$,nt,dt,$,gt=[],at),Et),$,Et,at,nt,j?gt:Et);break;default:parse(Tt,St,St,St,[""],Et,0,nt,Et)}}it=st=ct=0,ht=lt=1,dt=Tt="",at=tt;break;case 58:at=1+strlen(Tt),ct=ft;default:if(ht<1){if(ut==123)--ht;else if(ut==125&&ht++==0&&prev()==125)continue}switch(Tt+=from(ut),ut*ht){case 38:lt=st>0?1:(Tt+="\f",-1);break;case 44:nt[it++]=(strlen(Tt)-1)*lt,lt=1;break;case 64:peek()===45&&(Tt+=delimit(next())),ot=peek(),st=at=strlen(dt=Tt+=identifier(caret())),ut++;break;case 45:ft===45&&strlen(Tt)==2&&(ht=0)}}return _e}function ruleset(a,s,o,j,$,_e,tt,nt,rt,it,st){for(var at=$-1,ot=$===0?_e:[""],ct=sizeof$1(ot),ft=0,ht=0,mt=0;ft<j;++ft)for(var lt=0,ut=substr(a,at+1,at=abs(ht=tt[ft])),dt=a;lt<ct;++lt)(dt=trim(ht>0?ot[lt]+" "+ut:replace(ut,/&\f/g,ot[lt])))&&(rt[mt++]=dt);return node(a,s,o,$===0?RULESET:nt,rt,it,st)}function comment(a,s,o){return node(a,s,o,COMMENT,from(char()),substr(a,2,-2),0)}function declaration(a,s,o,j){return node(a,s,o,DECLARATION,substr(a,0,j),substr(a,j+1,-1),j)}function serialize(a,s){for(var o="",j=sizeof$1(a),$=0;$<j;$++)o+=s(a[$],$,a,s)||"";return o}function stringify(a,s,o,j){switch(a.type){case IMPORT:case DECLARATION:return a.return=a.return||a.value;case COMMENT:return"";case KEYFRAMES:return a.return=a.value+"{"+serialize(a.children,j)+"}";case RULESET:a.value=a.props.join(",")}return strlen(o=serialize(a.children,j))?a.return=a.value+"{"+o+"}":""}function middleware(a){var s=sizeof$1(a);return function(o,j,$,_e){for(var tt="",nt=0;nt<s;nt++)tt+=a[nt](o,j,$,_e)||"";return tt}}function rulesheet(a){return function(s){s.root||(s=s.return)&&a(s)}}var identifierWithPointTracking=function a(s,o,j){for(var $=0,_e=0;$=_e,_e=peek(),$===38&&_e===12&&(o[j]=1),!token(_e);)next();return slice(s,position)},toRules=function a(s,o){var j=-1,$=44;do switch(token($)){case 0:$===38&&peek()===12&&(o[j]=1),s[j]+=identifierWithPointTracking(position-1,o,j);break;case 2:s[j]+=delimit($);break;case 4:if($===44){s[++j]=peek()===58?"&\f":"",o[j]=s[j].length;break}default:s[j]+=from($)}while($=next());return s},getRules=function a(s,o){return dealloc(toRules(alloc(s),o))},fixedElements=new WeakMap,compat=function a(s){if(!(s.type!=="rule"||!s.parent||s.length<1)){for(var o=s.value,j=s.parent,$=s.column===j.column&&s.line===j.line;j.type!=="rule";)if(j=j.parent,!j)return;if(!(s.props.length===1&&o.charCodeAt(0)!==58&&!fixedElements.get(j))&&!$){fixedElements.set(s,!0);for(var _e=[],tt=getRules(o,_e),nt=j.props,rt=0,it=0;rt<tt.length;rt++)for(var st=0;st<nt.length;st++,it++)s.props[it]=_e[rt]?tt[rt].replace(/&\f/g,nt[st]):nt[st]+" "+tt[rt]}}},removeLabel=function a(s){if(s.type==="decl"){var o=s.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(s.return="",s.value="")}};function prefix(a,s){switch(hash(a,s)){case 5103:return WEBKIT+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+a+MOZ+a+MS+a+a;case 6828:case 4268:return WEBKIT+a+MS+a+a;case 6165:return WEBKIT+a+MS+"flex-"+a+a;case 5187:return WEBKIT+a+replace(a,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+a;case 5443:return WEBKIT+a+MS+"flex-item-"+replace(a,/flex-|-self/,"")+a;case 4675:return WEBKIT+a+MS+"flex-line-pack"+replace(a,/align-content|flex-|-self/,"")+a;case 5548:return WEBKIT+a+MS+replace(a,"shrink","negative")+a;case 5292:return WEBKIT+a+MS+replace(a,"basis","preferred-size")+a;case 6060:return WEBKIT+"box-"+replace(a,"-grow","")+WEBKIT+a+MS+replace(a,"grow","positive")+a;case 4554:return WEBKIT+replace(a,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+a;case 6187:return replace(replace(replace(a,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),a,"")+a;case 5495:case 3959:return replace(a,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(a,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+a+a;case 4095:case 3583:case 4068:case 2532:return replace(a,/(.+)-inline(.+)/,WEBKIT+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(a)-1-s>6)switch(charat(a,s+1)){case 109:if(charat(a,s+4)!==45)break;case 102:return replace(a,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(a,s+3)==108?"$3":"$2-$3"))+a;case 115:return~indexof(a,"stretch")?prefix(replace(a,"stretch","fill-available"),s)+a:a}break;case 4949:if(charat(a,s+1)!==115)break;case 6444:switch(charat(a,strlen(a)-3-(~indexof(a,"!important")&&10))){case 107:return replace(a,":",":"+WEBKIT)+a;case 101:return replace(a,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(a,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+a}break;case 5936:switch(charat(a,s+11)){case 114:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return WEBKIT+a+MS+replace(a,/[svh]\w+-[tblr]{2}/,"lr")+a}return WEBKIT+a+MS+a+a}return a}var prefixer=function a(s,o,j,$){if(s.length>-1&&!s.return)switch(s.type){case DECLARATION:s.return=prefix(s.value,s.length);break;case KEYFRAMES:return serialize([copy(s,{value:replace(s.value,"@","@"+WEBKIT)})],$);case RULESET:if(s.length)return combine(s.props,function(_e){switch(match(_e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(s,{props:[replace(_e,/:(read-\w+)/,":"+MOZ+"$1")]})],$);case"::placeholder":return serialize([copy(s,{props:[replace(_e,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(s,{props:[replace(_e,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(s,{props:[replace(_e,/:(plac\w+)/,MS+"input-$1")]})],$)}return""})}},defaultStylisPlugins=[prefixer],createCache=function a(s){var o=s.key;if(o==="css"){var j=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(j,function(ht){var mt=ht.getAttribute("data-emotion");mt.indexOf(" ")!==-1&&(document.head.appendChild(ht),ht.setAttribute("data-s",""))})}var $=s.stylisPlugins||defaultStylisPlugins,_e={},tt,nt=[];tt=s.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(ht){for(var mt=ht.getAttribute("data-emotion").split(" "),lt=1;lt<mt.length;lt++)_e[mt[lt]]=!0;nt.push(ht)});var rt,it=[compat,removeLabel];{var st,at=[stringify,rulesheet(function(ht){st.insert(ht)})],ot=middleware(it.concat($,at)),ct=function(mt){return serialize(compile(mt),ot)};rt=function(mt,lt,ut,dt){st=ut,ct(mt?mt+"{"+lt.styles+"}":lt.styles),dt&&(ft.inserted[lt.name]=!0)}}var ft={key:o,sheet:new StyleSheet({key:o,container:tt,nonce:s.nonce,speedy:s.speedy,prepend:s.prepend,insertionPoint:s.insertionPoint}),nonce:s.nonce,inserted:_e,registered:{},insert:rt};return ft.sheet.hydrate(nt),ft},reactIsExports={},reactIs$1={get exports(){return reactIsExports},set exports(a){reactIsExports=a}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=typeof Symbol=="function"&&Symbol.for,c=b?Symbol.for("react.element"):60103,d=b?Symbol.for("react.portal"):60106,e=b?Symbol.for("react.fragment"):60107,f=b?Symbol.for("react.strict_mode"):60108,g=b?Symbol.for("react.profiler"):60114,h=b?Symbol.for("react.provider"):60109,k=b?Symbol.for("react.context"):60110,l=b?Symbol.for("react.async_mode"):60111,m=b?Symbol.for("react.concurrent_mode"):60111,n=b?Symbol.for("react.forward_ref"):60112,p=b?Symbol.for("react.suspense"):60113,q=b?Symbol.for("react.suspense_list"):60120,r$1=b?Symbol.for("react.memo"):60115,t=b?Symbol.for("react.lazy"):60116,v=b?Symbol.for("react.block"):60121,w=b?Symbol.for("react.fundamental"):60117,x=b?Symbol.for("react.responder"):60118,y=b?Symbol.for("react.scope"):60119;function z(a){if(typeof a=="object"&&a!==null){var s=a.$$typeof;switch(s){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r$1:case h:return a;default:return s}}case d:return s}}}function A(a){return z(a)===m}reactIs_production_min.AsyncMode=l;reactIs_production_min.ConcurrentMode=m;reactIs_production_min.ContextConsumer=k;reactIs_production_min.ContextProvider=h;reactIs_production_min.Element=c;reactIs_production_min.ForwardRef=n;reactIs_production_min.Fragment=e;reactIs_production_min.Lazy=t;reactIs_production_min.Memo=r$1;reactIs_production_min.Portal=d;reactIs_production_min.Profiler=g;reactIs_production_min.StrictMode=f;reactIs_production_min.Suspense=p;reactIs_production_min.isAsyncMode=function(a){return A(a)||z(a)===l};reactIs_production_min.isConcurrentMode=A;reactIs_production_min.isContextConsumer=function(a){return z(a)===k};reactIs_production_min.isContextProvider=function(a){return z(a)===h};reactIs_production_min.isElement=function(a){return typeof a=="object"&&a!==null&&a.$$typeof===c};reactIs_production_min.isForwardRef=function(a){return z(a)===n};reactIs_production_min.isFragment=function(a){return z(a)===e};reactIs_production_min.isLazy=function(a){return z(a)===t};reactIs_production_min.isMemo=function(a){return z(a)===r$1};reactIs_production_min.isPortal=function(a){return z(a)===d};reactIs_production_min.isProfiler=function(a){return z(a)===g};reactIs_production_min.isStrictMode=function(a){return z(a)===f};reactIs_production_min.isSuspense=function(a){return z(a)===p};reactIs_production_min.isValidElementType=function(a){return typeof a=="string"||typeof a=="function"||a===e||a===m||a===g||a===f||a===p||a===q||typeof a=="object"&&a!==null&&(a.$$typeof===t||a.$$typeof===r$1||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};reactIs_production_min.typeOf=z;(function(a){a.exports=reactIs_production_min})(reactIs$1);var reactIs=reactIsExports,FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var isBrowser=!0;function getRegisteredStyles(a,s,o){var j="";return o.split(" ").forEach(function($){a[$]!==void 0?s.push(a[$]+";"):j+=$+" "}),j}var registerStyles=function a(s,o,j){var $=s.key+"-"+o.name;(j===!1||isBrowser===!1)&&s.registered[$]===void 0&&(s.registered[$]=o.styles)},insertStyles=function a(s,o,j){registerStyles(s,o,j);var $=s.key+"-"+o.name;if(s.inserted[o.name]===void 0){var _e=o;do s.insert(o===_e?"."+$:"",_e,s.sheet,!0),_e=_e.next;while(_e!==void 0)}};function murmur2(a){for(var s=0,o,j=0,$=a.length;$>=4;++j,$-=4)o=a.charCodeAt(j)&255|(a.charCodeAt(++j)&255)<<8|(a.charCodeAt(++j)&255)<<16|(a.charCodeAt(++j)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,s=(o&65535)*1540483477+((o>>>16)*59797<<16)^(s&65535)*1540483477+((s>>>16)*59797<<16);switch($){case 3:s^=(a.charCodeAt(j+2)&255)<<16;case 2:s^=(a.charCodeAt(j+1)&255)<<8;case 1:s^=a.charCodeAt(j)&255,s=(s&65535)*1540483477+((s>>>16)*59797<<16)}return s^=s>>>13,s=(s&65535)*1540483477+((s>>>16)*59797<<16),((s^s>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function a(s){return s.charCodeAt(1)===45},isProcessableValue=function a(s){return s!=null&&typeof s!="boolean"},processStyleName=memoize$1(function(a){return isCustomProperty(a)?a:a.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function a(s,o){switch(s){case"animation":case"animationName":if(typeof o=="string")return o.replace(animationRegex,function(j,$,_e){return cursor={name:$,styles:_e,next:cursor},$})}return unitlessKeys[s]!==1&&!isCustomProperty(s)&&typeof o=="number"&&o!==0?o+"px":o},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(a,s,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return cursor={name:o.name,styles:o.styles,next:cursor},o.name;if(o.styles!==void 0){var j=o.next;if(j!==void 0)for(;j!==void 0;)cursor={name:j.name,styles:j.styles,next:cursor},j=j.next;var $=o.styles+";";return $}return createStringFromObject(a,s,o)}case"function":{if(a!==void 0){var _e=cursor,tt=o(a);return cursor=_e,handleInterpolation(a,s,tt)}break}}if(s==null)return o;var nt=s[o];return nt!==void 0?nt:o}function createStringFromObject(a,s,o){var j="";if(Array.isArray(o))for(var $=0;$<o.length;$++)j+=handleInterpolation(a,s,o[$])+";";else for(var _e in o){var tt=o[_e];if(typeof tt!="object")s!=null&&s[tt]!==void 0?j+=_e+"{"+s[tt]+"}":isProcessableValue(tt)&&(j+=processStyleName(_e)+":"+processStyleValue(_e,tt)+";");else if(Array.isArray(tt)&&typeof tt[0]=="string"&&(s==null||s[tt[0]]===void 0))for(var nt=0;nt<tt.length;nt++)isProcessableValue(tt[nt])&&(j+=processStyleName(_e)+":"+processStyleValue(_e,tt[nt])+";");else{var rt=handleInterpolation(a,s,tt);switch(_e){case"animation":case"animationName":{j+=processStyleName(_e)+":"+rt+";";break}default:j+=_e+"{"+rt+"}"}}}return j}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function a(s,o,j){if(s.length===1&&typeof s[0]=="object"&&s[0]!==null&&s[0].styles!==void 0)return s[0];var $=!0,_e="";cursor=void 0;var tt=s[0];tt==null||tt.raw===void 0?($=!1,_e+=handleInterpolation(j,o,tt)):_e+=tt[0];for(var nt=1;nt<s.length;nt++)_e+=handleInterpolation(j,o,s[nt]),$&&(_e+=tt[nt]);labelPattern.lastIndex=0;for(var rt="",it;(it=labelPattern.exec(_e))!==null;)rt+="-"+it[1];var st=murmur2(_e)+rt;return{name:st,styles:_e,next:cursor}},syncFallback=function a(s){return s()},useInsertionEffect=React$1["useInsertionEffect"]?React$1["useInsertionEffect"]:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function a(s){return reactExports.forwardRef(function(o,j){var $=reactExports.useContext(EmotionCacheContext);return s(o,$,j)})},ThemeContext$2=reactExports.createContext({});function css(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return serializeStyles(s)}var keyframes=function a(){var s=css.apply(void 0,arguments),o="animation-"+s.name;return{name:o,styles:"@keyframes "+o+"{"+s.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function a(s){return s!=="theme"},getDefaultShouldForwardProp=function a(s){return typeof s=="string"&&s.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function a(s,o,j){var $;if(o){var _e=o.shouldForwardProp;$=s.__emotion_forwardProp&&_e?function(tt){return s.__emotion_forwardProp(tt)&&_e(tt)}:_e}return typeof $!="function"&&j&&($=s.__emotion_forwardProp),$},Insertion=function a(s){var o=s.cache,j=s.serialized,$=s.isStringTag;return registerStyles(o,j,$),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(o,j,$)}),null},createStyled$1=function a(s,o){var j=s.__emotion_real===s,$=j&&s.__emotion_base||s,_e,tt;o!==void 0&&(_e=o.label,tt=o.target);var nt=composeShouldForwardProps(s,o,j),rt=nt||getDefaultShouldForwardProp($),it=!rt("as");return function(){var st=arguments,at=j&&s.__emotion_styles!==void 0?s.__emotion_styles.slice(0):[];if(_e!==void 0&&at.push("label:"+_e+";"),st[0]==null||st[0].raw===void 0)at.push.apply(at,st);else{at.push(st[0][0]);for(var ot=st.length,ct=1;ct<ot;ct++)at.push(st[ct],st[0][ct])}var ft=withEmotionCache(function(ht,mt,lt){var ut=it&&ht.as||$,dt="",gt=[],Et=ht;if(ht.theme==null){Et={};for(var St in ht)Et[St]=ht[St];Et.theme=reactExports.useContext(ThemeContext$2)}typeof ht.className=="string"?dt=getRegisteredStyles(mt.registered,gt,ht.className):ht.className!=null&&(dt=ht.className+" ");var Tt=serializeStyles(at.concat(gt),mt.registered,Et);dt+=mt.key+"-"+Tt.name,tt!==void 0&&(dt+=" "+tt);var Mt=it&&nt===void 0?getDefaultShouldForwardProp(ut):rt,Bt={};for(var Rt in ht)it&&Rt==="as"||Mt(Rt)&&(Bt[Rt]=ht[Rt]);return Bt.className=dt,Bt.ref=lt,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:mt,serialized:Tt,isStringTag:typeof ut=="string"}),reactExports.createElement(ut,Bt))});return ft.displayName=_e!==void 0?_e:"Styled("+(typeof $=="string"?$:$.displayName||$.name||"Component")+")",ft.defaultProps=s.defaultProps,ft.__emotion_real=ft,ft.__emotion_base=$,ft.__emotion_styles=at,ft.__emotion_forwardProp=nt,Object.defineProperty(ft,"toString",{value:function(){return"."+tt}}),ft.withComponent=function(ht,mt){return a(ht,_extends({},o,mt,{shouldForwardProp:composeShouldForwardProps(ft,mt,!0)})).apply(void 0,at)},ft}},tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$1.bind();tags.forEach(function(a){newStyled[a]=newStyled(a)});const emStyled=newStyled;/**
 * @mui/styled-engine v5.11.8
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function styled$2(a,s){return emStyled(a,s)}const internal_processStyles=(a,s)=>{Array.isArray(a.__emotion_styles)&&(a.__emotion_styles=s(a.__emotion_styles))};function merge(a,s){return s?deepmerge(a,s,{clone:!1}):a}const values$1={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:a=>`@media (min-width:${values$1[a]}px)`};function handleBreakpoints(a,s,o){const j=a.theme||{};if(Array.isArray(s)){const _e=j.breakpoints||defaultBreakpoints;return s.reduce((tt,nt,rt)=>(tt[_e.up(_e.keys[rt])]=o(s[rt]),tt),{})}if(typeof s=="object"){const _e=j.breakpoints||defaultBreakpoints;return Object.keys(s).reduce((tt,nt)=>{if(Object.keys(_e.values||values$1).indexOf(nt)!==-1){const rt=_e.up(nt);tt[rt]=o(s[nt],nt)}else{const rt=nt;tt[rt]=s[rt]}return tt},{})}return o(s)}function createEmptyBreakpointObject(a={}){var s;return((s=a.keys)==null?void 0:s.reduce((j,$)=>{const _e=a.up($);return j[_e]={},j},{}))||{}}function removeUnusedBreakpoints(a,s){return a.reduce((o,j)=>{const $=o[j];return(!$||Object.keys($).length===0)&&delete o[j],o},s)}function mergeBreakpointsInOrder(a,...s){const o=createEmptyBreakpointObject(a),j=[o,...s].reduce(($,_e)=>deepmerge($,_e),{});return removeUnusedBreakpoints(Object.keys(o),j)}function computeBreakpointsBase(a,s){if(typeof a!="object")return{};const o={},j=Object.keys(s);return Array.isArray(a)?j.forEach(($,_e)=>{_e<a.length&&(o[$]=!0)}):j.forEach($=>{a[$]!=null&&(o[$]=!0)}),o}function resolveBreakpointValues({values:a,breakpoints:s,base:o}){const j=o||computeBreakpointsBase(a,s),$=Object.keys(j);if($.length===0)return a;let _e;return $.reduce((tt,nt,rt)=>(Array.isArray(a)?(tt[nt]=a[rt]!=null?a[rt]:a[_e],_e=rt):typeof a=="object"?(tt[nt]=a[nt]!=null?a[nt]:a[_e],_e=nt):tt[nt]=a,tt),{})}function getPath(a,s,o=!0){if(!s||typeof s!="string")return null;if(a&&a.vars&&o){const j=`vars.${s}`.split(".").reduce(($,_e)=>$&&$[_e]?$[_e]:null,a);if(j!=null)return j}return s.split(".").reduce((j,$)=>j&&j[$]!=null?j[$]:null,a)}function getStyleValue(a,s,o,j=o){let $;return typeof a=="function"?$=a(o):Array.isArray(a)?$=a[o]||j:$=getPath(a,o)||j,s&&($=s($,j,a)),$}function style$2(a){const{prop:s,cssProperty:o=a.prop,themeKey:j,transform:$}=a,_e=tt=>{if(tt[s]==null)return null;const nt=tt[s],rt=tt.theme,it=getPath(rt,j)||{};return handleBreakpoints(tt,nt,at=>{let ot=getStyleValue(it,$,at);return at===ot&&typeof at=="string"&&(ot=getStyleValue(it,$,`${s}${at==="default"?"":capitalize(at)}`,at)),o===!1?ot:{[o]:ot}})};return _e.propTypes={},_e.filterProps=[s],_e}function compose(...a){const s=a.reduce((j,$)=>($.filterProps.forEach(_e=>{j[_e]=$}),j),{}),o=j=>Object.keys(j).reduce(($,_e)=>s[_e]?merge($,s[_e](j)):$,{});return o.propTypes={},o.filterProps=a.reduce((j,$)=>j.concat($.filterProps),[]),o}function memoize(a){const s={};return o=>(s[o]===void 0&&(s[o]=a(o)),s[o])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(a=>{if(a.length>2)if(aliases[a])a=aliases[a];else return[a];const[s,o]=a.split(""),j=properties[s],$=directions[o]||"";return Array.isArray($)?$.map(_e=>j+_e):[j+$]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(a,s,o,j){var $;const _e=($=getPath(a,s,!1))!=null?$:o;return typeof _e=="number"?tt=>typeof tt=="string"?tt:_e*tt:Array.isArray(_e)?tt=>typeof tt=="string"?tt:_e[tt]:typeof _e=="function"?_e:()=>{}}function createUnarySpacing(a){return createUnaryUnit(a,"spacing",8)}function getValue(a,s){if(typeof s=="string"||s==null)return s;const o=Math.abs(s),j=a(o);return s>=0?j:typeof j=="number"?-j:`-${j}`}function getStyleFromPropValue(a,s){return o=>a.reduce((j,$)=>(j[$]=getValue(s,o),j),{})}function resolveCssProperty(a,s,o,j){if(s.indexOf(o)===-1)return null;const $=getCssProperties(o),_e=getStyleFromPropValue($,j),tt=a[o];return handleBreakpoints(a,tt,_e)}function style$1(a,s){const o=createUnarySpacing(a.theme);return Object.keys(a).map(j=>resolveCssProperty(a,s,j,o)).reduce(merge,{})}function margin(a){return style$1(a,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(a){return style$1(a,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function borderTransform(a){return typeof a!="number"?a:`${a}px solid`}const border=style$2({prop:"border",themeKey:"borders",transform:borderTransform}),borderTop=style$2({prop:"borderTop",themeKey:"borders",transform:borderTransform}),borderRight=style$2({prop:"borderRight",themeKey:"borders",transform:borderTransform}),borderBottom=style$2({prop:"borderBottom",themeKey:"borders",transform:borderTransform}),borderLeft=style$2({prop:"borderLeft",themeKey:"borders",transform:borderTransform}),borderColor=style$2({prop:"borderColor",themeKey:"palette"}),borderTopColor=style$2({prop:"borderTopColor",themeKey:"palette"}),borderRightColor=style$2({prop:"borderRightColor",themeKey:"palette"}),borderBottomColor=style$2({prop:"borderBottomColor",themeKey:"palette"}),borderLeftColor=style$2({prop:"borderLeftColor",themeKey:"palette"}),borderRadius=a=>{if(a.borderRadius!==void 0&&a.borderRadius!==null){const s=createUnaryUnit(a.theme,"shape.borderRadius",4),o=j=>({borderRadius:getValue(s,j)});return handleBreakpoints(a,a.borderRadius,o)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius);const gap=a=>{if(a.gap!==void 0&&a.gap!==null){const s=createUnaryUnit(a.theme,"spacing",8),o=j=>({gap:getValue(s,j)});return handleBreakpoints(a,a.gap,o)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=a=>{if(a.columnGap!==void 0&&a.columnGap!==null){const s=createUnaryUnit(a.theme,"spacing",8),o=j=>({columnGap:getValue(s,j)});return handleBreakpoints(a,a.columnGap,o)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=a=>{if(a.rowGap!==void 0&&a.rowGap!==null){const s=createUnaryUnit(a.theme,"spacing",8),o=j=>({rowGap:getValue(s,j)});return handleBreakpoints(a,a.rowGap,o)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$2({prop:"gridColumn"}),gridRow=style$2({prop:"gridRow"}),gridAutoFlow=style$2({prop:"gridAutoFlow"}),gridAutoColumns=style$2({prop:"gridAutoColumns"}),gridAutoRows=style$2({prop:"gridAutoRows"}),gridTemplateColumns=style$2({prop:"gridTemplateColumns"}),gridTemplateRows=style$2({prop:"gridTemplateRows"}),gridTemplateAreas=style$2({prop:"gridTemplateAreas"}),gridArea=style$2({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(a,s){return s==="grey"?s:a}const color=style$2({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$2({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$2({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color,bgcolor,backgroundColor);function sizingTransform(a){return a<=1&&a!==0?`${a*100}%`:a}const width=style$2({prop:"width",transform:sizingTransform}),maxWidth=a=>{if(a.maxWidth!==void 0&&a.maxWidth!==null){const s=o=>{var j,$,_e;return{maxWidth:((j=a.theme)==null||($=j.breakpoints)==null||(_e=$.values)==null?void 0:_e[o])||values$1[o]||sizingTransform(o)}};return handleBreakpoints(a,a.maxWidth,s)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$2({prop:"minWidth",transform:sizingTransform}),height=style$2({prop:"height",transform:sizingTransform}),maxHeight=style$2({prop:"maxHeight",transform:sizingTransform}),minHeight=style$2({prop:"minHeight",transform:sizingTransform});style$2({prop:"size",cssProperty:"width",transform:sizingTransform});style$2({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$2({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:a=>({"@media print":{display:a}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...a){const s=a.reduce((j,$)=>j.concat(Object.keys($)),[]),o=new Set(s);return a.every(j=>o.size===Object.keys(j).length)}function callIfFn(a,s){return typeof a=="function"?a(s):a}function unstable_createStyleFunctionSx(){function a(o,j,$,_e){const tt={[o]:j,theme:$},nt=_e[o];if(!nt)return{[o]:j};const{cssProperty:rt=o,themeKey:it,transform:st,style:at}=nt;if(j==null)return null;const ot=getPath($,it)||{};return at?at(tt):handleBreakpoints(tt,j,ft=>{let ht=getStyleValue(ot,st,ft);return ft===ht&&typeof ft=="string"&&(ht=getStyleValue(ot,st,`${o}${ft==="default"?"":capitalize(ft)}`,ft)),rt===!1?ht:{[rt]:ht}})}function s(o){var j;const{sx:$,theme:_e={}}=o||{};if(!$)return null;const tt=(j=_e.unstable_sxConfig)!=null?j:defaultSxConfig$1;function nt(rt){let it=rt;if(typeof rt=="function")it=rt(_e);else if(typeof rt!="object")return rt;if(!it)return null;const st=createEmptyBreakpointObject(_e.breakpoints),at=Object.keys(st);let ot=st;return Object.keys(it).forEach(ct=>{const ft=callIfFn(it[ct],_e);if(ft!=null)if(typeof ft=="object")if(tt[ct])ot=merge(ot,a(ct,ft,_e,tt));else{const ht=handleBreakpoints({theme:_e},ft,mt=>({[ct]:mt}));objectsHaveSameKeys(ht,ft)?ot[ct]=s({sx:ft,theme:_e}):ot=merge(ot,ht)}else ot=merge(ot,a(ct,ft,_e,tt))}),removeUnusedBreakpoints(at,ot)}return Array.isArray($)?$.map(nt):nt($)}return s}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const styleFunctionSx$1=styleFunctionSx,_excluded$n=["sx"],splitProps=a=>{var s,o;const j={systemProps:{},otherProps:{}},$=(s=a==null||(o=a.theme)==null?void 0:o.unstable_sxConfig)!=null?s:defaultSxConfig$1;return Object.keys(a).forEach(_e=>{$[_e]?j.systemProps[_e]=a[_e]:j.otherProps[_e]=a[_e]}),j};function extendSxProp(a){const{sx:s}=a,o=_objectWithoutPropertiesLoose(a,_excluded$n),{systemProps:j,otherProps:$}=splitProps(o);let _e;return Array.isArray(s)?_e=[j,...s]:typeof s=="function"?_e=(...tt)=>{const nt=s(...tt);return isPlainObject(nt)?_extends({},j,nt):j}:_e=_extends({},j,s),_extends({},$,{sx:_e})}function r(a){var s,o,j="";if(typeof a=="string"||typeof a=="number")j+=a;else if(typeof a=="object")if(Array.isArray(a))for(s=0;s<a.length;s++)a[s]&&(o=r(a[s]))&&(j&&(j+=" "),j+=o);else for(s in a)a[s]&&(j&&(j+=" "),j+=s);return j}function clsx(){for(var a,s,o=0,j="";o<arguments.length;)(a=arguments[o++])&&(s=r(a))&&(j&&(j+=" "),j+=s);return j}const _excluded$m=["values","unit","step"],sortBreakpointsValues=a=>{const s=Object.keys(a).map(o=>({key:o,val:a[o]}))||[];return s.sort((o,j)=>o.val-j.val),s.reduce((o,j)=>_extends({},o,{[j.key]:j.val}),{})};function createBreakpoints(a){const{values:s={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:o="px",step:j=5}=a,$=_objectWithoutPropertiesLoose(a,_excluded$m),_e=sortBreakpointsValues(s),tt=Object.keys(_e);function nt(ot){return`@media (min-width:${typeof s[ot]=="number"?s[ot]:ot}${o})`}function rt(ot){return`@media (max-width:${(typeof s[ot]=="number"?s[ot]:ot)-j/100}${o})`}function it(ot,ct){const ft=tt.indexOf(ct);return`@media (min-width:${typeof s[ot]=="number"?s[ot]:ot}${o}) and (max-width:${(ft!==-1&&typeof s[tt[ft]]=="number"?s[tt[ft]]:ct)-j/100}${o})`}function st(ot){return tt.indexOf(ot)+1<tt.length?it(ot,tt[tt.indexOf(ot)+1]):nt(ot)}function at(ot){const ct=tt.indexOf(ot);return ct===0?nt(tt[1]):ct===tt.length-1?rt(tt[ct]):it(ot,tt[tt.indexOf(ot)+1]).replace("@media","@media not all and")}return _extends({keys:tt,values:_e,up:nt,down:rt,between:it,only:st,not:at,unit:o},$)}const shape={borderRadius:4},shape$1=shape;function createSpacing(a=8){if(a.mui)return a;const s=createUnarySpacing({spacing:a}),o=(...j)=>(j.length===0?[1]:j).map(_e=>{const tt=s(_e);return typeof tt=="number"?`${tt}px`:tt}).join(" ");return o.mui=!0,o}const _excluded$l=["breakpoints","palette","spacing","shape"];function createTheme$1(a={},...s){const{breakpoints:o={},palette:j={},spacing:$,shape:_e={}}=a,tt=_objectWithoutPropertiesLoose(a,_excluded$l),nt=createBreakpoints(o),rt=createSpacing($);let it=deepmerge({breakpoints:nt,direction:"ltr",components:{},palette:_extends({mode:"light"},j),spacing:rt,shape:_extends({},shape$1,_e)},tt);return it=s.reduce((st,at)=>deepmerge(st,at),it),it.unstable_sxConfig=_extends({},defaultSxConfig$1,tt==null?void 0:tt.unstable_sxConfig),it.unstable_sx=function(at){return styleFunctionSx$1({sx:at,theme:this})},it}const ThemeContext=reactExports.createContext(null),ThemeContext$1=ThemeContext;function useTheme$3(){return reactExports.useContext(ThemeContext$1)}function isObjectEmpty(a){return Object.keys(a).length===0}function useTheme$2(a=null){const s=useTheme$3();return!s||isObjectEmpty(s)?a:s}const systemDefaultTheme$1=createTheme$1();function useTheme$1(a=systemDefaultTheme$1){return useTheme$2(a)}const _excluded$k=["className","component"];function createBox(a={}){const{defaultTheme:s,defaultClassName:o="MuiBox-root",generateClassName:j}=a,$=styled$2("div",{shouldForwardProp:tt=>tt!=="theme"&&tt!=="sx"&&tt!=="as"})(styleFunctionSx$1);return reactExports.forwardRef(function(nt,rt){const it=useTheme$1(s),st=extendSxProp(nt),{className:at,component:ot="div"}=st,ct=_objectWithoutPropertiesLoose(st,_excluded$k);return jsx($,_extends({as:ot,ref:rt,className:clsx(at,j?j(o):o),theme:it},ct))})}const _excluded$j=["variant"];function isEmpty$1(a){return a.length===0}function propsToClassKey(a){const{variant:s}=a,o=_objectWithoutPropertiesLoose(a,_excluded$j);let j=s||"";return Object.keys(o).sort().forEach($=>{$==="color"?j+=isEmpty$1(j)?a[$]:capitalize(a[$]):j+=`${isEmpty$1(j)?$:capitalize($)}${capitalize(a[$].toString())}`}),j}const _excluded$i=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],_excluded2=["theme"],_excluded3=["theme"];function isEmpty(a){return Object.keys(a).length===0}function isStringTag(a){return typeof a=="string"&&a.charCodeAt(0)>96}const getStyleOverrides=(a,s)=>s.components&&s.components[a]&&s.components[a].styleOverrides?s.components[a].styleOverrides:null,getVariantStyles=(a,s)=>{let o=[];s&&s.components&&s.components[a]&&s.components[a].variants&&(o=s.components[a].variants);const j={};return o.forEach($=>{const _e=propsToClassKey($.props);j[_e]=$.style}),j},variantsResolver=(a,s,o,j)=>{var $,_e;const{ownerState:tt={}}=a,nt=[],rt=o==null||($=o.components)==null||(_e=$[j])==null?void 0:_e.variants;return rt&&rt.forEach(it=>{let st=!0;Object.keys(it.props).forEach(at=>{tt[at]!==it.props[at]&&a[at]!==it.props[at]&&(st=!1)}),st&&nt.push(s[propsToClassKey(it.props)])}),nt};function shouldForwardProp(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}const systemDefaultTheme=createTheme$1();function createStyled(a={}){const{defaultTheme:s=systemDefaultTheme,rootShouldForwardProp:o=shouldForwardProp,slotShouldForwardProp:j=shouldForwardProp}=a,$=_e=>{const tt=isEmpty(_e.theme)?s:_e.theme;return styleFunctionSx$1(_extends({},_e,{theme:tt}))};return $.__mui_systemSx=!0,(_e,tt={})=>{internal_processStyles(_e,dt=>dt.filter(gt=>!(gt!=null&&gt.__mui_systemSx)));const{name:nt,slot:rt,skipVariantsResolver:it,skipSx:st,overridesResolver:at}=tt,ot=_objectWithoutPropertiesLoose(tt,_excluded$i),ct=it!==void 0?it:rt&&rt!=="Root"||!1,ft=st||!1;let ht,mt=shouldForwardProp;rt==="Root"?mt=o:rt?mt=j:isStringTag(_e)&&(mt=void 0);const lt=styled$2(_e,_extends({shouldForwardProp:mt,label:ht},ot)),ut=(dt,...gt)=>{const Et=gt?gt.map(Bt=>typeof Bt=="function"&&Bt.__emotion_real!==Bt?Rt=>{let{theme:Ut}=Rt,Ht=_objectWithoutPropertiesLoose(Rt,_excluded2);return Bt(_extends({theme:isEmpty(Ut)?s:Ut},Ht))}:Bt):[];let St=dt;nt&&at&&Et.push(Bt=>{const Rt=isEmpty(Bt.theme)?s:Bt.theme,Ut=getStyleOverrides(nt,Rt);if(Ut){const Ht={};return Object.entries(Ut).forEach(([Wt,Jt])=>{Ht[Wt]=typeof Jt=="function"?Jt(_extends({},Bt,{theme:Rt})):Jt}),at(Bt,Ht)}return null}),nt&&!ct&&Et.push(Bt=>{const Rt=isEmpty(Bt.theme)?s:Bt.theme;return variantsResolver(Bt,getVariantStyles(nt,Rt),Rt,nt)}),ft||Et.push($);const Tt=Et.length-gt.length;if(Array.isArray(dt)&&Tt>0){const Bt=new Array(Tt).fill("");St=[...dt,...Bt],St.raw=[...dt.raw,...Bt]}else typeof dt=="function"&&dt.__emotion_real!==dt&&(St=Bt=>{let{theme:Rt}=Bt,Ut=_objectWithoutPropertiesLoose(Bt,_excluded3);return dt(_extends({theme:isEmpty(Rt)?s:Rt},Ut))});return lt(St,...Et)};return lt.withConfig&&(ut.withConfig=lt.withConfig),ut}}function getThemeProps(a){const{theme:s,name:o,props:j}=a;return!s||!s.components||!s.components[o]||!s.components[o].defaultProps?j:resolveProps(s.components[o].defaultProps,j)}function useThemeProps$1({props:a,name:s,defaultTheme:o}){const j=useTheme$1(o);return getThemeProps({theme:j,name:s,props:a})}function clamp$1(a,s=0,o=1){return Math.min(Math.max(s,a),o)}function hexToRgb(a){a=a.slice(1);const s=new RegExp(`.{1,${a.length>=6?2:1}}`,"g");let o=a.match(s);return o&&o[0].length===1&&(o=o.map(j=>j+j)),o?`rgb${o.length===4?"a":""}(${o.map((j,$)=>$<3?parseInt(j,16):Math.round(parseInt(j,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(a){if(a.type)return a;if(a.charAt(0)==="#")return decomposeColor(hexToRgb(a));const s=a.indexOf("("),o=a.substring(0,s);if(["rgb","rgba","hsl","hsla","color"].indexOf(o)===-1)throw new Error(formatMuiErrorMessage(9,a));let j=a.substring(s+1,a.length-1),$;if(o==="color"){if(j=j.split(" "),$=j.shift(),j.length===4&&j[3].charAt(0)==="/"&&(j[3]=j[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf($)===-1)throw new Error(formatMuiErrorMessage(10,$))}else j=j.split(",");return j=j.map(_e=>parseFloat(_e)),{type:o,values:j,colorSpace:$}}function recomposeColor(a){const{type:s,colorSpace:o}=a;let{values:j}=a;return s.indexOf("rgb")!==-1?j=j.map(($,_e)=>_e<3?parseInt($,10):$):s.indexOf("hsl")!==-1&&(j[1]=`${j[1]}%`,j[2]=`${j[2]}%`),s.indexOf("color")!==-1?j=`${o} ${j.join(" ")}`:j=`${j.join(", ")}`,`${s}(${j})`}function hslToRgb(a){a=decomposeColor(a);const{values:s}=a,o=s[0],j=s[1]/100,$=s[2]/100,_e=j*Math.min($,1-$),tt=(it,st=(it+o/30)%12)=>$-_e*Math.max(Math.min(st-3,9-st,1),-1);let nt="rgb";const rt=[Math.round(tt(0)*255),Math.round(tt(8)*255),Math.round(tt(4)*255)];return a.type==="hsla"&&(nt+="a",rt.push(s[3])),recomposeColor({type:nt,values:rt})}function getLuminance(a){a=decomposeColor(a);let s=a.type==="hsl"||a.type==="hsla"?decomposeColor(hslToRgb(a)).values:a.values;return s=s.map(o=>(a.type!=="color"&&(o/=255),o<=.03928?o/12.92:((o+.055)/1.055)**2.4)),Number((.2126*s[0]+.7152*s[1]+.0722*s[2]).toFixed(3))}function getContrastRatio(a,s){const o=getLuminance(a),j=getLuminance(s);return(Math.max(o,j)+.05)/(Math.min(o,j)+.05)}function alpha(a,s){return a=decomposeColor(a),s=clamp$1(s),(a.type==="rgb"||a.type==="hsl")&&(a.type+="a"),a.type==="color"?a.values[3]=`/${s}`:a.values[3]=s,recomposeColor(a)}function darken(a,s){if(a=decomposeColor(a),s=clamp$1(s),a.type.indexOf("hsl")!==-1)a.values[2]*=1-s;else if(a.type.indexOf("rgb")!==-1||a.type.indexOf("color")!==-1)for(let o=0;o<3;o+=1)a.values[o]*=1-s;return recomposeColor(a)}function lighten(a,s){if(a=decomposeColor(a),s=clamp$1(s),a.type.indexOf("hsl")!==-1)a.values[2]+=(100-a.values[2])*s;else if(a.type.indexOf("rgb")!==-1)for(let o=0;o<3;o+=1)a.values[o]+=(255-a.values[o])*s;else if(a.type.indexOf("color")!==-1)for(let o=0;o<3;o+=1)a.values[o]+=(1-a.values[o])*s;return recomposeColor(a)}function createMixins(a,s){return _extends({toolbar:{minHeight:56,[a.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[a.up("sm")]:{minHeight:64}}},s)}const _excluded$h=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$1.white,default:common$1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(a,s,o,j){const $=j.light||j,_e=j.dark||j*1.5;a[s]||(a.hasOwnProperty(o)?a[s]=a[o]:s==="light"?a.light=lighten(a.main,$):s==="dark"&&(a.dark=darken(a.main,_e)))}function getDefaultPrimary(a="light"){return a==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(a="light"){return a==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(a="light"){return a==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(a="light"){return a==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(a="light"){return a==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(a="light"){return a==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(a){const{mode:s="light",contrastThreshold:o=3,tonalOffset:j=.2}=a,$=_objectWithoutPropertiesLoose(a,_excluded$h),_e=a.primary||getDefaultPrimary(s),tt=a.secondary||getDefaultSecondary(s),nt=a.error||getDefaultError(s),rt=a.info||getDefaultInfo(s),it=a.success||getDefaultSuccess(s),st=a.warning||getDefaultWarning(s);function at(ht){return getContrastRatio(ht,dark.text.primary)>=o?dark.text.primary:light.text.primary}const ot=({color:ht,name:mt,mainShade:lt=500,lightShade:ut=300,darkShade:dt=700})=>{if(ht=_extends({},ht),!ht.main&&ht[lt]&&(ht.main=ht[lt]),!ht.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,mt?` (${mt})`:"",lt));if(typeof ht.main!="string")throw new Error(formatMuiErrorMessage(12,mt?` (${mt})`:"",JSON.stringify(ht.main)));return addLightOrDark(ht,"light",ut,j),addLightOrDark(ht,"dark",dt,j),ht.contrastText||(ht.contrastText=at(ht.main)),ht},ct={dark,light};return deepmerge(_extends({common:_extends({},common$1),mode:s,primary:ot({color:_e,name:"primary"}),secondary:ot({color:tt,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:ot({color:nt,name:"error"}),warning:ot({color:st,name:"warning"}),info:ot({color:rt,name:"info"}),success:ot({color:it,name:"success"}),grey:grey$1,contrastThreshold:o,getContrastText:at,augmentColor:ot,tonalOffset:j},ct[s]),$)}const _excluded$g=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round(a){return Math.round(a*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(a,s){const o=typeof s=="function"?s(a):s,{fontFamily:j=defaultFontFamily,fontSize:$=14,fontWeightLight:_e=300,fontWeightRegular:tt=400,fontWeightMedium:nt=500,fontWeightBold:rt=700,htmlFontSize:it=16,allVariants:st,pxToRem:at}=o,ot=_objectWithoutPropertiesLoose(o,_excluded$g),ct=$/14,ft=at||(lt=>`${lt/it*ct}rem`),ht=(lt,ut,dt,gt,Et)=>_extends({fontFamily:j,fontWeight:lt,fontSize:ft(ut),lineHeight:dt},j===defaultFontFamily?{letterSpacing:`${round(gt/ut)}em`}:{},Et,st),mt={h1:ht(_e,96,1.167,-1.5),h2:ht(_e,60,1.2,-.5),h3:ht(tt,48,1.167,0),h4:ht(tt,34,1.235,.25),h5:ht(tt,24,1.334,0),h6:ht(nt,20,1.6,.15),subtitle1:ht(tt,16,1.75,.15),subtitle2:ht(nt,14,1.57,.1),body1:ht(tt,16,1.5,.15),body2:ht(tt,14,1.43,.15),button:ht(nt,14,1.75,.4,caseAllCaps),caption:ht(tt,12,1.66,.4),overline:ht(tt,12,2.66,1,caseAllCaps)};return deepmerge(_extends({htmlFontSize:it,pxToRem:ft,fontFamily:j,fontSize:$,fontWeightLight:_e,fontWeightRegular:tt,fontWeightMedium:nt,fontWeightBold:rt},mt),ot,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...a){return[`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${a[4]}px ${a[5]}px ${a[6]}px ${a[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${a[8]}px ${a[9]}px ${a[10]}px ${a[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],shadows$1=shadows,_excluded$f=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(a){return`${Math.round(a)}ms`}function getAutoHeightDuration(a){if(!a)return 0;const s=a/36;return Math.round((4+15*s**.25+s/5)*10)}function createTransitions(a){const s=_extends({},easing,a.easing),o=_extends({},duration,a.duration);return _extends({getAutoHeightDuration,create:($=["all"],_e={})=>{const{duration:tt=o.standard,easing:nt=s.easeInOut,delay:rt=0}=_e;return _objectWithoutPropertiesLoose(_e,_excluded$f),(Array.isArray($)?$:[$]).map(it=>`${it} ${typeof tt=="string"?tt:formatMs(tt)} ${nt} ${typeof rt=="string"?rt:formatMs(rt)}`).join(",")}},a,{easing:s,duration:o})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$e=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(a={},...s){const{mixins:o={},palette:j={},transitions:$={},typography:_e={}}=a,tt=_objectWithoutPropertiesLoose(a,_excluded$e);if(a.vars)throw new Error(formatMuiErrorMessage(18));const nt=createPalette(j),rt=createTheme$1(a);let it=deepmerge(rt,{mixins:createMixins(rt.breakpoints,o),palette:nt,shadows:shadows$1.slice(),typography:createTypography(nt,_e),transitions:createTransitions($),zIndex:_extends({},zIndex$1)});return it=deepmerge(it,tt),it=s.reduce((st,at)=>deepmerge(st,at),it),it.unstable_sxConfig=_extends({},defaultSxConfig$1,tt==null?void 0:tt.unstable_sxConfig),it.unstable_sx=function(at){return styleFunctionSx$1({sx:at,theme:this})},it}const defaultTheme$1=createTheme(),defaultTheme$2=defaultTheme$1;function useTheme(){return useTheme$1(defaultTheme$2)}function useThemeProps({props:a,name:s}){return useThemeProps$1({props:a,name:s,defaultTheme:defaultTheme$2})}const rootShouldForwardProp=a=>shouldForwardProp(a)&&a!=="classes",slotShouldForwardProp=shouldForwardProp,styled=createStyled({defaultTheme:defaultTheme$2,rootShouldForwardProp}),styled$1=styled;function isHostComponent(a){return typeof a=="string"}function appendOwnerState(a,s,o){return a===void 0||isHostComponent(a)?s:_extends({},s,{ownerState:_extends({},s.ownerState,o)})}function extractEventHandlers(a,s=[]){if(a===void 0)return{};const o={};return Object.keys(a).filter(j=>j.match(/^on[A-Z]/)&&typeof a[j]=="function"&&!s.includes(j)).forEach(j=>{o[j]=a[j]}),o}function resolveComponentProps(a,s){return typeof a=="function"?a(s):a}function omitEventHandlers(a){if(a===void 0)return{};const s={};return Object.keys(a).filter(o=>!(o.match(/^on[A-Z]/)&&typeof a[o]=="function")).forEach(o=>{s[o]=a[o]}),s}function mergeSlotProps(a){const{getSlotProps:s,additionalProps:o,externalSlotProps:j,externalForwardedProps:$,className:_e}=a;if(!s){const ct=clsx($==null?void 0:$.className,j==null?void 0:j.className,_e,o==null?void 0:o.className),ft=_extends({},o==null?void 0:o.style,$==null?void 0:$.style,j==null?void 0:j.style),ht=_extends({},o,$,j);return ct.length>0&&(ht.className=ct),Object.keys(ft).length>0&&(ht.style=ft),{props:ht,internalRef:void 0}}const tt=extractEventHandlers(_extends({},$,j)),nt=omitEventHandlers(j),rt=omitEventHandlers($),it=s(tt),st=clsx(it==null?void 0:it.className,o==null?void 0:o.className,_e,$==null?void 0:$.className,j==null?void 0:j.className),at=_extends({},it==null?void 0:it.style,o==null?void 0:o.style,$==null?void 0:$.style,j==null?void 0:j.style),ot=_extends({},it,o,rt,nt);return st.length>0&&(ot.className=st),Object.keys(at).length>0&&(ot.style=at),{props:ot,internalRef:it.ref}}const _excluded$d=["elementType","externalSlotProps","ownerState"];function useSlotProps(a){var s;const{elementType:o,externalSlotProps:j,ownerState:$}=a,_e=_objectWithoutPropertiesLoose(a,_excluded$d),tt=resolveComponentProps(j,$),{props:nt,internalRef:rt}=mergeSlotProps(_extends({},_e,{externalSlotProps:tt})),it=useForkRef(rt,tt==null?void 0:tt.ref,(s=a.additionalProps)==null?void 0:s.ref);return appendOwnerState(o,_extends({},nt,{ref:it}),$)}const INTENTIONAL_DRAG_COUNT_THRESHOLD=2;function asc(a,s){return a-s}function clamp(a,s,o){return a==null?s:Math.min(Math.max(s,a),o)}function findClosest(a,s){var o;const{index:j}=(o=a.reduce(($,_e,tt)=>{const nt=Math.abs(s-_e);return $===null||nt<$.distance||nt===$.distance?{distance:nt,index:tt}:$},null))!=null?o:{};return j}function trackFinger(a,s){if(s.current!==void 0&&a.changedTouches){const o=a;for(let j=0;j<o.changedTouches.length;j+=1){const $=o.changedTouches[j];if($.identifier===s.current)return{x:$.clientX,y:$.clientY}}return!1}return{x:a.clientX,y:a.clientY}}function valueToPercent$1(a,s,o){return(a-s)*100/(o-s)}function percentToValue(a,s,o){return(o-s)*a+s}function getDecimalPrecision(a){if(Math.abs(a)<1){const o=a.toExponential().split("e-"),j=o[0].split(".")[1];return(j?j.length:0)+parseInt(o[1],10)}const s=a.toString().split(".")[1];return s?s.length:0}function roundValueToStep(a,s,o){const j=Math.round((a-o)/s)*s+o;return Number(j.toFixed(getDecimalPrecision(s)))}function setValueIndex({values:a,newValue:s,index:o}){const j=a.slice();return j[o]=s,j.sort(asc)}function focusThumb({sliderRef:a,activeIndex:s,setActive:o}){var j,$;const _e=ownerDocument(a.current);if(!((j=a.current)!=null&&j.contains(_e.activeElement))||Number(_e==null||($=_e.activeElement)==null?void 0:$.getAttribute("data-index"))!==s){var tt;(tt=a.current)==null||tt.querySelector(`[type="range"][data-index="${s}"]`).focus()}o&&o(s)}const axisProps={horizontal:{offset:a=>({left:`${a}%`}),leap:a=>({width:`${a}%`})},"horizontal-reverse":{offset:a=>({right:`${a}%`}),leap:a=>({width:`${a}%`})},vertical:{offset:a=>({bottom:`${a}%`}),leap:a=>({height:`${a}%`})}},Identity$1=a=>a;let cachedSupportsTouchActionNone;function doesSupportTouchActionNone(){return cachedSupportsTouchActionNone===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?cachedSupportsTouchActionNone=CSS.supports("touch-action","none"):cachedSupportsTouchActionNone=!0),cachedSupportsTouchActionNone}function useSlider(a){const{"aria-labelledby":s,defaultValue:o,disabled:j=!1,disableSwap:$=!1,isRtl:_e=!1,marks:tt=!1,max:nt=100,min:rt=0,name:it,onChange:st,onChangeCommitted:at,orientation:ot="horizontal",ref:ct,scale:ft=Identity$1,step:ht=1,tabIndex:mt,value:lt}=a,ut=reactExports.useRef(),[dt,gt]=reactExports.useState(-1),[Et,St]=reactExports.useState(-1),[Tt,Mt]=reactExports.useState(!1),Bt=reactExports.useRef(0),[Rt,Ut]=useControlled({controlled:lt,default:o??rt,name:"Slider"}),Ht=st&&(($t,An,En)=>{const In=$t.nativeEvent||$t,Hn=new In.constructor(In.type,In);Object.defineProperty(Hn,"target",{writable:!0,value:{value:An,name:it}}),st(Hn,An,En)}),Wt=Array.isArray(Rt);let Jt=Wt?Rt.slice().sort(asc):[Rt];Jt=Jt.map($t=>clamp($t,rt,nt));const sn=tt===!0&&ht!==null?[...Array(Math.floor((nt-rt)/ht)+1)].map(($t,An)=>({value:rt+ht*An})):tt||[],jt=sn.map($t=>$t.value),{isFocusVisibleRef:Vt,onBlur:Lt,onFocus:Qt,ref:nn}=useIsFocusVisible(),[mn,Zt]=reactExports.useState(-1),cn=reactExports.useRef(),Ot=useForkRef(nn,cn),rn=useForkRef(ct,Ot),fn=$t=>An=>{var En;const In=Number(An.currentTarget.getAttribute("data-index"));Qt(An),Vt.current===!0&&Zt(In),St(In),$t==null||(En=$t.onFocus)==null||En.call($t,An)},hn=$t=>An=>{var En;Lt(An),Vt.current===!1&&Zt(-1),St(-1),$t==null||(En=$t.onBlur)==null||En.call($t,An)};useEnhancedEffect$1(()=>{if(j&&cn.current.contains(document.activeElement)){var $t;($t=document.activeElement)==null||$t.blur()}},[j]),j&&dt!==-1&&gt(-1),j&&mn!==-1&&Zt(-1);const Tn=$t=>An=>{var En;(En=$t.onChange)==null||En.call($t,An);const In=Number(An.currentTarget.getAttribute("data-index")),Hn=Jt[In],yn=jt.indexOf(Hn);let On=An.target.valueAsNumber;if(sn&&ht==null&&(On=On<Hn?jt[yn-1]:jt[yn+1]),On=clamp(On,rt,nt),sn&&ht==null){const Mn=jt.indexOf(Jt[In]);On=On<Jt[In]?jt[Mn-1]:jt[Mn+1]}if(Wt){$&&(On=clamp(On,Jt[In-1]||-1/0,Jt[In+1]||1/0));const Mn=On;On=setValueIndex({values:Jt,newValue:On,index:In});let tr=In;$||(tr=On.indexOf(Mn)),focusThumb({sliderRef:cn,activeIndex:tr})}Ut(On),Zt(In),Ht&&Ht(An,On,In),at&&at(An,On)},Nn=reactExports.useRef();let Pn=ot;_e&&ot==="horizontal"&&(Pn+="-reverse");const Dn=({finger:$t,move:An=!1})=>{const{current:En}=cn,{width:In,height:Hn,bottom:yn,left:On}=En.getBoundingClientRect();let Mn;Pn.indexOf("vertical")===0?Mn=(yn-$t.y)/Hn:Mn=($t.x-On)/In,Pn.indexOf("-reverse")!==-1&&(Mn=1-Mn);let tr;if(tr=percentToValue(Mn,rt,nt),ht)tr=roundValueToStep(tr,ht,rt);else{const Cr=findClosest(jt,tr);tr=jt[Cr]}tr=clamp(tr,rt,nt);let gr=0;if(Wt){An?gr=Nn.current:gr=findClosest(Jt,tr),$&&(tr=clamp(tr,Jt[gr-1]||-1/0,Jt[gr+1]||1/0));const Cr=tr;tr=setValueIndex({values:Jt,newValue:tr,index:gr}),$&&An||(gr=tr.indexOf(Cr),Nn.current=gr)}return{newValue:tr,activeIndex:gr}},ln=useEventCallback($t=>{const An=trackFinger($t,ut);if(!An)return;if(Bt.current+=1,$t.type==="mousemove"&&$t.buttons===0){Cn($t);return}const{newValue:En,activeIndex:In}=Dn({finger:An,move:!0});focusThumb({sliderRef:cn,activeIndex:In,setActive:gt}),Ut(En),!Tt&&Bt.current>INTENTIONAL_DRAG_COUNT_THRESHOLD&&Mt(!0),Ht&&En!==Rt&&Ht($t,En,In)}),Cn=useEventCallback($t=>{const An=trackFinger($t,ut);if(Mt(!1),!An)return;const{newValue:En}=Dn({finger:An,move:!0});gt(-1),$t.type==="touchend"&&St(-1),at&&at($t,En),ut.current=void 0,kn()}),bn=useEventCallback($t=>{if(j)return;doesSupportTouchActionNone()||$t.preventDefault();const An=$t.changedTouches[0];An!=null&&(ut.current=An.identifier);const En=trackFinger($t,ut);if(En!==!1){const{newValue:Hn,activeIndex:yn}=Dn({finger:En});focusThumb({sliderRef:cn,activeIndex:yn,setActive:gt}),Ut(Hn),Ht&&Ht($t,Hn,yn)}Bt.current=0;const In=ownerDocument(cn.current);In.addEventListener("touchmove",ln),In.addEventListener("touchend",Cn)}),kn=reactExports.useCallback(()=>{const $t=ownerDocument(cn.current);$t.removeEventListener("mousemove",ln),$t.removeEventListener("mouseup",Cn),$t.removeEventListener("touchmove",ln),$t.removeEventListener("touchend",Cn)},[Cn,ln]);reactExports.useEffect(()=>{const{current:$t}=cn;return $t.addEventListener("touchstart",bn,{passive:doesSupportTouchActionNone()}),()=>{$t.removeEventListener("touchstart",bn,{passive:doesSupportTouchActionNone()}),kn()}},[kn,bn]),reactExports.useEffect(()=>{j&&kn()},[j,kn]);const Sn=$t=>An=>{var En;if((En=$t.onMouseDown)==null||En.call($t,An),j||An.defaultPrevented||An.button!==0)return;An.preventDefault();const In=trackFinger(An,ut);if(In!==!1){const{newValue:yn,activeIndex:On}=Dn({finger:In});focusThumb({sliderRef:cn,activeIndex:On,setActive:gt}),Ut(yn),Ht&&Ht(An,yn,On)}Bt.current=0;const Hn=ownerDocument(cn.current);Hn.addEventListener("mousemove",ln),Hn.addEventListener("mouseup",Cn)},xn=valueToPercent$1(Wt?Jt[0]:rt,rt,nt),Qn=valueToPercent$1(Jt[Jt.length-1],rt,nt)-xn,nr=($t={})=>{const An={onMouseDown:Sn($t||{})},En=_extends({},$t,An);return _extends({ref:rn},En)},or=$t=>An=>{var En;(En=$t.onMouseOver)==null||En.call($t,An);const In=Number(An.currentTarget.getAttribute("data-index"));St(In)},mr=$t=>An=>{var En;(En=$t.onMouseLeave)==null||En.call($t,An),St(-1)};return{active:dt,axis:Pn,axisProps,dragging:Tt,focusedThumbIndex:mn,getHiddenInputProps:($t={})=>{var An;const En={onChange:Tn($t||{}),onFocus:fn($t||{}),onBlur:hn($t||{})},In=_extends({},$t,En);return _extends({tabIndex:mt,"aria-labelledby":s,"aria-orientation":ot,"aria-valuemax":ft(nt),"aria-valuemin":ft(rt),name:it,type:"range",min:a.min,max:a.max,step:(An=a.step)!=null?An:void 0,disabled:j},In,{style:_extends({},visuallyHidden$1,{direction:_e?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:nr,getThumbProps:($t={})=>{const An={onMouseOver:or($t||{}),onMouseLeave:mr($t||{})};return _extends({},$t,An)},marks:sn,open:Et,range:Wt,trackLeap:Qn,trackOffset:xn,values:Jt}}function getSvgIconUtilityClass(a){return generateUtilityClass("MuiSvgIcon",a)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$c=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses$9=a=>{const{color:s,fontSize:o,classes:j}=a,$={root:["root",s!=="inherit"&&`color${capitalize(s)}`,`fontSize${capitalize(o)}`]};return composeClasses($,getSvgIconUtilityClass,j)},SvgIconRoot=styled$1("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.root,o.color!=="inherit"&&s[`color${capitalize(o.color)}`],s[`fontSize${capitalize(o.fontSize)}`]]}})(({theme:a,ownerState:s})=>{var o,j,$,_e,tt,nt,rt,it,st,at,ot,ct,ft,ht,mt,lt,ut;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:(o=a.transitions)==null||(j=o.create)==null?void 0:j.call(o,"fill",{duration:($=a.transitions)==null||(_e=$.duration)==null?void 0:_e.shorter}),fontSize:{inherit:"inherit",small:((tt=a.typography)==null||(nt=tt.pxToRem)==null?void 0:nt.call(tt,20))||"1.25rem",medium:((rt=a.typography)==null||(it=rt.pxToRem)==null?void 0:it.call(rt,24))||"1.5rem",large:((st=a.typography)==null||(at=st.pxToRem)==null?void 0:at.call(st,35))||"2.1875rem"}[s.fontSize],color:(ot=(ct=(a.vars||a).palette)==null||(ft=ct[s.color])==null?void 0:ft.main)!=null?ot:{action:(ht=(a.vars||a).palette)==null||(mt=ht.action)==null?void 0:mt.active,disabled:(lt=(a.vars||a).palette)==null||(ut=lt.action)==null?void 0:ut.disabled,inherit:void 0}[s.color]}}),SvgIcon=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiSvgIcon"}),{children:$,className:_e,color:tt="inherit",component:nt="svg",fontSize:rt="medium",htmlColor:it,inheritViewBox:st=!1,titleAccess:at,viewBox:ot="0 0 24 24"}=j,ct=_objectWithoutPropertiesLoose(j,_excluded$c),ft=_extends({},j,{color:tt,component:nt,fontSize:rt,instanceFontSize:s.fontSize,inheritViewBox:st,viewBox:ot}),ht={};st||(ht.viewBox=ot);const mt=useUtilityClasses$9(ft);return jsxs(SvgIconRoot,_extends({as:nt,className:clsx(mt.root,_e),focusable:"false",color:it,"aria-hidden":at?void 0:!0,role:at?"img":void 0,ref:o},ht,ct,{ownerState:ft,children:[$,at?jsx("title",{children:at}):null]}))});SvgIcon.muiName="SvgIcon";const SvgIcon$1=SvgIcon;function createSvgIcon(a,s){function o(j,$){return jsx(SvgIcon$1,_extends({"data-testid":`${s}Icon`,ref:$},j,{children:a}))}return o.muiName=SvgIcon$1.muiName,reactExports.memo(reactExports.forwardRef(o))}function _setPrototypeOf(a,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,$){return j.__proto__=$,j},_setPrototypeOf(a,s)}function _inheritsLoose(a,s){a.prototype=Object.create(s.prototype),a.prototype.constructor=a,_setPrototypeOf(a,s)}const TransitionGroupContext=React.createContext(null);function _assertThisInitialized(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function getChildMapping(a,s){var o=function(_e){return s&&reactExports.isValidElement(_e)?s(_e):_e},j=Object.create(null);return a&&reactExports.Children.map(a,function($){return $}).forEach(function($){j[$.key]=o($)}),j}function mergeChildMappings(a,s){a=a||{},s=s||{};function o(st){return st in s?s[st]:a[st]}var j=Object.create(null),$=[];for(var _e in a)_e in s?$.length&&(j[_e]=$,$=[]):$.push(_e);var tt,nt={};for(var rt in s){if(j[rt])for(tt=0;tt<j[rt].length;tt++){var it=j[rt][tt];nt[j[rt][tt]]=o(it)}nt[rt]=o(rt)}for(tt=0;tt<$.length;tt++)nt[$[tt]]=o($[tt]);return nt}function getProp(a,s,o){return o[s]!=null?o[s]:a.props[s]}function getInitialChildMapping(a,s){return getChildMapping(a.children,function(o){return reactExports.cloneElement(o,{onExited:s.bind(null,o),in:!0,appear:getProp(o,"appear",a),enter:getProp(o,"enter",a),exit:getProp(o,"exit",a)})})}function getNextChildMapping(a,s,o){var j=getChildMapping(a.children),$=mergeChildMappings(s,j);return Object.keys($).forEach(function(_e){var tt=$[_e];if(reactExports.isValidElement(tt)){var nt=_e in s,rt=_e in j,it=s[_e],st=reactExports.isValidElement(it)&&!it.props.in;rt&&(!nt||st)?$[_e]=reactExports.cloneElement(tt,{onExited:o.bind(null,tt),in:!0,exit:getProp(tt,"exit",a),enter:getProp(tt,"enter",a)}):!rt&&nt&&!st?$[_e]=reactExports.cloneElement(tt,{in:!1}):rt&&nt&&reactExports.isValidElement(it)&&($[_e]=reactExports.cloneElement(tt,{onExited:o.bind(null,tt),in:it.props.in,exit:getProp(tt,"exit",a),enter:getProp(tt,"enter",a)}))}}),$}var values=Object.values||function(a){return Object.keys(a).map(function(s){return a[s]})},defaultProps={component:"div",childFactory:function a(s){return s}},TransitionGroup=function(a){_inheritsLoose(s,a);function s(j,$){var _e;_e=a.call(this,j,$)||this;var tt=_e.handleExited.bind(_assertThisInitialized(_e));return _e.state={contextValue:{isMounting:!0},handleExited:tt,firstRender:!0},_e}var o=s.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},s.getDerivedStateFromProps=function($,_e){var tt=_e.children,nt=_e.handleExited,rt=_e.firstRender;return{children:rt?getInitialChildMapping($,nt):getNextChildMapping($,tt,nt),firstRender:!1}},o.handleExited=function($,_e){var tt=getChildMapping(this.props.children);$.key in tt||($.props.onExited&&$.props.onExited(_e),this.mounted&&this.setState(function(nt){var rt=_extends({},nt.children);return delete rt[$.key],{children:rt}}))},o.render=function(){var $=this.props,_e=$.component,tt=$.childFactory,nt=_objectWithoutPropertiesLoose($,["component","childFactory"]),rt=this.state.contextValue,it=values(this.state.children).map(tt);return delete nt.appear,delete nt.enter,delete nt.exit,_e===null?React.createElement(TransitionGroupContext.Provider,{value:rt},it):React.createElement(TransitionGroupContext.Provider,{value:rt},React.createElement(_e,nt,it))},s}(React.Component);TransitionGroup.propTypes={};TransitionGroup.defaultProps=defaultProps;const TransitionGroup$1=TransitionGroup;function Ripple(a){const{className:s,classes:o,pulsate:j=!1,rippleX:$,rippleY:_e,rippleSize:tt,in:nt,onExited:rt,timeout:it}=a,[st,at]=reactExports.useState(!1),ot=clsx(s,o.ripple,o.rippleVisible,j&&o.ripplePulsate),ct={width:tt,height:tt,top:-(tt/2)+_e,left:-(tt/2)+$},ft=clsx(o.child,st&&o.childLeaving,j&&o.childPulsate);return!nt&&!st&&at(!0),reactExports.useEffect(()=>{if(!nt&&rt!=null){const ht=setTimeout(rt,it);return()=>{clearTimeout(ht)}}},[rt,nt,it]),jsx("span",{className:ot,style:ct,children:jsx("span",{className:ft})})}const touchRippleClasses=generateUtilityClasses("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),touchRippleClasses$1=touchRippleClasses,_excluded$b=["center","classes","className"];let _=a=>a,_t,_t2,_t3,_t4;const DURATION=550,DELAY_RIPPLE=80,enterKeyframe=keyframes(_t||(_t=_`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),exitKeyframe=keyframes(_t2||(_t2=_`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),pulsateKeyframe=keyframes(_t3||(_t3=_`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TouchRippleRoot=styled$1("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TouchRippleRipple=styled$1(Ripple,{name:"MuiTouchRipple",slot:"Ripple"})(_t4||(_t4=_`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),touchRippleClasses$1.rippleVisible,enterKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.ripplePulsate,({theme:a})=>a.transitions.duration.shorter,touchRippleClasses$1.child,touchRippleClasses$1.childLeaving,exitKeyframe,DURATION,({theme:a})=>a.transitions.easing.easeInOut,touchRippleClasses$1.childPulsate,pulsateKeyframe,({theme:a})=>a.transitions.easing.easeInOut),TouchRipple=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiTouchRipple"}),{center:$=!1,classes:_e={},className:tt}=j,nt=_objectWithoutPropertiesLoose(j,_excluded$b),[rt,it]=reactExports.useState([]),st=reactExports.useRef(0),at=reactExports.useRef(null);reactExports.useEffect(()=>{at.current&&(at.current(),at.current=null)},[rt]);const ot=reactExports.useRef(!1),ct=reactExports.useRef(null),ft=reactExports.useRef(null),ht=reactExports.useRef(null);reactExports.useEffect(()=>()=>{clearTimeout(ct.current)},[]);const mt=reactExports.useCallback(gt=>{const{pulsate:Et,rippleX:St,rippleY:Tt,rippleSize:Mt,cb:Bt}=gt;it(Rt=>[...Rt,jsx(TouchRippleRipple,{classes:{ripple:clsx(_e.ripple,touchRippleClasses$1.ripple),rippleVisible:clsx(_e.rippleVisible,touchRippleClasses$1.rippleVisible),ripplePulsate:clsx(_e.ripplePulsate,touchRippleClasses$1.ripplePulsate),child:clsx(_e.child,touchRippleClasses$1.child),childLeaving:clsx(_e.childLeaving,touchRippleClasses$1.childLeaving),childPulsate:clsx(_e.childPulsate,touchRippleClasses$1.childPulsate)},timeout:DURATION,pulsate:Et,rippleX:St,rippleY:Tt,rippleSize:Mt},st.current)]),st.current+=1,at.current=Bt},[_e]),lt=reactExports.useCallback((gt={},Et={},St=()=>{})=>{const{pulsate:Tt=!1,center:Mt=$||Et.pulsate,fakeElement:Bt=!1}=Et;if((gt==null?void 0:gt.type)==="mousedown"&&ot.current){ot.current=!1;return}(gt==null?void 0:gt.type)==="touchstart"&&(ot.current=!0);const Rt=Bt?null:ht.current,Ut=Rt?Rt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ht,Wt,Jt;if(Mt||gt===void 0||gt.clientX===0&&gt.clientY===0||!gt.clientX&&!gt.touches)Ht=Math.round(Ut.width/2),Wt=Math.round(Ut.height/2);else{const{clientX:sn,clientY:jt}=gt.touches&&gt.touches.length>0?gt.touches[0]:gt;Ht=Math.round(sn-Ut.left),Wt=Math.round(jt-Ut.top)}if(Mt)Jt=Math.sqrt((2*Ut.width**2+Ut.height**2)/3),Jt%2===0&&(Jt+=1);else{const sn=Math.max(Math.abs((Rt?Rt.clientWidth:0)-Ht),Ht)*2+2,jt=Math.max(Math.abs((Rt?Rt.clientHeight:0)-Wt),Wt)*2+2;Jt=Math.sqrt(sn**2+jt**2)}gt!=null&&gt.touches?ft.current===null&&(ft.current=()=>{mt({pulsate:Tt,rippleX:Ht,rippleY:Wt,rippleSize:Jt,cb:St})},ct.current=setTimeout(()=>{ft.current&&(ft.current(),ft.current=null)},DELAY_RIPPLE)):mt({pulsate:Tt,rippleX:Ht,rippleY:Wt,rippleSize:Jt,cb:St})},[$,mt]),ut=reactExports.useCallback(()=>{lt({},{pulsate:!0})},[lt]),dt=reactExports.useCallback((gt,Et)=>{if(clearTimeout(ct.current),(gt==null?void 0:gt.type)==="touchend"&&ft.current){ft.current(),ft.current=null,ct.current=setTimeout(()=>{dt(gt,Et)});return}ft.current=null,it(St=>St.length>0?St.slice(1):St),at.current=Et},[]);return reactExports.useImperativeHandle(o,()=>({pulsate:ut,start:lt,stop:dt}),[ut,lt,dt]),jsx(TouchRippleRoot,_extends({className:clsx(touchRippleClasses$1.root,_e.root,tt),ref:ht},nt,{children:jsx(TransitionGroup$1,{component:null,exit:!0,children:rt})}))}),TouchRipple$1=TouchRipple;function getButtonBaseUtilityClass(a){return generateUtilityClass("MuiButtonBase",a)}const buttonBaseClasses=generateUtilityClasses("MuiButtonBase",["root","disabled","focusVisible"]),buttonBaseClasses$1=buttonBaseClasses,_excluded$a=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],useUtilityClasses$8=a=>{const{disabled:s,focusVisible:o,focusVisibleClassName:j,classes:$}=a,tt=composeClasses({root:["root",s&&"disabled",o&&"focusVisible"]},getButtonBaseUtilityClass,$);return o&&j&&(tt.root+=` ${j}`),tt},ButtonBaseRoot=styled$1("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(a,s)=>s.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${buttonBaseClasses$1.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ButtonBase=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiButtonBase"}),{action:$,centerRipple:_e=!1,children:tt,className:nt,component:rt="button",disabled:it=!1,disableRipple:st=!1,disableTouchRipple:at=!1,focusRipple:ot=!1,LinkComponent:ct="a",onBlur:ft,onClick:ht,onContextMenu:mt,onDragLeave:lt,onFocus:ut,onFocusVisible:dt,onKeyDown:gt,onKeyUp:Et,onMouseDown:St,onMouseLeave:Tt,onMouseUp:Mt,onTouchEnd:Bt,onTouchMove:Rt,onTouchStart:Ut,tabIndex:Ht=0,TouchRippleProps:Wt,touchRippleRef:Jt,type:sn}=j,jt=_objectWithoutPropertiesLoose(j,_excluded$a),Vt=reactExports.useRef(null),Lt=reactExports.useRef(null),Qt=useForkRef(Lt,Jt),{isFocusVisibleRef:nn,onFocus:mn,onBlur:Zt,ref:cn}=useIsFocusVisible(),[Ot,rn]=reactExports.useState(!1);it&&Ot&&rn(!1),reactExports.useImperativeHandle($,()=>({focusVisible:()=>{rn(!0),Vt.current.focus()}}),[]);const[fn,hn]=reactExports.useState(!1);reactExports.useEffect(()=>{hn(!0)},[]);const Tn=fn&&!st&&!it;reactExports.useEffect(()=>{Ot&&ot&&!st&&fn&&Lt.current.pulsate()},[st,ot,Ot,fn]);function Nn(yn,On,Mn=at){return useEventCallback(tr=>(On&&On(tr),!Mn&&Lt.current&&Lt.current[yn](tr),!0))}const Pn=Nn("start",St),Dn=Nn("stop",mt),ln=Nn("stop",lt),Cn=Nn("stop",Mt),bn=Nn("stop",yn=>{Ot&&yn.preventDefault(),Tt&&Tt(yn)}),kn=Nn("start",Ut),Sn=Nn("stop",Bt),xn=Nn("stop",Rt),Qn=Nn("stop",yn=>{Zt(yn),nn.current===!1&&rn(!1),ft&&ft(yn)},!1),nr=useEventCallback(yn=>{Vt.current||(Vt.current=yn.currentTarget),mn(yn),nn.current===!0&&(rn(!0),dt&&dt(yn)),ut&&ut(yn)}),or=()=>{const yn=Vt.current;return rt&&rt!=="button"&&!(yn.tagName==="A"&&yn.href)},mr=reactExports.useRef(!1),$n=useEventCallback(yn=>{ot&&!mr.current&&Ot&&Lt.current&&yn.key===" "&&(mr.current=!0,Lt.current.stop(yn,()=>{Lt.current.start(yn)})),yn.target===yn.currentTarget&&or()&&yn.key===" "&&yn.preventDefault(),gt&&gt(yn),yn.target===yn.currentTarget&&or()&&yn.key==="Enter"&&!it&&(yn.preventDefault(),ht&&ht(yn))}),tn=useEventCallback(yn=>{ot&&yn.key===" "&&Lt.current&&Ot&&!yn.defaultPrevented&&(mr.current=!1,Lt.current.stop(yn,()=>{Lt.current.pulsate(yn)})),Et&&Et(yn),ht&&yn.target===yn.currentTarget&&or()&&yn.key===" "&&!yn.defaultPrevented&&ht(yn)});let $t=rt;$t==="button"&&(jt.href||jt.to)&&($t=ct);const An={};$t==="button"?(An.type=sn===void 0?"button":sn,An.disabled=it):(!jt.href&&!jt.to&&(An.role="button"),it&&(An["aria-disabled"]=it));const En=useForkRef(o,cn,Vt),In=_extends({},j,{centerRipple:_e,component:rt,disabled:it,disableRipple:st,disableTouchRipple:at,focusRipple:ot,tabIndex:Ht,focusVisible:Ot}),Hn=useUtilityClasses$8(In);return jsxs(ButtonBaseRoot,_extends({as:$t,className:clsx(Hn.root,nt),ownerState:In,onBlur:Qn,onClick:ht,onContextMenu:Dn,onFocus:nr,onKeyDown:$n,onKeyUp:tn,onMouseDown:Pn,onMouseLeave:bn,onMouseUp:Cn,onDragLeave:ln,onTouchEnd:Sn,onTouchMove:xn,onTouchStart:kn,ref:En,tabIndex:it?-1:Ht,type:sn},An,jt,{children:[tt,Tn?jsx(TouchRipple$1,_extends({ref:Qt,center:_e},Wt)):null]}))}),ButtonBase$1=ButtonBase;function getTypographyUtilityClass(a){return generateUtilityClass("MuiTypography",a)}generateUtilityClasses("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const _excluded$9=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],useUtilityClasses$7=a=>{const{align:s,gutterBottom:o,noWrap:j,paragraph:$,variant:_e,classes:tt}=a,nt={root:["root",_e,a.align!=="inherit"&&`align${capitalize(s)}`,o&&"gutterBottom",j&&"noWrap",$&&"paragraph"]};return composeClasses(nt,getTypographyUtilityClass,tt)},TypographyRoot=styled$1("span",{name:"MuiTypography",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.root,o.variant&&s[o.variant],o.align!=="inherit"&&s[`align${capitalize(o.align)}`],o.noWrap&&s.noWrap,o.gutterBottom&&s.gutterBottom,o.paragraph&&s.paragraph]}})(({theme:a,ownerState:s})=>_extends({margin:0},s.variant&&a.typography[s.variant],s.align!=="inherit"&&{textAlign:s.align},s.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s.gutterBottom&&{marginBottom:"0.35em"},s.paragraph&&{marginBottom:16})),defaultVariantMapping={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},colorTransformations={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=a=>colorTransformations[a]||a,Typography=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiTypography"}),$=transformDeprecatedColors(j.color),_e=extendSxProp(_extends({},j,{color:$})),{align:tt="inherit",className:nt,component:rt,gutterBottom:it=!1,noWrap:st=!1,paragraph:at=!1,variant:ot="body1",variantMapping:ct=defaultVariantMapping}=_e,ft=_objectWithoutPropertiesLoose(_e,_excluded$9),ht=_extends({},_e,{align:tt,color:$,className:nt,component:rt,gutterBottom:it,noWrap:st,paragraph:at,variant:ot,variantMapping:ct}),mt=rt||(at?"p":ct[ot]||defaultVariantMapping[ot])||"span",lt=useUtilityClasses$7(ht);return jsx(TypographyRoot,_extends({as:mt,ref:o,ownerState:ht,className:clsx(lt.root,nt)},ft))}),Typography$1=Typography;function formControlState({props:a,states:s,muiFormControl:o}){return s.reduce((j,$)=>(j[$]=a[$],o&&typeof a[$]>"u"&&(j[$]=o[$]),j),{})}const FormControlContext=reactExports.createContext(void 0),FormControlContext$1=FormControlContext;function useFormControl(){return reactExports.useContext(FormControlContext$1)}function hasValue(a){return a!=null&&!(Array.isArray(a)&&a.length===0)}function isFilled(a,s=!1){return a&&(hasValue(a.value)&&a.value!==""||s&&hasValue(a.defaultValue)&&a.defaultValue!=="")}function isAdornedStart(a){return a.startAdornment}const shouldSpreadAdditionalProps=a=>!a||!isHostComponent(a),shouldSpreadAdditionalProps$1=shouldSpreadAdditionalProps,defaultTheme=createTheme(),Box=createBox({defaultTheme,defaultClassName:"MuiBox-root",generateClassName:ClassNameGenerator$1.generate}),Box$1=Box;function getSwitchBaseUtilityClass(a){return generateUtilityClass("PrivateSwitchBase",a)}generateUtilityClasses("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const _excluded$8=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],useUtilityClasses$6=a=>{const{classes:s,checked:o,disabled:j,edge:$}=a,_e={root:["root",o&&"checked",j&&"disabled",$&&`edge${capitalize($)}`],input:["input"]};return composeClasses(_e,getSwitchBaseUtilityClass,s)},SwitchBaseRoot=styled$1(ButtonBase$1)(({ownerState:a})=>_extends({padding:9,borderRadius:"50%"},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12})),SwitchBaseInput=styled$1("input")({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),SwitchBase=reactExports.forwardRef(function a(s,o){const{autoFocus:j,checked:$,checkedIcon:_e,className:tt,defaultChecked:nt,disabled:rt,disableFocusRipple:it=!1,edge:st=!1,icon:at,id:ot,inputProps:ct,inputRef:ft,name:ht,onBlur:mt,onChange:lt,onFocus:ut,readOnly:dt,required:gt=!1,tabIndex:Et,type:St,value:Tt}=s,Mt=_objectWithoutPropertiesLoose(s,_excluded$8),[Bt,Rt]=useControlled({controlled:$,default:Boolean(nt),name:"SwitchBase",state:"checked"}),Ut=useFormControl(),Ht=Qt=>{ut&&ut(Qt),Ut&&Ut.onFocus&&Ut.onFocus(Qt)},Wt=Qt=>{mt&&mt(Qt),Ut&&Ut.onBlur&&Ut.onBlur(Qt)},Jt=Qt=>{if(Qt.nativeEvent.defaultPrevented)return;const nn=Qt.target.checked;Rt(nn),lt&&lt(Qt,nn)};let sn=rt;Ut&&typeof sn>"u"&&(sn=Ut.disabled);const jt=St==="checkbox"||St==="radio",Vt=_extends({},s,{checked:Bt,disabled:sn,disableFocusRipple:it,edge:st}),Lt=useUtilityClasses$6(Vt);return jsxs(SwitchBaseRoot,_extends({component:"span",className:clsx(Lt.root,tt),centerRipple:!0,focusRipple:!it,disabled:sn,tabIndex:null,role:void 0,onFocus:Ht,onBlur:Wt,ownerState:Vt,ref:o},Mt,{children:[jsx(SwitchBaseInput,_extends({autoFocus:j,checked:$,defaultChecked:nt,className:Lt.input,disabled:sn,id:jt&&ot,name:ht,onChange:Jt,readOnly:dt,ref:ft,required:gt,ownerState:Vt,tabIndex:Et,type:St},St==="checkbox"&&Tt===void 0?{}:{value:Tt},ct)),Bt?_e:at]}))}),SwitchBase$1=SwitchBase;function getFormControlUtilityClasses(a){return generateUtilityClass("MuiFormControl",a)}generateUtilityClasses("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const _excluded$7=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],useUtilityClasses$5=a=>{const{classes:s,margin:o,fullWidth:j}=a,$={root:["root",o!=="none"&&`margin${capitalize(o)}`,j&&"fullWidth"]};return composeClasses($,getFormControlUtilityClasses,s)},FormControlRoot=styled$1("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:a},s)=>_extends({},s.root,s[`margin${capitalize(a.margin)}`],a.fullWidth&&s.fullWidth)})(({ownerState:a})=>_extends({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},a.margin==="normal"&&{marginTop:16,marginBottom:8},a.margin==="dense"&&{marginTop:8,marginBottom:4},a.fullWidth&&{width:"100%"})),FormControl=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiFormControl"}),{children:$,className:_e,color:tt="primary",component:nt="div",disabled:rt=!1,error:it=!1,focused:st,fullWidth:at=!1,hiddenLabel:ot=!1,margin:ct="none",required:ft=!1,size:ht="medium",variant:mt="outlined"}=j,lt=_objectWithoutPropertiesLoose(j,_excluded$7),ut=_extends({},j,{color:tt,component:nt,disabled:rt,error:it,fullWidth:at,hiddenLabel:ot,margin:ct,required:ft,size:ht,variant:mt}),dt=useUtilityClasses$5(ut),[gt,Et]=reactExports.useState(()=>{let Wt=!1;return $&&reactExports.Children.forEach($,Jt=>{if(!isMuiElement(Jt,["Input","Select"]))return;const sn=isMuiElement(Jt,["Select"])?Jt.props.input:Jt;sn&&isAdornedStart(sn.props)&&(Wt=!0)}),Wt}),[St,Tt]=reactExports.useState(()=>{let Wt=!1;return $&&reactExports.Children.forEach($,Jt=>{isMuiElement(Jt,["Input","Select"])&&isFilled(Jt.props,!0)&&(Wt=!0)}),Wt}),[Mt,Bt]=reactExports.useState(!1);rt&&Mt&&Bt(!1);const Rt=st!==void 0&&!rt?st:Mt;let Ut;const Ht=reactExports.useMemo(()=>({adornedStart:gt,setAdornedStart:Et,color:tt,disabled:rt,error:it,filled:St,focused:Rt,fullWidth:at,hiddenLabel:ot,size:ht,onBlur:()=>{Bt(!1)},onEmpty:()=>{Tt(!1)},onFilled:()=>{Tt(!0)},onFocus:()=>{Bt(!0)},registerEffect:Ut,required:ft,variant:mt}),[gt,tt,rt,it,St,Rt,at,ot,Ut,ft,ht,mt]);return jsx(FormControlContext$1.Provider,{value:Ht,children:jsx(FormControlRoot,_extends({as:nt,ownerState:ut,className:clsx(dt.root,_e),ref:o},lt,{children:$}))})}),FormControl$1=FormControl;function getFormControlLabelUtilityClasses(a){return generateUtilityClass("MuiFormControlLabel",a)}const formControlLabelClasses=generateUtilityClasses("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error"]),formControlLabelClasses$1=formControlLabelClasses,_excluded$6=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","slotProps","value"],useUtilityClasses$4=a=>{const{classes:s,disabled:o,labelPlacement:j,error:$}=a,_e={root:["root",o&&"disabled",`labelPlacement${capitalize(j)}`,$&&"error"],label:["label",o&&"disabled"]};return composeClasses(_e,getFormControlLabelUtilityClasses,s)},FormControlLabelRoot=styled$1("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[{[`& .${formControlLabelClasses$1.label}`]:s.label},s.root,s[`labelPlacement${capitalize(o.labelPlacement)}`]]}})(({theme:a,ownerState:s})=>_extends({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${formControlLabelClasses$1.disabled}`]:{cursor:"default"}},s.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},s.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},s.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${formControlLabelClasses$1.label}`]:{[`&.${formControlLabelClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),FormControlLabel=reactExports.forwardRef(function a(s,o){var j;const $=useThemeProps({props:s,name:"MuiFormControlLabel"}),{className:_e,componentsProps:tt={},control:nt,disabled:rt,disableTypography:it,label:st,labelPlacement:at="end",slotProps:ot={}}=$,ct=_objectWithoutPropertiesLoose($,_excluded$6),ft=useFormControl();let ht=rt;typeof ht>"u"&&typeof nt.props.disabled<"u"&&(ht=nt.props.disabled),typeof ht>"u"&&ft&&(ht=ft.disabled);const mt={disabled:ht};["checked","name","onChange","value","inputRef"].forEach(St=>{typeof nt.props[St]>"u"&&typeof $[St]<"u"&&(mt[St]=$[St])});const lt=formControlState({props:$,muiFormControl:ft,states:["error"]}),ut=_extends({},$,{disabled:ht,labelPlacement:at,error:lt.error}),dt=useUtilityClasses$4(ut),gt=(j=ot.typography)!=null?j:tt.typography;let Et=st;return Et!=null&&Et.type!==Typography$1&&!it&&(Et=jsx(Typography$1,_extends({component:"span"},gt,{className:clsx(dt.label,gt==null?void 0:gt.className),children:Et}))),jsxs(FormControlLabelRoot,_extends({className:clsx(dt.root,_e),ownerState:ut,ref:o},ct,{children:[reactExports.cloneElement(nt,mt),Et]}))}),FormControlLabel$1=FormControlLabel;function getFormGroupUtilityClass(a){return generateUtilityClass("MuiFormGroup",a)}generateUtilityClasses("MuiFormGroup",["root","row","error"]);const _excluded$5=["className","row"],useUtilityClasses$3=a=>{const{classes:s,row:o,error:j}=a;return composeClasses({root:["root",o&&"row",j&&"error"]},getFormGroupUtilityClass,s)},FormGroupRoot=styled$1("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.root,o.row&&s.row]}})(({ownerState:a})=>_extends({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),FormGroup=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiFormGroup"}),{className:$,row:_e=!1}=j,tt=_objectWithoutPropertiesLoose(j,_excluded$5),nt=useFormControl(),rt=formControlState({props:j,muiFormControl:nt,states:["error"]}),it=_extends({},j,{row:_e,error:rt.error}),st=useUtilityClasses$3(it);return jsx(FormGroupRoot,_extends({className:clsx(st.root,$),ownerState:it,ref:o},tt))}),FormGroup$1=FormGroup;function getFormLabelUtilityClasses(a){return generateUtilityClass("MuiFormLabel",a)}const formLabelClasses=generateUtilityClasses("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),formLabelClasses$1=formLabelClasses,_excluded$4=["children","className","color","component","disabled","error","filled","focused","required"],useUtilityClasses$2=a=>{const{classes:s,color:o,focused:j,disabled:$,error:_e,filled:tt,required:nt}=a,rt={root:["root",`color${capitalize(o)}`,$&&"disabled",_e&&"error",tt&&"filled",j&&"focused",nt&&"required"],asterisk:["asterisk",_e&&"error"]};return composeClasses(rt,getFormLabelUtilityClasses,s)},FormLabelRoot=styled$1("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:a},s)=>_extends({},s.root,a.color==="secondary"&&s.colorSecondary,a.filled&&s.filled)})(({theme:a,ownerState:s})=>_extends({color:(a.vars||a).palette.text.secondary},a.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${formLabelClasses$1.focused}`]:{color:(a.vars||a).palette[s.color].main},[`&.${formLabelClasses$1.disabled}`]:{color:(a.vars||a).palette.text.disabled},[`&.${formLabelClasses$1.error}`]:{color:(a.vars||a).palette.error.main}})),AsteriskComponent=styled$1("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(a,s)=>s.asterisk})(({theme:a})=>({[`&.${formLabelClasses$1.error}`]:{color:(a.vars||a).palette.error.main}})),FormLabel=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiFormLabel"}),{children:$,className:_e,component:tt="label"}=j,nt=_objectWithoutPropertiesLoose(j,_excluded$4),rt=useFormControl(),it=formControlState({props:j,muiFormControl:rt,states:["color","required","focused","disabled","error","filled"]}),st=_extends({},j,{color:it.color||"primary",component:tt,disabled:it.disabled,error:it.error,filled:it.filled,focused:it.focused,required:it.required}),at=useUtilityClasses$2(st);return jsxs(FormLabelRoot,_extends({as:tt,ownerState:st,className:clsx(at.root,_e),ref:o},nt,{children:[$,it.required&&jsxs(AsteriskComponent,{ownerState:st,"aria-hidden":!0,className:at.asterisk,children:[" ","*"]})]}))}),FormLabel$1=FormLabel,RadioButtonUncheckedIcon=createSvgIcon(jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),RadioButtonCheckedIcon=createSvgIcon(jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),RadioButtonIconRoot=styled$1("span")({position:"relative",display:"flex"}),RadioButtonIconBackground=styled$1(RadioButtonUncheckedIcon)({transform:"scale(1)"}),RadioButtonIconDot=styled$1(RadioButtonCheckedIcon)(({theme:a,ownerState:s})=>_extends({left:0,position:"absolute",transform:"scale(0)",transition:a.transitions.create("transform",{easing:a.transitions.easing.easeIn,duration:a.transitions.duration.shortest})},s.checked&&{transform:"scale(1)",transition:a.transitions.create("transform",{easing:a.transitions.easing.easeOut,duration:a.transitions.duration.shortest})}));function RadioButtonIcon(a){const{checked:s=!1,classes:o={},fontSize:j}=a,$=_extends({},a,{checked:s});return jsxs(RadioButtonIconRoot,{className:o.root,ownerState:$,children:[jsx(RadioButtonIconBackground,{fontSize:j,className:o.background,ownerState:$}),jsx(RadioButtonIconDot,{fontSize:j,className:o.dot,ownerState:$})]})}const RadioGroupContext=reactExports.createContext(void 0),RadioGroupContext$1=RadioGroupContext;function useRadioGroup(){return reactExports.useContext(RadioGroupContext$1)}function getRadioUtilityClass(a){return generateUtilityClass("MuiRadio",a)}const radioClasses=generateUtilityClasses("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),radioClasses$1=radioClasses,_excluded$3=["checked","checkedIcon","color","icon","name","onChange","size","className"],useUtilityClasses$1=a=>{const{classes:s,color:o}=a,j={root:["root",`color${capitalize(o)}`]};return _extends({},s,composeClasses(j,getRadioUtilityClass,s))},RadioRoot=styled$1(SwitchBase$1,{shouldForwardProp:a=>rootShouldForwardProp(a)||a==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.root,s[`color${capitalize(o.color)}`]]}})(({theme:a,ownerState:s})=>_extends({color:(a.vars||a).palette.text.secondary},!s.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${s.color==="default"?a.vars.palette.action.activeChannel:a.vars.palette[s.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:alpha(s.color==="default"?a.palette.action.active:a.palette[s.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},s.color!=="default"&&{[`&.${radioClasses$1.checked}`]:{color:(a.vars||a).palette[s.color].main}},{[`&.${radioClasses$1.disabled}`]:{color:(a.vars||a).palette.action.disabled}}));function areEqualValues(a,s){return typeof s=="object"&&s!==null?a===s:String(a)===String(s)}const defaultCheckedIcon=jsx(RadioButtonIcon,{checked:!0}),defaultIcon=jsx(RadioButtonIcon,{}),Radio=reactExports.forwardRef(function a(s,o){var j,$;const _e=useThemeProps({props:s,name:"MuiRadio"}),{checked:tt,checkedIcon:nt=defaultCheckedIcon,color:rt="primary",icon:it=defaultIcon,name:st,onChange:at,size:ot="medium",className:ct}=_e,ft=_objectWithoutPropertiesLoose(_e,_excluded$3),ht=_extends({},_e,{color:rt,size:ot}),mt=useUtilityClasses$1(ht),lt=useRadioGroup();let ut=tt;const dt=createChainedFunction(at,lt&&lt.onChange);let gt=st;return lt&&(typeof ut>"u"&&(ut=areEqualValues(lt.value,_e.value)),typeof gt>"u"&&(gt=lt.name)),jsx(RadioRoot,_extends({type:"radio",icon:reactExports.cloneElement(it,{fontSize:(j=defaultIcon.props.fontSize)!=null?j:ot}),checkedIcon:reactExports.cloneElement(nt,{fontSize:($=defaultCheckedIcon.props.fontSize)!=null?$:ot}),ownerState:ht,classes:mt,name:gt,checked:ut,onChange:dt,ref:o,className:clsx(mt.root,ct)},ft))}),Radio$1=Radio,_excluded$2=["actions","children","defaultValue","name","onChange","value"],RadioGroup=reactExports.forwardRef(function a(s,o){const{actions:j,children:$,defaultValue:_e,name:tt,onChange:nt,value:rt}=s,it=_objectWithoutPropertiesLoose(s,_excluded$2),st=reactExports.useRef(null),[at,ot]=useControlled({controlled:rt,default:_e,name:"RadioGroup"});reactExports.useImperativeHandle(j,()=>({focus:()=>{let mt=st.current.querySelector("input:not(:disabled):checked");mt||(mt=st.current.querySelector("input:not(:disabled)")),mt&&mt.focus()}}),[]);const ct=useForkRef(o,st),ft=useId(tt),ht=reactExports.useMemo(()=>({name:ft,onChange(mt){ot(mt.target.value),nt&&nt(mt,mt.target.value)},value:at}),[ft,nt,ot,at]);return jsx(RadioGroupContext$1.Provider,{value:ht,children:jsx(FormGroup$1,_extends({role:"radiogroup",ref:ct},it,{children:$}))})}),RadioGroup$1=RadioGroup;function getSliderUtilityClass(a){return generateUtilityClass("MuiSlider",a)}const sliderClasses=generateUtilityClasses("MuiSlider",["root","active","colorPrimary","colorSecondary","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),sliderClasses$1=sliderClasses,useValueLabelClasses=a=>{const{open:s}=a;return{offset:clsx(s&&sliderClasses$1.valueLabelOpen),circle:sliderClasses$1.valueLabelCircle,label:sliderClasses$1.valueLabelLabel}};function SliderValueLabel(a){const{children:s,className:o,value:j}=a,$=useValueLabelClasses(a);return s?reactExports.cloneElement(s,{className:clsx(s.props.className)},jsxs(reactExports.Fragment,{children:[s.props.children,jsx("span",{className:clsx($.offset,o),"aria-hidden":!0,children:jsx("span",{className:$.circle,children:jsx("span",{className:$.label,children:j})})})]})):null}const _excluded$1=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"],valueToPercent=(a,s,o)=>(a-s)*100/(o-s);function Identity(a){return a}const SliderRoot=styled$1("span",{name:"MuiSlider",slot:"Root",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.root,s[`color${capitalize(o.color)}`],o.size!=="medium"&&s[`size${capitalize(o.size)}`],o.marked&&s.marked,o.orientation==="vertical"&&s.vertical,o.track==="inverted"&&s.trackInverted,o.track===!1&&s.trackFalse]}})(({theme:a,ownerState:s})=>_extends({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(a.vars||a).palette[s.color].main,WebkitTapHighlightColor:"transparent"},s.orientation==="horizontal"&&_extends({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},s.size==="small"&&{height:2},s.marked&&{marginBottom:20}),s.orientation==="vertical"&&_extends({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},s.size==="small"&&{width:2},s.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${sliderClasses$1.disabled}`]:{pointerEvents:"none",cursor:"default",color:(a.vars||a).palette.grey[400]},[`&.${sliderClasses$1.dragging}`]:{[`& .${sliderClasses$1.thumb}, & .${sliderClasses$1.track}`]:{transition:"none"}}})),SliderRail=styled$1("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(a,s)=>s.rail})(({ownerState:a})=>_extends({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},a.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},a.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},a.track==="inverted"&&{opacity:1})),SliderTrack=styled$1("span",{name:"MuiSlider",slot:"Track",overridesResolver:(a,s)=>s.track})(({theme:a,ownerState:s})=>{const o=a.palette.mode==="light"?lighten(a.palette[s.color].main,.62):darken(a.palette[s.color].main,.5);return _extends({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:a.transitions.create(["left","width","bottom","height"],{duration:a.transitions.duration.shortest})},s.size==="small"&&{border:"none"},s.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},s.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},s.track===!1&&{display:"none"},s.track==="inverted"&&{backgroundColor:a.vars?a.vars.palette.Slider[`${s.color}Track`]:o,borderColor:a.vars?a.vars.palette.Slider[`${s.color}Track`]:o})}),SliderThumb=styled$1("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(a,s)=>{const{ownerState:o}=a;return[s.thumb,s[`thumbColor${capitalize(o.color)}`],o.size!=="medium"&&s[`thumbSize${capitalize(o.size)}`]]}})(({theme:a,ownerState:s})=>_extends({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:a.transitions.create(["box-shadow","left","bottom"],{duration:a.transitions.duration.shortest})},s.size==="small"&&{width:12,height:12},s.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},s.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":_extends({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(a.vars||a).shadows[2]},s.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${sliderClasses$1.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${a.vars?`rgba(${a.vars.palette[s.color].mainChannel} / 0.16)`:alpha(a.palette[s.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${sliderClasses$1.active}`]:{boxShadow:`0px 0px 0px 14px ${a.vars?`rgba(${a.vars.palette[s.color].mainChannel} / 0.16)`:alpha(a.palette[s.color].main,.16)}`},[`&.${sliderClasses$1.disabled}`]:{"&:hover":{boxShadow:"none"}}})),StyledSliderValueLabel=styled$1(SliderValueLabel,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(a,s)=>s.valueLabel})(({theme:a,ownerState:s})=>_extends({[`&.${sliderClasses$1.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"},zIndex:1,whiteSpace:"nowrap"},a.typography.body2,{fontWeight:500,transition:a.transitions.create(["transform"],{duration:a.transitions.duration.shortest}),transform:"translateY(-100%) scale(0)",position:"absolute",backgroundColor:(a.vars||a).palette.grey[600],borderRadius:2,color:(a.vars||a).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},s.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},s.orientation==="vertical"&&{right:"30px",top:"24px",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",right:"-20%",top:"25%"}},s.size==="small"&&{fontSize:a.typography.pxToRem(12),padding:"0.25rem 0.5rem"})),SliderMark=styled$1("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:a=>slotShouldForwardProp(a)&&a!=="markActive",overridesResolver:(a,s)=>{const{markActive:o}=a;return[s.mark,o&&s.markActive]}})(({theme:a,ownerState:s,markActive:o})=>_extends({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},s.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},s.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},o&&{backgroundColor:(a.vars||a).palette.background.paper,opacity:.8})),SliderMarkLabel=styled$1("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:a=>slotShouldForwardProp(a)&&a!=="markLabelActive",overridesResolver:(a,s)=>s.markLabel})(({theme:a,ownerState:s,markLabelActive:o})=>_extends({},a.typography.body2,{color:(a.vars||a).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},s.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},s.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},o&&{color:(a.vars||a).palette.text.primary})),useUtilityClasses=a=>{const{disabled:s,dragging:o,marked:j,orientation:$,track:_e,classes:tt,color:nt,size:rt}=a,it={root:["root",s&&"disabled",o&&"dragging",j&&"marked",$==="vertical"&&"vertical",_e==="inverted"&&"trackInverted",_e===!1&&"trackFalse",nt&&`color${capitalize(nt)}`,rt&&`size${capitalize(rt)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",s&&"disabled",rt&&`thumbSize${capitalize(rt)}`,nt&&`thumbColor${capitalize(nt)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return composeClasses(it,getSliderUtilityClass,tt)},Forward=({children:a})=>a,Slider=reactExports.forwardRef(function a(s,o){var j,$,_e,tt,nt,rt,it,st,at,ot,ct,ft,ht,mt,lt,ut,dt,gt,Et,St,Tt,Mt,Bt,Rt;const Ut=useThemeProps({props:s,name:"MuiSlider"}),Wt=useTheme().direction==="rtl",{"aria-label":Jt,"aria-valuetext":sn,"aria-labelledby":jt,component:Vt="span",components:Lt={},componentsProps:Qt={},color:nn="primary",classes:mn,className:Zt,disableSwap:cn=!1,disabled:Ot=!1,getAriaLabel:rn,getAriaValueText:fn,marks:hn=!1,max:Tn=100,min:Nn=0,orientation:Pn="horizontal",size:Dn="medium",step:ln=1,scale:Cn=Identity,slotProps:bn,slots:kn,track:Sn="normal",valueLabelDisplay:xn="off",valueLabelFormat:Qn=Identity}=Ut,nr=_objectWithoutPropertiesLoose(Ut,_excluded$1),or=_extends({},Ut,{isRtl:Wt,max:Tn,min:Nn,classes:mn,disabled:Ot,disableSwap:cn,orientation:Pn,marks:hn,color:nn,size:Dn,step:ln,scale:Cn,track:Sn,valueLabelDisplay:xn,valueLabelFormat:Qn}),{axisProps:mr,getRootProps:$n,getHiddenInputProps:tn,getThumbProps:$t,open:An,active:En,axis:In,focusedThumbIndex:Hn,range:yn,dragging:On,marks:Mn,values:tr,trackOffset:gr,trackLeap:Cr}=useSlider(_extends({},or,{ref:o}));or.marked=Mn.length>0&&Mn.some(pn=>pn.label),or.dragging=On,or.focusedThumbIndex=Hn;const Sr=useUtilityClasses(or),Un=(j=($=kn==null?void 0:kn.root)!=null?$:Lt.Root)!=null?j:SliderRoot,Jn=(_e=(tt=kn==null?void 0:kn.rail)!=null?tt:Lt.Rail)!=null?_e:SliderRail,pr=(nt=(rt=kn==null?void 0:kn.track)!=null?rt:Lt.Track)!=null?nt:SliderTrack,Gn=(it=(st=kn==null?void 0:kn.thumb)!=null?st:Lt.Thumb)!=null?it:SliderThumb,Zn=(at=(ot=kn==null?void 0:kn.valueLabel)!=null?ot:Lt.ValueLabel)!=null?at:StyledSliderValueLabel,qn=(ct=(ft=kn==null?void 0:kn.mark)!=null?ft:Lt.Mark)!=null?ct:SliderMark,vr=(ht=(mt=kn==null?void 0:kn.markLabel)!=null?mt:Lt.MarkLabel)!=null?ht:SliderMarkLabel,_r=(lt=(ut=kn==null?void 0:kn.input)!=null?ut:Lt.Input)!=null?lt:"input",$r=(dt=bn==null?void 0:bn.root)!=null?dt:Qt.root,es=(gt=bn==null?void 0:bn.rail)!=null?gt:Qt.rail,Hr=(Et=bn==null?void 0:bn.track)!=null?Et:Qt.track,Ur=(St=bn==null?void 0:bn.thumb)!=null?St:Qt.thumb,Ir=(Tt=bn==null?void 0:bn.valueLabel)!=null?Tt:Qt.valueLabel,Fr=(Mt=bn==null?void 0:bn.mark)!=null?Mt:Qt.mark,Pr=(Bt=bn==null?void 0:bn.markLabel)!=null?Bt:Qt.markLabel,Jr=(Rt=bn==null?void 0:bn.input)!=null?Rt:Qt.input,zs=useSlotProps({elementType:Un,getSlotProps:$n,externalSlotProps:$r,externalForwardedProps:nr,additionalProps:_extends({},shouldSpreadAdditionalProps$1(Un)&&{as:Vt}),ownerState:_extends({},or,$r==null?void 0:$r.ownerState),className:[Sr.root,Zt]}),Ws=useSlotProps({elementType:Jn,externalSlotProps:es,ownerState:or,className:Sr.rail}),Js=useSlotProps({elementType:pr,externalSlotProps:Hr,additionalProps:{style:_extends({},mr[In].offset(gr),mr[In].leap(Cr))},ownerState:_extends({},or,Hr==null?void 0:Hr.ownerState),className:Sr.track}),ao=useSlotProps({elementType:Gn,getSlotProps:$t,externalSlotProps:Ur,ownerState:_extends({},or,Ur==null?void 0:Ur.ownerState)}),Ks=useSlotProps({elementType:Zn,externalSlotProps:Ir,ownerState:_extends({},or,Ir==null?void 0:Ir.ownerState),className:Sr.valueLabel}),Es=useSlotProps({elementType:qn,externalSlotProps:Fr,ownerState:or,className:Sr.mark}),Do=useSlotProps({elementType:vr,externalSlotProps:Pr,ownerState:or}),js=useSlotProps({elementType:_r,getSlotProps:tn,externalSlotProps:Jr,ownerState:or});return jsxs(Un,_extends({},zs,{children:[jsx(Jn,_extends({},Ws)),jsx(pr,_extends({},Js)),Mn.filter(pn=>pn.value>=Nn&&pn.value<=Tn).map((pn,Kt)=>{const Gt=valueToPercent(pn.value,Nn,Tn),zt=mr[In].offset(Gt);let on;return Sn===!1?on=tr.indexOf(pn.value)!==-1:on=Sn==="normal"&&(yn?pn.value>=tr[0]&&pn.value<=tr[tr.length-1]:pn.value<=tr[0])||Sn==="inverted"&&(yn?pn.value<=tr[0]||pn.value>=tr[tr.length-1]:pn.value>=tr[0]),jsxs(reactExports.Fragment,{children:[jsx(qn,_extends({"data-index":Kt},Es,!isHostComponent(qn)&&{markActive:on},{style:_extends({},zt,Es.style),className:clsx(Es.className,on&&Sr.markActive)})),pn.label!=null?jsx(vr,_extends({"aria-hidden":!0,"data-index":Kt},Do,!isHostComponent(vr)&&{markLabelActive:on},{style:_extends({},zt,Do.style),className:clsx(Sr.markLabel,Do.className,on&&Sr.markLabelActive),children:pn.label})):null]},Kt)}),tr.map((pn,Kt)=>{const Gt=valueToPercent(pn,Nn,Tn),zt=mr[In].offset(Gt),on=xn==="off"?Forward:Zn;return jsx(reactExports.Fragment,{children:jsx(on,_extends({},!isHostComponent(on)&&{valueLabelFormat:Qn,valueLabelDisplay:xn,value:typeof Qn=="function"?Qn(Cn(pn),Kt):Qn,index:Kt,open:An===Kt||En===Kt||xn==="on",disabled:Ot},Ks,{children:jsx(Gn,_extends({"data-index":Kt,"data-focusvisible":Hn===Kt},ao,{className:clsx(Sr.thumb,ao.className,En===Kt&&Sr.active,Hn===Kt&&Sr.focusVisible),style:_extends({},zt,{pointerEvents:cn&&En!==Kt?"none":void 0},ao.style),children:jsx(_r,_extends({"data-index":Kt,"aria-label":rn?rn(Kt):Jt,"aria-valuenow":Cn(pn),"aria-labelledby":jt,"aria-valuetext":fn?fn(Cn(pn),Kt):sn,value:tr[Kt]},js))}))}))},Kt)})]}))}),Slider$1=Slider,_excluded=["component","direction","spacing","divider","children"];function joinChildren(a,s){const o=reactExports.Children.toArray(a).filter(Boolean);return o.reduce((j,$,_e)=>(j.push($),_e<o.length-1&&j.push(reactExports.cloneElement(s,{key:`separator-${_e}`})),j),[])}const getSideFromDirection=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],style=({ownerState:a,theme:s})=>{let o=_extends({display:"flex",flexDirection:"column"},handleBreakpoints({theme:s},resolveBreakpointValues({values:a.direction,breakpoints:s.breakpoints.values}),j=>({flexDirection:j})));if(a.spacing){const j=createUnarySpacing(s),$=Object.keys(s.breakpoints.values).reduce((rt,it)=>((typeof a.spacing=="object"&&a.spacing[it]!=null||typeof a.direction=="object"&&a.direction[it]!=null)&&(rt[it]=!0),rt),{}),_e=resolveBreakpointValues({values:a.direction,base:$}),tt=resolveBreakpointValues({values:a.spacing,base:$});typeof _e=="object"&&Object.keys(_e).forEach((rt,it,st)=>{if(!_e[rt]){const ot=it>0?_e[st[it-1]]:"column";_e[rt]=ot}}),o=deepmerge(o,handleBreakpoints({theme:s},tt,(rt,it)=>({"& > :not(style) + :not(style)":{margin:0,[`margin${getSideFromDirection(it?_e[it]:a.direction)}`]:getValue(j,rt)}})))}return o=mergeBreakpointsInOrder(s.breakpoints,o),o},StackRoot=styled$1("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,s)=>[s.root]})(style),Stack=reactExports.forwardRef(function a(s,o){const j=useThemeProps({props:s,name:"MuiStack"}),$=extendSxProp(j),{component:_e="div",direction:tt="column",spacing:nt=0,divider:rt,children:it}=$,st=_objectWithoutPropertiesLoose($,_excluded);return jsx(StackRoot,_extends({as:_e,ownerState:{direction:tt,spacing:nt},ref:o},st,{children:rt?joinChildren(it,rt):it}))}),Stack$1=Stack,Interface=()=>{const{tableWidth:a,setTableWidth:s,legs:o,setLegs:j,legsColor:$,setLegsColor:_e}=useConfigurator();return jsx(Box$1,{sx:{position:"absolute",top:0,right:0},p:3,children:jsxs(Stack$1,{spacing:3,children:[jsx(Typography$1,{variant:"caption",children:"Table Configurator"}),jsx(Box$1,{className:"glass",p:3,children:jsxs(FormControl$1,{children:[jsx(FormLabel$1,{children:"Table width"}),jsx(Slider$1,{sx:{width:"200px"},min:50,max:200,value:a,onChange:tt=>s(tt.target.value),valueLabelDisplay:"auto"})]})}),jsx(Box$1,{className:"glass",p:3,children:jsxs(FormControl$1,{children:[jsx(FormLabel$1,{children:"Legs Layout"}),jsxs(RadioGroup$1,{value:o,onChange:tt=>j(parseInt(tt.target.value)),children:[jsx(FormControlLabel$1,{value:0,control:jsx(Radio$1,{}),label:"Standard"}),jsx(FormControlLabel$1,{value:1,control:jsx(Radio$1,{}),label:"Solid"}),jsx(FormControlLabel$1,{value:2,control:jsx(Radio$1,{}),label:"Design"})]})]})}),jsx(Box$1,{className:"glass",p:3,children:jsxs(FormControl$1,{children:[jsx(FormLabel$1,{children:"Legs Color"}),jsxs(RadioGroup$1,{value:$,onChange:tt=>_e(tt.target.value),children:[jsx(FormControlLabel$1,{value:"#777777",control:jsx(Radio$1,{}),label:"Black"}),jsx(FormControlLabel$1,{value:"#ECECEC",control:jsx(Radio$1,{}),label:"Chrome"}),jsx(FormControlLabel$1,{value:"#C9BD71",control:jsx(Radio$1,{}),label:"Gold"}),jsx(FormControlLabel$1,{value:"#C9A3B9",control:jsx(Radio$1,{}),label:"Pink Gold"})]})]})})]})})};function App(){return jsxs(Fragment,{children:[jsx(Canvas,{shadows:!0,camera:{position:[4,4,-12],fov:35},children:jsx(Experience,{})}),jsx(Interface,{})]})}const index="";client.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(ConfiguratorProvider,{children:jsx(App,{})})}))});export default vy();
